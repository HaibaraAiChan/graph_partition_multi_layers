Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647786024.998732
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026282787322998047
random selection method range initialization spend 0.0062100887298583984
time for parepare:  0.0190427303314209
local_output_nid generation:  0.0011098384857177734
local_in_edges_tensor generation:  0.003185749053955078
mini_batch_src_global generation:  0.001695394515991211
r_  generation:  0.011094808578491211
local_output_nid generation:  0.0014109611511230469
local_in_edges_tensor generation:  0.0009746551513671875
mini_batch_src_global generation:  0.0017542839050292969
r_  generation:  0.00993800163269043
local_output_nid generation:  0.0014939308166503906
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.00901174545288086
local_output_nid generation:  0.0014712810516357422
local_in_edges_tensor generation:  0.0008339881896972656
mini_batch_src_global generation:  0.0009515285491943359
r_  generation:  0.009072542190551758
local_output_nid generation:  0.001468658447265625
local_in_edges_tensor generation:  0.0008044242858886719
mini_batch_src_global generation:  0.0009438991546630859
r_  generation:  0.009141921997070312
local_output_nid generation:  0.0014758110046386719
local_in_edges_tensor generation:  0.0007877349853515625
mini_batch_src_global generation:  0.0009894371032714844
r_  generation:  0.009715795516967773
local_output_nid generation:  0.0014598369598388672
local_in_edges_tensor generation:  0.0007817745208740234
mini_batch_src_global generation:  0.0009987354278564453
r_  generation:  0.0096588134765625
local_output_nid generation:  0.0014500617980957031
local_in_edges_tensor generation:  0.0007822513580322266
mini_batch_src_global generation:  0.00099945068359375
r_  generation:  0.00986027717590332
local_output_nid generation:  0.001455545425415039
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.0009794235229492188
r_  generation:  0.00966024398803711
local_output_nid generation:  0.0014672279357910156
local_in_edges_tensor generation:  0.000766754150390625
mini_batch_src_global generation:  0.000989675521850586
r_  generation:  0.009650468826293945
local_output_nid generation:  0.0014493465423583984
local_in_edges_tensor generation:  0.0007669925689697266
mini_batch_src_global generation:  0.0010221004486083984
r_  generation:  0.01005411148071289
local_output_nid generation:  0.0014564990997314453
local_in_edges_tensor generation:  0.0007646083831787109
mini_batch_src_global generation:  0.0010313987731933594
r_  generation:  0.010060310363769531
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0010342597961425781
r_  generation:  0.00960230827331543
local_output_nid generation:  0.0014591217041015625
local_in_edges_tensor generation:  0.0007677078247070312
mini_batch_src_global generation:  0.0010242462158203125
r_  generation:  0.00994253158569336
local_output_nid generation:  0.001438140869140625
local_in_edges_tensor generation:  0.0007658004760742188
mini_batch_src_global generation:  0.0010344982147216797
r_  generation:  0.00996708869934082
local_output_nid generation:  0.0014450550079345703
local_in_edges_tensor generation:  0.0007417201995849609
mini_batch_src_global generation:  0.000993490219116211
r_  generation:  0.009522438049316406
local_output_nid generation:  0.0014553070068359375
local_in_edges_tensor generation:  0.0007569789886474609
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.010268926620483398
local_output_nid generation:  0.0014538764953613281
local_in_edges_tensor generation:  0.0007598400115966797
mini_batch_src_global generation:  0.0010328292846679688
r_  generation:  0.009807586669921875
local_output_nid generation:  0.0014531612396240234
local_in_edges_tensor generation:  0.0007500648498535156
mini_batch_src_global generation:  0.0010523796081542969
r_  generation:  0.009880542755126953
local_output_nid generation:  0.001438140869140625
local_in_edges_tensor generation:  0.0007584095001220703
mini_batch_src_global generation:  0.001020669937133789
r_  generation:  0.009745359420776367
local_output_nid generation:  0.0014684200286865234
local_in_edges_tensor generation:  0.0007562637329101562
mini_batch_src_global generation:  0.0010309219360351562
r_  generation:  0.009922981262207031
local_output_nid generation:  0.0014605522155761719
local_in_edges_tensor generation:  0.000766754150390625
mini_batch_src_global generation:  0.0010271072387695312
r_  generation:  0.010020971298217773
local_output_nid generation:  0.0014622211456298828
local_in_edges_tensor generation:  0.0007715225219726562
mini_batch_src_global generation:  0.001089334487915039
r_  generation:  0.01028585433959961
local_output_nid generation:  0.0014727115631103516
local_in_edges_tensor generation:  0.0007767677307128906
mini_batch_src_global generation:  0.0010957717895507812
r_  generation:  0.010346174240112305
local_output_nid generation:  0.001476287841796875
local_in_edges_tensor generation:  0.0007755756378173828
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.010259866714477539
local_output_nid generation:  0.001466512680053711
local_in_edges_tensor generation:  0.000774383544921875
mini_batch_src_global generation:  0.0010943412780761719
r_  generation:  0.009989500045776367
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.0007505416870117188
mini_batch_src_global generation:  0.0010437965393066406
r_  generation:  0.009595155715942383
local_output_nid generation:  0.0014472007751464844
local_in_edges_tensor generation:  0.0007565021514892578
mini_batch_src_global generation:  0.0010581016540527344
r_  generation:  0.010250091552734375
local_output_nid generation:  0.0014569759368896484
local_in_edges_tensor generation:  0.0007512569427490234
mini_batch_src_global generation:  0.001089334487915039
r_  generation:  0.01042628288269043
local_output_nid generation:  0.0014507770538330078
local_in_edges_tensor generation:  0.005655765533447266
mini_batch_src_global generation:  0.0012602806091308594
r_  generation:  0.01001119613647461
local_output_nid generation:  0.0013573169708251953
local_in_edges_tensor generation:  0.0007901191711425781
mini_batch_src_global generation:  0.0010950565338134766
r_  generation:  0.009580373764038086
local_output_nid generation:  0.001384735107421875
local_in_edges_tensor generation:  0.0007565021514892578
mini_batch_src_global generation:  0.0010890960693359375
r_  generation:  0.009792566299438477
----------------------check_connections_block total spend ----------------------------- 0.5378422737121582
generate_one_block  0.015735387802124023
generate_one_block  0.015549898147583008
generate_one_block  0.014193534851074219
generate_one_block  0.014317750930786133
generate_one_block  0.014383316040039062
generate_one_block  0.014904022216796875
generate_one_block  0.014755725860595703
generate_one_block  0.014918088912963867
generate_one_block  0.014681577682495117
generate_one_block  0.014899969100952148
generate_one_block  0.015104055404663086
generate_one_block  0.014605998992919922
generate_one_block  0.01439666748046875
generate_one_block  0.014679193496704102
generate_one_block  0.014709234237670898
generate_one_block  0.014020204544067383
generate_one_block  0.015199899673461914
generate_one_block  0.014440059661865234
generate_one_block  0.014646530151367188
generate_one_block  0.014278888702392578
generate_one_block  0.014734268188476562
generate_one_block  0.01460576057434082
generate_one_block  0.015248537063598633
generate_one_block  0.015021085739135742
generate_one_block  0.015186786651611328
generate_one_block  0.014647722244262695
generate_one_block  0.01416325569152832
generate_one_block  0.015041351318359375
generate_one_block  0.015281915664672852
generate_one_block  0.014627933502197266
generate_one_block  0.01431131362915039
generate_one_block  0.01450037956237793
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036856889724731445
gen group dst list time:  0.02381443977355957
time for parepare:  0.01903700828552246
local_output_nid generation:  0.005329608917236328
local_in_edges_tensor generation:  0.01167750358581543
mini_batch_src_global generation:  0.014091014862060547
r_  generation:  0.1372218132019043
local_output_nid generation:  0.00879049301147461
local_in_edges_tensor generation:  0.014328956604003906
mini_batch_src_global generation:  0.01824021339416504
r_  generation:  0.14686036109924316
local_output_nid generation:  0.008048295974731445
local_in_edges_tensor generation:  0.009512662887573242
mini_batch_src_global generation:  0.015419483184814453
r_  generation:  0.13595819473266602
local_output_nid generation:  0.008230209350585938
local_in_edges_tensor generation:  0.012282133102416992
mini_batch_src_global generation:  0.016247987747192383
r_  generation:  0.14164161682128906
local_output_nid generation:  0.008264780044555664
local_in_edges_tensor generation:  0.008467435836791992
mini_batch_src_global generation:  0.026430845260620117
r_  generation:  0.14849567413330078
local_output_nid generation:  0.00849461555480957
local_in_edges_tensor generation:  0.010292768478393555
mini_batch_src_global generation:  0.01930999755859375
r_  generation:  0.15017461776733398
local_output_nid generation:  0.008450508117675781
local_in_edges_tensor generation:  0.009989738464355469
mini_batch_src_global generation:  0.018390893936157227
r_  generation:  0.14822912216186523
local_output_nid generation:  0.008556127548217773
local_in_edges_tensor generation:  0.010106086730957031
mini_batch_src_global generation:  0.019919157028198242
r_  generation:  0.15156078338623047
local_output_nid generation:  0.008538246154785156
local_in_edges_tensor generation:  0.010092973709106445
mini_batch_src_global generation:  0.018604040145874023
r_  generation:  0.15486788749694824
local_output_nid generation:  0.0083465576171875
local_in_edges_tensor generation:  0.008697032928466797
mini_batch_src_global generation:  0.018393754959106445
r_  generation:  0.14940214157104492
local_output_nid generation:  0.008588314056396484
local_in_edges_tensor generation:  0.012420177459716797
mini_batch_src_global generation:  0.019029855728149414
r_  generation:  0.1535634994506836
local_output_nid generation:  0.008375883102416992
local_in_edges_tensor generation:  0.00882411003112793
mini_batch_src_global generation:  0.018915414810180664
r_  generation:  0.14994430541992188
local_output_nid generation:  0.008165359497070312
local_in_edges_tensor generation:  0.010830163955688477
mini_batch_src_global generation:  0.018617630004882812
r_  generation:  0.14962315559387207
local_output_nid generation:  0.008409261703491211
local_in_edges_tensor generation:  0.010042428970336914
mini_batch_src_global generation:  0.018704652786254883
r_  generation:  0.15120410919189453
local_output_nid generation:  0.008327722549438477
local_in_edges_tensor generation:  0.01120615005493164
mini_batch_src_global generation:  0.01870250701904297
r_  generation:  0.1496868133544922
local_output_nid generation:  0.008037805557250977
local_in_edges_tensor generation:  0.008407115936279297
mini_batch_src_global generation:  0.017612695693969727
r_  generation:  0.14135241508483887
local_output_nid generation:  0.008667945861816406
local_in_edges_tensor generation:  0.010171651840209961
mini_batch_src_global generation:  0.01972508430480957
r_  generation:  0.15386295318603516
local_output_nid generation:  0.008282184600830078
local_in_edges_tensor generation:  0.011601686477661133
mini_batch_src_global generation:  0.01849818229675293
r_  generation:  0.1497180461883545
local_output_nid generation:  0.008534431457519531
local_in_edges_tensor generation:  0.009540081024169922
mini_batch_src_global generation:  0.02004384994506836
r_  generation:  0.15263009071350098
local_output_nid generation:  0.008371114730834961
local_in_edges_tensor generation:  0.009949207305908203
mini_batch_src_global generation:  0.01849985122680664
r_  generation:  0.15219378471374512
local_output_nid generation:  0.008405685424804688
local_in_edges_tensor generation:  0.011062860488891602
mini_batch_src_global generation:  0.01875448226928711
r_  generation:  0.15132451057434082
local_output_nid generation:  0.008331537246704102
local_in_edges_tensor generation:  0.008664846420288086
mini_batch_src_global generation:  0.021854639053344727
r_  generation:  0.15068507194519043
local_output_nid generation:  0.008516550064086914
local_in_edges_tensor generation:  0.012633800506591797
mini_batch_src_global generation:  0.019077301025390625
r_  generation:  0.15382766723632812
local_output_nid generation:  0.008520841598510742
local_in_edges_tensor generation:  0.011258840560913086
mini_batch_src_global generation:  0.018909692764282227
r_  generation:  0.15653395652770996
local_output_nid generation:  0.008658409118652344
local_in_edges_tensor generation:  0.011487007141113281
mini_batch_src_global generation:  0.019489526748657227
r_  generation:  0.1560521125793457
local_output_nid generation:  0.008381366729736328
local_in_edges_tensor generation:  0.011823892593383789
mini_batch_src_global generation:  0.01919269561767578
r_  generation:  0.15400052070617676
local_output_nid generation:  0.00814509391784668
local_in_edges_tensor generation:  0.008304119110107422
mini_batch_src_global generation:  0.017975807189941406
r_  generation:  0.1462874412536621
local_output_nid generation:  0.008592605590820312
local_in_edges_tensor generation:  0.009319305419921875
mini_batch_src_global generation:  0.01889514923095703
r_  generation:  0.1551656723022461
local_output_nid generation:  0.00860285758972168
local_in_edges_tensor generation:  0.011542558670043945
mini_batch_src_global generation:  0.01933121681213379
r_  generation:  0.1572878360748291
local_output_nid generation:  0.00838160514831543
local_in_edges_tensor generation:  0.008720159530639648
mini_batch_src_global generation:  0.021770715713500977
r_  generation:  0.15122509002685547
local_output_nid generation:  0.00817418098449707
local_in_edges_tensor generation:  0.008475303649902344
mini_batch_src_global generation:  0.017827272415161133
r_  generation:  0.14776015281677246
local_output_nid generation:  0.008393049240112305
local_in_edges_tensor generation:  0.009761810302734375
mini_batch_src_global generation:  0.019466638565063477
r_  generation:  0.15446996688842773
----------------------check_connections_block total spend ----------------------------- 7.125291585922241
generate_one_block  0.1909496784210205
generate_one_block  0.20106220245361328
generate_one_block  0.19894671440124512
generate_one_block  0.18124079704284668
generate_one_block  0.1843738555908203
generate_one_block  0.19392967224121094
generate_one_block  0.19140291213989258
generate_one_block  0.1915607452392578
generate_one_block  0.1918196678161621
generate_one_block  0.18350696563720703
generate_one_block  0.1997992992401123
generate_one_block  0.1937572956085205
generate_one_block  0.18441200256347656
generate_one_block  0.18934369087219238
generate_one_block  0.1921215057373047
generate_one_block  0.20938444137573242
generate_one_block  0.19762444496154785
generate_one_block  0.18922710418701172
generate_one_block  0.19324040412902832
generate_one_block  0.18798041343688965
generate_one_block  0.19032669067382812
generate_one_block  0.18939971923828125
generate_one_block  0.1972522735595703
generate_one_block  0.19854259490966797
generate_one_block  0.19666218757629395
generate_one_block  0.1938323974609375
generate_one_block  0.17923259735107422
generate_one_block  0.1946849822998047
generate_one_block  0.1994028091430664
generate_one_block  0.18581271171569824
generate_one_block  0.18173003196716309
generate_one_block  0.1898503303527832
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05376410484313965
gen group dst list time:  0.1052103042602539
time for parepare:  0.01900625228881836
local_output_nid generation:  0.02251577377319336
local_in_edges_tensor generation:  0.057862281799316406
mini_batch_src_global generation:  0.04168343544006348
r_  generation:  0.3962230682373047
local_output_nid generation:  0.028451204299926758
local_in_edges_tensor generation:  0.04120612144470215
mini_batch_src_global generation:  0.06657099723815918
r_  generation:  0.41301822662353516
local_output_nid generation:  0.028415918350219727
local_in_edges_tensor generation:  0.03300619125366211
mini_batch_src_global generation:  0.04908394813537598
r_  generation:  0.40602755546569824
local_output_nid generation:  0.02687215805053711
local_in_edges_tensor generation:  0.02685236930847168
mini_batch_src_global generation:  0.05200982093811035
r_  generation:  0.4056985378265381
local_output_nid generation:  0.02623295783996582
local_in_edges_tensor generation:  0.03392624855041504
mini_batch_src_global generation:  0.04736328125
r_  generation:  0.41434192657470703
local_output_nid generation:  0.027660131454467773
local_in_edges_tensor generation:  0.0348057746887207
mini_batch_src_global generation:  0.04796338081359863
r_  generation:  0.4108591079711914
local_output_nid generation:  0.0268402099609375
local_in_edges_tensor generation:  0.029862403869628906
mini_batch_src_global generation:  0.047625064849853516
r_  generation:  0.41081738471984863
local_output_nid generation:  0.027002573013305664
local_in_edges_tensor generation:  0.03720808029174805
mini_batch_src_global generation:  0.04862570762634277
r_  generation:  0.4207499027252197
local_output_nid generation:  0.026976823806762695
local_in_edges_tensor generation:  0.03606081008911133
mini_batch_src_global generation:  0.0497279167175293
r_  generation:  0.4136970043182373
local_output_nid generation:  0.026569366455078125
local_in_edges_tensor generation:  0.028632402420043945
mini_batch_src_global generation:  0.048467159271240234
r_  generation:  0.4077169895172119
local_output_nid generation:  0.0267484188079834
local_in_edges_tensor generation:  0.026645898818969727
mini_batch_src_global generation:  0.05143404006958008
r_  generation:  0.4293947219848633
local_output_nid generation:  0.027301549911499023
local_in_edges_tensor generation:  0.035331010818481445
mini_batch_src_global generation:  0.0505976676940918
r_  generation:  0.4085671901702881
local_output_nid generation:  0.026996612548828125
local_in_edges_tensor generation:  0.030718088150024414
mini_batch_src_global generation:  0.04848337173461914
r_  generation:  0.4095592498779297
local_output_nid generation:  0.027214765548706055
local_in_edges_tensor generation:  0.029681921005249023
mini_batch_src_global generation:  0.04831862449645996
r_  generation:  0.41114330291748047
local_output_nid generation:  0.02950263023376465
local_in_edges_tensor generation:  0.034271240234375
mini_batch_src_global generation:  0.051773786544799805
r_  generation:  0.4120779037475586
local_output_nid generation:  0.026854753494262695
local_in_edges_tensor generation:  0.026448488235473633
mini_batch_src_global generation:  0.0482633113861084
r_  generation:  0.4013218879699707
local_output_nid generation:  0.027280807495117188
local_in_edges_tensor generation:  0.02591848373413086
mini_batch_src_global generation:  0.050908803939819336
r_  generation:  0.4102928638458252
local_output_nid generation:  0.027341365814208984
local_in_edges_tensor generation:  0.03032207489013672
mini_batch_src_global generation:  0.04830741882324219
r_  generation:  0.4159884452819824
local_output_nid generation:  0.027193784713745117
local_in_edges_tensor generation:  0.03362727165222168
mini_batch_src_global generation:  0.05115079879760742
r_  generation:  0.41395044326782227
local_output_nid generation:  0.027235984802246094
local_in_edges_tensor generation:  0.033605337142944336
mini_batch_src_global generation:  0.04840564727783203
r_  generation:  0.41158580780029297
local_output_nid generation:  0.02723097801208496
local_in_edges_tensor generation:  0.026645421981811523
mini_batch_src_global generation:  0.048670053482055664
r_  generation:  0.4160151481628418
local_output_nid generation:  0.027283430099487305
local_in_edges_tensor generation:  0.026166439056396484
mini_batch_src_global generation:  0.048551321029663086
r_  generation:  0.4243142604827881
local_output_nid generation:  0.02762889862060547
local_in_edges_tensor generation:  0.030646324157714844
mini_batch_src_global generation:  0.049143314361572266
r_  generation:  0.4189317226409912
local_output_nid generation:  0.027582168579101562
local_in_edges_tensor generation:  0.033995866775512695
mini_batch_src_global generation:  0.04860329627990723
r_  generation:  0.4152076244354248
local_output_nid generation:  0.02760148048400879
local_in_edges_tensor generation:  0.027403831481933594
mini_batch_src_global generation:  0.048897743225097656
r_  generation:  0.4197814464569092
local_output_nid generation:  0.027501344680786133
local_in_edges_tensor generation:  0.02979421615600586
mini_batch_src_global generation:  0.05203652381896973
r_  generation:  0.41910243034362793
local_output_nid generation:  0.02720022201538086
local_in_edges_tensor generation:  0.026751279830932617
mini_batch_src_global generation:  0.0486302375793457
r_  generation:  0.4267714023590088
local_output_nid generation:  0.027501821517944336
local_in_edges_tensor generation:  0.02668142318725586
mini_batch_src_global generation:  0.05202841758728027
r_  generation:  0.41500234603881836
local_output_nid generation:  0.027978897094726562
local_in_edges_tensor generation:  0.04099917411804199
mini_batch_src_global generation:  0.04862809181213379
r_  generation:  0.4217190742492676
local_output_nid generation:  0.027438640594482422
local_in_edges_tensor generation:  0.026920318603515625
mini_batch_src_global generation:  0.04937243461608887
r_  generation:  0.41145825386047363
local_output_nid generation:  0.027379751205444336
local_in_edges_tensor generation:  0.0264585018157959
mini_batch_src_global generation:  0.04851174354553223
r_  generation:  0.41344165802001953
local_output_nid generation:  0.02754068374633789
local_in_edges_tensor generation:  0.03391218185424805
mini_batch_src_global generation:  0.04864168167114258
r_  generation:  0.4133317470550537
----------------------check_connections_block total spend ----------------------------- 19.584479808807373
generate_one_block  0.6213665008544922
generate_one_block  0.5416882038116455
generate_one_block  0.5182538032531738
generate_one_block  0.5219533443450928
generate_one_block  0.5391390323638916
generate_one_block  0.5350604057312012
generate_one_block  0.5233349800109863
generate_one_block  0.5458669662475586
generate_one_block  0.5295567512512207
generate_one_block  0.5189921855926514
generate_one_block  0.5400881767272949
generate_one_block  0.5318937301635742
generate_one_block  0.5192568302154541
generate_one_block  0.5265047550201416
generate_one_block  0.5321617126464844
generate_one_block  0.5180153846740723
generate_one_block  0.5272865295410156
generate_one_block  0.5296483039855957
generate_one_block  0.5301387310028076
generate_one_block  0.5323777198791504
generate_one_block  0.5408022403717041
generate_one_block  0.5339770317077637
generate_one_block  0.5420331954956055
generate_one_block  0.5504519939422607
generate_one_block  0.5260937213897705
generate_one_block  0.5313520431518555
generate_one_block  0.5199615955352783
generate_one_block  0.5329704284667969
generate_one_block  0.5512399673461914
generate_one_block  0.5208694934844971
generate_one_block  0.5326223373413086
generate_one_block  0.5390398502349854
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  26.709771394729614
block generation total time  23.246411085128784
average batch blocks generation time:  0.7264503464102745
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.0888066291809082  GigaBytes
Max Memory Allocated: 0.0888066291809082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8748779296875 GB
    Memory Allocated: 17.210143089294434  GigaBytes
Max Memory Allocated: 17.248377323150635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7537841796875 GB
    Memory Allocated: 0.09447193145751953  GigaBytes
Max Memory Allocated: 17.248377323150635  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7518310546875 GB
    Memory Allocated: 17.34960651397705  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1951904296875 GB
    Memory Allocated: 0.09469223022460938  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3670654296875 GB
    Memory Allocated: 16.424522876739502  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.0942850112915039  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.606359481811523  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09475231170654297  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.696174144744873  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09415483474731445  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.126262664794922  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09478998184204102  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.8491473197937  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09448623657226562  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.18174648284912  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09480857849121094  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.062783241271973  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09413814544677734  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.750308513641357  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09485054016113281  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.16471576690674  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09410810470581055  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.009570598602295  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09373807907104492  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.77968406677246  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09437990188598633  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.866418838500977  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.0948023796081543  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.98900556564331  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09413814544677734  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.18559169769287  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09482669830322266  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.089497089385986  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09415960311889648  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.929770946502686  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09481525421142578  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.026013374328613  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.0944061279296875  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.774136543273926  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09479570388793945  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.89964532852173  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09432697296142578  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.879831790924072  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09482860565185547  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.125905513763428  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09447240829467773  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.130481719970703  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09485101699829102  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.153444290161133  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09414434432983398  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.158605575561523  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.0946950912475586  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.441890239715576  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09425020217895508  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.066408157348633  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09485149383544922  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.278461933135986  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09440135955810547  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.87760829925537  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09471559524536133  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.560179710388184  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.09416532516479492  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.946319580078125  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03390426188707352 |0.02880062907934189 |0.4452747255563736 |0.00010322779417037964 |0.7904002442955971 |0.010639667510986328 |
----------------------------------------------------------pseudo_mini_loss sum 5.384799480438232
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8793852
Number of first layer input nodes during this epoch:  4681529
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.12282752990722656  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024731159210205078
random selection method range initialization spend 0.005087852478027344
time for parepare:  0.01894402503967285
local_output_nid generation:  0.0013780593872070312
local_in_edges_tensor generation:  0.06615018844604492
mini_batch_src_global generation:  0.002460002899169922
r_  generation:  0.011127233505249023
local_output_nid generation:  0.0018520355224609375
local_in_edges_tensor generation:  0.0009686946868896484
mini_batch_src_global generation:  0.001684427261352539
r_  generation:  0.01011967658996582
local_output_nid generation:  0.0017278194427490234
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.010001897811889648
local_output_nid generation:  0.0016973018646240234
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.001171112060546875
r_  generation:  0.009775400161743164
local_output_nid generation:  0.0016565322875976562
local_in_edges_tensor generation:  0.0008668899536132812
mini_batch_src_global generation:  0.0011467933654785156
r_  generation:  0.009994029998779297
local_output_nid generation:  0.0016646385192871094
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.009830951690673828
local_output_nid generation:  0.0016596317291259766
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.009914159774780273
local_output_nid generation:  0.0016674995422363281
local_in_edges_tensor generation:  0.0008664131164550781
mini_batch_src_global generation:  0.0010819435119628906
r_  generation:  0.009720802307128906
local_output_nid generation:  0.0016436576843261719
local_in_edges_tensor generation:  0.0008497238159179688
mini_batch_src_global generation:  0.001089334487915039
r_  generation:  0.009765863418579102
local_output_nid generation:  0.0016551017761230469
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.01021122932434082
local_output_nid generation:  0.001661062240600586
local_in_edges_tensor generation:  0.00087738037109375
mini_batch_src_global generation:  0.0012292861938476562
r_  generation:  0.010321855545043945
local_output_nid generation:  0.0016722679138183594
local_in_edges_tensor generation:  0.000865936279296875
mini_batch_src_global generation:  0.0011138916015625
r_  generation:  0.01010894775390625
local_output_nid generation:  0.0016541481018066406
local_in_edges_tensor generation:  0.0008428096771240234
mini_batch_src_global generation:  0.0010519027709960938
r_  generation:  0.00947427749633789
local_output_nid generation:  0.0016608238220214844
local_in_edges_tensor generation:  0.0008668899536132812
mini_batch_src_global generation:  0.0010547637939453125
r_  generation:  0.009514570236206055
local_output_nid generation:  0.0016689300537109375
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.0011970996856689453
r_  generation:  0.010587453842163086
local_output_nid generation:  0.001669168472290039
local_in_edges_tensor generation:  0.0008401870727539062
mini_batch_src_global generation:  0.0010519027709960938
r_  generation:  0.009706258773803711
local_output_nid generation:  0.0016684532165527344
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.001071929931640625
r_  generation:  0.00986480712890625
local_output_nid generation:  0.0016770362854003906
local_in_edges_tensor generation:  0.0008733272552490234
mini_batch_src_global generation:  0.0010960102081298828
r_  generation:  0.01009988784790039
local_output_nid generation:  0.0016789436340332031
local_in_edges_tensor generation:  0.00086212158203125
mini_batch_src_global generation:  0.0011556148529052734
r_  generation:  0.010497331619262695
local_output_nid generation:  0.0016684532165527344
local_in_edges_tensor generation:  0.0008623600006103516
mini_batch_src_global generation:  0.0011239051818847656
r_  generation:  0.010119915008544922
local_output_nid generation:  0.0016932487487792969
local_in_edges_tensor generation:  0.0008630752563476562
mini_batch_src_global generation:  0.0012011528015136719
r_  generation:  0.01015019416809082
local_output_nid generation:  0.0016775131225585938
local_in_edges_tensor generation:  0.0008435249328613281
mini_batch_src_global generation:  0.001157522201538086
r_  generation:  0.010541439056396484
local_output_nid generation:  0.0017025470733642578
local_in_edges_tensor generation:  0.0008912086486816406
mini_batch_src_global generation:  0.0012314319610595703
r_  generation:  0.010463237762451172
local_output_nid generation:  0.0016896724700927734
local_in_edges_tensor generation:  0.0008764266967773438
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.010024547576904297
local_output_nid generation:  0.001687765121459961
local_in_edges_tensor generation:  0.0008647441864013672
mini_batch_src_global generation:  0.0011074542999267578
r_  generation:  0.009946107864379883
local_output_nid generation:  0.0016682147979736328
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.001188516616821289
r_  generation:  0.010149240493774414
local_output_nid generation:  0.00167083740234375
local_in_edges_tensor generation:  0.0008683204650878906
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.010423660278320312
local_output_nid generation:  0.0016717910766601562
local_in_edges_tensor generation:  0.0008516311645507812
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.010100364685058594
local_output_nid generation:  0.0016794204711914062
local_in_edges_tensor generation:  0.0008587837219238281
mini_batch_src_global generation:  0.0011641979217529297
r_  generation:  0.010160207748413086
local_output_nid generation:  0.0016658306121826172
local_in_edges_tensor generation:  0.0008401870727539062
mini_batch_src_global generation:  0.001184701919555664
r_  generation:  0.010170221328735352
local_output_nid generation:  0.0016751289367675781
local_in_edges_tensor generation:  0.000827789306640625
mini_batch_src_global generation:  0.0011265277862548828
r_  generation:  0.010245084762573242
local_output_nid generation:  0.0016510486602783203
local_in_edges_tensor generation:  0.0008301734924316406
mini_batch_src_global generation:  0.001125335693359375
r_  generation:  0.010094881057739258
----------------------check_connections_block total spend ----------------------------- 0.6214680671691895
generate_one_block  0.0233609676361084
generate_one_block  0.020641803741455078
generate_one_block  0.018825531005859375
generate_one_block  0.01949143409729004
generate_one_block  0.017994165420532227
generate_one_block  0.017392396926879883
generate_one_block  0.017406940460205078
generate_one_block  0.017152070999145508
generate_one_block  0.01709294319152832
generate_one_block  0.017707347869873047
generate_one_block  0.017911672592163086
generate_one_block  0.017784595489501953
generate_one_block  0.016347408294677734
generate_one_block  0.016499042510986328
generate_one_block  0.018101215362548828
generate_one_block  0.0165708065032959
generate_one_block  0.017059326171875
generate_one_block  0.017587900161743164
generate_one_block  0.018015384674072266
generate_one_block  0.017403602600097656
generate_one_block  0.01767754554748535
generate_one_block  0.018262386322021484
generate_one_block  0.017946720123291016
generate_one_block  0.01725625991821289
generate_one_block  0.01723337173461914
generate_one_block  0.01747298240661621
generate_one_block  0.017684459686279297
generate_one_block  0.017108678817749023
generate_one_block  0.01735401153564453
generate_one_block  0.017475128173828125
generate_one_block  0.017581701278686523
generate_one_block  0.01723456382751465
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033812522888183594
gen group dst list time:  0.023953676223754883
time for parepare:  0.019527673721313477
local_output_nid generation:  0.006012439727783203
local_in_edges_tensor generation:  0.014123916625976562
mini_batch_src_global generation:  0.015337467193603516
r_  generation:  0.13380098342895508
local_output_nid generation:  0.009552478790283203
local_in_edges_tensor generation:  0.010591268539428711
mini_batch_src_global generation:  0.016374588012695312
r_  generation:  0.13817238807678223
local_output_nid generation:  0.010188102722167969
local_in_edges_tensor generation:  0.030083179473876953
mini_batch_src_global generation:  0.016160011291503906
r_  generation:  0.15030455589294434
local_output_nid generation:  0.010280370712280273
local_in_edges_tensor generation:  0.010729312896728516
mini_batch_src_global generation:  0.01653909683227539
r_  generation:  0.14585375785827637
local_output_nid generation:  0.010545015335083008
local_in_edges_tensor generation:  0.01088261604309082
mini_batch_src_global generation:  0.028769493103027344
r_  generation:  0.17353391647338867
local_output_nid generation:  0.013799905776977539
local_in_edges_tensor generation:  0.012303352355957031
mini_batch_src_global generation:  0.020326852798461914
r_  generation:  0.16658806800842285
local_output_nid generation:  0.013123512268066406
local_in_edges_tensor generation:  0.011333703994750977
mini_batch_src_global generation:  0.020888328552246094
r_  generation:  0.1653881072998047
local_output_nid generation:  0.012871742248535156
local_in_edges_tensor generation:  0.012131214141845703
mini_batch_src_global generation:  0.02074289321899414
r_  generation:  0.1638927459716797
local_output_nid generation:  0.013549089431762695
local_in_edges_tensor generation:  0.012602806091308594
mini_batch_src_global generation:  0.021781206130981445
r_  generation:  0.1640920639038086
local_output_nid generation:  0.013881206512451172
local_in_edges_tensor generation:  0.014017820358276367
mini_batch_src_global generation:  0.02088141441345215
r_  generation:  0.16988873481750488
local_output_nid generation:  0.014337301254272461
local_in_edges_tensor generation:  0.01295328140258789
mini_batch_src_global generation:  0.02307438850402832
r_  generation:  0.1766517162322998
local_output_nid generation:  0.0146026611328125
local_in_edges_tensor generation:  0.012563228607177734
mini_batch_src_global generation:  0.02176070213317871
r_  generation:  0.19083404541015625
local_output_nid generation:  0.012067079544067383
local_in_edges_tensor generation:  0.009579896926879883
mini_batch_src_global generation:  0.018231868743896484
r_  generation:  0.14536190032958984
local_output_nid generation:  0.010525703430175781
local_in_edges_tensor generation:  0.008816242218017578
mini_batch_src_global generation:  0.017882823944091797
r_  generation:  0.149003267288208
local_output_nid generation:  0.011174201965332031
local_in_edges_tensor generation:  0.009503841400146484
mini_batch_src_global generation:  0.02068185806274414
r_  generation:  0.163177490234375
local_output_nid generation:  0.010093927383422852
local_in_edges_tensor generation:  0.008624792098999023
mini_batch_src_global generation:  0.01824951171875
r_  generation:  0.14953017234802246
local_output_nid generation:  0.010178327560424805
local_in_edges_tensor generation:  0.009676933288574219
mini_batch_src_global generation:  0.01901721954345703
r_  generation:  0.1546335220336914
local_output_nid generation:  0.010247945785522461
local_in_edges_tensor generation:  0.010263204574584961
mini_batch_src_global generation:  0.019149303436279297
r_  generation:  0.16362762451171875
local_output_nid generation:  0.010306596755981445
local_in_edges_tensor generation:  0.010841846466064453
mini_batch_src_global generation:  0.023361682891845703
r_  generation:  0.17731046676635742
local_output_nid generation:  0.013159990310668945
local_in_edges_tensor generation:  0.017362117767333984
mini_batch_src_global generation:  0.021083831787109375
r_  generation:  0.19376635551452637
local_output_nid generation:  0.010207414627075195
local_in_edges_tensor generation:  0.011025667190551758
mini_batch_src_global generation:  0.019301891326904297
r_  generation:  0.15875577926635742
local_output_nid generation:  0.010362625122070312
local_in_edges_tensor generation:  0.01045846939086914
mini_batch_src_global generation:  0.020008325576782227
r_  generation:  0.16428208351135254
local_output_nid generation:  0.010390758514404297
local_in_edges_tensor generation:  0.008849620819091797
mini_batch_src_global generation:  0.01987290382385254
r_  generation:  0.1616506576538086
local_output_nid generation:  0.00999593734741211
local_in_edges_tensor generation:  0.008675098419189453
mini_batch_src_global generation:  0.01921248435974121
r_  generation:  0.1550748348236084
local_output_nid generation:  0.00998067855834961
local_in_edges_tensor generation:  0.008470773696899414
mini_batch_src_global generation:  0.019090652465820312
r_  generation:  0.15577125549316406
local_output_nid generation:  0.01015615463256836
local_in_edges_tensor generation:  0.010908126831054688
mini_batch_src_global generation:  0.019355297088623047
r_  generation:  0.157806396484375
local_output_nid generation:  0.01041555404663086
local_in_edges_tensor generation:  0.0110321044921875
mini_batch_src_global generation:  0.019301414489746094
r_  generation:  0.15868735313415527
local_output_nid generation:  0.009907960891723633
local_in_edges_tensor generation:  0.008381366729736328
mini_batch_src_global generation:  0.01905083656311035
r_  generation:  0.19127202033996582
local_output_nid generation:  0.010091304779052734
local_in_edges_tensor generation:  0.009054899215698242
mini_batch_src_global generation:  0.0205228328704834
r_  generation:  0.19225811958312988
local_output_nid generation:  0.010128259658813477
local_in_edges_tensor generation:  0.010945320129394531
mini_batch_src_global generation:  0.019598007202148438
r_  generation:  0.2086493968963623
local_output_nid generation:  0.010023832321166992
local_in_edges_tensor generation:  0.011131525039672852
mini_batch_src_global generation:  0.02147698402404785
r_  generation:  0.16308164596557617
local_output_nid generation:  0.010007381439208984
local_in_edges_tensor generation:  0.008687973022460938
mini_batch_src_global generation:  0.019021987915039062
r_  generation:  0.1585075855255127
----------------------check_connections_block total spend ----------------------------- 7.822915554046631
generate_one_block  0.2378828525543213
generate_one_block  0.19747686386108398
generate_one_block  0.21255755424499512
generate_one_block  0.2054305076599121
generate_one_block  0.24585843086242676
generate_one_block  0.20795059204101562
generate_one_block  0.20152544975280762
generate_one_block  0.20923757553100586
generate_one_block  0.19761157035827637
generate_one_block  0.2049729824066162
generate_one_block  0.20853185653686523
generate_one_block  0.21036028861999512
generate_one_block  0.1825087070465088
generate_one_block  0.19022822380065918
generate_one_block  0.21265912055969238
generate_one_block  0.19923973083496094
generate_one_block  0.2015068531036377
generate_one_block  0.21646785736083984
generate_one_block  0.22773313522338867
generate_one_block  0.21593117713928223
generate_one_block  0.21364927291870117
generate_one_block  0.22100424766540527
generate_one_block  0.2111973762512207
generate_one_block  0.19739484786987305
generate_one_block  0.21127843856811523
generate_one_block  0.20384001731872559
generate_one_block  0.22522592544555664
generate_one_block  0.20947980880737305
generate_one_block  0.2043917179107666
generate_one_block  0.21073603630065918
generate_one_block  0.21644139289855957
generate_one_block  0.19632172584533691
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037165164947509766
gen group dst list time:  0.10539054870605469
time for parepare:  0.017667293548583984
local_output_nid generation:  0.024890422821044922
local_in_edges_tensor generation:  0.05336642265319824
mini_batch_src_global generation:  0.03951764106750488
r_  generation:  0.3941209316253662
local_output_nid generation:  0.030037879943847656
local_in_edges_tensor generation:  0.04109954833984375
mini_batch_src_global generation:  0.047597646713256836
r_  generation:  0.4329183101654053
local_output_nid generation:  0.03371167182922363
local_in_edges_tensor generation:  0.04494357109069824
mini_batch_src_global generation:  0.05086493492126465
r_  generation:  0.40592432022094727
local_output_nid generation:  0.028913259506225586
local_in_edges_tensor generation:  0.03371095657348633
mini_batch_src_global generation:  0.04756808280944824
r_  generation:  0.4077427387237549
local_output_nid generation:  0.028830766677856445
local_in_edges_tensor generation:  0.034529685974121094
mini_batch_src_global generation:  0.0477449893951416
r_  generation:  0.40995097160339355
local_output_nid generation:  0.028469085693359375
local_in_edges_tensor generation:  0.028865337371826172
mini_batch_src_global generation:  0.04832768440246582
r_  generation:  0.4094095230102539
local_output_nid generation:  0.028305530548095703
local_in_edges_tensor generation:  0.030637025833129883
mini_batch_src_global generation:  0.047464847564697266
r_  generation:  0.4321572780609131
local_output_nid generation:  0.028337717056274414
local_in_edges_tensor generation:  0.02658224105834961
mini_batch_src_global generation:  0.0480804443359375
r_  generation:  0.4094209671020508
local_output_nid generation:  0.028725147247314453
local_in_edges_tensor generation:  0.03243756294250488
mini_batch_src_global generation:  0.05187726020812988
r_  generation:  0.4185936450958252
local_output_nid generation:  0.02842235565185547
local_in_edges_tensor generation:  0.028790712356567383
mini_batch_src_global generation:  0.052315711975097656
r_  generation:  0.4159705638885498
local_output_nid generation:  0.02894878387451172
local_in_edges_tensor generation:  0.03825259208679199
mini_batch_src_global generation:  0.05415177345275879
r_  generation:  0.4429442882537842
local_output_nid generation:  0.032624244689941406
local_in_edges_tensor generation:  0.035767555236816406
mini_batch_src_global generation:  0.04961085319519043
r_  generation:  0.41734886169433594
local_output_nid generation:  0.028205156326293945
local_in_edges_tensor generation:  0.029240846633911133
mini_batch_src_global generation:  0.04712963104248047
r_  generation:  0.40013766288757324
local_output_nid generation:  0.0281674861907959
local_in_edges_tensor generation:  0.028838157653808594
mini_batch_src_global generation:  0.04804420471191406
r_  generation:  0.4075460433959961
local_output_nid generation:  0.028627395629882812
local_in_edges_tensor generation:  0.036232948303222656
mini_batch_src_global generation:  0.04797625541687012
r_  generation:  0.41766810417175293
local_output_nid generation:  0.03021836280822754
local_in_edges_tensor generation:  0.028278827667236328
mini_batch_src_global generation:  0.04841184616088867
r_  generation:  0.4082906246185303
local_output_nid generation:  0.028657913208007812
local_in_edges_tensor generation:  0.029029130935668945
mini_batch_src_global generation:  0.05074644088745117
r_  generation:  0.4151289463043213
local_output_nid generation:  0.028959274291992188
local_in_edges_tensor generation:  0.02910137176513672
mini_batch_src_global generation:  0.04873299598693848
r_  generation:  0.41933393478393555
local_output_nid generation:  0.028798341751098633
local_in_edges_tensor generation:  0.0332643985748291
mini_batch_src_global generation:  0.05130410194396973
r_  generation:  0.4339020252227783
local_output_nid generation:  0.028625965118408203
local_in_edges_tensor generation:  0.025629758834838867
mini_batch_src_global generation:  0.04890751838684082
r_  generation:  0.41800689697265625
local_output_nid generation:  0.02874279022216797
local_in_edges_tensor generation:  0.025239944458007812
mini_batch_src_global generation:  0.048674821853637695
r_  generation:  0.4229733943939209
local_output_nid generation:  0.02886033058166504
local_in_edges_tensor generation:  0.03222799301147461
mini_batch_src_global generation:  0.05144977569580078
r_  generation:  0.4175543785095215
local_output_nid generation:  0.029070377349853516
local_in_edges_tensor generation:  0.029250383377075195
mini_batch_src_global generation:  0.04885053634643555
r_  generation:  0.4228994846343994
local_output_nid generation:  0.029505252838134766
local_in_edges_tensor generation:  0.027587175369262695
mini_batch_src_global generation:  0.04995870590209961
r_  generation:  0.4143505096435547
local_output_nid generation:  0.02844405174255371
local_in_edges_tensor generation:  0.031014680862426758
mini_batch_src_global generation:  0.04797530174255371
r_  generation:  0.41577696800231934
local_output_nid generation:  0.029639244079589844
local_in_edges_tensor generation:  0.03338193893432617
mini_batch_src_global generation:  0.05057191848754883
r_  generation:  0.4316139221191406
local_output_nid generation:  0.02957892417907715
local_in_edges_tensor generation:  0.03690338134765625
mini_batch_src_global generation:  0.05143928527832031
r_  generation:  0.4175913333892822
local_output_nid generation:  0.02862548828125
local_in_edges_tensor generation:  0.03127622604370117
mini_batch_src_global generation:  0.04879331588745117
r_  generation:  0.4136173725128174
local_output_nid generation:  0.028585433959960938
local_in_edges_tensor generation:  0.028473615646362305
mini_batch_src_global generation:  0.05042767524719238
r_  generation:  0.41597795486450195
local_output_nid generation:  0.028536319732666016
local_in_edges_tensor generation:  0.029541969299316406
mini_batch_src_global generation:  0.048334598541259766
r_  generation:  0.4166262149810791
local_output_nid generation:  0.02870321273803711
local_in_edges_tensor generation:  0.03261828422546387
mini_batch_src_global generation:  0.04783320426940918
r_  generation:  0.41935038566589355
local_output_nid generation:  0.028375625610351562
local_in_edges_tensor generation:  0.025323867797851562
mini_batch_src_global generation:  0.04905819892883301
r_  generation:  0.41132235527038574
----------------------check_connections_block total spend ----------------------------- 19.73616075515747
generate_one_block  0.5579228401184082
generate_one_block  0.5485551357269287
generate_one_block  0.552147388458252
generate_one_block  0.555304765701294
generate_one_block  0.6553707122802734
generate_one_block  0.5448436737060547
generate_one_block  0.5463817119598389
generate_one_block  0.5462477207183838
generate_one_block  0.5496344566345215
generate_one_block  0.5609707832336426
generate_one_block  0.5675697326660156
generate_one_block  0.5548861026763916
generate_one_block  0.5337233543395996
generate_one_block  0.5375313758850098
generate_one_block  0.5610222816467285
generate_one_block  0.5396907329559326
generate_one_block  0.5562231540679932
generate_one_block  0.5657219886779785
generate_one_block  0.5643796920776367
generate_one_block  0.5448577404022217
generate_one_block  0.5505120754241943
generate_one_block  0.5619468688964844
generate_one_block  0.5626339912414551
generate_one_block  0.5471963882446289
generate_one_block  0.5677902698516846
generate_one_block  0.5589685440063477
generate_one_block  0.5486257076263428
generate_one_block  0.5505928993225098
generate_one_block  0.5568323135375977
generate_one_block  0.5558567047119141
generate_one_block  0.5599839687347412
generate_one_block  0.5404534339904785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.12282752990722656  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

connection checking time:  27.5590763092041
block generation total time  24.51101064682007
average batch blocks generation time:  0.7659690827131271
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.1052093505859375  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.75217866897583  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.10448837280273438  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.596211910247803  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.10531139373779297  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.198723793029785  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.10459232330322266  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.800561904907227  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.1053156852722168  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.19968318939209  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.10461568832397461  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.938201904296875  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.1052389144897461  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.905455112457275  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.1043539047241211  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.655458450317383  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.10520172119140625  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 16.713733673095703  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.10474920272827148  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 17.098625659942627  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.10530853271484375  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 17.286486625671387  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10485410690307617  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 17.071526050567627  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10506534576416016  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 15.944981575012207  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.1042776107788086  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.245017528533936  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10534334182739258  GigaBytes
Max Memory Allocated: 17.386358737945557  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 17.360732555389404  GigaBytes
Max Memory Allocated: 17.39702796936035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10449504852294922  GigaBytes
Max Memory Allocated: 17.39702796936035  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.299009799957275  GigaBytes
Max Memory Allocated: 17.39702796936035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10521221160888672  GigaBytes
Max Memory Allocated: 17.39702796936035  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.7729434967041  GigaBytes
Max Memory Allocated: 17.39702796936035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10493183135986328  GigaBytes
Max Memory Allocated: 17.39702796936035  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.92477798461914  GigaBytes
Max Memory Allocated: 17.39702796936035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10534381866455078  GigaBytes
Max Memory Allocated: 17.39702796936035  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 17.39481830596924  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10475349426269531  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.896179676055908  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10527753829956055  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 17.061063289642334  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10465335845947266  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 17.219982624053955  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.1053166389465332  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 17.305626392364502  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10470151901245117  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.783751010894775  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10524272918701172  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.958529472351074  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10473823547363281  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.993783473968506  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10528707504272461  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 17.124385356903076  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10429763793945312  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.89381170272827  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10526132583618164  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 17.054466724395752  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.1046605110168457  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 17.112891674041748  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10531234741210938  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 17.26152801513672  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.1046609878540039  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.678724765777588  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034592822194099426 |0.01635187864303589 |0.42009542882442474 |9.58666205406189e-05 |0.7592413127422333 |0.0074825286865234375 |
----------------------------------------------------------pseudo_mini_loss sum 3.961577892303467
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8789220
Number of first layer input nodes during this epoch:  4679105
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.12246370315551758  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0258331298828125
random selection method range initialization spend 0.005108833312988281
time for parepare:  0.020636796951293945
local_output_nid generation:  0.0013020038604736328
local_in_edges_tensor generation:  0.006656169891357422
mini_batch_src_global generation:  0.0017476081848144531
r_  generation:  0.010635137557983398
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.0011322498321533203
mini_batch_src_global generation:  0.0018246173858642578
r_  generation:  0.010404109954833984
local_output_nid generation:  0.0016324520111083984
local_in_edges_tensor generation:  0.0010492801666259766
mini_batch_src_global generation:  0.0011870861053466797
r_  generation:  0.0093841552734375
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0009918212890625
mini_batch_src_global generation:  0.0011403560638427734
r_  generation:  0.009673357009887695
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0009396076202392578
mini_batch_src_global generation:  0.0011577606201171875
r_  generation:  0.009570121765136719
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0009214878082275391
mini_batch_src_global generation:  0.0011489391326904297
r_  generation:  0.010280370712280273
local_output_nid generation:  0.0016231536865234375
local_in_edges_tensor generation:  0.0009553432464599609
mini_batch_src_global generation:  0.0011970996856689453
r_  generation:  0.010054588317871094
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.009922266006469727
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0009975433349609375
mini_batch_src_global generation:  0.0011518001556396484
r_  generation:  0.010220766067504883
local_output_nid generation:  0.0016279220581054688
local_in_edges_tensor generation:  0.0009675025939941406
mini_batch_src_global generation:  0.001180887222290039
r_  generation:  0.010473489761352539
local_output_nid generation:  0.0016286373138427734
local_in_edges_tensor generation:  0.000873565673828125
mini_batch_src_global generation:  0.0011072158813476562
r_  generation:  0.009942293167114258
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.0012199878692626953
r_  generation:  0.009896039962768555
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.0008988380432128906
mini_batch_src_global generation:  0.0011739730834960938
r_  generation:  0.01048898696899414
local_output_nid generation:  0.0015845298767089844
local_in_edges_tensor generation:  0.0008976459503173828
mini_batch_src_global generation:  0.0012547969818115234
r_  generation:  0.010502815246582031
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0009298324584960938
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.010165691375732422
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0009174346923828125
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.010175943374633789
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.001176595687866211
r_  generation:  0.010345220565795898
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.0011882781982421875
r_  generation:  0.01052713394165039
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0009493827819824219
mini_batch_src_global generation:  0.0011997222900390625
r_  generation:  0.010159730911254883
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0008854866027832031
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.00998234748840332
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.0008971691131591797
mini_batch_src_global generation:  0.0012402534484863281
r_  generation:  0.010362863540649414
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0009334087371826172
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.010341882705688477
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.0011436939239501953
r_  generation:  0.010221481323242188
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0008785724639892578
mini_batch_src_global generation:  0.0011408329010009766
r_  generation:  0.010189533233642578
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.0011832714080810547
r_  generation:  0.010274887084960938
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.000904083251953125
mini_batch_src_global generation:  0.001251220703125
r_  generation:  0.010045051574707031
local_output_nid generation:  0.0015990734100341797
local_in_edges_tensor generation:  0.0008594989776611328
mini_batch_src_global generation:  0.0011594295501708984
r_  generation:  0.0102081298828125
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0008687973022460938
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.010144472122192383
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.001247406005859375
r_  generation:  0.010599613189697266
local_output_nid generation:  0.001598358154296875
local_in_edges_tensor generation:  0.0008416175842285156
mini_batch_src_global generation:  0.0011467933654785156
r_  generation:  0.009984493255615234
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0008883476257324219
mini_batch_src_global generation:  0.0011894702911376953
r_  generation:  0.010312795639038086
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.0011889934539794922
r_  generation:  0.010403156280517578
----------------------check_connections_block total spend ----------------------------- 0.5650608539581299
generate_one_block  0.02355217933654785
generate_one_block  0.020719051361083984
generate_one_block  0.017293930053710938
generate_one_block  0.01730179786682129
generate_one_block  0.01713275909423828
generate_one_block  0.017846107482910156
generate_one_block  0.017263174057006836
generate_one_block  0.01702427864074707
generate_one_block  0.01762533187866211
generate_one_block  0.01769876480102539
generate_one_block  0.016942977905273438
generate_one_block  0.017006874084472656
generate_one_block  0.01778244972229004
generate_one_block  0.017765283584594727
generate_one_block  0.01724100112915039
generate_one_block  0.017319679260253906
generate_one_block  0.01731562614440918
generate_one_block  0.017670154571533203
generate_one_block  0.016972780227661133
generate_one_block  0.01693272590637207
generate_one_block  0.01755356788635254
generate_one_block  0.017496347427368164
generate_one_block  0.01697683334350586
generate_one_block  0.017092466354370117
generate_one_block  0.01715850830078125
generate_one_block  0.016729116439819336
generate_one_block  0.017136335372924805
generate_one_block  0.01706099510192871
generate_one_block  0.017696142196655273
generate_one_block  0.016714096069335938
generate_one_block  0.017276287078857422
generate_one_block  0.01738905906677246
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03447246551513672
gen group dst list time:  0.023111820220947266
time for parepare:  0.019558191299438477
local_output_nid generation:  0.006148338317871094
local_in_edges_tensor generation:  0.01822376251220703
mini_batch_src_global generation:  0.01414799690246582
r_  generation:  0.13561367988586426
local_output_nid generation:  0.008884429931640625
local_in_edges_tensor generation:  0.012248039245605469
mini_batch_src_global generation:  0.017154216766357422
r_  generation:  0.18325233459472656
local_output_nid generation:  0.008441925048828125
local_in_edges_tensor generation:  0.03258657455444336
mini_batch_src_global generation:  0.015867948532104492
r_  generation:  0.14287996292114258
local_output_nid generation:  0.009179353713989258
local_in_edges_tensor generation:  0.01746654510498047
mini_batch_src_global generation:  0.02091503143310547
r_  generation:  0.15171456336975098
local_output_nid generation:  0.00902867317199707
local_in_edges_tensor generation:  0.008800268173217773
mini_batch_src_global generation:  0.01709270477294922
r_  generation:  0.14902281761169434
local_output_nid generation:  0.009433507919311523
local_in_edges_tensor generation:  0.01119542121887207
mini_batch_src_global generation:  0.0194857120513916
r_  generation:  0.15623927116394043
local_output_nid generation:  0.009066104888916016
local_in_edges_tensor generation:  0.008464336395263672
mini_batch_src_global generation:  0.01812458038330078
r_  generation:  0.1507279872894287
local_output_nid generation:  0.0116729736328125
local_in_edges_tensor generation:  0.008155584335327148
mini_batch_src_global generation:  0.017931461334228516
r_  generation:  0.15549492835998535
local_output_nid generation:  0.009648561477661133
local_in_edges_tensor generation:  0.010122060775756836
mini_batch_src_global generation:  0.018697023391723633
r_  generation:  0.16080665588378906
local_output_nid generation:  0.010187149047851562
local_in_edges_tensor generation:  0.0093231201171875
mini_batch_src_global generation:  0.018648862838745117
r_  generation:  0.15649032592773438
local_output_nid generation:  0.009120941162109375
local_in_edges_tensor generation:  0.008413314819335938
mini_batch_src_global generation:  0.01828479766845703
r_  generation:  0.15230298042297363
local_output_nid generation:  0.009192228317260742
local_in_edges_tensor generation:  0.008437633514404297
mini_batch_src_global generation:  0.01955437660217285
r_  generation:  0.15088653564453125
local_output_nid generation:  0.009464025497436523
local_in_edges_tensor generation:  0.008490562438964844
mini_batch_src_global generation:  0.028182268142700195
r_  generation:  0.16037964820861816
local_output_nid generation:  0.010643720626831055
local_in_edges_tensor generation:  0.01002192497253418
mini_batch_src_global generation:  0.020395278930664062
r_  generation:  0.16347146034240723
local_output_nid generation:  0.009549856185913086
local_in_edges_tensor generation:  0.008486747741699219
mini_batch_src_global generation:  0.018767833709716797
r_  generation:  0.15605545043945312
local_output_nid generation:  0.009399175643920898
local_in_edges_tensor generation:  0.008533477783203125
mini_batch_src_global generation:  0.019335031509399414
r_  generation:  0.15623021125793457
local_output_nid generation:  0.009314775466918945
local_in_edges_tensor generation:  0.008644580841064453
mini_batch_src_global generation:  0.01827239990234375
r_  generation:  0.15296053886413574
local_output_nid generation:  0.009795188903808594
local_in_edges_tensor generation:  0.008312702178955078
mini_batch_src_global generation:  0.023389101028442383
r_  generation:  0.15657329559326172
local_output_nid generation:  0.009241342544555664
local_in_edges_tensor generation:  0.009078741073608398
mini_batch_src_global generation:  0.018187761306762695
r_  generation:  0.15057110786437988
local_output_nid generation:  0.009251832962036133
local_in_edges_tensor generation:  0.008418083190917969
mini_batch_src_global generation:  0.01854681968688965
r_  generation:  0.15218019485473633
local_output_nid generation:  0.009678125381469727
local_in_edges_tensor generation:  0.00982666015625
mini_batch_src_global generation:  0.018754959106445312
r_  generation:  0.15851736068725586
local_output_nid generation:  0.009474754333496094
local_in_edges_tensor generation:  0.01039576530456543
mini_batch_src_global generation:  0.019695758819580078
r_  generation:  0.15828537940979004
local_output_nid generation:  0.009500265121459961
local_in_edges_tensor generation:  0.008350372314453125
mini_batch_src_global generation:  0.018716812133789062
r_  generation:  0.15528655052185059
local_output_nid generation:  0.009398937225341797
local_in_edges_tensor generation:  0.008664131164550781
mini_batch_src_global generation:  0.01877307891845703
r_  generation:  0.15367650985717773
local_output_nid generation:  0.00947713851928711
local_in_edges_tensor generation:  0.009008646011352539
mini_batch_src_global generation:  0.018503904342651367
r_  generation:  0.1553182601928711
local_output_nid generation:  0.009163618087768555
local_in_edges_tensor generation:  0.008193731307983398
mini_batch_src_global generation:  0.018144845962524414
r_  generation:  0.14934587478637695
local_output_nid generation:  0.009392261505126953
local_in_edges_tensor generation:  0.00844573974609375
mini_batch_src_global generation:  0.018520116806030273
r_  generation:  0.15479516983032227
local_output_nid generation:  0.00944828987121582
local_in_edges_tensor generation:  0.010323762893676758
mini_batch_src_global generation:  0.01887798309326172
r_  generation:  0.15418434143066406
local_output_nid generation:  0.009568214416503906
local_in_edges_tensor generation:  0.009954690933227539
mini_batch_src_global generation:  0.019356250762939453
r_  generation:  0.16101408004760742
local_output_nid generation:  0.009063005447387695
local_in_edges_tensor generation:  0.008479833602905273
mini_batch_src_global generation:  0.018855571746826172
r_  generation:  0.15142035484313965
local_output_nid generation:  0.009172439575195312
local_in_edges_tensor generation:  0.008662700653076172
mini_batch_src_global generation:  0.01864004135131836
r_  generation:  0.1601848602294922
local_output_nid generation:  0.009226322174072266
local_in_edges_tensor generation:  0.009580850601196289
mini_batch_src_global generation:  0.01879429817199707
r_  generation:  0.15741443634033203
----------------------check_connections_block total spend ----------------------------- 7.349542140960693
generate_one_block  0.2155132293701172
generate_one_block  0.19887590408325195
generate_one_block  0.19064569473266602
generate_one_block  0.19726252555847168
generate_one_block  0.2281200885772705
generate_one_block  0.20983028411865234
generate_one_block  0.1967918872833252
generate_one_block  0.19407415390014648
generate_one_block  0.20761394500732422
generate_one_block  0.2016913890838623
generate_one_block  0.1981039047241211
generate_one_block  0.19469332695007324
generate_one_block  0.20973992347717285
generate_one_block  0.21005558967590332
generate_one_block  0.20394039154052734
generate_one_block  0.20520853996276855
generate_one_block  0.200333833694458
generate_one_block  0.20373106002807617
generate_one_block  0.19519352912902832
generate_one_block  0.20240330696105957
generate_one_block  0.20793890953063965
generate_one_block  0.2074294090270996
generate_one_block  0.19831299781799316
generate_one_block  0.20301079750061035
generate_one_block  0.20055294036865234
generate_one_block  0.19418573379516602
generate_one_block  0.20317316055297852
generate_one_block  0.20473694801330566
generate_one_block  0.21357965469360352
generate_one_block  0.1969928741455078
generate_one_block  0.20396780967712402
generate_one_block  0.20397686958312988
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.044844865798950195
gen group dst list time:  0.10805892944335938
time for parepare:  0.019795894622802734
local_output_nid generation:  0.025382518768310547
local_in_edges_tensor generation:  0.04908013343811035
mini_batch_src_global generation:  0.03714609146118164
r_  generation:  0.40247249603271484
local_output_nid generation:  0.029573440551757812
local_in_edges_tensor generation:  0.03244757652282715
mini_batch_src_global generation:  0.04807019233703613
r_  generation:  0.3993368148803711
local_output_nid generation:  0.028529644012451172
local_in_edges_tensor generation:  0.02785944938659668
mini_batch_src_global generation:  0.047513723373413086
r_  generation:  0.4076042175292969
local_output_nid generation:  0.028030872344970703
local_in_edges_tensor generation:  0.027903318405151367
mini_batch_src_global generation:  0.05010271072387695
r_  generation:  0.41808152198791504
local_output_nid generation:  0.02785181999206543
local_in_edges_tensor generation:  0.026053428649902344
mini_batch_src_global generation:  0.047740936279296875
r_  generation:  0.4162271022796631
local_output_nid generation:  0.028609275817871094
local_in_edges_tensor generation:  0.02809429168701172
mini_batch_src_global generation:  0.04997611045837402
r_  generation:  0.4161503314971924
local_output_nid generation:  0.028319358825683594
local_in_edges_tensor generation:  0.03100299835205078
mini_batch_src_global generation:  0.059246063232421875
r_  generation:  0.4190654754638672
local_output_nid generation:  0.027850866317749023
local_in_edges_tensor generation:  0.03583478927612305
mini_batch_src_global generation:  0.04921388626098633
r_  generation:  0.4087347984313965
local_output_nid generation:  0.028691530227661133
local_in_edges_tensor generation:  0.028043031692504883
mini_batch_src_global generation:  0.05017590522766113
r_  generation:  0.41908931732177734
local_output_nid generation:  0.02830028533935547
local_in_edges_tensor generation:  0.027905702590942383
mini_batch_src_global generation:  0.04976630210876465
r_  generation:  0.4139411449432373
local_output_nid generation:  0.028092622756958008
local_in_edges_tensor generation:  0.029683351516723633
mini_batch_src_global generation:  0.04807281494140625
r_  generation:  0.4198880195617676
local_output_nid generation:  0.028764009475708008
local_in_edges_tensor generation:  0.027991771697998047
mini_batch_src_global generation:  0.04915261268615723
r_  generation:  0.40935468673706055
local_output_nid generation:  0.02849125862121582
local_in_edges_tensor generation:  0.02802300453186035
mini_batch_src_global generation:  0.04852151870727539
r_  generation:  0.4197070598602295
local_output_nid generation:  0.02868056297302246
local_in_edges_tensor generation:  0.030945539474487305
mini_batch_src_global generation:  0.05014657974243164
r_  generation:  0.41596364974975586
local_output_nid generation:  0.028078317642211914
local_in_edges_tensor generation:  0.028403043746948242
mini_batch_src_global generation:  0.048035621643066406
r_  generation:  0.42177271842956543
local_output_nid generation:  0.0291135311126709
local_in_edges_tensor generation:  0.0282285213470459
mini_batch_src_global generation:  0.049631595611572266
r_  generation:  0.4279167652130127
local_output_nid generation:  0.030055761337280273
local_in_edges_tensor generation:  0.02784442901611328
mini_batch_src_global generation:  0.04865741729736328
r_  generation:  0.42508888244628906
local_output_nid generation:  0.029376745223999023
local_in_edges_tensor generation:  0.028478384017944336
mini_batch_src_global generation:  0.05134916305541992
r_  generation:  0.4138350486755371
local_output_nid generation:  0.028716564178466797
local_in_edges_tensor generation:  0.0260467529296875
mini_batch_src_global generation:  0.049993276596069336
r_  generation:  0.4171295166015625
local_output_nid generation:  0.02845907211303711
local_in_edges_tensor generation:  0.027647733688354492
mini_batch_src_global generation:  0.053067684173583984
r_  generation:  0.4130709171295166
local_output_nid generation:  0.028718233108520508
local_in_edges_tensor generation:  0.02743244171142578
mini_batch_src_global generation:  0.05193924903869629
r_  generation:  0.43123292922973633
local_output_nid generation:  0.028909683227539062
local_in_edges_tensor generation:  0.02670741081237793
mini_batch_src_global generation:  0.051828622817993164
r_  generation:  0.41802358627319336
local_output_nid generation:  0.028956174850463867
local_in_edges_tensor generation:  0.02865886688232422
mini_batch_src_global generation:  0.05423426628112793
r_  generation:  0.4260380268096924
local_output_nid generation:  0.028962135314941406
local_in_edges_tensor generation:  0.029679059982299805
mini_batch_src_global generation:  0.04999184608459473
r_  generation:  0.41852450370788574
local_output_nid generation:  0.02875971794128418
local_in_edges_tensor generation:  0.026056289672851562
mini_batch_src_global generation:  0.04806971549987793
r_  generation:  0.41878628730773926
local_output_nid generation:  0.028402328491210938
local_in_edges_tensor generation:  0.02992558479309082
mini_batch_src_global generation:  0.050057172775268555
r_  generation:  0.4119100570678711
local_output_nid generation:  0.028782129287719727
local_in_edges_tensor generation:  0.028120040893554688
mini_batch_src_global generation:  0.049991607666015625
r_  generation:  0.4188368320465088
local_output_nid generation:  0.028782367706298828
local_in_edges_tensor generation:  0.027425527572631836
mini_batch_src_global generation:  0.04948091506958008
r_  generation:  0.4121434688568115
local_output_nid generation:  0.029171466827392578
local_in_edges_tensor generation:  0.03002166748046875
mini_batch_src_global generation:  0.04855489730834961
r_  generation:  0.42627716064453125
local_output_nid generation:  0.028942584991455078
local_in_edges_tensor generation:  0.029238462448120117
mini_batch_src_global generation:  0.04969334602355957
r_  generation:  0.4161081314086914
local_output_nid generation:  0.029076099395751953
local_in_edges_tensor generation:  0.028142213821411133
mini_batch_src_global generation:  0.04772329330444336
r_  generation:  0.4232761859893799
local_output_nid generation:  0.029363155364990234
local_in_edges_tensor generation:  0.030640602111816406
mini_batch_src_global generation:  0.049909114837646484
r_  generation:  0.4165165424346924
----------------------check_connections_block total spend ----------------------------- 19.737765789031982
generate_one_block  0.5698225498199463
generate_one_block  0.5508725643157959
generate_one_block  0.5507066249847412
generate_one_block  0.5558764934539795
generate_one_block  0.6541876792907715
generate_one_block  0.5639636516571045
generate_one_block  0.5576484203338623
generate_one_block  0.5490646362304688
generate_one_block  0.5519475936889648
generate_one_block  0.5539298057556152
generate_one_block  0.550978422164917
generate_one_block  0.5443439483642578
generate_one_block  0.557152509689331
generate_one_block  0.5587236881256104
generate_one_block  0.5700490474700928
generate_one_block  0.5519824028015137
generate_one_block  0.5469298362731934
generate_one_block  0.5513854026794434
generate_one_block  0.5437324047088623
generate_one_block  0.5506918430328369
generate_one_block  0.5537159442901611
generate_one_block  0.5641863346099854
generate_one_block  0.5660741329193115
generate_one_block  0.5572738647460938
generate_one_block  0.5644686222076416
generate_one_block  0.5482611656188965
generate_one_block  0.5790605545043945
generate_one_block  0.5631856918334961
generate_one_block  0.5792102813720703
generate_one_block  0.5487082004547119
generate_one_block  0.5599071979522705
generate_one_block  0.5675249099731445
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.12246370315551758  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

connection checking time:  27.087307929992676
block generation total time  24.437247037887573
average batch blocks generation time:  0.7636639699339867
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.1052541732788086  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 17.014934062957764  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.1045069694519043  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.852094650268555  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10514545440673828  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.47453212738037  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10437154769897461  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 16.80113697052002  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 0.10522222518920898  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9940185546875 GB
    Memory Allocated: 16.769197463989258  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10475444793701172  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.267526626586914  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522890090942383  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.880853176116943  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10438680648803711  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.60606336593628  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529518127441406  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.106234550476074  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10477304458618164  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.014750003814697  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522127151489258  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.765002250671387  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10445404052734375  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.561797618865967  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10530757904052734  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.184815883636475  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10486841201782227  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.222468852996826  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526514053344727  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.99345874786377  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10483407974243164  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.07965326309204  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522222518920898  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.746586322784424  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10500240325927734  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.02809429168701  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10518169403076172  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.57733917236328  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10454893112182617  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.68936586380005  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529422760009766  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.107911586761475  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10476303100585938  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.15657615661621  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10521697998046875  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.78545904159546  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.104400634765625  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.951268672943115  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10523223876953125  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.813272953033447  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1044611930847168  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.561440467834473  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10525178909301758  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.952154636383057  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10486364364624023  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.993977069854736  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10532236099243164  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.232533931732178  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10470151901245117  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.696394443511963  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10528278350830078  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.13736915588379  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10488510131835938  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.959408283233643  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030989520251750946 |0.014433182775974274 |0.4199998751282692 |9.387731552124023e-05 |0.7577861547470093 |0.006479978561401367 |
----------------------------------------------------------pseudo_mini_loss sum 3.4843356609344482
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  8792123
Number of first layer input nodes during this epoch:  4679585
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12349557876586914  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025218963623046875
random selection method range initialization spend 0.00590825080871582
time for parepare:  0.02052783966064453
local_output_nid generation:  0.001360177993774414
local_in_edges_tensor generation:  0.006657600402832031
mini_batch_src_global generation:  0.0017845630645751953
r_  generation:  0.010471343994140625
local_output_nid generation:  0.0016283988952636719
local_in_edges_tensor generation:  0.0010514259338378906
mini_batch_src_global generation:  0.0015590190887451172
r_  generation:  0.01030278205871582
local_output_nid generation:  0.001621246337890625
local_in_edges_tensor generation:  0.0009777545928955078
mini_batch_src_global generation:  0.0012202262878417969
r_  generation:  0.009850025177001953
local_output_nid generation:  0.0016057491302490234
local_in_edges_tensor generation:  0.0009629726409912109
mini_batch_src_global generation:  0.0012006759643554688
r_  generation:  0.01007699966430664
local_output_nid generation:  0.0015988349914550781
local_in_edges_tensor generation:  0.0009186267852783203
mini_batch_src_global generation:  0.0011186599731445312
r_  generation:  0.009856700897216797
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0009171962738037109
mini_batch_src_global generation:  0.001165628433227539
r_  generation:  0.010128974914550781
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.001094818115234375
r_  generation:  0.009919404983520508
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0011718273162841797
r_  generation:  0.010061979293823242
local_output_nid generation:  0.0015816688537597656
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.010288238525390625
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0008704662322998047
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.010333776473999023
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.0008718967437744141
mini_batch_src_global generation:  0.0011110305786132812
r_  generation:  0.009974956512451172
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0009024143218994141
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.01024317741394043
local_output_nid generation:  0.0015697479248046875
local_in_edges_tensor generation:  0.0009295940399169922
mini_batch_src_global generation:  0.0011870861053466797
r_  generation:  0.010604143142700195
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.009750843048095703
local_output_nid generation:  0.0015850067138671875
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.001188516616821289
r_  generation:  0.010463714599609375
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0009000301361083984
mini_batch_src_global generation:  0.0011982917785644531
r_  generation:  0.010365486145019531
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.0008795261383056641
mini_batch_src_global generation:  0.0011589527130126953
r_  generation:  0.010106563568115234
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.0011250972747802734
r_  generation:  0.01017618179321289
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0009052753448486328
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.010245561599731445
local_output_nid generation:  0.0015861988067626953
local_in_edges_tensor generation:  0.0008733272552490234
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.00976109504699707
local_output_nid generation:  0.0016024112701416016
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0011568069458007812
r_  generation:  0.010701417922973633
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0008862018585205078
mini_batch_src_global generation:  0.0011708736419677734
r_  generation:  0.010406970977783203
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0008783340454101562
mini_batch_src_global generation:  0.0011277198791503906
r_  generation:  0.010399818420410156
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.01001286506652832
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.00087738037109375
mini_batch_src_global generation:  0.001146554946899414
r_  generation:  0.010491132736206055
local_output_nid generation:  0.0015978813171386719
local_in_edges_tensor generation:  0.0008797645568847656
mini_batch_src_global generation:  0.0011141300201416016
r_  generation:  0.01000070571899414
local_output_nid generation:  0.001596689224243164
local_in_edges_tensor generation:  0.0008857250213623047
mini_batch_src_global generation:  0.0011703968048095703
r_  generation:  0.010332584381103516
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0008666515350341797
mini_batch_src_global generation:  0.0011413097381591797
r_  generation:  0.01012277603149414
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0008575916290283203
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.01019597053527832
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.0011870861053466797
r_  generation:  0.010103464126586914
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0008883476257324219
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.010423660278320312
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0008566379547119141
mini_batch_src_global generation:  0.001104593276977539
r_  generation:  0.01014089584350586
----------------------check_connections_block total spend ----------------------------- 0.5642399787902832
generate_one_block  0.019509553909301758
generate_one_block  0.02053666114807129
generate_one_block  0.018112897872924805
generate_one_block  0.020841121673583984
generate_one_block  0.017651796340942383
generate_one_block  0.017861366271972656
generate_one_block  0.0173037052154541
generate_one_block  0.017588376998901367
generate_one_block  0.017656803131103516
generate_one_block  0.017699480056762695
generate_one_block  0.01689600944519043
generate_one_block  0.0175015926361084
generate_one_block  0.01797962188720703
generate_one_block  0.016519784927368164
generate_one_block  0.017629623413085938
generate_one_block  0.017543554306030273
generate_one_block  0.01706981658935547
generate_one_block  0.017198562622070312
generate_one_block  0.01743769645690918
generate_one_block  0.016546249389648438
generate_one_block  0.017838716506958008
generate_one_block  0.01745891571044922
generate_one_block  0.017266035079956055
generate_one_block  0.01702427864074707
generate_one_block  0.017496347427368164
generate_one_block  0.016852140426635742
generate_one_block  0.01725912094116211
generate_one_block  0.017191410064697266
generate_one_block  0.01702284812927246
generate_one_block  0.016712188720703125
generate_one_block  0.017379045486450195
generate_one_block  0.016968727111816406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039457082748413086
gen group dst list time:  0.02322840690612793
time for parepare:  0.020073413848876953
local_output_nid generation:  0.006097316741943359
local_in_edges_tensor generation:  0.0197603702545166
mini_batch_src_global generation:  0.013971328735351562
r_  generation:  0.1330859661102295
local_output_nid generation:  0.008569002151489258
local_in_edges_tensor generation:  0.010721445083618164
mini_batch_src_global generation:  0.01661515235900879
r_  generation:  0.1393136978149414
local_output_nid generation:  0.009072303771972656
local_in_edges_tensor generation:  0.030428409576416016
mini_batch_src_global generation:  0.015767812728881836
r_  generation:  0.14584994316101074
local_output_nid generation:  0.00947260856628418
local_in_edges_tensor generation:  0.008925914764404297
mini_batch_src_global generation:  0.016733646392822266
r_  generation:  0.15022611618041992
local_output_nid generation:  0.00923466682434082
local_in_edges_tensor generation:  0.008372783660888672
mini_batch_src_global generation:  0.017559289932250977
r_  generation:  0.1514894962310791
local_output_nid generation:  0.009527206420898438
local_in_edges_tensor generation:  0.009005546569824219
mini_batch_src_global generation:  0.01804327964782715
r_  generation:  0.1515648365020752
local_output_nid generation:  0.008739233016967773
local_in_edges_tensor generation:  0.008458852767944336
mini_batch_src_global generation:  0.018036603927612305
r_  generation:  0.15218591690063477
local_output_nid generation:  0.008963346481323242
local_in_edges_tensor generation:  0.008443355560302734
mini_batch_src_global generation:  0.0186002254486084
r_  generation:  0.1543586254119873
local_output_nid generation:  0.00892782211303711
local_in_edges_tensor generation:  0.008584022521972656
mini_batch_src_global generation:  0.022231578826904297
r_  generation:  0.15368032455444336
local_output_nid generation:  0.009450435638427734
local_in_edges_tensor generation:  0.008419513702392578
mini_batch_src_global generation:  0.01907205581665039
r_  generation:  0.1558067798614502
local_output_nid generation:  0.009166240692138672
local_in_edges_tensor generation:  0.008922100067138672
mini_batch_src_global generation:  0.017754554748535156
r_  generation:  0.14900827407836914
local_output_nid generation:  0.009196758270263672
local_in_edges_tensor generation:  0.008611202239990234
mini_batch_src_global generation:  0.018320322036743164
r_  generation:  0.1535961627960205
local_output_nid generation:  0.009565114974975586
local_in_edges_tensor generation:  0.009186506271362305
mini_batch_src_global generation:  0.02009129524230957
r_  generation:  0.16164064407348633
local_output_nid generation:  0.008893966674804688
local_in_edges_tensor generation:  0.008213996887207031
mini_batch_src_global generation:  0.01818084716796875
r_  generation:  0.14772677421569824
local_output_nid generation:  0.009444952011108398
local_in_edges_tensor generation:  0.008468866348266602
mini_batch_src_global generation:  0.018347740173339844
r_  generation:  0.15682673454284668
local_output_nid generation:  0.009420156478881836
local_in_edges_tensor generation:  0.009022235870361328
mini_batch_src_global generation:  0.018898725509643555
r_  generation:  0.15648651123046875
local_output_nid generation:  0.0091552734375
local_in_edges_tensor generation:  0.008354663848876953
mini_batch_src_global generation:  0.018503189086914062
r_  generation:  0.1560971736907959
local_output_nid generation:  0.009160995483398438
local_in_edges_tensor generation:  0.008983135223388672
mini_batch_src_global generation:  0.0189971923828125
r_  generation:  0.1540207862854004
local_output_nid generation:  0.009294748306274414
local_in_edges_tensor generation:  0.00857090950012207
mini_batch_src_global generation:  0.018496036529541016
r_  generation:  0.1566023826599121
local_output_nid generation:  0.008969783782958984
local_in_edges_tensor generation:  0.008153915405273438
mini_batch_src_global generation:  0.01810765266418457
r_  generation:  0.14723896980285645
local_output_nid generation:  0.009426593780517578
local_in_edges_tensor generation:  0.00915074348449707
mini_batch_src_global generation:  0.019974470138549805
r_  generation:  0.16045522689819336
local_output_nid generation:  0.009474515914916992
local_in_edges_tensor generation:  0.009045839309692383
mini_batch_src_global generation:  0.019435644149780273
r_  generation:  0.1591203212738037
local_output_nid generation:  0.00934147834777832
local_in_edges_tensor generation:  0.008221149444580078
mini_batch_src_global generation:  0.018367767333984375
r_  generation:  0.15387606620788574
local_output_nid generation:  0.009201765060424805
local_in_edges_tensor generation:  0.008359670639038086
mini_batch_src_global generation:  0.018451213836669922
r_  generation:  0.14927172660827637
local_output_nid generation:  0.00948643684387207
local_in_edges_tensor generation:  0.00911855697631836
mini_batch_src_global generation:  0.01943039894104004
r_  generation:  0.15871286392211914
local_output_nid generation:  0.00912022590637207
local_in_edges_tensor generation:  0.008836746215820312
mini_batch_src_global generation:  0.019294023513793945
r_  generation:  0.1507551670074463
local_output_nid generation:  0.00920414924621582
local_in_edges_tensor generation:  0.008529901504516602
mini_batch_src_global generation:  0.018529653549194336
r_  generation:  0.15635299682617188
local_output_nid generation:  0.00922083854675293
local_in_edges_tensor generation:  0.008357524871826172
mini_batch_src_global generation:  0.01874995231628418
r_  generation:  0.15309739112854004
local_output_nid generation:  0.00926661491394043
local_in_edges_tensor generation:  0.009217262268066406
mini_batch_src_global generation:  0.019059181213378906
r_  generation:  0.15505719184875488
local_output_nid generation:  0.00911855697631836
local_in_edges_tensor generation:  0.008266687393188477
mini_batch_src_global generation:  0.018395662307739258
r_  generation:  0.15331101417541504
local_output_nid generation:  0.009395360946655273
local_in_edges_tensor generation:  0.009040117263793945
mini_batch_src_global generation:  0.01902461051940918
r_  generation:  0.15715408325195312
local_output_nid generation:  0.009180068969726562
local_in_edges_tensor generation:  0.008489370346069336
mini_batch_src_global generation:  0.01863694190979004
r_  generation:  0.15093493461608887
----------------------check_connections_block total spend ----------------------------- 7.2128565311431885
generate_one_block  0.2050485610961914
generate_one_block  0.19402241706848145
generate_one_block  0.1994922161102295
generate_one_block  0.20322299003601074
generate_one_block  0.22690892219543457
generate_one_block  0.20191407203674316
generate_one_block  0.20181989669799805
generate_one_block  0.20466995239257812
generate_one_block  0.20120668411254883
generate_one_block  0.20512080192565918
generate_one_block  0.19303655624389648
generate_one_block  0.20084571838378906
generate_one_block  0.2124004364013672
generate_one_block  0.19054222106933594
generate_one_block  0.2015819549560547
generate_one_block  0.2050156593322754
generate_one_block  0.19919753074645996
generate_one_block  0.20069289207458496
generate_one_block  0.2025599479675293
generate_one_block  0.19552302360534668
generate_one_block  0.2102820873260498
generate_one_block  0.2065119743347168
generate_one_block  0.19867634773254395
generate_one_block  0.19392800331115723
generate_one_block  0.20847344398498535
generate_one_block  0.19699907302856445
generate_one_block  0.20071840286254883
generate_one_block  0.1985163688659668
generate_one_block  0.2014448642730713
generate_one_block  0.19904208183288574
generate_one_block  0.2059488296508789
generate_one_block  0.19632482528686523
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0283968448638916
gen group dst list time:  0.09765887260437012
time for parepare:  0.019789695739746094
local_output_nid generation:  0.0233461856842041
local_in_edges_tensor generation:  0.03543591499328613
mini_batch_src_global generation:  0.03475379943847656
r_  generation:  0.40462470054626465
local_output_nid generation:  0.02930307388305664
local_in_edges_tensor generation:  0.03052687644958496
mini_batch_src_global generation:  0.04704618453979492
r_  generation:  0.4011867046356201
local_output_nid generation:  0.02967977523803711
local_in_edges_tensor generation:  0.028560638427734375
mini_batch_src_global generation:  0.0479273796081543
r_  generation:  0.4142177104949951
local_output_nid generation:  0.028057336807250977
local_in_edges_tensor generation:  0.026565074920654297
mini_batch_src_global generation:  0.04830312728881836
r_  generation:  0.4095592498779297
local_output_nid generation:  0.02773571014404297
local_in_edges_tensor generation:  0.025948286056518555
mini_batch_src_global generation:  0.046999454498291016
r_  generation:  0.41310620307922363
local_output_nid generation:  0.028131723403930664
local_in_edges_tensor generation:  0.029669523239135742
mini_batch_src_global generation:  0.058202266693115234
r_  generation:  0.4128541946411133
local_output_nid generation:  0.027840852737426758
local_in_edges_tensor generation:  0.025989532470703125
mini_batch_src_global generation:  0.04706835746765137
r_  generation:  0.41737842559814453
local_output_nid generation:  0.028078556060791016
local_in_edges_tensor generation:  0.025541305541992188
mini_batch_src_global generation:  0.04908156394958496
r_  generation:  0.4100062847137451
local_output_nid generation:  0.028211355209350586
local_in_edges_tensor generation:  0.027680635452270508
mini_batch_src_global generation:  0.049039363861083984
r_  generation:  0.4205210208892822
local_output_nid generation:  0.028020858764648438
local_in_edges_tensor generation:  0.026622533798217773
mini_batch_src_global generation:  0.04904651641845703
r_  generation:  0.41171836853027344
local_output_nid generation:  0.027850627899169922
local_in_edges_tensor generation:  0.02680349349975586
mini_batch_src_global generation:  0.04721641540527344
r_  generation:  0.41485023498535156
local_output_nid generation:  0.027994394302368164
local_in_edges_tensor generation:  0.02683711051940918
mini_batch_src_global generation:  0.04942011833190918
r_  generation:  0.40985965728759766
local_output_nid generation:  0.02801060676574707
local_in_edges_tensor generation:  0.028243303298950195
mini_batch_src_global generation:  0.04741334915161133
r_  generation:  0.41971349716186523
local_output_nid generation:  0.027543067932128906
local_in_edges_tensor generation:  0.02629256248474121
mini_batch_src_global generation:  0.049143075942993164
r_  generation:  0.4027080535888672
local_output_nid generation:  0.02824711799621582
local_in_edges_tensor generation:  0.026665449142456055
mini_batch_src_global generation:  0.04837512969970703
r_  generation:  0.4199666976928711
local_output_nid generation:  0.027971982955932617
local_in_edges_tensor generation:  0.029893159866333008
mini_batch_src_global generation:  0.04959559440612793
r_  generation:  0.41360020637512207
local_output_nid generation:  0.027927637100219727
local_in_edges_tensor generation:  0.026906490325927734
mini_batch_src_global generation:  0.0478825569152832
r_  generation:  0.4196772575378418
local_output_nid generation:  0.027724027633666992
local_in_edges_tensor generation:  0.026351213455200195
mini_batch_src_global generation:  0.049393653869628906
r_  generation:  0.40960049629211426
local_output_nid generation:  0.028046607971191406
local_in_edges_tensor generation:  0.02568674087524414
mini_batch_src_global generation:  0.0476837158203125
r_  generation:  0.4226539134979248
local_output_nid generation:  0.027843236923217773
local_in_edges_tensor generation:  0.025876998901367188
mini_batch_src_global generation:  0.049709320068359375
r_  generation:  0.4064314365386963
local_output_nid generation:  0.028038501739501953
local_in_edges_tensor generation:  0.02826380729675293
mini_batch_src_global generation:  0.04902005195617676
r_  generation:  0.42206835746765137
local_output_nid generation:  0.0280001163482666
local_in_edges_tensor generation:  0.027206897735595703
mini_batch_src_global generation:  0.0512843132019043
r_  generation:  0.4144723415374756
local_output_nid generation:  0.028147459030151367
local_in_edges_tensor generation:  0.0264589786529541
mini_batch_src_global generation:  0.04743623733520508
r_  generation:  0.4167013168334961
local_output_nid generation:  0.027819395065307617
local_in_edges_tensor generation:  0.02548503875732422
mini_batch_src_global generation:  0.04887056350708008
r_  generation:  0.40959930419921875
local_output_nid generation:  0.027791500091552734
local_in_edges_tensor generation:  0.025688886642456055
mini_batch_src_global generation:  0.04725337028503418
r_  generation:  0.42067551612854004
local_output_nid generation:  0.02797985076904297
local_in_edges_tensor generation:  0.028609275817871094
mini_batch_src_global generation:  0.048761606216430664
r_  generation:  0.41083407402038574
local_output_nid generation:  0.027634859085083008
local_in_edges_tensor generation:  0.02585458755493164
mini_batch_src_global generation:  0.04839634895324707
r_  generation:  0.4168267250061035
local_output_nid generation:  0.027709245681762695
local_in_edges_tensor generation:  0.027127742767333984
mini_batch_src_global generation:  0.048787593841552734
r_  generation:  0.41376781463623047
local_output_nid generation:  0.02762150764465332
local_in_edges_tensor generation:  0.02760791778564453
mini_batch_src_global generation:  0.04739952087402344
r_  generation:  0.4192476272583008
local_output_nid generation:  0.027752399444580078
local_in_edges_tensor generation:  0.03008413314819336
mini_batch_src_global generation:  0.04902935028076172
r_  generation:  0.4126088619232178
local_output_nid generation:  0.028093814849853516
local_in_edges_tensor generation:  0.026108264923095703
mini_batch_src_global generation:  0.04748702049255371
r_  generation:  0.4168562889099121
local_output_nid generation:  0.02803826332092285
local_in_edges_tensor generation:  0.025975465774536133
mini_batch_src_global generation:  0.048844337463378906
r_  generation:  0.41118788719177246
----------------------check_connections_block total spend ----------------------------- 19.498773097991943
generate_one_block  0.5528624057769775
generate_one_block  0.5496516227722168
generate_one_block  0.5536448955535889
generate_one_block  0.5589075088500977
generate_one_block  0.6380259990692139
generate_one_block  0.5551354885101318
generate_one_block  0.5555527210235596
generate_one_block  0.5584821701049805
generate_one_block  0.557682991027832
generate_one_block  0.5573313236236572
generate_one_block  0.5486013889312744
generate_one_block  0.5557229518890381
generate_one_block  0.5611412525177002
generate_one_block  0.5405871868133545
generate_one_block  0.5589189529418945
generate_one_block  0.5544891357421875
generate_one_block  0.5528802871704102
generate_one_block  0.5633463859558105
generate_one_block  0.5622439384460449
generate_one_block  0.5442733764648438
generate_one_block  0.5725648403167725
generate_one_block  0.562640905380249
generate_one_block  0.5505287647247314
generate_one_block  0.5547008514404297
generate_one_block  0.5774405002593994
generate_one_block  0.5534818172454834
generate_one_block  0.5601961612701416
generate_one_block  0.5587172508239746
generate_one_block  0.557335615158081
generate_one_block  0.5557417869567871
generate_one_block  0.5619792938232422
generate_one_block  0.5481953620910645
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12349557876586914  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

connection checking time:  26.711629629135132
block generation total time  24.35469388961792
average batch blocks generation time:  0.76108418405056
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10523605346679688  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.845426082611084  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10467386245727539  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.613675594329834  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10524749755859375  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.953184604644775  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1048588752746582  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.12661123275757  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526180267333984  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.95062017440796  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10519218444824219  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.025573253631592  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10524749755859375  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.99480962753296  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10485553741455078  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.17271327972412  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10525751113891602  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.060242652893066  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10472726821899414  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.195222854614258  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10517024993896484  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.57746458053589  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10446643829345703  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.026753902435303  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10535430908203125  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.35830593109131  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1044611930847168  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.403603076934814  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527896881103516  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.102636337280273  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10475778579711914  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.086541652679443  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10524702072143555  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.004820823669434  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10441875457763672  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.946592330932617  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526418685913086  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.014198780059814  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10440969467163086  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.538795471191406  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10533905029296875  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.295485496520996  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10493850708007812  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.15164804458618  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10523605346679688  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.800689220428467  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10476016998291016  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.656116485595703  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529947280883789  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.148738384246826  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10470962524414062  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.68917226791382  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10524177551269531  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.872369289398193  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10471248626708984  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.79894495010376  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10523319244384766  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.847057342529297  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10476160049438477  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.867340087890625  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526561737060547  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.94212293624878  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10469722747802734  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.648717403411865  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031093448400497437 |0.016478925943374634 |0.4225212410092354 |9.768456220626831e-05 |0.7562139332294464 |0.009346485137939453 |
----------------------------------------------------------pseudo_mini_loss sum 2.7841410636901855
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  8798962
Number of first layer input nodes during this epoch:  4683575
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1226949691772461  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029438257217407227
random selection method range initialization spend 0.006422996520996094
time for parepare:  0.026053905487060547
local_output_nid generation:  0.0018248558044433594
local_in_edges_tensor generation:  0.008479833602905273
mini_batch_src_global generation:  0.004872322082519531
r_  generation:  0.01016378402709961
local_output_nid generation:  0.001828908920288086
local_in_edges_tensor generation:  0.001230001449584961
mini_batch_src_global generation:  0.001760721206665039
r_  generation:  0.012334823608398438
local_output_nid generation:  0.0018613338470458984
local_in_edges_tensor generation:  0.0011894702911376953
mini_batch_src_global generation:  0.0016069412231445312
r_  generation:  0.010292291641235352
local_output_nid generation:  0.0020303726196289062
local_in_edges_tensor generation:  0.0012271404266357422
mini_batch_src_global generation:  0.001529693603515625
r_  generation:  0.010134458541870117
local_output_nid generation:  0.002075672149658203
local_in_edges_tensor generation:  0.0011627674102783203
mini_batch_src_global generation:  0.0013887882232666016
r_  generation:  0.01011967658996582
local_output_nid generation:  0.002118825912475586
local_in_edges_tensor generation:  0.0011324882507324219
mini_batch_src_global generation:  0.0013835430145263672
r_  generation:  0.010157108306884766
local_output_nid generation:  0.002119302749633789
local_in_edges_tensor generation:  0.0011916160583496094
mini_batch_src_global generation:  0.0013861656188964844
r_  generation:  0.010813713073730469
local_output_nid generation:  0.002142667770385742
local_in_edges_tensor generation:  0.0011448860168457031
mini_batch_src_global generation:  0.0012974739074707031
r_  generation:  0.010366439819335938
local_output_nid generation:  0.002168893814086914
local_in_edges_tensor generation:  0.001188039779663086
mini_batch_src_global generation:  0.0014300346374511719
r_  generation:  0.010664224624633789
local_output_nid generation:  0.002214670181274414
local_in_edges_tensor generation:  0.001119852066040039
mini_batch_src_global generation:  0.0012664794921875
r_  generation:  0.01033163070678711
local_output_nid generation:  0.00218963623046875
local_in_edges_tensor generation:  0.0011813640594482422
mini_batch_src_global generation:  0.001352071762084961
r_  generation:  0.010975122451782227
local_output_nid generation:  0.0022423267364501953
local_in_edges_tensor generation:  0.0011324882507324219
mini_batch_src_global generation:  0.0013413429260253906
r_  generation:  0.010531425476074219
local_output_nid generation:  0.002241373062133789
local_in_edges_tensor generation:  0.0011608600616455078
mini_batch_src_global generation:  0.0012886524200439453
r_  generation:  0.01036214828491211
local_output_nid generation:  0.002269268035888672
local_in_edges_tensor generation:  0.0011625289916992188
mini_batch_src_global generation:  0.001293182373046875
r_  generation:  0.010335206985473633
local_output_nid generation:  0.002253293991088867
local_in_edges_tensor generation:  0.001176595687866211
mini_batch_src_global generation:  0.0012898445129394531
r_  generation:  0.010807275772094727
local_output_nid generation:  0.0022788047790527344
local_in_edges_tensor generation:  0.0011675357818603516
mini_batch_src_global generation:  0.0012712478637695312
r_  generation:  0.010439157485961914
local_output_nid generation:  0.0022351741790771484
local_in_edges_tensor generation:  0.001180887222290039
mini_batch_src_global generation:  0.0014274120330810547
r_  generation:  0.010555267333984375
local_output_nid generation:  0.0022432804107666016
local_in_edges_tensor generation:  0.0011854171752929688
mini_batch_src_global generation:  0.0013403892517089844
r_  generation:  0.010834932327270508
local_output_nid generation:  0.002269744873046875
local_in_edges_tensor generation:  0.001178741455078125
mini_batch_src_global generation:  0.0013079643249511719
r_  generation:  0.010343074798583984
local_output_nid generation:  0.002288341522216797
local_in_edges_tensor generation:  0.0011601448059082031
mini_batch_src_global generation:  0.0012900829315185547
r_  generation:  0.010377168655395508
local_output_nid generation:  0.002286195755004883
local_in_edges_tensor generation:  0.0011370182037353516
mini_batch_src_global generation:  0.0012693405151367188
r_  generation:  0.010468244552612305
local_output_nid generation:  0.002269744873046875
local_in_edges_tensor generation:  0.0011708736419677734
mini_batch_src_global generation:  0.0012674331665039062
r_  generation:  0.01027226448059082
local_output_nid generation:  0.0022835731506347656
local_in_edges_tensor generation:  0.0011684894561767578
mini_batch_src_global generation:  0.001386404037475586
r_  generation:  0.010186195373535156
local_output_nid generation:  0.0022885799407958984
local_in_edges_tensor generation:  0.001168966293334961
mini_batch_src_global generation:  0.0012669563293457031
r_  generation:  0.010273933410644531
local_output_nid generation:  0.0022652149200439453
local_in_edges_tensor generation:  0.0012080669403076172
mini_batch_src_global generation:  0.0013184547424316406
r_  generation:  0.010695219039916992
local_output_nid generation:  0.002284526824951172
local_in_edges_tensor generation:  0.0011775493621826172
mini_batch_src_global generation:  0.0012326240539550781
r_  generation:  0.010270357131958008
local_output_nid generation:  0.0022826194763183594
local_in_edges_tensor generation:  0.0011837482452392578
mini_batch_src_global generation:  0.0012726783752441406
r_  generation:  0.010460615158081055
local_output_nid generation:  0.00394129753112793
local_in_edges_tensor generation:  0.001903533935546875
mini_batch_src_global generation:  0.003195047378540039
r_  generation:  0.013956308364868164
local_output_nid generation:  0.0024085044860839844
local_in_edges_tensor generation:  0.0011565685272216797
mini_batch_src_global generation:  0.0013170242309570312
r_  generation:  0.010590076446533203
local_output_nid generation:  0.002247333526611328
local_in_edges_tensor generation:  0.0010838508605957031
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.009827613830566406
local_output_nid generation:  0.002161264419555664
local_in_edges_tensor generation:  0.001012563705444336
mini_batch_src_global generation:  0.0012583732604980469
r_  generation:  0.010472536087036133
local_output_nid generation:  0.002108335494995117
local_in_edges_tensor generation:  0.0010218620300292969
mini_batch_src_global generation:  0.001115560531616211
r_  generation:  0.009763479232788086
----------------------check_connections_block total spend ----------------------------- 0.6366891860961914
generate_one_block  0.02374577522277832
generate_one_block  0.022499561309814453
generate_one_block  0.02110600471496582
generate_one_block  0.01781749725341797
generate_one_block  0.017433881759643555
generate_one_block  0.017443418502807617
generate_one_block  0.017755985260009766
generate_one_block  0.01739668846130371
generate_one_block  0.017481565475463867
generate_one_block  0.017444372177124023
generate_one_block  0.018035411834716797
generate_one_block  0.017804861068725586
generate_one_block  0.017269611358642578
generate_one_block  0.01752305030822754
generate_one_block  0.01772332191467285
generate_one_block  0.017476558685302734
generate_one_block  0.017328262329101562
generate_one_block  0.01793074607849121
generate_one_block  0.017090559005737305
generate_one_block  0.017279863357543945
generate_one_block  0.017121076583862305
generate_one_block  0.017244815826416016
generate_one_block  0.016695499420166016
generate_one_block  0.01701831817626953
generate_one_block  0.017587661743164062
generate_one_block  0.01695728302001953
generate_one_block  0.0174407958984375
generate_one_block  0.0170285701751709
generate_one_block  0.017221689224243164
generate_one_block  0.01654338836669922
generate_one_block  0.01754927635192871
generate_one_block  0.016480207443237305
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035704851150512695
gen group dst list time:  0.026529788970947266
time for parepare:  0.02239847183227539
local_output_nid generation:  0.006303310394287109
local_in_edges_tensor generation:  0.02046823501586914
mini_batch_src_global generation:  0.016545772552490234
r_  generation:  0.1403646469116211
local_output_nid generation:  0.009229421615600586
local_in_edges_tensor generation:  0.011901140213012695
mini_batch_src_global generation:  0.021330833435058594
r_  generation:  0.15766334533691406
local_output_nid generation:  0.009103775024414062
local_in_edges_tensor generation:  0.032874345779418945
mini_batch_src_global generation:  0.018570661544799805
r_  generation:  0.14933419227600098
local_output_nid generation:  0.00950932502746582
local_in_edges_tensor generation:  0.008471250534057617
mini_batch_src_global generation:  0.019344329833984375
r_  generation:  0.14962434768676758
local_output_nid generation:  0.009488821029663086
local_in_edges_tensor generation:  0.010996580123901367
mini_batch_src_global generation:  0.020447492599487305
r_  generation:  0.14988398551940918
local_output_nid generation:  0.009187936782836914
local_in_edges_tensor generation:  0.008849143981933594
mini_batch_src_global generation:  0.020239830017089844
r_  generation:  0.14980697631835938
local_output_nid generation:  0.008861780166625977
local_in_edges_tensor generation:  0.008481979370117188
mini_batch_src_global generation:  0.037706851959228516
r_  generation:  0.1540985107421875
local_output_nid generation:  0.008789539337158203
local_in_edges_tensor generation:  0.00879359245300293
mini_batch_src_global generation:  0.02806687355041504
r_  generation:  0.15452265739440918
local_output_nid generation:  0.008652925491333008
local_in_edges_tensor generation:  0.008129596710205078
mini_batch_src_global generation:  0.025697946548461914
r_  generation:  0.15096473693847656
local_output_nid generation:  0.009575128555297852
local_in_edges_tensor generation:  0.008280277252197266
mini_batch_src_global generation:  0.020900726318359375
r_  generation:  0.15267086029052734
local_output_nid generation:  0.010027885437011719
local_in_edges_tensor generation:  0.009725809097290039
mini_batch_src_global generation:  0.021173715591430664
r_  generation:  0.18619036674499512
local_output_nid generation:  0.015271663665771484
local_in_edges_tensor generation:  0.011621475219726562
mini_batch_src_global generation:  0.02236151695251465
r_  generation:  0.17663812637329102
local_output_nid generation:  0.015381574630737305
local_in_edges_tensor generation:  0.013796329498291016
mini_batch_src_global generation:  0.021985292434692383
r_  generation:  0.1945962905883789
local_output_nid generation:  0.01364588737487793
local_in_edges_tensor generation:  0.009907722473144531
mini_batch_src_global generation:  0.03966712951660156
r_  generation:  0.1584787368774414
local_output_nid generation:  0.010539054870605469
local_in_edges_tensor generation:  0.015451908111572266
mini_batch_src_global generation:  0.021535396575927734
r_  generation:  0.16304588317871094
local_output_nid generation:  0.00992131233215332
local_in_edges_tensor generation:  0.013059377670288086
mini_batch_src_global generation:  0.019690752029418945
r_  generation:  0.158921480178833
local_output_nid generation:  0.009557723999023438
local_in_edges_tensor generation:  0.010882139205932617
mini_batch_src_global generation:  0.01912236213684082
r_  generation:  0.15913152694702148
local_output_nid generation:  0.00974726676940918
local_in_edges_tensor generation:  0.008998870849609375
mini_batch_src_global generation:  0.01946878433227539
r_  generation:  0.16428017616271973
local_output_nid generation:  0.009328126907348633
local_in_edges_tensor generation:  0.009430170059204102
mini_batch_src_global generation:  0.032189369201660156
r_  generation:  0.18424320220947266
local_output_nid generation:  0.011470317840576172
local_in_edges_tensor generation:  0.009894847869873047
mini_batch_src_global generation:  0.021791696548461914
r_  generation:  0.15809082984924316
local_output_nid generation:  0.009685277938842773
local_in_edges_tensor generation:  0.008491754531860352
mini_batch_src_global generation:  0.02079629898071289
r_  generation:  0.1574842929840088
local_output_nid generation:  0.00957036018371582
local_in_edges_tensor generation:  0.009473323822021484
mini_batch_src_global generation:  0.053946495056152344
r_  generation:  0.16047310829162598
local_output_nid generation:  0.01614856719970703
local_in_edges_tensor generation:  0.012209653854370117
mini_batch_src_global generation:  0.017693042755126953
r_  generation:  0.1519641876220703
local_output_nid generation:  0.014092206954956055
local_in_edges_tensor generation:  0.010799407958984375
mini_batch_src_global generation:  0.01781749725341797
r_  generation:  0.15375947952270508
local_output_nid generation:  0.015116214752197266
local_in_edges_tensor generation:  0.012085676193237305
mini_batch_src_global generation:  0.019194364547729492
r_  generation:  0.18470120429992676
local_output_nid generation:  0.013052940368652344
local_in_edges_tensor generation:  0.010355472564697266
mini_batch_src_global generation:  0.0259244441986084
r_  generation:  0.16743850708007812
local_output_nid generation:  0.011586189270019531
local_in_edges_tensor generation:  0.00977325439453125
mini_batch_src_global generation:  0.0256960391998291
r_  generation:  0.17494606971740723
local_output_nid generation:  0.010966300964355469
local_in_edges_tensor generation:  0.010956048965454102
mini_batch_src_global generation:  0.025994062423706055
r_  generation:  0.16918396949768066
local_output_nid generation:  0.010879278182983398
local_in_edges_tensor generation:  0.009179115295410156
mini_batch_src_global generation:  0.023769855499267578
r_  generation:  0.17750859260559082
local_output_nid generation:  0.010476112365722656
local_in_edges_tensor generation:  0.008999347686767578
mini_batch_src_global generation:  0.0232846736907959
r_  generation:  0.1645033359527588
local_output_nid generation:  0.010612010955810547
local_in_edges_tensor generation:  0.008837461471557617
mini_batch_src_global generation:  0.022841215133666992
r_  generation:  0.18095707893371582
local_output_nid generation:  0.010255813598632812
local_in_edges_tensor generation:  0.008550167083740234
mini_batch_src_global generation:  0.02262592315673828
r_  generation:  0.168229341506958
----------------------check_connections_block total spend ----------------------------- 7.948415040969849
generate_one_block  0.21573877334594727
generate_one_block  0.21521735191345215
generate_one_block  0.20387005805969238
generate_one_block  0.20357656478881836
generate_one_block  0.23685717582702637
generate_one_block  0.20074081420898438
generate_one_block  0.20535778999328613
generate_one_block  0.2049553394317627
generate_one_block  0.19946050643920898
generate_one_block  0.20420527458190918
generate_one_block  0.22971892356872559
generate_one_block  0.2114849090576172
generate_one_block  0.20504236221313477
generate_one_block  0.20908761024475098
generate_one_block  0.20948338508605957
generate_one_block  0.21050500869750977
generate_one_block  0.20818805694580078
generate_one_block  0.2160017490386963
generate_one_block  0.202347993850708
generate_one_block  0.2033390998840332
generate_one_block  0.20709753036499023
generate_one_block  0.20120644569396973
generate_one_block  0.19229745864868164
generate_one_block  0.19537806510925293
generate_one_block  0.20897817611694336
generate_one_block  0.19560956954956055
generate_one_block  0.2015552520751953
generate_one_block  0.202439546585083
generate_one_block  0.20662641525268555
generate_one_block  0.19486069679260254
generate_one_block  0.20734047889709473
generate_one_block  0.19574594497680664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038680076599121094
gen group dst list time:  0.1098175048828125
time for parepare:  0.02058863639831543
local_output_nid generation:  0.025015830993652344
local_in_edges_tensor generation:  0.044631004333496094
mini_batch_src_global generation:  0.036180734634399414
r_  generation:  0.41178369522094727
local_output_nid generation:  0.03018665313720703
local_in_edges_tensor generation:  0.0333099365234375
mini_batch_src_global generation:  0.048487186431884766
r_  generation:  0.4076225757598877
local_output_nid generation:  0.029631853103637695
local_in_edges_tensor generation:  0.027089834213256836
mini_batch_src_global generation:  0.04806947708129883
r_  generation:  0.430037260055542
local_output_nid generation:  0.029797792434692383
local_in_edges_tensor generation:  0.027750253677368164
mini_batch_src_global generation:  0.05083012580871582
r_  generation:  0.4110598564147949
local_output_nid generation:  0.028514623641967773
local_in_edges_tensor generation:  0.03080582618713379
mini_batch_src_global generation:  0.0507810115814209
r_  generation:  0.42229652404785156
local_output_nid generation:  0.02883744239807129
local_in_edges_tensor generation:  0.031473398208618164
mini_batch_src_global generation:  0.05188107490539551
r_  generation:  0.4156992435455322
local_output_nid generation:  0.028029203414916992
local_in_edges_tensor generation:  0.02592754364013672
mini_batch_src_global generation:  0.05996274948120117
r_  generation:  0.42478156089782715
local_output_nid generation:  0.02781057357788086
local_in_edges_tensor generation:  0.029467105865478516
mini_batch_src_global generation:  0.05164051055908203
r_  generation:  0.41437196731567383
local_output_nid generation:  0.027707338333129883
local_in_edges_tensor generation:  0.029845237731933594
mini_batch_src_global generation:  0.04834866523742676
r_  generation:  0.4339423179626465
local_output_nid generation:  0.029918432235717773
local_in_edges_tensor generation:  0.025439977645874023
mini_batch_src_global generation:  0.05257868766784668
r_  generation:  0.40866780281066895
local_output_nid generation:  0.029207706451416016
local_in_edges_tensor generation:  0.029166460037231445
mini_batch_src_global generation:  0.04754304885864258
r_  generation:  0.4203474521636963
local_output_nid generation:  0.028805971145629883
local_in_edges_tensor generation:  0.026804208755493164
mini_batch_src_global generation:  0.052255868911743164
r_  generation:  0.40889453887939453
local_output_nid generation:  0.028815746307373047
local_in_edges_tensor generation:  0.025949716567993164
mini_batch_src_global generation:  0.04737353324890137
r_  generation:  0.41782069206237793
local_output_nid generation:  0.028788089752197266
local_in_edges_tensor generation:  0.02735424041748047
mini_batch_src_global generation:  0.05228447914123535
r_  generation:  0.40961766242980957
local_output_nid generation:  0.02861952781677246
local_in_edges_tensor generation:  0.03869819641113281
mini_batch_src_global generation:  0.04764723777770996
r_  generation:  0.42416834831237793
local_output_nid generation:  0.02859187126159668
local_in_edges_tensor generation:  0.02565598487854004
mini_batch_src_global generation:  0.04903674125671387
r_  generation:  0.41160154342651367
local_output_nid generation:  0.02878880500793457
local_in_edges_tensor generation:  0.02702474594116211
mini_batch_src_global generation:  0.047351837158203125
r_  generation:  0.4230203628540039
local_output_nid generation:  0.028907299041748047
local_in_edges_tensor generation:  0.02947545051574707
mini_batch_src_global generation:  0.04948163032531738
r_  generation:  0.41876983642578125
local_output_nid generation:  0.03127551078796387
local_in_edges_tensor generation:  0.03193926811218262
mini_batch_src_global generation:  0.04708385467529297
r_  generation:  0.4232802391052246
local_output_nid generation:  0.028776168823242188
local_in_edges_tensor generation:  0.02914595603942871
mini_batch_src_global generation:  0.05054354667663574
r_  generation:  0.41251277923583984
local_output_nid generation:  0.030814170837402344
local_in_edges_tensor generation:  0.025426387786865234
mini_batch_src_global generation:  0.04730939865112305
r_  generation:  0.4228789806365967
local_output_nid generation:  0.028666019439697266
local_in_edges_tensor generation:  0.031048059463500977
mini_batch_src_global generation:  0.04941987991333008
r_  generation:  0.41322946548461914
local_output_nid generation:  0.030230283737182617
local_in_edges_tensor generation:  0.02713322639465332
mini_batch_src_global generation:  0.04892468452453613
r_  generation:  0.4161653518676758
local_output_nid generation:  0.0284879207611084
local_in_edges_tensor generation:  0.027605295181274414
mini_batch_src_global generation:  0.05008840560913086
r_  generation:  0.4104654788970947
local_output_nid generation:  0.030508995056152344
local_in_edges_tensor generation:  0.03350687026977539
mini_batch_src_global generation:  0.047518253326416016
r_  generation:  0.42581796646118164
local_output_nid generation:  0.028875112533569336
local_in_edges_tensor generation:  0.025830745697021484
mini_batch_src_global generation:  0.05266141891479492
r_  generation:  0.4134244918823242
local_output_nid generation:  0.028826236724853516
local_in_edges_tensor generation:  0.025916576385498047
mini_batch_src_global generation:  0.04773974418640137
r_  generation:  0.43724560737609863
local_output_nid generation:  0.030159473419189453
local_in_edges_tensor generation:  0.030402421951293945
mini_batch_src_global generation:  0.05044198036193848
r_  generation:  0.41228747367858887
local_output_nid generation:  0.029265165328979492
local_in_edges_tensor generation:  0.027747631072998047
mini_batch_src_global generation:  0.049550533294677734
r_  generation:  0.4214630126953125
local_output_nid generation:  0.02870631217956543
local_in_edges_tensor generation:  0.02554917335510254
mini_batch_src_global generation:  0.04888486862182617
r_  generation:  0.41068220138549805
local_output_nid generation:  0.02892327308654785
local_in_edges_tensor generation:  0.025730609893798828
mini_batch_src_global generation:  0.04962587356567383
r_  generation:  0.42516255378723145
local_output_nid generation:  0.028652191162109375
local_in_edges_tensor generation:  0.0260012149810791
mini_batch_src_global generation:  0.04900765419006348
r_  generation:  0.40885114669799805
----------------------check_connections_block total spend ----------------------------- 19.77799415588379
generate_one_block  0.5693342685699463
generate_one_block  0.5621387958526611
generate_one_block  0.5519559383392334
generate_one_block  0.5520260334014893
generate_one_block  0.6554214954376221
generate_one_block  0.5494561195373535
generate_one_block  0.5693008899688721
generate_one_block  0.5582485198974609
generate_one_block  0.5515141487121582
generate_one_block  0.5533912181854248
generate_one_block  0.5571866035461426
generate_one_block  0.5586442947387695
generate_one_block  0.5549280643463135
generate_one_block  0.5699281692504883
generate_one_block  0.5663876533508301
generate_one_block  0.5562512874603271
generate_one_block  0.5560870170593262
generate_one_block  0.5623624324798584
generate_one_block  0.5527322292327881
generate_one_block  0.5545361042022705
generate_one_block  0.5589315891265869
generate_one_block  0.5621671676635742
generate_one_block  0.556983232498169
generate_one_block  0.5558595657348633
generate_one_block  0.5768163204193115
generate_one_block  0.5551223754882812
generate_one_block  0.5591416358947754
generate_one_block  0.5573139190673828
generate_one_block  0.5605373382568359
generate_one_block  0.5498547554016113
generate_one_block  0.561187744140625
generate_one_block  0.5498504638671875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1226949691772461  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

connection checking time:  27.726409196853638
block generation total time  24.56991171836853
average batch blocks generation time:  0.7678097411990166
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526418685913086  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.12108039855957  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1049809455871582  GigaBytes
Max Memory Allocated: 17.431148052215576  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.557476043701172  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527372360229492  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.060744762420654  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1047520637512207  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.071383476257324  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1052393913269043  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.91870355606079  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10466480255126953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.92865562438965  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529470443725586  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.111189365386963  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10463953018188477  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.11167049407959  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10523366928100586  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.77664089202881  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10462522506713867  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.992705821990967  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529851913452148  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.185744285583496  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1047978401184082  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.08567762374878  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522127151489258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.807477951049805  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10471105575561523  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.094008445739746  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526800155639648  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.054280757904053  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10490036010742188  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.04993200302124  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10521554946899414  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.782623767852783  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10471630096435547  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.2577543258667  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522031784057617  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.78034734725952  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10476064682006836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.75387144088745  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10521793365478516  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.802871704101562  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10480165481567383  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.791090488433838  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10514402389526367  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.424540519714355  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10451555252075195  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.527807235717773  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527181625366211  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.086027145385742  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10463619232177734  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.60353374481201  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10523509979248047  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.84007501602173  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10475540161132812  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.806557655334473  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526752471923828  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.055953979492188  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1044912338256836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.56185817718506  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526037216186523  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.99087619781494  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10433340072631836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.56502866744995  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032200492918491364 |0.014992699027061462 |0.4210636392235756 |9.451806545257568e-05 |0.76248449832201 |0.008977174758911133 |
----------------------------------------------------------pseudo_mini_loss sum 2.4013309478759766
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  8796899
Number of first layer input nodes during this epoch:  4682201
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12225723266601562  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026161670684814453
random selection method range initialization spend 0.0052111148834228516
time for parepare:  0.01949620246887207
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.004079103469848633
mini_batch_src_global generation:  0.0017919540405273438
r_  generation:  0.010842084884643555
local_output_nid generation:  0.0016200542449951172
local_in_edges_tensor generation:  0.0010764598846435547
mini_batch_src_global generation:  0.0016472339630126953
r_  generation:  0.009944438934326172
local_output_nid generation:  0.0017042160034179688
local_in_edges_tensor generation:  0.0009894371032714844
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.009816169738769531
local_output_nid generation:  0.0016429424285888672
local_in_edges_tensor generation:  0.0009391307830810547
mini_batch_src_global generation:  0.0012717247009277344
r_  generation:  0.010020732879638672
local_output_nid generation:  0.0016040802001953125
local_in_edges_tensor generation:  0.0009520053863525391
mini_batch_src_global generation:  0.001140594482421875
r_  generation:  0.009792089462280273
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0010602474212646484
r_  generation:  0.011712789535522461
local_output_nid generation:  0.0016715526580810547
local_in_edges_tensor generation:  0.0009250640869140625
mini_batch_src_global generation:  0.0013048648834228516
r_  generation:  0.010813474655151367
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0012128353118896484
r_  generation:  0.010013341903686523
local_output_nid generation:  0.0016217231750488281
local_in_edges_tensor generation:  0.0009398460388183594
mini_batch_src_global generation:  0.0011701583862304688
r_  generation:  0.010080575942993164
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.000888824462890625
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.009845972061157227
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.0012404918670654297
r_  generation:  0.010434389114379883
local_output_nid generation:  0.001603841781616211
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.0011942386627197266
r_  generation:  0.010456562042236328
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.0011811256408691406
r_  generation:  0.010116338729858398
local_output_nid generation:  0.0015587806701660156
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.010108709335327148
local_output_nid generation:  0.0015649795532226562
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.001157522201538086
r_  generation:  0.010033369064331055
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0008893013000488281
mini_batch_src_global generation:  0.0012209415435791016
r_  generation:  0.010329008102416992
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0009005069732666016
mini_batch_src_global generation:  0.0012254714965820312
r_  generation:  0.010477781295776367
local_output_nid generation:  0.0015709400177001953
local_in_edges_tensor generation:  0.0009102821350097656
mini_batch_src_global generation:  0.0012891292572021484
r_  generation:  0.010660409927368164
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0008792877197265625
mini_batch_src_global generation:  0.0012247562408447266
r_  generation:  0.010242700576782227
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.0008871555328369141
mini_batch_src_global generation:  0.0012116432189941406
r_  generation:  0.010251045227050781
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0009503364562988281
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.010482311248779297
local_output_nid generation:  0.0016446113586425781
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0012052059173583984
r_  generation:  0.01014852523803711
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0008800029754638672
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.010031938552856445
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.010308980941772461
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0012280941009521484
r_  generation:  0.01035928726196289
local_output_nid generation:  0.0015842914581298828
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0012164115905761719
r_  generation:  0.010977745056152344
local_output_nid generation:  0.001631021499633789
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0012009143829345703
r_  generation:  0.010213613510131836
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.000858306884765625
mini_batch_src_global generation:  0.001180887222290039
r_  generation:  0.010136604309082031
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0008752346038818359
mini_batch_src_global generation:  0.0012311935424804688
r_  generation:  0.010364055633544922
local_output_nid generation:  0.0015816688537597656
local_in_edges_tensor generation:  0.0009226799011230469
mini_batch_src_global generation:  0.001138448715209961
r_  generation:  0.009873628616333008
local_output_nid generation:  0.0015597343444824219
local_in_edges_tensor generation:  0.0008759498596191406
mini_batch_src_global generation:  0.00113677978515625
r_  generation:  0.009829282760620117
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0008637905120849609
mini_batch_src_global generation:  0.0011341571807861328
r_  generation:  0.010137319564819336
----------------------check_connections_block total spend ----------------------------- 0.5668914318084717
generate_one_block  0.02407240867614746
generate_one_block  0.02019047737121582
generate_one_block  0.018059492111206055
generate_one_block  0.018074512481689453
generate_one_block  0.017206907272338867
generate_one_block  0.018481731414794922
generate_one_block  0.019031763076782227
generate_one_block  0.017874717712402344
generate_one_block  0.01739788055419922
generate_one_block  0.016719579696655273
generate_one_block  0.017901182174682617
generate_one_block  0.017966270446777344
generate_one_block  0.01728224754333496
generate_one_block  0.01723194122314453
generate_one_block  0.01695418357849121
generate_one_block  0.01745319366455078
generate_one_block  0.017773866653442383
generate_one_block  0.01792430877685547
generate_one_block  0.01715230941772461
generate_one_block  0.017404556274414062
generate_one_block  0.017369985580444336
generate_one_block  0.01710200309753418
generate_one_block  0.0169522762298584
generate_one_block  0.017056703567504883
generate_one_block  0.017129898071289062
generate_one_block  0.01824021339416504
generate_one_block  0.016930580139160156
generate_one_block  0.016967296600341797
generate_one_block  0.017319440841674805
generate_one_block  0.016703367233276367
generate_one_block  0.016616106033325195
generate_one_block  0.017158985137939453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0349428653717041
gen group dst list time:  0.022783994674682617
time for parepare:  0.02202916145324707
local_output_nid generation:  0.006259441375732422
local_in_edges_tensor generation:  0.016467809677124023
mini_batch_src_global generation:  0.013753175735473633
r_  generation:  0.1615588665008545
local_output_nid generation:  0.00908803939819336
local_in_edges_tensor generation:  0.010215282440185547
mini_batch_src_global generation:  0.01796269416809082
r_  generation:  0.14874553680419922
local_output_nid generation:  0.01160120964050293
local_in_edges_tensor generation:  0.03217196464538574
mini_batch_src_global generation:  0.016428232192993164
r_  generation:  0.14717555046081543
local_output_nid generation:  0.010067939758300781
local_in_edges_tensor generation:  0.009014368057250977
mini_batch_src_global generation:  0.01735663414001465
r_  generation:  0.15387845039367676
local_output_nid generation:  0.009441852569580078
local_in_edges_tensor generation:  0.008245468139648438
mini_batch_src_global generation:  0.020779848098754883
r_  generation:  0.1471569538116455
local_output_nid generation:  0.00959634780883789
local_in_edges_tensor generation:  0.00941777229309082
mini_batch_src_global generation:  0.019483089447021484
r_  generation:  0.16101908683776855
local_output_nid generation:  0.009084939956665039
local_in_edges_tensor generation:  0.008441448211669922
mini_batch_src_global generation:  0.018831491470336914
r_  generation:  0.15410375595092773
local_output_nid generation:  0.008933782577514648
local_in_edges_tensor generation:  0.009022712707519531
mini_batch_src_global generation:  0.019649505615234375
r_  generation:  0.15618467330932617
local_output_nid generation:  0.00890970230102539
local_in_edges_tensor generation:  0.008399486541748047
mini_batch_src_global generation:  0.019391775131225586
r_  generation:  0.16135501861572266
local_output_nid generation:  0.009022235870361328
local_in_edges_tensor generation:  0.009528636932373047
mini_batch_src_global generation:  0.01814413070678711
r_  generation:  0.15413975715637207
local_output_nid generation:  0.010321378707885742
local_in_edges_tensor generation:  0.00933527946472168
mini_batch_src_global generation:  0.019407033920288086
r_  generation:  0.16078805923461914
local_output_nid generation:  0.009476184844970703
local_in_edges_tensor generation:  0.011867046356201172
mini_batch_src_global generation:  0.01978588104248047
r_  generation:  0.20265793800354004
local_output_nid generation:  0.009333133697509766
local_in_edges_tensor generation:  0.009764432907104492
mini_batch_src_global generation:  0.01956963539123535
r_  generation:  0.15929245948791504
local_output_nid generation:  0.009377241134643555
local_in_edges_tensor generation:  0.008448600769042969
mini_batch_src_global generation:  0.018872499465942383
r_  generation:  0.15783166885375977
local_output_nid generation:  0.010507345199584961
local_in_edges_tensor generation:  0.008623838424682617
mini_batch_src_global generation:  0.019079208374023438
r_  generation:  0.1543426513671875
local_output_nid generation:  0.009556055068969727
local_in_edges_tensor generation:  0.00889444351196289
mini_batch_src_global generation:  0.020000696182250977
r_  generation:  0.15725183486938477
local_output_nid generation:  0.009669065475463867
local_in_edges_tensor generation:  0.008483409881591797
mini_batch_src_global generation:  0.019927024841308594
r_  generation:  0.1613917350769043
local_output_nid generation:  0.009868144989013672
local_in_edges_tensor generation:  0.009713411331176758
mini_batch_src_global generation:  0.02083444595336914
r_  generation:  0.1612226963043213
local_output_nid generation:  0.009385347366333008
local_in_edges_tensor generation:  0.009703397750854492
mini_batch_src_global generation:  0.019253969192504883
r_  generation:  0.15526890754699707
local_output_nid generation:  0.009669780731201172
local_in_edges_tensor generation:  0.008435726165771484
mini_batch_src_global generation:  0.019725322723388672
r_  generation:  0.15616703033447266
local_output_nid generation:  0.009615182876586914
local_in_edges_tensor generation:  0.008675575256347656
mini_batch_src_global generation:  0.019722461700439453
r_  generation:  0.15937352180480957
local_output_nid generation:  0.009454727172851562
local_in_edges_tensor generation:  0.009046077728271484
mini_batch_src_global generation:  0.019227027893066406
r_  generation:  0.15497183799743652
local_output_nid generation:  0.009480714797973633
local_in_edges_tensor generation:  0.008217573165893555
mini_batch_src_global generation:  0.023456096649169922
r_  generation:  0.15184259414672852
local_output_nid generation:  0.009464263916015625
local_in_edges_tensor generation:  0.008993148803710938
mini_batch_src_global generation:  0.018984556198120117
r_  generation:  0.15506458282470703
local_output_nid generation:  0.009485960006713867
local_in_edges_tensor generation:  0.008462190628051758
mini_batch_src_global generation:  0.019457340240478516
r_  generation:  0.15741848945617676
local_output_nid generation:  0.010051488876342773
local_in_edges_tensor generation:  0.010527372360229492
mini_batch_src_global generation:  0.020220041275024414
r_  generation:  0.16387438774108887
local_output_nid generation:  0.009191513061523438
local_in_edges_tensor generation:  0.008718729019165039
mini_batch_src_global generation:  0.01907181739807129
r_  generation:  0.1526317596435547
local_output_nid generation:  0.00938725471496582
local_in_edges_tensor generation:  0.008554935455322266
mini_batch_src_global generation:  0.018797874450683594
r_  generation:  0.15436983108520508
local_output_nid generation:  0.00964975357055664
local_in_edges_tensor generation:  0.009103059768676758
mini_batch_src_global generation:  0.019751310348510742
r_  generation:  0.15808558464050293
local_output_nid generation:  0.009285926818847656
local_in_edges_tensor generation:  0.008876323699951172
mini_batch_src_global generation:  0.01885533332824707
r_  generation:  0.15319108963012695
local_output_nid generation:  0.009338855743408203
local_in_edges_tensor generation:  0.00821995735168457
mini_batch_src_global generation:  0.018766164779663086
r_  generation:  0.15375614166259766
local_output_nid generation:  0.009674310684204102
local_in_edges_tensor generation:  0.00986480712890625
mini_batch_src_global generation:  0.019237756729125977
r_  generation:  0.156050443649292
----------------------check_connections_block total spend ----------------------------- 7.466565132141113
generate_one_block  0.20152783393859863
generate_one_block  0.19413089752197266
generate_one_block  0.20233154296875
generate_one_block  0.2056276798248291
generate_one_block  0.22277593612670898
generate_one_block  0.2127363681793213
generate_one_block  0.20049667358398438
generate_one_block  0.20024824142456055
generate_one_block  0.20197796821594238
generate_one_block  0.19059085845947266
generate_one_block  0.20723319053649902
generate_one_block  0.2129204273223877
generate_one_block  0.200606107711792
generate_one_block  0.1982741355895996
generate_one_block  0.19782567024230957
generate_one_block  0.20274829864501953
generate_one_block  0.20987176895141602
generate_one_block  0.20978713035583496
generate_one_block  0.19918227195739746
generate_one_block  0.21017026901245117
generate_one_block  0.20610380172729492
generate_one_block  0.19978070259094238
generate_one_block  0.19556212425231934
generate_one_block  0.201690673828125
generate_one_block  0.2051682472229004
generate_one_block  0.22035765647888184
generate_one_block  0.1972057819366455
generate_one_block  0.20089244842529297
generate_one_block  0.20342087745666504
generate_one_block  0.1980113983154297
generate_one_block  0.1986703872680664
generate_one_block  0.20232224464416504
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03667879104614258
gen group dst list time:  0.09903168678283691
time for parepare:  0.019839763641357422
local_output_nid generation:  0.026780128479003906
local_in_edges_tensor generation:  0.04185128211975098
mini_batch_src_global generation:  0.034906625747680664
r_  generation:  0.3985157012939453
local_output_nid generation:  0.031163930892944336
local_in_edges_tensor generation:  0.03289508819580078
mini_batch_src_global generation:  0.04752516746520996
r_  generation:  0.4043769836425781
local_output_nid generation:  0.029996395111083984
local_in_edges_tensor generation:  0.032440900802612305
mini_batch_src_global generation:  0.04669356346130371
r_  generation:  0.42218852043151855
local_output_nid generation:  0.030017375946044922
local_in_edges_tensor generation:  0.03304910659790039
mini_batch_src_global generation:  0.04929661750793457
r_  generation:  0.4124417304992676
local_output_nid generation:  0.030727386474609375
local_in_edges_tensor generation:  0.031939029693603516
mini_batch_src_global generation:  0.04702281951904297
r_  generation:  0.4293973445892334
local_output_nid generation:  0.030668020248413086
local_in_edges_tensor generation:  0.034128427505493164
mini_batch_src_global generation:  0.05347275733947754
r_  generation:  0.42312002182006836
local_output_nid generation:  0.029544591903686523
local_in_edges_tensor generation:  0.02641582489013672
mini_batch_src_global generation:  0.048021793365478516
r_  generation:  0.42931437492370605
local_output_nid generation:  0.028301000595092773
local_in_edges_tensor generation:  0.028420209884643555
mini_batch_src_global generation:  0.0489044189453125
r_  generation:  0.404430627822876
local_output_nid generation:  0.028821468353271484
local_in_edges_tensor generation:  0.025397062301635742
mini_batch_src_global generation:  0.048920631408691406
r_  generation:  0.40947890281677246
local_output_nid generation:  0.028306961059570312
local_in_edges_tensor generation:  0.02979135513305664
mini_batch_src_global generation:  0.051207542419433594
r_  generation:  0.4011044502258301
local_output_nid generation:  0.028501033782958984
local_in_edges_tensor generation:  0.02560257911682129
mini_batch_src_global generation:  0.04764676094055176
r_  generation:  0.415393590927124
local_output_nid generation:  0.028914451599121094
local_in_edges_tensor generation:  0.028864145278930664
mini_batch_src_global generation:  0.05130958557128906
r_  generation:  0.4220421314239502
local_output_nid generation:  0.028647422790527344
local_in_edges_tensor generation:  0.025484323501586914
mini_batch_src_global generation:  0.04789900779724121
r_  generation:  0.4150078296661377
local_output_nid generation:  0.0286409854888916
local_in_edges_tensor generation:  0.02514362335205078
mini_batch_src_global generation:  0.04893803596496582
r_  generation:  0.4046494960784912
local_output_nid generation:  0.03077244758605957
local_in_edges_tensor generation:  0.02930903434753418
mini_batch_src_global generation:  0.04800105094909668
r_  generation:  0.4164869785308838
local_output_nid generation:  0.028563737869262695
local_in_edges_tensor generation:  0.02932119369506836
mini_batch_src_global generation:  0.048783063888549805
r_  generation:  0.40544939041137695
local_output_nid generation:  0.030161380767822266
local_in_edges_tensor generation:  0.02894902229309082
mini_batch_src_global generation:  0.04952096939086914
r_  generation:  0.42029905319213867
local_output_nid generation:  0.028728485107421875
local_in_edges_tensor generation:  0.029162883758544922
mini_batch_src_global generation:  0.04937458038330078
r_  generation:  0.4126737117767334
local_output_nid generation:  0.02989959716796875
local_in_edges_tensor generation:  0.0267331600189209
mini_batch_src_global generation:  0.047228336334228516
r_  generation:  0.4146997928619385
local_output_nid generation:  0.028645753860473633
local_in_edges_tensor generation:  0.025483131408691406
mini_batch_src_global generation:  0.048703670501708984
r_  generation:  0.40912675857543945
local_output_nid generation:  0.03064250946044922
local_in_edges_tensor generation:  0.02933812141418457
mini_batch_src_global generation:  0.0476686954498291
r_  generation:  0.4184145927429199
local_output_nid generation:  0.02840113639831543
local_in_edges_tensor generation:  0.03070688247680664
mini_batch_src_global generation:  0.05437302589416504
r_  generation:  0.4056367874145508
local_output_nid generation:  0.030974864959716797
local_in_edges_tensor generation:  0.029562711715698242
mini_batch_src_global generation:  0.04726219177246094
r_  generation:  0.4115023612976074
local_output_nid generation:  0.02830982208251953
local_in_edges_tensor generation:  0.027228593826293945
mini_batch_src_global generation:  0.048651933670043945
r_  generation:  0.40715694427490234
local_output_nid generation:  0.03217887878417969
local_in_edges_tensor generation:  0.02874302864074707
mini_batch_src_global generation:  0.057271480560302734
r_  generation:  0.41980648040771484
local_output_nid generation:  0.02974104881286621
local_in_edges_tensor generation:  0.02888178825378418
mini_batch_src_global generation:  0.049620628356933594
r_  generation:  0.41185522079467773
local_output_nid generation:  0.028035640716552734
local_in_edges_tensor generation:  0.025721311569213867
mini_batch_src_global generation:  0.046949148178100586
r_  generation:  0.4057185649871826
local_output_nid generation:  0.0284731388092041
local_in_edges_tensor generation:  0.025946617126464844
mini_batch_src_global generation:  0.04858732223510742
r_  generation:  0.40438055992126465
local_output_nid generation:  0.028502941131591797
local_in_edges_tensor generation:  0.02956700325012207
mini_batch_src_global generation:  0.04717302322387695
r_  generation:  0.4173240661621094
local_output_nid generation:  0.028291940689086914
local_in_edges_tensor generation:  0.02547168731689453
mini_batch_src_global generation:  0.049161672592163086
r_  generation:  0.4065394401550293
local_output_nid generation:  0.028221845626831055
local_in_edges_tensor generation:  0.02530503273010254
mini_batch_src_global generation:  0.04652523994445801
r_  generation:  0.4121711254119873
local_output_nid generation:  0.028392791748046875
local_in_edges_tensor generation:  0.027387380599975586
mini_batch_src_global generation:  0.04926323890686035
r_  generation:  0.4225311279296875
----------------------check_connections_block total spend ----------------------------- 19.559646129608154
generate_one_block  0.5562264919281006
generate_one_block  0.5460019111633301
generate_one_block  0.56032395362854
generate_one_block  0.5543398857116699
generate_one_block  0.6451008319854736
generate_one_block  0.5601706504821777
generate_one_block  0.5513052940368652
generate_one_block  0.5484387874603271
generate_one_block  0.5518150329589844
generate_one_block  0.5397820472717285
generate_one_block  0.5478115081787109
generate_one_block  0.5569972991943359
generate_one_block  0.548980712890625
generate_one_block  0.5479092597961426
generate_one_block  0.5531811714172363
generate_one_block  0.5502409934997559
generate_one_block  0.5616686344146729
generate_one_block  0.5541715621948242
generate_one_block  0.5467274188995361
generate_one_block  0.5545980930328369
generate_one_block  0.5555040836334229
generate_one_block  0.5559513568878174
generate_one_block  0.550628662109375
generate_one_block  0.5496225357055664
generate_one_block  0.5696332454681396
generate_one_block  0.5624146461486816
generate_one_block  0.5451509952545166
generate_one_block  0.5492849349975586
generate_one_block  0.5572810173034668
generate_one_block  0.5432291030883789
generate_one_block  0.5475804805755615
generate_one_block  0.5555081367492676
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12225723266601562  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  27.026211261749268
block generation total time  24.287830352783203
average batch blocks generation time:  0.7589946985244751
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10518026351928711  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.554659843444824  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1045980453491211  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.66930341720581  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526657104492188  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.105359077453613  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1046304702758789  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.224602222442627  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10518455505371094  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.626537799835205  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1049962043762207  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.48369026184082  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10525274276733398  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.055177211761475  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10465240478515625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.91524314880371  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526132583618164  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.961411476135254  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10448122024536133  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.42600154876709  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529422760009766  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.107248783111572  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10488367080688477  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.246960163116455  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10523796081542969  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.83509063720703  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10491037368774414  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.740507125854492  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10519933700561523  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.69205617904663  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10468864440917969  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.98901605606079  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10531997680664062  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.278132915496826  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10463523864746094  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.239328861236572  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522317886352539  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.88805913925171  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10484647750854492  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.96360492706299  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1052851676940918  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.157479286193848  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10446929931640625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.857567310333252  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10518169403076172  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.56251859664917  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10463094711303711  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.738444805145264  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10524797439575195  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.015846252441406  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1048879623413086  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.41685199737549  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10400819778442383  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.546208381652832  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1048579216003418  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.724339485168457  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526132583618164  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.997401237487793  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10458993911743164  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.57561159133911  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10518312454223633  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.577338218688965  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10446834564208984  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.82028818130493  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031676389276981354 |0.015817753970623016 |0.4178386703133583 |9.582936763763428e-05 |0.7557880654931068 |0.0058345794677734375 |
----------------------------------------------------------pseudo_mini_loss sum 2.19759202003479
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  8793016
Number of first layer input nodes during this epoch:  4679371
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1228952407836914  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024501800537109375
random selection method range initialization spend 0.0068132877349853516
time for parepare:  0.02194666862487793
local_output_nid generation:  0.0014224052429199219
local_in_edges_tensor generation:  0.0038895606994628906
mini_batch_src_global generation:  0.006195545196533203
r_  generation:  0.014136314392089844
local_output_nid generation:  0.002518892288208008
local_in_edges_tensor generation:  0.0013473033905029297
mini_batch_src_global generation:  0.0021982192993164062
r_  generation:  0.010976314544677734
local_output_nid generation:  0.0023632049560546875
local_in_edges_tensor generation:  0.0012180805206298828
mini_batch_src_global generation:  0.0014719963073730469
r_  generation:  0.009932994842529297
local_output_nid generation:  0.0023000240325927734
local_in_edges_tensor generation:  0.00118255615234375
mini_batch_src_global generation:  0.0015397071838378906
r_  generation:  0.010257720947265625
local_output_nid generation:  0.004513978958129883
local_in_edges_tensor generation:  0.0012156963348388672
mini_batch_src_global generation:  0.0014400482177734375
r_  generation:  0.010394573211669922
local_output_nid generation:  0.0022912025451660156
local_in_edges_tensor generation:  0.0011920928955078125
mini_batch_src_global generation:  0.0015840530395507812
r_  generation:  0.010880470275878906
local_output_nid generation:  0.002289295196533203
local_in_edges_tensor generation:  0.0011963844299316406
mini_batch_src_global generation:  0.001522064208984375
r_  generation:  0.010502338409423828
local_output_nid generation:  0.0022687911987304688
local_in_edges_tensor generation:  0.0011959075927734375
mini_batch_src_global generation:  0.0014748573303222656
r_  generation:  0.01008749008178711
local_output_nid generation:  0.0022759437561035156
local_in_edges_tensor generation:  0.0011820793151855469
mini_batch_src_global generation:  0.0013234615325927734
r_  generation:  0.010378599166870117
local_output_nid generation:  0.002289295196533203
local_in_edges_tensor generation:  0.0012001991271972656
mini_batch_src_global generation:  0.0013782978057861328
r_  generation:  0.010450124740600586
local_output_nid generation:  0.0022993087768554688
local_in_edges_tensor generation:  0.0011930465698242188
mini_batch_src_global generation:  0.0014514923095703125
r_  generation:  0.010878324508666992
local_output_nid generation:  0.0022835731506347656
local_in_edges_tensor generation:  0.0011677742004394531
mini_batch_src_global generation:  0.0014185905456542969
r_  generation:  0.01042628288269043
local_output_nid generation:  0.002312898635864258
local_in_edges_tensor generation:  0.0011982917785644531
mini_batch_src_global generation:  0.0013766288757324219
r_  generation:  0.010704994201660156
local_output_nid generation:  0.0023086071014404297
local_in_edges_tensor generation:  0.0011947154998779297
mini_batch_src_global generation:  0.0014874935150146484
r_  generation:  0.01027226448059082
local_output_nid generation:  0.002337932586669922
local_in_edges_tensor generation:  0.0011832714080810547
mini_batch_src_global generation:  0.0013661384582519531
r_  generation:  0.010529756546020508
local_output_nid generation:  0.004453897476196289
local_in_edges_tensor generation:  0.001260519027709961
mini_batch_src_global generation:  0.0014255046844482422
r_  generation:  0.010745763778686523
local_output_nid generation:  0.0023467540740966797
local_in_edges_tensor generation:  0.0011792182922363281
mini_batch_src_global generation:  0.0013720989227294922
r_  generation:  0.010096549987792969
local_output_nid generation:  0.0038423538208007812
local_in_edges_tensor generation:  0.001756906509399414
mini_batch_src_global generation:  0.003297090530395508
r_  generation:  0.015122652053833008
local_output_nid generation:  0.0024487972259521484
local_in_edges_tensor generation:  0.0011756420135498047
mini_batch_src_global generation:  0.0015492439270019531
r_  generation:  0.010780096054077148
local_output_nid generation:  0.002253293991088867
local_in_edges_tensor generation:  0.0011167526245117188
mini_batch_src_global generation:  0.0012958049774169922
r_  generation:  0.010665178298950195
local_output_nid generation:  0.002185344696044922
local_in_edges_tensor generation:  0.0010437965393066406
mini_batch_src_global generation:  0.0012905597686767578
r_  generation:  0.010383129119873047
local_output_nid generation:  0.0020427703857421875
local_in_edges_tensor generation:  0.0009899139404296875
mini_batch_src_global generation:  0.001238107681274414
r_  generation:  0.010729551315307617
local_output_nid generation:  0.001997709274291992
local_in_edges_tensor generation:  0.0009984970092773438
mini_batch_src_global generation:  0.0011882781982421875
r_  generation:  0.010684728622436523
local_output_nid generation:  0.0020148754119873047
local_in_edges_tensor generation:  0.0010137557983398438
mini_batch_src_global generation:  0.0012657642364501953
r_  generation:  0.01068258285522461
local_output_nid generation:  0.001941680908203125
local_in_edges_tensor generation:  0.0010020732879638672
mini_batch_src_global generation:  0.0012125968933105469
r_  generation:  0.010798215866088867
local_output_nid generation:  0.0018801689147949219
local_in_edges_tensor generation:  0.0009577274322509766
mini_batch_src_global generation:  0.0012598037719726562
r_  generation:  0.012161016464233398
local_output_nid generation:  0.0018398761749267578
local_in_edges_tensor generation:  0.0010073184967041016
mini_batch_src_global generation:  0.0012285709381103516
r_  generation:  0.010257244110107422
local_output_nid generation:  0.0017719268798828125
local_in_edges_tensor generation:  0.0009236335754394531
mini_batch_src_global generation:  0.0013518333435058594
r_  generation:  0.010053396224975586
local_output_nid generation:  0.0018243789672851562
local_in_edges_tensor generation:  0.0009641647338867188
mini_batch_src_global generation:  0.0011055469512939453
r_  generation:  0.010135889053344727
local_output_nid generation:  0.0017213821411132812
local_in_edges_tensor generation:  0.0009362697601318359
mini_batch_src_global generation:  0.0012199878692626953
r_  generation:  0.010761499404907227
local_output_nid generation:  0.001712799072265625
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.0011987686157226562
r_  generation:  0.010897397994995117
local_output_nid generation:  0.0017113685607910156
local_in_edges_tensor generation:  0.0009243488311767578
mini_batch_src_global generation:  0.001361846923828125
r_  generation:  0.011431455612182617
----------------------check_connections_block total spend ----------------------------- 0.643913984298706
generate_one_block  0.023598909378051758
generate_one_block  0.020416736602783203
generate_one_block  0.0182492733001709
generate_one_block  0.018214941024780273
generate_one_block  0.019625186920166016
generate_one_block  0.01848578453063965
generate_one_block  0.017618894577026367
generate_one_block  0.017132997512817383
generate_one_block  0.01779961585998535
generate_one_block  0.01782846450805664
generate_one_block  0.019667387008666992
generate_one_block  0.018264055252075195
generate_one_block  0.01831841468811035
generate_one_block  0.017081260681152344
generate_one_block  0.017552852630615234
generate_one_block  0.018017053604125977
generate_one_block  0.018512487411499023
generate_one_block  0.017276287078857422
generate_one_block  0.017726898193359375
generate_one_block  0.017719030380249023
generate_one_block  0.01724386215209961
generate_one_block  0.018186092376708984
generate_one_block  0.019974946975708008
generate_one_block  0.01762080192565918
generate_one_block  0.018161535263061523
generate_one_block  0.01741814613342285
generate_one_block  0.017398834228515625
generate_one_block  0.016928672790527344
generate_one_block  0.019596576690673828
generate_one_block  0.01809859275817871
generate_one_block  0.018280982971191406
generate_one_block  0.016802072525024414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06162619590759277
gen group dst list time:  0.02601003646850586
time for parepare:  0.02223968505859375
local_output_nid generation:  0.0062487125396728516
local_in_edges_tensor generation:  0.016849517822265625
mini_batch_src_global generation:  0.01608443260192871
r_  generation:  0.13493084907531738
local_output_nid generation:  0.008508443832397461
local_in_edges_tensor generation:  0.010457277297973633
mini_batch_src_global generation:  0.018764734268188477
r_  generation:  0.1380012035369873
local_output_nid generation:  0.00914311408996582
local_in_edges_tensor generation:  0.03219866752624512
mini_batch_src_global generation:  0.016339778900146484
r_  generation:  0.14455366134643555
local_output_nid generation:  0.009270429611206055
local_in_edges_tensor generation:  0.011111974716186523
mini_batch_src_global generation:  0.029215097427368164
r_  generation:  0.15131759643554688
local_output_nid generation:  0.009312629699707031
local_in_edges_tensor generation:  0.010609626770019531
mini_batch_src_global generation:  0.019019603729248047
r_  generation:  0.1532609462738037
local_output_nid generation:  0.009387969970703125
local_in_edges_tensor generation:  0.00974416732788086
mini_batch_src_global generation:  0.019302845001220703
r_  generation:  0.15473008155822754
local_output_nid generation:  0.008704662322998047
local_in_edges_tensor generation:  0.008417129516601562
mini_batch_src_global generation:  0.020786523818969727
r_  generation:  0.15288257598876953
local_output_nid generation:  0.008574962615966797
local_in_edges_tensor generation:  0.00803232192993164
mini_batch_src_global generation:  0.02059006690979004
r_  generation:  0.1787550449371338
local_output_nid generation:  0.010384321212768555
local_in_edges_tensor generation:  0.00862574577331543
mini_batch_src_global generation:  0.020474910736083984
r_  generation:  0.16102004051208496
local_output_nid generation:  0.009459733963012695
local_in_edges_tensor generation:  0.013944387435913086
mini_batch_src_global generation:  0.018982648849487305
r_  generation:  0.15552711486816406
local_output_nid generation:  0.009737968444824219
local_in_edges_tensor generation:  0.008601903915405273
mini_batch_src_global generation:  0.019040584564208984
r_  generation:  0.16146492958068848
local_output_nid generation:  0.009093999862670898
local_in_edges_tensor generation:  0.010093927383422852
mini_batch_src_global generation:  0.019034385681152344
r_  generation:  0.15130949020385742
local_output_nid generation:  0.009411811828613281
local_in_edges_tensor generation:  0.008536338806152344
mini_batch_src_global generation:  0.018718481063842773
r_  generation:  0.15316033363342285
local_output_nid generation:  0.009090185165405273
local_in_edges_tensor generation:  0.009478330612182617
mini_batch_src_global generation:  0.01821279525756836
r_  generation:  0.15243935585021973
local_output_nid generation:  0.010182857513427734
local_in_edges_tensor generation:  0.009125709533691406
mini_batch_src_global generation:  0.01853322982788086
r_  generation:  0.15891456604003906
local_output_nid generation:  0.00950932502746582
local_in_edges_tensor generation:  0.0090484619140625
mini_batch_src_global generation:  0.01999354362487793
r_  generation:  0.1630840301513672
local_output_nid generation:  0.010851383209228516
local_in_edges_tensor generation:  0.008312702178955078
mini_batch_src_global generation:  0.021044254302978516
r_  generation:  0.1531665325164795
local_output_nid generation:  0.00958108901977539
local_in_edges_tensor generation:  0.00902867317199707
mini_batch_src_global generation:  0.018732547760009766
r_  generation:  0.15189528465270996
local_output_nid generation:  0.009770870208740234
local_in_edges_tensor generation:  0.009746789932250977
mini_batch_src_global generation:  0.018909454345703125
r_  generation:  0.1564929485321045
local_output_nid generation:  0.009541988372802734
local_in_edges_tensor generation:  0.009785890579223633
mini_batch_src_global generation:  0.019123554229736328
r_  generation:  0.15811800956726074
local_output_nid generation:  0.009293556213378906
local_in_edges_tensor generation:  0.00828099250793457
mini_batch_src_global generation:  0.018234729766845703
r_  generation:  0.14986920356750488
local_output_nid generation:  0.009875297546386719
local_in_edges_tensor generation:  0.008541107177734375
mini_batch_src_global generation:  0.02010512351989746
r_  generation:  0.15975618362426758
local_output_nid generation:  0.009516716003417969
local_in_edges_tensor generation:  0.009082317352294922
mini_batch_src_global generation:  0.019022226333618164
r_  generation:  0.15548181533813477
local_output_nid generation:  0.009599924087524414
local_in_edges_tensor generation:  0.009088277816772461
mini_batch_src_global generation:  0.018892526626586914
r_  generation:  0.15453410148620605
local_output_nid generation:  0.009964466094970703
local_in_edges_tensor generation:  0.00923466682434082
mini_batch_src_global generation:  0.01941680908203125
r_  generation:  0.15920186042785645
local_output_nid generation:  0.009448528289794922
local_in_edges_tensor generation:  0.009058475494384766
mini_batch_src_global generation:  0.01904773712158203
r_  generation:  0.15462541580200195
local_output_nid generation:  0.00951075553894043
local_in_edges_tensor generation:  0.009139776229858398
mini_batch_src_global generation:  0.01871967315673828
r_  generation:  0.1541907787322998
local_output_nid generation:  0.009208202362060547
local_in_edges_tensor generation:  0.008143901824951172
mini_batch_src_global generation:  0.018011808395385742
r_  generation:  0.14670348167419434
local_output_nid generation:  0.009359121322631836
local_in_edges_tensor generation:  0.008309125900268555
mini_batch_src_global generation:  0.017958641052246094
r_  generation:  0.14961981773376465
local_output_nid generation:  0.009779214859008789
local_in_edges_tensor generation:  0.010347366333007812
mini_batch_src_global generation:  0.019812822341918945
r_  generation:  0.16017484664916992
local_output_nid generation:  0.009851932525634766
local_in_edges_tensor generation:  0.009353876113891602
mini_batch_src_global generation:  0.0191648006439209
r_  generation:  0.1646263599395752
local_output_nid generation:  0.009096145629882812
local_in_edges_tensor generation:  0.009526968002319336
mini_batch_src_global generation:  0.019170522689819336
r_  generation:  0.15058588981628418
----------------------check_connections_block total spend ----------------------------- 7.387694358825684
generate_one_block  0.21271967887878418
generate_one_block  0.1937248706817627
generate_one_block  0.19924187660217285
generate_one_block  0.20496416091918945
generate_one_block  0.23588991165161133
generate_one_block  0.20799946784973145
generate_one_block  0.20192337036132812
generate_one_block  0.19626140594482422
generate_one_block  0.20766043663024902
generate_one_block  0.2028217315673828
generate_one_block  0.20895695686340332
generate_one_block  0.2015368938446045
generate_one_block  0.20265936851501465
generate_one_block  0.19739532470703125
generate_one_block  0.2056586742401123
generate_one_block  0.21234917640686035
generate_one_block  0.19732213020324707
generate_one_block  0.20094752311706543
generate_one_block  0.21038508415222168
generate_one_block  0.21492433547973633
generate_one_block  0.19653654098510742
generate_one_block  0.21359992027282715
generate_one_block  0.2063906192779541
generate_one_block  0.20570898056030273
generate_one_block  0.21308445930480957
generate_one_block  0.20188045501708984
generate_one_block  0.199293851852417
generate_one_block  0.1952497959136963
generate_one_block  0.19694733619689941
generate_one_block  0.20885133743286133
generate_one_block  0.21111774444580078
generate_one_block  0.19365334510803223
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03413081169128418
gen group dst list time:  0.10472989082336426
time for parepare:  0.02048349380493164
local_output_nid generation:  0.02427506446838379
local_in_edges_tensor generation:  0.040041208267211914
mini_batch_src_global generation:  0.03676962852478027
r_  generation:  0.3960752487182617
local_output_nid generation:  0.02945256233215332
local_in_edges_tensor generation:  0.0345461368560791
mini_batch_src_global generation:  0.04698491096496582
r_  generation:  0.4046366214752197
local_output_nid generation:  0.02994680404663086
local_in_edges_tensor generation:  0.028754234313964844
mini_batch_src_global generation:  0.04642677307128906
r_  generation:  0.4143650531768799
local_output_nid generation:  0.029891252517700195
local_in_edges_tensor generation:  0.031461238861083984
mini_batch_src_global generation:  0.04890799522399902
r_  generation:  0.41028690338134766
local_output_nid generation:  0.0298154354095459
local_in_edges_tensor generation:  0.031193017959594727
mini_batch_src_global generation:  0.04768776893615723
r_  generation:  0.41970324516296387
local_output_nid generation:  0.030381202697753906
local_in_edges_tensor generation:  0.03397822380065918
mini_batch_src_global generation:  0.04983353614807129
r_  generation:  0.41154909133911133
local_output_nid generation:  0.027905702590942383
local_in_edges_tensor generation:  0.029241085052490234
mini_batch_src_global generation:  0.04910993576049805
r_  generation:  0.4125959873199463
local_output_nid generation:  0.028080463409423828
local_in_edges_tensor generation:  0.030722618103027344
mini_batch_src_global generation:  0.04883527755737305
r_  generation:  0.40798377990722656
local_output_nid generation:  0.0282289981842041
local_in_edges_tensor generation:  0.031070232391357422
mini_batch_src_global generation:  0.04803276062011719
r_  generation:  0.4202084541320801
local_output_nid generation:  0.02808666229248047
local_in_edges_tensor generation:  0.029314279556274414
mini_batch_src_global generation:  0.04932761192321777
r_  generation:  0.4097254276275635
local_output_nid generation:  0.02844977378845215
local_in_edges_tensor generation:  0.026943445205688477
mini_batch_src_global generation:  0.04803633689880371
r_  generation:  0.4203956127166748
local_output_nid generation:  0.028045654296875
local_in_edges_tensor generation:  0.02917170524597168
mini_batch_src_global generation:  0.04864835739135742
r_  generation:  0.4092586040496826
local_output_nid generation:  0.02818465232849121
local_in_edges_tensor generation:  0.030645370483398438
mini_batch_src_global generation:  0.04683542251586914
r_  generation:  0.41405248641967773
local_output_nid generation:  0.027806520462036133
local_in_edges_tensor generation:  0.027190208435058594
mini_batch_src_global generation:  0.04958391189575195
r_  generation:  0.4128689765930176
local_output_nid generation:  0.028178691864013672
local_in_edges_tensor generation:  0.027358531951904297
mini_batch_src_global generation:  0.05016779899597168
r_  generation:  0.42295241355895996
local_output_nid generation:  0.030183792114257812
local_in_edges_tensor generation:  0.028403043746948242
mini_batch_src_global generation:  0.05261683464050293
r_  generation:  0.410306453704834
local_output_nid generation:  0.028850317001342773
local_in_edges_tensor generation:  0.026707172393798828
mini_batch_src_global generation:  0.04770636558532715
r_  generation:  0.40961194038391113
local_output_nid generation:  0.028802156448364258
local_in_edges_tensor generation:  0.027596712112426758
mini_batch_src_global generation:  0.051171302795410156
r_  generation:  0.40636301040649414
local_output_nid generation:  0.028949975967407227
local_in_edges_tensor generation:  0.02663397789001465
mini_batch_src_global generation:  0.048193931579589844
r_  generation:  0.4184994697570801
local_output_nid generation:  0.02896714210510254
local_in_edges_tensor generation:  0.027362823486328125
mini_batch_src_global generation:  0.04928231239318848
r_  generation:  0.40819406509399414
local_output_nid generation:  0.028789758682250977
local_in_edges_tensor generation:  0.026409387588500977
mini_batch_src_global generation:  0.04772377014160156
r_  generation:  0.4143972396850586
local_output_nid generation:  0.03116631507873535
local_in_edges_tensor generation:  0.027904510498046875
mini_batch_src_global generation:  0.05222439765930176
r_  generation:  0.41939210891723633
local_output_nid generation:  0.029016733169555664
local_in_edges_tensor generation:  0.027575016021728516
mini_batch_src_global generation:  0.04813075065612793
r_  generation:  0.43337297439575195
local_output_nid generation:  0.02892017364501953
local_in_edges_tensor generation:  0.027149677276611328
mini_batch_src_global generation:  0.04960346221923828
r_  generation:  0.4199635982513428
local_output_nid generation:  0.029179096221923828
local_in_edges_tensor generation:  0.03113842010498047
mini_batch_src_global generation:  0.04971170425415039
r_  generation:  0.4289515018463135
local_output_nid generation:  0.02904510498046875
local_in_edges_tensor generation:  0.026455402374267578
mini_batch_src_global generation:  0.04956555366516113
r_  generation:  0.4086015224456787
local_output_nid generation:  0.02874302864074707
local_in_edges_tensor generation:  0.025815248489379883
mini_batch_src_global generation:  0.04789257049560547
r_  generation:  0.41721272468566895
local_output_nid generation:  0.028546571731567383
local_in_edges_tensor generation:  0.02788519859313965
mini_batch_src_global generation:  0.049646615982055664
r_  generation:  0.4070272445678711
local_output_nid generation:  0.03117060661315918
local_in_edges_tensor generation:  0.02655959129333496
mini_batch_src_global generation:  0.04942917823791504
r_  generation:  0.412006139755249
local_output_nid generation:  0.029233217239379883
local_in_edges_tensor generation:  0.03159451484680176
mini_batch_src_global generation:  0.04995560646057129
r_  generation:  0.4124269485473633
local_output_nid generation:  0.029024600982666016
local_in_edges_tensor generation:  0.029347896575927734
mini_batch_src_global generation:  0.05201363563537598
r_  generation:  0.42157554626464844
local_output_nid generation:  0.028387784957885742
local_in_edges_tensor generation:  0.028271198272705078
mini_batch_src_global generation:  0.0518951416015625
r_  generation:  0.41147875785827637
----------------------check_connections_block total spend ----------------------------- 19.611857175827026
generate_one_block  0.5713980197906494
generate_one_block  0.5441584587097168
generate_one_block  0.5616412162780762
generate_one_block  0.564100980758667
generate_one_block  0.6572175025939941
generate_one_block  0.5611772537231445
generate_one_block  0.5545833110809326
generate_one_block  0.5519266128540039
generate_one_block  0.5575447082519531
generate_one_block  0.5568428039550781
generate_one_block  0.5590059757232666
generate_one_block  0.551706075668335
generate_one_block  0.5549430847167969
generate_one_block  0.5530693531036377
generate_one_block  0.5640907287597656
generate_one_block  0.5618777275085449
generate_one_block  0.557497501373291
generate_one_block  0.5557911396026611
generate_one_block  0.5611221790313721
generate_one_block  0.5572183132171631
generate_one_block  0.5508601665496826
generate_one_block  0.565852165222168
generate_one_block  0.5591914653778076
generate_one_block  0.5558478832244873
generate_one_block  0.5805978775024414
generate_one_block  0.5551266670227051
generate_one_block  0.5596067905426025
generate_one_block  0.5488870143890381
generate_one_block  0.5486574172973633
generate_one_block  0.5617313385009766
generate_one_block  0.5774834156036377
generate_one_block  0.5496525764465332
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1228952407836914  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  26.99955153465271
block generation total time  24.528064489364624
average batch blocks generation time:  0.7665020152926445
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10519552230834961  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.58411931991577  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10414886474609375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.431748867034912  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522937774658203  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.93353271484375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1047358512878418  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.052870273590088  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527801513671875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.0849289894104  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10495805740356445  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.220802307128906  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10525131225585938  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.93708372116089  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10460901260375977  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.639774322509766  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529327392578125  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.206824779510498  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10446310043334961  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.945297718048096  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10530281066894531  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.203728675842285  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10469436645507812  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.751455783843994  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10524177551269531  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.83024311065674  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1044454574584961  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.524993896484375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10524749755859375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.87519407272339  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10465621948242188  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.10211753845215  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10517263412475586  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.504332065582275  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1045541763305664  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.750399589538574  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10528326034545898  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.16616916656494  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.104644775390625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.059980869293213  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1051778793334961  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.5757155418396  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1049652099609375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.322927474975586  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10525178909301758  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.90112590789795  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10467529296875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.9443998336792  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1053323745727539  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.303602695465088  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10443401336669922  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.860224723815918  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1052241325378418  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.832821369171143  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10444021224975586  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.474162578582764  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10519123077392578  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.593724727630615  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1048574447631836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.220888137817383  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10532093048095703  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.2729811668396  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10415458679199219  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.48020362854004  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030649639666080475 |0.014037080109119415 |0.4158981740474701 |9.369105100631714e-05 |0.7506972551345825 |0.00577545166015625 |
----------------------------------------------------------pseudo_mini_loss sum 2.043705940246582
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  8785453
Number of first layer input nodes during this epoch:  4678047
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12193536758422852  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026050806045532227
random selection method range initialization spend 0.006048679351806641
time for parepare:  0.01915597915649414
local_output_nid generation:  0.001379251480102539
local_in_edges_tensor generation:  0.008527278900146484
mini_batch_src_global generation:  0.0015766620635986328
r_  generation:  0.010756492614746094
local_output_nid generation:  0.0016286373138427734
local_in_edges_tensor generation:  0.0010869503021240234
mini_batch_src_global generation:  0.0015048980712890625
r_  generation:  0.010107040405273438
local_output_nid generation:  0.0015978813171386719
local_in_edges_tensor generation:  0.0010082721710205078
mini_batch_src_global generation:  0.0011963844299316406
r_  generation:  0.010203838348388672
local_output_nid generation:  0.001598358154296875
local_in_edges_tensor generation:  0.0009648799896240234
mini_batch_src_global generation:  0.0011844635009765625
r_  generation:  0.010286808013916016
local_output_nid generation:  0.0016093254089355469
local_in_edges_tensor generation:  0.0009791851043701172
mini_batch_src_global generation:  0.0011265277862548828
r_  generation:  0.009978771209716797
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0009307861328125
mini_batch_src_global generation:  0.0010952949523925781
r_  generation:  0.00995635986328125
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.010102987289428711
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0009322166442871094
mini_batch_src_global generation:  0.0011210441589355469
r_  generation:  0.009845733642578125
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0009152889251708984
mini_batch_src_global generation:  0.0011026859283447266
r_  generation:  0.0100860595703125
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0010919570922851562
r_  generation:  0.010029792785644531
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0011038780212402344
r_  generation:  0.010245323181152344
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0008847713470458984
mini_batch_src_global generation:  0.0011067390441894531
r_  generation:  0.010269641876220703
local_output_nid generation:  0.0016276836395263672
local_in_edges_tensor generation:  0.0008995532989501953
mini_batch_src_global generation:  0.0011186599731445312
r_  generation:  0.010189294815063477
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0009088516235351562
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.010280132293701172
local_output_nid generation:  0.0015649795532226562
local_in_edges_tensor generation:  0.0009424686431884766
mini_batch_src_global generation:  0.0011684894561767578
r_  generation:  0.01007843017578125
local_output_nid generation:  0.0015935897827148438
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.001131296157836914
r_  generation:  0.010185003280639648
local_output_nid generation:  0.0015642642974853516
local_in_edges_tensor generation:  0.0008900165557861328
mini_batch_src_global generation:  0.0011310577392578125
r_  generation:  0.01027822494506836
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008835792541503906
mini_batch_src_global generation:  0.0011262893676757812
r_  generation:  0.010268211364746094
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.010101079940795898
local_output_nid generation:  0.0015711784362792969
local_in_edges_tensor generation:  0.000888824462890625
mini_batch_src_global generation:  0.0011205673217773438
r_  generation:  0.010295867919921875
local_output_nid generation:  0.0015609264373779297
local_in_edges_tensor generation:  0.0008633136749267578
mini_batch_src_global generation:  0.00113677978515625
r_  generation:  0.010289907455444336
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.0011539459228515625
r_  generation:  0.010405540466308594
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.0011341571807861328
r_  generation:  0.010211467742919922
local_output_nid generation:  0.001569509506225586
local_in_edges_tensor generation:  0.0008442401885986328
mini_batch_src_global generation:  0.0010955333709716797
r_  generation:  0.010215997695922852
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.0011858940124511719
r_  generation:  0.010354757308959961
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0008740425109863281
mini_batch_src_global generation:  0.001138448715209961
r_  generation:  0.010106086730957031
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0011420249938964844
r_  generation:  0.010529518127441406
local_output_nid generation:  0.0015590190887451172
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.0011937618255615234
r_  generation:  0.010482072830200195
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0008697509765625
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.010117769241333008
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.000850677490234375
mini_batch_src_global generation:  0.0011112689971923828
r_  generation:  0.010355710983276367
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0012080669403076172
r_  generation:  0.010362625122070312
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0008673667907714844
mini_batch_src_global generation:  0.0011456012725830078
r_  generation:  0.010223865509033203
----------------------check_connections_block total spend ----------------------------- 0.5654897689819336
generate_one_block  0.019977569580078125
generate_one_block  0.020058155059814453
generate_one_block  0.018544435501098633
generate_one_block  0.01815319061279297
generate_one_block  0.017615556716918945
generate_one_block  0.017266035079956055
generate_one_block  0.01717686653137207
generate_one_block  0.017041921615600586
generate_one_block  0.017354249954223633
generate_one_block  0.016864776611328125
generate_one_block  0.017298460006713867
generate_one_block  0.017575502395629883
generate_one_block  0.017139196395874023
generate_one_block  0.01722121238708496
generate_one_block  0.016767024993896484
generate_one_block  0.017024993896484375
generate_one_block  0.01729297637939453
generate_one_block  0.017183780670166016
generate_one_block  0.016987323760986328
generate_one_block  0.017337560653686523
generate_one_block  0.0171201229095459
generate_one_block  0.01709747314453125
generate_one_block  0.017141342163085938
generate_one_block  0.017145395278930664
generate_one_block  0.017314434051513672
generate_one_block  0.017017364501953125
generate_one_block  0.0175015926361084
generate_one_block  0.017375946044921875
generate_one_block  0.016950368881225586
generate_one_block  0.017425060272216797
generate_one_block  0.01721811294555664
generate_one_block  0.01713085174560547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03744626045227051
gen group dst list time:  0.020643234252929688
time for parepare:  0.020272254943847656
local_output_nid generation:  0.006385087966918945
local_in_edges_tensor generation:  0.019426822662353516
mini_batch_src_global generation:  0.01485133171081543
r_  generation:  0.13649249076843262
local_output_nid generation:  0.009042024612426758
local_in_edges_tensor generation:  0.010738372802734375
mini_batch_src_global generation:  0.017274141311645508
r_  generation:  0.1385641098022461
local_output_nid generation:  0.009536504745483398
local_in_edges_tensor generation:  0.03153204917907715
mini_batch_src_global generation:  0.017158985137939453
r_  generation:  0.15144610404968262
local_output_nid generation:  0.009531021118164062
local_in_edges_tensor generation:  0.011444091796875
mini_batch_src_global generation:  0.017386674880981445
r_  generation:  0.15075421333312988
local_output_nid generation:  0.00943303108215332
local_in_edges_tensor generation:  0.008697271347045898
mini_batch_src_global generation:  0.018059253692626953
r_  generation:  0.15158557891845703
local_output_nid generation:  0.008722305297851562
local_in_edges_tensor generation:  0.008602142333984375
mini_batch_src_global generation:  0.017969131469726562
r_  generation:  0.15105414390563965
local_output_nid generation:  0.008734464645385742
local_in_edges_tensor generation:  0.009123802185058594
mini_batch_src_global generation:  0.018256187438964844
r_  generation:  0.15009474754333496
local_output_nid generation:  0.008808374404907227
local_in_edges_tensor generation:  0.00894308090209961
mini_batch_src_global generation:  0.01838374137878418
r_  generation:  0.15203022956848145
local_output_nid generation:  0.008785009384155273
local_in_edges_tensor generation:  0.009049177169799805
mini_batch_src_global generation:  0.01861572265625
r_  generation:  0.15153002738952637
local_output_nid generation:  0.008938789367675781
local_in_edges_tensor generation:  0.008171558380126953
mini_batch_src_global generation:  0.018003225326538086
r_  generation:  0.148604154586792
local_output_nid generation:  0.009201526641845703
local_in_edges_tensor generation:  0.00896310806274414
mini_batch_src_global generation:  0.018443584442138672
r_  generation:  0.15030407905578613
local_output_nid generation:  0.009279489517211914
local_in_edges_tensor generation:  0.00908517837524414
mini_batch_src_global generation:  0.018620014190673828
r_  generation:  0.15270185470581055
local_output_nid generation:  0.009196281433105469
local_in_edges_tensor generation:  0.008375167846679688
mini_batch_src_global generation:  0.018707990646362305
r_  generation:  0.1488044261932373
local_output_nid generation:  0.009168624877929688
local_in_edges_tensor generation:  0.008278608322143555
mini_batch_src_global generation:  0.0191805362701416
r_  generation:  0.15215539932250977
local_output_nid generation:  0.009050369262695312
local_in_edges_tensor generation:  0.008085489273071289
mini_batch_src_global generation:  0.018070697784423828
r_  generation:  0.1484520435333252
local_output_nid generation:  0.009228706359863281
local_in_edges_tensor generation:  0.008868694305419922
mini_batch_src_global generation:  0.01901721954345703
r_  generation:  0.1561717987060547
local_output_nid generation:  0.011429071426391602
local_in_edges_tensor generation:  0.010076761245727539
mini_batch_src_global generation:  0.018988609313964844
r_  generation:  0.1554279327392578
local_output_nid generation:  0.009537696838378906
local_in_edges_tensor generation:  0.009060382843017578
mini_batch_src_global generation:  0.018597841262817383
r_  generation:  0.15721368789672852
local_output_nid generation:  0.009341001510620117
local_in_edges_tensor generation:  0.009014368057250977
mini_batch_src_global generation:  0.018805742263793945
r_  generation:  0.15288329124450684
local_output_nid generation:  0.009379863739013672
local_in_edges_tensor generation:  0.008204460144042969
mini_batch_src_global generation:  0.018488645553588867
r_  generation:  0.15784215927124023
local_output_nid generation:  0.009410858154296875
local_in_edges_tensor generation:  0.008847951889038086
mini_batch_src_global generation:  0.019194841384887695
r_  generation:  0.1533052921295166
local_output_nid generation:  0.009509801864624023
local_in_edges_tensor generation:  0.008849143981933594
mini_batch_src_global generation:  0.01886439323425293
r_  generation:  0.15795397758483887
local_output_nid generation:  0.009387969970703125
local_in_edges_tensor generation:  0.008702516555786133
mini_batch_src_global generation:  0.019036293029785156
r_  generation:  0.15701580047607422
local_output_nid generation:  0.009467363357543945
local_in_edges_tensor generation:  0.008652925491333008
mini_batch_src_global generation:  0.018563508987426758
r_  generation:  0.1586294174194336
local_output_nid generation:  0.009699344635009766
local_in_edges_tensor generation:  0.00936579704284668
mini_batch_src_global generation:  0.018951416015625
r_  generation:  0.15744900703430176
local_output_nid generation:  0.009490966796875
local_in_edges_tensor generation:  0.00907754898071289
mini_batch_src_global generation:  0.020394325256347656
r_  generation:  0.1552574634552002
local_output_nid generation:  0.00962972640991211
local_in_edges_tensor generation:  0.009356021881103516
mini_batch_src_global generation:  0.019702672958374023
r_  generation:  0.160017728805542
local_output_nid generation:  0.009346723556518555
local_in_edges_tensor generation:  0.008628606796264648
mini_batch_src_global generation:  0.019187211990356445
r_  generation:  0.15889334678649902
local_output_nid generation:  0.009554624557495117
local_in_edges_tensor generation:  0.008908510208129883
mini_batch_src_global generation:  0.018880367279052734
r_  generation:  0.15572333335876465
local_output_nid generation:  0.00968027114868164
local_in_edges_tensor generation:  0.008599042892456055
mini_batch_src_global generation:  0.019527912139892578
r_  generation:  0.15755796432495117
local_output_nid generation:  0.009588003158569336
local_in_edges_tensor generation:  0.009274005889892578
mini_batch_src_global generation:  0.01900005340576172
r_  generation:  0.15584588050842285
local_output_nid generation:  0.009685754776000977
local_in_edges_tensor generation:  0.008764505386352539
mini_batch_src_global generation:  0.018635988235473633
r_  generation:  0.15525293350219727
----------------------check_connections_block total spend ----------------------------- 7.257210969924927
generate_one_block  0.2021927833557129
generate_one_block  0.1925661563873291
generate_one_block  0.2066049575805664
generate_one_block  0.2047591209411621
generate_one_block  0.2399606704711914
generate_one_block  0.20044660568237305
generate_one_block  0.1996452808380127
generate_one_block  0.20193123817443848
generate_one_block  0.20396757125854492
generate_one_block  0.19635581970214844
generate_one_block  0.19822168350219727
generate_one_block  0.20531868934631348
generate_one_block  0.19587326049804688
generate_one_block  0.19849348068237305
generate_one_block  0.19434666633605957
generate_one_block  0.20038175582885742
generate_one_block  0.20958518981933594
generate_one_block  0.20521259307861328
generate_one_block  0.19670987129211426
generate_one_block  0.2039639949798584
generate_one_block  0.199845552444458
generate_one_block  0.20513653755187988
generate_one_block  0.20084142684936523
generate_one_block  0.2016294002532959
generate_one_block  0.20458078384399414
generate_one_block  0.19968748092651367
generate_one_block  0.20421648025512695
generate_one_block  0.20847678184509277
generate_one_block  0.20116543769836426
generate_one_block  0.20568037033081055
generate_one_block  0.20425844192504883
generate_one_block  0.19884848594665527
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033525705337524414
gen group dst list time:  0.0974891185760498
time for parepare:  0.019323110580444336
local_output_nid generation:  0.02357625961303711
local_in_edges_tensor generation:  0.042810678482055664
mini_batch_src_global generation:  0.037534475326538086
r_  generation:  0.4072530269622803
local_output_nid generation:  0.029990673065185547
local_in_edges_tensor generation:  0.03310561180114746
mini_batch_src_global generation:  0.048830509185791016
r_  generation:  0.39821791648864746
local_output_nid generation:  0.029703617095947266
local_in_edges_tensor generation:  0.026072263717651367
mini_batch_src_global generation:  0.048079490661621094
r_  generation:  0.41292881965637207
local_output_nid generation:  0.03017568588256836
local_in_edges_tensor generation:  0.029766082763671875
mini_batch_src_global generation:  0.051154136657714844
r_  generation:  0.41199493408203125
local_output_nid generation:  0.02997446060180664
local_in_edges_tensor generation:  0.030690908432006836
mini_batch_src_global generation:  0.048636436462402344
r_  generation:  0.41848301887512207
local_output_nid generation:  0.028969287872314453
local_in_edges_tensor generation:  0.02635931968688965
mini_batch_src_global generation:  0.04946088790893555
r_  generation:  0.409381628036499
local_output_nid generation:  0.027855873107910156
local_in_edges_tensor generation:  0.026745319366455078
mini_batch_src_global generation:  0.04817080497741699
r_  generation:  0.41974663734436035
local_output_nid generation:  0.028012514114379883
local_in_edges_tensor generation:  0.028536558151245117
mini_batch_src_global generation:  0.05067729949951172
r_  generation:  0.4121983051300049
local_output_nid generation:  0.028214216232299805
local_in_edges_tensor generation:  0.02908802032470703
mini_batch_src_global generation:  0.048082828521728516
r_  generation:  0.4194774627685547
local_output_nid generation:  0.028224468231201172
local_in_edges_tensor generation:  0.025980710983276367
mini_batch_src_global generation:  0.04920458793640137
r_  generation:  0.41017889976501465
local_output_nid generation:  0.027943849563598633
local_in_edges_tensor generation:  0.02594304084777832
mini_batch_src_global generation:  0.04809904098510742
r_  generation:  0.4146463871002197
local_output_nid generation:  0.028075218200683594
local_in_edges_tensor generation:  0.02594447135925293
mini_batch_src_global generation:  0.04972577095031738
r_  generation:  0.4101099967956543
local_output_nid generation:  0.028174877166748047
local_in_edges_tensor generation:  0.030495405197143555
mini_batch_src_global generation:  0.04804563522338867
r_  generation:  0.41823244094848633
local_output_nid generation:  0.02772235870361328
local_in_edges_tensor generation:  0.026092052459716797
mini_batch_src_global generation:  0.04917788505554199
r_  generation:  0.4075162410736084
local_output_nid generation:  0.027793407440185547
local_in_edges_tensor generation:  0.026285171508789062
mini_batch_src_global generation:  0.047280073165893555
r_  generation:  0.4120142459869385
local_output_nid generation:  0.028023719787597656
local_in_edges_tensor generation:  0.02874159812927246
mini_batch_src_global generation:  0.05171012878417969
r_  generation:  0.41242051124572754
local_output_nid generation:  0.028086423873901367
local_in_edges_tensor generation:  0.028085708618164062
mini_batch_src_global generation:  0.048467397689819336
r_  generation:  0.41677188873291016
local_output_nid generation:  0.028170347213745117
local_in_edges_tensor generation:  0.029818058013916016
mini_batch_src_global generation:  0.049805641174316406
r_  generation:  0.41081833839416504
local_output_nid generation:  0.027858495712280273
local_in_edges_tensor generation:  0.026925086975097656
mini_batch_src_global generation:  0.04801440238952637
r_  generation:  0.41669607162475586
local_output_nid generation:  0.027944087982177734
local_in_edges_tensor generation:  0.026662111282348633
mini_batch_src_global generation:  0.050911903381347656
r_  generation:  0.4121513366699219
local_output_nid generation:  0.028074264526367188
local_in_edges_tensor generation:  0.027489662170410156
mini_batch_src_global generation:  0.0497896671295166
r_  generation:  0.4161491394042969
local_output_nid generation:  0.02800440788269043
local_in_edges_tensor generation:  0.025814056396484375
mini_batch_src_global generation:  0.04959416389465332
r_  generation:  0.4137110710144043
local_output_nid generation:  0.0277862548828125
local_in_edges_tensor generation:  0.026033639907836914
mini_batch_src_global generation:  0.047852277755737305
r_  generation:  0.4195704460144043
local_output_nid generation:  0.02792525291442871
local_in_edges_tensor generation:  0.026656627655029297
mini_batch_src_global generation:  0.049349069595336914
r_  generation:  0.41384148597717285
local_output_nid generation:  0.027854442596435547
local_in_edges_tensor generation:  0.027846336364746094
mini_batch_src_global generation:  0.047811269760131836
r_  generation:  0.42206597328186035
local_output_nid generation:  0.028233051300048828
local_in_edges_tensor generation:  0.028148412704467773
mini_batch_src_global generation:  0.051505327224731445
r_  generation:  0.4156224727630615
local_output_nid generation:  0.027925729751586914
local_in_edges_tensor generation:  0.026869773864746094
mini_batch_src_global generation:  0.04794168472290039
r_  generation:  0.4209122657775879
local_output_nid generation:  0.02799201011657715
local_in_edges_tensor generation:  0.02947521209716797
mini_batch_src_global generation:  0.049797773361206055
r_  generation:  0.4188408851623535
local_output_nid generation:  0.02839970588684082
local_in_edges_tensor generation:  0.026807308197021484
mini_batch_src_global generation:  0.04830217361450195
r_  generation:  0.42562413215637207
local_output_nid generation:  0.027981996536254883
local_in_edges_tensor generation:  0.026517868041992188
mini_batch_src_global generation:  0.04945993423461914
r_  generation:  0.414445161819458
local_output_nid generation:  0.02801036834716797
local_in_edges_tensor generation:  0.02706742286682129
mini_batch_src_global generation:  0.04801130294799805
r_  generation:  0.42581772804260254
local_output_nid generation:  0.028048038482666016
local_in_edges_tensor generation:  0.02800130844116211
mini_batch_src_global generation:  0.04964256286621094
r_  generation:  0.41597747802734375
----------------------check_connections_block total spend ----------------------------- 19.58298087120056
generate_one_block  0.5470538139343262
generate_one_block  0.5460429191589355
generate_one_block  0.551231861114502
generate_one_block  0.5600006580352783
generate_one_block  0.6431891918182373
generate_one_block  0.5453910827636719
generate_one_block  0.545506477355957
generate_one_block  0.5478465557098389
generate_one_block  0.5563497543334961
generate_one_block  0.5458548069000244
generate_one_block  0.5468788146972656
generate_one_block  0.5555346012115479
generate_one_block  0.5517497062683105
generate_one_block  0.5516879558563232
generate_one_block  0.5466723442077637
generate_one_block  0.5541036128997803
generate_one_block  0.555631160736084
generate_one_block  0.5606667995452881
generate_one_block  0.5482015609741211
generate_one_block  0.548130989074707
generate_one_block  0.552739143371582
generate_one_block  0.562603235244751
generate_one_block  0.554506778717041
generate_one_block  0.5472064018249512
generate_one_block  0.5674059391021729
generate_one_block  0.5570192337036133
generate_one_block  0.5584671497344971
generate_one_block  0.5597724914550781
generate_one_block  0.5531373023986816
generate_one_block  0.5507948398590088
generate_one_block  0.5555934906005859
generate_one_block  0.5515367984771729
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12193536758422852  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  26.84019184112549
block generation total time  24.26941204071045
average batch blocks generation time:  0.7584191262722015
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527372360229492  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.036144733428955  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1045985221862793  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.540447235107422  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10532522201538086  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.199424743652344  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10493183135986328  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.20063018798828  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527706146240234  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.108548641204834  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10462665557861328  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.970972537994385  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10523843765258789  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.89821434020996  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10498380661010742  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.00605869293213  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.105255126953125  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.061737060546875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10466575622558594  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.66602611541748  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522127151489258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.767282009124756  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.104644775390625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.016517162322998  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10519933700561523  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.726407527923584  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10448169708251953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.738778591156006  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10517597198486328  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.54891300201416  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10480546951293945  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.838513374328613  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1052560806274414  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.0078444480896  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10485267639160156  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.07668972015381  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10521316528320312  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.72652816772461  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10460853576660156  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.83403205871582  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522651672363281  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.775745391845703  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10483551025390625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.070550441741943  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10524415969848633  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.994322776794434  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10482406616210938  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.888023853302002  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526895523071289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.056686878204346  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10476255416870117  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.003044605255127  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527324676513672  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.988967895507812  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10445547103881836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.12084197998047  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10524702072143555  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.005545139312744  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10463190078735352  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.069419384002686  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10525941848754883  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.035434246063232  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10501384735107422  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.86142110824585  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035118259489536285 |0.016431055963039398 |0.41642744094133377 |9.427964687347412e-05 |0.7529696598649025 |0.006697416305541992 |
----------------------------------------------------------pseudo_mini_loss sum 1.9298261404037476
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  8800293
Number of first layer input nodes during this epoch:  4682982
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12322568893432617  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024675607681274414
random selection method range initialization spend 0.005191802978515625
time for parepare:  0.019739627838134766
local_output_nid generation:  0.0014281272888183594
local_in_edges_tensor generation:  0.004840373992919922
mini_batch_src_global generation:  0.0018019676208496094
r_  generation:  0.010458946228027344
local_output_nid generation:  0.0017726421356201172
local_in_edges_tensor generation:  0.0010597705841064453
mini_batch_src_global generation:  0.0016760826110839844
r_  generation:  0.010478973388671875
local_output_nid generation:  0.001653432846069336
local_in_edges_tensor generation:  0.0009515285491943359
mini_batch_src_global generation:  0.0012047290802001953
r_  generation:  0.010206937789916992
local_output_nid generation:  0.001622915267944336
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0011563301086425781
r_  generation:  0.009637594223022461
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.0009262561798095703
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.010066986083984375
local_output_nid generation:  0.0016036033630371094
local_in_edges_tensor generation:  0.0009706020355224609
mini_batch_src_global generation:  0.0012309551239013672
r_  generation:  0.01030278205871582
local_output_nid generation:  0.0016224384307861328
local_in_edges_tensor generation:  0.0009212493896484375
mini_batch_src_global generation:  0.0011415481567382812
r_  generation:  0.010204315185546875
local_output_nid generation:  0.0016722679138183594
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0011591911315917969
r_  generation:  0.01033782958984375
local_output_nid generation:  0.0016486644744873047
local_in_edges_tensor generation:  0.0009396076202392578
mini_batch_src_global generation:  0.0012035369873046875
r_  generation:  0.01070261001586914
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.0008914470672607422
mini_batch_src_global generation:  0.0011944770812988281
r_  generation:  0.010150909423828125
local_output_nid generation:  0.0016083717346191406
local_in_edges_tensor generation:  0.0009212493896484375
mini_batch_src_global generation:  0.0011835098266601562
r_  generation:  0.010612010955810547
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0012090206146240234
r_  generation:  0.010319232940673828
local_output_nid generation:  0.0016093254089355469
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.0011713504791259766
r_  generation:  0.010037899017333984
local_output_nid generation:  0.0016412734985351562
local_in_edges_tensor generation:  0.0009143352508544922
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.01029205322265625
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.010385751724243164
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.0009016990661621094
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.010152816772460938
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0009031295776367188
mini_batch_src_global generation:  0.0011281967163085938
r_  generation:  0.010392189025878906
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.010465621948242188
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.001192331314086914
r_  generation:  0.010672569274902344
local_output_nid generation:  0.0015988349914550781
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.001203775405883789
r_  generation:  0.010411262512207031
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.010126829147338867
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.0009019374847412109
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.010315179824829102
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0008983612060546875
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.010277986526489258
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.0011548995971679688
r_  generation:  0.010274648666381836
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.010869741439819336
local_output_nid generation:  0.001598358154296875
local_in_edges_tensor generation:  0.0008969306945800781
mini_batch_src_global generation:  0.0012085437774658203
r_  generation:  0.010346651077270508
local_output_nid generation:  0.0015943050384521484
local_in_edges_tensor generation:  0.0008931159973144531
mini_batch_src_global generation:  0.0011250972747802734
r_  generation:  0.010381937026977539
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.010096311569213867
local_output_nid generation:  0.0016047954559326172
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.0012204647064208984
r_  generation:  0.010619878768920898
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.010168313980102539
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0008869171142578125
mini_batch_src_global generation:  0.001119852066040039
r_  generation:  0.010392189025878906
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0008792877197265625
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.010120153427124023
----------------------check_connections_block total spend ----------------------------- 0.5682468414306641
generate_one_block  0.02271747589111328
generate_one_block  0.020283937454223633
generate_one_block  0.01825261116027832
generate_one_block  0.0170590877532959
generate_one_block  0.018811464309692383
generate_one_block  0.017510175704956055
generate_one_block  0.017039060592651367
generate_one_block  0.01740264892578125
generate_one_block  0.017918825149536133
generate_one_block  0.01729297637939453
generate_one_block  0.017635345458984375
generate_one_block  0.017544984817504883
generate_one_block  0.016811847686767578
generate_one_block  0.01739811897277832
generate_one_block  0.017178058624267578
generate_one_block  0.017164945602416992
generate_one_block  0.017286062240600586
generate_one_block  0.017548561096191406
generate_one_block  0.01756906509399414
generate_one_block  0.017316341400146484
generate_one_block  0.01689887046813965
generate_one_block  0.01729440689086914
generate_one_block  0.017037630081176758
generate_one_block  0.01728224754333496
generate_one_block  0.018099546432495117
generate_one_block  0.017382383346557617
generate_one_block  0.017219066619873047
generate_one_block  0.016991615295410156
generate_one_block  0.017597198486328125
generate_one_block  0.017238616943359375
generate_one_block  0.017311811447143555
generate_one_block  0.01728510856628418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0409090518951416
gen group dst list time:  0.02283501625061035
time for parepare:  0.021847963333129883
local_output_nid generation:  0.006028890609741211
local_in_edges_tensor generation:  0.015614986419677734
mini_batch_src_global generation:  0.014256954193115234
r_  generation:  0.12888860702514648
local_output_nid generation:  0.00890207290649414
local_in_edges_tensor generation:  0.010720252990722656
mini_batch_src_global generation:  0.018151044845581055
r_  generation:  0.1431581974029541
local_output_nid generation:  0.0094146728515625
local_in_edges_tensor generation:  0.03317856788635254
mini_batch_src_global generation:  0.017251014709472656
r_  generation:  0.14878153800964355
local_output_nid generation:  0.009129762649536133
local_in_edges_tensor generation:  0.009053707122802734
mini_batch_src_global generation:  0.016610145568847656
r_  generation:  0.1427466869354248
local_output_nid generation:  0.009311914443969727
local_in_edges_tensor generation:  0.009023189544677734
mini_batch_src_global generation:  0.01831507682800293
r_  generation:  0.14993000030517578
local_output_nid generation:  0.009193658828735352
local_in_edges_tensor generation:  0.009114503860473633
mini_batch_src_global generation:  0.018157958984375
r_  generation:  0.1544344425201416
local_output_nid generation:  0.008821249008178711
local_in_edges_tensor generation:  0.00834512710571289
mini_batch_src_global generation:  0.018191814422607422
r_  generation:  0.14922213554382324
local_output_nid generation:  0.00895833969116211
local_in_edges_tensor generation:  0.009646177291870117
mini_batch_src_global generation:  0.01965045928955078
r_  generation:  0.15379118919372559
local_output_nid generation:  0.00924992561340332
local_in_edges_tensor generation:  0.010949373245239258
mini_batch_src_global generation:  0.02027273178100586
r_  generation:  0.15784430503845215
local_output_nid generation:  0.009078741073608398
local_in_edges_tensor generation:  0.008408308029174805
mini_batch_src_global generation:  0.01910686492919922
r_  generation:  0.1524355411529541
local_output_nid generation:  0.009451627731323242
local_in_edges_tensor generation:  0.008605718612670898
mini_batch_src_global generation:  0.01925945281982422
r_  generation:  0.15688776969909668
local_output_nid generation:  0.009324073791503906
local_in_edges_tensor generation:  0.008507966995239258
mini_batch_src_global generation:  0.019202232360839844
r_  generation:  0.15378785133361816
local_output_nid generation:  0.009259939193725586
local_in_edges_tensor generation:  0.008241891860961914
mini_batch_src_global generation:  0.018535614013671875
r_  generation:  0.14849328994750977
local_output_nid generation:  0.009383201599121094
local_in_edges_tensor generation:  0.008528470993041992
mini_batch_src_global generation:  0.019055604934692383
r_  generation:  0.1573796272277832
local_output_nid generation:  0.00929403305053711
local_in_edges_tensor generation:  0.008948087692260742
mini_batch_src_global generation:  0.018972396850585938
r_  generation:  0.15359711647033691
local_output_nid generation:  0.009515047073364258
local_in_edges_tensor generation:  0.009190797805786133
mini_batch_src_global generation:  0.019284963607788086
r_  generation:  0.15430450439453125
local_output_nid generation:  0.00936579704284668
local_in_edges_tensor generation:  0.009033203125
mini_batch_src_global generation:  0.018980979919433594
r_  generation:  0.15654373168945312
local_output_nid generation:  0.009477376937866211
local_in_edges_tensor generation:  0.009182453155517578
mini_batch_src_global generation:  0.020058870315551758
r_  generation:  0.15721702575683594
local_output_nid generation:  0.00967717170715332
local_in_edges_tensor generation:  0.008677244186401367
mini_batch_src_global generation:  0.020041704177856445
r_  generation:  0.1603102684020996
local_output_nid generation:  0.009353160858154297
local_in_edges_tensor generation:  0.008487939834594727
mini_batch_src_global generation:  0.01914358139038086
r_  generation:  0.1535348892211914
local_output_nid generation:  0.009188652038574219
local_in_edges_tensor generation:  0.00836491584777832
mini_batch_src_global generation:  0.018262147903442383
r_  generation:  0.15247440338134766
local_output_nid generation:  0.00950765609741211
local_in_edges_tensor generation:  0.00847172737121582
mini_batch_src_global generation:  0.018960952758789062
r_  generation:  0.15828561782836914
local_output_nid generation:  0.009315252304077148
local_in_edges_tensor generation:  0.011672735214233398
mini_batch_src_global generation:  0.018283605575561523
r_  generation:  0.15202546119689941
local_output_nid generation:  0.009530782699584961
local_in_edges_tensor generation:  0.009227991104125977
mini_batch_src_global generation:  0.02038884162902832
r_  generation:  0.15598249435424805
local_output_nid generation:  0.009682893753051758
local_in_edges_tensor generation:  0.009869098663330078
mini_batch_src_global generation:  0.019899368286132812
r_  generation:  0.16135835647583008
local_output_nid generation:  0.009290933609008789
local_in_edges_tensor generation:  0.008548498153686523
mini_batch_src_global generation:  0.0192720890045166
r_  generation:  0.15630054473876953
local_output_nid generation:  0.009205102920532227
local_in_edges_tensor generation:  0.009019613265991211
mini_batch_src_global generation:  0.018551111221313477
r_  generation:  0.15526723861694336
local_output_nid generation:  0.00932002067565918
local_in_edges_tensor generation:  0.008357763290405273
mini_batch_src_global generation:  0.018643617630004883
r_  generation:  0.15024590492248535
local_output_nid generation:  0.009436368942260742
local_in_edges_tensor generation:  0.009018659591674805
mini_batch_src_global generation:  0.019844770431518555
r_  generation:  0.15885376930236816
local_output_nid generation:  0.009443044662475586
local_in_edges_tensor generation:  0.008928298950195312
mini_batch_src_global generation:  0.019214630126953125
r_  generation:  0.1575002670288086
local_output_nid generation:  0.009490489959716797
local_in_edges_tensor generation:  0.0091094970703125
mini_batch_src_global generation:  0.018749713897705078
r_  generation:  0.15704965591430664
local_output_nid generation:  0.009392261505126953
local_in_edges_tensor generation:  0.008358240127563477
mini_batch_src_global generation:  0.018814563751220703
r_  generation:  0.15434646606445312
----------------------check_connections_block total spend ----------------------------- 7.279083967208862
generate_one_block  0.19376397132873535
generate_one_block  0.19898104667663574
generate_one_block  0.20476865768432617
generate_one_block  0.19468045234680176
generate_one_block  0.22724485397338867
generate_one_block  0.2038121223449707
generate_one_block  0.20164871215820312
generate_one_block  0.2079315185546875
generate_one_block  0.2108016014099121
generate_one_block  0.20279932022094727
generate_one_block  0.20969033241271973
generate_one_block  0.20283937454223633
generate_one_block  0.1993718147277832
generate_one_block  0.20752787590026855
generate_one_block  0.20109772682189941
generate_one_block  0.20864391326904297
generate_one_block  0.20604872703552246
generate_one_block  0.20911169052124023
generate_one_block  0.21079635620117188
generate_one_block  0.29810476303100586
generate_one_block  0.1989753246307373
generate_one_block  0.20534634590148926
generate_one_block  0.19800806045532227
generate_one_block  0.21045565605163574
generate_one_block  0.21393775939941406
generate_one_block  0.2042229175567627
generate_one_block  0.20120692253112793
generate_one_block  0.1969761848449707
generate_one_block  0.2118992805480957
generate_one_block  0.2038891315460205
generate_one_block  0.20523333549499512
generate_one_block  0.20278167724609375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03368115425109863
gen group dst list time:  0.09745025634765625
time for parepare:  0.01894974708557129
local_output_nid generation:  0.02309107780456543
local_in_edges_tensor generation:  0.03998589515686035
mini_batch_src_global generation:  0.03749871253967285
r_  generation:  0.3993363380432129
local_output_nid generation:  0.029422760009765625
local_in_edges_tensor generation:  0.03298807144165039
mini_batch_src_global generation:  0.04863262176513672
r_  generation:  0.40357184410095215
local_output_nid generation:  0.029715538024902344
local_in_edges_tensor generation:  0.02893543243408203
mini_batch_src_global generation:  0.04725813865661621
r_  generation:  0.42543935775756836
local_output_nid generation:  0.029279232025146484
local_in_edges_tensor generation:  0.025784730911254883
mini_batch_src_global generation:  0.04844474792480469
r_  generation:  0.40339183807373047
local_output_nid generation:  0.02970576286315918
local_in_edges_tensor generation:  0.027606964111328125
mini_batch_src_global generation:  0.04770469665527344
r_  generation:  0.42118120193481445
local_output_nid generation:  0.02892589569091797
local_in_edges_tensor generation:  0.026028156280517578
mini_batch_src_global generation:  0.049118995666503906
r_  generation:  0.41416454315185547
local_output_nid generation:  0.027454614639282227
local_in_edges_tensor generation:  0.026146888732910156
mini_batch_src_global generation:  0.04781603813171387
r_  generation:  0.41083621978759766
local_output_nid generation:  0.027698993682861328
local_in_edges_tensor generation:  0.027814865112304688
mini_batch_src_global generation:  0.049112558364868164
r_  generation:  0.40974926948547363
local_output_nid generation:  0.028232574462890625
local_in_edges_tensor generation:  0.028368473052978516
mini_batch_src_global generation:  0.05080223083496094
r_  generation:  0.423647403717041
local_output_nid generation:  0.027637958526611328
local_in_edges_tensor generation:  0.025923728942871094
mini_batch_src_global generation:  0.04889202117919922
r_  generation:  0.40592265129089355
local_output_nid generation:  0.027736663818359375
local_in_edges_tensor generation:  0.027823925018310547
mini_batch_src_global generation:  0.047968387603759766
r_  generation:  0.4181530475616455
local_output_nid generation:  0.02778768539428711
local_in_edges_tensor generation:  0.027827978134155273
mini_batch_src_global generation:  0.04899120330810547
r_  generation:  0.4095113277435303
local_output_nid generation:  0.027561426162719727
local_in_edges_tensor generation:  0.027460813522338867
mini_batch_src_global generation:  0.04661107063293457
r_  generation:  0.41339874267578125
local_output_nid generation:  0.027512550354003906
local_in_edges_tensor generation:  0.025499820709228516
mini_batch_src_global generation:  0.04892086982727051
r_  generation:  0.4073772430419922
local_output_nid generation:  0.02768111228942871
local_in_edges_tensor generation:  0.02865123748779297
mini_batch_src_global generation:  0.04758644104003906
r_  generation:  0.4217641353607178
local_output_nid generation:  0.02856731414794922
local_in_edges_tensor generation:  0.03175020217895508
mini_batch_src_global generation:  0.048796892166137695
r_  generation:  0.40926480293273926
local_output_nid generation:  0.027785778045654297
local_in_edges_tensor generation:  0.027573108673095703
mini_batch_src_global generation:  0.04746413230895996
r_  generation:  0.4175412654876709
local_output_nid generation:  0.028016090393066406
local_in_edges_tensor generation:  0.027663707733154297
mini_batch_src_global generation:  0.05047726631164551
r_  generation:  0.4153892993927002
local_output_nid generation:  0.0278627872467041
local_in_edges_tensor generation:  0.028435707092285156
mini_batch_src_global generation:  0.04833531379699707
r_  generation:  0.4222848415374756
local_output_nid generation:  0.027754783630371094
local_in_edges_tensor generation:  0.026034116744995117
mini_batch_src_global generation:  0.04849600791931152
r_  generation:  0.4090847969055176
local_output_nid generation:  0.027866363525390625
local_in_edges_tensor generation:  0.02577805519104004
mini_batch_src_global generation:  0.04667925834655762
r_  generation:  0.42073845863342285
local_output_nid generation:  0.02802419662475586
local_in_edges_tensor generation:  0.025864124298095703
mini_batch_src_global generation:  0.0506591796875
r_  generation:  0.4130363464355469
local_output_nid generation:  0.027971267700195312
local_in_edges_tensor generation:  0.026271343231201172
mini_batch_src_global generation:  0.04694032669067383
r_  generation:  0.42601585388183594
local_output_nid generation:  0.028081417083740234
local_in_edges_tensor generation:  0.029308319091796875
mini_batch_src_global generation:  0.04931521415710449
r_  generation:  0.420701265335083
local_output_nid generation:  0.028101682662963867
local_in_edges_tensor generation:  0.029225826263427734
mini_batch_src_global generation:  0.04755234718322754
r_  generation:  0.4229001998901367
local_output_nid generation:  0.028509140014648438
local_in_edges_tensor generation:  0.025915861129760742
mini_batch_src_global generation:  0.04892253875732422
r_  generation:  0.40990471839904785
local_output_nid generation:  0.027861833572387695
local_in_edges_tensor generation:  0.0257568359375
mini_batch_src_global generation:  0.04737377166748047
r_  generation:  0.4182577133178711
local_output_nid generation:  0.02759265899658203
local_in_edges_tensor generation:  0.027433156967163086
mini_batch_src_global generation:  0.049970388412475586
r_  generation:  0.40589451789855957
local_output_nid generation:  0.0277559757232666
local_in_edges_tensor generation:  0.02669358253479004
mini_batch_src_global generation:  0.047049522399902344
r_  generation:  0.4168241024017334
local_output_nid generation:  0.027959346771240234
local_in_edges_tensor generation:  0.027844905853271484
mini_batch_src_global generation:  0.04872274398803711
r_  generation:  0.4216794967651367
local_output_nid generation:  0.0278627872467041
local_in_edges_tensor generation:  0.02890467643737793
mini_batch_src_global generation:  0.05849266052246094
r_  generation:  0.4200558662414551
local_output_nid generation:  0.027903318405151367
local_in_edges_tensor generation:  0.02620530128479004
mini_batch_src_global generation:  0.049619436264038086
r_  generation:  0.4198169708251953
----------------------check_connections_block total spend ----------------------------- 19.571619033813477
generate_one_block  0.6556441783905029
generate_one_block  0.550950288772583
generate_one_block  0.5610504150390625
generate_one_block  0.5469462871551514
generate_one_block  0.5517880916595459
generate_one_block  0.5576004981994629
generate_one_block  0.5453126430511475
generate_one_block  0.5544488430023193
generate_one_block  0.5690343379974365
generate_one_block  0.5496771335601807
generate_one_block  0.5703892707824707
generate_one_block  0.5520732402801514
generate_one_block  0.5503969192504883
generate_one_block  0.5536806583404541
generate_one_block  0.5523910522460938
generate_one_block  0.5643892288208008
generate_one_block  0.551342248916626
generate_one_block  0.5535626411437988
generate_one_block  0.5579955577850342
generate_one_block  0.553290843963623
generate_one_block  0.556088924407959
generate_one_block  0.553168773651123
generate_one_block  0.5525779724121094
generate_one_block  0.5601241588592529
generate_one_block  0.5588514804840088
generate_one_block  0.5523416996002197
generate_one_block  0.5517966747283936
generate_one_block  0.5433621406555176
generate_one_block  0.5516126155853271
generate_one_block  0.5555598735809326
generate_one_block  0.553210973739624
generate_one_block  0.5682051181793213
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12322568893432617  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  26.85070300102234
block generation total time  24.511462211608887
average batch blocks generation time:  0.7659831941127777
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1051487922668457  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.466104984283447  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1046590805053711  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.815016269683838  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527610778808594  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.130706787109375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10446357727050781  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.516868114471436  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10523414611816406  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.870501041412354  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10448265075683594  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.039091110229492  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10520696640014648  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.616358757019043  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10466766357421875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.080111026763916  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10531282424926758  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.32252311706543  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10454082489013672  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.95498037338257  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529279708862305  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.18037176132202  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10480070114135742  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.851942539215088  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10517454147338867  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.56449842453003  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10467195510864258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.064496517181396  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10521650314331055  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.803256034851074  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10491609573364258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.070653915405273  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10525798797607422  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.004424571990967  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1044917106628418  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.15724515914917  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10531902313232422  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.279640197753906  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10482263565063477  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.825536727905273  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10519838333129883  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.61867046356201  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.104766845703125  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.921205043792725  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10518789291381836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.636922359466553  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10477876663208008  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.10340976715088  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10533809661865234  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.306735038757324  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10477542877197266  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.032440185546875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10523223876953125  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.914360523223877  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1044611930847168  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.607981204986572  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529041290283203  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.061968326568604  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10464954376220703  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.901866912841797  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10525798797607422  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.984193801879883  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10463571548461914  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.963080406188965  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03077111393213272 |0.012480348348617554 |0.4160851761698723 |9.272992610931396e-05 |0.7507178410887718 |0.00609135627746582 |
----------------------------------------------------------pseudo_mini_loss sum 1.8338981866836548
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  8795847
Number of first layer input nodes during this epoch:  4682232
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12394046783447266  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02416539192199707
random selection method range initialization spend 0.006865501403808594
time for parepare:  0.01883220672607422
local_output_nid generation:  0.0014460086822509766
local_in_edges_tensor generation:  0.007134199142456055
mini_batch_src_global generation:  0.00157928466796875
r_  generation:  0.010377168655395508
local_output_nid generation:  0.0017902851104736328
local_in_edges_tensor generation:  0.0010380744934082031
mini_batch_src_global generation:  0.0015521049499511719
r_  generation:  0.010211467742919922
local_output_nid generation:  0.0016627311706542969
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0011670589447021484
r_  generation:  0.009893178939819336
local_output_nid generation:  0.001634359359741211
local_in_edges_tensor generation:  0.0009324550628662109
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.010184526443481445
local_output_nid generation:  0.0015935897827148438
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.009761333465576172
local_output_nid generation:  0.0016064643859863281
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.0012443065643310547
r_  generation:  0.010213613510131836
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0009639263153076172
mini_batch_src_global generation:  0.0011124610900878906
r_  generation:  0.009801626205444336
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0009913444519042969
mini_batch_src_global generation:  0.0011186599731445312
r_  generation:  0.00974130630493164
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0011622905731201172
r_  generation:  0.010243892669677734
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0009028911590576172
mini_batch_src_global generation:  0.0011110305786132812
r_  generation:  0.010215282440185547
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0008788108825683594
mini_batch_src_global generation:  0.0011715888977050781
r_  generation:  0.010047435760498047
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.0011060237884521484
r_  generation:  0.010078191757202148
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0008976459503173828
mini_batch_src_global generation:  0.001188039779663086
r_  generation:  0.010133743286132812
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0009663105010986328
mini_batch_src_global generation:  0.0011975765228271484
r_  generation:  0.010349750518798828
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.001207113265991211
r_  generation:  0.010313749313354492
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0008895397186279297
mini_batch_src_global generation:  0.0011856555938720703
r_  generation:  0.010197639465332031
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0009028911590576172
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.010219097137451172
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0009691715240478516
mini_batch_src_global generation:  0.0011522769927978516
r_  generation:  0.010528802871704102
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0008931159973144531
mini_batch_src_global generation:  0.0011146068572998047
r_  generation:  0.010367870330810547
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.0008931159973144531
mini_batch_src_global generation:  0.0011088848114013672
r_  generation:  0.010227203369140625
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0012183189392089844
r_  generation:  0.01044321060180664
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0009064674377441406
mini_batch_src_global generation:  0.0012326240539550781
r_  generation:  0.010686397552490234
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.0012192726135253906
r_  generation:  0.01063394546508789
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.010329723358154297
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.0012094974517822266
r_  generation:  0.010497570037841797
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0009450912475585938
mini_batch_src_global generation:  0.00107574462890625
r_  generation:  0.009951353073120117
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0011036396026611328
r_  generation:  0.01018381118774414
local_output_nid generation:  0.0015690326690673828
local_in_edges_tensor generation:  0.0009465217590332031
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.010046005249023438
local_output_nid generation:  0.0015633106231689453
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.0011010169982910156
r_  generation:  0.010113716125488281
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0008652210235595703
mini_batch_src_global generation:  0.0010952949523925781
r_  generation:  0.010028839111328125
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0008933544158935547
mini_batch_src_global generation:  0.0011212825775146484
r_  generation:  0.010303974151611328
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009031295776367188
mini_batch_src_global generation:  0.0012459754943847656
r_  generation:  0.010620594024658203
----------------------check_connections_block total spend ----------------------------- 0.5651564598083496
generate_one_block  0.019604921340942383
generate_one_block  0.02074718475341797
generate_one_block  0.018167495727539062
generate_one_block  0.017835617065429688
generate_one_block  0.017166852951049805
generate_one_block  0.017552614212036133
generate_one_block  0.01672530174255371
generate_one_block  0.01667046546936035
generate_one_block  0.017589330673217773
generate_one_block  0.017397403717041016
generate_one_block  0.016963720321655273
generate_one_block  0.01729607582092285
generate_one_block  0.017210721969604492
generate_one_block  0.017792224884033203
generate_one_block  0.017965078353881836
generate_one_block  0.017593860626220703
generate_one_block  0.0176999568939209
generate_one_block  0.018201112747192383
generate_one_block  0.01765155792236328
generate_one_block  0.01749396324157715
generate_one_block  0.01804351806640625
generate_one_block  0.018570423126220703
generate_one_block  0.021855831146240234
generate_one_block  0.01814889907836914
generate_one_block  0.01799917221069336
generate_one_block  0.017165660858154297
generate_one_block  0.017725229263305664
generate_one_block  0.0172574520111084
generate_one_block  0.017515897750854492
generate_one_block  0.017076730728149414
generate_one_block  0.01768803596496582
generate_one_block  0.01796436309814453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040329933166503906
gen group dst list time:  0.020505905151367188
time for parepare:  0.020007848739624023
local_output_nid generation:  0.0062732696533203125
local_in_edges_tensor generation:  0.01898789405822754
mini_batch_src_global generation:  0.013700008392333984
r_  generation:  0.13206076622009277
local_output_nid generation:  0.009194135665893555
local_in_edges_tensor generation:  0.010683059692382812
mini_batch_src_global generation:  0.017863035202026367
r_  generation:  0.14040923118591309
local_output_nid generation:  0.009224414825439453
local_in_edges_tensor generation:  0.03158450126647949
mini_batch_src_global generation:  0.016717910766601562
r_  generation:  0.1442432403564453
local_output_nid generation:  0.009236574172973633
local_in_edges_tensor generation:  0.009027481079101562
mini_batch_src_global generation:  0.017765045166015625
r_  generation:  0.14715886116027832
local_output_nid generation:  0.008922576904296875
local_in_edges_tensor generation:  0.00830388069152832
mini_batch_src_global generation:  0.017773866653442383
r_  generation:  0.14804625511169434
local_output_nid generation:  0.008951902389526367
local_in_edges_tensor generation:  0.009505033493041992
mini_batch_src_global generation:  0.01915597915649414
r_  generation:  0.15165209770202637
local_output_nid generation:  0.008713722229003906
local_in_edges_tensor generation:  0.008321046829223633
mini_batch_src_global generation:  0.018167972564697266
r_  generation:  0.1474471092224121
local_output_nid generation:  0.008523702621459961
local_in_edges_tensor generation:  0.008785486221313477
mini_batch_src_global generation:  0.017731189727783203
r_  generation:  0.14376473426818848
local_output_nid generation:  0.009061336517333984
local_in_edges_tensor generation:  0.008772134780883789
mini_batch_src_global generation:  0.019716501235961914
r_  generation:  0.15530967712402344
local_output_nid generation:  0.009429931640625
local_in_edges_tensor generation:  0.008386850357055664
mini_batch_src_global generation:  0.018823862075805664
r_  generation:  0.15299320220947266
local_output_nid generation:  0.009252548217773438
local_in_edges_tensor generation:  0.008400440216064453
mini_batch_src_global generation:  0.018276691436767578
r_  generation:  0.14843320846557617
local_output_nid generation:  0.009229660034179688
local_in_edges_tensor generation:  0.008272647857666016
mini_batch_src_global generation:  0.018918991088867188
r_  generation:  0.1496727466583252
local_output_nid generation:  0.009369134902954102
local_in_edges_tensor generation:  0.009055852890014648
mini_batch_src_global generation:  0.018683433532714844
r_  generation:  0.15319085121154785
local_output_nid generation:  0.009411096572875977
local_in_edges_tensor generation:  0.009623289108276367
mini_batch_src_global generation:  0.018948793411254883
r_  generation:  0.1533210277557373
local_output_nid generation:  0.009382009506225586
local_in_edges_tensor generation:  0.00855112075805664
mini_batch_src_global generation:  0.019203662872314453
r_  generation:  0.15704965591430664
local_output_nid generation:  0.009308338165283203
local_in_edges_tensor generation:  0.008481264114379883
mini_batch_src_global generation:  0.018755674362182617
r_  generation:  0.15174365043640137
local_output_nid generation:  0.00937032699584961
local_in_edges_tensor generation:  0.00897669792175293
mini_batch_src_global generation:  0.018375873565673828
r_  generation:  0.15498566627502441
local_output_nid generation:  0.009646892547607422
local_in_edges_tensor generation:  0.009125947952270508
mini_batch_src_global generation:  0.019224882125854492
r_  generation:  0.15937566757202148
local_output_nid generation:  0.009574174880981445
local_in_edges_tensor generation:  0.008897542953491211
mini_batch_src_global generation:  0.019214630126953125
r_  generation:  0.15652132034301758
local_output_nid generation:  0.009301185607910156
local_in_edges_tensor generation:  0.008426904678344727
mini_batch_src_global generation:  0.019280195236206055
r_  generation:  0.15733885765075684
local_output_nid generation:  0.00959324836730957
local_in_edges_tensor generation:  0.00854182243347168
mini_batch_src_global generation:  0.018973112106323242
r_  generation:  0.15798091888427734
local_output_nid generation:  0.009614229202270508
local_in_edges_tensor generation:  0.009312868118286133
mini_batch_src_global generation:  0.01984095573425293
r_  generation:  0.16246891021728516
local_output_nid generation:  0.009685754776000977
local_in_edges_tensor generation:  0.008520126342773438
mini_batch_src_global generation:  0.019462108612060547
r_  generation:  0.16433429718017578
local_output_nid generation:  0.00933384895324707
local_in_edges_tensor generation:  0.00844717025756836
mini_batch_src_global generation:  0.019550323486328125
r_  generation:  0.15550708770751953
local_output_nid generation:  0.009462594985961914
local_in_edges_tensor generation:  0.008580923080444336
mini_batch_src_global generation:  0.018661022186279297
r_  generation:  0.15704703330993652
local_output_nid generation:  0.009102821350097656
local_in_edges_tensor generation:  0.008432149887084961
mini_batch_src_global generation:  0.018523693084716797
r_  generation:  0.14708375930786133
local_output_nid generation:  0.009358644485473633
local_in_edges_tensor generation:  0.00830984115600586
mini_batch_src_global generation:  0.019435882568359375
r_  generation:  0.1569507122039795
local_output_nid generation:  0.009162187576293945
local_in_edges_tensor generation:  0.010137081146240234
mini_batch_src_global generation:  0.018773555755615234
r_  generation:  0.15444207191467285
local_output_nid generation:  0.009174346923828125
local_in_edges_tensor generation:  0.010741472244262695
mini_batch_src_global generation:  0.018423795700073242
r_  generation:  0.15470385551452637
local_output_nid generation:  0.008966445922851562
local_in_edges_tensor generation:  0.008598089218139648
mini_batch_src_global generation:  0.01860642433166504
r_  generation:  0.15023303031921387
local_output_nid generation:  0.009387731552124023
local_in_edges_tensor generation:  0.01029348373413086
mini_batch_src_global generation:  0.01863384246826172
r_  generation:  0.15744948387145996
local_output_nid generation:  0.009594917297363281
local_in_edges_tensor generation:  0.008901596069335938
mini_batch_src_global generation:  0.019457578659057617
r_  generation:  0.15722966194152832
----------------------check_connections_block total spend ----------------------------- 7.240771532058716
generate_one_block  0.1955399513244629
generate_one_block  0.19701218605041504
generate_one_block  0.19984674453735352
generate_one_block  0.20195388793945312
generate_one_block  0.21506500244140625
generate_one_block  0.20433330535888672
generate_one_block  0.1960582733154297
generate_one_block  0.19161248207092285
generate_one_block  0.20664501190185547
generate_one_block  0.20112824440002441
generate_one_block  0.19377517700195312
generate_one_block  0.19728732109069824
generate_one_block  0.20226693153381348
generate_one_block  0.2087407112121582
generate_one_block  0.20752835273742676
generate_one_block  0.2003624439239502
generate_one_block  0.19782590866088867
generate_one_block  0.2058248519897461
generate_one_block  0.20597386360168457
generate_one_block  0.21140122413635254
generate_one_block  0.20751214027404785
generate_one_block  0.21304655075073242
generate_one_block  0.21981120109558105
generate_one_block  0.20564818382263184
generate_one_block  0.20622563362121582
generate_one_block  0.19321846961975098
generate_one_block  0.2056713104248047
generate_one_block  0.20164203643798828
generate_one_block  0.20240378379821777
generate_one_block  0.19783282279968262
generate_one_block  0.20985889434814453
generate_one_block  0.21087217330932617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030481576919555664
gen group dst list time:  0.10150790214538574
time for parepare:  0.020377397537231445
local_output_nid generation:  0.023509979248046875
local_in_edges_tensor generation:  0.04465937614440918
mini_batch_src_global generation:  0.03731799125671387
r_  generation:  0.3982369899749756
local_output_nid generation:  0.029378652572631836
local_in_edges_tensor generation:  0.03260087966918945
mini_batch_src_global generation:  0.04690194129943848
r_  generation:  0.40371131896972656
local_output_nid generation:  0.029253244400024414
local_in_edges_tensor generation:  0.029278039932250977
mini_batch_src_global generation:  0.046124935150146484
r_  generation:  0.4115135669708252
local_output_nid generation:  0.029285430908203125
local_in_edges_tensor generation:  0.024834871292114258
mini_batch_src_global generation:  0.05173063278198242
r_  generation:  0.4080798625946045
local_output_nid generation:  0.02936697006225586
local_in_edges_tensor generation:  0.025861024856567383
mini_batch_src_global generation:  0.0489046573638916
r_  generation:  0.41605305671691895
local_output_nid generation:  0.029205322265625
local_in_edges_tensor generation:  0.028412580490112305
mini_batch_src_global generation:  0.049213409423828125
r_  generation:  0.40825843811035156
local_output_nid generation:  0.02748727798461914
local_in_edges_tensor generation:  0.026180028915405273
mini_batch_src_global generation:  0.04780936241149902
r_  generation:  0.4174385070800781
local_output_nid generation:  0.027250051498413086
local_in_edges_tensor generation:  0.025730371475219727
mini_batch_src_global generation:  0.048629045486450195
r_  generation:  0.40136051177978516
local_output_nid generation:  0.02776336669921875
local_in_edges_tensor generation:  0.026398897171020508
mini_batch_src_global generation:  0.047659873962402344
r_  generation:  0.4169926643371582
local_output_nid generation:  0.027695417404174805
local_in_edges_tensor generation:  0.03095698356628418
mini_batch_src_global generation:  0.0514678955078125
r_  generation:  0.4095425605773926
local_output_nid generation:  0.02742314338684082
local_in_edges_tensor generation:  0.02593708038330078
mini_batch_src_global generation:  0.04784131050109863
r_  generation:  0.41257309913635254
local_output_nid generation:  0.027395009994506836
local_in_edges_tensor generation:  0.026329517364501953
mini_batch_src_global generation:  0.04910707473754883
r_  generation:  0.40875768661499023
local_output_nid generation:  0.027596235275268555
local_in_edges_tensor generation:  0.02515864372253418
mini_batch_src_global generation:  0.04754376411437988
r_  generation:  0.4177577495574951
local_output_nid generation:  0.02761554718017578
local_in_edges_tensor generation:  0.027254581451416016
mini_batch_src_global generation:  0.04927420616149902
r_  generation:  0.4124126434326172
local_output_nid generation:  0.027953624725341797
local_in_edges_tensor generation:  0.026460886001586914
mini_batch_src_global generation:  0.04804420471191406
r_  generation:  0.4234752655029297
local_output_nid generation:  0.027921199798583984
local_in_edges_tensor generation:  0.028985023498535156
mini_batch_src_global generation:  0.04927802085876465
r_  generation:  0.4124295711517334
local_output_nid generation:  0.027635812759399414
local_in_edges_tensor generation:  0.027373552322387695
mini_batch_src_global generation:  0.047247886657714844
r_  generation:  0.41670703887939453
local_output_nid generation:  0.02791452407836914
local_in_edges_tensor generation:  0.026218891143798828
mini_batch_src_global generation:  0.04916954040527344
r_  generation:  0.41651082038879395
local_output_nid generation:  0.027798891067504883
local_in_edges_tensor generation:  0.031261444091796875
mini_batch_src_global generation:  0.04948830604553223
r_  generation:  0.421034574508667
local_output_nid generation:  0.02777266502380371
local_in_edges_tensor generation:  0.025998830795288086
mini_batch_src_global generation:  0.04933571815490723
r_  generation:  0.41159939765930176
local_output_nid generation:  0.027617692947387695
local_in_edges_tensor generation:  0.025145292282104492
mini_batch_src_global generation:  0.04720735549926758
r_  generation:  0.424100399017334
local_output_nid generation:  0.027730703353881836
local_in_edges_tensor generation:  0.027707815170288086
mini_batch_src_global generation:  0.05067777633666992
r_  generation:  0.4125816822052002
local_output_nid generation:  0.027924299240112305
local_in_edges_tensor generation:  0.030986785888671875
mini_batch_src_global generation:  0.048537254333496094
r_  generation:  0.4222424030303955
local_output_nid generation:  0.027557373046875
local_in_edges_tensor generation:  0.026493549346923828
mini_batch_src_global generation:  0.050157785415649414
r_  generation:  0.40840911865234375
local_output_nid generation:  0.02766251564025879
local_in_edges_tensor generation:  0.02589130401611328
mini_batch_src_global generation:  0.047421932220458984
r_  generation:  0.4172861576080322
local_output_nid generation:  0.02733302116394043
local_in_edges_tensor generation:  0.025902271270751953
mini_batch_src_global generation:  0.04944181442260742
r_  generation:  0.4071037769317627
local_output_nid generation:  0.027561664581298828
local_in_edges_tensor generation:  0.025787830352783203
mini_batch_src_global generation:  0.04777836799621582
r_  generation:  0.4188497066497803
local_output_nid generation:  0.027677297592163086
local_in_edges_tensor generation:  0.02950906753540039
mini_batch_src_global generation:  0.04955005645751953
r_  generation:  0.41075968742370605
local_output_nid generation:  0.027363300323486328
local_in_edges_tensor generation:  0.02550959587097168
mini_batch_src_global generation:  0.04772067070007324
r_  generation:  0.4182431697845459
local_output_nid generation:  0.02718830108642578
local_in_edges_tensor generation:  0.025923490524291992
mini_batch_src_global generation:  0.049617767333984375
r_  generation:  0.41352152824401855
local_output_nid generation:  0.028005599975585938
local_in_edges_tensor generation:  0.027608156204223633
mini_batch_src_global generation:  0.050208091735839844
r_  generation:  0.4256868362426758
local_output_nid generation:  0.027822017669677734
local_in_edges_tensor generation:  0.030830860137939453
mini_batch_src_global generation:  0.04983234405517578
r_  generation:  0.4130892753601074
----------------------check_connections_block total spend ----------------------------- 19.509875774383545
generate_one_block  0.5541071891784668
generate_one_block  0.5453653335571289
generate_one_block  0.5591027736663818
generate_one_block  0.5620763301849365
generate_one_block  0.6353836059570312
generate_one_block  0.5572178363800049
generate_one_block  0.5480825901031494
generate_one_block  0.5441219806671143
generate_one_block  0.5545134544372559
generate_one_block  0.5616335868835449
generate_one_block  0.5493423938751221
generate_one_block  0.5442397594451904
generate_one_block  0.5542516708374023
generate_one_block  0.5574655532836914
generate_one_block  0.5608422756195068
generate_one_block  0.5603301525115967
generate_one_block  0.5487663745880127
generate_one_block  0.5600154399871826
generate_one_block  0.5591750144958496
generate_one_block  0.5590410232543945
generate_one_block  0.5610766410827637
generate_one_block  0.5583865642547607
generate_one_block  0.5614988803863525
generate_one_block  0.5540568828582764
generate_one_block  0.5702672004699707
generate_one_block  0.5441663265228271
generate_one_block  0.5528216361999512
generate_one_block  0.5578997135162354
generate_one_block  0.5472779273986816
generate_one_block  0.5438385009765625
generate_one_block  0.5568735599517822
generate_one_block  0.5555086135864258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12394046783447266  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  26.75064730644226
block generation total time  24.35267186164856
average batch blocks generation time:  0.7610209956765175
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10518407821655273  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.593099117279053  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10466718673706055  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.69935941696167  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522127151489258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.766796112060547  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10462665557861328  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.995182991027832  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522317886352539  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.898122787475586  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10428094863891602  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.055866241455078  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10518026351928711  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.589443683624268  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10462760925292969  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.43748188018799  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10528850555419922  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.138376235961914  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10471248626708984  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.914327144622803  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10517501831054688  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.567567825317383  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10460710525512695  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.652634620666504  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522937774658203  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.810213565826416  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10458755493164062  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.973358631134033  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529136657714844  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.245768547058105  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10480833053588867  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.836113452911377  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10521841049194336  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.764132022857666  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10482597351074219  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.216211318969727  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10525989532470703  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.004212379455566  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10469579696655273  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.12439489364624  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10528993606567383  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.161712169647217  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10466527938842773  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.36207342147827  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10535335540771484  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.425092697143555  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10454130172729492  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.9963321685791  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1052694320678711  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.092920303344727  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10460996627807617  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.431575775146484  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527229309082031  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.06435489654541  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10467529296875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.93177080154419  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1052398681640625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.893935203552246  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1042623519897461  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.612299919128418  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527801513671875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.16782808303833  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10465240478515625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.176269054412842  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03540276736021042 |0.01536601036787033 |0.4190395921468735 |9.450316429138184e-05 |0.7582214027643204 |0.005486488342285156 |
----------------------------------------------------------pseudo_mini_loss sum 1.7706154584884644
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  8791460
Number of first layer input nodes during this epoch:  4679888
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12305450439453125  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023960590362548828
random selection method range initialization spend 0.00662684440612793
time for parepare:  0.02013874053955078
local_output_nid generation:  0.001402139663696289
local_in_edges_tensor generation:  0.0068323612213134766
mini_batch_src_global generation:  0.002355813980102539
r_  generation:  0.019259929656982422
local_output_nid generation:  0.0017046928405761719
local_in_edges_tensor generation:  0.0009930133819580078
mini_batch_src_global generation:  0.0017812252044677734
r_  generation:  0.010870218276977539
local_output_nid generation:  0.0016596317291259766
local_in_edges_tensor generation:  0.0009379386901855469
mini_batch_src_global generation:  0.0012118816375732422
r_  generation:  0.009912252426147461
local_output_nid generation:  0.001615762710571289
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0011019706726074219
r_  generation:  0.009428977966308594
local_output_nid generation:  0.0016047954559326172
local_in_edges_tensor generation:  0.0009341239929199219
mini_batch_src_global generation:  0.0011878013610839844
r_  generation:  0.01005864143371582
local_output_nid generation:  0.0016033649444580078
local_in_edges_tensor generation:  0.0008864402770996094
mini_batch_src_global generation:  0.0012111663818359375
r_  generation:  0.010178804397583008
local_output_nid generation:  0.0016562938690185547
local_in_edges_tensor generation:  0.0009071826934814453
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.010301589965820312
local_output_nid generation:  0.0016002655029296875
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.0011835098266601562
r_  generation:  0.010442018508911133
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.010264396667480469
local_output_nid generation:  0.001627206802368164
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.010011434555053711
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.0011920928955078125
r_  generation:  0.010427236557006836
local_output_nid generation:  0.0016198158264160156
local_in_edges_tensor generation:  0.0008957386016845703
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.010136604309082031
local_output_nid generation:  0.001650094985961914
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.001129150390625
r_  generation:  0.00994253158569336
local_output_nid generation:  0.0016145706176757812
local_in_edges_tensor generation:  0.0009224414825439453
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.010117292404174805
local_output_nid generation:  0.0016045570373535156
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.001186370849609375
r_  generation:  0.010902643203735352
local_output_nid generation:  0.0016090869903564453
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0012013912200927734
r_  generation:  0.010482549667358398
local_output_nid generation:  0.0016269683837890625
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0011777877807617188
r_  generation:  0.010167598724365234
local_output_nid generation:  0.0016169548034667969
local_in_edges_tensor generation:  0.0008931159973144531
mini_batch_src_global generation:  0.0011925697326660156
r_  generation:  0.010077953338623047
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0008447170257568359
mini_batch_src_global generation:  0.001110076904296875
r_  generation:  0.011479854583740234
local_output_nid generation:  0.0016276836395263672
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.0011682510375976562
r_  generation:  0.010477542877197266
local_output_nid generation:  0.0016086101531982422
local_in_edges_tensor generation:  0.0008809566497802734
mini_batch_src_global generation:  0.0011708736419677734
r_  generation:  0.010116815567016602
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.000885009765625
mini_batch_src_global generation:  0.00113677978515625
r_  generation:  0.010371208190917969
local_output_nid generation:  0.0016269683837890625
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.001188039779663086
r_  generation:  0.009980201721191406
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.0008912086486816406
mini_batch_src_global generation:  0.0012094974517822266
r_  generation:  0.010254859924316406
local_output_nid generation:  0.0015647411346435547
local_in_edges_tensor generation:  0.0008497238159179688
mini_batch_src_global generation:  0.0011553764343261719
r_  generation:  0.011601924896240234
local_output_nid generation:  0.0016014575958251953
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0011746883392333984
r_  generation:  0.01031351089477539
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.0011723041534423828
r_  generation:  0.010204792022705078
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.009928464889526367
local_output_nid generation:  0.001631021499633789
local_in_edges_tensor generation:  0.0008702278137207031
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.010196208953857422
local_output_nid generation:  0.0016138553619384766
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0012598037719726562
r_  generation:  0.010578155517578125
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0009257793426513672
mini_batch_src_global generation:  0.001215219497680664
r_  generation:  0.01098775863647461
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0012481212615966797
r_  generation:  0.010671138763427734
----------------------check_connections_block total spend ----------------------------- 0.5876424312591553
generate_one_block  0.02312755584716797
generate_one_block  0.02064228057861328
generate_one_block  0.018065452575683594
generate_one_block  0.016777515411376953
generate_one_block  0.02005934715270996
generate_one_block  0.017431974411010742
generate_one_block  0.017474651336669922
generate_one_block  0.017832040786743164
generate_one_block  0.017449140548706055
generate_one_block  0.017075300216674805
generate_one_block  0.019954919815063477
generate_one_block  0.017409086227416992
generate_one_block  0.01686835289001465
generate_one_block  0.017286300659179688
generate_one_block  0.018216609954833984
generate_one_block  0.017643213272094727
generate_one_block  0.019483089447021484
generate_one_block  0.017120838165283203
generate_one_block  0.017021656036376953
generate_one_block  0.01769256591796875
generate_one_block  0.017052888870239258
generate_one_block  0.017444133758544922
generate_one_block  0.02292633056640625
generate_one_block  0.017922401428222656
generate_one_block  0.01711297035217285
generate_one_block  0.017323017120361328
generate_one_block  0.017092466354370117
generate_one_block  0.019254684448242188
generate_one_block  0.01751852035522461
generate_one_block  0.017848491668701172
generate_one_block  0.018126249313354492
generate_one_block  0.018021106719970703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.09949564933776855
gen group dst list time:  0.0324254035949707
time for parepare:  0.03176593780517578
local_output_nid generation:  0.006877422332763672
local_in_edges_tensor generation:  0.020010948181152344
mini_batch_src_global generation:  0.015557050704956055
r_  generation:  0.15192341804504395
local_output_nid generation:  0.009050130844116211
local_in_edges_tensor generation:  0.01492619514465332
mini_batch_src_global generation:  0.020750999450683594
r_  generation:  0.1499946117401123
local_output_nid generation:  0.010103225708007812
local_in_edges_tensor generation:  0.03579211235046387
mini_batch_src_global generation:  0.01958775520324707
r_  generation:  0.14728784561157227
local_output_nid generation:  0.008820772171020508
local_in_edges_tensor generation:  0.011620283126831055
mini_batch_src_global generation:  0.016851425170898438
r_  generation:  0.13754558563232422
local_output_nid generation:  0.009368658065795898
local_in_edges_tensor generation:  0.012374639511108398
mini_batch_src_global generation:  0.018629789352416992
r_  generation:  0.1536569595336914
local_output_nid generation:  0.008695363998413086
local_in_edges_tensor generation:  0.010617494583129883
mini_batch_src_global generation:  0.018151044845581055
r_  generation:  0.147871732711792
local_output_nid generation:  0.008900880813598633
local_in_edges_tensor generation:  0.009636163711547852
mini_batch_src_global generation:  0.018648147583007812
r_  generation:  0.15153026580810547
local_output_nid generation:  0.008989572525024414
local_in_edges_tensor generation:  0.01163625717163086
mini_batch_src_global generation:  0.019416093826293945
r_  generation:  0.15191411972045898
local_output_nid generation:  0.008807182312011719
local_in_edges_tensor generation:  0.009767293930053711
mini_batch_src_global generation:  0.0188906192779541
r_  generation:  0.15212798118591309
local_output_nid generation:  0.009158849716186523
local_in_edges_tensor generation:  0.009552478790283203
mini_batch_src_global generation:  0.018696069717407227
r_  generation:  0.14842462539672852
local_output_nid generation:  0.009185314178466797
local_in_edges_tensor generation:  0.009929418563842773
mini_batch_src_global generation:  0.019064903259277344
r_  generation:  0.1571061611175537
local_output_nid generation:  0.009132862091064453
local_in_edges_tensor generation:  0.009555816650390625
mini_batch_src_global generation:  0.01872420310974121
r_  generation:  0.15136480331420898
local_output_nid generation:  0.009048938751220703
local_in_edges_tensor generation:  0.009521007537841797
mini_batch_src_global generation:  0.018706083297729492
r_  generation:  0.15091347694396973
local_output_nid generation:  0.009237527847290039
local_in_edges_tensor generation:  0.009920120239257812
mini_batch_src_global generation:  0.02019977569580078
r_  generation:  0.1536874771118164
local_output_nid generation:  0.010359764099121094
local_in_edges_tensor generation:  0.013132572174072266
mini_batch_src_global generation:  0.020400047302246094
r_  generation:  0.1587822437286377
local_output_nid generation:  0.009520769119262695
local_in_edges_tensor generation:  0.010835886001586914
mini_batch_src_global generation:  0.02019786834716797
r_  generation:  0.15800690650939941
local_output_nid generation:  0.00954890251159668
local_in_edges_tensor generation:  0.009528636932373047
mini_batch_src_global generation:  0.018758296966552734
r_  generation:  0.1509687900543213
local_output_nid generation:  0.009444952011108398
local_in_edges_tensor generation:  0.00975942611694336
mini_batch_src_global generation:  0.018474102020263672
r_  generation:  0.15446019172668457
local_output_nid generation:  0.009387969970703125
local_in_edges_tensor generation:  0.009921550750732422
mini_batch_src_global generation:  0.018911123275756836
r_  generation:  0.15298676490783691
local_output_nid generation:  0.009659528732299805
local_in_edges_tensor generation:  0.009831905364990234
mini_batch_src_global generation:  0.019451141357421875
r_  generation:  0.15596699714660645
local_output_nid generation:  0.009401559829711914
local_in_edges_tensor generation:  0.00978994369506836
mini_batch_src_global generation:  0.019115686416625977
r_  generation:  0.15285420417785645
local_output_nid generation:  0.009377479553222656
local_in_edges_tensor generation:  0.009917020797729492
mini_batch_src_global generation:  0.019240379333496094
r_  generation:  0.1571199893951416
local_output_nid generation:  0.009270191192626953
local_in_edges_tensor generation:  0.009519338607788086
mini_batch_src_global generation:  0.01868414878845215
r_  generation:  0.14984607696533203
local_output_nid generation:  0.009369373321533203
local_in_edges_tensor generation:  0.009786844253540039
mini_batch_src_global generation:  0.018799781799316406
r_  generation:  0.15298819541931152
local_output_nid generation:  0.00941777229309082
local_in_edges_tensor generation:  0.009659051895141602
mini_batch_src_global generation:  0.018656492233276367
r_  generation:  0.15386104583740234
local_output_nid generation:  0.009382963180541992
local_in_edges_tensor generation:  0.009510517120361328
mini_batch_src_global generation:  0.0188291072845459
r_  generation:  0.15364599227905273
local_output_nid generation:  0.00940251350402832
local_in_edges_tensor generation:  0.009662151336669922
mini_batch_src_global generation:  0.018625974655151367
r_  generation:  0.15294814109802246
local_output_nid generation:  0.0092315673828125
local_in_edges_tensor generation:  0.00972294807434082
mini_batch_src_global generation:  0.01819324493408203
r_  generation:  0.14965176582336426
local_output_nid generation:  0.009446859359741211
local_in_edges_tensor generation:  0.009474992752075195
mini_batch_src_global generation:  0.020908117294311523
r_  generation:  0.15386533737182617
local_output_nid generation:  0.00961446762084961
local_in_edges_tensor generation:  0.009916543960571289
mini_batch_src_global generation:  0.020101308822631836
r_  generation:  0.1585240364074707
local_output_nid generation:  0.010042905807495117
local_in_edges_tensor generation:  0.011797189712524414
mini_batch_src_global generation:  0.020721435546875
r_  generation:  0.17223834991455078
local_output_nid generation:  0.00964045524597168
local_in_edges_tensor generation:  0.010275125503540039
mini_batch_src_global generation:  0.019991636276245117
r_  generation:  0.16327977180480957
----------------------check_connections_block total spend ----------------------------- 7.365112543106079
generate_one_block  0.21266603469848633
generate_one_block  0.19962739944458008
generate_one_block  0.19986510276794434
generate_one_block  0.18691444396972656
generate_one_block  0.2206559181213379
generate_one_block  0.19850564002990723
generate_one_block  0.2019195556640625
generate_one_block  0.20246219635009766
generate_one_block  0.20168733596801758
generate_one_block  0.19404816627502441
generate_one_block  0.20395112037658691
generate_one_block  0.19908833503723145
generate_one_block  0.1997840404510498
generate_one_block  0.20670056343078613
generate_one_block  0.21390271186828613
generate_one_block  0.2097764015197754
generate_one_block  0.20253396034240723
generate_one_block  0.20259356498718262
generate_one_block  0.20417046546936035
generate_one_block  0.2106800079345703
generate_one_block  0.2018108367919922
generate_one_block  0.20881962776184082
generate_one_block  0.19585013389587402
generate_one_block  0.20273971557617188
generate_one_block  0.20411467552185059
generate_one_block  0.2033991813659668
generate_one_block  0.2000288963317871
generate_one_block  0.1934986114501953
generate_one_block  0.20134902000427246
generate_one_block  0.20712947845458984
generate_one_block  0.21329021453857422
generate_one_block  0.21030807495117188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0370631217956543
gen group dst list time:  0.10787606239318848
time for parepare:  0.020242929458618164
local_output_nid generation:  0.024212360382080078
local_in_edges_tensor generation:  0.049950361251831055
mini_batch_src_global generation:  0.03710794448852539
r_  generation:  0.3966841697692871
local_output_nid generation:  0.03128623962402344
local_in_edges_tensor generation:  0.03417253494262695
mini_batch_src_global generation:  0.04783034324645996
r_  generation:  0.3973696231842041
local_output_nid generation:  0.0294644832611084
local_in_edges_tensor generation:  0.02747178077697754
mini_batch_src_global generation:  0.04689598083496094
r_  generation:  0.4204678535461426
local_output_nid generation:  0.029066085815429688
local_in_edges_tensor generation:  0.02959752082824707
mini_batch_src_global generation:  0.047905683517456055
r_  generation:  0.39823055267333984
local_output_nid generation:  0.029198169708251953
local_in_edges_tensor generation:  0.027287006378173828
mini_batch_src_global generation:  0.04698324203491211
r_  generation:  0.41440796852111816
local_output_nid generation:  0.02871537208557129
local_in_edges_tensor generation:  0.03121638298034668
mini_batch_src_global generation:  0.050731658935546875
r_  generation:  0.40638160705566406
local_output_nid generation:  0.02778768539428711
local_in_edges_tensor generation:  0.030092239379882812
mini_batch_src_global generation:  0.048126220703125
r_  generation:  0.4145848751068115
local_output_nid generation:  0.027632474899291992
local_in_edges_tensor generation:  0.0292966365814209
mini_batch_src_global generation:  0.050794124603271484
r_  generation:  0.4082920551300049
local_output_nid generation:  0.028469085693359375
local_in_edges_tensor generation:  0.027997255325317383
mini_batch_src_global generation:  0.04754781723022461
r_  generation:  0.41820240020751953
local_output_nid generation:  0.02782464027404785
local_in_edges_tensor generation:  0.027324199676513672
mini_batch_src_global generation:  0.05138969421386719
r_  generation:  0.4092574119567871
local_output_nid generation:  0.027834653854370117
local_in_edges_tensor generation:  0.027587413787841797
mini_batch_src_global generation:  0.04983210563659668
r_  generation:  0.4149515628814697
local_output_nid generation:  0.027591466903686523
local_in_edges_tensor generation:  0.030890941619873047
mini_batch_src_global generation:  0.05098748207092285
r_  generation:  0.4038984775543213
local_output_nid generation:  0.02780318260192871
local_in_edges_tensor generation:  0.025719165802001953
mini_batch_src_global generation:  0.0474550724029541
r_  generation:  0.4124789237976074
local_output_nid generation:  0.027958393096923828
local_in_edges_tensor generation:  0.028440475463867188
mini_batch_src_global generation:  0.05319786071777344
r_  generation:  0.4059591293334961
local_output_nid generation:  0.028080224990844727
local_in_edges_tensor generation:  0.029127836227416992
mini_batch_src_global generation:  0.04842638969421387
r_  generation:  0.42758750915527344
local_output_nid generation:  0.027724742889404297
local_in_edges_tensor generation:  0.025988340377807617
mini_batch_src_global generation:  0.0572965145111084
r_  generation:  0.4090869426727295
local_output_nid generation:  0.029865026473999023
local_in_edges_tensor generation:  0.027835845947265625
mini_batch_src_global generation:  0.048494577407836914
r_  generation:  0.41184282302856445
local_output_nid generation:  0.028174400329589844
local_in_edges_tensor generation:  0.027509689331054688
mini_batch_src_global generation:  0.051072120666503906
r_  generation:  0.406078577041626
local_output_nid generation:  0.02835822105407715
local_in_edges_tensor generation:  0.025873422622680664
mini_batch_src_global generation:  0.04721832275390625
r_  generation:  0.410888671875
local_output_nid generation:  0.02849435806274414
local_in_edges_tensor generation:  0.02738642692565918
mini_batch_src_global generation:  0.04925179481506348
r_  generation:  0.40943002700805664
local_output_nid generation:  0.02821969985961914
local_in_edges_tensor generation:  0.027650117874145508
mini_batch_src_global generation:  0.04824519157409668
r_  generation:  0.4133262634277344
local_output_nid generation:  0.028148412704467773
local_in_edges_tensor generation:  0.025422334671020508
mini_batch_src_global generation:  0.04902982711791992
r_  generation:  0.40922093391418457
local_output_nid generation:  0.02811408042907715
local_in_edges_tensor generation:  0.02527642250061035
mini_batch_src_global generation:  0.047594308853149414
r_  generation:  0.41022777557373047
local_output_nid generation:  0.028330087661743164
local_in_edges_tensor generation:  0.025354385375976562
mini_batch_src_global generation:  0.051178693771362305
r_  generation:  0.41123294830322266
local_output_nid generation:  0.028211355209350586
local_in_edges_tensor generation:  0.03155994415283203
mini_batch_src_global generation:  0.04731154441833496
r_  generation:  0.41773438453674316
local_output_nid generation:  0.028377532958984375
local_in_edges_tensor generation:  0.025464296340942383
mini_batch_src_global generation:  0.05692005157470703
r_  generation:  0.40986061096191406
local_output_nid generation:  0.02859187126159668
local_in_edges_tensor generation:  0.028006315231323242
mini_batch_src_global generation:  0.04932522773742676
r_  generation:  0.41425657272338867
local_output_nid generation:  0.028328657150268555
local_in_edges_tensor generation:  0.025658607482910156
mini_batch_src_global generation:  0.04873180389404297
r_  generation:  0.4053032398223877
local_output_nid generation:  0.02826976776123047
local_in_edges_tensor generation:  0.027048349380493164
mini_batch_src_global generation:  0.058808088302612305
r_  generation:  0.4124610424041748
local_output_nid generation:  0.028574228286743164
local_in_edges_tensor generation:  0.026407241821289062
mini_batch_src_global generation:  0.049311161041259766
r_  generation:  0.4099705219268799
local_output_nid generation:  0.028334617614746094
local_in_edges_tensor generation:  0.02873063087463379
mini_batch_src_global generation:  0.04830312728881836
r_  generation:  0.4187583923339844
local_output_nid generation:  0.03066420555114746
local_in_edges_tensor generation:  0.027899980545043945
mini_batch_src_global generation:  0.05015134811401367
r_  generation:  0.41434621810913086
----------------------check_connections_block total spend ----------------------------- 19.485915899276733
generate_one_block  0.5560672283172607
generate_one_block  0.5504024028778076
generate_one_block  0.5490224361419678
generate_one_block  0.5400619506835938
generate_one_block  0.6482343673706055
generate_one_block  0.5538105964660645
generate_one_block  0.5513739585876465
generate_one_block  0.5539121627807617
generate_one_block  0.5511636734008789
generate_one_block  0.551764726638794
generate_one_block  0.5536699295043945
generate_one_block  0.5475568771362305
generate_one_block  0.543468713760376
generate_one_block  0.5593881607055664
generate_one_block  0.5631732940673828
generate_one_block  0.5461101531982422
generate_one_block  0.5438106060028076
generate_one_block  0.5516550540924072
generate_one_block  0.5538175106048584
generate_one_block  0.5536863803863525
generate_one_block  0.5486679077148438
generate_one_block  0.5552301406860352
generate_one_block  0.5501856803894043
generate_one_block  0.5538501739501953
generate_one_block  0.5619416236877441
generate_one_block  0.5518779754638672
generate_one_block  0.5520637035369873
generate_one_block  0.545414924621582
generate_one_block  0.5594091415405273
generate_one_block  0.559241533279419
generate_one_block  0.5731832981109619
generate_one_block  0.5591733455657959
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12305450439453125  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  26.851028442382812
block generation total time  24.30626106262207
average batch blocks generation time:  0.7595706582069397
block dataloader generation time/epoch 54.292662143707275
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10520792007446289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.758889198303223  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10459613800048828  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.87614631652832  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10525178909301758  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.960281372070312  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10444498062133789  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.272655487060547  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529375076293945  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.129220962524414  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10457849502563477  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.818134784698486  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10525131225585938  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.929145336151123  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10490894317626953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.11832904815674  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10524845123291016  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.97564458847046  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10458850860595703  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.622897624969482  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527610778808594  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.123889923095703  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10465812683105469  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.623721599578857  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10519981384277344  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.779773235321045  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10465288162231445  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.021718978881836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1053318977355957  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.362886428833008  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10450077056884766  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.15485429763794  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10521316528320312  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.7614107131958  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10469675064086914  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.830424785614014  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522890090942383  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.915764331817627  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10488462448120117  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.09074306488037  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10523223876953125  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.805742740631104  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10451126098632812  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.08919858932495  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1051778793334961  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.537919998168945  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10438966751098633  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.01762628555298  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522699356079102  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.751978397369385  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10471105575561523  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.9648494720459  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10522270202636719  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.787580013275146  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10472679138183594  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.562077522277832  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10523796081542969  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.97147512435913  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10463809967041016  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.095439910888672  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10537195205688477  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.479438304901123  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10467815399169922  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.344392776489258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030425257980823517 |0.013712987303733826 |0.417196162045002 |9.144842624664307e-05 |0.7603361010551453 |0.0061223506927490234 |
----------------------------------------------------------pseudo_mini_loss sum 1.708856225013733
Total (block generation + training)time/epoch 93.44474244117737
Training time/epoch 39.15181589126587
Training time without block to device /epoch 38.71300029754639
Training time without total dataloading part /epoch 37.69008111953735
load block tensor time/epoch 0.9736082553863525
block to device time/epoch 0.4388155937194824
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  8796014
Number of first layer input nodes during this epoch:  4681197
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12361669540405273  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024007797241210938
random selection method range initialization spend 0.006632566452026367
time for parepare:  0.018172740936279297
local_output_nid generation:  0.0014269351959228516
local_in_edges_tensor generation:  0.0041544437408447266
mini_batch_src_global generation:  0.002215147018432617
r_  generation:  0.011823177337646484
local_output_nid generation:  0.0016448497772216797
local_in_edges_tensor generation:  0.0010657310485839844
mini_batch_src_global generation:  0.001581430435180664
r_  generation:  0.010880231857299805
local_output_nid generation:  0.0016207695007324219
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.001132965087890625
r_  generation:  0.009260892868041992
local_output_nid generation:  0.0016300678253173828
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.0011434555053710938
r_  generation:  0.009822368621826172
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0008983612060546875
mini_batch_src_global generation:  0.0011014938354492188
r_  generation:  0.009586095809936523
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.0010952949523925781
r_  generation:  0.00958251953125
local_output_nid generation:  0.0015645027160644531
local_in_edges_tensor generation:  0.00089263916015625
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.010060787200927734
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.0011539459228515625
r_  generation:  0.010151147842407227
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.010055780410766602
local_output_nid generation:  0.0015485286712646484
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.0011229515075683594
r_  generation:  0.01013040542602539
local_output_nid generation:  0.0015571117401123047
local_in_edges_tensor generation:  0.0008678436279296875
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.010246038436889648
local_output_nid generation:  0.001598358154296875
local_in_edges_tensor generation:  0.0008649826049804688
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.009749174118041992
local_output_nid generation:  0.0015497207641601562
local_in_edges_tensor generation:  0.0008451938629150391
mini_batch_src_global generation:  0.0011086463928222656
r_  generation:  0.010096549987792969
local_output_nid generation:  0.0015559196472167969
local_in_edges_tensor generation:  0.0008645057678222656
mini_batch_src_global generation:  0.0011172294616699219
r_  generation:  0.010054349899291992
local_output_nid generation:  0.0015497207641601562
local_in_edges_tensor generation:  0.0008699893951416016
mini_batch_src_global generation:  0.0011947154998779297
r_  generation:  0.009949684143066406
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0009007453918457031
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.01056814193725586
local_output_nid generation:  0.0015554428100585938
local_in_edges_tensor generation:  0.0008873939514160156
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.010122299194335938
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.000858306884765625
mini_batch_src_global generation:  0.0012121200561523438
r_  generation:  0.010601520538330078
local_output_nid generation:  0.0015749931335449219
local_in_edges_tensor generation:  0.0008630752563476562
mini_batch_src_global generation:  0.0011663436889648438
r_  generation:  0.010174989700317383
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0008792877197265625
mini_batch_src_global generation:  0.001190185546875
r_  generation:  0.010105133056640625
local_output_nid generation:  0.001558065414428711
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.010229825973510742
local_output_nid generation:  0.0015521049499511719
local_in_edges_tensor generation:  0.0008738040924072266
mini_batch_src_global generation:  0.0011093616485595703
r_  generation:  0.009857416152954102
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.0011601448059082031
r_  generation:  0.010459423065185547
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0008726119995117188
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.010032892227172852
local_output_nid generation:  0.0015597343444824219
local_in_edges_tensor generation:  0.0008642673492431641
mini_batch_src_global generation:  0.001127004623413086
r_  generation:  0.009874343872070312
local_output_nid generation:  0.0015642642974853516
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0012018680572509766
r_  generation:  0.010149002075195312
local_output_nid generation:  0.0015554428100585938
local_in_edges_tensor generation:  0.0008502006530761719
mini_batch_src_global generation:  0.0011026859283447266
r_  generation:  0.009655237197875977
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0008673667907714844
mini_batch_src_global generation:  0.0011811256408691406
r_  generation:  0.010103225708007812
local_output_nid generation:  0.001556396484375
local_in_edges_tensor generation:  0.0008730888366699219
mini_batch_src_global generation:  0.0012102127075195312
r_  generation:  0.010381698608398438
local_output_nid generation:  0.0015635490417480469
local_in_edges_tensor generation:  0.0008566379547119141
mini_batch_src_global generation:  0.001142263412475586
r_  generation:  0.009964704513549805
local_output_nid generation:  0.0015892982482910156
local_in_edges_tensor generation:  0.0008561611175537109
mini_batch_src_global generation:  0.0011124610900878906
r_  generation:  0.009806394577026367
local_output_nid generation:  0.0015518665313720703
local_in_edges_tensor generation:  0.0008656978607177734
mini_batch_src_global generation:  0.0011103153228759766
r_  generation:  0.009990692138671875
----------------------check_connections_block total spend ----------------------------- 0.554783821105957
generate_one_block  0.019947290420532227
generate_one_block  0.02103281021118164
generate_one_block  0.016927003860473633
generate_one_block  0.01789093017578125
generate_one_block  0.017013072967529297
generate_one_block  0.016689777374267578
generate_one_block  0.017388105392456055
generate_one_block  0.017388343811035156
generate_one_block  0.017325162887573242
generate_one_block  0.017292261123657227
generate_one_block  0.01754593849182129
generate_one_block  0.016772031784057617
generate_one_block  0.01720285415649414
generate_one_block  0.017106056213378906
generate_one_block  0.016933441162109375
generate_one_block  0.017986297607421875
generate_one_block  0.01714301109313965
generate_one_block  0.018043041229248047
generate_one_block  0.01721477508544922
generate_one_block  0.017153263092041016
generate_one_block  0.01738142967224121
generate_one_block  0.016507387161254883
generate_one_block  0.020711898803710938
generate_one_block  0.017402172088623047
generate_one_block  0.016849756240844727
generate_one_block  0.0172731876373291
generate_one_block  0.016636133193969727
generate_one_block  0.017238855361938477
generate_one_block  0.0174410343170166
generate_one_block  0.016698122024536133
generate_one_block  0.01648235321044922
generate_one_block  0.01690673828125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03536629676818848
gen group dst list time:  0.020265579223632812
time for parepare:  0.019515514373779297
local_output_nid generation:  0.006281614303588867
local_in_edges_tensor generation:  0.01601243019104004
mini_batch_src_global generation:  0.014319658279418945
r_  generation:  0.13936448097229004
local_output_nid generation:  0.009362459182739258
local_in_edges_tensor generation:  0.01106119155883789
mini_batch_src_global generation:  0.019025564193725586
r_  generation:  0.18839788436889648
local_output_nid generation:  0.009941577911376953
local_in_edges_tensor generation:  0.03287959098815918
mini_batch_src_global generation:  0.01880335807800293
r_  generation:  0.13666009902954102
local_output_nid generation:  0.009583234786987305
local_in_edges_tensor generation:  0.010306835174560547
mini_batch_src_global generation:  0.017264604568481445
r_  generation:  0.14928579330444336
local_output_nid generation:  0.009107351303100586
local_in_edges_tensor generation:  0.009276628494262695
mini_batch_src_global generation:  0.01835036277770996
r_  generation:  0.1458115577697754
local_output_nid generation:  0.008642435073852539
local_in_edges_tensor generation:  0.010395288467407227
mini_batch_src_global generation:  0.017491817474365234
r_  generation:  0.14424419403076172
local_output_nid generation:  0.008882761001586914
local_in_edges_tensor generation:  0.008422613143920898
mini_batch_src_global generation:  0.01889657974243164
r_  generation:  0.15273284912109375
local_output_nid generation:  0.008858680725097656
local_in_edges_tensor generation:  0.008418560028076172
mini_batch_src_global generation:  0.018642663955688477
r_  generation:  0.15139365196228027
local_output_nid generation:  0.009002685546875
local_in_edges_tensor generation:  0.008558511734008789
mini_batch_src_global generation:  0.019400596618652344
r_  generation:  0.15821480751037598
local_output_nid generation:  0.009346246719360352
local_in_edges_tensor generation:  0.008563518524169922
mini_batch_src_global generation:  0.01892256736755371
r_  generation:  0.15620636940002441
local_output_nid generation:  0.00952911376953125
local_in_edges_tensor generation:  0.009794950485229492
mini_batch_src_global generation:  0.024643421173095703
r_  generation:  0.15851759910583496
local_output_nid generation:  0.011562347412109375
local_in_edges_tensor generation:  0.00850057601928711
mini_batch_src_global generation:  0.018060684204101562
r_  generation:  0.1471869945526123
local_output_nid generation:  0.011508941650390625
local_in_edges_tensor generation:  0.009723424911499023
mini_batch_src_global generation:  0.019529104232788086
r_  generation:  0.15886783599853516
local_output_nid generation:  0.009395599365234375
local_in_edges_tensor generation:  0.008513689041137695
mini_batch_src_global generation:  0.018857479095458984
r_  generation:  0.15269041061401367
local_output_nid generation:  0.009290933609008789
local_in_edges_tensor generation:  0.008279561996459961
mini_batch_src_global generation:  0.018756628036499023
r_  generation:  0.1559457778930664
local_output_nid generation:  0.010961771011352539
local_in_edges_tensor generation:  0.008948326110839844
mini_batch_src_global generation:  0.020621061325073242
r_  generation:  0.1611936092376709
local_output_nid generation:  0.009546995162963867
local_in_edges_tensor generation:  0.012798786163330078
mini_batch_src_global generation:  0.01922893524169922
r_  generation:  0.15601897239685059
local_output_nid generation:  0.01011347770690918
local_in_edges_tensor generation:  0.009340763092041016
mini_batch_src_global generation:  0.020387887954711914
r_  generation:  0.1599273681640625
local_output_nid generation:  0.009661436080932617
local_in_edges_tensor generation:  0.009086132049560547
mini_batch_src_global generation:  0.019344091415405273
r_  generation:  0.1565113067626953
local_output_nid generation:  0.009687185287475586
local_in_edges_tensor generation:  0.008609533309936523
mini_batch_src_global generation:  0.019275903701782227
r_  generation:  0.15375232696533203
local_output_nid generation:  0.009701728820800781
local_in_edges_tensor generation:  0.008578062057495117
mini_batch_src_global generation:  0.020033836364746094
r_  generation:  0.1571366786956787
local_output_nid generation:  0.009369850158691406
local_in_edges_tensor generation:  0.008247137069702148
mini_batch_src_global generation:  0.018503904342651367
r_  generation:  0.14900588989257812
local_output_nid generation:  0.010035037994384766
local_in_edges_tensor generation:  0.008693218231201172
mini_batch_src_global generation:  0.01947307586669922
r_  generation:  0.16028666496276855
local_output_nid generation:  0.009523630142211914
local_in_edges_tensor generation:  0.008501291275024414
mini_batch_src_global generation:  0.01886725425720215
r_  generation:  0.15043377876281738
local_output_nid generation:  0.009424924850463867
local_in_edges_tensor generation:  0.008506059646606445
mini_batch_src_global generation:  0.018336772918701172
r_  generation:  0.14996981620788574
local_output_nid generation:  0.009622573852539062
local_in_edges_tensor generation:  0.009006500244140625
mini_batch_src_global generation:  0.019850969314575195
r_  generation:  0.15474581718444824
local_output_nid generation:  0.009343862533569336
local_in_edges_tensor generation:  0.008389472961425781
mini_batch_src_global generation:  0.01839303970336914
r_  generation:  0.1527268886566162
local_output_nid generation:  0.009851217269897461
local_in_edges_tensor generation:  0.009199380874633789
mini_batch_src_global generation:  0.01876544952392578
r_  generation:  0.15444469451904297
local_output_nid generation:  0.00986170768737793
local_in_edges_tensor generation:  0.008992671966552734
mini_batch_src_global generation:  0.019716978073120117
r_  generation:  0.15961241722106934
local_output_nid generation:  0.009302854537963867
local_in_edges_tensor generation:  0.008324146270751953
mini_batch_src_global generation:  0.018893718719482422
r_  generation:  0.15256881713867188
local_output_nid generation:  0.009562969207763672
local_in_edges_tensor generation:  0.008313417434692383
mini_batch_src_global generation:  0.018552303314208984
r_  generation:  0.15220355987548828
local_output_nid generation:  0.009640216827392578
local_in_edges_tensor generation:  0.008512258529663086
mini_batch_src_global generation:  0.01967144012451172
r_  generation:  0.15382170677185059
----------------------check_connections_block total spend ----------------------------- 7.333354234695435
generate_one_block  0.21786236763000488
generate_one_block  0.21106219291687012
generate_one_block  0.18837428092956543
generate_one_block  0.20452022552490234
generate_one_block  0.2114853858947754
generate_one_block  0.19568181037902832
generate_one_block  0.20709776878356934
generate_one_block  0.20547866821289062
generate_one_block  0.2081766128540039
generate_one_block  0.20245742797851562
generate_one_block  0.21075105667114258
generate_one_block  0.1942739486694336
generate_one_block  0.20315051078796387
generate_one_block  0.2018122673034668
generate_one_block  0.20017576217651367
generate_one_block  0.21866106986999512
generate_one_block  0.20719599723815918
generate_one_block  0.21516108512878418
generate_one_block  0.20871376991271973
generate_one_block  0.21046876907348633
generate_one_block  0.21009588241577148
generate_one_block  0.19983291625976562
generate_one_block  0.21204781532287598
generate_one_block  0.20136022567749023
generate_one_block  0.20025897026062012
generate_one_block  0.20824813842773438
generate_one_block  0.20499610900878906
generate_one_block  0.20634722709655762
generate_one_block  0.21688318252563477
generate_one_block  0.20377707481384277
generate_one_block  0.20092272758483887
generate_one_block  0.20619964599609375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041211843490600586
gen group dst list time:  0.10625505447387695
time for parepare:  0.0196380615234375
local_output_nid generation:  0.02536177635192871
local_in_edges_tensor generation:  0.05261039733886719
mini_batch_src_global generation:  0.038614511489868164
r_  generation:  0.40592217445373535
local_output_nid generation:  0.030033588409423828
local_in_edges_tensor generation:  0.03792834281921387
mini_batch_src_global generation:  0.05026555061340332
r_  generation:  0.42592620849609375
local_output_nid generation:  0.032414913177490234
local_in_edges_tensor generation:  0.028143882751464844
mini_batch_src_global generation:  0.04812216758728027
r_  generation:  0.4045875072479248
local_output_nid generation:  0.03090071678161621
local_in_edges_tensor generation:  0.028928518295288086
mini_batch_src_global generation:  0.05063986778259277
r_  generation:  0.4098222255706787
local_output_nid generation:  0.030498981475830078
local_in_edges_tensor generation:  0.02864360809326172
mini_batch_src_global generation:  0.047591209411621094
r_  generation:  0.41075563430786133
local_output_nid generation:  0.030155420303344727
local_in_edges_tensor generation:  0.027817964553833008
mini_batch_src_global generation:  0.05106854438781738
r_  generation:  0.40705370903015137
local_output_nid generation:  0.028577804565429688
local_in_edges_tensor generation:  0.04188680648803711
mini_batch_src_global generation:  0.047602176666259766
r_  generation:  0.41555142402648926
local_output_nid generation:  0.028415203094482422
local_in_edges_tensor generation:  0.030385971069335938
mini_batch_src_global generation:  0.049221038818359375
r_  generation:  0.4097628593444824
local_output_nid generation:  0.030577898025512695
local_in_edges_tensor generation:  0.03180956840515137
mini_batch_src_global generation:  0.04879021644592285
r_  generation:  0.42084360122680664
local_output_nid generation:  0.028658151626586914
local_in_edges_tensor generation:  0.026907682418823242
mini_batch_src_global generation:  0.04981565475463867
r_  generation:  0.40810370445251465
local_output_nid generation:  0.02887892723083496
local_in_edges_tensor generation:  0.029385089874267578
mini_batch_src_global generation:  0.04765009880065918
r_  generation:  0.4183351993560791
local_output_nid generation:  0.02820444107055664
local_in_edges_tensor generation:  0.02738475799560547
mini_batch_src_global generation:  0.04891848564147949
r_  generation:  0.40038084983825684
local_output_nid generation:  0.028606414794921875
local_in_edges_tensor generation:  0.026198148727416992
mini_batch_src_global generation:  0.04754757881164551
r_  generation:  0.4183676242828369
local_output_nid generation:  0.02947402000427246
local_in_edges_tensor generation:  0.029734134674072266
mini_batch_src_global generation:  0.04919838905334473
r_  generation:  0.4088459014892578
local_output_nid generation:  0.02951359748840332
local_in_edges_tensor generation:  0.026607990264892578
mini_batch_src_global generation:  0.04743838310241699
r_  generation:  0.4152064323425293
local_output_nid generation:  0.028873682022094727
local_in_edges_tensor generation:  0.030104875564575195
mini_batch_src_global generation:  0.050484657287597656
r_  generation:  0.43085718154907227
local_output_nid generation:  0.028693437576293945
local_in_edges_tensor generation:  0.026297569274902344
mini_batch_src_global generation:  0.049569129943847656
r_  generation:  0.4193000793457031
local_output_nid generation:  0.028810739517211914
local_in_edges_tensor generation:  0.026848793029785156
mini_batch_src_global generation:  0.05077695846557617
r_  generation:  0.4173085689544678
local_output_nid generation:  0.028995990753173828
local_in_edges_tensor generation:  0.03242182731628418
mini_batch_src_global generation:  0.04858827590942383
r_  generation:  0.4211444854736328
local_output_nid generation:  0.02858710289001465
local_in_edges_tensor generation:  0.028148174285888672
mini_batch_src_global generation:  0.04978036880493164
r_  generation:  0.41500377655029297
local_output_nid generation:  0.028809785842895508
local_in_edges_tensor generation:  0.029858112335205078
mini_batch_src_global generation:  0.049866676330566406
r_  generation:  0.437089204788208
local_output_nid generation:  0.02971816062927246
local_in_edges_tensor generation:  0.030751943588256836
mini_batch_src_global generation:  0.0503079891204834
r_  generation:  0.40657997131347656
local_output_nid generation:  0.029142141342163086
local_in_edges_tensor generation:  0.02752685546875
mini_batch_src_global generation:  0.049714088439941406
r_  generation:  0.4226839542388916
local_output_nid generation:  0.02875685691833496
local_in_edges_tensor generation:  0.029148340225219727
mini_batch_src_global generation:  0.04967999458312988
r_  generation:  0.412433385848999
local_output_nid generation:  0.028495073318481445
local_in_edges_tensor generation:  0.025838851928710938
mini_batch_src_global generation:  0.04766058921813965
r_  generation:  0.41308140754699707
local_output_nid generation:  0.028810739517211914
local_in_edges_tensor generation:  0.02596569061279297
mini_batch_src_global generation:  0.05134868621826172
r_  generation:  0.4129526615142822
local_output_nid generation:  0.028626680374145508
local_in_edges_tensor generation:  0.03079366683959961
mini_batch_src_global generation:  0.049103736877441406
r_  generation:  0.41892457008361816
local_output_nid generation:  0.02903127670288086
local_in_edges_tensor generation:  0.0259857177734375
mini_batch_src_global generation:  0.05001664161682129
r_  generation:  0.4121992588043213
local_output_nid generation:  0.028709888458251953
local_in_edges_tensor generation:  0.026088714599609375
mini_batch_src_global generation:  0.05319356918334961
r_  generation:  0.4210531711578369
local_output_nid generation:  0.028251171112060547
local_in_edges_tensor generation:  0.025437593460083008
mini_batch_src_global generation:  0.04937434196472168
r_  generation:  0.40616703033447266
local_output_nid generation:  0.028524160385131836
local_in_edges_tensor generation:  0.026296377182006836
mini_batch_src_global generation:  0.0495455265045166
r_  generation:  0.41457152366638184
local_output_nid generation:  0.028342723846435547
local_in_edges_tensor generation:  0.026308059692382812
mini_batch_src_global generation:  0.0490264892578125
r_  generation:  0.40395379066467285
----------------------check_connections_block total spend ----------------------------- 19.678577423095703
generate_one_block  0.5685665607452393
generate_one_block  0.563058614730835
generate_one_block  0.5396957397460938
generate_one_block  0.5571506023406982
generate_one_block  0.6523213386535645
generate_one_block  0.5514016151428223
generate_one_block  0.550729513168335
generate_one_block  0.5554704666137695
generate_one_block  0.5563454627990723
generate_one_block  0.550452709197998
generate_one_block  0.5586807727813721
generate_one_block  0.5393373966217041
generate_one_block  0.5532078742980957
generate_one_block  0.5610172748565674
generate_one_block  0.5495836734771729
generate_one_block  0.5638573169708252
generate_one_block  0.559337854385376
generate_one_block  0.5629823207855225
generate_one_block  0.5590524673461914
generate_one_block  0.5569007396697998
generate_one_block  0.5626330375671387
generate_one_block  0.5557219982147217
generate_one_block  0.5668807029724121
generate_one_block  0.5609114170074463
generate_one_block  0.5684478282928467
generate_one_block  0.5612013339996338
generate_one_block  0.5589151382446289
generate_one_block  0.5648252964019775
generate_one_block  0.5593700408935547
generate_one_block  0.5474109649658203
generate_one_block  0.5588607788085938
generate_one_block  0.5483729839324951
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.12361669540405273  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  27.011931657791138
block generation total time  24.51623272895813
average batch blocks generation time:  0.7661322727799416
block dataloader generation time/epoch 54.43506562709808
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10528135299682617  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.104976654052734  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10482263565063477  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.246346950531006  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10509014129638672  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.127810955047607  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10505056381225586  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.02769422531128  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10517358779907227  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.580936908721924  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10474538803100586  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.49243974685669  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1052713394165039  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.0290846824646  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10460186004638672  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.981784343719482  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527944564819336  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.15917682647705  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10472631454467773  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.906620502471924  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10531282424926758  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.182231903076172  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10447549819946289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.28706979751587  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10524845123291016  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.057827949523926  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10466623306274414  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.793785095214844  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10521221160888672  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.709712505340576  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10486936569213867  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.377412796020508  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10526561737060547  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.05248737335205  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10500860214233398  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.35745906829834  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10527896881103516  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.13740873336792  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10482931137084961  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.89403247833252  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10528373718261719  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.17018175125122  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1044163703918457  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.504562854766846  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10531330108642578  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.292912483215332  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10471963882446289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.75271463394165  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10517740249633789  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.516491413116455  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10473966598510742  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.03459358215332  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10520458221435547  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.719172477722168  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10475969314575195  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.887083530426025  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529422760009766  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.14491081237793  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10431194305419922  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.699161529541016  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10519933700561523  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.67182970046997  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1043863296508789  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.74795627593994  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031989336013793945 |0.015194348990917206 |0.41678842157125473 |9.575486183166504e-05 |0.7545204609632492 |0.0060710906982421875 |
----------------------------------------------------------pseudo_mini_loss sum 1.640342116355896
Total (block generation + training)time/epoch 93.53724145889282
Training time/epoch 39.05200695991516
Training time without block to device /epoch 38.56578779220581
Training time without total dataloading part /epoch 37.49101948738098
load block tensor time/epoch 1.0236587524414062
block to device time/epoch 0.4862191677093506
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  8790471
Number of first layer input nodes during this epoch:  4680223
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1223917007446289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023710012435913086
random selection method range initialization spend 0.006480693817138672
time for parepare:  0.01865363121032715
local_output_nid generation:  0.0014925003051757812
local_in_edges_tensor generation:  0.00458073616027832
mini_batch_src_global generation:  0.0028772354125976562
r_  generation:  0.016483545303344727
local_output_nid generation:  0.0025284290313720703
local_in_edges_tensor generation:  0.0013871192932128906
mini_batch_src_global generation:  0.0022385120391845703
r_  generation:  0.012037515640258789
local_output_nid generation:  0.0025436878204345703
local_in_edges_tensor generation:  0.0012810230255126953
mini_batch_src_global generation:  0.0017352104187011719
r_  generation:  0.010717153549194336
local_output_nid generation:  0.002398967742919922
local_in_edges_tensor generation:  0.0012271404266357422
mini_batch_src_global generation:  0.0015327930450439453
r_  generation:  0.00991964340209961
local_output_nid generation:  0.0023598670959472656
local_in_edges_tensor generation:  0.0012485980987548828
mini_batch_src_global generation:  0.0015349388122558594
r_  generation:  0.010468721389770508
local_output_nid generation:  0.002368927001953125
local_in_edges_tensor generation:  0.0012199878692626953
mini_batch_src_global generation:  0.0015723705291748047
r_  generation:  0.010247945785522461
local_output_nid generation:  0.0023534297943115234
local_in_edges_tensor generation:  0.0012049674987792969
mini_batch_src_global generation:  0.0014679431915283203
r_  generation:  0.010201454162597656
local_output_nid generation:  0.002325296401977539
local_in_edges_tensor generation:  0.0016944408416748047
mini_batch_src_global generation:  0.0044765472412109375
r_  generation:  0.017606496810913086
local_output_nid generation:  0.0025243759155273438
local_in_edges_tensor generation:  0.0012586116790771484
mini_batch_src_global generation:  0.0015773773193359375
r_  generation:  0.010722875595092773
local_output_nid generation:  0.002223968505859375
local_in_edges_tensor generation:  0.0010967254638671875
mini_batch_src_global generation:  0.0013897418975830078
r_  generation:  0.01059722900390625
local_output_nid generation:  0.0020647048950195312
local_in_edges_tensor generation:  0.0010504722595214844
mini_batch_src_global generation:  0.0012171268463134766
r_  generation:  0.010262727737426758
local_output_nid generation:  0.0019783973693847656
local_in_edges_tensor generation:  0.0009706020355224609
mini_batch_src_global generation:  0.0011987686157226562
r_  generation:  0.010034561157226562
local_output_nid generation:  0.0019371509552001953
local_in_edges_tensor generation:  0.0009746551513671875
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.009907960891723633
local_output_nid generation:  0.0018918514251708984
local_in_edges_tensor generation:  0.0009613037109375
mini_batch_src_global generation:  0.0011720657348632812
r_  generation:  0.010373592376708984
local_output_nid generation:  0.0018663406372070312
local_in_edges_tensor generation:  0.0009255409240722656
mini_batch_src_global generation:  0.0011553764343261719
r_  generation:  0.010316133499145508
local_output_nid generation:  0.0018718242645263672
local_in_edges_tensor generation:  0.0010266304016113281
mini_batch_src_global generation:  0.0011856555938720703
r_  generation:  0.010825395584106445
local_output_nid generation:  0.0018038749694824219
local_in_edges_tensor generation:  0.0009701251983642578
mini_batch_src_global generation:  0.0012416839599609375
r_  generation:  0.010944366455078125
local_output_nid generation:  0.0017855167388916016
local_in_edges_tensor generation:  0.00096893310546875
mini_batch_src_global generation:  0.0011720657348632812
r_  generation:  0.01019740104675293
local_output_nid generation:  0.0017800331115722656
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.01058053970336914
local_output_nid generation:  0.001775503158569336
local_in_edges_tensor generation:  0.0009469985961914062
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.010252237319946289
local_output_nid generation:  0.0017330646514892578
local_in_edges_tensor generation:  0.0009238719940185547
mini_batch_src_global generation:  0.0011415481567382812
r_  generation:  0.010199785232543945
local_output_nid generation:  0.0017933845520019531
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0011553764343261719
r_  generation:  0.010304689407348633
local_output_nid generation:  0.0017538070678710938
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.01056528091430664
local_output_nid generation:  0.0017447471618652344
local_in_edges_tensor generation:  0.0008921623229980469
mini_batch_src_global generation:  0.0011358261108398438
r_  generation:  0.010356664657592773
local_output_nid generation:  0.001674652099609375
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.010148286819458008
local_output_nid generation:  0.0017354488372802734
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0011942386627197266
r_  generation:  0.010657548904418945
local_output_nid generation:  0.0016591548919677734
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.0012497901916503906
r_  generation:  0.010950565338134766
local_output_nid generation:  0.0016591548919677734
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.010483741760253906
local_output_nid generation:  0.0016582012176513672
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0011670589447021484
r_  generation:  0.010386943817138672
local_output_nid generation:  0.0016622543334960938
local_in_edges_tensor generation:  0.0009150505065917969
mini_batch_src_global generation:  0.001154184341430664
r_  generation:  0.010046720504760742
local_output_nid generation:  0.0016260147094726562
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.0011310577392578125
r_  generation:  0.010346651077270508
local_output_nid generation:  0.0016171932220458984
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0011436939239501953
r_  generation:  0.010095357894897461
----------------------check_connections_block total spend ----------------------------- 0.6157834529876709
generate_one_block  0.023836851119995117
generate_one_block  0.02103590965270996
generate_one_block  0.01846623420715332
generate_one_block  0.017290592193603516
generate_one_block  0.018284082412719727
generate_one_block  0.017350196838378906
generate_one_block  0.01717972755432129
generate_one_block  0.017104148864746094
generate_one_block  0.017651081085205078
generate_one_block  0.01745462417602539
generate_one_block  0.017209291458129883
generate_one_block  0.017175912857055664
generate_one_block  0.016834259033203125
generate_one_block  0.017652273178100586
generate_one_block  0.017282485961914062
generate_one_block  0.018240928649902344
generate_one_block  0.017989158630371094
generate_one_block  0.01706719398498535
generate_one_block  0.017573118209838867
generate_one_block  0.017234086990356445
generate_one_block  0.017180204391479492
generate_one_block  0.016999483108520508
generate_one_block  0.02075028419494629
generate_one_block  0.017779827117919922
generate_one_block  0.01703667640686035
generate_one_block  0.017505884170532227
generate_one_block  0.018495798110961914
generate_one_block  0.017550230026245117
generate_one_block  0.017490386962890625
generate_one_block  0.016744136810302734
generate_one_block  0.017371177673339844
generate_one_block  0.016969680786132812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03664851188659668
gen group dst list time:  0.022817134857177734
time for parepare:  0.019565582275390625
local_output_nid generation:  0.006333827972412109
local_in_edges_tensor generation:  0.0171048641204834
mini_batch_src_global generation:  0.017128467559814453
r_  generation:  0.14287972450256348
local_output_nid generation:  0.009351491928100586
local_in_edges_tensor generation:  0.011020660400390625
mini_batch_src_global generation:  0.021156787872314453
r_  generation:  0.17841458320617676
local_output_nid generation:  0.014881372451782227
local_in_edges_tensor generation:  0.05342435836791992
mini_batch_src_global generation:  0.018133163452148438
r_  generation:  0.17289400100708008
local_output_nid generation:  0.015072822570800781
local_in_edges_tensor generation:  0.016951322555541992
mini_batch_src_global generation:  0.018992185592651367
r_  generation:  0.16644287109375
local_output_nid generation:  0.015812397003173828
local_in_edges_tensor generation:  0.01852273941040039
mini_batch_src_global generation:  0.020993709564208984
r_  generation:  0.19719433784484863
local_output_nid generation:  0.013949871063232422
local_in_edges_tensor generation:  0.01275777816772461
mini_batch_src_global generation:  0.03475236892700195
r_  generation:  0.15602612495422363
local_output_nid generation:  0.010163068771362305
local_in_edges_tensor generation:  0.010100364685058594
mini_batch_src_global generation:  0.02276921272277832
r_  generation:  0.15956759452819824
local_output_nid generation:  0.011859416961669922
local_in_edges_tensor generation:  0.010778188705444336
mini_batch_src_global generation:  0.020800113677978516
r_  generation:  0.15024399757385254
local_output_nid generation:  0.009777069091796875
local_in_edges_tensor generation:  0.011289358139038086
mini_batch_src_global generation:  0.02131938934326172
r_  generation:  0.19352197647094727
local_output_nid generation:  0.009825944900512695
local_in_edges_tensor generation:  0.009189128875732422
mini_batch_src_global generation:  0.021895408630371094
r_  generation:  0.15461421012878418
local_output_nid generation:  0.009776592254638672
local_in_edges_tensor generation:  0.008645772933959961
mini_batch_src_global generation:  0.021090984344482422
r_  generation:  0.15136504173278809
local_output_nid generation:  0.009881019592285156
local_in_edges_tensor generation:  0.008955240249633789
mini_batch_src_global generation:  0.020733118057250977
r_  generation:  0.1480875015258789
local_output_nid generation:  0.009710550308227539
local_in_edges_tensor generation:  0.008121013641357422
mini_batch_src_global generation:  0.01847553253173828
r_  generation:  0.14789915084838867
local_output_nid generation:  0.010186433792114258
local_in_edges_tensor generation:  0.011232137680053711
mini_batch_src_global generation:  0.019435644149780273
r_  generation:  0.15577435493469238
local_output_nid generation:  0.009998559951782227
local_in_edges_tensor generation:  0.008594512939453125
mini_batch_src_global generation:  0.031157732009887695
r_  generation:  0.1829075813293457
local_output_nid generation:  0.01025247573852539
local_in_edges_tensor generation:  0.008816003799438477
mini_batch_src_global generation:  0.03324413299560547
r_  generation:  0.16591691970825195
local_output_nid generation:  0.010039091110229492
local_in_edges_tensor generation:  0.008905649185180664
mini_batch_src_global generation:  0.01995396614074707
r_  generation:  0.16047906875610352
local_output_nid generation:  0.009994745254516602
local_in_edges_tensor generation:  0.00845193862915039
mini_batch_src_global generation:  0.01903080940246582
r_  generation:  0.15388154983520508
local_output_nid generation:  0.010123252868652344
local_in_edges_tensor generation:  0.008606195449829102
mini_batch_src_global generation:  0.02009749412536621
r_  generation:  0.15642786026000977
local_output_nid generation:  0.010030269622802734
local_in_edges_tensor generation:  0.008513689041137695
mini_batch_src_global generation:  0.021101951599121094
r_  generation:  0.18615078926086426
local_output_nid generation:  0.015223026275634766
local_in_edges_tensor generation:  0.011752605438232422
mini_batch_src_global generation:  0.023642301559448242
r_  generation:  0.1891927719116211
local_output_nid generation:  0.013864278793334961
local_in_edges_tensor generation:  0.009937286376953125
mini_batch_src_global generation:  0.02306079864501953
r_  generation:  0.15622615814208984
local_output_nid generation:  0.01121830940246582
local_in_edges_tensor generation:  0.010977745056152344
mini_batch_src_global generation:  0.020679950714111328
r_  generation:  0.15716910362243652
local_output_nid generation:  0.010524749755859375
local_in_edges_tensor generation:  0.009292125701904297
mini_batch_src_global generation:  0.01920342445373535
r_  generation:  0.15643954277038574
local_output_nid generation:  0.010415792465209961
local_in_edges_tensor generation:  0.008643150329589844
mini_batch_src_global generation:  0.0187833309173584
r_  generation:  0.1506023406982422
local_output_nid generation:  0.010426521301269531
local_in_edges_tensor generation:  0.008711099624633789
mini_batch_src_global generation:  0.019405126571655273
r_  generation:  0.15672588348388672
local_output_nid generation:  0.01076960563659668
local_in_edges_tensor generation:  0.01070404052734375
mini_batch_src_global generation:  0.021051406860351562
r_  generation:  0.16416382789611816
local_output_nid generation:  0.010403156280517578
local_in_edges_tensor generation:  0.008556604385375977
mini_batch_src_global generation:  0.019733905792236328
r_  generation:  0.15962862968444824
local_output_nid generation:  0.01031947135925293
local_in_edges_tensor generation:  0.008682489395141602
mini_batch_src_global generation:  0.019747495651245117
r_  generation:  0.15770530700683594
local_output_nid generation:  0.009806394577026367
local_in_edges_tensor generation:  0.008083343505859375
mini_batch_src_global generation:  0.018595218658447266
r_  generation:  0.15195941925048828
local_output_nid generation:  0.01023721694946289
local_in_edges_tensor generation:  0.00856781005859375
mini_batch_src_global generation:  0.019225358963012695
r_  generation:  0.1568770408630371
local_output_nid generation:  0.011516809463500977
local_in_edges_tensor generation:  0.008478164672851562
mini_batch_src_global generation:  0.019032716751098633
r_  generation:  0.16025471687316895
----------------------check_connections_block total spend ----------------------------- 7.8131327629089355
generate_one_block  0.22751593589782715
generate_one_block  0.21961140632629395
generate_one_block  0.2149209976196289
generate_one_block  0.20114493370056152
generate_one_block  0.2299201488494873
generate_one_block  0.20699024200439453
generate_one_block  0.19647479057312012
generate_one_block  0.19733309745788574
generate_one_block  0.20316267013549805
generate_one_block  0.20296144485473633
generate_one_block  0.19771385192871094
generate_one_block  0.19507646560668945
generate_one_block  0.1959981918334961
generate_one_block  0.20601224899291992
generate_one_block  0.20074939727783203
generate_one_block  0.2167372703552246
generate_one_block  0.21243596076965332
generate_one_block  0.20064473152160645
generate_one_block  0.20352530479431152
generate_one_block  0.20623135566711426
generate_one_block  0.20542168617248535
generate_one_block  0.20169377326965332
generate_one_block  0.20888662338256836
generate_one_block  0.20114517211914062
generate_one_block  0.19672226905822754
generate_one_block  0.20724153518676758
generate_one_block  0.23436570167541504
generate_one_block  0.21105098724365234
generate_one_block  0.2112882137298584
generate_one_block  0.19783878326416016
generate_one_block  0.20513153076171875
generate_one_block  0.20321393013000488
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03279447555541992
gen group dst list time:  0.10552167892456055
time for parepare:  0.020611047744750977
local_output_nid generation:  0.025083541870117188
local_in_edges_tensor generation:  0.04764127731323242
mini_batch_src_global generation:  0.03812408447265625
r_  generation:  0.4138774871826172
local_output_nid generation:  0.029933929443359375
local_in_edges_tensor generation:  0.0348200798034668
mini_batch_src_global generation:  0.04915928840637207
r_  generation:  0.4090583324432373
local_output_nid generation:  0.030948162078857422
local_in_edges_tensor generation:  0.03167986869812012
mini_batch_src_global generation:  0.04677224159240723
r_  generation:  0.4189918041229248
local_output_nid generation:  0.029918670654296875
local_in_edges_tensor generation:  0.03438568115234375
mini_batch_src_global generation:  0.04894089698791504
r_  generation:  0.4071474075317383
local_output_nid generation:  0.03014087677001953
local_in_edges_tensor generation:  0.027614831924438477
mini_batch_src_global generation:  0.06184530258178711
r_  generation:  0.4266350269317627
local_output_nid generation:  0.03217506408691406
local_in_edges_tensor generation:  0.03129839897155762
mini_batch_src_global generation:  0.04957151412963867
r_  generation:  0.40927839279174805
local_output_nid generation:  0.0286710262298584
local_in_edges_tensor generation:  0.025671720504760742
mini_batch_src_global generation:  0.04746127128601074
r_  generation:  0.41553473472595215
local_output_nid generation:  0.028718948364257812
local_in_edges_tensor generation:  0.02541518211364746
mini_batch_src_global generation:  0.049164772033691406
r_  generation:  0.4046926498413086
local_output_nid generation:  0.02899789810180664
local_in_edges_tensor generation:  0.02886033058166504
mini_batch_src_global generation:  0.047470808029174805
r_  generation:  0.41948533058166504
local_output_nid generation:  0.028420209884643555
local_in_edges_tensor generation:  0.025681257247924805
mini_batch_src_global generation:  0.04899191856384277
r_  generation:  0.4185822010040283
local_output_nid generation:  0.02876591682434082
local_in_edges_tensor generation:  0.029959678649902344
mini_batch_src_global generation:  0.048177242279052734
r_  generation:  0.4180753231048584
local_output_nid generation:  0.02859783172607422
local_in_edges_tensor generation:  0.02892279624938965
mini_batch_src_global generation:  0.05072641372680664
r_  generation:  0.4089348316192627
local_output_nid generation:  0.028329133987426758
local_in_edges_tensor generation:  0.028469085693359375
mini_batch_src_global generation:  0.047132015228271484
r_  generation:  0.4151346683502197
local_output_nid generation:  0.02888631820678711
local_in_edges_tensor generation:  0.031696319580078125
mini_batch_src_global generation:  0.04975008964538574
r_  generation:  0.4142792224884033
local_output_nid generation:  0.02865910530090332
local_in_edges_tensor generation:  0.0341639518737793
mini_batch_src_global generation:  0.0469355583190918
r_  generation:  0.41745424270629883
local_output_nid generation:  0.0292050838470459
local_in_edges_tensor generation:  0.028238534927368164
mini_batch_src_global generation:  0.0518345832824707
r_  generation:  0.42020606994628906
local_output_nid generation:  0.03041362762451172
local_in_edges_tensor generation:  0.02739548683166504
mini_batch_src_global generation:  0.0475153923034668
r_  generation:  0.4248502254486084
local_output_nid generation:  0.02863001823425293
local_in_edges_tensor generation:  0.02803826332092285
mini_batch_src_global generation:  0.051122426986694336
r_  generation:  0.40684080123901367
local_output_nid generation:  0.03103780746459961
local_in_edges_tensor generation:  0.028136491775512695
mini_batch_src_global generation:  0.04728841781616211
r_  generation:  0.4192030429840088
local_output_nid generation:  0.028670072555541992
local_in_edges_tensor generation:  0.027211427688598633
mini_batch_src_global generation:  0.05096268653869629
r_  generation:  0.4104297161102295
local_output_nid generation:  0.03009033203125
local_in_edges_tensor generation:  0.025974273681640625
mini_batch_src_global generation:  0.047150611877441406
r_  generation:  0.4201998710632324
local_output_nid generation:  0.02839350700378418
local_in_edges_tensor generation:  0.0272524356842041
mini_batch_src_global generation:  0.0492396354675293
r_  generation:  0.4097416400909424
local_output_nid generation:  0.03214621543884277
local_in_edges_tensor generation:  0.03115534782409668
mini_batch_src_global generation:  0.05994987487792969
r_  generation:  0.42327308654785156
local_output_nid generation:  0.029788732528686523
local_in_edges_tensor generation:  0.02939438819885254
mini_batch_src_global generation:  0.04940652847290039
r_  generation:  0.4094235897064209
local_output_nid generation:  0.028885364532470703
local_in_edges_tensor generation:  0.027638912200927734
mini_batch_src_global generation:  0.04780840873718262
r_  generation:  0.41727352142333984
local_output_nid generation:  0.02859330177307129
local_in_edges_tensor generation:  0.026962995529174805
mini_batch_src_global generation:  0.04926490783691406
r_  generation:  0.40882182121276855
local_output_nid generation:  0.02913045883178711
local_in_edges_tensor generation:  0.02761101722717285
mini_batch_src_global generation:  0.047437429428100586
r_  generation:  0.4229285717010498
local_output_nid generation:  0.028677701950073242
local_in_edges_tensor generation:  0.028506755828857422
mini_batch_src_global generation:  0.05132937431335449
r_  generation:  0.411975622177124
local_output_nid generation:  0.029052734375
local_in_edges_tensor generation:  0.02650308609008789
mini_batch_src_global generation:  0.04730987548828125
r_  generation:  0.43753528594970703
local_output_nid generation:  0.028629302978515625
local_in_edges_tensor generation:  0.027762413024902344
mini_batch_src_global generation:  0.049552202224731445
r_  generation:  0.4130990505218506
local_output_nid generation:  0.02881789207458496
local_in_edges_tensor generation:  0.025917530059814453
mini_batch_src_global generation:  0.0482182502746582
r_  generation:  0.4233076572418213
local_output_nid generation:  0.028755664825439453
local_in_edges_tensor generation:  0.024875402450561523
mini_batch_src_global generation:  0.04921388626098633
r_  generation:  0.4064819812774658
----------------------check_connections_block total spend ----------------------------- 19.695557594299316
generate_one_block  0.5722124576568604
generate_one_block  0.554375410079956
generate_one_block  0.5536339282989502
generate_one_block  0.5475320816040039
generate_one_block  0.6613759994506836
generate_one_block  0.5500547885894775
generate_one_block  0.5463423728942871
generate_one_block  0.550663948059082
generate_one_block  0.555140495300293
generate_one_block  0.5494832992553711
generate_one_block  0.551567554473877
generate_one_block  0.5540313720703125
generate_one_block  0.5507011413574219
generate_one_block  0.5659010410308838
generate_one_block  0.5502333641052246
generate_one_block  0.5614738464355469
generate_one_block  0.5567429065704346
generate_one_block  0.54878830909729
generate_one_block  0.5502817630767822
generate_one_block  0.5520656108856201
generate_one_block  0.5561573505401611
generate_one_block  0.5495452880859375
generate_one_block  0.5621333122253418
generate_one_block  0.5596945285797119
generate_one_block  0.5739908218383789
generate_one_block  0.5492494106292725
generate_one_block  0.5664393901824951
generate_one_block  0.548231840133667
generate_one_block  0.5579330921173096
generate_one_block  0.5478160381317139
generate_one_block  0.5490245819091797
generate_one_block  0.5576467514038086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1223917007446289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  27.508690357208252
block generation total time  24.47962474822998
average batch blocks generation time:  0.7649882733821869
block dataloader generation time/epoch 54.64459935824076
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1052708625793457  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.150206089019775  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10469388961791992  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.114184856414795  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10528039932250977  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.138408660888672  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10455799102783203  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.62358045578003  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10532760620117188  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.2732195854187  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10472965240478516  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.850590705871582  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10518598556518555  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.616622924804688  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10450220108032227  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.625479698181152  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.1052403450012207  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.900346279144287  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10451269149780273  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.904524326324463  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10520410537719727  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.697880744934082  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10459184646606445  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.518723487854004  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10399341583251953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.523956775665283  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10466480255126953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 17.071173667907715  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10521316528320312  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 16.737735271453857  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9959716796875 GB
    Memory Allocated: 0.10529613494873047  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.407448291778564  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10529232025146484  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.15214204788208  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10457563400268555  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.67610454559326  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10525989532470703  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.9948468208313  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10468292236328125  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.790486812591553  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10525369644165039  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.06163501739502  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1045694351196289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.740416526794434  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10528755187988281  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.116151809692383  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10476446151733398  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.984549045562744  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1051793098449707  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.66128635406494  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10464239120483398  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.044333934783936  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1053767204284668  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.49456548690796  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10462713241577148  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.098045825958252  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10528230667114258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.13109302520752  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10419988632202148  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.48160743713379  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10524702072143555  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.883541107177734  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10450124740600586  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.696189880371094  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031112730503082275 |0.013675987720489502 |0.41751477867364883 |9.446591138839722e-05 |0.7550222650170326 |0.005823612213134766 |
----------------------------------------------------------pseudo_mini_loss sum 1.5908348560333252
Total (block generation + training)time/epoch 93.71670985221863
Training time/epoch 39.01171827316284
Training time without block to device /epoch 38.57408666610718
Training time without total dataloading part /epoch 37.53003191947937
load block tensor time/epoch 0.9956073760986328
block to device time/epoch 0.43763160705566406
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  8791317
Number of first layer input nodes during this epoch:  4679266
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1224222183227539  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02774524688720703
random selection method range initialization spend 0.005721092224121094
time for parepare:  0.02226567268371582
local_output_nid generation:  0.0017888545989990234
local_in_edges_tensor generation:  0.005349874496459961
mini_batch_src_global generation:  0.002046346664428711
r_  generation:  0.009967803955078125
local_output_nid generation:  0.0018684864044189453
local_in_edges_tensor generation:  0.0012836456298828125
mini_batch_src_global generation:  0.001901865005493164
r_  generation:  0.011044025421142578
local_output_nid generation:  0.0019989013671875
local_in_edges_tensor generation:  0.0012080669403076172
mini_batch_src_global generation:  0.0014350414276123047
r_  generation:  0.009878158569335938
local_output_nid generation:  0.0020482540130615234
local_in_edges_tensor generation:  0.0012118816375732422
mini_batch_src_global generation:  0.0014891624450683594
r_  generation:  0.010227680206298828
local_output_nid generation:  0.0021131038665771484
local_in_edges_tensor generation:  0.0012323856353759766
mini_batch_src_global generation:  0.0014388561248779297
r_  generation:  0.009989023208618164
local_output_nid generation:  0.002161741256713867
local_in_edges_tensor generation:  0.0011858940124511719
mini_batch_src_global generation:  0.0013883113861083984
r_  generation:  0.01025080680847168
local_output_nid generation:  0.002201557159423828
local_in_edges_tensor generation:  0.001180887222290039
mini_batch_src_global generation:  0.0013382434844970703
r_  generation:  0.010290145874023438
local_output_nid generation:  0.0022051334381103516
local_in_edges_tensor generation:  0.0011906623840332031
mini_batch_src_global generation:  0.0013380050659179688
r_  generation:  0.010156393051147461
local_output_nid generation:  0.002227306365966797
local_in_edges_tensor generation:  0.0011532306671142578
mini_batch_src_global generation:  0.001316070556640625
r_  generation:  0.01017451286315918
local_output_nid generation:  0.002248525619506836
local_in_edges_tensor generation:  0.0011484622955322266
mini_batch_src_global generation:  0.0014460086822509766
r_  generation:  0.010289192199707031
local_output_nid generation:  0.0022530555725097656
local_in_edges_tensor generation:  0.001161813735961914
mini_batch_src_global generation:  0.001321554183959961
r_  generation:  0.010484695434570312
local_output_nid generation:  0.0022437572479248047
local_in_edges_tensor generation:  0.0012004375457763672
mini_batch_src_global generation:  0.0013434886932373047
r_  generation:  0.010684490203857422
local_output_nid generation:  0.0022852420806884766
local_in_edges_tensor generation:  0.0011954307556152344
mini_batch_src_global generation:  0.0014538764953613281
r_  generation:  0.01076197624206543
local_output_nid generation:  0.0023093223571777344
local_in_edges_tensor generation:  0.0011751651763916016
mini_batch_src_global generation:  0.001352548599243164
r_  generation:  0.010553598403930664
local_output_nid generation:  0.002277374267578125
local_in_edges_tensor generation:  0.0011653900146484375
mini_batch_src_global generation:  0.0014328956604003906
r_  generation:  0.010169029235839844
local_output_nid generation:  0.002306222915649414
local_in_edges_tensor generation:  0.001163482666015625
mini_batch_src_global generation:  0.0013096332550048828
r_  generation:  0.009991645812988281
local_output_nid generation:  0.0022873878479003906
local_in_edges_tensor generation:  0.0011870861053466797
mini_batch_src_global generation:  0.0013654232025146484
r_  generation:  0.010342836380004883
local_output_nid generation:  0.0023183822631835938
local_in_edges_tensor generation:  0.0011966228485107422
mini_batch_src_global generation:  0.0014567375183105469
r_  generation:  0.010476827621459961
local_output_nid generation:  0.0023221969604492188
local_in_edges_tensor generation:  0.0011985301971435547
mini_batch_src_global generation:  0.0015306472778320312
r_  generation:  0.011035442352294922
local_output_nid generation:  0.0023403167724609375
local_in_edges_tensor generation:  0.001177072525024414
mini_batch_src_global generation:  0.0013775825500488281
r_  generation:  0.010603666305541992
local_output_nid generation:  0.002328157424926758
local_in_edges_tensor generation:  0.0012080669403076172
mini_batch_src_global generation:  0.0014100074768066406
r_  generation:  0.01050114631652832
local_output_nid generation:  0.0023145675659179688
local_in_edges_tensor generation:  0.0011973381042480469
mini_batch_src_global generation:  0.0014421939849853516
r_  generation:  0.01093435287475586
local_output_nid generation:  0.0023343563079833984
local_in_edges_tensor generation:  0.0011763572692871094
mini_batch_src_global generation:  0.001470327377319336
r_  generation:  0.010249853134155273
local_output_nid generation:  0.0023114681243896484
local_in_edges_tensor generation:  0.0011584758758544922
mini_batch_src_global generation:  0.0013341903686523438
r_  generation:  0.010161876678466797
local_output_nid generation:  0.0022954940795898438
local_in_edges_tensor generation:  0.0011723041534423828
mini_batch_src_global generation:  0.001497030258178711
r_  generation:  0.010772943496704102
local_output_nid generation:  0.0023262500762939453
local_in_edges_tensor generation:  0.0011456012725830078
mini_batch_src_global generation:  0.001451730728149414
r_  generation:  0.010213613510131836
local_output_nid generation:  0.0023317337036132812
local_in_edges_tensor generation:  0.0011951923370361328
mini_batch_src_global generation:  0.0013284683227539062
r_  generation:  0.01049494743347168
local_output_nid generation:  0.0023527145385742188
local_in_edges_tensor generation:  0.0011720657348632812
mini_batch_src_global generation:  0.0013587474822998047
r_  generation:  0.010545015335083008
local_output_nid generation:  0.0023415088653564453
local_in_edges_tensor generation:  0.001209259033203125
mini_batch_src_global generation:  0.0013670921325683594
r_  generation:  0.010907649993896484
local_output_nid generation:  0.0023450851440429688
local_in_edges_tensor generation:  0.0012049674987792969
mini_batch_src_global generation:  0.00139617919921875
r_  generation:  0.010544061660766602
local_output_nid generation:  0.0023674964904785156
local_in_edges_tensor generation:  0.0012359619140625
mini_batch_src_global generation:  0.0014281272888183594
r_  generation:  0.011085033416748047
local_output_nid generation:  0.002373933792114258
local_in_edges_tensor generation:  0.0011932849884033203
mini_batch_src_global generation:  0.001659393310546875
r_  generation:  0.010815620422363281
----------------------check_connections_block total spend ----------------------------- 0.6231467723846436
generate_one_block  0.022982358932495117
generate_one_block  0.023120880126953125
generate_one_block  0.019207477569580078
generate_one_block  0.01905512809753418
generate_one_block  0.018523454666137695
generate_one_block  0.01825571060180664
generate_one_block  0.01811838150024414
generate_one_block  0.0182647705078125
generate_one_block  0.017879962921142578
generate_one_block  0.017937183380126953
generate_one_block  0.018192768096923828
generate_one_block  0.020209312438964844
generate_one_block  0.018407344818115234
generate_one_block  0.018558263778686523
generate_one_block  0.017614364624023438
generate_one_block  0.017418861389160156
generate_one_block  0.018264055252075195
generate_one_block  0.018182754516601562
generate_one_block  0.01864910125732422
generate_one_block  0.017989397048950195
generate_one_block  0.0181577205657959
generate_one_block  0.018917322158813477
generate_one_block  0.02263498306274414
generate_one_block  0.018728017807006836
generate_one_block  0.019031524658203125
generate_one_block  0.01777935028076172
generate_one_block  0.017922401428222656
generate_one_block  0.018362760543823242
generate_one_block  0.018773317337036133
generate_one_block  0.01799297332763672
generate_one_block  0.018872737884521484
generate_one_block  0.018396854400634766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0650639533996582
gen group dst list time:  0.026069164276123047
time for parepare:  0.025423288345336914
local_output_nid generation:  0.00908041000366211
local_in_edges_tensor generation:  0.018431663513183594
mini_batch_src_global generation:  0.014849662780761719
r_  generation:  0.14496970176696777
local_output_nid generation:  0.014414548873901367
local_in_edges_tensor generation:  0.01436161994934082
mini_batch_src_global generation:  0.017557144165039062
r_  generation:  0.14999723434448242
local_output_nid generation:  0.014676570892333984
local_in_edges_tensor generation:  0.04608345031738281
mini_batch_src_global generation:  0.017212629318237305
r_  generation:  0.15102434158325195
local_output_nid generation:  0.01550745964050293
local_in_edges_tensor generation:  0.012353897094726562
mini_batch_src_global generation:  0.01844930648803711
r_  generation:  0.1552748680114746
local_output_nid generation:  0.016541004180908203
local_in_edges_tensor generation:  0.012569665908813477
mini_batch_src_global generation:  0.023830652236938477
r_  generation:  0.16573572158813477
local_output_nid generation:  0.011258840560913086
local_in_edges_tensor generation:  0.010549783706665039
mini_batch_src_global generation:  0.023070335388183594
r_  generation:  0.16965627670288086
local_output_nid generation:  0.009605884552001953
local_in_edges_tensor generation:  0.009515762329101562
mini_batch_src_global generation:  0.020604372024536133
r_  generation:  0.16039037704467773
local_output_nid generation:  0.00945901870727539
local_in_edges_tensor generation:  0.009431123733520508
mini_batch_src_global generation:  0.02065277099609375
r_  generation:  0.1604902744293213
local_output_nid generation:  0.009048223495483398
local_in_edges_tensor generation:  0.008908987045288086
mini_batch_src_global generation:  0.02057933807373047
r_  generation:  0.15848302841186523
local_output_nid generation:  0.009581565856933594
local_in_edges_tensor generation:  0.009071111679077148
mini_batch_src_global generation:  0.0204925537109375
r_  generation:  0.1588287353515625
local_output_nid generation:  0.009789228439331055
local_in_edges_tensor generation:  0.009801626205444336
mini_batch_src_global generation:  0.020989179611206055
r_  generation:  0.16010332107543945
local_output_nid generation:  0.01001286506652832
local_in_edges_tensor generation:  0.009299755096435547
mini_batch_src_global generation:  0.02173471450805664
r_  generation:  0.16435837745666504
local_output_nid generation:  0.01000070571899414
local_in_edges_tensor generation:  0.009217262268066406
mini_batch_src_global generation:  0.021213293075561523
r_  generation:  0.16362810134887695
local_output_nid generation:  0.010049104690551758
local_in_edges_tensor generation:  0.009094715118408203
mini_batch_src_global generation:  0.02159714698791504
r_  generation:  0.1661992073059082
local_output_nid generation:  0.00957632064819336
local_in_edges_tensor generation:  0.01051187515258789
mini_batch_src_global generation:  0.023324012756347656
r_  generation:  0.15662789344787598
local_output_nid generation:  0.00953221321105957
local_in_edges_tensor generation:  0.008443117141723633
mini_batch_src_global generation:  0.020310640335083008
r_  generation:  0.1558983325958252
local_output_nid generation:  0.009727954864501953
local_in_edges_tensor generation:  0.00863027572631836
mini_batch_src_global generation:  0.021527767181396484
r_  generation:  0.16239285469055176
local_output_nid generation:  0.00982522964477539
local_in_edges_tensor generation:  0.009391069412231445
mini_batch_src_global generation:  0.021178483963012695
r_  generation:  0.16107630729675293
local_output_nid generation:  0.010286808013916016
local_in_edges_tensor generation:  0.009099483489990234
mini_batch_src_global generation:  0.02178668975830078
r_  generation:  0.1663501262664795
local_output_nid generation:  0.009927749633789062
local_in_edges_tensor generation:  0.009326457977294922
mini_batch_src_global generation:  0.02146625518798828
r_  generation:  0.16576385498046875
local_output_nid generation:  0.009914875030517578
local_in_edges_tensor generation:  0.009276151657104492
mini_batch_src_global generation:  0.021204233169555664
r_  generation:  0.16560602188110352
local_output_nid generation:  0.010277271270751953
local_in_edges_tensor generation:  0.009179115295410156
mini_batch_src_global generation:  0.022008895874023438
r_  generation:  0.17247724533081055
local_output_nid generation:  0.011638164520263672
local_in_edges_tensor generation:  0.008678913116455078
mini_batch_src_global generation:  0.0215761661529541
r_  generation:  0.16376304626464844
local_output_nid generation:  0.00971531867980957
local_in_edges_tensor generation:  0.008911371231079102
mini_batch_src_global generation:  0.022494077682495117
r_  generation:  0.1622762680053711
local_output_nid generation:  0.010174274444580078
local_in_edges_tensor generation:  0.008375167846679688
mini_batch_src_global generation:  0.022002696990966797
r_  generation:  0.17077136039733887
local_output_nid generation:  0.011020660400390625
local_in_edges_tensor generation:  0.008489847183227539
mini_batch_src_global generation:  0.021279573440551758
r_  generation:  0.16391777992248535
local_output_nid generation:  0.01012110710144043
local_in_edges_tensor generation:  0.008484840393066406
mini_batch_src_global generation:  0.02182316780090332
r_  generation:  0.16115593910217285
local_output_nid generation:  0.009962320327758789
local_in_edges_tensor generation:  0.009107589721679688
mini_batch_src_global generation:  0.021404266357421875
r_  generation:  0.16552090644836426
local_output_nid generation:  0.01043701171875
local_in_edges_tensor generation:  0.009931087493896484
mini_batch_src_global generation:  0.02184605598449707
r_  generation:  0.16950345039367676
local_output_nid generation:  0.009979009628295898
local_in_edges_tensor generation:  0.009040594100952148
mini_batch_src_global generation:  0.02125096321105957
r_  generation:  0.16295599937438965
local_output_nid generation:  0.010607481002807617
local_in_edges_tensor generation:  0.00938272476196289
mini_batch_src_global generation:  0.021882057189941406
r_  generation:  0.17254853248596191
local_output_nid generation:  0.010206222534179688
local_in_edges_tensor generation:  0.009165048599243164
mini_batch_src_global generation:  0.021658658981323242
r_  generation:  0.16657090187072754
----------------------check_connections_block total spend ----------------------------- 7.832782506942749
generate_one_block  0.21511411666870117
generate_one_block  0.20273399353027344
generate_one_block  0.1964874267578125
generate_one_block  0.20352745056152344
generate_one_block  0.2206125259399414
generate_one_block  0.20612788200378418
generate_one_block  0.20058321952819824
generate_one_block  0.20362257957458496
generate_one_block  0.19996428489685059
generate_one_block  0.20033574104309082
generate_one_block  0.2008342742919922
generate_one_block  0.2062234878540039
generate_one_block  0.20673465728759766
generate_one_block  0.2070610523223877
generate_one_block  0.19883346557617188
generate_one_block  0.1944563388824463
generate_one_block  0.20653009414672852
generate_one_block  0.20369529724121094
generate_one_block  0.209855318069458
generate_one_block  0.2134265899658203
generate_one_block  0.20690107345581055
generate_one_block  0.2138988971710205
generate_one_block  0.19696736335754395
generate_one_block  0.1972959041595459
generate_one_block  0.21009373664855957
generate_one_block  0.1999833583831787
generate_one_block  0.20215749740600586
generate_one_block  0.21520686149597168
generate_one_block  0.21597766876220703
generate_one_block  0.20460152626037598
generate_one_block  0.2175593376159668
generate_one_block  0.20667195320129395
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04228377342224121
gen group dst list time:  0.11096644401550293
time for parepare:  0.01958918571472168
local_output_nid generation:  0.025450944900512695
local_in_edges_tensor generation:  0.05098700523376465
mini_batch_src_global generation:  0.037813425064086914
r_  generation:  0.41304922103881836
local_output_nid generation:  0.029933929443359375
local_in_edges_tensor generation:  0.034325599670410156
mini_batch_src_global generation:  0.04927563667297363
r_  generation:  0.40979456901550293
local_output_nid generation:  0.02951335906982422
local_in_edges_tensor generation:  0.0316162109375
mini_batch_src_global generation:  0.04685354232788086
r_  generation:  0.42720818519592285
local_output_nid generation:  0.031760215759277344
local_in_edges_tensor generation:  0.03443717956542969
mini_batch_src_global generation:  0.05164003372192383
r_  generation:  0.4155158996582031
local_output_nid generation:  0.030629873275756836
local_in_edges_tensor generation:  0.030611753463745117
mini_batch_src_global generation:  0.04933524131774902
r_  generation:  0.42413997650146484
local_output_nid generation:  0.03019547462463379
local_in_edges_tensor generation:  0.030234575271606445
mini_batch_src_global generation:  0.049803972244262695
r_  generation:  0.418292760848999
local_output_nid generation:  0.028917312622070312
local_in_edges_tensor generation:  0.03236651420593262
mini_batch_src_global generation:  0.04804205894470215
r_  generation:  0.4240541458129883
local_output_nid generation:  0.028620481491088867
local_in_edges_tensor generation:  0.02715754508972168
mini_batch_src_global generation:  0.04999399185180664
r_  generation:  0.4134252071380615
local_output_nid generation:  0.028440475463867188
local_in_edges_tensor generation:  0.026940584182739258
mini_batch_src_global generation:  0.050241947174072266
r_  generation:  0.4196934700012207
local_output_nid generation:  0.028478384017944336
local_in_edges_tensor generation:  0.027186155319213867
mini_batch_src_global generation:  0.04990863800048828
r_  generation:  0.41230154037475586
local_output_nid generation:  0.028241634368896484
local_in_edges_tensor generation:  0.02727484703063965
mini_batch_src_global generation:  0.04764151573181152
r_  generation:  0.42055630683898926
local_output_nid generation:  0.028374671936035156
local_in_edges_tensor generation:  0.027489185333251953
mini_batch_src_global generation:  0.05013775825500488
r_  generation:  0.4153554439544678
local_output_nid generation:  0.028669118881225586
local_in_edges_tensor generation:  0.027635812759399414
mini_batch_src_global generation:  0.060071468353271484
r_  generation:  0.42784762382507324
local_output_nid generation:  0.028417348861694336
local_in_edges_tensor generation:  0.029010295867919922
mini_batch_src_global generation:  0.05020451545715332
r_  generation:  0.41720080375671387
local_output_nid generation:  0.028275251388549805
local_in_edges_tensor generation:  0.02804875373840332
mini_batch_src_global generation:  0.046924591064453125
r_  generation:  0.4182403087615967
local_output_nid generation:  0.028079509735107422
local_in_edges_tensor generation:  0.02856922149658203
mini_batch_src_global generation:  0.04927515983581543
r_  generation:  0.41060924530029297
local_output_nid generation:  0.02881169319152832
local_in_edges_tensor generation:  0.0328216552734375
mini_batch_src_global generation:  0.04877352714538574
r_  generation:  0.42306017875671387
local_output_nid generation:  0.029308319091796875
local_in_edges_tensor generation:  0.02736639976501465
mini_batch_src_global generation:  0.05082535743713379
r_  generation:  0.410534143447876
local_output_nid generation:  0.030261516571044922
local_in_edges_tensor generation:  0.03135538101196289
mini_batch_src_global generation:  0.04848957061767578
r_  generation:  0.42998409271240234
local_output_nid generation:  0.028661251068115234
local_in_edges_tensor generation:  0.028922080993652344
mini_batch_src_global generation:  0.051542043685913086
r_  generation:  0.4156811237335205
local_output_nid generation:  0.030482769012451172
local_in_edges_tensor generation:  0.027474164962768555
mini_batch_src_global generation:  0.04788565635681152
r_  generation:  0.42566657066345215
local_output_nid generation:  0.02897930145263672
local_in_edges_tensor generation:  0.02909088134765625
mini_batch_src_global generation:  0.05184054374694824
r_  generation:  0.42081451416015625
local_output_nid generation:  0.02833700180053711
local_in_edges_tensor generation:  0.029428720474243164
mini_batch_src_global generation:  0.047306060791015625
r_  generation:  0.4192643165588379
local_output_nid generation:  0.02836155891418457
local_in_edges_tensor generation:  0.031143903732299805
mini_batch_src_global generation:  0.049442291259765625
r_  generation:  0.41092348098754883
local_output_nid generation:  0.028699874877929688
local_in_edges_tensor generation:  0.03120899200439453
mini_batch_src_global generation:  0.049782514572143555
r_  generation:  0.4389779567718506
local_output_nid generation:  0.029773712158203125
local_in_edges_tensor generation:  0.026755809783935547
mini_batch_src_global generation:  0.050131797790527344
r_  generation:  0.4125833511352539
local_output_nid generation:  0.028918027877807617
local_in_edges_tensor generation:  0.026943683624267578
mini_batch_src_global generation:  0.04749727249145508
r_  generation:  0.4216346740722656
local_output_nid generation:  0.028534650802612305
local_in_edges_tensor generation:  0.030207395553588867
mini_batch_src_global generation:  0.05125617980957031
r_  generation:  0.415158748626709
local_output_nid generation:  0.028748035430908203
local_in_edges_tensor generation:  0.027575254440307617
mini_batch_src_global generation:  0.04776763916015625
r_  generation:  0.42430973052978516
local_output_nid generation:  0.02861332893371582
local_in_edges_tensor generation:  0.028589725494384766
mini_batch_src_global generation:  0.05190300941467285
r_  generation:  0.41353654861450195
local_output_nid generation:  0.028670310974121094
local_in_edges_tensor generation:  0.029303550720214844
mini_batch_src_global generation:  0.04796791076660156
r_  generation:  0.4264833927154541
local_output_nid generation:  0.028367042541503906
local_in_edges_tensor generation:  0.026937246322631836
mini_batch_src_global generation:  0.04995465278625488
r_  generation:  0.4141223430633545
----------------------check_connections_block total spend ----------------------------- 19.84348177909851
generate_one_block  0.566852331161499
generate_one_block  0.5669472217559814
generate_one_block  0.5472574234008789
generate_one_block  0.555842399597168
generate_one_block  0.6586246490478516
generate_one_block  0.5612471103668213
generate_one_block  0.5617823600769043
generate_one_block  0.5537276268005371
generate_one_block  0.5522184371948242
generate_one_block  0.5512959957122803
generate_one_block  0.5542917251586914
generate_one_block  0.5588531494140625
generate_one_block  0.5597760677337646
generate_one_block  0.5513763427734375
generate_one_block  0.5457718372344971
generate_one_block  0.5484306812286377
generate_one_block  0.5596857070922852
generate_one_block  0.5582146644592285
generate_one_block  0.5700685977935791
generate_one_block  0.5562477111816406
generate_one_block  0.5676379203796387
generate_one_block  0.5639781951904297
generate_one_block  0.5500059127807617
generate_one_block  0.5450177192687988
generate_one_block  0.572162389755249
generate_one_block  0.5493371486663818
generate_one_block  0.5547497272491455
generate_one_block  0.5712141990661621
generate_one_block  0.5746700763702393
generate_one_block  0.5579230785369873
generate_one_block  0.5631725788116455
generate_one_block  0.5593900680541992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1224222183227539  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  27.67626428604126
block generation total time  24.551846027374268
average batch blocks generation time:  0.7672451883554459
block dataloader generation time/epoch 54.836540043354034
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1052541732788086  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.03625202178955  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10463571548461914  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.843658924102783  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10517740249633789  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.555068016052246  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10481119155883789  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.966121196746826  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10525941848754883  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.091233730316162  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10477590560913086  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.023691654205322  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10521841049194336  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.805453300476074  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10459327697753906  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.966496467590332  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10521554946899414  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.80195903778076  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10456180572509766  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.762595176696777  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10522985458374023  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.777016639709473  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10468673706054688  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.094990730285645  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1052694320678711  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.09166717529297  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10472726821899414  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.037376403808594  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1051487922668457  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.426509857177734  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10438251495361328  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.40183687210083  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10526084899902344  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.90549325942993  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10484743118286133  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.763803482055664  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10530567169189453  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.275514602661133  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10474634170532227  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.06566047668457  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10527276992797852  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.119786262512207  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10496234893798828  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.343233108520508  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10517644882202148  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.57974338531494  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10453605651855469  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.56392478942871  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10527849197387695  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.112369537353516  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10452890396118164  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.571028232574463  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10521411895751953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.725939750671387  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10476160049438477  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.074626922607422  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10532855987548828  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.29130220413208  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10462713241577148  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.821364879608154  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10535430908203125  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.356533527374268  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10446405410766602  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.07132911682129  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03457861393690109 |0.015334628522396088 |0.41973356902599335 |9.584426879882812e-05 |0.7579181641340256 |0.007791757583618164 |
----------------------------------------------------------pseudo_mini_loss sum 1.5500836372375488
Total (block generation + training)time/epoch 93.97587305307388
Training time/epoch 39.34073519706726
Training time without block to device /epoch 38.850027084350586
Training time without total dataloading part /epoch 37.695714235305786
load block tensor time/epoch 1.106515645980835
block to device time/epoch 0.4907081127166748
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  8791531
Number of first layer input nodes during this epoch:  4679624
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.12278413772583008  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027039051055908203
random selection method range initialization spend 0.006550788879394531
time for parepare:  0.020056962966918945
local_output_nid generation:  0.0014684200286865234
local_in_edges_tensor generation:  0.008446216583251953
mini_batch_src_global generation:  0.0020363330841064453
r_  generation:  0.011329412460327148
local_output_nid generation:  0.001622915267944336
local_in_edges_tensor generation:  0.0010924339294433594
mini_batch_src_global generation:  0.0015821456909179688
r_  generation:  0.010332584381103516
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.0009961128234863281
mini_batch_src_global generation:  0.001210927963256836
r_  generation:  0.010176420211791992
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0009715557098388672
mini_batch_src_global generation:  0.001131296157836914
r_  generation:  0.009570837020874023
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.0009598731994628906
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.01005411148071289
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0009450912475585938
mini_batch_src_global generation:  0.0012438297271728516
r_  generation:  0.010306119918823242
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0009281635284423828
mini_batch_src_global generation:  0.0011670589447021484
r_  generation:  0.009999275207519531
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0009243488311767578
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  0.009944677352905273
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0009245872497558594
mini_batch_src_global generation:  0.0012269020080566406
r_  generation:  0.010225534439086914
local_output_nid generation:  0.0015728473663330078
local_in_edges_tensor generation:  0.0009224414825439453
mini_batch_src_global generation:  0.001168966293334961
r_  generation:  0.010158300399780273
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0009508132934570312
mini_batch_src_global generation:  0.001132965087890625
r_  generation:  0.010062932968139648
local_output_nid generation:  0.0015802383422851562
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.0011267662048339844
r_  generation:  0.010312557220458984
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.0011568069458007812
r_  generation:  0.010244131088256836
local_output_nid generation:  0.0015668869018554688
local_in_edges_tensor generation:  0.0009350776672363281
mini_batch_src_global generation:  0.0012056827545166016
r_  generation:  0.010721445083618164
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0009140968322753906
mini_batch_src_global generation:  0.0011670589447021484
r_  generation:  0.010181427001953125
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.00115966796875
r_  generation:  0.010069131851196289
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.009744644165039062
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0008988380432128906
mini_batch_src_global generation:  0.0011699199676513672
r_  generation:  0.009956598281860352
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.010288238525390625
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0011785030364990234
r_  generation:  0.010297060012817383
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.00086212158203125
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.010226249694824219
local_output_nid generation:  0.0015673637390136719
local_in_edges_tensor generation:  0.000865936279296875
mini_batch_src_global generation:  0.001194000244140625
r_  generation:  0.01030421257019043
local_output_nid generation:  0.001580953598022461
local_in_edges_tensor generation:  0.0008857250213623047
mini_batch_src_global generation:  0.0011703968048095703
r_  generation:  0.010561227798461914
local_output_nid generation:  0.0016281604766845703
local_in_edges_tensor generation:  0.0013413429260253906
mini_batch_src_global generation:  0.00115966796875
r_  generation:  0.009977340698242188
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0010554790496826172
mini_batch_src_global generation:  0.0012063980102539062
r_  generation:  0.010664939880371094
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.0012500286102294922
r_  generation:  0.01073455810546875
local_output_nid generation:  0.00160980224609375
local_in_edges_tensor generation:  0.0009062290191650391
mini_batch_src_global generation:  0.0012121200561523438
r_  generation:  0.010214805603027344
local_output_nid generation:  0.0016193389892578125
local_in_edges_tensor generation:  0.0009121894836425781
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.010037660598754883
local_output_nid generation:  0.0015850067138671875
local_in_edges_tensor generation:  0.0009524822235107422
mini_batch_src_global generation:  0.0011360645294189453
r_  generation:  0.0100250244140625
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.0011858940124511719
r_  generation:  0.010484457015991211
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0008969306945800781
mini_batch_src_global generation:  0.0012047290802001953
r_  generation:  0.010520219802856445
local_output_nid generation:  0.001617431640625
local_in_edges_tensor generation:  0.0009629726409912109
mini_batch_src_global generation:  0.0012371540069580078
r_  generation:  0.010342597961425781
----------------------check_connections_block total spend ----------------------------- 0.573145866394043
generate_one_block  0.023954391479492188
generate_one_block  0.020823955535888672
generate_one_block  0.018702268600463867
generate_one_block  0.01710963249206543
generate_one_block  0.01792120933532715
generate_one_block  0.01799798011779785
generate_one_block  0.017230987548828125
generate_one_block  0.017012834548950195
generate_one_block  0.017710447311401367
generate_one_block  0.017266273498535156
generate_one_block  0.016959190368652344
generate_one_block  0.01768207550048828
generate_one_block  0.01745128631591797
generate_one_block  0.018076419830322266
generate_one_block  0.01704692840576172
generate_one_block  0.01702284812927246
generate_one_block  0.016163349151611328
generate_one_block  0.016875505447387695
generate_one_block  0.01721954345703125
generate_one_block  0.017360687255859375
generate_one_block  0.017114639282226562
generate_one_block  0.01726508140563965
generate_one_block  0.020460844039916992
generate_one_block  0.017251253128051758
generate_one_block  0.018128156661987305
generate_one_block  0.01790022850036621
generate_one_block  0.01709294319152832
generate_one_block  0.016843080520629883
generate_one_block  0.016747474670410156
generate_one_block  0.017385005950927734
generate_one_block  0.017525911331176758
generate_one_block  0.017031192779541016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036022186279296875
gen group dst list time:  0.02370429039001465
time for parepare:  0.020140647888183594
local_output_nid generation:  0.006524801254272461
local_in_edges_tensor generation:  0.02102518081665039
mini_batch_src_global generation:  0.015660762786865234
r_  generation:  0.13469481468200684
local_output_nid generation:  0.009003639221191406
local_in_edges_tensor generation:  0.01022648811340332
mini_batch_src_global generation:  0.01822519302368164
r_  generation:  0.14085984230041504
local_output_nid generation:  0.009708404541015625
local_in_edges_tensor generation:  0.034010887145996094
mini_batch_src_global generation:  0.017833948135375977
r_  generation:  0.15077996253967285
local_output_nid generation:  0.009238004684448242
local_in_edges_tensor generation:  0.008404731750488281
mini_batch_src_global generation:  0.017101049423217773
r_  generation:  0.14712738990783691
local_output_nid generation:  0.010379791259765625
local_in_edges_tensor generation:  0.010933637619018555
mini_batch_src_global generation:  0.019229412078857422
r_  generation:  0.15166807174682617
local_output_nid generation:  0.009340286254882812
local_in_edges_tensor generation:  0.009588479995727539
mini_batch_src_global generation:  0.020299434661865234
r_  generation:  0.15572142601013184
local_output_nid generation:  0.008886098861694336
local_in_edges_tensor generation:  0.008244514465332031
mini_batch_src_global generation:  0.018431425094604492
r_  generation:  0.1484665870666504
local_output_nid generation:  0.008873701095581055
local_in_edges_tensor generation:  0.009589672088623047
mini_batch_src_global generation:  0.018260478973388672
r_  generation:  0.14853429794311523
local_output_nid generation:  0.009209394454956055
local_in_edges_tensor generation:  0.00861668586730957
mini_batch_src_global generation:  0.01975727081298828
r_  generation:  0.15507721900939941
local_output_nid generation:  0.009309530258178711
local_in_edges_tensor generation:  0.009626388549804688
mini_batch_src_global generation:  0.01984119415283203
r_  generation:  0.15210175514221191
local_output_nid generation:  0.009231328964233398
local_in_edges_tensor generation:  0.0095367431640625
mini_batch_src_global generation:  0.018457412719726562
r_  generation:  0.1510763168334961
local_output_nid generation:  0.009522438049316406
local_in_edges_tensor generation:  0.00874638557434082
mini_batch_src_global generation:  0.01918935775756836
r_  generation:  0.15585708618164062
local_output_nid generation:  0.00951838493347168
local_in_edges_tensor generation:  0.010312557220458984
mini_batch_src_global generation:  0.019609928131103516
r_  generation:  0.15355587005615234
local_output_nid generation:  0.009889841079711914
local_in_edges_tensor generation:  0.00861215591430664
mini_batch_src_global generation:  0.020543336868286133
r_  generation:  0.15996956825256348
local_output_nid generation:  0.009538888931274414
local_in_edges_tensor generation:  0.008449554443359375
mini_batch_src_global generation:  0.019010305404663086
r_  generation:  0.15461182594299316
local_output_nid generation:  0.009489059448242188
local_in_edges_tensor generation:  0.009167909622192383
mini_batch_src_global generation:  0.01846623420715332
r_  generation:  0.1516580581665039
local_output_nid generation:  0.008853673934936523
local_in_edges_tensor generation:  0.009548425674438477
mini_batch_src_global generation:  0.018010616302490234
r_  generation:  0.14629340171813965
local_output_nid generation:  0.00932765007019043
local_in_edges_tensor generation:  0.008633613586425781
mini_batch_src_global generation:  0.018524885177612305
r_  generation:  0.1529998779296875
local_output_nid generation:  0.00938558578491211
local_in_edges_tensor generation:  0.008340597152709961
mini_batch_src_global generation:  0.019379138946533203
r_  generation:  0.15581297874450684
local_output_nid generation:  0.009412527084350586
local_in_edges_tensor generation:  0.008578777313232422
mini_batch_src_global generation:  0.019731521606445312
r_  generation:  0.15767788887023926
local_output_nid generation:  0.009530305862426758
local_in_edges_tensor generation:  0.009464502334594727
mini_batch_src_global generation:  0.019562721252441406
r_  generation:  0.15595197677612305
local_output_nid generation:  0.009494543075561523
local_in_edges_tensor generation:  0.009948015213012695
mini_batch_src_global generation:  0.019030332565307617
r_  generation:  0.15638446807861328
local_output_nid generation:  0.009550094604492188
local_in_edges_tensor generation:  0.008583307266235352
mini_batch_src_global generation:  0.019073486328125
r_  generation:  0.15557050704956055
local_output_nid generation:  0.009215831756591797
local_in_edges_tensor generation:  0.008475065231323242
mini_batch_src_global generation:  0.018892288208007812
r_  generation:  0.152815580368042
local_output_nid generation:  0.009891271591186523
local_in_edges_tensor generation:  0.009022712707519531
mini_batch_src_global generation:  0.020188093185424805
r_  generation:  0.16327834129333496
local_output_nid generation:  0.009872674942016602
local_in_edges_tensor generation:  0.011325836181640625
mini_batch_src_global generation:  0.020038366317749023
r_  generation:  0.16384291648864746
local_output_nid generation:  0.00947260856628418
local_in_edges_tensor generation:  0.00855255126953125
mini_batch_src_global generation:  0.01888251304626465
r_  generation:  0.15398812294006348
local_output_nid generation:  0.009266853332519531
local_in_edges_tensor generation:  0.00815439224243164
mini_batch_src_global generation:  0.01871204376220703
r_  generation:  0.15282249450683594
local_output_nid generation:  0.00935673713684082
local_in_edges_tensor generation:  0.008358240127563477
mini_batch_src_global generation:  0.01862359046936035
r_  generation:  0.15493035316467285
local_output_nid generation:  0.009531736373901367
local_in_edges_tensor generation:  0.008641481399536133
mini_batch_src_global generation:  0.01928853988647461
r_  generation:  0.15404534339904785
local_output_nid generation:  0.009699583053588867
local_in_edges_tensor generation:  0.00857234001159668
mini_batch_src_global generation:  0.01926445960998535
r_  generation:  0.1587202548980713
local_output_nid generation:  0.009296894073486328
local_in_edges_tensor generation:  0.008674860000610352
mini_batch_src_global generation:  0.019400596618652344
r_  generation:  0.15583467483520508
----------------------check_connections_block total spend ----------------------------- 7.2939770221710205
generate_one_block  0.20017099380493164
generate_one_block  0.19889450073242188
generate_one_block  0.2104642391204834
generate_one_block  0.19643354415893555
generate_one_block  0.22217273712158203
generate_one_block  0.21142029762268066
generate_one_block  0.19977545738220215
generate_one_block  0.20076203346252441
generate_one_block  0.20819520950317383
generate_one_block  0.20017242431640625
generate_one_block  0.19373273849487305
generate_one_block  0.20723247528076172
generate_one_block  0.20282554626464844
generate_one_block  0.21183061599731445
generate_one_block  0.20047879219055176
generate_one_block  0.2037041187286377
generate_one_block  0.19493865966796875
generate_one_block  0.1970534324645996
generate_one_block  0.20545315742492676
generate_one_block  0.2134554386138916
generate_one_block  0.2042703628540039
generate_one_block  0.20327401161193848
generate_one_block  0.204362154006958
generate_one_block  0.19911932945251465
generate_one_block  0.2133631706237793
generate_one_block  0.21439123153686523
generate_one_block  0.19852662086486816
generate_one_block  0.19733572006225586
generate_one_block  0.20196032524108887
generate_one_block  0.20386791229248047
generate_one_block  0.2129840850830078
generate_one_block  0.2040705680847168
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03877878189086914
gen group dst list time:  0.10186171531677246
time for parepare:  0.019495248794555664
local_output_nid generation:  0.0250246524810791
local_in_edges_tensor generation:  0.03605318069458008
mini_batch_src_global generation:  0.036466360092163086
r_  generation:  0.40750908851623535
local_output_nid generation:  0.029997587203979492
local_in_edges_tensor generation:  0.03171658515930176
mini_batch_src_global generation:  0.047840118408203125
r_  generation:  0.40515851974487305
local_output_nid generation:  0.030861616134643555
local_in_edges_tensor generation:  0.03334331512451172
mini_batch_src_global generation:  0.04658007621765137
r_  generation:  0.4212474822998047
local_output_nid generation:  0.030009984970092773
local_in_edges_tensor generation:  0.02946782112121582
mini_batch_src_global generation:  0.048291683197021484
r_  generation:  0.4091324806213379
local_output_nid generation:  0.03014993667602539
local_in_edges_tensor generation:  0.02780914306640625
mini_batch_src_global generation:  0.04860830307006836
r_  generation:  0.420914888381958
local_output_nid generation:  0.029990673065185547
local_in_edges_tensor generation:  0.028995752334594727
mini_batch_src_global generation:  0.05103468894958496
r_  generation:  0.4113121032714844
local_output_nid generation:  0.028096437454223633
local_in_edges_tensor generation:  0.02961421012878418
mini_batch_src_global generation:  0.0468289852142334
r_  generation:  0.41414928436279297
local_output_nid generation:  0.028219223022460938
local_in_edges_tensor generation:  0.02760767936706543
mini_batch_src_global generation:  0.05138993263244629
r_  generation:  0.40566325187683105
local_output_nid generation:  0.02809929847717285
local_in_edges_tensor generation:  0.029651880264282227
mini_batch_src_global generation:  0.04691505432128906
r_  generation:  0.4183187484741211
local_output_nid generation:  0.028456449508666992
local_in_edges_tensor generation:  0.031009197235107422
mini_batch_src_global generation:  0.048822641372680664
r_  generation:  0.4108462333679199
local_output_nid generation:  0.028268098831176758
local_in_edges_tensor generation:  0.02740001678466797
mini_batch_src_global generation:  0.048612117767333984
r_  generation:  0.4133424758911133
local_output_nid generation:  0.028148651123046875
local_in_edges_tensor generation:  0.03148221969604492
mini_batch_src_global generation:  0.0504918098449707
r_  generation:  0.4110400676727295
local_output_nid generation:  0.028093576431274414
local_in_edges_tensor generation:  0.027805805206298828
mini_batch_src_global generation:  0.04677844047546387
r_  generation:  0.41591358184814453
local_output_nid generation:  0.02835702896118164
local_in_edges_tensor generation:  0.030994892120361328
mini_batch_src_global generation:  0.051296234130859375
r_  generation:  0.4126136302947998
local_output_nid generation:  0.028095245361328125
local_in_edges_tensor generation:  0.027973651885986328
mini_batch_src_global generation:  0.04718899726867676
r_  generation:  0.4163200855255127
local_output_nid generation:  0.027955293655395508
local_in_edges_tensor generation:  0.028841018676757812
mini_batch_src_global generation:  0.05704450607299805
r_  generation:  0.4072873592376709
local_output_nid generation:  0.028648853302001953
local_in_edges_tensor generation:  0.0270845890045166
mini_batch_src_global generation:  0.0466916561126709
r_  generation:  0.4119603633880615
local_output_nid generation:  0.02837681770324707
local_in_edges_tensor generation:  0.03059840202331543
mini_batch_src_global generation:  0.04858136177062988
r_  generation:  0.41700005531311035
local_output_nid generation:  0.02965092658996582
local_in_edges_tensor generation:  0.032799720764160156
mini_batch_src_global generation:  0.047475337982177734
r_  generation:  0.42034482955932617
local_output_nid generation:  0.028998613357543945
local_in_edges_tensor generation:  0.02931809425354004
mini_batch_src_global generation:  0.0488886833190918
r_  generation:  0.4136312007904053
local_output_nid generation:  0.028815507888793945
local_in_edges_tensor generation:  0.029389381408691406
mini_batch_src_global generation:  0.04727315902709961
r_  generation:  0.42227602005004883
local_output_nid generation:  0.028749465942382812
local_in_edges_tensor generation:  0.027698516845703125
mini_batch_src_global generation:  0.049265146255493164
r_  generation:  0.40869593620300293
local_output_nid generation:  0.028846025466918945
local_in_edges_tensor generation:  0.027437210083007812
mini_batch_src_global generation:  0.04667401313781738
r_  generation:  0.4185216426849365
local_output_nid generation:  0.02858591079711914
local_in_edges_tensor generation:  0.030449867248535156
mini_batch_src_global generation:  0.048688650131225586
r_  generation:  0.4082932472229004
local_output_nid generation:  0.029066085815429688
local_in_edges_tensor generation:  0.02824568748474121
mini_batch_src_global generation:  0.046750783920288086
r_  generation:  0.42147111892700195
local_output_nid generation:  0.0297091007232666
local_in_edges_tensor generation:  0.031415700912475586
mini_batch_src_global generation:  0.049111127853393555
r_  generation:  0.41670775413513184
local_output_nid generation:  0.02891683578491211
local_in_edges_tensor generation:  0.027607440948486328
mini_batch_src_global generation:  0.0471804141998291
r_  generation:  0.41939258575439453
local_output_nid generation:  0.028780460357666016
local_in_edges_tensor generation:  0.029255390167236328
mini_batch_src_global generation:  0.050293684005737305
r_  generation:  0.4092252254486084
local_output_nid generation:  0.02911210060119629
local_in_edges_tensor generation:  0.02829575538635254
mini_batch_src_global generation:  0.04652762413024902
r_  generation:  0.42096447944641113
local_output_nid generation:  0.029010772705078125
local_in_edges_tensor generation:  0.030513525009155273
mini_batch_src_global generation:  0.04889345169067383
r_  generation:  0.4105715751647949
local_output_nid generation:  0.02881908416748047
local_in_edges_tensor generation:  0.031061649322509766
mini_batch_src_global generation:  0.0475921630859375
r_  generation:  0.42096734046936035
local_output_nid generation:  0.028891324996948242
local_in_edges_tensor generation:  0.027747154235839844
mini_batch_src_global generation:  0.05061697959899902
r_  generation:  0.4150404930114746
----------------------check_connections_block total spend ----------------------------- 19.598508596420288
generate_one_block  0.5545458793640137
generate_one_block  0.5471210479736328
generate_one_block  0.5583267211914062
generate_one_block  0.5565524101257324
generate_one_block  0.6489648818969727
generate_one_block  0.5619759559631348
generate_one_block  0.547215461730957
generate_one_block  0.5507640838623047
generate_one_block  0.5532958507537842
generate_one_block  0.5580160617828369
generate_one_block  0.5430686473846436
generate_one_block  0.5555984973907471
generate_one_block  0.5474467277526855
generate_one_block  0.5627725124359131
generate_one_block  0.5472941398620605
generate_one_block  0.5451695919036865
generate_one_block  0.5434412956237793
generate_one_block  0.5537757873535156
generate_one_block  0.5581264495849609
generate_one_block  0.5541019439697266
generate_one_block  0.5564711093902588
generate_one_block  0.5528388023376465
generate_one_block  0.5519254207611084
generate_one_block  0.5531458854675293
generate_one_block  0.5747537612915039
generate_one_block  0.5675246715545654
generate_one_block  0.5483157634735107
generate_one_block  0.5485501289367676
generate_one_block  0.5495882034301758
generate_one_block  0.5501613616943359
generate_one_block  0.5590336322784424
generate_one_block  0.5543258190155029
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.12278413772583008  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  26.89248561859131
block generation total time  24.350900411605835
average batch blocks generation time:  0.7609656378626823
block dataloader generation time/epoch 54.71534719467163
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10519647598266602  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.628855228424072  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10471248626708984  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.73969316482544  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10532760620117188  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.3134708404541  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10471439361572266  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.66829204559326  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10528707504272461  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.18879270553589  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10490131378173828  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.287055015563965  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1052093505859375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.735915184020996  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10466241836547852  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.721107482910156  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10528755187988281  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.15488338470459  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10486316680908203  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.879497528076172  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10516786575317383  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.556811332702637  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10474300384521484  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.078367710113525  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10525083541870117  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.85159921646118  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10514259338378906  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.353957653045654  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10522222518920898  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.804258823394775  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10447931289672852  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.644259929656982  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10512733459472656  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.325105667114258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1048574447631836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.82027578353882  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10525035858154297  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.962665557861328  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10475873947143555  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.047306537628174  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10525751113891602  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.991342544555664  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10458183288574219  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.006508827209473  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10524415969848633  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.881519317626953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10443353652954102  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.692835330963135  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10532522201538086  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.305272102355957  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10508394241333008  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.415855407714844  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1052093505859375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.77172565460205  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10479354858398438  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.621625423431396  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10523080825805664  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.87224769592285  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10475873947143555  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.019778728485107  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10529422760009766  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.165113925933838  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10460662841796875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.99419403076172  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03621841222047806 |0.013903990387916565 |0.42377912253141403 |9.425729513168335e-05 |0.7580694481730461 |0.007926225662231445 |
----------------------------------------------------------pseudo_mini_loss sum 1.5149683952331543
Total (block generation + training)time/epoch 93.92326006889343
Training time/epoch 39.48192811012268
Training time without block to device /epoch 39.03700041770935
Training time without total dataloading part /epoch 37.83009672164917
load block tensor time/epoch 1.1589891910552979
block to device time/epoch 0.4449276924133301
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  8798467
Number of first layer input nodes during this epoch:  4683244
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.12318944931030273  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025423288345336914
random selection method range initialization spend 0.006602048873901367
time for parepare:  0.020914793014526367
local_output_nid generation:  0.0014014244079589844
local_in_edges_tensor generation:  0.00414276123046875
mini_batch_src_global generation:  0.002325296401977539
r_  generation:  0.011390209197998047
local_output_nid generation:  0.0016331672668457031
local_in_edges_tensor generation:  0.00101470947265625
mini_batch_src_global generation:  0.0017011165618896484
r_  generation:  0.010176420211791992
local_output_nid generation:  0.0016291141510009766
local_in_edges_tensor generation:  0.0009267330169677734
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.01004171371459961
local_output_nid generation:  0.001615285873413086
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.0012166500091552734
r_  generation:  0.010297775268554688
local_output_nid generation:  0.0015845298767089844
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.001125335693359375
r_  generation:  0.009726524353027344
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.0011789798736572266
r_  generation:  0.009898900985717773
local_output_nid generation:  0.001569509506225586
local_in_edges_tensor generation:  0.0008783340454101562
mini_batch_src_global generation:  0.0011548995971679688
r_  generation:  0.010022163391113281
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008740425109863281
mini_batch_src_global generation:  0.0011208057403564453
r_  generation:  0.009818315505981445
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0008785724639892578
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.009973526000976562
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0008847713470458984
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.01038980484008789
local_output_nid generation:  0.0015587806701660156
local_in_edges_tensor generation:  0.0009207725524902344
mini_batch_src_global generation:  0.001172780990600586
r_  generation:  0.010460853576660156
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.0008947849273681641
mini_batch_src_global generation:  0.0012476444244384766
r_  generation:  0.010691165924072266
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.001035451889038086
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.010042190551757812
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0008776187896728516
mini_batch_src_global generation:  0.0011358261108398438
r_  generation:  0.010378599166870117
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.00087738037109375
mini_batch_src_global generation:  0.0011911392211914062
r_  generation:  0.01034092903137207
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0008847713470458984
mini_batch_src_global generation:  0.0011167526245117188
r_  generation:  0.010062694549560547
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0009298324584960938
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.010353565216064453
local_output_nid generation:  0.00324249267578125
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.0012094974517822266
r_  generation:  0.010220766067504883
local_output_nid generation:  0.0015642642974853516
local_in_edges_tensor generation:  0.0009131431579589844
mini_batch_src_global generation:  0.0011699199676513672
r_  generation:  0.010585546493530273
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0008578300476074219
mini_batch_src_global generation:  0.0011436939239501953
r_  generation:  0.010165691375732422
local_output_nid generation:  0.0015668869018554688
local_in_edges_tensor generation:  0.0008995532989501953
mini_batch_src_global generation:  0.0011749267578125
r_  generation:  0.010994911193847656
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0008909702301025391
mini_batch_src_global generation:  0.0012161731719970703
r_  generation:  0.010588407516479492
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0008761882781982422
mini_batch_src_global generation:  0.0011317729949951172
r_  generation:  0.010124921798706055
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0008788108825683594
mini_batch_src_global generation:  0.0011408329010009766
r_  generation:  0.010373115539550781
local_output_nid generation:  0.0016057491302490234
local_in_edges_tensor generation:  0.0008544921875
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.010036230087280273
local_output_nid generation:  0.0015611648559570312
local_in_edges_tensor generation:  0.0008673667907714844
mini_batch_src_global generation:  0.001186370849609375
r_  generation:  0.010453939437866211
local_output_nid generation:  0.0015621185302734375
local_in_edges_tensor generation:  0.0008671283721923828
mini_batch_src_global generation:  0.0011069774627685547
r_  generation:  0.010262012481689453
local_output_nid generation:  0.001558065414428711
local_in_edges_tensor generation:  0.0008816719055175781
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.010730743408203125
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0008797645568847656
mini_batch_src_global generation:  0.001188039779663086
r_  generation:  0.010250329971313477
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0008637905120849609
mini_batch_src_global generation:  0.0011715888977050781
r_  generation:  0.009830713272094727
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0009515285491943359
mini_batch_src_global generation:  0.0011320114135742188
r_  generation:  0.010125398635864258
local_output_nid generation:  0.0015633106231689453
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.010406255722045898
----------------------check_connections_block total spend ----------------------------- 0.5689787864685059
generate_one_block  0.02320098876953125
generate_one_block  0.020733356475830078
generate_one_block  0.018519163131713867
generate_one_block  0.01845550537109375
generate_one_block  0.01739048957824707
generate_one_block  0.017358064651489258
generate_one_block  0.017328262329101562
generate_one_block  0.016973018646240234
generate_one_block  0.018747806549072266
generate_one_block  0.017821073532104492
generate_one_block  0.01755547523498535
generate_one_block  0.018602371215820312
generate_one_block  0.017055511474609375
generate_one_block  0.017708539962768555
generate_one_block  0.017566680908203125
generate_one_block  0.017156362533569336
generate_one_block  0.017615079879760742
generate_one_block  0.01741814613342285
generate_one_block  0.017841815948486328
generate_one_block  0.018918991088867188
generate_one_block  0.018443822860717773
generate_one_block  0.01772308349609375
generate_one_block  0.020273923873901367
generate_one_block  0.018048763275146484
generate_one_block  0.017206907272338867
generate_one_block  0.01728034019470215
generate_one_block  0.017011404037475586
generate_one_block  0.017676115036010742
generate_one_block  0.01729869842529297
generate_one_block  0.01660609245300293
generate_one_block  0.018354177474975586
generate_one_block  0.017693519592285156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03660893440246582
gen group dst list time:  0.025340557098388672
time for parepare:  0.02210068702697754
local_output_nid generation:  0.006222248077392578
local_in_edges_tensor generation:  0.018360614776611328
mini_batch_src_global generation:  0.016030073165893555
r_  generation:  0.13572955131530762
local_output_nid generation:  0.008957386016845703
local_in_edges_tensor generation:  0.011175870895385742
mini_batch_src_global generation:  0.018116235733032227
r_  generation:  0.17869329452514648
local_output_nid generation:  0.01542210578918457
local_in_edges_tensor generation:  0.05327892303466797
mini_batch_src_global generation:  0.019358158111572266
r_  generation:  0.17843985557556152
local_output_nid generation:  0.015322685241699219
local_in_edges_tensor generation:  0.012757539749145508
mini_batch_src_global generation:  0.022636890411376953
r_  generation:  0.16262483596801758
local_output_nid generation:  0.011275768280029297
local_in_edges_tensor generation:  0.01000213623046875
mini_batch_src_global generation:  0.0240786075592041
r_  generation:  0.15588760375976562
local_output_nid generation:  0.010935068130493164
local_in_edges_tensor generation:  0.01217198371887207
mini_batch_src_global generation:  0.019212007522583008
r_  generation:  0.15857839584350586
local_output_nid generation:  0.009354352951049805
local_in_edges_tensor generation:  0.016865968704223633
mini_batch_src_global generation:  0.027467012405395508
r_  generation:  0.1563255786895752
local_output_nid generation:  0.00902557373046875
local_in_edges_tensor generation:  0.01070261001586914
mini_batch_src_global generation:  0.0208740234375
r_  generation:  0.1564490795135498
local_output_nid generation:  0.009131669998168945
local_in_edges_tensor generation:  0.009296894073486328
mini_batch_src_global generation:  0.019364118576049805
r_  generation:  0.1576535701751709
local_output_nid generation:  0.009788274765014648
local_in_edges_tensor generation:  0.010691642761230469
mini_batch_src_global generation:  0.019744873046875
r_  generation:  0.15834498405456543
local_output_nid generation:  0.009952545166015625
local_in_edges_tensor generation:  0.01125192642211914
mini_batch_src_global generation:  0.020851612091064453
r_  generation:  0.15780138969421387
local_output_nid generation:  0.011908292770385742
local_in_edges_tensor generation:  0.009915351867675781
mini_batch_src_global generation:  0.020617008209228516
r_  generation:  0.17519736289978027
local_output_nid generation:  0.012276172637939453
local_in_edges_tensor generation:  0.009016036987304688
mini_batch_src_global generation:  0.018907785415649414
r_  generation:  0.15735983848571777
local_output_nid generation:  0.010447025299072266
local_in_edges_tensor generation:  0.00894021987915039
mini_batch_src_global generation:  0.019444704055786133
r_  generation:  0.16115093231201172
local_output_nid generation:  0.010225057601928711
local_in_edges_tensor generation:  0.008571386337280273
mini_batch_src_global generation:  0.01896047592163086
r_  generation:  0.15529394149780273
local_output_nid generation:  0.010125160217285156
local_in_edges_tensor generation:  0.00865483283996582
mini_batch_src_global generation:  0.018450260162353516
r_  generation:  0.1538681983947754
local_output_nid generation:  0.010226726531982422
local_in_edges_tensor generation:  0.009122371673583984
mini_batch_src_global generation:  0.01982402801513672
r_  generation:  0.15633487701416016
local_output_nid generation:  0.010192155838012695
local_in_edges_tensor generation:  0.009703874588012695
mini_batch_src_global generation:  0.019089937210083008
r_  generation:  0.15766143798828125
local_output_nid generation:  0.010413885116577148
local_in_edges_tensor generation:  0.00899648666381836
mini_batch_src_global generation:  0.020369768142700195
r_  generation:  0.15838313102722168
local_output_nid generation:  0.010283708572387695
local_in_edges_tensor generation:  0.009157419204711914
mini_batch_src_global generation:  0.01921677589416504
r_  generation:  0.158677339553833
local_output_nid generation:  0.010753154754638672
local_in_edges_tensor generation:  0.009342193603515625
mini_batch_src_global generation:  0.01999044418334961
r_  generation:  0.1639113426208496
local_output_nid generation:  0.010206460952758789
local_in_edges_tensor generation:  0.009118795394897461
mini_batch_src_global generation:  0.019483327865600586
r_  generation:  0.1999835968017578
local_output_nid generation:  0.011921405792236328
local_in_edges_tensor generation:  0.008339405059814453
mini_batch_src_global generation:  0.021081209182739258
r_  generation:  0.15384602546691895
local_output_nid generation:  0.010187625885009766
local_in_edges_tensor generation:  0.008497238159179688
mini_batch_src_global generation:  0.021786212921142578
r_  generation:  0.158250093460083
local_output_nid generation:  0.01009988784790039
local_in_edges_tensor generation:  0.0088958740234375
mini_batch_src_global generation:  0.018826007843017578
r_  generation:  0.15374469757080078
local_output_nid generation:  0.009561300277709961
local_in_edges_tensor generation:  0.009156465530395508
mini_batch_src_global generation:  0.01888728141784668
r_  generation:  0.15839385986328125
local_output_nid generation:  0.009767532348632812
local_in_edges_tensor generation:  0.008361577987670898
mini_batch_src_global generation:  0.018535137176513672
r_  generation:  0.15241456031799316
local_output_nid generation:  0.010196685791015625
local_in_edges_tensor generation:  0.008533716201782227
mini_batch_src_global generation:  0.019788742065429688
r_  generation:  0.1594548225402832
local_output_nid generation:  0.010062217712402344
local_in_edges_tensor generation:  0.008436918258666992
mini_batch_src_global generation:  0.020839691162109375
r_  generation:  0.15283417701721191
local_output_nid generation:  0.009865760803222656
local_in_edges_tensor generation:  0.01056981086730957
mini_batch_src_global generation:  0.018647432327270508
r_  generation:  0.14925408363342285
local_output_nid generation:  0.009988784790039062
local_in_edges_tensor generation:  0.00967097282409668
mini_batch_src_global generation:  0.018239498138427734
r_  generation:  0.15058422088623047
local_output_nid generation:  0.010210037231445312
local_in_edges_tensor generation:  0.008461952209472656
mini_batch_src_global generation:  0.01916217803955078
r_  generation:  0.16190648078918457
----------------------check_connections_block total spend ----------------------------- 7.612090349197388
generate_one_block  0.20754194259643555
generate_one_block  0.2071213722229004
generate_one_block  0.2093057632446289
generate_one_block  0.21107697486877441
generate_one_block  0.21421599388122559
generate_one_block  0.20134210586547852
generate_one_block  0.20148634910583496
generate_one_block  0.19545674324035645
generate_one_block  0.20377802848815918
generate_one_block  0.20598626136779785
generate_one_block  0.21924996376037598
generate_one_block  0.22348237037658691
generate_one_block  0.20393848419189453
generate_one_block  0.21436548233032227
generate_one_block  0.2070772647857666
generate_one_block  0.2041921615600586
generate_one_block  0.2251598834991455
generate_one_block  0.20992732048034668
generate_one_block  0.2114427089691162
generate_one_block  0.21690845489501953
generate_one_block  0.21960949897766113
generate_one_block  0.2078113555908203
generate_one_block  0.19947147369384766
generate_one_block  0.2032327651977539
generate_one_block  0.20079588890075684
generate_one_block  0.2049088478088379
generate_one_block  0.19762897491455078
generate_one_block  0.20737385749816895
generate_one_block  0.1999502182006836
generate_one_block  0.1930689811706543
generate_one_block  0.19855856895446777
generate_one_block  0.21296906471252441
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037099599838256836
gen group dst list time:  0.11846661567687988
time for parepare:  0.019682645797729492
local_output_nid generation:  0.024968624114990234
local_in_edges_tensor generation:  0.046514034271240234
mini_batch_src_global generation:  0.03992319107055664
r_  generation:  0.4031984806060791
local_output_nid generation:  0.030041933059692383
local_in_edges_tensor generation:  0.03660225868225098
mini_batch_src_global generation:  0.049733638763427734
r_  generation:  0.40961194038391113
local_output_nid generation:  0.03022623062133789
local_in_edges_tensor generation:  0.03394961357116699
mini_batch_src_global generation:  0.049485206604003906
r_  generation:  0.4212794303894043
local_output_nid generation:  0.030256032943725586
local_in_edges_tensor generation:  0.02873826026916504
mini_batch_src_global generation:  0.05078744888305664
r_  generation:  0.4178617000579834
local_output_nid generation:  0.02992987632751465
local_in_edges_tensor generation:  0.026294946670532227
mini_batch_src_global generation:  0.051065921783447266
r_  generation:  0.41677021980285645
local_output_nid generation:  0.03077864646911621
local_in_edges_tensor generation:  0.03279876708984375
mini_batch_src_global generation:  0.05054187774658203
r_  generation:  0.42002415657043457
local_output_nid generation:  0.028281688690185547
local_in_edges_tensor generation:  0.02950286865234375
mini_batch_src_global generation:  0.051270246505737305
r_  generation:  0.4264531135559082
local_output_nid generation:  0.030352354049682617
local_in_edges_tensor generation:  0.028176546096801758
mini_batch_src_global generation:  0.0489809513092041
r_  generation:  0.40416383743286133
local_output_nid generation:  0.029127836227416992
local_in_edges_tensor generation:  0.027951478958129883
mini_batch_src_global generation:  0.04916787147521973
r_  generation:  0.4192519187927246
local_output_nid generation:  0.029127836227416992
local_in_edges_tensor generation:  0.027077674865722656
mini_batch_src_global generation:  0.04944038391113281
r_  generation:  0.41557979583740234
local_output_nid generation:  0.02877950668334961
local_in_edges_tensor generation:  0.02800726890563965
mini_batch_src_global generation:  0.049633026123046875
r_  generation:  0.41770291328430176
local_output_nid generation:  0.02906179428100586
local_in_edges_tensor generation:  0.029483556747436523
mini_batch_src_global generation:  0.04988217353820801
r_  generation:  0.42774200439453125
local_output_nid generation:  0.029117345809936523
local_in_edges_tensor generation:  0.029228925704956055
mini_batch_src_global generation:  0.04921913146972656
r_  generation:  0.41862988471984863
local_output_nid generation:  0.029393911361694336
local_in_edges_tensor generation:  0.02748274803161621
mini_batch_src_global generation:  0.05169200897216797
r_  generation:  0.41544151306152344
local_output_nid generation:  0.028839826583862305
local_in_edges_tensor generation:  0.032073974609375
mini_batch_src_global generation:  0.04817461967468262
r_  generation:  0.416332483291626
local_output_nid generation:  0.029033660888671875
local_in_edges_tensor generation:  0.025091886520385742
mini_batch_src_global generation:  0.049710750579833984
r_  generation:  0.411177396774292
local_output_nid generation:  0.029194116592407227
local_in_edges_tensor generation:  0.03165769577026367
mini_batch_src_global generation:  0.04906487464904785
r_  generation:  0.4212219715118408
local_output_nid generation:  0.029354333877563477
local_in_edges_tensor generation:  0.029064655303955078
mini_batch_src_global generation:  0.05205130577087402
r_  generation:  0.4157593250274658
local_output_nid generation:  0.029081106185913086
local_in_edges_tensor generation:  0.027719974517822266
mini_batch_src_global generation:  0.04774594306945801
r_  generation:  0.42127323150634766
local_output_nid generation:  0.0290224552154541
local_in_edges_tensor generation:  0.027277708053588867
mini_batch_src_global generation:  0.049579620361328125
r_  generation:  0.41265225410461426
local_output_nid generation:  0.030773401260375977
local_in_edges_tensor generation:  0.03160715103149414
mini_batch_src_global generation:  0.05028080940246582
r_  generation:  0.4225642681121826
local_output_nid generation:  0.029689788818359375
local_in_edges_tensor generation:  0.028295040130615234
mini_batch_src_global generation:  0.050002336502075195
r_  generation:  0.40926074981689453
local_output_nid generation:  0.03038763999938965
local_in_edges_tensor generation:  0.028035879135131836
mini_batch_src_global generation:  0.04749941825866699
r_  generation:  0.41797733306884766
local_output_nid generation:  0.02903890609741211
local_in_edges_tensor generation:  0.02834010124206543
mini_batch_src_global generation:  0.05096316337585449
r_  generation:  0.4216649532318115
local_output_nid generation:  0.03288102149963379
local_in_edges_tensor generation:  0.027440547943115234
mini_batch_src_global generation:  0.05029606819152832
r_  generation:  0.42067384719848633
local_output_nid generation:  0.029857873916625977
local_in_edges_tensor generation:  0.02779078483581543
mini_batch_src_global generation:  0.04986977577209473
r_  generation:  0.41182756423950195
local_output_nid generation:  0.028656005859375
local_in_edges_tensor generation:  0.027246713638305664
mini_batch_src_global generation:  0.047434091567993164
r_  generation:  0.4168875217437744
local_output_nid generation:  0.029043197631835938
local_in_edges_tensor generation:  0.025229215621948242
mini_batch_src_global generation:  0.05091094970703125
r_  generation:  0.41801977157592773
local_output_nid generation:  0.028968095779418945
local_in_edges_tensor generation:  0.02875804901123047
mini_batch_src_global generation:  0.04703259468078613
r_  generation:  0.4170267581939697
local_output_nid generation:  0.028494834899902344
local_in_edges_tensor generation:  0.026934385299682617
mini_batch_src_global generation:  0.048625946044921875
r_  generation:  0.40645599365234375
local_output_nid generation:  0.028786897659301758
local_in_edges_tensor generation:  0.02521491050720215
mini_batch_src_global generation:  0.04852938652038574
r_  generation:  0.4166109561920166
local_output_nid generation:  0.028980493545532227
local_in_edges_tensor generation:  0.027385711669921875
mini_batch_src_global generation:  0.05091071128845215
r_  generation:  0.41939640045166016
----------------------check_connections_block total spend ----------------------------- 19.744802236557007
generate_one_block  0.5589642524719238
generate_one_block  0.5544250011444092
generate_one_block  0.5582594871520996
generate_one_block  0.5614843368530273
generate_one_block  0.6452863216400146
generate_one_block  0.5477101802825928
generate_one_block  0.5513858795166016
generate_one_block  0.5441029071807861
generate_one_block  0.5574393272399902
generate_one_block  0.5634009838104248
generate_one_block  0.5489037036895752
generate_one_block  0.5675454139709473
generate_one_block  0.5504143238067627
generate_one_block  0.5631222724914551
generate_one_block  0.5484094619750977
generate_one_block  0.5459866523742676
generate_one_block  0.5625829696655273
generate_one_block  0.5620489120483398
generate_one_block  0.5574731826782227
generate_one_block  0.5600457191467285
generate_one_block  0.5624639987945557
generate_one_block  0.5549535751342773
generate_one_block  0.5496702194213867
generate_one_block  0.5582349300384521
generate_one_block  0.5674169063568115
generate_one_block  0.5604817867279053
generate_one_block  0.561058759689331
generate_one_block  0.5615119934082031
generate_one_block  0.5581119060516357
generate_one_block  0.5537886619567871
generate_one_block  0.5524764060974121
generate_one_block  0.56600022315979
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.12318944931030273  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  27.356892585754395
block generation total time  24.553595781326294
average batch blocks generation time:  0.7672998681664467
block dataloader generation time/epoch 54.752949158350624
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10519170761108398  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.59578800201416  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10453128814697266  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.965426921844482  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1052999496459961  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.16738796234131  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10483407974243164  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.30546522140503  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10521221160888672  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.724448204040527  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10489320755004883  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.799269676208496  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10522842407226562  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.91195774078369  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1041717529296875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.501760959625244  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10524368286132812  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.886231899261475  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10481071472167969  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.09260845184326  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10525369644165039  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.980990886688232  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10469341278076172  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.388652324676514  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10520458221435547  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.720587730407715  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10486030578613281  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.18486738204956  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10523414611816406  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.815561771392822  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10480737686157227  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.595500946044922  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10526418685913086  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.095494747161865  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10501241683959961  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.100153923034668  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10529756546020508  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.15715456008911  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10471343994140625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.051662921905518  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1053619384765625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.483882904052734  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10469579696655273  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.02984094619751  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10520696640014648  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.683461666107178  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10498332977294922  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.892757892608643  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10521507263183594  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.759389400482178  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10465812683105469  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.00042963027954  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10518980026245117  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.586198806762695  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10486173629760742  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.03539514541626  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1052103042602539  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.716349601745605  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10456180572509766  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.27318000793457  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10516548156738281  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.49906015396118  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10470724105834961  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.095163345336914  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03777384012937546 |0.015788666903972626 |0.41751493513584137 |9.475648403167725e-05 |0.7545353695750237 |0.006405353546142578 |
----------------------------------------------------------pseudo_mini_loss sum 1.4831849336624146
Total (block generation + training)time/epoch 93.97265418370564
Training time/epoch 39.27840971946716
Training time without block to device /epoch 38.77317237854004
Training time without total dataloading part /epoch 37.51504731178284
load block tensor time/epoch 1.2087628841400146
block to device time/epoch 0.505237340927124
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  8792386
Number of first layer input nodes during this epoch:  4681178
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.12347269058227539  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02871870994567871
random selection method range initialization spend 0.005919456481933594
time for parepare:  0.024546384811401367
local_output_nid generation:  0.0018451213836669922
local_in_edges_tensor generation:  0.005636453628540039
mini_batch_src_global generation:  0.002502918243408203
r_  generation:  0.010744333267211914
local_output_nid generation:  0.001703023910522461
local_in_edges_tensor generation:  0.0012137889862060547
mini_batch_src_global generation:  0.0022246837615966797
r_  generation:  0.011121511459350586
local_output_nid generation:  0.0019378662109375
local_in_edges_tensor generation:  0.001239776611328125
mini_batch_src_global generation:  0.0016245841979980469
r_  generation:  0.01008749008178711
local_output_nid generation:  0.0020241737365722656
local_in_edges_tensor generation:  0.0011544227600097656
mini_batch_src_global generation:  0.0016698837280273438
r_  generation:  0.010109901428222656
local_output_nid generation:  0.0020461082458496094
local_in_edges_tensor generation:  0.0012102127075195312
mini_batch_src_global generation:  0.0015435218811035156
r_  generation:  0.010317325592041016
local_output_nid generation:  0.002088308334350586
local_in_edges_tensor generation:  0.0011637210845947266
mini_batch_src_global generation:  0.0015797615051269531
r_  generation:  0.010782718658447266
local_output_nid generation:  0.002159595489501953
local_in_edges_tensor generation:  0.0011696815490722656
mini_batch_src_global generation:  0.0015022754669189453
r_  generation:  0.010750293731689453
local_output_nid generation:  0.002126932144165039
local_in_edges_tensor generation:  0.0011744499206542969
mini_batch_src_global generation:  0.0014929771423339844
r_  generation:  0.010020017623901367
local_output_nid generation:  0.0021593570709228516
local_in_edges_tensor generation:  0.0011289119720458984
mini_batch_src_global generation:  0.0015406608581542969
r_  generation:  0.010250091552734375
local_output_nid generation:  0.0021653175354003906
local_in_edges_tensor generation:  0.0011382102966308594
mini_batch_src_global generation:  0.0016031265258789062
r_  generation:  0.010572195053100586
local_output_nid generation:  0.002205371856689453
local_in_edges_tensor generation:  0.0011816024780273438
mini_batch_src_global generation:  0.001519918441772461
r_  generation:  0.010697603225708008
local_output_nid generation:  0.0022220611572265625
local_in_edges_tensor generation:  0.001125335693359375
mini_batch_src_global generation:  0.0013887882232666016
r_  generation:  0.010420083999633789
local_output_nid generation:  0.002194643020629883
local_in_edges_tensor generation:  0.0011162757873535156
mini_batch_src_global generation:  0.0014467239379882812
r_  generation:  0.01033639907836914
local_output_nid generation:  0.002294301986694336
local_in_edges_tensor generation:  0.0011684894561767578
mini_batch_src_global generation:  0.001516103744506836
r_  generation:  0.010881662368774414
local_output_nid generation:  0.002197265625
local_in_edges_tensor generation:  0.0011115074157714844
mini_batch_src_global generation:  0.0014455318450927734
r_  generation:  0.010300397872924805
local_output_nid generation:  0.002206563949584961
local_in_edges_tensor generation:  0.0011525154113769531
mini_batch_src_global generation:  0.001573324203491211
r_  generation:  0.010445117950439453
local_output_nid generation:  0.002221345901489258
local_in_edges_tensor generation:  0.001194000244140625
mini_batch_src_global generation:  0.0014793872833251953
r_  generation:  0.010614871978759766
local_output_nid generation:  0.002226114273071289
local_in_edges_tensor generation:  0.0011823177337646484
mini_batch_src_global generation:  0.001478433609008789
r_  generation:  0.010770559310913086
local_output_nid generation:  0.002233266830444336
local_in_edges_tensor generation:  0.001165628433227539
mini_batch_src_global generation:  0.0014717578887939453
r_  generation:  0.01073145866394043
local_output_nid generation:  0.002224445343017578
local_in_edges_tensor generation:  0.001123666763305664
mini_batch_src_global generation:  0.0014123916625976562
r_  generation:  0.010313272476196289
local_output_nid generation:  0.002189159393310547
local_in_edges_tensor generation:  0.0011494159698486328
mini_batch_src_global generation:  0.0014028549194335938
r_  generation:  0.010414838790893555
local_output_nid generation:  0.002218484878540039
local_in_edges_tensor generation:  0.00109100341796875
mini_batch_src_global generation:  0.001477956771850586
r_  generation:  0.010360002517700195
local_output_nid generation:  0.0022237300872802734
local_in_edges_tensor generation:  0.001142263412475586
mini_batch_src_global generation:  0.0014560222625732422
r_  generation:  0.010783672332763672
local_output_nid generation:  0.0022192001342773438
local_in_edges_tensor generation:  0.0011451244354248047
mini_batch_src_global generation:  0.0015530586242675781
r_  generation:  0.0103912353515625
local_output_nid generation:  0.002228975296020508
local_in_edges_tensor generation:  0.0011355876922607422
mini_batch_src_global generation:  0.0013976097106933594
r_  generation:  0.010494232177734375
local_output_nid generation:  0.002207040786743164
local_in_edges_tensor generation:  0.0011513233184814453
mini_batch_src_global generation:  0.0014879703521728516
r_  generation:  0.010032415390014648
local_output_nid generation:  0.002217531204223633
local_in_edges_tensor generation:  0.001127004623413086
mini_batch_src_global generation:  0.0013709068298339844
r_  generation:  0.010439157485961914
local_output_nid generation:  0.002207040786743164
local_in_edges_tensor generation:  0.0011594295501708984
mini_batch_src_global generation:  0.0014057159423828125
r_  generation:  0.010383129119873047
local_output_nid generation:  0.0022356510162353516
local_in_edges_tensor generation:  0.001102447509765625
mini_batch_src_global generation:  0.0014297962188720703
r_  generation:  0.010340213775634766
local_output_nid generation:  0.0022368431091308594
local_in_edges_tensor generation:  0.0011355876922607422
mini_batch_src_global generation:  0.0013909339904785156
r_  generation:  0.010283231735229492
local_output_nid generation:  0.002209901809692383
local_in_edges_tensor generation:  0.0011467933654785156
mini_batch_src_global generation:  0.0014564990997314453
r_  generation:  0.010711669921875
local_output_nid generation:  0.002233266830444336
local_in_edges_tensor generation:  0.0011341571807861328
mini_batch_src_global generation:  0.0014293193817138672
r_  generation:  0.010575056076049805
----------------------check_connections_block total spend ----------------------------- 0.6250979900360107
generate_one_block  0.03901553153991699
generate_one_block  0.021361827850341797
generate_one_block  0.018274784088134766
generate_one_block  0.01793074607849121
generate_one_block  0.017852067947387695
generate_one_block  0.021031856536865234
generate_one_block  0.01803302764892578
generate_one_block  0.01713871955871582
generate_one_block  0.017263174057006836
generate_one_block  0.017908096313476562
generate_one_block  0.017636537551879883
generate_one_block  0.019662857055664062
generate_one_block  0.017210006713867188
generate_one_block  0.018101215362548828
generate_one_block  0.01701211929321289
generate_one_block  0.017407894134521484
generate_one_block  0.02011847496032715
generate_one_block  0.018807172775268555
generate_one_block  0.017617225646972656
generate_one_block  0.017217397689819336
generate_one_block  0.01720595359802246
generate_one_block  0.01723504066467285
generate_one_block  0.023573875427246094
generate_one_block  0.018002748489379883
generate_one_block  0.017339706420898438
generate_one_block  0.016857147216796875
generate_one_block  0.017216205596923828
generate_one_block  0.01694321632385254
generate_one_block  0.019711017608642578
generate_one_block  0.016939163208007812
generate_one_block  0.017592668533325195
generate_one_block  0.017362356185913086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07313156127929688
gen group dst list time:  0.027821063995361328
time for parepare:  0.023876667022705078
local_output_nid generation:  0.006632566452026367
local_in_edges_tensor generation:  0.01806640625
mini_batch_src_global generation:  0.021123647689819336
r_  generation:  0.14738702774047852
local_output_nid generation:  0.009450435638427734
local_in_edges_tensor generation:  0.013417959213256836
mini_batch_src_global generation:  0.020087718963623047
r_  generation:  0.1456737518310547
local_output_nid generation:  0.011830329895019531
local_in_edges_tensor generation:  0.03450632095336914
mini_batch_src_global generation:  0.01956939697265625
r_  generation:  0.15302491188049316
local_output_nid generation:  0.009658575057983398
local_in_edges_tensor generation:  0.011186838150024414
mini_batch_src_global generation:  0.01708698272705078
r_  generation:  0.1538228988647461
local_output_nid generation:  0.00983285903930664
local_in_edges_tensor generation:  0.0093231201171875
mini_batch_src_global generation:  0.03492140769958496
r_  generation:  0.1637706756591797
local_output_nid generation:  0.010886907577514648
local_in_edges_tensor generation:  0.013712882995605469
mini_batch_src_global generation:  0.020352840423583984
r_  generation:  0.15879440307617188
local_output_nid generation:  0.009263992309570312
local_in_edges_tensor generation:  0.008944034576416016
mini_batch_src_global generation:  0.01891636848449707
r_  generation:  0.15503716468811035
local_output_nid generation:  0.008965492248535156
local_in_edges_tensor generation:  0.009169578552246094
mini_batch_src_global generation:  0.018217086791992188
r_  generation:  0.1473226547241211
local_output_nid generation:  0.009024858474731445
local_in_edges_tensor generation:  0.011011838912963867
mini_batch_src_global generation:  0.01898360252380371
r_  generation:  0.1860790252685547
local_output_nid generation:  0.009594440460205078
local_in_edges_tensor generation:  0.008981466293334961
mini_batch_src_global generation:  0.01909160614013672
r_  generation:  0.20270729064941406
local_output_nid generation:  0.009595155715942383
local_in_edges_tensor generation:  0.009521245956420898
mini_batch_src_global generation:  0.01943659782409668
r_  generation:  0.15585732460021973
local_output_nid generation:  0.009455204010009766
local_in_edges_tensor generation:  0.009783744812011719
mini_batch_src_global generation:  0.01857781410217285
r_  generation:  0.14803814888000488
local_output_nid generation:  0.00956273078918457
local_in_edges_tensor generation:  0.008600234985351562
mini_batch_src_global generation:  0.018244504928588867
r_  generation:  0.1509566307067871
local_output_nid generation:  0.009765148162841797
local_in_edges_tensor generation:  0.00889444351196289
mini_batch_src_global generation:  0.02179694175720215
r_  generation:  0.15823793411254883
local_output_nid generation:  0.009401559829711914
local_in_edges_tensor generation:  0.008311748504638672
mini_batch_src_global generation:  0.01965928077697754
r_  generation:  0.19666552543640137
local_output_nid generation:  0.00941324234008789
local_in_edges_tensor generation:  0.008637666702270508
mini_batch_src_global generation:  0.01959514617919922
r_  generation:  0.15873408317565918
local_output_nid generation:  0.009595632553100586
local_in_edges_tensor generation:  0.008640527725219727
mini_batch_src_global generation:  0.01883387565612793
r_  generation:  0.1579139232635498
local_output_nid generation:  0.009721040725708008
local_in_edges_tensor generation:  0.009180307388305664
mini_batch_src_global generation:  0.01962137222290039
r_  generation:  0.15816640853881836
local_output_nid generation:  0.00983428955078125
local_in_edges_tensor generation:  0.009318828582763672
mini_batch_src_global generation:  0.02115488052368164
r_  generation:  0.15904927253723145
local_output_nid generation:  0.012328624725341797
local_in_edges_tensor generation:  0.009242773056030273
mini_batch_src_global generation:  0.019034624099731445
r_  generation:  0.1572558879852295
local_output_nid generation:  0.009767770767211914
local_in_edges_tensor generation:  0.01306462287902832
mini_batch_src_global generation:  0.01957988739013672
r_  generation:  0.15897846221923828
local_output_nid generation:  0.009662628173828125
local_in_edges_tensor generation:  0.008671283721923828
mini_batch_src_global generation:  0.019801616668701172
r_  generation:  0.15779781341552734
local_output_nid generation:  0.009857892990112305
local_in_edges_tensor generation:  0.011422395706176758
mini_batch_src_global generation:  0.021331310272216797
r_  generation:  0.16012263298034668
local_output_nid generation:  0.009605884552001953
local_in_edges_tensor generation:  0.010680437088012695
mini_batch_src_global generation:  0.01993584632873535
r_  generation:  0.15354084968566895
local_output_nid generation:  0.009579658508300781
local_in_edges_tensor generation:  0.009339570999145508
mini_batch_src_global generation:  0.019611120223999023
r_  generation:  0.15778112411499023
local_output_nid generation:  0.009183645248413086
local_in_edges_tensor generation:  0.01031947135925293
mini_batch_src_global generation:  0.01869964599609375
r_  generation:  0.14805221557617188
local_output_nid generation:  0.009537696838378906
local_in_edges_tensor generation:  0.00856781005859375
mini_batch_src_global generation:  0.018417835235595703
r_  generation:  0.15342497825622559
local_output_nid generation:  0.009546041488647461
local_in_edges_tensor generation:  0.008402347564697266
mini_batch_src_global generation:  0.018408775329589844
r_  generation:  0.15203285217285156
local_output_nid generation:  0.009606122970581055
local_in_edges_tensor generation:  0.00916910171508789
mini_batch_src_global generation:  0.018622636795043945
r_  generation:  0.15475988388061523
local_output_nid generation:  0.009352445602416992
local_in_edges_tensor generation:  0.008865833282470703
mini_batch_src_global generation:  0.01854395866394043
r_  generation:  0.15064239501953125
local_output_nid generation:  0.009702205657958984
local_in_edges_tensor generation:  0.009330034255981445
mini_batch_src_global generation:  0.01914381980895996
r_  generation:  0.16207551956176758
local_output_nid generation:  0.009752273559570312
local_in_edges_tensor generation:  0.009339094161987305
mini_batch_src_global generation:  0.01933121681213379
r_  generation:  0.16004419326782227
----------------------check_connections_block total spend ----------------------------- 7.563300371170044
generate_one_block  0.22469544410705566
generate_one_block  0.2063596248626709
generate_one_block  0.2066330909729004
generate_one_block  0.2046651840209961
generate_one_block  0.22262883186340332
generate_one_block  0.21297788619995117
generate_one_block  0.2059628963470459
generate_one_block  0.1964859962463379
generate_one_block  0.2003631591796875
generate_one_block  0.20594382286071777
generate_one_block  0.2043776512145996
generate_one_block  0.19469571113586426
generate_one_block  0.20064067840576172
generate_one_block  0.2163081169128418
generate_one_block  0.21411490440368652
generate_one_block  0.20989584922790527
generate_one_block  0.20973753929138184
generate_one_block  0.21561741828918457
generate_one_block  0.21027088165283203
generate_one_block  0.21005487442016602
generate_one_block  0.20365190505981445
generate_one_block  0.20479989051818848
generate_one_block  0.21097731590270996
generate_one_block  0.20520639419555664
generate_one_block  0.2113037109375
generate_one_block  0.19976234436035156
generate_one_block  0.20241236686706543
generate_one_block  0.20721673965454102
generate_one_block  0.2050032615661621
generate_one_block  0.20198678970336914
generate_one_block  0.2093360424041748
generate_one_block  0.210280179977417
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04532313346862793
gen group dst list time:  0.1358497142791748
time for parepare:  0.01935410499572754
local_output_nid generation:  0.026400327682495117
local_in_edges_tensor generation:  0.04765629768371582
mini_batch_src_global generation:  0.03750276565551758
r_  generation:  0.4055519104003906
local_output_nid generation:  0.031334638595581055
local_in_edges_tensor generation:  0.032631635665893555
mini_batch_src_global generation:  0.0484921932220459
r_  generation:  0.4005250930786133
local_output_nid generation:  0.031296491622924805
local_in_edges_tensor generation:  0.02873516082763672
mini_batch_src_global generation:  0.04818844795227051
r_  generation:  0.41679906845092773
local_output_nid generation:  0.03184866905212402
local_in_edges_tensor generation:  0.029705047607421875
mini_batch_src_global generation:  0.049359798431396484
r_  generation:  0.40972304344177246
local_output_nid generation:  0.03153800964355469
local_in_edges_tensor generation:  0.02732706069946289
mini_batch_src_global generation:  0.047518253326416016
r_  generation:  0.418320894241333
local_output_nid generation:  0.031450510025024414
local_in_edges_tensor generation:  0.031060218811035156
mini_batch_src_global generation:  0.04965329170227051
r_  generation:  0.4141347408294678
local_output_nid generation:  0.02991962432861328
local_in_edges_tensor generation:  0.027960777282714844
mini_batch_src_global generation:  0.05005645751953125
r_  generation:  0.42072153091430664
local_output_nid generation:  0.029224634170532227
local_in_edges_tensor generation:  0.025517702102661133
mini_batch_src_global generation:  0.049146175384521484
r_  generation:  0.4047274589538574
local_output_nid generation:  0.029326200485229492
local_in_edges_tensor generation:  0.025165081024169922
mini_batch_src_global generation:  0.047301292419433594
r_  generation:  0.41501450538635254
local_output_nid generation:  0.02948784828186035
local_in_edges_tensor generation:  0.025580883026123047
mini_batch_src_global generation:  0.049509525299072266
r_  generation:  0.42726874351501465
local_output_nid generation:  0.029559612274169922
local_in_edges_tensor generation:  0.02748394012451172
mini_batch_src_global generation:  0.04719901084899902
r_  generation:  0.42532873153686523
local_output_nid generation:  0.029640674591064453
local_in_edges_tensor generation:  0.028809785842895508
mini_batch_src_global generation:  0.050066471099853516
r_  generation:  0.40665125846862793
local_output_nid generation:  0.029868602752685547
local_in_edges_tensor generation:  0.032061100006103516
mini_batch_src_global generation:  0.04827547073364258
r_  generation:  0.42435216903686523
local_output_nid generation:  0.030994892120361328
local_in_edges_tensor generation:  0.030009984970092773
mini_batch_src_global generation:  0.04995870590209961
r_  generation:  0.41473937034606934
local_output_nid generation:  0.029467344284057617
local_in_edges_tensor generation:  0.030343055725097656
mini_batch_src_global generation:  0.046912193298339844
r_  generation:  0.41907286643981934
local_output_nid generation:  0.02966618537902832
local_in_edges_tensor generation:  0.03081035614013672
mini_batch_src_global generation:  0.049425363540649414
r_  generation:  0.42563629150390625
local_output_nid generation:  0.031288862228393555
local_in_edges_tensor generation:  0.02781200408935547
mini_batch_src_global generation:  0.0491175651550293
r_  generation:  0.4216334819793701
local_output_nid generation:  0.028966426849365234
local_in_edges_tensor generation:  0.029872655868530273
mini_batch_src_global generation:  0.049428701400756836
r_  generation:  0.41157102584838867
local_output_nid generation:  0.028844833374023438
local_in_edges_tensor generation:  0.027683496475219727
mini_batch_src_global generation:  0.047777652740478516
r_  generation:  0.42074108123779297
local_output_nid generation:  0.028484344482421875
local_in_edges_tensor generation:  0.02723836898803711
mini_batch_src_global generation:  0.049416542053222656
r_  generation:  0.4074361324310303
local_output_nid generation:  0.02857518196105957
local_in_edges_tensor generation:  0.02732539176940918
mini_batch_src_global generation:  0.04897642135620117
r_  generation:  0.41710615158081055
local_output_nid generation:  0.028722524642944336
local_in_edges_tensor generation:  0.025807857513427734
mini_batch_src_global generation:  0.05179882049560547
r_  generation:  0.41179442405700684
local_output_nid generation:  0.028736114501953125
local_in_edges_tensor generation:  0.029462814331054688
mini_batch_src_global generation:  0.04931473731994629
r_  generation:  0.4204976558685303
local_output_nid generation:  0.02868962287902832
local_in_edges_tensor generation:  0.027971506118774414
mini_batch_src_global generation:  0.049559593200683594
r_  generation:  0.41457056999206543
local_output_nid generation:  0.028548240661621094
local_in_edges_tensor generation:  0.025166034698486328
mini_batch_src_global generation:  0.048013925552368164
r_  generation:  0.41847801208496094
local_output_nid generation:  0.02833390235900879
local_in_edges_tensor generation:  0.02739429473876953
mini_batch_src_global generation:  0.04931902885437012
r_  generation:  0.4068608283996582
local_output_nid generation:  0.028492212295532227
local_in_edges_tensor generation:  0.025072097778320312
mini_batch_src_global generation:  0.046990394592285156
r_  generation:  0.4150516986846924
local_output_nid generation:  0.028733015060424805
local_in_edges_tensor generation:  0.02572154998779297
mini_batch_src_global generation:  0.05140376091003418
r_  generation:  0.4171016216278076
local_output_nid generation:  0.028584957122802734
local_in_edges_tensor generation:  0.026843547821044922
mini_batch_src_global generation:  0.047760725021362305
r_  generation:  0.41892480850219727
local_output_nid generation:  0.02862262725830078
local_in_edges_tensor generation:  0.02532339096069336
mini_batch_src_global generation:  0.04979348182678223
r_  generation:  0.4071786403656006
local_output_nid generation:  0.028627395629882812
local_in_edges_tensor generation:  0.02768087387084961
mini_batch_src_global generation:  0.04737734794616699
r_  generation:  0.4226651191711426
local_output_nid generation:  0.03082418441772461
local_in_edges_tensor generation:  0.02596902847290039
mini_batch_src_global generation:  0.04932832717895508
r_  generation:  0.4167466163635254
----------------------check_connections_block total spend ----------------------------- 19.6740825176239
generate_one_block  0.5712838172912598
generate_one_block  0.5524442195892334
generate_one_block  0.5547032356262207
generate_one_block  0.5588159561157227
generate_one_block  0.6509904861450195
generate_one_block  0.5700769424438477
generate_one_block  0.5603642463684082
generate_one_block  0.5526282787322998
generate_one_block  0.5495929718017578
generate_one_block  0.5566763877868652
generate_one_block  0.5589656829833984
generate_one_block  0.5468263626098633
generate_one_block  0.5542888641357422
generate_one_block  0.5661866664886475
generate_one_block  0.5457742214202881
generate_one_block  0.5520496368408203
generate_one_block  0.5579564571380615
generate_one_block  0.552464485168457
generate_one_block  0.5602262020111084
generate_one_block  0.5516049861907959
generate_one_block  0.5546393394470215
generate_one_block  0.5764162540435791
generate_one_block  0.5586695671081543
generate_one_block  0.5611939430236816
generate_one_block  0.5787835121154785
generate_one_block  0.5604496002197266
generate_one_block  0.5482947826385498
generate_one_block  0.5540685653686523
generate_one_block  0.5556693077087402
generate_one_block  0.5521585941314697
generate_one_block  0.5644626617431641
generate_one_block  0.5657167434692383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.12347269058227539  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  27.237382888793945
block generation total time  24.598809480667114
average batch blocks generation time:  0.7687127962708473
block dataloader generation time/epoch 54.79120928900583
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10529327392578125  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.17076826095581  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10481834411621094  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.677072048187256  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10524892807006836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.988182544708252  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10491800308227539  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.06981372833252  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10527563095092773  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.04306697845459  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10487794876098633  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.367259979248047  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10528421401977539  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 17.137054443359375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.1045217514038086  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.580958366394043  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10520648956298828  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 16.701753616333008  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 0.10476922988891602  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6483154296875 GB
    Memory Allocated: 17.050655364990234  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052708625793457  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.068495750427246  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10448646545410156  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.519607067108154  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10520505905151367  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.749308109283447  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10477781295776367  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.162466526031494  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10518026351928711  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.515294075012207  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10451745986938477  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.01039981842041  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526895523071289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.122214317321777  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10495805740356445  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.103443145751953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527944564819336  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.143991947174072  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10439682006835938  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.765226364135742  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521841049194336  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.70749807357788  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10475540161132812  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.770127773284912  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528707504272461  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.134995460510254  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10466146469116211  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.856001377105713  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526752471923828  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.082812309265137  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10446023941040039  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.44705581665039  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052093505859375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.697712898254395  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10473823547363281  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.702129364013672  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052241325378418  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.78768825531006  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1044917106628418  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.60539960861206  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052865982055664  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.12044668197632  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10494756698608398  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.1331787109375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03495346009731293 |0.01657421886920929 |0.41733143478631973 |9.423494338989258e-05 |0.7506172508001328 |0.007937908172607422 |
----------------------------------------------------------pseudo_mini_loss sum 1.4615564346313477
Total (block generation + training)time/epoch 93.99146148136684
Training time/epoch 39.083269357681274
Training time without block to device /epoch 38.55289435386658
Training time without total dataloading part /epoch 37.38531136512756
load block tensor time/epoch 1.1185107231140137
block to device time/epoch 0.5303750038146973
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  8793333
Number of first layer input nodes during this epoch:  4682923
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12368440628051758  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025017738342285156
random selection method range initialization spend 0.005122184753417969
time for parepare:  0.0207672119140625
local_output_nid generation:  0.0014290809631347656
local_in_edges_tensor generation:  0.0077702999114990234
mini_batch_src_global generation:  0.0018661022186279297
r_  generation:  0.011022806167602539
local_output_nid generation:  0.0016574859619140625
local_in_edges_tensor generation:  0.0010652542114257812
mini_batch_src_global generation:  0.0015785694122314453
r_  generation:  0.010044574737548828
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0009710788726806641
mini_batch_src_global generation:  0.0011532306671142578
r_  generation:  0.009673833847045898
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0009980201721191406
mini_batch_src_global generation:  0.0011582374572753906
r_  generation:  0.009919404983520508
local_output_nid generation:  0.0015892982482910156
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.0010898113250732422
r_  generation:  0.00967860221862793
local_output_nid generation:  0.0016286373138427734
local_in_edges_tensor generation:  0.0009467601776123047
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.009897708892822266
local_output_nid generation:  0.001611471176147461
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0011224746704101562
r_  generation:  0.010037899017333984
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.0010840892791748047
r_  generation:  0.009982109069824219
local_output_nid generation:  0.0015969276428222656
local_in_edges_tensor generation:  0.0009388923645019531
mini_batch_src_global generation:  0.0011289119720458984
r_  generation:  0.010435819625854492
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0009245872497558594
mini_batch_src_global generation:  0.0011360645294189453
r_  generation:  0.01034998893737793
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.0011920928955078125
r_  generation:  0.010702848434448242
local_output_nid generation:  0.0016367435455322266
local_in_edges_tensor generation:  0.0009212493896484375
mini_batch_src_global generation:  0.001165628433227539
r_  generation:  0.010660886764526367
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.0012030601501464844
r_  generation:  0.010193586349487305
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0009264945983886719
mini_batch_src_global generation:  0.0011963844299316406
r_  generation:  0.010436773300170898
local_output_nid generation:  0.0016243457794189453
local_in_edges_tensor generation:  0.0009062290191650391
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.010252952575683594
local_output_nid generation:  0.0015892982482910156
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0011944770812988281
r_  generation:  0.010307073593139648
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  0.010408878326416016
local_output_nid generation:  0.0016036033630371094
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0010981559753417969
r_  generation:  0.009839534759521484
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.001123666763305664
r_  generation:  0.010121345520019531
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009143352508544922
mini_batch_src_global generation:  0.0012164115905761719
r_  generation:  0.010666847229003906
local_output_nid generation:  0.001631021499633789
local_in_edges_tensor generation:  0.0009207725524902344
mini_batch_src_global generation:  0.001215219497680664
r_  generation:  0.01080632209777832
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0011708736419677734
r_  generation:  0.010024785995483398
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0008969306945800781
mini_batch_src_global generation:  0.0011126995086669922
r_  generation:  0.010015487670898438
local_output_nid generation:  0.0016388893127441406
local_in_edges_tensor generation:  0.0008921623229980469
mini_batch_src_global generation:  0.0011761188507080078
r_  generation:  0.010158300399780273
local_output_nid generation:  0.0016105175018310547
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.010092020034790039
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0009069442749023438
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.010548114776611328
local_output_nid generation:  0.0016787052154541016
local_in_edges_tensor generation:  0.0009071826934814453
mini_batch_src_global generation:  0.0011942386627197266
r_  generation:  0.010539054870605469
local_output_nid generation:  0.0016074180603027344
local_in_edges_tensor generation:  0.000985860824584961
mini_batch_src_global generation:  0.0012459754943847656
r_  generation:  0.011031627655029297
local_output_nid generation:  0.001603841781616211
local_in_edges_tensor generation:  0.0009052753448486328
mini_batch_src_global generation:  0.0011594295501708984
r_  generation:  0.01060342788696289
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0011408329010009766
r_  generation:  0.010038137435913086
local_output_nid generation:  0.00159454345703125
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0011970996856689453
r_  generation:  0.010123252868652344
local_output_nid generation:  0.001613616943359375
local_in_edges_tensor generation:  0.0008831024169921875
mini_batch_src_global generation:  0.0011167526245117188
r_  generation:  0.009975433349609375
----------------------check_connections_block total spend ----------------------------- 0.5701711177825928
generate_one_block  0.02388167381286621
generate_one_block  0.020495176315307617
generate_one_block  0.01790142059326172
generate_one_block  0.017921924591064453
generate_one_block  0.01710987091064453
generate_one_block  0.01719975471496582
generate_one_block  0.01739358901977539
generate_one_block  0.017203807830810547
generate_one_block  0.017943382263183594
generate_one_block  0.01753401756286621
generate_one_block  0.017937898635864258
generate_one_block  0.01804375648498535
generate_one_block  0.017282485961914062
generate_one_block  0.0175323486328125
generate_one_block  0.01740884780883789
generate_one_block  0.017367124557495117
generate_one_block  0.017317533493041992
generate_one_block  0.016661405563354492
generate_one_block  0.017039060592651367
generate_one_block  0.01800370216369629
generate_one_block  0.017933368682861328
generate_one_block  0.016845226287841797
generate_one_block  0.020067453384399414
generate_one_block  0.017760276794433594
generate_one_block  0.017065763473510742
generate_one_block  0.017503738403320312
generate_one_block  0.01735997200012207
generate_one_block  0.01822352409362793
generate_one_block  0.01748037338256836
generate_one_block  0.01672077178955078
generate_one_block  0.016727447509765625
generate_one_block  0.01696491241455078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03558659553527832
gen group dst list time:  0.02295970916748047
time for parepare:  0.022237777709960938
local_output_nid generation:  0.0065195560455322266
local_in_edges_tensor generation:  0.019270896911621094
mini_batch_src_global generation:  0.015479564666748047
r_  generation:  0.14429807662963867
local_output_nid generation:  0.009230852127075195
local_in_edges_tensor generation:  0.011041641235351562
mini_batch_src_global generation:  0.018110275268554688
r_  generation:  0.14279937744140625
local_output_nid generation:  0.009267807006835938
local_in_edges_tensor generation:  0.03342461585998535
mini_batch_src_global generation:  0.01665782928466797
r_  generation:  0.146254301071167
local_output_nid generation:  0.009351968765258789
local_in_edges_tensor generation:  0.009340047836303711
mini_batch_src_global generation:  0.017286062240600586
r_  generation:  0.14905476570129395
local_output_nid generation:  0.008878469467163086
local_in_edges_tensor generation:  0.010493993759155273
mini_batch_src_global generation:  0.018358945846557617
r_  generation:  0.14528560638427734
local_output_nid generation:  0.008819341659545898
local_in_edges_tensor generation:  0.008487224578857422
mini_batch_src_global generation:  0.018301963806152344
r_  generation:  0.15173578262329102
local_output_nid generation:  0.008814573287963867
local_in_edges_tensor generation:  0.008573770523071289
mini_batch_src_global generation:  0.01813507080078125
r_  generation:  0.15133309364318848
local_output_nid generation:  0.008716344833374023
local_in_edges_tensor generation:  0.008438825607299805
mini_batch_src_global generation:  0.01851367950439453
r_  generation:  0.14976191520690918
local_output_nid generation:  0.009063959121704102
local_in_edges_tensor generation:  0.008647918701171875
mini_batch_src_global generation:  0.01897263526916504
r_  generation:  0.15793585777282715
local_output_nid generation:  0.009163141250610352
local_in_edges_tensor generation:  0.009078502655029297
mini_batch_src_global generation:  0.018979310989379883
r_  generation:  0.1520087718963623
local_output_nid generation:  0.00957036018371582
local_in_edges_tensor generation:  0.009358882904052734
mini_batch_src_global generation:  0.020144939422607422
r_  generation:  0.16197562217712402
local_output_nid generation:  0.009662628173828125
local_in_edges_tensor generation:  0.01095890998840332
mini_batch_src_global generation:  0.019495010375976562
r_  generation:  0.15537118911743164
local_output_nid generation:  0.00933218002319336
local_in_edges_tensor generation:  0.008573055267333984
mini_batch_src_global generation:  0.018971681594848633
r_  generation:  0.15288662910461426
local_output_nid generation:  0.009481191635131836
local_in_edges_tensor generation:  0.008504390716552734
mini_batch_src_global generation:  0.01943182945251465
r_  generation:  0.15560388565063477
local_output_nid generation:  0.009373188018798828
local_in_edges_tensor generation:  0.009133338928222656
mini_batch_src_global generation:  0.01904773712158203
r_  generation:  0.15804696083068848
local_output_nid generation:  0.009347915649414062
local_in_edges_tensor generation:  0.009071826934814453
mini_batch_src_global generation:  0.019383668899536133
r_  generation:  0.15640711784362793
local_output_nid generation:  0.009401082992553711
local_in_edges_tensor generation:  0.009084463119506836
mini_batch_src_global generation:  0.01864027976989746
r_  generation:  0.1563568115234375
local_output_nid generation:  0.00906515121459961
local_in_edges_tensor generation:  0.009172439575195312
mini_batch_src_global generation:  0.0181734561920166
r_  generation:  0.14575529098510742
local_output_nid generation:  0.009305715560913086
local_in_edges_tensor generation:  0.008458852767944336
mini_batch_src_global generation:  0.018671274185180664
r_  generation:  0.15398335456848145
local_output_nid generation:  0.009744882583618164
local_in_edges_tensor generation:  0.008802413940429688
mini_batch_src_global generation:  0.02029871940612793
r_  generation:  0.1599438190460205
local_output_nid generation:  0.009664535522460938
local_in_edges_tensor generation:  0.009768486022949219
mini_batch_src_global generation:  0.019468069076538086
r_  generation:  0.1626589298248291
local_output_nid generation:  0.009194612503051758
local_in_edges_tensor generation:  0.00820779800415039
mini_batch_src_global generation:  0.018752574920654297
r_  generation:  0.14960145950317383
local_output_nid generation:  0.009276628494262695
local_in_edges_tensor generation:  0.008460044860839844
mini_batch_src_global generation:  0.017896175384521484
r_  generation:  0.15331411361694336
local_output_nid generation:  0.009323835372924805
local_in_edges_tensor generation:  0.008363485336303711
mini_batch_src_global generation:  0.01913905143737793
r_  generation:  0.15514516830444336
local_output_nid generation:  0.009371280670166016
local_in_edges_tensor generation:  0.008554220199584961
mini_batch_src_global generation:  0.01810145378112793
r_  generation:  0.15390872955322266
local_output_nid generation:  0.009452581405639648
local_in_edges_tensor generation:  0.009105920791625977
mini_batch_src_global generation:  0.019804954528808594
r_  generation:  0.15590286254882812
local_output_nid generation:  0.009378194808959961
local_in_edges_tensor generation:  0.00899505615234375
mini_batch_src_global generation:  0.0186007022857666
r_  generation:  0.1569361686706543
local_output_nid generation:  0.009621858596801758
local_in_edges_tensor generation:  0.009520292282104492
mini_batch_src_global generation:  0.020044803619384766
r_  generation:  0.1620194911956787
local_output_nid generation:  0.009481430053710938
local_in_edges_tensor generation:  0.009167909622192383
mini_batch_src_global generation:  0.019141197204589844
r_  generation:  0.16053009033203125
local_output_nid generation:  0.009170293807983398
local_in_edges_tensor generation:  0.008429288864135742
mini_batch_src_global generation:  0.018501758575439453
r_  generation:  0.15028142929077148
local_output_nid generation:  0.00923776626586914
local_in_edges_tensor generation:  0.008392333984375
mini_batch_src_global generation:  0.01811528205871582
r_  generation:  0.15400457382202148
local_output_nid generation:  0.00912165641784668
local_in_edges_tensor generation:  0.00885772705078125
mini_batch_src_global generation:  0.018629789352416992
r_  generation:  0.15183401107788086
----------------------check_connections_block total spend ----------------------------- 7.274846076965332
generate_one_block  0.21008944511413574
generate_one_block  0.1997358798980713
generate_one_block  0.19819951057434082
generate_one_block  0.2023162841796875
generate_one_block  0.20846152305603027
generate_one_block  0.20214533805847168
generate_one_block  0.20018458366394043
generate_one_block  0.1982886791229248
generate_one_block  0.20586466789245605
generate_one_block  0.2025315761566162
generate_one_block  0.2125082015991211
generate_one_block  0.20735502243041992
generate_one_block  0.19849133491516113
generate_one_block  0.20320367813110352
generate_one_block  0.20630526542663574
generate_one_block  0.20381999015808105
generate_one_block  0.20195770263671875
generate_one_block  0.19132065773010254
generate_one_block  0.19905447959899902
generate_one_block  0.21494293212890625
generate_one_block  0.21262836456298828
generate_one_block  0.19487547874450684
generate_one_block  0.19727611541748047
generate_one_block  0.20270180702209473
generate_one_block  0.19901561737060547
generate_one_block  0.2074906826019287
generate_one_block  0.20527410507202148
generate_one_block  0.21328282356262207
generate_one_block  0.2084946632385254
generate_one_block  0.19621729850769043
generate_one_block  0.19745182991027832
generate_one_block  0.19939064979553223
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030017614364624023
gen group dst list time:  0.09753060340881348
time for parepare:  0.02004861831665039
local_output_nid generation:  0.02398681640625
local_in_edges_tensor generation:  0.040642738342285156
mini_batch_src_global generation:  0.038770437240600586
r_  generation:  0.41337013244628906
local_output_nid generation:  0.029862165451049805
local_in_edges_tensor generation:  0.032989501953125
mini_batch_src_global generation:  0.048729658126831055
r_  generation:  0.40586376190185547
local_output_nid generation:  0.029661893844604492
local_in_edges_tensor generation:  0.027309894561767578
mini_batch_src_global generation:  0.04655313491821289
r_  generation:  0.41803765296936035
local_output_nid generation:  0.02977609634399414
local_in_edges_tensor generation:  0.027380704879760742
mini_batch_src_global generation:  0.04866790771484375
r_  generation:  0.4096519947052002
local_output_nid generation:  0.029649972915649414
local_in_edges_tensor generation:  0.02669382095336914
mini_batch_src_global generation:  0.046923160552978516
r_  generation:  0.4134788513183594
local_output_nid generation:  0.029624462127685547
local_in_edges_tensor generation:  0.02755284309387207
mini_batch_src_global generation:  0.049254655838012695
r_  generation:  0.4116940498352051
local_output_nid generation:  0.027883052825927734
local_in_edges_tensor generation:  0.02803349494934082
mini_batch_src_global generation:  0.0470881462097168
r_  generation:  0.4154214859008789
local_output_nid generation:  0.027965307235717773
local_in_edges_tensor generation:  0.025383710861206055
mini_batch_src_global generation:  0.04915189743041992
r_  generation:  0.4049820899963379
local_output_nid generation:  0.027877092361450195
local_in_edges_tensor generation:  0.027123689651489258
mini_batch_src_global generation:  0.04775571823120117
r_  generation:  0.42149901390075684
local_output_nid generation:  0.02801203727722168
local_in_edges_tensor generation:  0.025982379913330078
mini_batch_src_global generation:  0.04891324043273926
r_  generation:  0.4106566905975342
local_output_nid generation:  0.028144359588623047
local_in_edges_tensor generation:  0.02788376808166504
mini_batch_src_global generation:  0.0491633415222168
r_  generation:  0.42290520668029785
local_output_nid generation:  0.02798914909362793
local_in_edges_tensor generation:  0.02623772621154785
mini_batch_src_global generation:  0.04905223846435547
r_  generation:  0.4150538444519043
local_output_nid generation:  0.028008699417114258
local_in_edges_tensor generation:  0.02772068977355957
mini_batch_src_global generation:  0.0468597412109375
r_  generation:  0.41794824600219727
local_output_nid generation:  0.028270483016967773
local_in_edges_tensor generation:  0.027591466903686523
mini_batch_src_global generation:  0.04874730110168457
r_  generation:  0.4124782085418701
local_output_nid generation:  0.031667232513427734
local_in_edges_tensor generation:  0.03323936462402344
mini_batch_src_global generation:  0.04804491996765137
r_  generation:  0.42278504371643066
local_output_nid generation:  0.028185606002807617
local_in_edges_tensor generation:  0.026579856872558594
mini_batch_src_global generation:  0.04942440986633301
r_  generation:  0.41208410263061523
local_output_nid generation:  0.028024911880493164
local_in_edges_tensor generation:  0.025655031204223633
mini_batch_src_global generation:  0.047345876693725586
r_  generation:  0.42926907539367676
local_output_nid generation:  0.028311491012573242
local_in_edges_tensor generation:  0.029836654663085938
mini_batch_src_global generation:  0.048145294189453125
r_  generation:  0.4068186283111572
local_output_nid generation:  0.02824115753173828
local_in_edges_tensor generation:  0.029400348663330078
mini_batch_src_global generation:  0.04733109474182129
r_  generation:  0.41885900497436523
local_output_nid generation:  0.0282437801361084
local_in_edges_tensor generation:  0.027797460556030273
mini_batch_src_global generation:  0.0501558780670166
r_  generation:  0.41449952125549316
local_output_nid generation:  0.028205394744873047
local_in_edges_tensor generation:  0.027156352996826172
mini_batch_src_global generation:  0.04995465278625488
r_  generation:  0.4204103946685791
local_output_nid generation:  0.028004169464111328
local_in_edges_tensor generation:  0.02982163429260254
mini_batch_src_global generation:  0.04957103729248047
r_  generation:  0.4100620746612549
local_output_nid generation:  0.02805352210998535
local_in_edges_tensor generation:  0.02567911148071289
mini_batch_src_global generation:  0.04733133316040039
r_  generation:  0.4187023639678955
local_output_nid generation:  0.0278170108795166
local_in_edges_tensor generation:  0.025696754455566406
mini_batch_src_global generation:  0.04909491539001465
r_  generation:  0.413038969039917
local_output_nid generation:  0.0279996395111084
local_in_edges_tensor generation:  0.0270693302154541
mini_batch_src_global generation:  0.04782533645629883
r_  generation:  0.4203004837036133
local_output_nid generation:  0.027936458587646484
local_in_edges_tensor generation:  0.027587175369262695
mini_batch_src_global generation:  0.05097508430480957
r_  generation:  0.40981316566467285
local_output_nid generation:  0.027530670166015625
local_in_edges_tensor generation:  0.02625584602355957
mini_batch_src_global generation:  0.0475921630859375
r_  generation:  0.4198641777038574
local_output_nid generation:  0.028500080108642578
local_in_edges_tensor generation:  0.027911901473999023
mini_batch_src_global generation:  0.05286002159118652
r_  generation:  0.41628074645996094
local_output_nid generation:  0.028311967849731445
local_in_edges_tensor generation:  0.02988457679748535
mini_batch_src_global generation:  0.048465728759765625
r_  generation:  0.4250457286834717
local_output_nid generation:  0.02796769142150879
local_in_edges_tensor generation:  0.025356531143188477
mini_batch_src_global generation:  0.04941248893737793
r_  generation:  0.41391658782958984
local_output_nid generation:  0.0289154052734375
local_in_edges_tensor generation:  0.025459766387939453
mini_batch_src_global generation:  0.04680013656616211
r_  generation:  0.41729068756103516
local_output_nid generation:  0.028102636337280273
local_in_edges_tensor generation:  0.025924205780029297
mini_batch_src_global generation:  0.04914593696594238
r_  generation:  0.41022205352783203
----------------------check_connections_block total spend ----------------------------- 19.585506677627563
generate_one_block  0.566519021987915
generate_one_block  0.5575408935546875
generate_one_block  0.5502071380615234
generate_one_block  0.5525810718536377
generate_one_block  0.625316858291626
generate_one_block  0.5542194843292236
generate_one_block  0.5507020950317383
generate_one_block  0.5476574897766113
generate_one_block  0.5535311698913574
generate_one_block  0.5496909618377686
generate_one_block  0.5554931163787842
generate_one_block  0.5543594360351562
generate_one_block  0.546626091003418
generate_one_block  0.5522768497467041
generate_one_block  0.559495210647583
generate_one_block  0.5544209480285645
generate_one_block  0.5529453754425049
generate_one_block  0.554581880569458
generate_one_block  0.5575666427612305
generate_one_block  0.5603852272033691
generate_one_block  0.5637335777282715
generate_one_block  0.5450103282928467
generate_one_block  0.5486016273498535
generate_one_block  0.5575640201568604
generate_one_block  0.5638976097106934
generate_one_block  0.5523686408996582
generate_one_block  0.5519678592681885
generate_one_block  0.5658736228942871
generate_one_block  0.5558478832244873
generate_one_block  0.5481610298156738
generate_one_block  0.5429024696350098
generate_one_block  0.5537779331207275
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12368440628051758  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  26.860352754592896
block generation total time  24.306699752807617
average batch blocks generation time:  0.759584367275238
block dataloader generation time/epoch 54.704065442085266
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10532093048095703  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.28510093688965  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10449695587158203  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.827340126037598  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521411895751953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.795032501220703  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10462379455566406  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.008229732513428  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10517358779907227  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.5177264213562  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10458230972290039  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.97487449645996  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521793365478516  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.721651077270508  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10457563400268555  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.723684310913086  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528755187988281  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.07505464553833  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10481119155883789  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.864880561828613  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10533761978149414  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.346059322357178  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10478878021240234  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.204657077789307  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521173477172852  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.755133152008057  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10464143753051758  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.979090213775635  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526847839355469  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.075621128082275  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10441780090332031  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.006943702697754  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10525369644165039  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.983097553253174  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10469341278076172  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.342581272125244  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521268844604492  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.762010097503662  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10502243041992188  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.27426767349243  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10533761978149414  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.276063919067383  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10454988479614258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.524639129638672  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10519027709960938  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.675928592681885  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10469198226928711  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.935229778289795  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10520315170288086  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.741154670715332  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1043238639831543  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.926011562347412  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10525131225585938  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.842984676361084  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10500431060791016  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.39323377609253  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528326034545898  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.155102729797363  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10457944869995117  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.614334106445312  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.105194091796875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.64488697052002  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10440206527709961  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.69488525390625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03401549905538559 |0.013398200273513794 |0.4178014025092125 |9.357184171676636e-05 |0.753701277077198 |0.005973339080810547 |
----------------------------------------------------------pseudo_mini_loss sum 1.4273126125335693
Total (block generation + training)time/epoch 93.88728532195091
Training time/epoch 39.06375503540039
Training time without block to device /epoch 38.63501262664795
Training time without total dataloading part /epoch 37.497053384780884
load block tensor time/epoch 1.0884959697723389
block to device time/epoch 0.4287424087524414
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  8791459
Number of first layer input nodes during this epoch:  4680166
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12234783172607422  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025724172592163086
random selection method range initialization spend 0.005238056182861328
time for parepare:  0.018074989318847656
local_output_nid generation:  0.0015554428100585938
local_in_edges_tensor generation:  0.006437540054321289
mini_batch_src_global generation:  0.0015840530395507812
r_  generation:  0.010638236999511719
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0010743141174316406
mini_batch_src_global generation:  0.0015349388122558594
r_  generation:  0.010215520858764648
local_output_nid generation:  0.0016374588012695312
local_in_edges_tensor generation:  0.0009436607360839844
mini_batch_src_global generation:  0.0011980533599853516
r_  generation:  0.009743452072143555
local_output_nid generation:  0.0016169548034667969
local_in_edges_tensor generation:  0.0009276866912841797
mini_batch_src_global generation:  0.0011684894561767578
r_  generation:  0.009993314743041992
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.0011212825775146484
r_  generation:  0.009922504425048828
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.001132965087890625
r_  generation:  0.010139226913452148
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.0011439323425292969
r_  generation:  0.010153770446777344
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0008864402770996094
mini_batch_src_global generation:  0.0010805130004882812
r_  generation:  0.009922266006469727
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008692741394042969
mini_batch_src_global generation:  0.0010533332824707031
r_  generation:  0.012029170989990234
local_output_nid generation:  0.0016455650329589844
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0012192726135253906
r_  generation:  0.010590791702270508
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0009760856628417969
mini_batch_src_global generation:  0.0011963844299316406
r_  generation:  0.01048588752746582
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.0011844635009765625
r_  generation:  0.010352611541748047
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.00113677978515625
r_  generation:  0.01006007194519043
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0008826255798339844
mini_batch_src_global generation:  0.0011317729949951172
r_  generation:  0.010143518447875977
local_output_nid generation:  0.0015778541564941406
local_in_edges_tensor generation:  0.0008873939514160156
mini_batch_src_global generation:  0.0011515617370605469
r_  generation:  0.010432243347167969
local_output_nid generation:  0.0015861988067626953
local_in_edges_tensor generation:  0.0008718967437744141
mini_batch_src_global generation:  0.0011026859283447266
r_  generation:  0.010139703750610352
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0008535385131835938
mini_batch_src_global generation:  0.0011067390441894531
r_  generation:  0.01007390022277832
local_output_nid generation:  0.0015444755554199219
local_in_edges_tensor generation:  0.0008599758148193359
mini_batch_src_global generation:  0.0010755062103271484
r_  generation:  0.009776592254638672
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0009410381317138672
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.010596513748168945
local_output_nid generation:  0.0015892982482910156
local_in_edges_tensor generation:  0.0008695125579833984
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.010186910629272461
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0008742809295654297
mini_batch_src_global generation:  0.0011150836944580078
r_  generation:  0.010118961334228516
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0008761882781982422
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.00996088981628418
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0008492469787597656
mini_batch_src_global generation:  0.0010669231414794922
r_  generation:  0.010021448135375977
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.001138925552368164
r_  generation:  0.01045370101928711
local_output_nid generation:  0.0015635490417480469
local_in_edges_tensor generation:  0.0008656978607177734
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.010179519653320312
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0008594989776611328
mini_batch_src_global generation:  0.0011725425720214844
r_  generation:  0.010102033615112305
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0009212493896484375
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.010589122772216797
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0008692741394042969
mini_batch_src_global generation:  0.0011794567108154297
r_  generation:  0.010441780090332031
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0008392333984375
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.010216474533081055
local_output_nid generation:  0.001580953598022461
local_in_edges_tensor generation:  0.0008437633514404297
mini_batch_src_global generation:  0.0010819435119628906
r_  generation:  0.009661197662353516
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0008676052093505859
mini_batch_src_global generation:  0.0010950565338134766
r_  generation:  0.010355710983276367
local_output_nid generation:  0.0015554428100585938
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0012099742889404297
r_  generation:  0.010787010192871094
----------------------check_connections_block total spend ----------------------------- 0.5633866786956787
generate_one_block  0.019424915313720703
generate_one_block  0.020274877548217773
generate_one_block  0.017735958099365234
generate_one_block  0.017752885818481445
generate_one_block  0.0173184871673584
generate_one_block  0.017554283142089844
generate_one_block  0.017238855361938477
generate_one_block  0.017066240310668945
generate_one_block  0.01864767074584961
generate_one_block  0.018800973892211914
generate_one_block  0.018093585968017578
generate_one_block  0.01763010025024414
generate_one_block  0.01701951026916504
generate_one_block  0.017174243927001953
generate_one_block  0.01748180389404297
generate_one_block  0.017019987106323242
generate_one_block  0.017009258270263672
generate_one_block  0.01645207405090332
generate_one_block  0.018029212951660156
generate_one_block  0.0173037052154541
generate_one_block  0.017058372497558594
generate_one_block  0.01687169075012207
generate_one_block  0.020109176635742188
generate_one_block  0.018169641494750977
generate_one_block  0.017278671264648438
generate_one_block  0.017106056213378906
generate_one_block  0.017386436462402344
generate_one_block  0.017488718032836914
generate_one_block  0.017383575439453125
generate_one_block  0.01651453971862793
generate_one_block  0.017772197723388672
generate_one_block  0.01839756965637207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03393197059631348
gen group dst list time:  0.02004551887512207
time for parepare:  0.019492626190185547
local_output_nid generation:  0.006350040435791016
local_in_edges_tensor generation:  0.01812291145324707
mini_batch_src_global generation:  0.01412057876586914
r_  generation:  0.13707971572875977
local_output_nid generation:  0.009183168411254883
local_in_edges_tensor generation:  0.011129379272460938
mini_batch_src_global generation:  0.017368555068969727
r_  generation:  0.14309263229370117
local_output_nid generation:  0.00928187370300293
local_in_edges_tensor generation:  0.032134294509887695
mini_batch_src_global generation:  0.016427040100097656
r_  generation:  0.14464449882507324
local_output_nid generation:  0.00958108901977539
local_in_edges_tensor generation:  0.009410858154296875
mini_batch_src_global generation:  0.017631053924560547
r_  generation:  0.1485588550567627
local_output_nid generation:  0.009405851364135742
local_in_edges_tensor generation:  0.009096860885620117
mini_batch_src_global generation:  0.018172502517700195
r_  generation:  0.14939498901367188
local_output_nid generation:  0.00910186767578125
local_in_edges_tensor generation:  0.010867118835449219
mini_batch_src_global generation:  0.01947021484375
r_  generation:  0.15336251258850098
local_output_nid generation:  0.008889198303222656
local_in_edges_tensor generation:  0.008700847625732422
mini_batch_src_global generation:  0.01908588409423828
r_  generation:  0.1513195037841797
local_output_nid generation:  0.008859395980834961
local_in_edges_tensor generation:  0.009181499481201172
mini_batch_src_global generation:  0.018344402313232422
r_  generation:  0.14975881576538086
local_output_nid generation:  0.009330511093139648
local_in_edges_tensor generation:  0.01133275032043457
mini_batch_src_global generation:  0.02111196517944336
r_  generation:  0.1609041690826416
local_output_nid generation:  0.009109735488891602
local_in_edges_tensor generation:  0.008453845977783203
mini_batch_src_global generation:  0.01917409896850586
r_  generation:  0.15518951416015625
local_output_nid generation:  0.009601593017578125
local_in_edges_tensor generation:  0.011071205139160156
mini_batch_src_global generation:  0.02058267593383789
r_  generation:  0.1585848331451416
local_output_nid generation:  0.010345220565795898
local_in_edges_tensor generation:  0.008620262145996094
mini_batch_src_global generation:  0.01931929588317871
r_  generation:  0.15509390830993652
local_output_nid generation:  0.009326696395874023
local_in_edges_tensor generation:  0.010864496231079102
mini_batch_src_global generation:  0.019191741943359375
r_  generation:  0.14965510368347168
local_output_nid generation:  0.009367704391479492
local_in_edges_tensor generation:  0.008563518524169922
mini_batch_src_global generation:  0.018805503845214844
r_  generation:  0.15283823013305664
local_output_nid generation:  0.009641647338867188
local_in_edges_tensor generation:  0.008571863174438477
mini_batch_src_global generation:  0.019819259643554688
r_  generation:  0.15608549118041992
local_output_nid generation:  0.009359359741210938
local_in_edges_tensor generation:  0.008510589599609375
mini_batch_src_global generation:  0.01916813850402832
r_  generation:  0.15243101119995117
local_output_nid generation:  0.00934147834777832
local_in_edges_tensor generation:  0.00848841667175293
mini_batch_src_global generation:  0.018978118896484375
r_  generation:  0.15212082862854004
local_output_nid generation:  0.009083747863769531
local_in_edges_tensor generation:  0.010230064392089844
mini_batch_src_global generation:  0.018988370895385742
r_  generation:  0.14612412452697754
local_output_nid generation:  0.009669780731201172
local_in_edges_tensor generation:  0.008477449417114258
mini_batch_src_global generation:  0.019361495971679688
r_  generation:  0.16021442413330078
local_output_nid generation:  0.009292840957641602
local_in_edges_tensor generation:  0.008373260498046875
mini_batch_src_global generation:  0.019039392471313477
r_  generation:  0.15255284309387207
local_output_nid generation:  0.009347677230834961
local_in_edges_tensor generation:  0.009345293045043945
mini_batch_src_global generation:  0.01950526237487793
r_  generation:  0.1520371437072754
local_output_nid generation:  0.00925135612487793
local_in_edges_tensor generation:  0.00844430923461914
mini_batch_src_global generation:  0.01840043067932129
r_  generation:  0.15182733535766602
local_output_nid generation:  0.009177446365356445
local_in_edges_tensor generation:  0.008271455764770508
mini_batch_src_global generation:  0.018614768981933594
r_  generation:  0.15063118934631348
local_output_nid generation:  0.009462118148803711
local_in_edges_tensor generation:  0.008691549301147461
mini_batch_src_global generation:  0.019318580627441406
r_  generation:  0.15478181838989258
local_output_nid generation:  0.009329080581665039
local_in_edges_tensor generation:  0.008318185806274414
mini_batch_src_global generation:  0.018796443939208984
r_  generation:  0.15291166305541992
local_output_nid generation:  0.009311199188232422
local_in_edges_tensor generation:  0.00814366340637207
mini_batch_src_global generation:  0.019536256790161133
r_  generation:  0.15150856971740723
local_output_nid generation:  0.009390830993652344
local_in_edges_tensor generation:  0.010170459747314453
mini_batch_src_global generation:  0.01894378662109375
r_  generation:  0.15889191627502441
local_output_nid generation:  0.009433507919311523
local_in_edges_tensor generation:  0.008578300476074219
mini_batch_src_global generation:  0.01903986930847168
r_  generation:  0.15798735618591309
local_output_nid generation:  0.009524106979370117
local_in_edges_tensor generation:  0.009705066680908203
mini_batch_src_global generation:  0.018825531005859375
r_  generation:  0.15808677673339844
local_output_nid generation:  0.009165048599243164
local_in_edges_tensor generation:  0.008157730102539062
mini_batch_src_global generation:  0.01895451545715332
r_  generation:  0.14792990684509277
local_output_nid generation:  0.009527206420898438
local_in_edges_tensor generation:  0.008704185485839844
mini_batch_src_global generation:  0.01928997039794922
r_  generation:  0.16060614585876465
local_output_nid generation:  0.00993657112121582
local_in_edges_tensor generation:  0.008855342864990234
mini_batch_src_global generation:  0.02073383331298828
r_  generation:  0.16386771202087402
----------------------check_connections_block total spend ----------------------------- 7.276186466217041
generate_one_block  0.20191574096679688
generate_one_block  0.1996898651123047
generate_one_block  0.20270681381225586
generate_one_block  0.20555734634399414
generate_one_block  0.2173917293548584
generate_one_block  0.20988750457763672
generate_one_block  0.20064210891723633
generate_one_block  0.1999058723449707
generate_one_block  0.21622586250305176
generate_one_block  0.20267415046691895
generate_one_block  0.20740532875061035
generate_one_block  0.21238946914672852
generate_one_block  0.1991746425628662
generate_one_block  0.20326638221740723
generate_one_block  0.21003103256225586
generate_one_block  0.2028641700744629
generate_one_block  0.20343494415283203
generate_one_block  0.19380640983581543
generate_one_block  0.20746803283691406
generate_one_block  0.20781683921813965
generate_one_block  0.20638060569763184
generate_one_block  0.20082712173461914
generate_one_block  0.19961977005004883
generate_one_block  0.2084336280822754
generate_one_block  0.20072650909423828
generate_one_block  0.20138907432556152
generate_one_block  0.20994877815246582
generate_one_block  0.20547914505004883
generate_one_block  0.2103896141052246
generate_one_block  0.1939220428466797
generate_one_block  0.20964550971984863
generate_one_block  0.21670794486999512
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029566049575805664
gen group dst list time:  0.10041189193725586
time for parepare:  0.020238637924194336
local_output_nid generation:  0.02494502067565918
local_in_edges_tensor generation:  0.03865671157836914
mini_batch_src_global generation:  0.037352561950683594
r_  generation:  0.40503764152526855
local_output_nid generation:  0.029757976531982422
local_in_edges_tensor generation:  0.033675193786621094
mini_batch_src_global generation:  0.04795718193054199
r_  generation:  0.40537548065185547
local_output_nid generation:  0.02977132797241211
local_in_edges_tensor generation:  0.030199527740478516
mini_batch_src_global generation:  0.04791426658630371
r_  generation:  0.4164576530456543
local_output_nid generation:  0.029789209365844727
local_in_edges_tensor generation:  0.027411937713623047
mini_batch_src_global generation:  0.04814958572387695
r_  generation:  0.4068310260772705
local_output_nid generation:  0.029933452606201172
local_in_edges_tensor generation:  0.027562856674194336
mini_batch_src_global generation:  0.04677700996398926
r_  generation:  0.421703577041626
local_output_nid generation:  0.02989649772644043
local_in_edges_tensor generation:  0.029385805130004883
mini_batch_src_global generation:  0.04891180992126465
r_  generation:  0.41498589515686035
local_output_nid generation:  0.0279848575592041
local_in_edges_tensor generation:  0.029333114624023438
mini_batch_src_global generation:  0.04713916778564453
r_  generation:  0.42000627517700195
local_output_nid generation:  0.02803659439086914
local_in_edges_tensor generation:  0.027329206466674805
mini_batch_src_global generation:  0.04890942573547363
r_  generation:  0.41113972663879395
local_output_nid generation:  0.028445720672607422
local_in_edges_tensor generation:  0.03162264823913574
mini_batch_src_global generation:  0.0497736930847168
r_  generation:  0.42638373374938965
local_output_nid generation:  0.028021574020385742
local_in_edges_tensor generation:  0.025542736053466797
mini_batch_src_global generation:  0.04908871650695801
r_  generation:  0.4089846611022949
local_output_nid generation:  0.028049945831298828
local_in_edges_tensor generation:  0.029085874557495117
mini_batch_src_global generation:  0.04654335975646973
r_  generation:  0.4218471050262451
local_output_nid generation:  0.02814173698425293
local_in_edges_tensor generation:  0.02719855308532715
mini_batch_src_global generation:  0.050141334533691406
r_  generation:  0.41620707511901855
local_output_nid generation:  0.027834415435791016
local_in_edges_tensor generation:  0.028142452239990234
mini_batch_src_global generation:  0.04719185829162598
r_  generation:  0.415355920791626
local_output_nid generation:  0.027834415435791016
local_in_edges_tensor generation:  0.025717973709106445
mini_batch_src_global generation:  0.049184322357177734
r_  generation:  0.4142639636993408
local_output_nid generation:  0.02839970588684082
local_in_edges_tensor generation:  0.028436660766601562
mini_batch_src_global generation:  0.04892110824584961
r_  generation:  0.42205286026000977
local_output_nid generation:  0.027757644653320312
local_in_edges_tensor generation:  0.026619434356689453
mini_batch_src_global generation:  0.048566341400146484
r_  generation:  0.4071376323699951
local_output_nid generation:  0.027823448181152344
local_in_edges_tensor generation:  0.0254061222076416
mini_batch_src_global generation:  0.04685664176940918
r_  generation:  0.4297018051147461
local_output_nid generation:  0.027799606323242188
local_in_edges_tensor generation:  0.025673389434814453
mini_batch_src_global generation:  0.04893326759338379
r_  generation:  0.4040029048919678
local_output_nid generation:  0.028370141983032227
local_in_edges_tensor generation:  0.025527238845825195
mini_batch_src_global generation:  0.04864811897277832
r_  generation:  0.41878795623779297
local_output_nid generation:  0.027731895446777344
local_in_edges_tensor generation:  0.02806401252746582
mini_batch_src_global generation:  0.048427581787109375
r_  generation:  0.4174306392669678
local_output_nid generation:  0.029829740524291992
local_in_edges_tensor generation:  0.027002811431884766
mini_batch_src_global generation:  0.04740285873413086
r_  generation:  0.4161827564239502
local_output_nid generation:  0.02866530418395996
local_in_edges_tensor generation:  0.026932716369628906
mini_batch_src_global generation:  0.04914045333862305
r_  generation:  0.40906548500061035
local_output_nid generation:  0.028312206268310547
local_in_edges_tensor generation:  0.029314517974853516
mini_batch_src_global generation:  0.04667305946350098
r_  generation:  0.41556215286254883
local_output_nid generation:  0.029535293579101562
local_in_edges_tensor generation:  0.025818586349487305
mini_batch_src_global generation:  0.05092954635620117
r_  generation:  0.4211869239807129
local_output_nid generation:  0.02873682975769043
local_in_edges_tensor generation:  0.029083251953125
mini_batch_src_global generation:  0.04723954200744629
r_  generation:  0.42246079444885254
local_output_nid generation:  0.02854013442993164
local_in_edges_tensor generation:  0.02737736701965332
mini_batch_src_global generation:  0.049024343490600586
r_  generation:  0.4131288528442383
local_output_nid generation:  0.02851557731628418
local_in_edges_tensor generation:  0.025608062744140625
mini_batch_src_global generation:  0.048478126525878906
r_  generation:  0.4176766872406006
local_output_nid generation:  0.02832818031311035
local_in_edges_tensor generation:  0.031134366989135742
mini_batch_src_global generation:  0.0491642951965332
r_  generation:  0.40817880630493164
local_output_nid generation:  0.02871561050415039
local_in_edges_tensor generation:  0.02551436424255371
mini_batch_src_global generation:  0.04697751998901367
r_  generation:  0.4210851192474365
local_output_nid generation:  0.028529644012451172
local_in_edges_tensor generation:  0.027360200881958008
mini_batch_src_global generation:  0.04883098602294922
r_  generation:  0.4122946262359619
local_output_nid generation:  0.028615951538085938
local_in_edges_tensor generation:  0.029513835906982422
mini_batch_src_global generation:  0.04701423645019531
r_  generation:  0.4272148609161377
local_output_nid generation:  0.029326438903808594
local_in_edges_tensor generation:  0.03127145767211914
mini_batch_src_global generation:  0.04937100410461426
r_  generation:  0.4202697277069092
----------------------check_connections_block total spend ----------------------------- 19.60223388671875
generate_one_block  0.554919958114624
generate_one_block  0.55279541015625
generate_one_block  0.553272008895874
generate_one_block  0.5475327968597412
generate_one_block  0.6429016590118408
generate_one_block  0.5761051177978516
generate_one_block  0.5521266460418701
generate_one_block  0.5497407913208008
generate_one_block  0.5658848285675049
generate_one_block  0.5457415580749512
generate_one_block  0.5473105907440186
generate_one_block  0.553797721862793
generate_one_block  0.543548583984375
generate_one_block  0.550602912902832
generate_one_block  0.5603153705596924
generate_one_block  0.5420329570770264
generate_one_block  0.5517833232879639
generate_one_block  0.5370359420776367
generate_one_block  0.5522315502166748
generate_one_block  0.5453000068664551
generate_one_block  0.5483465194702148
generate_one_block  0.5464794635772705
generate_one_block  0.5447185039520264
generate_one_block  0.5548522472381592
generate_one_block  0.5745174884796143
generate_one_block  0.543729305267334
generate_one_block  0.5531401634216309
generate_one_block  0.5502607822418213
generate_one_block  0.5557308197021484
generate_one_block  0.545961856842041
generate_one_block  0.5700345039367676
generate_one_block  0.5699667930603027
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12234783172607422  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  26.87842035293579
block generation total time  24.3504421710968
average batch blocks generation time:  0.760951317846775
block dataloader generation time/epoch 54.63914998372396
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524463653564453  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.984121322631836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1048436164855957  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.88489055633545  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10522031784057617  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.80229139328003  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10485267639160156  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.070396423339844  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052403450012207  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.939724445343018  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10491943359375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.219339847564697  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523176193237305  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.85863971710205  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1047525405883789  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.818037509918213  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10538768768310547  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.551240921020508  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10434341430664062  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.94253396987915  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10529899597167969  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.156915187835693  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10462427139282227  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.092494010925293  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1051936149597168  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.649093627929688  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10461235046386719  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.828556060791016  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528755187988281  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.170576572418213  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10436439514160156  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.87353277206421  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523080825805664  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.84531021118164  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1044321060180664  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.33039951324463  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528993606567383  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.169352531433105  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10426950454711914  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.779775619506836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052098274230957  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.72984266281128  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10453414916992188  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.799217700958252  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10518932342529297  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.58179473876953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1047968864440918  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.09622812271118  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521316528320312  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.838611125946045  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10460567474365234  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.729780673980713  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528135299682617  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.091881275177002  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10448408126831055  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.913262367248535  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052713394165039  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.03782033920288  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10451650619506836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.379035472869873  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1053018569946289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.261666297912598  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10509729385375977  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.476454734802246  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03402305394411087 |0.012750178575515747 |0.41733089834451675 |9.279698133468628e-05 |0.7555007338523865 |0.006415367126464844 |
----------------------------------------------------------pseudo_mini_loss sum 1.4033608436584473
Total (block generation + training)time/epoch 93.81156992912292
Training time/epoch 39.085760831832886
Training time without block to device /epoch 38.67775511741638
Training time without total dataloading part /epoch 37.53999710083008
load block tensor time/epoch 1.0887377262115479
block to device time/epoch 0.4080057144165039
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  8797788
Number of first layer input nodes during this epoch:  4682253
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12375307083129883  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02393507957458496
random selection method range initialization spend 0.0052869319915771484
time for parepare:  0.018190383911132812
local_output_nid generation:  0.0014569759368896484
local_in_edges_tensor generation:  0.00588226318359375
mini_batch_src_global generation:  0.0016634464263916016
r_  generation:  0.011356115341186523
local_output_nid generation:  0.0017025470733642578
local_in_edges_tensor generation:  0.0010976791381835938
mini_batch_src_global generation:  0.0015897750854492188
r_  generation:  0.010629653930664062
local_output_nid generation:  0.0016543865203857422
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0012106895446777344
r_  generation:  0.009947776794433594
local_output_nid generation:  0.0016291141510009766
local_in_edges_tensor generation:  0.0008969306945800781
mini_batch_src_global generation:  0.0011630058288574219
r_  generation:  0.009759664535522461
local_output_nid generation:  0.0016117095947265625
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0011420249938964844
r_  generation:  0.009745359420776367
local_output_nid generation:  0.001613616943359375
local_in_edges_tensor generation:  0.0009291172027587891
mini_batch_src_global generation:  0.0011630058288574219
r_  generation:  0.010107755661010742
local_output_nid generation:  0.0015840530395507812
local_in_edges_tensor generation:  0.0008757114410400391
mini_batch_src_global generation:  0.001161336898803711
r_  generation:  0.009970664978027344
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0008795261383056641
mini_batch_src_global generation:  0.001157999038696289
r_  generation:  0.010161876678466797
local_output_nid generation:  0.0015673637390136719
local_in_edges_tensor generation:  0.0008718967437744141
mini_batch_src_global generation:  0.0011661052703857422
r_  generation:  0.010222196578979492
local_output_nid generation:  0.001627206802368164
local_in_edges_tensor generation:  0.0008394718170166016
mini_batch_src_global generation:  0.0011146068572998047
r_  generation:  0.011924505233764648
local_output_nid generation:  0.0016498565673828125
local_in_edges_tensor generation:  0.0009174346923828125
mini_batch_src_global generation:  0.0012450218200683594
r_  generation:  0.01078033447265625
local_output_nid generation:  0.0016396045684814453
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.0011584758758544922
r_  generation:  0.009975910186767578
local_output_nid generation:  0.0015978813171386719
local_in_edges_tensor generation:  0.000865936279296875
mini_batch_src_global generation:  0.0011584758758544922
r_  generation:  0.01036381721496582
local_output_nid generation:  0.0016100406646728516
local_in_edges_tensor generation:  0.0009102821350097656
mini_batch_src_global generation:  0.0011782646179199219
r_  generation:  0.010260343551635742
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.010195493698120117
local_output_nid generation:  0.0015802383422851562
local_in_edges_tensor generation:  0.0008606910705566406
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.010437965393066406
local_output_nid generation:  0.0015590190887451172
local_in_edges_tensor generation:  0.0008575916290283203
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.010247230529785156
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0008747577667236328
mini_batch_src_global generation:  0.0011408329010009766
r_  generation:  0.009968996047973633
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0008568763732910156
mini_batch_src_global generation:  0.0011227130889892578
r_  generation:  0.009821414947509766
local_output_nid generation:  0.0015518665313720703
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.01049184799194336
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.0009326934814453125
mini_batch_src_global generation:  0.0012097358703613281
r_  generation:  0.010689020156860352
local_output_nid generation:  0.0016036033630371094
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0011882781982421875
r_  generation:  0.010195732116699219
local_output_nid generation:  0.0015673637390136719
local_in_edges_tensor generation:  0.0008757114410400391
mini_batch_src_global generation:  0.0011715888977050781
r_  generation:  0.010139942169189453
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.0008623600006103516
mini_batch_src_global generation:  0.0011870861053466797
r_  generation:  0.009594440460205078
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.010231494903564453
local_output_nid generation:  0.0015711784362792969
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.010319232940673828
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.001203298568725586
r_  generation:  0.010068416595458984
local_output_nid generation:  0.0015659332275390625
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0012216567993164062
r_  generation:  0.010470151901245117
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.001172780990600586
r_  generation:  0.010329723358154297
local_output_nid generation:  0.0015630722045898438
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0012443065643310547
r_  generation:  0.010063648223876953
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0008778572082519531
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.010452747344970703
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0008809566497802734
mini_batch_src_global generation:  0.001169443130493164
r_  generation:  0.010503053665161133
----------------------check_connections_block total spend ----------------------------- 0.5642578601837158
generate_one_block  0.020648479461669922
generate_one_block  0.02044224739074707
generate_one_block  0.01814556121826172
generate_one_block  0.0173189640045166
generate_one_block  0.017106294631958008
generate_one_block  0.017507076263427734
generate_one_block  0.016836166381835938
generate_one_block  0.01742839813232422
generate_one_block  0.017267227172851562
generate_one_block  0.018436193466186523
generate_one_block  0.018691301345825195
generate_one_block  0.017514467239379883
generate_one_block  0.01735663414001465
generate_one_block  0.017136812210083008
generate_one_block  0.017078399658203125
generate_one_block  0.017318010330200195
generate_one_block  0.01711130142211914
generate_one_block  0.016754865646362305
generate_one_block  0.01638031005859375
generate_one_block  0.017559528350830078
generate_one_block  0.01779317855834961
generate_one_block  0.017066240310668945
generate_one_block  0.02029132843017578
generate_one_block  0.01654815673828125
generate_one_block  0.017352581024169922
generate_one_block  0.017596960067749023
generate_one_block  0.017038822174072266
generate_one_block  0.01747274398803711
generate_one_block  0.01730036735534668
generate_one_block  0.017037391662597656
generate_one_block  0.017671823501586914
generate_one_block  0.01757979393005371
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03528189659118652
gen group dst list time:  0.020490646362304688
time for parepare:  0.019899606704711914
local_output_nid generation:  0.006716251373291016
local_in_edges_tensor generation:  0.017547607421875
mini_batch_src_global generation:  0.014626264572143555
r_  generation:  0.14529848098754883
local_output_nid generation:  0.009228229522705078
local_in_edges_tensor generation:  0.010265827178955078
mini_batch_src_global generation:  0.018393278121948242
r_  generation:  0.1851484775543213
local_output_nid generation:  0.009371519088745117
local_in_edges_tensor generation:  0.10619521141052246
mini_batch_src_global generation:  0.020649433135986328
r_  generation:  0.15461254119873047
local_output_nid generation:  0.00927877426147461
local_in_edges_tensor generation:  0.010649681091308594
mini_batch_src_global generation:  0.017633676528930664
r_  generation:  0.15088343620300293
local_output_nid generation:  0.009115457534790039
local_in_edges_tensor generation:  0.010277748107910156
mini_batch_src_global generation:  0.017901182174682617
r_  generation:  0.15970110893249512
local_output_nid generation:  0.011430025100708008
local_in_edges_tensor generation:  0.008324146270751953
mini_batch_src_global generation:  0.01943373680114746
r_  generation:  0.15766239166259766
local_output_nid generation:  0.008912324905395508
local_in_edges_tensor generation:  0.010257482528686523
mini_batch_src_global generation:  0.018042802810668945
r_  generation:  0.17806649208068848
local_output_nid generation:  0.012066125869750977
local_in_edges_tensor generation:  0.009195804595947266
mini_batch_src_global generation:  0.02252793312072754
r_  generation:  0.15450048446655273
local_output_nid generation:  0.009058713912963867
local_in_edges_tensor generation:  0.009097099304199219
mini_batch_src_global generation:  0.01973724365234375
r_  generation:  0.1521625518798828
local_output_nid generation:  0.009719133377075195
local_in_edges_tensor generation:  0.009140491485595703
mini_batch_src_global generation:  0.020595312118530273
r_  generation:  0.16128826141357422
local_output_nid generation:  0.009337186813354492
local_in_edges_tensor generation:  0.008505821228027344
mini_batch_src_global generation:  0.01941680908203125
r_  generation:  0.1531524658203125
local_output_nid generation:  0.009238481521606445
local_in_edges_tensor generation:  0.008085489273071289
mini_batch_src_global generation:  0.018510818481445312
r_  generation:  0.14860939979553223
local_output_nid generation:  0.0096282958984375
local_in_edges_tensor generation:  0.008449792861938477
mini_batch_src_global generation:  0.018964052200317383
r_  generation:  0.15396428108215332
local_output_nid generation:  0.009536266326904297
local_in_edges_tensor generation:  0.009565114974975586
mini_batch_src_global generation:  0.022401809692382812
r_  generation:  0.15625619888305664
local_output_nid generation:  0.011770009994506836
local_in_edges_tensor generation:  0.008714914321899414
mini_batch_src_global generation:  0.021460533142089844
r_  generation:  0.15655970573425293
local_output_nid generation:  0.009516477584838867
local_in_edges_tensor generation:  0.009071826934814453
mini_batch_src_global generation:  0.01995372772216797
r_  generation:  0.15804433822631836
local_output_nid generation:  0.00947117805480957
local_in_edges_tensor generation:  0.008328437805175781
mini_batch_src_global generation:  0.01877307891845703
r_  generation:  0.15871977806091309
local_output_nid generation:  0.009233713150024414
local_in_edges_tensor generation:  0.008205413818359375
mini_batch_src_global generation:  0.018331527709960938
r_  generation:  0.15085458755493164
local_output_nid generation:  0.009256362915039062
local_in_edges_tensor generation:  0.008125782012939453
mini_batch_src_global generation:  0.017723798751831055
r_  generation:  0.1481492519378662
local_output_nid generation:  0.00968313217163086
local_in_edges_tensor generation:  0.008483409881591797
mini_batch_src_global generation:  0.019396066665649414
r_  generation:  0.1594526767730713
local_output_nid generation:  0.009703397750854492
local_in_edges_tensor generation:  0.01090097427368164
mini_batch_src_global generation:  0.019182205200195312
r_  generation:  0.15696287155151367
local_output_nid generation:  0.009574413299560547
local_in_edges_tensor generation:  0.008982419967651367
mini_batch_src_global generation:  0.019272804260253906
r_  generation:  0.15548419952392578
local_output_nid generation:  0.009450912475585938
local_in_edges_tensor generation:  0.008232355117797852
mini_batch_src_global generation:  0.01883244514465332
r_  generation:  0.15304279327392578
local_output_nid generation:  0.009114265441894531
local_in_edges_tensor generation:  0.009734392166137695
mini_batch_src_global generation:  0.017866134643554688
r_  generation:  0.14420437812805176
local_output_nid generation:  0.009488821029663086
local_in_edges_tensor generation:  0.008235692977905273
mini_batch_src_global generation:  0.018851518630981445
r_  generation:  0.15391135215759277
local_output_nid generation:  0.009591341018676758
local_in_edges_tensor generation:  0.008335351943969727
mini_batch_src_global generation:  0.019455432891845703
r_  generation:  0.1568889617919922
local_output_nid generation:  0.009389638900756836
local_in_edges_tensor generation:  0.008286237716674805
mini_batch_src_global generation:  0.01905035972595215
r_  generation:  0.15259218215942383
local_output_nid generation:  0.009505271911621094
local_in_edges_tensor generation:  0.008547067642211914
mini_batch_src_global generation:  0.01932072639465332
r_  generation:  0.15632414817810059
local_output_nid generation:  0.009576082229614258
local_in_edges_tensor generation:  0.008806943893432617
mini_batch_src_global generation:  0.019036054611206055
r_  generation:  0.15630197525024414
local_output_nid generation:  0.009402751922607422
local_in_edges_tensor generation:  0.014625787734985352
mini_batch_src_global generation:  0.01926398277282715
r_  generation:  0.15723419189453125
local_output_nid generation:  0.010853767395019531
local_in_edges_tensor generation:  0.012634515762329102
mini_batch_src_global generation:  0.019977569580078125
r_  generation:  0.15934967994689941
local_output_nid generation:  0.009833097457885742
local_in_edges_tensor generation:  0.00945901870727539
mini_batch_src_global generation:  0.01906752586364746
r_  generation:  0.1571049690246582
----------------------check_connections_block total spend ----------------------------- 7.493427276611328
generate_one_block  0.22449946403503418
generate_one_block  0.20232772827148438
generate_one_block  0.22235465049743652
generate_one_block  0.1990518569946289
generate_one_block  0.19971895217895508
generate_one_block  0.20879769325256348
generate_one_block  0.19203805923461914
generate_one_block  0.21190667152404785
generate_one_block  0.21001386642456055
generate_one_block  0.21857666969299316
generate_one_block  0.20651674270629883
generate_one_block  0.20084643363952637
generate_one_block  0.21306753158569336
generate_one_block  0.2068643569946289
generate_one_block  0.20159006118774414
generate_one_block  0.20582318305969238
generate_one_block  0.20320558547973633
generate_one_block  0.19568419456481934
generate_one_block  0.1929607391357422
generate_one_block  0.21008944511413574
generate_one_block  0.20789146423339844
generate_one_block  0.2052021026611328
generate_one_block  0.20249223709106445
generate_one_block  0.19295978546142578
generate_one_block  0.20387721061706543
generate_one_block  0.207200288772583
generate_one_block  0.19898581504821777
generate_one_block  0.20891094207763672
generate_one_block  0.20314502716064453
generate_one_block  0.2008671760559082
generate_one_block  0.20949769020080566
generate_one_block  0.20729637145996094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03828573226928711
gen group dst list time:  0.10482144355773926
time for parepare:  0.020010709762573242
local_output_nid generation:  0.025157928466796875
local_in_edges_tensor generation:  0.05995011329650879
mini_batch_src_global generation:  0.03802680969238281
r_  generation:  0.41331028938293457
local_output_nid generation:  0.029842376708984375
local_in_edges_tensor generation:  0.03504824638366699
mini_batch_src_global generation:  0.04964470863342285
r_  generation:  0.4102206230163574
local_output_nid generation:  0.029889583587646484
local_in_edges_tensor generation:  0.03245282173156738
mini_batch_src_global generation:  0.04834246635437012
r_  generation:  0.42082691192626953
local_output_nid generation:  0.030840158462524414
local_in_edges_tensor generation:  0.030161142349243164
mini_batch_src_global generation:  0.050341129302978516
r_  generation:  0.4150683879852295
local_output_nid generation:  0.029659271240234375
local_in_edges_tensor generation:  0.027666568756103516
mini_batch_src_global generation:  0.048189640045166016
r_  generation:  0.4204728603363037
local_output_nid generation:  0.02983403205871582
local_in_edges_tensor generation:  0.034607887268066406
mini_batch_src_global generation:  0.053052663803100586
r_  generation:  0.42244482040405273
local_output_nid generation:  0.02788519859313965
local_in_edges_tensor generation:  0.03074026107788086
mini_batch_src_global generation:  0.05193471908569336
r_  generation:  0.4135925769805908
local_output_nid generation:  0.02801227569580078
local_in_edges_tensor generation:  0.02682805061340332
mini_batch_src_global generation:  0.05101585388183594
r_  generation:  0.4115164279937744
local_output_nid generation:  0.028002023696899414
local_in_edges_tensor generation:  0.02753472328186035
mini_batch_src_global generation:  0.048105478286743164
r_  generation:  0.41735172271728516
local_output_nid generation:  0.02841925621032715
local_in_edges_tensor generation:  0.09423947334289551
mini_batch_src_global generation:  0.05140280723571777
r_  generation:  0.42937755584716797
local_output_nid generation:  0.030152082443237305
local_in_edges_tensor generation:  0.029726266860961914
mini_batch_src_global generation:  0.04830574989318848
r_  generation:  0.41660642623901367
local_output_nid generation:  0.028473854064941406
local_in_edges_tensor generation:  0.026007890701293945
mini_batch_src_global generation:  0.049134254455566406
r_  generation:  0.4101834297180176
local_output_nid generation:  0.028738021850585938
local_in_edges_tensor generation:  0.027765274047851562
mini_batch_src_global generation:  0.04938936233520508
r_  generation:  0.4181690216064453
local_output_nid generation:  0.028263330459594727
local_in_edges_tensor generation:  0.02560591697692871
mini_batch_src_global generation:  0.04890871047973633
r_  generation:  0.4113285541534424
local_output_nid generation:  0.02831745147705078
local_in_edges_tensor generation:  0.02612137794494629
mini_batch_src_global generation:  0.047121286392211914
r_  generation:  0.41613078117370605
local_output_nid generation:  0.02871847152709961
local_in_edges_tensor generation:  0.026816129684448242
mini_batch_src_global generation:  0.05003166198730469
r_  generation:  0.41289830207824707
local_output_nid generation:  0.02845454216003418
local_in_edges_tensor generation:  0.02608633041381836
mini_batch_src_global generation:  0.04748821258544922
r_  generation:  0.4162588119506836
local_output_nid generation:  0.028131484985351562
local_in_edges_tensor generation:  0.025943517684936523
mini_batch_src_global generation:  0.048641204833984375
r_  generation:  0.4082813262939453
local_output_nid generation:  0.028302431106567383
local_in_edges_tensor generation:  0.025545597076416016
mini_batch_src_global generation:  0.04672551155090332
r_  generation:  0.4159514904022217
local_output_nid generation:  0.028681278228759766
local_in_edges_tensor generation:  0.028876304626464844
mini_batch_src_global generation:  0.0709831714630127
r_  generation:  0.4154057502746582
local_output_nid generation:  0.02864861488342285
local_in_edges_tensor generation:  0.029381752014160156
mini_batch_src_global generation:  0.04914498329162598
r_  generation:  0.4237987995147705
local_output_nid generation:  0.02848029136657715
local_in_edges_tensor generation:  0.02673935890197754
mini_batch_src_global generation:  0.04930567741394043
r_  generation:  0.41370129585266113
local_output_nid generation:  0.028341054916381836
local_in_edges_tensor generation:  0.02624344825744629
mini_batch_src_global generation:  0.04775738716125488
r_  generation:  0.42105841636657715
local_output_nid generation:  0.028049945831298828
local_in_edges_tensor generation:  0.027194976806640625
mini_batch_src_global generation:  0.04845380783081055
r_  generation:  0.4112541675567627
local_output_nid generation:  0.028248310089111328
local_in_edges_tensor generation:  0.02549123764038086
mini_batch_src_global generation:  0.04767775535583496
r_  generation:  0.42232775688171387
local_output_nid generation:  0.028482675552368164
local_in_edges_tensor generation:  0.031082630157470703
mini_batch_src_global generation:  0.04944729804992676
r_  generation:  0.4175267219543457
local_output_nid generation:  0.02945423126220703
local_in_edges_tensor generation:  0.02749919891357422
mini_batch_src_global generation:  0.04886579513549805
r_  generation:  0.4194636344909668
local_output_nid generation:  0.02885150909423828
local_in_edges_tensor generation:  0.030446529388427734
mini_batch_src_global generation:  0.048793792724609375
r_  generation:  0.41585659980773926
local_output_nid generation:  0.028664112091064453
local_in_edges_tensor generation:  0.02630162239074707
mini_batch_src_global generation:  0.047577857971191406
r_  generation:  0.41866540908813477
local_output_nid generation:  0.02841019630432129
local_in_edges_tensor generation:  0.029253244400024414
mini_batch_src_global generation:  0.04903888702392578
r_  generation:  0.414703369140625
local_output_nid generation:  0.0291903018951416
local_in_edges_tensor generation:  0.02957940101623535
mini_batch_src_global generation:  0.048368215560913086
r_  generation:  0.42415285110473633
local_output_nid generation:  0.03085017204284668
local_in_edges_tensor generation:  0.02790975570678711
mini_batch_src_global generation:  0.05126523971557617
r_  generation:  0.41913819313049316
----------------------check_connections_block total spend ----------------------------- 19.802691221237183
generate_one_block  0.5766105651855469
generate_one_block  0.5595262050628662
generate_one_block  0.5588500499725342
generate_one_block  0.5500338077545166
generate_one_block  0.5447840690612793
generate_one_block  0.5537419319152832
generate_one_block  0.5752320289611816
generate_one_block  0.5448317527770996
generate_one_block  0.5540800094604492
generate_one_block  0.5611655712127686
generate_one_block  0.5478639602661133
generate_one_block  0.5581977367401123
generate_one_block  0.553443431854248
generate_one_block  0.5642080307006836
generate_one_block  0.5483005046844482
generate_one_block  0.5603818893432617
generate_one_block  0.558112621307373
generate_one_block  0.5438470840454102
generate_one_block  0.5508019924163818
generate_one_block  0.5675082206726074
generate_one_block  0.5617029666900635
generate_one_block  0.5488066673278809
generate_one_block  0.5524346828460693
generate_one_block  0.545130729675293
generate_one_block  0.5529239177703857
generate_one_block  0.5597169399261475
generate_one_block  0.5545589923858643
generate_one_block  0.5558004379272461
generate_one_block  0.5482580661773682
generate_one_block  0.5582895278930664
generate_one_block  0.567608118057251
generate_one_block  0.5555684566497803
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12375307083129883  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  27.29611849784851
block generation total time  24.366580963134766
average batch blocks generation time:  0.7614556550979614
block dataloader generation time/epoch 54.64172492027283
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10535955429077148  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.426339149475098  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10460996627807617  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.859357357025146  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527563095092773  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.123051166534424  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10454940795898438  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.71924924850464  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10520792007446289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.674224376678467  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10491418838500977  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.115548133850098  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10514497756958008  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.400553703308105  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10440206527709961  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.97896909713745  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523605346679688  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.859796047210693  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10498237609863281  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.461897373199463  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524511337280273  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.94744873046875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10469484329223633  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.64519739151001  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052393913269043  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.888507843017578  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10438680648803711  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.00890064239502  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10522842407226562  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.798813343048096  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10471582412719727  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.08652973175049  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523700714111328  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.854492664337158  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10460472106933594  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.507479190826416  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10514259338378906  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.419809341430664  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10493898391723633  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.189452171325684  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528182983398438  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.187127590179443  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10452795028686523  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.96718454360962  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.105224609375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.792271614074707  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10442876815795898  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.21514129638672  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524606704711914  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.890721797943115  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1047520637512207  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.986519813537598  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521173477172852  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.756886959075928  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10464668273925781  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.09805154800415  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524225234985352  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.844214916229248  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10461091995239258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.917344093322754  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10530281066894531  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.248796463012695  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10487937927246094  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.047255992889404  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03893110901117325 |0.016079947352409363 |0.41437163203954697 |9.190291166305542e-05 |0.7509817481040955 |0.006476879119873047 |
----------------------------------------------------------pseudo_mini_loss sum 1.3818830251693726
Total (block generation + training)time/epoch 93.80806729793548
Training time/epoch 39.1113760471344
Training time without block to device /epoch 38.5968177318573
Training time without total dataloading part /epoch 37.30072593688965
load block tensor time/epoch 1.245795488357544
block to device time/epoch 0.5145583152770996
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  8790689
Number of first layer input nodes during this epoch:  4679813
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12329483032226562  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029684066772460938
random selection method range initialization spend 0.006472349166870117
time for parepare:  0.024041414260864258
local_output_nid generation:  0.0018804073333740234
local_in_edges_tensor generation:  0.006865978240966797
mini_batch_src_global generation:  0.004866838455200195
r_  generation:  0.010236263275146484
local_output_nid generation:  0.0019447803497314453
local_in_edges_tensor generation:  0.0012557506561279297
mini_batch_src_global generation:  0.0024428367614746094
r_  generation:  0.011746406555175781
local_output_nid generation:  0.002174854278564453
local_in_edges_tensor generation:  0.0011823177337646484
mini_batch_src_global generation:  0.0014612674713134766
r_  generation:  0.010101318359375
local_output_nid generation:  0.0021708011627197266
local_in_edges_tensor generation:  0.0011742115020751953
mini_batch_src_global generation:  0.0014009475708007812
r_  generation:  0.010024785995483398
local_output_nid generation:  0.002216815948486328
local_in_edges_tensor generation:  0.0011475086212158203
mini_batch_src_global generation:  0.0013577938079833984
r_  generation:  0.010321378707885742
local_output_nid generation:  0.002206563949584961
local_in_edges_tensor generation:  0.0011186599731445312
mini_batch_src_global generation:  0.0012888908386230469
r_  generation:  0.009651899337768555
local_output_nid generation:  0.002232074737548828
local_in_edges_tensor generation:  0.001146554946899414
mini_batch_src_global generation:  0.0014164447784423828
r_  generation:  0.010145902633666992
local_output_nid generation:  0.002254009246826172
local_in_edges_tensor generation:  0.0011525154113769531
mini_batch_src_global generation:  0.0013623237609863281
r_  generation:  0.010785818099975586
local_output_nid generation:  0.0022804737091064453
local_in_edges_tensor generation:  0.0011196136474609375
mini_batch_src_global generation:  0.0013186931610107422
r_  generation:  0.010138273239135742
local_output_nid generation:  0.0022432804107666016
local_in_edges_tensor generation:  0.0011501312255859375
mini_batch_src_global generation:  0.0013282299041748047
r_  generation:  0.010353565216064453
local_output_nid generation:  0.0022881031036376953
local_in_edges_tensor generation:  0.001127481460571289
mini_batch_src_global generation:  0.0013880729675292969
r_  generation:  0.010489463806152344
local_output_nid generation:  0.002251148223876953
local_in_edges_tensor generation:  0.0011310577392578125
mini_batch_src_global generation:  0.0012340545654296875
r_  generation:  0.009745597839355469
local_output_nid generation:  0.0022780895233154297
local_in_edges_tensor generation:  0.0011463165283203125
mini_batch_src_global generation:  0.0013108253479003906
r_  generation:  0.0240175724029541
local_output_nid generation:  0.0026814937591552734
local_in_edges_tensor generation:  0.00138092041015625
mini_batch_src_global generation:  0.0015497207641601562
r_  generation:  0.010451793670654297
local_output_nid generation:  0.0022356510162353516
local_in_edges_tensor generation:  0.0010700225830078125
mini_batch_src_global generation:  0.0012323856353759766
r_  generation:  0.009892940521240234
local_output_nid generation:  0.0021517276763916016
local_in_edges_tensor generation:  0.0011394023895263672
mini_batch_src_global generation:  0.0012063980102539062
r_  generation:  0.010488510131835938
local_output_nid generation:  0.0020699501037597656
local_in_edges_tensor generation:  0.0009837150573730469
mini_batch_src_global generation:  0.0013096332550048828
r_  generation:  0.014372825622558594
local_output_nid generation:  0.0020568370819091797
local_in_edges_tensor generation:  0.0010497570037841797
mini_batch_src_global generation:  0.001215219497680664
r_  generation:  0.010226726531982422
local_output_nid generation:  0.002000093460083008
local_in_edges_tensor generation:  0.0010421276092529297
mini_batch_src_global generation:  0.0012087821960449219
r_  generation:  0.009696722030639648
local_output_nid generation:  0.0019350051879882812
local_in_edges_tensor generation:  0.0009586811065673828
mini_batch_src_global generation:  0.001188039779663086
r_  generation:  0.010065793991088867
local_output_nid generation:  0.0018711090087890625
local_in_edges_tensor generation:  0.0009686946868896484
mini_batch_src_global generation:  0.0012700557708740234
r_  generation:  0.010656356811523438
local_output_nid generation:  0.0018837451934814453
local_in_edges_tensor generation:  0.000965118408203125
mini_batch_src_global generation:  0.0011210441589355469
r_  generation:  0.010131359100341797
local_output_nid generation:  0.0018444061279296875
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.010354280471801758
local_output_nid generation:  0.0018630027770996094
local_in_edges_tensor generation:  0.0009813308715820312
mini_batch_src_global generation:  0.0013170242309570312
r_  generation:  0.010459184646606445
local_output_nid generation:  0.0017871856689453125
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.01038813591003418
local_output_nid generation:  0.0017590522766113281
local_in_edges_tensor generation:  0.0009341239929199219
mini_batch_src_global generation:  0.001176595687866211
r_  generation:  0.010627269744873047
local_output_nid generation:  0.0017518997192382812
local_in_edges_tensor generation:  0.0009927749633789062
mini_batch_src_global generation:  0.0011928081512451172
r_  generation:  0.010336637496948242
local_output_nid generation:  0.0017142295837402344
local_in_edges_tensor generation:  0.0009396076202392578
mini_batch_src_global generation:  0.001295328140258789
r_  generation:  0.010610580444335938
local_output_nid generation:  0.0017161369323730469
local_in_edges_tensor generation:  0.0009472370147705078
mini_batch_src_global generation:  0.0011997222900390625
r_  generation:  0.010652303695678711
local_output_nid generation:  0.0016865730285644531
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.010140419006347656
local_output_nid generation:  0.0017008781433105469
local_in_edges_tensor generation:  0.0009307861328125
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.010009765625
local_output_nid generation:  0.001668691635131836
local_in_edges_tensor generation:  0.0009250640869140625
mini_batch_src_global generation:  0.0011136531829833984
r_  generation:  0.010178327560424805
----------------------check_connections_block total spend ----------------------------- 0.6266858577728271
generate_one_block  0.024241924285888672
generate_one_block  0.022159814834594727
generate_one_block  0.01819586753845215
generate_one_block  0.01765608787536621
generate_one_block  0.018002033233642578
generate_one_block  0.016703128814697266
generate_one_block  0.01746845245361328
generate_one_block  0.018125057220458984
generate_one_block  0.01740097999572754
generate_one_block  0.017514705657958984
generate_one_block  0.01752614974975586
generate_one_block  0.019731998443603516
generate_one_block  0.018526554107666016
generate_one_block  0.01759195327758789
generate_one_block  0.016885042190551758
generate_one_block  0.017564773559570312
generate_one_block  0.01866745948791504
generate_one_block  0.019748210906982422
generate_one_block  0.016880035400390625
generate_one_block  0.017159700393676758
generate_one_block  0.017627716064453125
generate_one_block  0.016944169998168945
generate_one_block  0.017682790756225586
generate_one_block  0.01721811294555664
generate_one_block  0.01746344566345215
generate_one_block  0.017674922943115234
generate_one_block  0.01753067970275879
generate_one_block  0.017711400985717773
generate_one_block  0.01784992218017578
generate_one_block  0.016834735870361328
generate_one_block  0.016850948333740234
generate_one_block  0.017336606979370117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03791165351867676
gen group dst list time:  0.02632761001586914
time for parepare:  0.022330522537231445
local_output_nid generation:  0.006450653076171875
local_in_edges_tensor generation:  0.01885533332824707
mini_batch_src_global generation:  0.016009807586669922
r_  generation:  0.13765501976013184
local_output_nid generation:  0.009189605712890625
local_in_edges_tensor generation:  0.011332273483276367
mini_batch_src_global generation:  0.01964402198791504
r_  generation:  0.15137028694152832
local_output_nid generation:  0.009290218353271484
local_in_edges_tensor generation:  0.032312631607055664
mini_batch_src_global generation:  0.017442941665649414
r_  generation:  0.14632678031921387
local_output_nid generation:  0.009305000305175781
local_in_edges_tensor generation:  0.010849952697753906
mini_batch_src_global generation:  0.017933368682861328
r_  generation:  0.15019559860229492
local_output_nid generation:  0.009742021560668945
local_in_edges_tensor generation:  0.010993242263793945
mini_batch_src_global generation:  0.01938319206237793
r_  generation:  0.16206741333007812
local_output_nid generation:  0.009737014770507812
local_in_edges_tensor generation:  0.010340213775634766
mini_batch_src_global generation:  0.019061565399169922
r_  generation:  0.14667987823486328
local_output_nid generation:  0.009157896041870117
local_in_edges_tensor generation:  0.011120796203613281
mini_batch_src_global generation:  0.019006967544555664
r_  generation:  0.15881133079528809
local_output_nid generation:  0.009155988693237305
local_in_edges_tensor generation:  0.012497901916503906
mini_batch_src_global generation:  0.020299434661865234
r_  generation:  0.16314697265625
local_output_nid generation:  0.008979558944702148
local_in_edges_tensor generation:  0.015856504440307617
mini_batch_src_global generation:  0.02036261558532715
r_  generation:  0.15549349784851074
local_output_nid generation:  0.011763572692871094
local_in_edges_tensor generation:  0.01055002212524414
mini_batch_src_global generation:  0.01974797248840332
r_  generation:  0.156998872756958
local_output_nid generation:  0.009894609451293945
local_in_edges_tensor generation:  0.01034235954284668
mini_batch_src_global generation:  0.019208192825317383
r_  generation:  0.15795588493347168
local_output_nid generation:  0.009466886520385742
local_in_edges_tensor generation:  0.008799552917480469
mini_batch_src_global generation:  0.0189359188079834
r_  generation:  0.15611696243286133
local_output_nid generation:  0.012405633926391602
local_in_edges_tensor generation:  0.00853729248046875
mini_batch_src_global generation:  0.01953911781311035
r_  generation:  0.15797853469848633
local_output_nid generation:  0.009837627410888672
local_in_edges_tensor generation:  0.00872492790222168
mini_batch_src_global generation:  0.019262313842773438
r_  generation:  0.15423130989074707
local_output_nid generation:  0.009657144546508789
local_in_edges_tensor generation:  0.009534597396850586
mini_batch_src_global generation:  0.019213199615478516
r_  generation:  0.15039443969726562
local_output_nid generation:  0.009660482406616211
local_in_edges_tensor generation:  0.010515213012695312
mini_batch_src_global generation:  0.01930379867553711
r_  generation:  0.15604734420776367
local_output_nid generation:  0.01011037826538086
local_in_edges_tensor generation:  0.011526346206665039
mini_batch_src_global generation:  0.020925521850585938
r_  generation:  0.21637439727783203
local_output_nid generation:  0.008995532989501953
local_in_edges_tensor generation:  0.008093595504760742
mini_batch_src_global generation:  0.019976377487182617
r_  generation:  0.14654207229614258
local_output_nid generation:  0.00920248031616211
local_in_edges_tensor generation:  0.009196043014526367
mini_batch_src_global generation:  0.01766204833984375
r_  generation:  0.14646363258361816
local_output_nid generation:  0.009422540664672852
local_in_edges_tensor generation:  0.009162187576293945
mini_batch_src_global generation:  0.01847982406616211
r_  generation:  0.19562482833862305
local_output_nid generation:  0.009603738784790039
local_in_edges_tensor generation:  0.00853419303894043
mini_batch_src_global generation:  0.023127079010009766
r_  generation:  0.1605358123779297
local_output_nid generation:  0.009417295455932617
local_in_edges_tensor generation:  0.010226249694824219
mini_batch_src_global generation:  0.019040346145629883
r_  generation:  0.15644264221191406
local_output_nid generation:  0.009741783142089844
local_in_edges_tensor generation:  0.008850574493408203
mini_batch_src_global generation:  0.0202333927154541
r_  generation:  0.16129612922668457
local_output_nid generation:  0.009456872940063477
local_in_edges_tensor generation:  0.00841379165649414
mini_batch_src_global generation:  0.018854856491088867
r_  generation:  0.15415191650390625
local_output_nid generation:  0.009643316268920898
local_in_edges_tensor generation:  0.009018898010253906
mini_batch_src_global generation:  0.019176959991455078
r_  generation:  0.15751910209655762
local_output_nid generation:  0.009787321090698242
local_in_edges_tensor generation:  0.009085655212402344
mini_batch_src_global generation:  0.019789457321166992
r_  generation:  0.16129541397094727
local_output_nid generation:  0.00964975357055664
local_in_edges_tensor generation:  0.009153604507446289
mini_batch_src_global generation:  0.021930456161499023
r_  generation:  0.16062521934509277
local_output_nid generation:  0.010621070861816406
local_in_edges_tensor generation:  0.008665323257446289
mini_batch_src_global generation:  0.0201113224029541
r_  generation:  0.16316485404968262
local_output_nid generation:  0.00985860824584961
local_in_edges_tensor generation:  0.013812780380249023
mini_batch_src_global generation:  0.01981043815612793
r_  generation:  0.1668236255645752
local_output_nid generation:  0.009300947189331055
local_in_edges_tensor generation:  0.013438701629638672
mini_batch_src_global generation:  0.020112276077270508
r_  generation:  0.14987611770629883
local_output_nid generation:  0.00936436653137207
local_in_edges_tensor generation:  0.00898289680480957
mini_batch_src_global generation:  0.018177032470703125
r_  generation:  0.1519181728363037
local_output_nid generation:  0.009432792663574219
local_in_edges_tensor generation:  0.009647607803344727
mini_batch_src_global generation:  0.01868605613708496
r_  generation:  0.15337491035461426
----------------------check_connections_block total spend ----------------------------- 7.548098564147949
generate_one_block  0.21370935440063477
generate_one_block  0.21314501762390137
generate_one_block  0.2004563808441162
generate_one_block  0.20158100128173828
generate_one_block  0.22339749336242676
generate_one_block  0.19288349151611328
generate_one_block  0.20899295806884766
generate_one_block  0.2141115665435791
generate_one_block  0.20260095596313477
generate_one_block  0.20899462699890137
generate_one_block  0.20760607719421387
generate_one_block  0.1901717185974121
generate_one_block  0.20863962173461914
generate_one_block  0.20343518257141113
generate_one_block  0.19620966911315918
generate_one_block  0.20658302307128906
generate_one_block  0.2151479721069336
generate_one_block  0.19325542449951172
generate_one_block  0.19202136993408203
generate_one_block  0.20466160774230957
generate_one_block  0.2138357162475586
generate_one_block  0.2090768814086914
generate_one_block  0.22605562210083008
generate_one_block  0.20362234115600586
generate_one_block  0.20742034912109375
generate_one_block  0.2133488655090332
generate_one_block  0.20790958404541016
generate_one_block  0.21756291389465332
generate_one_block  0.2189493179321289
generate_one_block  0.20301032066345215
generate_one_block  0.20122551918029785
generate_one_block  0.2042694091796875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032381534576416016
gen group dst list time:  0.11193394660949707
time for parepare:  0.02167057991027832
local_output_nid generation:  0.026368141174316406
local_in_edges_tensor generation:  0.0449831485748291
mini_batch_src_global generation:  0.03734612464904785
r_  generation:  0.4103207588195801
local_output_nid generation:  0.0317380428314209
local_in_edges_tensor generation:  0.03368377685546875
mini_batch_src_global generation:  0.05038642883300781
r_  generation:  0.40840911865234375
local_output_nid generation:  0.032256364822387695
local_in_edges_tensor generation:  0.03605532646179199
mini_batch_src_global generation:  0.04801487922668457
r_  generation:  0.4188363552093506
local_output_nid generation:  0.03189587593078613
local_in_edges_tensor generation:  0.031099319458007812
mini_batch_src_global generation:  0.04988694190979004
r_  generation:  0.418499231338501
local_output_nid generation:  0.032422780990600586
local_in_edges_tensor generation:  0.029335975646972656
mini_batch_src_global generation:  0.04818081855773926
r_  generation:  0.4185032844543457
local_output_nid generation:  0.02998948097229004
local_in_edges_tensor generation:  0.025691509246826172
mini_batch_src_global generation:  0.0491185188293457
r_  generation:  0.40358996391296387
local_output_nid generation:  0.02892899513244629
local_in_edges_tensor generation:  0.02576470375061035
mini_batch_src_global generation:  0.04789280891418457
r_  generation:  0.41599392890930176
local_output_nid generation:  0.02881908416748047
local_in_edges_tensor generation:  0.027179956436157227
mini_batch_src_global generation:  0.053615570068359375
r_  generation:  0.4122047424316406
local_output_nid generation:  0.02874016761779785
local_in_edges_tensor generation:  0.027135610580444336
mini_batch_src_global generation:  0.048030853271484375
r_  generation:  0.4278247356414795
local_output_nid generation:  0.02885746955871582
local_in_edges_tensor generation:  0.026099205017089844
mini_batch_src_global generation:  0.05121493339538574
r_  generation:  0.4122176170349121
local_output_nid generation:  0.02871108055114746
local_in_edges_tensor generation:  0.028844356536865234
mini_batch_src_global generation:  0.0479586124420166
r_  generation:  0.4236617088317871
local_output_nid generation:  0.02832484245300293
local_in_edges_tensor generation:  0.028807878494262695
mini_batch_src_global generation:  0.05126619338989258
r_  generation:  0.40985107421875
local_output_nid generation:  0.028894901275634766
local_in_edges_tensor generation:  0.027619600296020508
mini_batch_src_global generation:  0.049716949462890625
r_  generation:  0.42046236991882324
local_output_nid generation:  0.028873920440673828
local_in_edges_tensor generation:  0.027095794677734375
mini_batch_src_global generation:  0.05129432678222656
r_  generation:  0.4090747833251953
local_output_nid generation:  0.02873682975769043
local_in_edges_tensor generation:  0.031746625900268555
mini_batch_src_global generation:  0.04727053642272949
r_  generation:  0.41733384132385254
local_output_nid generation:  0.028745174407958984
local_in_edges_tensor generation:  0.027378082275390625
mini_batch_src_global generation:  0.04892849922180176
r_  generation:  0.41460537910461426
local_output_nid generation:  0.029622793197631836
local_in_edges_tensor generation:  0.03383016586303711
mini_batch_src_global generation:  0.050338029861450195
r_  generation:  0.42882204055786133
local_output_nid generation:  0.030846595764160156
local_in_edges_tensor generation:  0.027319908142089844
mini_batch_src_global generation:  0.051760196685791016
r_  generation:  0.40453529357910156
local_output_nid generation:  0.028576135635375977
local_in_edges_tensor generation:  0.028156757354736328
mini_batch_src_global generation:  0.04725050926208496
r_  generation:  0.4159700870513916
local_output_nid generation:  0.028716325759887695
local_in_edges_tensor generation:  0.02702641487121582
mini_batch_src_global generation:  0.049184560775756836
r_  generation:  0.4087839126586914
local_output_nid generation:  0.029257535934448242
local_in_edges_tensor generation:  0.02986001968383789
mini_batch_src_global generation:  0.04984593391418457
r_  generation:  0.4224853515625
local_output_nid generation:  0.028909921646118164
local_in_edges_tensor generation:  0.030608654022216797
mini_batch_src_global generation:  0.05010986328125
r_  generation:  0.4115617275238037
local_output_nid generation:  0.028820037841796875
local_in_edges_tensor generation:  0.029651641845703125
mini_batch_src_global generation:  0.051577091217041016
r_  generation:  0.4220709800720215
local_output_nid generation:  0.0301206111907959
local_in_edges_tensor generation:  0.0297243595123291
mini_batch_src_global generation:  0.049773454666137695
r_  generation:  0.4100472927093506
local_output_nid generation:  0.028971433639526367
local_in_edges_tensor generation:  0.025739192962646484
mini_batch_src_global generation:  0.04784870147705078
r_  generation:  0.4355902671813965
local_output_nid generation:  0.0332646369934082
local_in_edges_tensor generation:  0.02906060218811035
mini_batch_src_global generation:  0.05190277099609375
r_  generation:  0.41430187225341797
local_output_nid generation:  0.028958797454833984
local_in_edges_tensor generation:  0.026067256927490234
mini_batch_src_global generation:  0.04776954650878906
r_  generation:  0.41753125190734863
local_output_nid generation:  0.028767108917236328
local_in_edges_tensor generation:  0.02620077133178711
mini_batch_src_global generation:  0.05478668212890625
r_  generation:  0.4135122299194336
local_output_nid generation:  0.02899479866027832
local_in_edges_tensor generation:  0.02795577049255371
mini_batch_src_global generation:  0.04786944389343262
r_  generation:  0.43317580223083496
local_output_nid generation:  0.028524160385131836
local_in_edges_tensor generation:  0.028351783752441406
mini_batch_src_global generation:  0.04939675331115723
r_  generation:  0.4102623462677002
local_output_nid generation:  0.028559207916259766
local_in_edges_tensor generation:  0.02624821662902832
mini_batch_src_global generation:  0.0478816032409668
r_  generation:  0.4185066223144531
local_output_nid generation:  0.029159069061279297
local_in_edges_tensor generation:  0.02606344223022461
mini_batch_src_global generation:  0.04989337921142578
r_  generation:  0.41342782974243164
----------------------check_connections_block total spend ----------------------------- 19.748355388641357
generate_one_block  0.5670630931854248
generate_one_block  0.5818789005279541
generate_one_block  0.5498948097229004
generate_one_block  0.5533015727996826
generate_one_block  0.6555371284484863
generate_one_block  0.541266679763794
generate_one_block  0.5524537563323975
generate_one_block  0.5658557415008545
generate_one_block  0.5569188594818115
generate_one_block  0.559823751449585
generate_one_block  0.5572288036346436
generate_one_block  0.5458278656005859
generate_one_block  0.558856725692749
generate_one_block  0.5522685050964355
generate_one_block  0.5467169284820557
generate_one_block  0.5555665493011475
generate_one_block  0.5706942081451416
generate_one_block  0.5438342094421387
generate_one_block  0.5433344841003418
generate_one_block  0.5497856140136719
generate_one_block  0.5620701313018799
generate_one_block  0.551703691482544
generate_one_block  0.5595822334289551
generate_one_block  0.546544075012207
generate_one_block  0.5728569030761719
generate_one_block  0.56618332862854
generate_one_block  0.5529823303222656
generate_one_block  0.5548136234283447
generate_one_block  0.5665018558502197
generate_one_block  0.5518879890441895
generate_one_block  0.5493121147155762
generate_one_block  0.5584638118743896
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12329483032226562  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  27.296453952789307
block generation total time  24.524901628494263
average batch blocks generation time:  0.7664031758904457
block dataloader generation time/epoch 54.665596506812356
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10522747039794922  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.88956356048584  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10470867156982422  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.41773509979248  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10522699356079102  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.819714069366455  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10477447509765625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.898836612701416  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10530757904052734  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.178985118865967  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.104400634765625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.269737720489502  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528039932250977  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.110896587371826  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10450601577758789  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.239486694335938  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523509979248047  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.931193828582764  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10471105575561523  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.9258131980896  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527515411376953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.09576940536499  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10457611083984375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.366741180419922  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10530376434326172  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.13516616821289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10452747344970703  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.821696758270264  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10517501831054688  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.579808235168457  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10458707809448242  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.04340124130249  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10537433624267578  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.5045166015625  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10411214828491211  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.355942726135254  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10512018203735352  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.337509155273438  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10458612442016602  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.670228958129883  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10529661178588867  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.167546272277832  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10466575622558594  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.86502456665039  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10530281066894531  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.165642738342285  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10457563400268555  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.711742401123047  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10525941848754883  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.031551837921143  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10500049591064453  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.20018243789673  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10525274276733398  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.942763805389404  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10465764999389648  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.159492015838623  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10531902313232422  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.250154495239258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10443544387817383  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.597532749176025  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10519647598266602  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.654827117919922  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10489273071289062  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.82465171813965  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03081107884645462 |0.01520448923110962 |0.4177132025361061 |9.348243474960327e-05 |0.7537887915968895 |0.006962299346923828 |
----------------------------------------------------------pseudo_mini_loss sum 1.3622980117797852
Total (block generation + training)time/epoch 93.81854592670093
Training time/epoch 39.01876401901245
Training time without block to device /epoch 38.53222036361694
Training time without total dataloading part /epoch 37.49801754951477
load block tensor time/epoch 0.9859545230865479
block to device time/epoch 0.4865436553955078
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  8796918
Number of first layer input nodes during this epoch:  4681116
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12307310104370117  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028621673583984375
random selection method range initialization spend 0.005427837371826172
time for parepare:  0.02084827423095703
local_output_nid generation:  0.0015070438385009766
local_in_edges_tensor generation:  0.008661985397338867
mini_batch_src_global generation:  0.0016942024230957031
r_  generation:  0.011426925659179688
local_output_nid generation:  0.001714468002319336
local_in_edges_tensor generation:  0.0010471343994140625
mini_batch_src_global generation:  0.001486063003540039
r_  generation:  0.010538101196289062
local_output_nid generation:  0.0016412734985351562
local_in_edges_tensor generation:  0.0009789466857910156
mini_batch_src_global generation:  0.001276254653930664
r_  generation:  0.010060310363769531
local_output_nid generation:  0.0016269683837890625
local_in_edges_tensor generation:  0.0009622573852539062
mini_batch_src_global generation:  0.0011472702026367188
r_  generation:  0.009430646896362305
local_output_nid generation:  0.0016477108001708984
local_in_edges_tensor generation:  0.0010972023010253906
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.013251304626464844
local_output_nid generation:  0.0017476081848144531
local_in_edges_tensor generation:  0.0009477138519287109
mini_batch_src_global generation:  0.0011744499206542969
r_  generation:  0.010122537612915039
local_output_nid generation:  0.0016217231750488281
local_in_edges_tensor generation:  0.0009665489196777344
mini_batch_src_global generation:  0.0012288093566894531
r_  generation:  0.010409832000732422
local_output_nid generation:  0.0016260147094726562
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.0011928081512451172
r_  generation:  0.010341644287109375
local_output_nid generation:  0.0016527175903320312
local_in_edges_tensor generation:  0.0009164810180664062
mini_batch_src_global generation:  0.0011489391326904297
r_  generation:  0.010131597518920898
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.001157999038696289
r_  generation:  0.01026606559753418
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0009207725524902344
mini_batch_src_global generation:  0.0011394023895263672
r_  generation:  0.01253962516784668
local_output_nid generation:  0.0016262531280517578
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0011625289916992188
r_  generation:  0.010049104690551758
local_output_nid generation:  0.001621246337890625
local_in_edges_tensor generation:  0.0009996891021728516
mini_batch_src_global generation:  0.0011577606201171875
r_  generation:  0.01002955436706543
local_output_nid generation:  0.0016088485717773438
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0011982917785644531
r_  generation:  0.010563373565673828
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.0009620189666748047
mini_batch_src_global generation:  0.0011138916015625
r_  generation:  0.009967565536499023
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0011525154113769531
r_  generation:  0.010177135467529297
local_output_nid generation:  0.0015892982482910156
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0012545585632324219
r_  generation:  0.010200738906860352
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0029823780059814453
r_  generation:  0.00953054428100586
local_output_nid generation:  0.0016443729400634766
local_in_edges_tensor generation:  0.0009267330169677734
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.010257959365844727
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0008983612060546875
mini_batch_src_global generation:  0.0011339187622070312
r_  generation:  0.010179519653320312
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0009505748748779297
mini_batch_src_global generation:  0.0012564659118652344
r_  generation:  0.010678529739379883
local_output_nid generation:  0.00162506103515625
local_in_edges_tensor generation:  0.0009915828704833984
mini_batch_src_global generation:  0.001210927963256836
r_  generation:  0.010711908340454102
local_output_nid generation:  0.0016129016876220703
local_in_edges_tensor generation:  0.0009062290191650391
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.010375261306762695
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0011935234069824219
r_  generation:  0.012031793594360352
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.0009195804595947266
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.010223627090454102
local_output_nid generation:  0.001603841781616211
local_in_edges_tensor generation:  0.000934600830078125
mini_batch_src_global generation:  0.0012454986572265625
r_  generation:  0.01074981689453125
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009319782257080078
mini_batch_src_global generation:  0.0012001991271972656
r_  generation:  0.010726690292358398
local_output_nid generation:  0.0016057491302490234
local_in_edges_tensor generation:  0.0009613037109375
mini_batch_src_global generation:  0.0011630058288574219
r_  generation:  0.009755611419677734
local_output_nid generation:  0.0016238689422607422
local_in_edges_tensor generation:  0.0009205341339111328
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.010180950164794922
local_output_nid generation:  0.0016100406646728516
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.001190185546875
r_  generation:  0.012517929077148438
local_output_nid generation:  0.0017490386962890625
local_in_edges_tensor generation:  0.0009675025939941406
mini_batch_src_global generation:  0.0014431476593017578
r_  generation:  0.010685443878173828
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.010303258895874023
----------------------check_connections_block total spend ----------------------------- 0.5856082439422607
generate_one_block  0.0277862548828125
generate_one_block  0.020489931106567383
generate_one_block  0.021608591079711914
generate_one_block  0.018706083297729492
generate_one_block  0.017744779586791992
generate_one_block  0.017574310302734375
generate_one_block  0.01797795295715332
generate_one_block  0.017877578735351562
generate_one_block  0.020813941955566406
generate_one_block  0.017916202545166016
generate_one_block  0.017679691314697266
generate_one_block  0.020505905151367188
generate_one_block  0.017836332321166992
generate_one_block  0.020839452743530273
generate_one_block  0.016988039016723633
generate_one_block  0.01758551597595215
generate_one_block  0.017569303512573242
generate_one_block  0.016640186309814453
generate_one_block  0.01738262176513672
generate_one_block  0.019273757934570312
generate_one_block  0.018467426300048828
generate_one_block  0.018289804458618164
generate_one_block  0.017769575119018555
generate_one_block  0.017447710037231445
generate_one_block  0.017494678497314453
generate_one_block  0.020368576049804688
generate_one_block  0.018466472625732422
generate_one_block  0.016571044921875
generate_one_block  0.017490625381469727
generate_one_block  0.01737523078918457
generate_one_block  0.017568349838256836
generate_one_block  0.019623279571533203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038419485092163086
gen group dst list time:  0.020486831665039062
time for parepare:  0.020730972290039062
local_output_nid generation:  0.007042884826660156
local_in_edges_tensor generation:  0.023155927658081055
mini_batch_src_global generation:  0.015146970748901367
r_  generation:  0.15064048767089844
local_output_nid generation:  0.010081291198730469
local_in_edges_tensor generation:  0.010888814926147461
mini_batch_src_global generation:  0.019026994705200195
r_  generation:  0.1528615951538086
local_output_nid generation:  0.011553764343261719
local_in_edges_tensor generation:  0.03870129585266113
mini_batch_src_global generation:  0.017529010772705078
r_  generation:  0.1479320526123047
local_output_nid generation:  0.00900578498840332
local_in_edges_tensor generation:  0.009141206741333008
mini_batch_src_global generation:  0.016510963439941406
r_  generation:  0.14232325553894043
local_output_nid generation:  0.009184837341308594
local_in_edges_tensor generation:  0.011081933975219727
mini_batch_src_global generation:  0.018451452255249023
r_  generation:  0.14923977851867676
local_output_nid generation:  0.008942604064941406
local_in_edges_tensor generation:  0.010065317153930664
mini_batch_src_global generation:  0.019283771514892578
r_  generation:  0.15213370323181152
local_output_nid generation:  0.008958101272583008
local_in_edges_tensor generation:  0.011348962783813477
mini_batch_src_global generation:  0.01986098289489746
r_  generation:  0.1557018756866455
local_output_nid generation:  0.00892496109008789
local_in_edges_tensor generation:  0.010354995727539062
mini_batch_src_global generation:  0.02023792266845703
r_  generation:  0.15668725967407227
local_output_nid generation:  0.008974790573120117
local_in_edges_tensor generation:  0.009582996368408203
mini_batch_src_global generation:  0.019984722137451172
r_  generation:  0.15523457527160645
local_output_nid generation:  0.009421110153198242
local_in_edges_tensor generation:  0.008966684341430664
mini_batch_src_global generation:  0.01963043212890625
r_  generation:  0.15515923500061035
local_output_nid generation:  0.00918269157409668
local_in_edges_tensor generation:  0.009290218353271484
mini_batch_src_global generation:  0.01903843879699707
r_  generation:  0.15261244773864746
local_output_nid generation:  0.009271383285522461
local_in_edges_tensor generation:  0.009124279022216797
mini_batch_src_global generation:  0.019170761108398438
r_  generation:  0.15143132209777832
local_output_nid generation:  0.009173154830932617
local_in_edges_tensor generation:  0.008730649948120117
mini_batch_src_global generation:  0.018463850021362305
r_  generation:  0.15062904357910156
local_output_nid generation:  0.009582757949829102
local_in_edges_tensor generation:  0.008873701095581055
mini_batch_src_global generation:  0.019539833068847656
r_  generation:  0.15750479698181152
local_output_nid generation:  0.009098052978515625
local_in_edges_tensor generation:  0.008584022521972656
mini_batch_src_global generation:  0.0188138484954834
r_  generation:  0.1501631736755371
local_output_nid generation:  0.009265661239624023
local_in_edges_tensor generation:  0.008780479431152344
mini_batch_src_global generation:  0.019131898880004883
r_  generation:  0.1549217700958252
local_output_nid generation:  0.009147882461547852
local_in_edges_tensor generation:  0.008717536926269531
mini_batch_src_global generation:  0.018683195114135742
r_  generation:  0.15463638305664062
local_output_nid generation:  0.008931159973144531
local_in_edges_tensor generation:  0.01019430160522461
mini_batch_src_global generation:  0.018004655838012695
r_  generation:  0.14696097373962402
local_output_nid generation:  0.009319782257080078
local_in_edges_tensor generation:  0.008924007415771484
mini_batch_src_global generation:  0.018721342086791992
r_  generation:  0.15556836128234863
local_output_nid generation:  0.009198427200317383
local_in_edges_tensor generation:  0.00892949104309082
mini_batch_src_global generation:  0.01873922348022461
r_  generation:  0.1523730754852295
local_output_nid generation:  0.009719610214233398
local_in_edges_tensor generation:  0.008758783340454102
mini_batch_src_global generation:  0.01943182945251465
r_  generation:  0.15916037559509277
local_output_nid generation:  0.009645938873291016
local_in_edges_tensor generation:  0.009449958801269531
mini_batch_src_global generation:  0.019557476043701172
r_  generation:  0.15848469734191895
local_output_nid generation:  0.009453058242797852
local_in_edges_tensor generation:  0.008906841278076172
mini_batch_src_global generation:  0.01937699317932129
r_  generation:  0.15806007385253906
local_output_nid generation:  0.009297370910644531
local_in_edges_tensor generation:  0.008753061294555664
mini_batch_src_global generation:  0.019283294677734375
r_  generation:  0.15470457077026367
local_output_nid generation:  0.009354591369628906
local_in_edges_tensor generation:  0.008943557739257812
mini_batch_src_global generation:  0.01950359344482422
r_  generation:  0.15604925155639648
local_output_nid generation:  0.009631633758544922
local_in_edges_tensor generation:  0.010037660598754883
mini_batch_src_global generation:  0.021061420440673828
r_  generation:  0.1623821258544922
local_output_nid generation:  0.00965738296508789
local_in_edges_tensor generation:  0.00968480110168457
mini_batch_src_global generation:  0.019580841064453125
r_  generation:  0.16149020195007324
local_output_nid generation:  0.008973360061645508
local_in_edges_tensor generation:  0.008695840835571289
mini_batch_src_global generation:  0.018437623977661133
r_  generation:  0.14796781539916992
local_output_nid generation:  0.009327888488769531
local_in_edges_tensor generation:  0.00883173942565918
mini_batch_src_global generation:  0.01879715919494629
r_  generation:  0.15886759757995605
local_output_nid generation:  0.009259223937988281
local_in_edges_tensor generation:  0.008834123611450195
mini_batch_src_global generation:  0.018551111221313477
r_  generation:  0.15641450881958008
local_output_nid generation:  0.009327411651611328
local_in_edges_tensor generation:  0.008926630020141602
mini_batch_src_global generation:  0.020083189010620117
r_  generation:  0.15874075889587402
local_output_nid generation:  0.009393692016601562
local_in_edges_tensor generation:  0.008923768997192383
mini_batch_src_global generation:  0.018910646438598633
r_  generation:  0.1560070514678955
----------------------check_connections_block total spend ----------------------------- 7.345581531524658
generate_one_block  0.22413134574890137
generate_one_block  0.19718360900878906
generate_one_block  0.20501494407653809
generate_one_block  0.19626903533935547
generate_one_block  0.22327232360839844
generate_one_block  0.2087407112121582
generate_one_block  0.21069049835205078
generate_one_block  0.21322059631347656
generate_one_block  0.20710468292236328
generate_one_block  0.20598149299621582
generate_one_block  0.20134449005126953
generate_one_block  0.20063042640686035
generate_one_block  0.19796991348266602
generate_one_block  0.20892548561096191
generate_one_block  0.19558095932006836
generate_one_block  0.20243072509765625
generate_one_block  0.2010204792022705
generate_one_block  0.19089365005493164
generate_one_block  0.2053976058959961
generate_one_block  0.20770025253295898
generate_one_block  0.21602821350097656
generate_one_block  0.21464896202087402
generate_one_block  0.20862841606140137
generate_one_block  0.2065141201019287
generate_one_block  0.2100696563720703
generate_one_block  0.21631932258605957
generate_one_block  0.21508431434631348
generate_one_block  0.19482159614562988
generate_one_block  0.20817875862121582
generate_one_block  0.20650076866149902
generate_one_block  0.2064371109008789
generate_one_block  0.20252633094787598
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032061100006103516
gen group dst list time:  0.10965609550476074
time for parepare:  0.01928567886352539
local_output_nid generation:  0.02566695213317871
local_in_edges_tensor generation:  0.045686960220336914
mini_batch_src_global generation:  0.03740096092224121
r_  generation:  0.4065244197845459
local_output_nid generation:  0.029708385467529297
local_in_edges_tensor generation:  0.03260350227355957
mini_batch_src_global generation:  0.04932737350463867
r_  generation:  0.3996422290802002
local_output_nid generation:  0.029871463775634766
local_in_edges_tensor generation:  0.029214859008789062
mini_batch_src_global generation:  0.048690080642700195
r_  generation:  0.40959858894348145
local_output_nid generation:  0.02977275848388672
local_in_edges_tensor generation:  0.025563955307006836
mini_batch_src_global generation:  0.04823493957519531
r_  generation:  0.4003267288208008
local_output_nid generation:  0.030054330825805664
local_in_edges_tensor generation:  0.025823116302490234
mini_batch_src_global generation:  0.0468597412109375
r_  generation:  0.41611504554748535
local_output_nid generation:  0.030220508575439453
local_in_edges_tensor generation:  0.030912160873413086
mini_batch_src_global generation:  0.048876047134399414
r_  generation:  0.41527652740478516
local_output_nid generation:  0.028595924377441406
local_in_edges_tensor generation:  0.02786731719970703
mini_batch_src_global generation:  0.04776811599731445
r_  generation:  0.4234769344329834
local_output_nid generation:  0.028449296951293945
local_in_edges_tensor generation:  0.031177759170532227
mini_batch_src_global generation:  0.049191951751708984
r_  generation:  0.41692590713500977
local_output_nid generation:  0.028595685958862305
local_in_edges_tensor generation:  0.025581836700439453
mini_batch_src_global generation:  0.04805731773376465
r_  generation:  0.42390894889831543
local_output_nid generation:  0.0291140079498291
local_in_edges_tensor generation:  0.02646803855895996
mini_batch_src_global generation:  0.049004316329956055
r_  generation:  0.4116787910461426
local_output_nid generation:  0.02816605567932129
local_in_edges_tensor generation:  0.02714705467224121
mini_batch_src_global generation:  0.04964470863342285
r_  generation:  0.42249298095703125
local_output_nid generation:  0.02840590476989746
local_in_edges_tensor generation:  0.03274869918823242
mini_batch_src_global generation:  0.04894566535949707
r_  generation:  0.4101743698120117
local_output_nid generation:  0.027944087982177734
local_in_edges_tensor generation:  0.02945542335510254
mini_batch_src_global generation:  0.04717826843261719
r_  generation:  0.4162893295288086
local_output_nid generation:  0.02892470359802246
local_in_edges_tensor generation:  0.028284072875976562
mini_batch_src_global generation:  0.048551321029663086
r_  generation:  0.4108142852783203
local_output_nid generation:  0.027504682540893555
local_in_edges_tensor generation:  0.02721095085144043
mini_batch_src_global generation:  0.04900503158569336
r_  generation:  0.4143691062927246
local_output_nid generation:  0.02836132049560547
local_in_edges_tensor generation:  0.026159286499023438
mini_batch_src_global generation:  0.04889369010925293
r_  generation:  0.41139936447143555
local_output_nid generation:  0.028357982635498047
local_in_edges_tensor generation:  0.02764892578125
mini_batch_src_global generation:  0.04746294021606445
r_  generation:  0.4228975772857666
local_output_nid generation:  0.027831315994262695
local_in_edges_tensor generation:  0.030096769332885742
mini_batch_src_global generation:  0.04834699630737305
r_  generation:  0.4042978286743164
local_output_nid generation:  0.028030872344970703
local_in_edges_tensor generation:  0.027069568634033203
mini_batch_src_global generation:  0.04692792892456055
r_  generation:  0.41898131370544434
local_output_nid generation:  0.02815556526184082
local_in_edges_tensor generation:  0.029538393020629883
mini_batch_src_global generation:  0.04883861541748047
r_  generation:  0.4236323833465576
local_output_nid generation:  0.030844449996948242
local_in_edges_tensor generation:  0.0314478874206543
mini_batch_src_global generation:  0.0483400821685791
r_  generation:  0.4245452880859375
local_output_nid generation:  0.029408931732177734
local_in_edges_tensor generation:  0.02810359001159668
mini_batch_src_global generation:  0.04912304878234863
r_  generation:  0.41372084617614746
local_output_nid generation:  0.02900838851928711
local_in_edges_tensor generation:  0.02762436866760254
mini_batch_src_global generation:  0.04792380332946777
r_  generation:  0.4231569766998291
local_output_nid generation:  0.028873920440673828
local_in_edges_tensor generation:  0.027718305587768555
mini_batch_src_global generation:  0.04915428161621094
r_  generation:  0.40990185737609863
local_output_nid generation:  0.02898406982421875
local_in_edges_tensor generation:  0.02589869499206543
mini_batch_src_global generation:  0.047237396240234375
r_  generation:  0.42389941215515137
local_output_nid generation:  0.029120922088623047
local_in_edges_tensor generation:  0.029253482818603516
mini_batch_src_global generation:  0.050774335861206055
r_  generation:  0.4145054817199707
local_output_nid generation:  0.02945232391357422
local_in_edges_tensor generation:  0.029992103576660156
mini_batch_src_global generation:  0.047640085220336914
r_  generation:  0.4271395206451416
local_output_nid generation:  0.029099464416503906
local_in_edges_tensor generation:  0.025434494018554688
mini_batch_src_global generation:  0.04812002182006836
r_  generation:  0.4082963466644287
local_output_nid generation:  0.028878211975097656
local_in_edges_tensor generation:  0.02623128890991211
mini_batch_src_global generation:  0.047205448150634766
r_  generation:  0.43808603286743164
local_output_nid generation:  0.028617382049560547
local_in_edges_tensor generation:  0.026825904846191406
mini_batch_src_global generation:  0.04851984977722168
r_  generation:  0.4070906639099121
local_output_nid generation:  0.0333094596862793
local_in_edges_tensor generation:  0.026283979415893555
mini_batch_src_global generation:  0.0475611686706543
r_  generation:  0.4190669059753418
local_output_nid generation:  0.029155254364013672
local_in_edges_tensor generation:  0.027292728424072266
mini_batch_src_global generation:  0.04864096641540527
r_  generation:  0.4106254577636719
----------------------check_connections_block total spend ----------------------------- 19.63676691055298
generate_one_block  0.5715923309326172
generate_one_block  0.5540938377380371
generate_one_block  0.5443832874298096
generate_one_block  0.5427074432373047
generate_one_block  0.6553914546966553
generate_one_block  0.5587201118469238
generate_one_block  0.5623631477355957
generate_one_block  0.5646359920501709
generate_one_block  0.5565989017486572
generate_one_block  0.5597789287567139
generate_one_block  0.5593311786651611
generate_one_block  0.5571906566619873
generate_one_block  0.5529475212097168
generate_one_block  0.5553855895996094
generate_one_block  0.5502104759216309
generate_one_block  0.5649027824401855
generate_one_block  0.5589656829833984
generate_one_block  0.5455107688903809
generate_one_block  0.5491042137145996
generate_one_block  0.5517489910125732
generate_one_block  0.5651683807373047
generate_one_block  0.55965256690979
generate_one_block  0.5534353256225586
generate_one_block  0.5541501045227051
generate_one_block  0.574622392654419
generate_one_block  0.5641283988952637
generate_one_block  0.573157787322998
generate_one_block  0.5502943992614746
generate_one_block  0.5504970550537109
generate_one_block  0.5540533065795898
generate_one_block  0.5557224750518799
generate_one_block  0.5478134155273438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12307310104370117  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  26.982348442077637
block generation total time  24.527519702911377
average batch blocks generation time:  0.7664849907159805
block dataloader generation time/epoch 54.65916631619135
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10535049438476562  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.3259334564209  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1044473648071289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.58020782470703  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524654388427734  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.891758918762207  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10431623458862305  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.3992977142334  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10522747039794922  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.80939483642578  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.104583740234375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.980252742767334  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10529708862304688  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.105708122253418  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1046743392944336  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.20101022720337  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526371002197266  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.066041946411133  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10457277297973633  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.062618255615234  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523033142089844  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.851311683654785  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10476303100585938  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.757817268371582  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10518598556518555  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.62124729156494  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10466957092285156  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.132468223571777  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10410451889038086  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.45976495742798  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10485315322875977  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.863261699676514  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521411895751953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.726359367370605  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10431957244873047  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.232409954071045  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523223876953125  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.757811069488525  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10468816757202148  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.67349100112915  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10530471801757812  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.24001407623291  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10510778427124023  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.249428749084473  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528230667114258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.128133296966553  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10453271865844727  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.861053943634033  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527276992797852  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.068034172058105  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10484838485717773  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.34394407272339  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1053309440612793  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.335362911224365  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10442590713500977  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.354437828063965  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524988174438477  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.921483516693115  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10458230972290039  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.909889698028564  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526704788208008  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.075692653656006  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10470771789550781  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.780720233917236  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03715740889310837 |0.014709144830703735 |0.42814458906650543 |9.85562801361084e-05 |0.7547202557325363 |0.00589299201965332 |
----------------------------------------------------------pseudo_mini_loss sum 1.3353856801986694
Total (block generation + training)time/epoch 93.84736722707748
Training time/epoch 39.575706243515015
Training time without block to device /epoch 39.105013608932495
Training time without total dataloading part /epoch 37.860721826553345
load block tensor time/epoch 1.1890370845794678
block to device time/epoch 0.47069263458251953
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  8791476
Number of first layer input nodes during this epoch:  4679290
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12217187881469727  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02498340606689453
random selection method range initialization spend 0.007326602935791016
time for parepare:  0.020700931549072266
local_output_nid generation:  0.0014145374298095703
local_in_edges_tensor generation:  0.006704092025756836
mini_batch_src_global generation:  0.0022661685943603516
r_  generation:  0.010492563247680664
local_output_nid generation:  0.0016286373138427734
local_in_edges_tensor generation:  0.0009915828704833984
mini_batch_src_global generation:  0.0016586780548095703
r_  generation:  0.01026010513305664
local_output_nid generation:  0.0016794204711914062
local_in_edges_tensor generation:  0.0009443759918212891
mini_batch_src_global generation:  0.001165628433227539
r_  generation:  0.00997018814086914
local_output_nid generation:  0.0016634464263916016
local_in_edges_tensor generation:  0.0009126663208007812
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.009834527969360352
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0008676052093505859
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.009812116622924805
local_output_nid generation:  0.0016131401062011719
local_in_edges_tensor generation:  0.0008738040924072266
mini_batch_src_global generation:  0.0011246204376220703
r_  generation:  0.010045289993286133
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.00128936767578125
r_  generation:  0.01061391830444336
local_output_nid generation:  0.001608133316040039
local_in_edges_tensor generation:  0.0008776187896728516
mini_batch_src_global generation:  0.001130819320678711
r_  generation:  0.009986639022827148
local_output_nid generation:  0.001627206802368164
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.010360479354858398
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0012292861938476562
r_  generation:  0.010602235794067383
local_output_nid generation:  0.0015850067138671875
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0012197494506835938
r_  generation:  0.010402441024780273
local_output_nid generation:  0.0016276836395263672
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0012009143829345703
r_  generation:  0.010237693786621094
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0008516311645507812
mini_batch_src_global generation:  0.0011928081512451172
r_  generation:  0.010474920272827148
local_output_nid generation:  0.0015969276428222656
local_in_edges_tensor generation:  0.0008871555328369141
mini_batch_src_global generation:  0.0012233257293701172
r_  generation:  0.010325908660888672
local_output_nid generation:  0.0016016960144042969
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.0011851787567138672
r_  generation:  0.010040044784545898
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.010199785232543945
local_output_nid generation:  0.0015690326690673828
local_in_edges_tensor generation:  0.0008761882781982422
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.010387897491455078
local_output_nid generation:  0.0016224384307861328
local_in_edges_tensor generation:  0.0008757114410400391
mini_batch_src_global generation:  0.0011043548583984375
r_  generation:  0.009899616241455078
local_output_nid generation:  0.001573801040649414
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.010615348815917969
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.0008699893951416016
mini_batch_src_global generation:  0.0011136531829833984
r_  generation:  0.01012277603149414
local_output_nid generation:  0.0016293525695800781
local_in_edges_tensor generation:  0.0008664131164550781
mini_batch_src_global generation:  0.0011093616485595703
r_  generation:  0.010135412216186523
local_output_nid generation:  0.0016388893127441406
local_in_edges_tensor generation:  0.0008633136749267578
mini_batch_src_global generation:  0.0011141300201416016
r_  generation:  0.010115623474121094
local_output_nid generation:  0.001590728759765625
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.010379791259765625
local_output_nid generation:  0.0016007423400878906
local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.0011677742004394531
r_  generation:  0.010474443435668945
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008652210235595703
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.009825706481933594
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.0011801719665527344
r_  generation:  0.010843515396118164
local_output_nid generation:  0.0016245841979980469
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.010175704956054688
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.0008723735809326172
mini_batch_src_global generation:  0.0011150836944580078
r_  generation:  0.010248899459838867
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008585453033447266
mini_batch_src_global generation:  0.0011425018310546875
r_  generation:  0.010175466537475586
local_output_nid generation:  0.0015673637390136719
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.0011525154113769531
r_  generation:  0.010309696197509766
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0011742115020751953
r_  generation:  0.010640382766723633
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.00086212158203125
mini_batch_src_global generation:  0.0011911392211914062
r_  generation:  0.009892463684082031
----------------------check_connections_block total spend ----------------------------- 0.5668637752532959
generate_one_block  0.02295708656311035
generate_one_block  0.020687103271484375
generate_one_block  0.017893314361572266
generate_one_block  0.017411470413208008
generate_one_block  0.01734137535095215
generate_one_block  0.017372608184814453
generate_one_block  0.01806187629699707
generate_one_block  0.017066001892089844
generate_one_block  0.017584562301635742
generate_one_block  0.01812601089477539
generate_one_block  0.017601966857910156
generate_one_block  0.020299673080444336
generate_one_block  0.01843571662902832
generate_one_block  0.01748061180114746
generate_one_block  0.016983747482299805
generate_one_block  0.017304182052612305
generate_one_block  0.017619609832763672
generate_one_block  0.016910791397094727
generate_one_block  0.017956256866455078
generate_one_block  0.017200469970703125
generate_one_block  0.016920804977416992
generate_one_block  0.01713848114013672
generate_one_block  0.01748204231262207
generate_one_block  0.017628192901611328
generate_one_block  0.01660013198852539
generate_one_block  0.01813960075378418
generate_one_block  0.01717090606689453
generate_one_block  0.017151594161987305
generate_one_block  0.016994714736938477
generate_one_block  0.017259836196899414
generate_one_block  0.017808198928833008
generate_one_block  0.016616344451904297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040265560150146484
gen group dst list time:  0.0230252742767334
time for parepare:  0.021919965744018555
local_output_nid generation:  0.00616002082824707
local_in_edges_tensor generation:  0.01742839813232422
mini_batch_src_global generation:  0.014277219772338867
r_  generation:  0.1345992088317871
local_output_nid generation:  0.009005546569824219
local_in_edges_tensor generation:  0.010990381240844727
mini_batch_src_global generation:  0.01796412467956543
r_  generation:  0.14223003387451172
local_output_nid generation:  0.009296178817749023
local_in_edges_tensor generation:  0.032016754150390625
mini_batch_src_global generation:  0.020871639251708984
r_  generation:  0.17616629600524902
local_output_nid generation:  0.009268522262573242
local_in_edges_tensor generation:  0.009107828140258789
mini_batch_src_global generation:  0.03240704536437988
r_  generation:  0.14836668968200684
local_output_nid generation:  0.009322404861450195
local_in_edges_tensor generation:  0.01091146469116211
mini_batch_src_global generation:  0.018747329711914062
r_  generation:  0.1503899097442627
local_output_nid generation:  0.009196758270263672
local_in_edges_tensor generation:  0.01019597053527832
mini_batch_src_global generation:  0.018240690231323242
r_  generation:  0.15120768547058105
local_output_nid generation:  0.009122848510742188
local_in_edges_tensor generation:  0.011333227157592773
mini_batch_src_global generation:  0.02008986473083496
r_  generation:  0.18741059303283691
local_output_nid generation:  0.011842489242553711
local_in_edges_tensor generation:  0.009077072143554688
mini_batch_src_global generation:  0.022004127502441406
r_  generation:  0.15060853958129883
local_output_nid generation:  0.008942365646362305
local_in_edges_tensor generation:  0.009225606918334961
mini_batch_src_global generation:  0.019841670989990234
r_  generation:  0.15503931045532227
local_output_nid generation:  0.009620904922485352
local_in_edges_tensor generation:  0.009354352951049805
mini_batch_src_global generation:  0.020550966262817383
r_  generation:  0.18732047080993652
local_output_nid generation:  0.014801979064941406
local_in_edges_tensor generation:  0.014961719512939453
mini_batch_src_global generation:  0.0296018123626709
r_  generation:  0.15883231163024902
local_output_nid generation:  0.011962413787841797
local_in_edges_tensor generation:  0.010985851287841797
mini_batch_src_global generation:  0.018758296966552734
r_  generation:  0.15274477005004883
local_output_nid generation:  0.011737823486328125
local_in_edges_tensor generation:  0.008798360824584961
mini_batch_src_global generation:  0.01934361457824707
r_  generation:  0.16009044647216797
local_output_nid generation:  0.009634256362915039
local_in_edges_tensor generation:  0.00834202766418457
mini_batch_src_global generation:  0.018962383270263672
r_  generation:  0.15741348266601562
local_output_nid generation:  0.009297609329223633
local_in_edges_tensor generation:  0.008156538009643555
mini_batch_src_global generation:  0.01866745948791504
r_  generation:  0.15599322319030762
local_output_nid generation:  0.009311199188232422
local_in_edges_tensor generation:  0.00824880599975586
mini_batch_src_global generation:  0.01882314682006836
r_  generation:  0.15692615509033203
local_output_nid generation:  0.009296417236328125
local_in_edges_tensor generation:  0.009752273559570312
mini_batch_src_global generation:  0.01942920684814453
r_  generation:  0.16226744651794434
local_output_nid generation:  0.009156465530395508
local_in_edges_tensor generation:  0.012089967727661133
mini_batch_src_global generation:  0.021161556243896484
r_  generation:  0.1533668041229248
local_output_nid generation:  0.010358095169067383
local_in_edges_tensor generation:  0.011586666107177734
mini_batch_src_global generation:  0.019606590270996094
r_  generation:  0.16384291648864746
local_output_nid generation:  0.009940624237060547
local_in_edges_tensor generation:  0.009107112884521484
mini_batch_src_global generation:  0.032674551010131836
r_  generation:  0.15872550010681152
local_output_nid generation:  0.009109258651733398
local_in_edges_tensor generation:  0.00886082649230957
mini_batch_src_global generation:  0.018877267837524414
r_  generation:  0.15622234344482422
local_output_nid generation:  0.00919961929321289
local_in_edges_tensor generation:  0.012041807174682617
mini_batch_src_global generation:  0.019161701202392578
r_  generation:  0.1579127311706543
local_output_nid generation:  0.009311199188232422
local_in_edges_tensor generation:  0.009864091873168945
mini_batch_src_global generation:  0.0208890438079834
r_  generation:  0.16186785697937012
local_output_nid generation:  0.011812448501586914
local_in_edges_tensor generation:  0.010346174240112305
mini_batch_src_global generation:  0.021391630172729492
r_  generation:  0.16011619567871094
local_output_nid generation:  0.00911092758178711
local_in_edges_tensor generation:  0.010310173034667969
mini_batch_src_global generation:  0.01886439323425293
r_  generation:  0.14884614944458008
local_output_nid generation:  0.009852409362792969
local_in_edges_tensor generation:  0.008770227432250977
mini_batch_src_global generation:  0.019828319549560547
r_  generation:  0.16231942176818848
local_output_nid generation:  0.009352684020996094
local_in_edges_tensor generation:  0.00842142105102539
mini_batch_src_global generation:  0.019116878509521484
r_  generation:  0.15369129180908203
local_output_nid generation:  0.009357690811157227
local_in_edges_tensor generation:  0.008439779281616211
mini_batch_src_global generation:  0.018488407135009766
r_  generation:  0.1542501449584961
local_output_nid generation:  0.009398221969604492
local_in_edges_tensor generation:  0.008409500122070312
mini_batch_src_global generation:  0.018992185592651367
r_  generation:  0.1539318561553955
local_output_nid generation:  0.009592533111572266
local_in_edges_tensor generation:  0.008517026901245117
mini_batch_src_global generation:  0.019191503524780273
r_  generation:  0.15718650817871094
local_output_nid generation:  0.009781837463378906
local_in_edges_tensor generation:  0.010324239730834961
mini_batch_src_global generation:  0.019434690475463867
r_  generation:  0.16034793853759766
local_output_nid generation:  0.009161710739135742
local_in_edges_tensor generation:  0.008211851119995117
mini_batch_src_global generation:  0.018250703811645508
r_  generation:  0.15033674240112305
----------------------check_connections_block total spend ----------------------------- 7.544816493988037
generate_one_block  0.20880699157714844
generate_one_block  0.19777917861938477
generate_one_block  0.19795536994934082
generate_one_block  0.1981964111328125
generate_one_block  0.21792173385620117
generate_one_block  0.20133638381958008
generate_one_block  0.2103414535522461
generate_one_block  0.199782133102417
generate_one_block  0.20627999305725098
generate_one_block  0.21231746673583984
generate_one_block  0.21470332145690918
generate_one_block  0.20939874649047852
generate_one_block  0.22264480590820312
generate_one_block  0.20451140403747559
generate_one_block  0.20098638534545898
generate_one_block  0.20388174057006836
generate_one_block  0.21076440811157227
generate_one_block  0.20159578323364258
generate_one_block  0.21147418022155762
generate_one_block  0.20882606506347656
generate_one_block  0.20289897918701172
generate_one_block  0.20675277709960938
generate_one_block  0.2109684944152832
generate_one_block  0.21607756614685059
generate_one_block  0.19998621940612793
generate_one_block  0.21569037437438965
generate_one_block  0.20537042617797852
generate_one_block  0.20432543754577637
generate_one_block  0.20438885688781738
generate_one_block  0.20782923698425293
generate_one_block  0.21567726135253906
generate_one_block  0.19771933555603027
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037030696868896484
gen group dst list time:  0.11032295227050781
time for parepare:  0.02129077911376953
local_output_nid generation:  0.02510237693786621
local_in_edges_tensor generation:  0.04776287078857422
mini_batch_src_global generation:  0.03733539581298828
r_  generation:  0.4010593891143799
local_output_nid generation:  0.02959156036376953
local_in_edges_tensor generation:  0.032468318939208984
mini_batch_src_global generation:  0.04813838005065918
r_  generation:  0.39936351776123047
local_output_nid generation:  0.029515504837036133
local_in_edges_tensor generation:  0.02843952178955078
mini_batch_src_global generation:  0.04601764678955078
r_  generation:  0.41167497634887695
local_output_nid generation:  0.029608964920043945
local_in_edges_tensor generation:  0.026036739349365234
mini_batch_src_global generation:  0.05037331581115723
r_  generation:  0.40860462188720703
local_output_nid generation:  0.029697418212890625
local_in_edges_tensor generation:  0.029070138931274414
mini_batch_src_global generation:  0.047652244567871094
r_  generation:  0.42654848098754883
local_output_nid generation:  0.02943873405456543
local_in_edges_tensor generation:  0.02548956871032715
mini_batch_src_global generation:  0.05220317840576172
r_  generation:  0.41088414192199707
local_output_nid generation:  0.027884960174560547
local_in_edges_tensor generation:  0.029471874237060547
mini_batch_src_global generation:  0.04809260368347168
r_  generation:  0.42738962173461914
local_output_nid generation:  0.027922391891479492
local_in_edges_tensor generation:  0.02708268165588379
mini_batch_src_global generation:  0.051152706146240234
r_  generation:  0.4075040817260742
local_output_nid generation:  0.02767801284790039
local_in_edges_tensor generation:  0.03128504753112793
mini_batch_src_global generation:  0.047312259674072266
r_  generation:  0.4224436283111572
local_output_nid generation:  0.02810072898864746
local_in_edges_tensor generation:  0.03154277801513672
mini_batch_src_global generation:  0.053394317626953125
r_  generation:  0.4175286293029785
local_output_nid generation:  0.027803659439086914
local_in_edges_tensor generation:  0.03431820869445801
mini_batch_src_global generation:  0.04812026023864746
r_  generation:  0.4251682758331299
local_output_nid generation:  0.02785515785217285
local_in_edges_tensor generation:  0.029036760330200195
mini_batch_src_global generation:  0.049395084381103516
r_  generation:  0.4098775386810303
local_output_nid generation:  0.028075218200683594
local_in_edges_tensor generation:  0.026027917861938477
mini_batch_src_global generation:  0.050595760345458984
r_  generation:  0.4218451976776123
local_output_nid generation:  0.02803659439086914
local_in_edges_tensor generation:  0.027402877807617188
mini_batch_src_global generation:  0.04931211471557617
r_  generation:  0.40956664085388184
local_output_nid generation:  0.028078079223632812
local_in_edges_tensor generation:  0.02718186378479004
mini_batch_src_global generation:  0.047364234924316406
r_  generation:  0.41956424713134766
local_output_nid generation:  0.02782464027404785
local_in_edges_tensor generation:  0.03085613250732422
mini_batch_src_global generation:  0.04919552803039551
r_  generation:  0.41188883781433105
local_output_nid generation:  0.02887439727783203
local_in_edges_tensor generation:  0.02943897247314453
mini_batch_src_global generation:  0.04904341697692871
r_  generation:  0.428483247756958
local_output_nid generation:  0.027625560760498047
local_in_edges_tensor generation:  0.033344268798828125
mini_batch_src_global generation:  0.05493783950805664
r_  generation:  0.4081604480743408
local_output_nid generation:  0.030271530151367188
local_in_edges_tensor generation:  0.027835607528686523
mini_batch_src_global generation:  0.04807734489440918
r_  generation:  0.4251589775085449
local_output_nid generation:  0.028456449508666992
local_in_edges_tensor generation:  0.02717876434326172
mini_batch_src_global generation:  0.04951071739196777
r_  generation:  0.40701913833618164
local_output_nid generation:  0.028159141540527344
local_in_edges_tensor generation:  0.025654315948486328
mini_batch_src_global generation:  0.04730415344238281
r_  generation:  0.42101573944091797
local_output_nid generation:  0.028569936752319336
local_in_edges_tensor generation:  0.026753664016723633
mini_batch_src_global generation:  0.04992413520812988
r_  generation:  0.4109625816345215
local_output_nid generation:  0.028509855270385742
local_in_edges_tensor generation:  0.02733612060546875
mini_batch_src_global generation:  0.04904508590698242
r_  generation:  0.42229413986206055
local_output_nid generation:  0.028691768646240234
local_in_edges_tensor generation:  0.02877497673034668
mini_batch_src_global generation:  0.050057411193847656
r_  generation:  0.4188878536224365
local_output_nid generation:  0.028208255767822266
local_in_edges_tensor generation:  0.025823116302490234
mini_batch_src_global generation:  0.0473484992980957
r_  generation:  0.41376376152038574
local_output_nid generation:  0.028756380081176758
local_in_edges_tensor generation:  0.02610301971435547
mini_batch_src_global generation:  0.04996371269226074
r_  generation:  0.41548633575439453
local_output_nid generation:  0.028700590133666992
local_in_edges_tensor generation:  0.02715611457824707
mini_batch_src_global generation:  0.047478437423706055
r_  generation:  0.41948962211608887
local_output_nid generation:  0.028600454330444336
local_in_edges_tensor generation:  0.027523040771484375
mini_batch_src_global generation:  0.04935932159423828
r_  generation:  0.4237086772918701
local_output_nid generation:  0.028432130813598633
local_in_edges_tensor generation:  0.025476455688476562
mini_batch_src_global generation:  0.04695868492126465
r_  generation:  0.4246327877044678
local_output_nid generation:  0.028850317001342773
local_in_edges_tensor generation:  0.027220726013183594
mini_batch_src_global generation:  0.05023312568664551
r_  generation:  0.41327428817749023
local_output_nid generation:  0.028961181640625
local_in_edges_tensor generation:  0.02790093421936035
mini_batch_src_global generation:  0.049585819244384766
r_  generation:  0.4267106056213379
local_output_nid generation:  0.028334856033325195
local_in_edges_tensor generation:  0.02728271484375
mini_batch_src_global generation:  0.049201250076293945
r_  generation:  0.40865564346313477
----------------------check_connections_block total spend ----------------------------- 19.66526174545288
generate_one_block  0.5627868175506592
generate_one_block  0.5498700141906738
generate_one_block  0.5500283241271973
generate_one_block  0.5525619983673096
generate_one_block  0.6548664569854736
generate_one_block  0.5558028221130371
generate_one_block  0.5626378059387207
generate_one_block  0.5491814613342285
generate_one_block  0.5547561645507812
generate_one_block  0.5736615657806396
generate_one_block  0.5617105960845947
generate_one_block  0.5477747917175293
generate_one_block  0.5565764904022217
generate_one_block  0.5507626533508301
generate_one_block  0.5530705451965332
generate_one_block  0.5516557693481445
generate_one_block  0.5595972537994385
generate_one_block  0.5486490726470947
generate_one_block  0.557776927947998
generate_one_block  0.5533323287963867
generate_one_block  0.5618894100189209
generate_one_block  0.5540342330932617
generate_one_block  0.5622434616088867
generate_one_block  0.5640277862548828
generate_one_block  0.5591864585876465
generate_one_block  0.5628714561462402
generate_one_block  0.5576591491699219
generate_one_block  0.5500500202178955
generate_one_block  0.5493733882904053
generate_one_block  0.5617656707763672
generate_one_block  0.5732192993164062
generate_one_block  0.5531027317047119
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12217187881469727  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  27.210078239440918
block generation total time  24.54367184638977
average batch blocks generation time:  0.7669897451996803
block dataloader generation time/epoch 54.67628633058988
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10518074035644531  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.606236934661865  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10465764999389648  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.660215854644775  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10519075393676758  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.63309144973755  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10463285446166992  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.73722267150879  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523748397827148  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.873422145843506  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1045083999633789  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.83800172805786  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10532474517822266  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.26260471343994  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10452032089233398  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.72585105895996  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527658462524414  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.078319549560547  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10504293441772461  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.386319160461426  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10529518127441406  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.184938430786133  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10463428497314453  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.758659839630127  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10529708862304688  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.18632411956787  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10467195510864258  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.838850498199463  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10518789291381836  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.631251335144043  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10449934005737305  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.753026485443115  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527849197387695  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.156575202941895  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10441970825195312  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.589534759521484  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1053018569946289  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.122154235839844  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10475587844848633  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.753719806671143  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521411895751953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.727548122406006  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1046600341796875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.006062507629395  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527324676513672  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.10340976715088  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10480690002441406  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.214609146118164  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10516214370727539  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.44412326812744  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10489320755004883  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.392230987548828  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10522890090942383  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.853447914123535  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10456275939941406  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.76343822479248  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523605346679688  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.8715763092041  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1050262451171875  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.1550350189209  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10531473159790039  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.327774047851562  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10433387756347656  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.466763019561768  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03532864898443222 |0.014082200825214386 |0.4194781258702278 |9.470432996749878e-05 |0.7584470883011818 |0.004385948181152344 |
----------------------------------------------------------pseudo_mini_loss sum 1.320754885673523
Total (block generation + training)time/epoch 93.87637664721562
Training time/epoch 39.34250211715698
Training time without block to device /epoch 38.89187169075012
Training time without total dataloading part /epoch 37.70102334022522
load block tensor time/epoch 1.130516767501831
block to device time/epoch 0.45063042640686035
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  8793743
Number of first layer input nodes during this epoch:  4680677
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12288618087768555  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024073123931884766
random selection method range initialization spend 0.005205631256103516
time for parepare:  0.018787860870361328
local_output_nid generation:  0.0014369487762451172
local_in_edges_tensor generation:  0.006223917007446289
mini_batch_src_global generation:  0.0015151500701904297
r_  generation:  0.010137081146240234
local_output_nid generation:  0.0016219615936279297
local_in_edges_tensor generation:  0.0010406970977783203
mini_batch_src_global generation:  0.0014989376068115234
r_  generation:  0.009806394577026367
local_output_nid generation:  0.0016074180603027344
local_in_edges_tensor generation:  0.0009744167327880859
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.009911060333251953
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0009322166442871094
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.00983572006225586
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009279251098632812
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.009811878204345703
local_output_nid generation:  0.0015568733215332031
local_in_edges_tensor generation:  0.0009224414825439453
mini_batch_src_global generation:  0.0011012554168701172
r_  generation:  0.009755849838256836
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.009901046752929688
local_output_nid generation:  0.0015861988067626953
local_in_edges_tensor generation:  0.0009300708770751953
mini_batch_src_global generation:  0.001199483871459961
r_  generation:  0.010261297225952148
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0009033679962158203
mini_batch_src_global generation:  0.0011124610900878906
r_  generation:  0.010101318359375
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0008940696716308594
mini_batch_src_global generation:  0.0010936260223388672
r_  generation:  0.009669303894042969
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.001132965087890625
r_  generation:  0.010073184967041016
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.001154184341430664
r_  generation:  0.010476350784301758
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0008723735809326172
mini_batch_src_global generation:  0.0010933876037597656
r_  generation:  0.010188102722167969
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.0012087821960449219
r_  generation:  0.009967327117919922
local_output_nid generation:  0.0015716552734375
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.001146554946899414
r_  generation:  0.009804725646972656
local_output_nid generation:  0.0016188621520996094
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.00113677978515625
r_  generation:  0.010257482528686523
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0008795261383056641
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.010070085525512695
local_output_nid generation:  0.0015575885772705078
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.0011630058288574219
r_  generation:  0.010483980178833008
local_output_nid generation:  0.0016057491302490234
local_in_edges_tensor generation:  0.0009126663208007812
mini_batch_src_global generation:  0.0011773109436035156
r_  generation:  0.010100841522216797
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.001195669174194336
r_  generation:  0.010487794876098633
local_output_nid generation:  0.001580953598022461
local_in_edges_tensor generation:  0.000888824462890625
mini_batch_src_global generation:  0.0011470317840576172
r_  generation:  0.01024317741394043
local_output_nid generation:  0.0016064643859863281
local_in_edges_tensor generation:  0.0009052753448486328
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.01042032241821289
local_output_nid generation:  0.0015635490417480469
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0011985301971435547
r_  generation:  0.010385274887084961
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0008690357208251953
mini_batch_src_global generation:  0.0011317729949951172
r_  generation:  0.010039329528808594
local_output_nid generation:  0.001596212387084961
local_in_edges_tensor generation:  0.0008864402770996094
mini_batch_src_global generation:  0.0011348724365234375
r_  generation:  0.010360956192016602
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0008726119995117188
mini_batch_src_global generation:  0.001161336898803711
r_  generation:  0.010005712509155273
local_output_nid generation:  0.0015490055084228516
local_in_edges_tensor generation:  0.0008459091186523438
mini_batch_src_global generation:  0.001161336898803711
r_  generation:  0.010332584381103516
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.010107278823852539
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0008716583251953125
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.009877681732177734
local_output_nid generation:  0.0015785694122314453
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.0011763572692871094
r_  generation:  0.010573387145996094
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0008745193481445312
mini_batch_src_global generation:  0.0012161731719970703
r_  generation:  0.009923458099365234
local_output_nid generation:  0.001558065414428711
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0011258125305175781
r_  generation:  0.010197162628173828
----------------------check_connections_block total spend ----------------------------- 0.558483362197876
generate_one_block  0.0190122127532959
generate_one_block  0.020041942596435547
generate_one_block  0.018290996551513672
generate_one_block  0.017888307571411133
generate_one_block  0.01749897003173828
generate_one_block  0.017102956771850586
generate_one_block  0.016939640045166016
generate_one_block  0.017597675323486328
generate_one_block  0.017299890518188477
generate_one_block  0.01671743392944336
generate_one_block  0.01730179786682129
generate_one_block  0.02075672149658203
generate_one_block  0.018184661865234375
generate_one_block  0.017247676849365234
generate_one_block  0.01686263084411621
generate_one_block  0.017510414123535156
generate_one_block  0.016946792602539062
generate_one_block  0.017801523208618164
generate_one_block  0.01721358299255371
generate_one_block  0.0175631046295166
generate_one_block  0.017213821411132812
generate_one_block  0.017485618591308594
generate_one_block  0.017633914947509766
generate_one_block  0.01681804656982422
generate_one_block  0.017575740814208984
generate_one_block  0.016776084899902344
generate_one_block  0.01756119728088379
generate_one_block  0.017261743545532227
generate_one_block  0.016622543334960938
generate_one_block  0.017711162567138672
generate_one_block  0.01687455177307129
generate_one_block  0.017246007919311523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037217140197753906
gen group dst list time:  0.01990795135498047
time for parepare:  0.01949453353881836
local_output_nid generation:  0.005923748016357422
local_in_edges_tensor generation:  0.017865657806396484
mini_batch_src_global generation:  0.013810396194458008
r_  generation:  0.12894010543823242
local_output_nid generation:  0.0086669921875
local_in_edges_tensor generation:  0.010727882385253906
mini_batch_src_global generation:  0.017557382583618164
r_  generation:  0.13724708557128906
local_output_nid generation:  0.00923609733581543
local_in_edges_tensor generation:  0.032959938049316406
mini_batch_src_global generation:  0.017213821411132812
r_  generation:  0.14656972885131836
local_output_nid generation:  0.009261608123779297
local_in_edges_tensor generation:  0.010981082916259766
mini_batch_src_global generation:  0.01772284507751465
r_  generation:  0.14857244491577148
local_output_nid generation:  0.009264469146728516
local_in_edges_tensor generation:  0.01086735725402832
mini_batch_src_global generation:  0.0184934139251709
r_  generation:  0.14811062812805176
local_output_nid generation:  0.008819341659545898
local_in_edges_tensor generation:  0.0083465576171875
mini_batch_src_global generation:  0.0176699161529541
r_  generation:  0.14740991592407227
local_output_nid generation:  0.008572578430175781
local_in_edges_tensor generation:  0.008344650268554688
mini_batch_src_global generation:  0.01824665069580078
r_  generation:  0.1474921703338623
local_output_nid generation:  0.008943796157836914
local_in_edges_tensor generation:  0.009630441665649414
mini_batch_src_global generation:  0.019551753997802734
r_  generation:  0.15467476844787598
local_output_nid generation:  0.00873708724975586
local_in_edges_tensor generation:  0.008341312408447266
mini_batch_src_global generation:  0.018744945526123047
r_  generation:  0.15056896209716797
local_output_nid generation:  0.009023427963256836
local_in_edges_tensor generation:  0.008992671966552734
mini_batch_src_global generation:  0.01798391342163086
r_  generation:  0.14605498313903809
local_output_nid generation:  0.009217977523803711
local_in_edges_tensor generation:  0.008616924285888672
mini_batch_src_global generation:  0.019176483154296875
r_  generation:  0.15453481674194336
local_output_nid generation:  0.00955653190612793
local_in_edges_tensor generation:  0.009955167770385742
mini_batch_src_global generation:  0.019809246063232422
r_  generation:  0.15464520454406738
local_output_nid generation:  0.009404659271240234
local_in_edges_tensor generation:  0.008402109146118164
mini_batch_src_global generation:  0.018900632858276367
r_  generation:  0.1533491611480713
local_output_nid generation:  0.009187936782836914
local_in_edges_tensor generation:  0.00827932357788086
mini_batch_src_global generation:  0.0184628963470459
r_  generation:  0.14968013763427734
local_output_nid generation:  0.009083747863769531
local_in_edges_tensor generation:  0.008186101913452148
mini_batch_src_global generation:  0.018247127532958984
r_  generation:  0.14986944198608398
local_output_nid generation:  0.00932002067565918
local_in_edges_tensor generation:  0.008523225784301758
mini_batch_src_global generation:  0.018772125244140625
r_  generation:  0.15623116493225098
local_output_nid generation:  0.008930206298828125
local_in_edges_tensor generation:  0.008296728134155273
mini_batch_src_global generation:  0.019547224044799805
r_  generation:  0.15032696723937988
local_output_nid generation:  0.009588241577148438
local_in_edges_tensor generation:  0.008491754531860352
mini_batch_src_global generation:  0.01924920082092285
r_  generation:  0.15639877319335938
local_output_nid generation:  0.009302616119384766
local_in_edges_tensor generation:  0.008472204208374023
mini_batch_src_global generation:  0.019994497299194336
r_  generation:  0.15241098403930664
local_output_nid generation:  0.00947713851928711
local_in_edges_tensor generation:  0.00933694839477539
mini_batch_src_global generation:  0.019080638885498047
r_  generation:  0.1549520492553711
local_output_nid generation:  0.009335994720458984
local_in_edges_tensor generation:  0.008754730224609375
mini_batch_src_global generation:  0.019062280654907227
r_  generation:  0.15316057205200195
local_output_nid generation:  0.009419918060302734
local_in_edges_tensor generation:  0.008462667465209961
mini_batch_src_global generation:  0.018514394760131836
r_  generation:  0.15289521217346191
local_output_nid generation:  0.009491682052612305
local_in_edges_tensor generation:  0.0095977783203125
mini_batch_src_global generation:  0.01911449432373047
r_  generation:  0.15541911125183105
local_output_nid generation:  0.009079456329345703
local_in_edges_tensor generation:  0.008394241333007812
mini_batch_src_global generation:  0.018383264541625977
r_  generation:  0.15158867835998535
local_output_nid generation:  0.009444952011108398
local_in_edges_tensor generation:  0.008628606796264648
mini_batch_src_global generation:  0.019216299057006836
r_  generation:  0.1592097282409668
local_output_nid generation:  0.010158538818359375
local_in_edges_tensor generation:  0.012587547302246094
mini_batch_src_global generation:  0.01852560043334961
r_  generation:  0.15433287620544434
local_output_nid generation:  0.009407997131347656
local_in_edges_tensor generation:  0.009413957595825195
mini_batch_src_global generation:  0.018787622451782227
r_  generation:  0.15555024147033691
local_output_nid generation:  0.009405374526977539
local_in_edges_tensor generation:  0.00908041000366211
mini_batch_src_global generation:  0.01871967315673828
r_  generation:  0.158217191696167
local_output_nid generation:  0.00904393196105957
local_in_edges_tensor generation:  0.009015798568725586
mini_batch_src_global generation:  0.018569469451904297
r_  generation:  0.14933037757873535
local_output_nid generation:  0.009556293487548828
local_in_edges_tensor generation:  0.008603096008300781
mini_batch_src_global generation:  0.01929187774658203
r_  generation:  0.15970849990844727
local_output_nid generation:  0.009161949157714844
local_in_edges_tensor generation:  0.008764266967773438
mini_batch_src_global generation:  0.01880502700805664
r_  generation:  0.15117383003234863
local_output_nid generation:  0.009363651275634766
local_in_edges_tensor generation:  0.009168863296508789
mini_batch_src_global generation:  0.01952648162841797
r_  generation:  0.15453457832336426
----------------------check_connections_block total spend ----------------------------- 7.2001214027404785
generate_one_block  0.19537138938903809
generate_one_block  0.1956484317779541
generate_one_block  0.2037663459777832
generate_one_block  0.20603108406066895
generate_one_block  0.21470117568969727
generate_one_block  0.19841575622558594
generate_one_block  0.1976330280303955
generate_one_block  0.20740151405334473
generate_one_block  0.19998383522033691
generate_one_block  0.19178342819213867
generate_one_block  0.2038884162902832
generate_one_block  0.20780110359191895
generate_one_block  0.20045161247253418
generate_one_block  0.20007729530334473
generate_one_block  0.19525384902954102
generate_one_block  0.2043895721435547
generate_one_block  0.1970815658569336
generate_one_block  0.2080073356628418
generate_one_block  0.20284533500671387
generate_one_block  0.2071704864501953
generate_one_block  0.19954395294189453
generate_one_block  0.20173311233520508
generate_one_block  0.205108642578125
generate_one_block  0.19790363311767578
generate_one_block  0.20201730728149414
generate_one_block  0.20108604431152344
generate_one_block  0.20309710502624512
generate_one_block  0.20436525344848633
generate_one_block  0.1927351951599121
generate_one_block  0.21184086799621582
generate_one_block  0.19644522666931152
generate_one_block  0.2021801471710205
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03173637390136719
gen group dst list time:  0.09683656692504883
time for parepare:  0.01983785629272461
local_output_nid generation:  0.02306652069091797
local_in_edges_tensor generation:  0.03821730613708496
mini_batch_src_global generation:  0.03691697120666504
r_  generation:  0.3946511745452881
local_output_nid generation:  0.028847694396972656
local_in_edges_tensor generation:  0.03241133689880371
mini_batch_src_global generation:  0.04761385917663574
r_  generation:  0.40426015853881836
local_output_nid generation:  0.029584169387817383
local_in_edges_tensor generation:  0.02699899673461914
mini_batch_src_global generation:  0.048084259033203125
r_  generation:  0.40918660163879395
local_output_nid generation:  0.029550552368164062
local_in_edges_tensor generation:  0.031014442443847656
mini_batch_src_global generation:  0.04834938049316406
r_  generation:  0.40387701988220215
local_output_nid generation:  0.029294729232788086
local_in_edges_tensor generation:  0.028855323791503906
mini_batch_src_global generation:  0.04871487617492676
r_  generation:  0.4168996810913086
local_output_nid generation:  0.029537677764892578
local_in_edges_tensor generation:  0.027225732803344727
mini_batch_src_global generation:  0.048492431640625
r_  generation:  0.40520811080932617
local_output_nid generation:  0.027464628219604492
local_in_edges_tensor generation:  0.025156736373901367
mini_batch_src_global generation:  0.047745704650878906
r_  generation:  0.4125187397003174
local_output_nid generation:  0.027715444564819336
local_in_edges_tensor generation:  0.030658245086669922
mini_batch_src_global generation:  0.04953789710998535
r_  generation:  0.41399121284484863
local_output_nid generation:  0.02746129035949707
local_in_edges_tensor generation:  0.02826523780822754
mini_batch_src_global generation:  0.0474855899810791
r_  generation:  0.41045713424682617
local_output_nid generation:  0.027201175689697266
local_in_edges_tensor generation:  0.025504350662231445
mini_batch_src_global generation:  0.04902458190917969
r_  generation:  0.4148545265197754
local_output_nid generation:  0.02766108512878418
local_in_edges_tensor generation:  0.025942325592041016
mini_batch_src_global generation:  0.047272682189941406
r_  generation:  0.42111897468566895
local_output_nid generation:  0.02776646614074707
local_in_edges_tensor generation:  0.030856609344482422
mini_batch_src_global generation:  0.0492243766784668
r_  generation:  0.41042208671569824
local_output_nid generation:  0.027645111083984375
local_in_edges_tensor generation:  0.027135848999023438
mini_batch_src_global generation:  0.05402374267578125
r_  generation:  0.41887497901916504
local_output_nid generation:  0.02906322479248047
local_in_edges_tensor generation:  0.025806427001953125
mini_batch_src_global generation:  0.04907965660095215
r_  generation:  0.40875673294067383
local_output_nid generation:  0.02824544906616211
local_in_edges_tensor generation:  0.02758622169494629
mini_batch_src_global generation:  0.04674267768859863
r_  generation:  0.4128091335296631
local_output_nid generation:  0.028383970260620117
local_in_edges_tensor generation:  0.025041580200195312
mini_batch_src_global generation:  0.04950380325317383
r_  generation:  0.40938282012939453
local_output_nid generation:  0.028117656707763672
local_in_edges_tensor generation:  0.02728271484375
mini_batch_src_global generation:  0.049001455307006836
r_  generation:  0.4203031063079834
local_output_nid generation:  0.029197216033935547
local_in_edges_tensor generation:  0.026606082916259766
mini_batch_src_global generation:  0.04963278770446777
r_  generation:  0.40770721435546875
local_output_nid generation:  0.02823328971862793
local_in_edges_tensor generation:  0.02714824676513672
mini_batch_src_global generation:  0.047115325927734375
r_  generation:  0.4136655330657959
local_output_nid generation:  0.028456449508666992
local_in_edges_tensor generation:  0.025057554244995117
mini_batch_src_global generation:  0.04948258399963379
r_  generation:  0.41379332542419434
local_output_nid generation:  0.029996633529663086
local_in_edges_tensor generation:  0.025789976119995117
mini_batch_src_global generation:  0.047193288803100586
r_  generation:  0.4137146472930908
local_output_nid generation:  0.028401851654052734
local_in_edges_tensor generation:  0.027315378189086914
mini_batch_src_global generation:  0.051136016845703125
r_  generation:  0.40715813636779785
local_output_nid generation:  0.02869701385498047
local_in_edges_tensor generation:  0.030475139617919922
mini_batch_src_global generation:  0.04744720458984375
r_  generation:  0.42592620849609375
local_output_nid generation:  0.02812361717224121
local_in_edges_tensor generation:  0.027134180068969727
mini_batch_src_global generation:  0.04991745948791504
r_  generation:  0.4085538387298584
local_output_nid generation:  0.028337717056274414
local_in_edges_tensor generation:  0.025918960571289062
mini_batch_src_global generation:  0.04707837104797363
r_  generation:  0.41526341438293457
local_output_nid generation:  0.02810811996459961
local_in_edges_tensor generation:  0.02469801902770996
mini_batch_src_global generation:  0.04898500442504883
r_  generation:  0.41371583938598633
local_output_nid generation:  0.028499841690063477
local_in_edges_tensor generation:  0.029467344284057617
mini_batch_src_global generation:  0.04716658592224121
r_  generation:  0.4226949214935303
local_output_nid generation:  0.028261661529541016
local_in_edges_tensor generation:  0.026582002639770508
mini_batch_src_global generation:  0.05100440979003906
r_  generation:  0.40842723846435547
local_output_nid generation:  0.02806711196899414
local_in_edges_tensor generation:  0.026051998138427734
mini_batch_src_global generation:  0.047243595123291016
r_  generation:  0.4175255298614502
local_output_nid generation:  0.028497695922851562
local_in_edges_tensor generation:  0.02569270133972168
mini_batch_src_global generation:  0.04942750930786133
r_  generation:  0.4148402214050293
local_output_nid generation:  0.02828502655029297
local_in_edges_tensor generation:  0.02520751953125
mini_batch_src_global generation:  0.046726226806640625
r_  generation:  0.41351938247680664
local_output_nid generation:  0.028494834899902344
local_in_edges_tensor generation:  0.025653600692749023
mini_batch_src_global generation:  0.05069851875305176
r_  generation:  0.41403841972351074
----------------------check_connections_block total spend ----------------------------- 19.463526725769043
generate_one_block  0.5482733249664307
generate_one_block  0.5370407104492188
generate_one_block  0.5440347194671631
generate_one_block  0.5482773780822754
generate_one_block  0.6346235275268555
generate_one_block  0.5488896369934082
generate_one_block  0.545243501663208
generate_one_block  0.5569534301757812
generate_one_block  0.5441076755523682
generate_one_block  0.5380349159240723
generate_one_block  0.5550289154052734
generate_one_block  0.5557243824005127
generate_one_block  0.5520172119140625
generate_one_block  0.5420198440551758
generate_one_block  0.5428023338317871
generate_one_block  0.5511777400970459
generate_one_block  0.5526964664459229
generate_one_block  0.553170919418335
generate_one_block  0.5536165237426758
generate_one_block  0.5493645668029785
generate_one_block  0.5485680103302002
generate_one_block  0.5515341758728027
generate_one_block  0.5567522048950195
generate_one_block  0.5435612201690674
generate_one_block  0.5667750835418701
generate_one_block  0.5495786666870117
generate_one_block  0.5517885684967041
generate_one_block  0.5502655506134033
generate_one_block  0.5397157669067383
generate_one_block  0.559326171875
generate_one_block  0.5454940795898438
generate_one_block  0.5600142478942871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12288618087768555  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  26.66364812850952
block generation total time  24.132230520248413
average batch blocks generation time:  0.7541322037577629
block dataloader generation time/epoch 54.60723468235561
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10516595840454102  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.51533842086792  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10434913635253906  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.607067584991455  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052694320678711  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.956465244293213  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1044621467590332  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.04760980606079  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524463653564453  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.010951042175293  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1045832633972168  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.935999393463135  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521554946899414  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.806880474090576  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10507726669311523  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.279115676879883  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523366928100586  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.809975147247314  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10450363159179688  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.496838092803955  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527515411376953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.133464336395264  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10509061813354492  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.187520027160645  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524797439575195  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.042896270751953  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10442543029785156  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.73926305770874  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1051936149597168  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.65215253829956  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10465717315673828  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.070096492767334  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521459579467773  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.71887445449829  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10469532012939453  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.155256748199463  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524988174438477  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.005427360534668  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10467720031738281  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.11418390274048  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10525131225585938  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.9851131439209  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1047825813293457  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.895196437835693  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528707504272461  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.212780952453613  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10442876815795898  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.719383716583252  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526466369628906  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.95802879333496  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10450410842895508  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.913504123687744  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526084899902344  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.99412202835083  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10465288162231445  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.039459705352783  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10516595840454102  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.547157764434814  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10484981536865234  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.35517120361328  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10519981384277344  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.68117332458496  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10489892959594727  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.929367065429688  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033879369497299194 |0.012641362845897675 |0.4169604927301407 |9.167194366455078e-05 |0.7588076367974281 |0.005780458450317383 |
----------------------------------------------------------pseudo_mini_loss sum 1.3019465208053589
Total (block generation + training)time/epoch 93.80562554086957
Training time/epoch 39.17605924606323
Training time without block to device /epoch 38.77153563499451
Training time without total dataloading part /epoch 37.633294105529785
load block tensor time/epoch 1.0841398239135742
block to device time/epoch 0.4045236110687256
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  8792684
Number of first layer input nodes during this epoch:  4680173
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12349605560302734  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024770498275756836
random selection method range initialization spend 0.006605625152587891
time for parepare:  0.019280672073364258
local_output_nid generation:  0.0013954639434814453
local_in_edges_tensor generation:  0.005372524261474609
mini_batch_src_global generation:  0.0022230148315429688
r_  generation:  0.012172698974609375
local_output_nid generation:  0.0017101764678955078
local_in_edges_tensor generation:  0.0010433197021484375
mini_batch_src_global generation:  0.0014524459838867188
r_  generation:  0.01014566421508789
local_output_nid generation:  0.0016503334045410156
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0011966228485107422
r_  generation:  0.010010957717895508
local_output_nid generation:  0.0016255378723144531
local_in_edges_tensor generation:  0.0008573532104492188
mini_batch_src_global generation:  0.0011589527130126953
r_  generation:  0.00965571403503418
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0009157657623291016
mini_batch_src_global generation:  0.0011866092681884766
r_  generation:  0.010036945343017578
local_output_nid generation:  0.0015673637390136719
local_in_edges_tensor generation:  0.0008637905120849609
mini_batch_src_global generation:  0.0011317729949951172
r_  generation:  0.009695291519165039
local_output_nid generation:  0.001611471176147461
local_in_edges_tensor generation:  0.0008702278137207031
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.009662628173828125
local_output_nid generation:  0.0015556812286376953
local_in_edges_tensor generation:  0.0008640289306640625
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.009867429733276367
local_output_nid generation:  0.0015633106231689453
local_in_edges_tensor generation:  0.0008542537689208984
mini_batch_src_global generation:  0.001157522201538086
r_  generation:  0.010108470916748047
local_output_nid generation:  0.0015716552734375
local_in_edges_tensor generation:  0.0008869171142578125
mini_batch_src_global generation:  0.0011320114135742188
r_  generation:  0.009770393371582031
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.0008614063262939453
mini_batch_src_global generation:  0.0011241436004638672
r_  generation:  0.00983572006225586
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0008449554443359375
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.014167547225952148
local_output_nid generation:  0.0016279220581054688
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0013303756713867188
r_  generation:  0.010729074478149414
local_output_nid generation:  0.0016093254089355469
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0012259483337402344
r_  generation:  0.010272026062011719
local_output_nid generation:  0.0015673637390136719
local_in_edges_tensor generation:  0.0008661746978759766
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.010114192962646484
local_output_nid generation:  0.0015621185302734375
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.0011866092681884766
r_  generation:  0.01011204719543457
local_output_nid generation:  0.0015633106231689453
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0011916160583496094
r_  generation:  0.010004520416259766
local_output_nid generation:  0.0015499591827392578
local_in_edges_tensor generation:  0.0008726119995117188
mini_batch_src_global generation:  0.001215219497680664
r_  generation:  0.010167121887207031
local_output_nid generation:  0.0015642642974853516
local_in_edges_tensor generation:  0.0008537769317626953
mini_batch_src_global generation:  0.0011112689971923828
r_  generation:  0.00973057746887207
local_output_nid generation:  0.0015587806701660156
local_in_edges_tensor generation:  0.0008690357208251953
mini_batch_src_global generation:  0.0011513233184814453
r_  generation:  0.010094881057739258
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.010473251342773438
local_output_nid generation:  0.0016183853149414062
local_in_edges_tensor generation:  0.0008432865142822266
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.010155439376831055
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0008478164672851562
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.009901046752929688
local_output_nid generation:  0.0015404224395751953
local_in_edges_tensor generation:  0.0008578300476074219
mini_batch_src_global generation:  0.0011761188507080078
r_  generation:  0.010097265243530273
local_output_nid generation:  0.0015358924865722656
local_in_edges_tensor generation:  0.0008869171142578125
mini_batch_src_global generation:  0.0011744499206542969
r_  generation:  0.009997844696044922
local_output_nid generation:  0.0015518665313720703
local_in_edges_tensor generation:  0.0008485317230224609
mini_batch_src_global generation:  0.0011470317840576172
r_  generation:  0.009993314743041992
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0008373260498046875
mini_batch_src_global generation:  0.0011477470397949219
r_  generation:  0.012530088424682617
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.010238885879516602
local_output_nid generation:  0.0015587806701660156
local_in_edges_tensor generation:  0.0008661746978759766
mini_batch_src_global generation:  0.0011696815490722656
r_  generation:  0.01041412353515625
local_output_nid generation:  0.001544952392578125
local_in_edges_tensor generation:  0.0008511543273925781
mini_batch_src_global generation:  0.0011725425720214844
r_  generation:  0.010055065155029297
local_output_nid generation:  0.0015506744384765625
local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.009936094284057617
local_output_nid generation:  0.0015418529510498047
local_in_edges_tensor generation:  0.0008313655853271484
mini_batch_src_global generation:  0.0011744499206542969
r_  generation:  0.010097265243530273
----------------------check_connections_block total spend ----------------------------- 0.5652220249176025
generate_one_block  0.02032303810119629
generate_one_block  0.02021169662475586
generate_one_block  0.017939090728759766
generate_one_block  0.017242431640625
generate_one_block  0.01749134063720703
generate_one_block  0.01688981056213379
generate_one_block  0.016613006591796875
generate_one_block  0.016993045806884766
generate_one_block  0.017217397689819336
generate_one_block  0.016644001007080078
generate_one_block  0.016646146774291992
generate_one_block  0.02141094207763672
generate_one_block  0.021962881088256836
generate_one_block  0.017883777618408203
generate_one_block  0.017008543014526367
generate_one_block  0.017184972763061523
generate_one_block  0.016775131225585938
generate_one_block  0.017137527465820312
generate_one_block  0.016300678253173828
generate_one_block  0.017041921615600586
generate_one_block  0.017709016799926758
generate_one_block  0.01726818084716797
generate_one_block  0.016757965087890625
generate_one_block  0.01690077781677246
generate_one_block  0.01686716079711914
generate_one_block  0.01690530776977539
generate_one_block  0.017023563385009766
generate_one_block  0.017026901245117188
generate_one_block  0.01740550994873047
generate_one_block  0.01696014404296875
generate_one_block  0.016709089279174805
generate_one_block  0.016980648040771484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036417245864868164
gen group dst list time:  0.022539854049682617
time for parepare:  0.01936507225036621
local_output_nid generation:  0.0065937042236328125
local_in_edges_tensor generation:  0.018854141235351562
mini_batch_src_global generation:  0.016663551330566406
r_  generation:  0.14656805992126465
local_output_nid generation:  0.00909876823425293
local_in_edges_tensor generation:  0.011080741882324219
mini_batch_src_global generation:  0.020618677139282227
r_  generation:  0.14381885528564453
local_output_nid generation:  0.009213685989379883
local_in_edges_tensor generation:  0.03289198875427246
mini_batch_src_global generation:  0.01635909080505371
r_  generation:  0.14451217651367188
local_output_nid generation:  0.009285449981689453
local_in_edges_tensor generation:  0.008832931518554688
mini_batch_src_global generation:  0.017654895782470703
r_  generation:  0.14706897735595703
local_output_nid generation:  0.009161710739135742
local_in_edges_tensor generation:  0.010335206985473633
mini_batch_src_global generation:  0.019912004470825195
r_  generation:  0.15300869941711426
local_output_nid generation:  0.00868082046508789
local_in_edges_tensor generation:  0.010653972625732422
mini_batch_src_global generation:  0.021744966506958008
r_  generation:  0.14713764190673828
local_output_nid generation:  0.008570432662963867
local_in_edges_tensor generation:  0.010484457015991211
mini_batch_src_global generation:  0.01818227767944336
r_  generation:  0.14422202110290527
local_output_nid generation:  0.008765220642089844
local_in_edges_tensor generation:  0.008541584014892578
mini_batch_src_global generation:  0.018503665924072266
r_  generation:  0.15131855010986328
local_output_nid generation:  0.008920907974243164
local_in_edges_tensor generation:  0.009114265441894531
mini_batch_src_global generation:  0.03064441680908203
r_  generation:  0.17356228828430176
local_output_nid generation:  0.014219522476196289
local_in_edges_tensor generation:  0.011417627334594727
mini_batch_src_global generation:  0.02242279052734375
r_  generation:  0.16288232803344727
local_output_nid generation:  0.014477729797363281
local_in_edges_tensor generation:  0.01139378547668457
mini_batch_src_global generation:  0.02246856689453125
r_  generation:  0.16707229614257812
local_output_nid generation:  0.015595436096191406
local_in_edges_tensor generation:  0.015032768249511719
mini_batch_src_global generation:  0.0249786376953125
r_  generation:  0.1836833953857422
local_output_nid generation:  0.01532602310180664
local_in_edges_tensor generation:  0.011977434158325195
mini_batch_src_global generation:  0.024083852767944336
r_  generation:  0.1761322021484375
local_output_nid generation:  0.012468099594116211
local_in_edges_tensor generation:  0.011304616928100586
mini_batch_src_global generation:  0.030910015106201172
r_  generation:  0.17431926727294922
local_output_nid generation:  0.014261007308959961
local_in_edges_tensor generation:  0.012301206588745117
mini_batch_src_global generation:  0.022891759872436523
r_  generation:  0.1667783260345459
local_output_nid generation:  0.01475667953491211
local_in_edges_tensor generation:  0.011640548706054688
mini_batch_src_global generation:  0.022374391555786133
r_  generation:  0.1701953411102295
local_output_nid generation:  0.014481306076049805
local_in_edges_tensor generation:  0.012150764465332031
mini_batch_src_global generation:  0.0224306583404541
r_  generation:  0.1730654239654541
local_output_nid generation:  0.012231826782226562
local_in_edges_tensor generation:  0.010402202606201172
mini_batch_src_global generation:  0.029500961303710938
r_  generation:  0.17025971412658691
local_output_nid generation:  0.014127969741821289
local_in_edges_tensor generation:  0.011517763137817383
mini_batch_src_global generation:  0.021700382232666016
r_  generation:  0.16916227340698242
local_output_nid generation:  0.014986991882324219
local_in_edges_tensor generation:  0.015651226043701172
mini_batch_src_global generation:  0.04515981674194336
r_  generation:  0.18134665489196777
local_output_nid generation:  0.013515233993530273
local_in_edges_tensor generation:  0.010395526885986328
mini_batch_src_global generation:  0.026114702224731445
r_  generation:  0.17822027206420898
local_output_nid generation:  0.010573863983154297
local_in_edges_tensor generation:  0.009757757186889648
mini_batch_src_global generation:  0.023496150970458984
r_  generation:  0.1721642017364502
local_output_nid generation:  0.009720563888549805
local_in_edges_tensor generation:  0.008726119995117188
mini_batch_src_global generation:  0.022658109664916992
r_  generation:  0.16737103462219238
local_output_nid generation:  0.009707450866699219
local_in_edges_tensor generation:  0.00856161117553711
mini_batch_src_global generation:  0.022721052169799805
r_  generation:  0.16841912269592285
local_output_nid generation:  0.009423255920410156
local_in_edges_tensor generation:  0.008397579193115234
mini_batch_src_global generation:  0.022206544876098633
r_  generation:  0.16791129112243652
local_output_nid generation:  0.00941777229309082
local_in_edges_tensor generation:  0.008315086364746094
mini_batch_src_global generation:  0.022472620010375977
r_  generation:  0.1859419345855713
local_output_nid generation:  0.009964704513549805
local_in_edges_tensor generation:  0.008278846740722656
mini_batch_src_global generation:  0.023033618927001953
r_  generation:  0.16979217529296875
local_output_nid generation:  0.009483575820922852
local_in_edges_tensor generation:  0.008677482604980469
mini_batch_src_global generation:  0.02293109893798828
r_  generation:  0.177382230758667
local_output_nid generation:  0.009461641311645508
local_in_edges_tensor generation:  0.009586811065673828
mini_batch_src_global generation:  0.022495508193969727
r_  generation:  0.17626523971557617
local_output_nid generation:  0.009253263473510742
local_in_edges_tensor generation:  0.00944972038269043
mini_batch_src_global generation:  0.022813796997070312
r_  generation:  0.17066383361816406
local_output_nid generation:  0.010706424713134766
local_in_edges_tensor generation:  0.008328676223754883
mini_batch_src_global generation:  0.022246599197387695
r_  generation:  0.1712336540222168
local_output_nid generation:  0.009362936019897461
local_in_edges_tensor generation:  0.008435249328613281
mini_batch_src_global generation:  0.02277517318725586
r_  generation:  0.16967082023620605
----------------------check_connections_block total spend ----------------------------- 8.108568668365479
generate_one_block  0.22849559783935547
generate_one_block  0.2138514518737793
generate_one_block  0.21103525161743164
generate_one_block  0.20656132698059082
generate_one_block  0.22721552848815918
generate_one_block  0.2008364200592041
generate_one_block  0.19839239120483398
generate_one_block  0.20779657363891602
generate_one_block  0.2094860076904297
generate_one_block  0.19707345962524414
generate_one_block  0.20049118995666504
generate_one_block  0.22359085083007812
generate_one_block  0.22104811668395996
generate_one_block  0.2228717803955078
generate_one_block  0.20803475379943848
generate_one_block  0.2115917205810547
generate_one_block  0.20767593383789062
generate_one_block  0.213822603225708
generate_one_block  0.20032382011413574
generate_one_block  0.2065117359161377
generate_one_block  0.21743535995483398
generate_one_block  0.21275854110717773
generate_one_block  0.20242094993591309
generate_one_block  0.2074112892150879
generate_one_block  0.20427441596984863
generate_one_block  0.20554542541503906
generate_one_block  0.20795440673828125
generate_one_block  0.2074909210205078
generate_one_block  0.21665358543395996
generate_one_block  0.22264337539672852
generate_one_block  0.20522737503051758
generate_one_block  0.20801544189453125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034628868103027344
gen group dst list time:  0.10844182968139648
time for parepare:  0.020090341567993164
local_output_nid generation:  0.027892589569091797
local_in_edges_tensor generation:  0.04877614974975586
mini_batch_src_global generation:  0.03793978691101074
r_  generation:  0.41646766662597656
local_output_nid generation:  0.030699968338012695
local_in_edges_tensor generation:  0.035629987716674805
mini_batch_src_global generation:  0.050640106201171875
r_  generation:  0.4060344696044922
local_output_nid generation:  0.03023672103881836
local_in_edges_tensor generation:  0.0321042537689209
mini_batch_src_global generation:  0.048171043395996094
r_  generation:  0.4212191104888916
local_output_nid generation:  0.032778263092041016
local_in_edges_tensor generation:  0.027916908264160156
mini_batch_src_global generation:  0.051119089126586914
r_  generation:  0.41362714767456055
local_output_nid generation:  0.03188967704772949
local_in_edges_tensor generation:  0.03357267379760742
mini_batch_src_global generation:  0.047791242599487305
r_  generation:  0.42357325553894043
local_output_nid generation:  0.03217506408691406
local_in_edges_tensor generation:  0.027559757232666016
mini_batch_src_global generation:  0.050112009048461914
r_  generation:  0.41893863677978516
local_output_nid generation:  0.0324251651763916
local_in_edges_tensor generation:  0.025992393493652344
mini_batch_src_global generation:  0.0479283332824707
r_  generation:  0.4155564308166504
local_output_nid generation:  0.028803586959838867
local_in_edges_tensor generation:  0.025207042694091797
mini_batch_src_global generation:  0.049425601959228516
r_  generation:  0.4091665744781494
local_output_nid generation:  0.02915191650390625
local_in_edges_tensor generation:  0.028400182723999023
mini_batch_src_global generation:  0.04810738563537598
r_  generation:  0.42119932174682617
local_output_nid generation:  0.0285491943359375
local_in_edges_tensor generation:  0.025768756866455078
mini_batch_src_global generation:  0.0518956184387207
r_  generation:  0.40427446365356445
local_output_nid generation:  0.028653383255004883
local_in_edges_tensor generation:  0.028944730758666992
mini_batch_src_global generation:  0.0491330623626709
r_  generation:  0.4162261486053467
local_output_nid generation:  0.028975725173950195
local_in_edges_tensor generation:  0.027153730392456055
mini_batch_src_global generation:  0.04968857765197754
r_  generation:  0.41335105895996094
local_output_nid generation:  0.02903914451599121
local_in_edges_tensor generation:  0.02758932113647461
mini_batch_src_global generation:  0.048014163970947266
r_  generation:  0.42327117919921875
local_output_nid generation:  0.02908182144165039
local_in_edges_tensor generation:  0.02799510955810547
mini_batch_src_global generation:  0.05158114433288574
r_  generation:  0.4176344871520996
local_output_nid generation:  0.028617143630981445
local_in_edges_tensor generation:  0.025790929794311523
mini_batch_src_global generation:  0.04736471176147461
r_  generation:  0.41523313522338867
local_output_nid generation:  0.028818368911743164
local_in_edges_tensor generation:  0.02723383903503418
mini_batch_src_global generation:  0.05065417289733887
r_  generation:  0.4100067615509033
local_output_nid generation:  0.028761625289916992
local_in_edges_tensor generation:  0.030100107192993164
mini_batch_src_global generation:  0.04742741584777832
r_  generation:  0.4153778553009033
local_output_nid generation:  0.028696775436401367
local_in_edges_tensor generation:  0.02922654151916504
mini_batch_src_global generation:  0.05053853988647461
r_  generation:  0.40971946716308594
local_output_nid generation:  0.028601408004760742
local_in_edges_tensor generation:  0.029050588607788086
mini_batch_src_global generation:  0.04907417297363281
r_  generation:  0.41616058349609375
local_output_nid generation:  0.0289154052734375
local_in_edges_tensor generation:  0.027202844619750977
mini_batch_src_global generation:  0.05037736892700195
r_  generation:  0.41203975677490234
local_output_nid generation:  0.02982020378112793
local_in_edges_tensor generation:  0.03125
mini_batch_src_global generation:  0.0491185188293457
r_  generation:  0.42693209648132324
local_output_nid generation:  0.029134273529052734
local_in_edges_tensor generation:  0.03333544731140137
mini_batch_src_global generation:  0.049501657485961914
r_  generation:  0.4166386127471924
local_output_nid generation:  0.029392480850219727
local_in_edges_tensor generation:  0.02587413787841797
mini_batch_src_global generation:  0.04711437225341797
r_  generation:  0.41652417182922363
local_output_nid generation:  0.028432130813598633
local_in_edges_tensor generation:  0.029344558715820312
mini_batch_src_global generation:  0.04898500442504883
r_  generation:  0.4103069305419922
local_output_nid generation:  0.028497934341430664
local_in_edges_tensor generation:  0.02553081512451172
mini_batch_src_global generation:  0.04680180549621582
r_  generation:  0.4176614284515381
local_output_nid generation:  0.029018640518188477
local_in_edges_tensor generation:  0.025606393814086914
mini_batch_src_global generation:  0.04883742332458496
r_  generation:  0.42703962326049805
local_output_nid generation:  0.030254602432250977
local_in_edges_tensor generation:  0.028464794158935547
mini_batch_src_global generation:  0.04872465133666992
r_  generation:  0.42284512519836426
local_output_nid generation:  0.029488563537597656
local_in_edges_tensor generation:  0.029194355010986328
mini_batch_src_global generation:  0.049455881118774414
r_  generation:  0.41243720054626465
local_output_nid generation:  0.02884507179260254
local_in_edges_tensor generation:  0.025957345962524414
mini_batch_src_global generation:  0.049102067947387695
r_  generation:  0.4219183921813965
local_output_nid generation:  0.028867721557617188
local_in_edges_tensor generation:  0.02632451057434082
mini_batch_src_global generation:  0.049152374267578125
r_  generation:  0.4123506546020508
local_output_nid generation:  0.028649091720581055
local_in_edges_tensor generation:  0.026001930236816406
mini_batch_src_global generation:  0.0476994514465332
r_  generation:  0.4232327938079834
local_output_nid generation:  0.02873373031616211
local_in_edges_tensor generation:  0.025525331497192383
mini_batch_src_global generation:  0.049147605895996094
r_  generation:  0.41242384910583496
----------------------check_connections_block total spend ----------------------------- 19.71682381629944
generate_one_block  0.5799815654754639
generate_one_block  0.5571765899658203
generate_one_block  0.5472404956817627
generate_one_block  0.5527374744415283
generate_one_block  0.6600985527038574
generate_one_block  0.5629823207855225
generate_one_block  0.5433695316314697
generate_one_block  0.5567328929901123
generate_one_block  0.5608155727386475
generate_one_block  0.5441629886627197
generate_one_block  0.5527987480163574
generate_one_block  0.5632672309875488
generate_one_block  0.5583040714263916
generate_one_block  0.5647947788238525
generate_one_block  0.5516641139984131
generate_one_block  0.5548579692840576
generate_one_block  0.54620361328125
generate_one_block  0.5516328811645508
generate_one_block  0.5575137138366699
generate_one_block  0.5560944080352783
generate_one_block  0.5777955055236816
generate_one_block  0.5668673515319824
generate_one_block  0.5485043525695801
generate_one_block  0.5525734424591064
generate_one_block  0.5689826011657715
generate_one_block  0.5534000396728516
generate_one_block  0.5552475452423096
generate_one_block  0.5631566047668457
generate_one_block  0.558586597442627
generate_one_block  0.5546603202819824
generate_one_block  0.5535156726837158
generate_one_block  0.5578806400299072
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12349605560302734  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

connection checking time:  27.825392484664917
block generation total time  24.668137788772583
average batch blocks generation time:  0.7708793058991432
block dataloader generation time/epoch 54.66719085375468
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10535717010498047  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.42473030090332  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10486125946044922  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.00116205215454  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523080825805664  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.78803062438965  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10471439361572266  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.01947021484375  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528564453125  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.124935150146484  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10454225540161133  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.649813652038574  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10515403747558594  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.473150730133057  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10444450378417969  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.01611042022705  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527372360229492  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.05735206604004  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10455656051635742  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.514811515808105  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10520076751708984  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.732803344726562  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10480451583862305  GigaBytes
Max Memory Allocated: 17.59412145614624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.681291580200195  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1053156852722168  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.28432607650757  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1049656867980957  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.283202171325684  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10518646240234375  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.570425987243652  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10474967956542969  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.085845947265625  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10520696640014648  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.701494693756104  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10458517074584961  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.832940578460693  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10513496398925781  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.387370586395264  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10476398468017578  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.68688726425171  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10533428192138672  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.31594228744507  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1048288345336914  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.135749340057373  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10520267486572266  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.649649143218994  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10447120666503906  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.943108558654785  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10522174835205078  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.846567630767822  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10455608367919922  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.80494213104248  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10525083541870117  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.034364700317383  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1049947738647461  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.947102069854736  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527849197387695  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.101025104522705  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10467147827148438  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.931591987609863  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10520029067993164  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.694559574127197  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10455513000488281  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.833908081054688  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03705832362174988 |0.016315706074237823 |0.4192291349172592 |9.379535913467407e-05 |0.7583310902118683 |0.005281209945678711 |
----------------------------------------------------------pseudo_mini_loss sum 1.2900546789169312
Total (block generation + training)time/epoch 93.88234505653381
Training time/epoch 39.44958472251892
Training time without block to device /epoch 38.92748212814331
Training time without total dataloading part /epoch 37.69020986557007
load block tensor time/epoch 1.185866355895996
block to device time/epoch 0.5221025943756104
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  8794415
Number of first layer input nodes during this epoch:  4680309
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12297582626342773  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02599930763244629
random selection method range initialization spend 0.005644559860229492
time for parepare:  0.023836612701416016
local_output_nid generation:  0.001848459243774414
local_in_edges_tensor generation:  0.005307197570800781
mini_batch_src_global generation:  0.004596710205078125
r_  generation:  0.009411811828613281
local_output_nid generation:  0.0018002986907958984
local_in_edges_tensor generation:  0.001257181167602539
mini_batch_src_global generation:  0.0020873546600341797
r_  generation:  0.011163711547851562
local_output_nid generation:  0.002027750015258789
local_in_edges_tensor generation:  0.0012240409851074219
mini_batch_src_global generation:  0.0014903545379638672
r_  generation:  0.010286569595336914
local_output_nid generation:  0.0021200180053710938
local_in_edges_tensor generation:  0.0012028217315673828
mini_batch_src_global generation:  0.0014412403106689453
r_  generation:  0.010345697402954102
local_output_nid generation:  0.0021774768829345703
local_in_edges_tensor generation:  0.0011916160583496094
mini_batch_src_global generation:  0.0013573169708251953
r_  generation:  0.010112285614013672
local_output_nid generation:  0.002200603485107422
local_in_edges_tensor generation:  0.0011715888977050781
mini_batch_src_global generation:  0.0014467239379882812
r_  generation:  0.010571718215942383
local_output_nid generation:  0.0022220611572265625
local_in_edges_tensor generation:  0.0011746883392333984
mini_batch_src_global generation:  0.001384735107421875
r_  generation:  0.020859479904174805
local_output_nid generation:  0.0025589466094970703
local_in_edges_tensor generation:  0.0012273788452148438
mini_batch_src_global generation:  0.0016558170318603516
r_  generation:  0.010047197341918945
local_output_nid generation:  0.002102375030517578
local_in_edges_tensor generation:  0.001039266586303711
mini_batch_src_global generation:  0.001499176025390625
r_  generation:  0.010418176651000977
local_output_nid generation:  0.0019779205322265625
local_in_edges_tensor generation:  0.0009932518005371094
mini_batch_src_global generation:  0.0012178421020507812
r_  generation:  0.010015726089477539
local_output_nid generation:  0.0019643306732177734
local_in_edges_tensor generation:  0.0010552406311035156
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.010531187057495117
local_output_nid generation:  0.0018932819366455078
local_in_edges_tensor generation:  0.0010073184967041016
mini_batch_src_global generation:  0.001201629638671875
r_  generation:  0.010283708572387695
local_output_nid generation:  0.001836538314819336
local_in_edges_tensor generation:  0.0009772777557373047
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.0109405517578125
local_output_nid generation:  0.001827239990234375
local_in_edges_tensor generation:  0.0009424686431884766
mini_batch_src_global generation:  0.0011208057403564453
r_  generation:  0.010106563568115234
local_output_nid generation:  0.0018448829650878906
local_in_edges_tensor generation:  0.0010173320770263672
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.010566949844360352
local_output_nid generation:  0.001806020736694336
local_in_edges_tensor generation:  0.0009183883666992188
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.010012149810791016
local_output_nid generation:  0.0017812252044677734
local_in_edges_tensor generation:  0.0009360313415527344
mini_batch_src_global generation:  0.0010666847229003906
r_  generation:  0.010074853897094727
local_output_nid generation:  0.0017955303192138672
local_in_edges_tensor generation:  0.0009529590606689453
mini_batch_src_global generation:  0.0011796951293945312
r_  generation:  0.010855913162231445
local_output_nid generation:  0.0017354488372802734
local_in_edges_tensor generation:  0.0009381771087646484
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.010496854782104492
local_output_nid generation:  0.001718282699584961
local_in_edges_tensor generation:  0.0009186267852783203
mini_batch_src_global generation:  0.0011997222900390625
r_  generation:  0.010684967041015625
local_output_nid generation:  0.0017268657684326172
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.0011811256408691406
r_  generation:  0.010116815567016602
local_output_nid generation:  0.0016944408416748047
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0011799335479736328
r_  generation:  0.010404348373413086
local_output_nid generation:  0.0016818046569824219
local_in_edges_tensor generation:  0.0009148120880126953
mini_batch_src_global generation:  0.0010988712310791016
r_  generation:  0.010245800018310547
local_output_nid generation:  0.0016689300537109375
local_in_edges_tensor generation:  0.00089263916015625
mini_batch_src_global generation:  0.0010898113250732422
r_  generation:  0.010368824005126953
local_output_nid generation:  0.0016613006591796875
local_in_edges_tensor generation:  0.0009076595306396484
mini_batch_src_global generation:  0.0011370182037353516
r_  generation:  0.010062932968139648
local_output_nid generation:  0.0016436576843261719
local_in_edges_tensor generation:  0.0008711814880371094
mini_batch_src_global generation:  0.0010709762573242188
r_  generation:  0.010236978530883789
local_output_nid generation:  0.0016548633575439453
local_in_edges_tensor generation:  0.0008761882781982422
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.01303720474243164
local_output_nid generation:  0.0017290115356445312
local_in_edges_tensor generation:  0.0008871555328369141
mini_batch_src_global generation:  0.0011451244354248047
r_  generation:  0.01071023941040039
local_output_nid generation:  0.0016319751739501953
local_in_edges_tensor generation:  0.0008738040924072266
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.01044774055480957
local_output_nid generation:  0.0016241073608398438
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.009851932525634766
local_output_nid generation:  0.0016703605651855469
local_in_edges_tensor generation:  0.0008740425109863281
mini_batch_src_global generation:  0.0010809898376464844
r_  generation:  0.010284662246704102
local_output_nid generation:  0.0016069412231445312
local_in_edges_tensor generation:  0.0009493827819824219
mini_batch_src_global generation:  0.0011713504791259766
r_  generation:  0.010158777236938477
----------------------check_connections_block total spend ----------------------------- 0.6090974807739258
generate_one_block  0.02808690071105957
generate_one_block  0.02144479751586914
generate_one_block  0.018541812896728516
generate_one_block  0.01815199851989746
generate_one_block  0.017598628997802734
generate_one_block  0.02045750617980957
generate_one_block  0.01900005340576172
generate_one_block  0.01691889762878418
generate_one_block  0.017558574676513672
generate_one_block  0.017316341400146484
generate_one_block  0.017585039138793945
generate_one_block  0.02311110496520996
generate_one_block  0.019733190536499023
generate_one_block  0.01737070083618164
generate_one_block  0.018057823181152344
generate_one_block  0.016950130462646484
generate_one_block  0.017185211181640625
generate_one_block  0.02042531967163086
generate_one_block  0.017818212509155273
generate_one_block  0.018277645111083984
generate_one_block  0.01715087890625
generate_one_block  0.0176699161529541
generate_one_block  0.01933121681213379
generate_one_block  0.017955780029296875
generate_one_block  0.01716327667236328
generate_one_block  0.017261981964111328
generate_one_block  0.017820119857788086
generate_one_block  0.017712116241455078
generate_one_block  0.020359516143798828
generate_one_block  0.01783156394958496
generate_one_block  0.017555713653564453
generate_one_block  0.017130136489868164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.045568227767944336
gen group dst list time:  0.028779983520507812
time for parepare:  0.024723291397094727
local_output_nid generation:  0.007043123245239258
local_in_edges_tensor generation:  0.021135568618774414
mini_batch_src_global generation:  0.01641988754272461
r_  generation:  0.1388251781463623
local_output_nid generation:  0.009276390075683594
local_in_edges_tensor generation:  0.010893821716308594
mini_batch_src_global generation:  0.020192861557006836
r_  generation:  0.14777445793151855
local_output_nid generation:  0.009545564651489258
local_in_edges_tensor generation:  0.03709220886230469
mini_batch_src_global generation:  0.02236652374267578
r_  generation:  0.15015912055969238
local_output_nid generation:  0.009330272674560547
local_in_edges_tensor generation:  0.011961936950683594
mini_batch_src_global generation:  0.020242691040039062
r_  generation:  0.15424633026123047
local_output_nid generation:  0.014840841293334961
local_in_edges_tensor generation:  0.008417129516601562
mini_batch_src_global generation:  0.023025035858154297
r_  generation:  0.15188169479370117
local_output_nid generation:  0.009064912796020508
local_in_edges_tensor generation:  0.008829116821289062
mini_batch_src_global generation:  0.018980979919433594
r_  generation:  0.15052175521850586
local_output_nid generation:  0.009260177612304688
local_in_edges_tensor generation:  0.01114034652709961
mini_batch_src_global generation:  0.01996445655822754
r_  generation:  0.15454959869384766
local_output_nid generation:  0.00879669189453125
local_in_edges_tensor generation:  0.008104562759399414
mini_batch_src_global generation:  0.01869034767150879
r_  generation:  0.14643001556396484
local_output_nid generation:  0.009034156799316406
local_in_edges_tensor generation:  0.00847482681274414
mini_batch_src_global generation:  0.018950939178466797
r_  generation:  0.15383529663085938
local_output_nid generation:  0.009340047836303711
local_in_edges_tensor generation:  0.008770465850830078
mini_batch_src_global generation:  0.018648147583007812
r_  generation:  0.20859789848327637
local_output_nid generation:  0.009711265563964844
local_in_edges_tensor generation:  0.00899505615234375
mini_batch_src_global generation:  0.021872520446777344
r_  generation:  0.15666580200195312
local_output_nid generation:  0.009651660919189453
local_in_edges_tensor generation:  0.008313894271850586
mini_batch_src_global generation:  0.03577923774719238
r_  generation:  0.15423870086669922
local_output_nid generation:  0.010082244873046875
local_in_edges_tensor generation:  0.008717060089111328
mini_batch_src_global generation:  0.019711017608642578
r_  generation:  0.15976309776306152
local_output_nid generation:  0.011766195297241211
local_in_edges_tensor generation:  0.009313106536865234
mini_batch_src_global generation:  0.018796682357788086
r_  generation:  0.1559920310974121
local_output_nid generation:  0.009700536727905273
local_in_edges_tensor generation:  0.008699655532836914
mini_batch_src_global generation:  0.019188642501831055
r_  generation:  0.1595163345336914
local_output_nid generation:  0.009311199188232422
local_in_edges_tensor generation:  0.010224580764770508
mini_batch_src_global generation:  0.028988361358642578
r_  generation:  0.16712284088134766
local_output_nid generation:  0.014380216598510742
local_in_edges_tensor generation:  0.011138439178466797
mini_batch_src_global generation:  0.024941444396972656
r_  generation:  0.19262051582336426
local_output_nid generation:  0.012610912322998047
local_in_edges_tensor generation:  0.010778188705444336
mini_batch_src_global generation:  0.0218658447265625
r_  generation:  0.16408252716064453
local_output_nid generation:  0.010356903076171875
local_in_edges_tensor generation:  0.009352684020996094
mini_batch_src_global generation:  0.019400358200073242
r_  generation:  0.16013360023498535
local_output_nid generation:  0.010192632675170898
local_in_edges_tensor generation:  0.00960397720336914
mini_batch_src_global generation:  0.02164292335510254
r_  generation:  0.16117525100708008
local_output_nid generation:  0.009559869766235352
local_in_edges_tensor generation:  0.00846099853515625
mini_batch_src_global generation:  0.01928544044494629
r_  generation:  0.1540834903717041
local_output_nid generation:  0.00957632064819336
local_in_edges_tensor generation:  0.009220123291015625
mini_batch_src_global generation:  0.019292354583740234
r_  generation:  0.1574866771697998
local_output_nid generation:  0.009541034698486328
local_in_edges_tensor generation:  0.00917363166809082
mini_batch_src_global generation:  0.019144296646118164
r_  generation:  0.1553936004638672
local_output_nid generation:  0.009550333023071289
local_in_edges_tensor generation:  0.008407115936279297
mini_batch_src_global generation:  0.018859148025512695
r_  generation:  0.15441203117370605
local_output_nid generation:  0.009452342987060547
local_in_edges_tensor generation:  0.0083770751953125
mini_batch_src_global generation:  0.019409894943237305
r_  generation:  0.154310941696167
local_output_nid generation:  0.009544134140014648
local_in_edges_tensor generation:  0.008424520492553711
mini_batch_src_global generation:  0.01906561851501465
r_  generation:  0.1541450023651123
local_output_nid generation:  0.009585380554199219
local_in_edges_tensor generation:  0.0090789794921875
mini_batch_src_global generation:  0.019749164581298828
r_  generation:  0.15615153312683105
local_output_nid generation:  0.009413480758666992
local_in_edges_tensor generation:  0.009476900100708008
mini_batch_src_global generation:  0.01933574676513672
r_  generation:  0.16292119026184082
local_output_nid generation:  0.010368824005126953
local_in_edges_tensor generation:  0.008965015411376953
mini_batch_src_global generation:  0.019024372100830078
r_  generation:  0.15962886810302734
local_output_nid generation:  0.009056329727172852
local_in_edges_tensor generation:  0.013639450073242188
mini_batch_src_global generation:  0.020714282989501953
r_  generation:  0.1528792381286621
local_output_nid generation:  0.009354352951049805
local_in_edges_tensor generation:  0.008531332015991211
mini_batch_src_global generation:  0.02212047576904297
r_  generation:  0.16200757026672363
local_output_nid generation:  0.00935506820678711
local_in_edges_tensor generation:  0.009373664855957031
mini_batch_src_global generation:  0.018941402435302734
r_  generation:  0.15682625770568848
----------------------check_connections_block total spend ----------------------------- 7.588035583496094
generate_one_block  0.2144014835357666
generate_one_block  0.204207181930542
generate_one_block  0.20963335037231445
generate_one_block  0.20764803886413574
generate_one_block  0.22002744674682617
generate_one_block  0.2048642635345459
generate_one_block  0.21151947975158691
generate_one_block  0.19488000869750977
generate_one_block  0.20619535446166992
generate_one_block  0.20275306701660156
generate_one_block  0.20414471626281738
generate_one_block  0.20175695419311523
generate_one_block  0.21126484870910645
generate_one_block  0.2048053741455078
generate_one_block  0.22648859024047852
generate_one_block  0.19725370407104492
generate_one_block  0.2042407989501953
generate_one_block  0.21880197525024414
generate_one_block  0.21137666702270508
generate_one_block  0.22517037391662598
generate_one_block  0.20762395858764648
generate_one_block  0.21121811866760254
generate_one_block  0.20987224578857422
generate_one_block  0.20689702033996582
generate_one_block  0.21190190315246582
generate_one_block  0.2078390121459961
generate_one_block  0.20897865295410156
generate_one_block  0.2095789909362793
generate_one_block  0.20903253555297852
generate_one_block  0.20177268981933594
generate_one_block  0.20915913581848145
generate_one_block  0.2047131061553955
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03845930099487305
gen group dst list time:  0.11165833473205566
time for parepare:  0.020699501037597656
local_output_nid generation:  0.029395580291748047
local_in_edges_tensor generation:  0.042565107345581055
mini_batch_src_global generation:  0.0409543514251709
r_  generation:  0.4055502414703369
local_output_nid generation:  0.031877994537353516
local_in_edges_tensor generation:  0.03291463851928711
mini_batch_src_global generation:  0.050189971923828125
r_  generation:  0.40229272842407227
local_output_nid generation:  0.03075122833251953
local_in_edges_tensor generation:  0.025951385498046875
mini_batch_src_global generation:  0.04689836502075195
r_  generation:  0.41487812995910645
local_output_nid generation:  0.031062841415405273
local_in_edges_tensor generation:  0.027346134185791016
mini_batch_src_global generation:  0.05082106590270996
r_  generation:  0.410567045211792
local_output_nid generation:  0.031183719635009766
local_in_edges_tensor generation:  0.028636932373046875
mini_batch_src_global generation:  0.04777932167053223
r_  generation:  0.419954776763916
local_output_nid generation:  0.030771970748901367
local_in_edges_tensor generation:  0.027036428451538086
mini_batch_src_global generation:  0.04942035675048828
r_  generation:  0.4102613925933838
local_output_nid generation:  0.02956247329711914
local_in_edges_tensor generation:  0.029410123825073242
mini_batch_src_global generation:  0.04755663871765137
r_  generation:  0.4216017723083496
local_output_nid generation:  0.028928756713867188
local_in_edges_tensor generation:  0.026148080825805664
mini_batch_src_global generation:  0.051373958587646484
r_  generation:  0.4063591957092285
local_output_nid generation:  0.029523849487304688
local_in_edges_tensor generation:  0.025977611541748047
mini_batch_src_global generation:  0.04785609245300293
r_  generation:  0.42508673667907715
local_output_nid generation:  0.029301881790161133
local_in_edges_tensor generation:  0.030624866485595703
mini_batch_src_global generation:  0.04936623573303223
r_  generation:  0.411456823348999
local_output_nid generation:  0.029257535934448242
local_in_edges_tensor generation:  0.03085041046142578
mini_batch_src_global generation:  0.047238826751708984
r_  generation:  0.4233384132385254
local_output_nid generation:  0.029219388961791992
local_in_edges_tensor generation:  0.025349855422973633
mini_batch_src_global generation:  0.04880642890930176
r_  generation:  0.413191556930542
local_output_nid generation:  0.02989339828491211
local_in_edges_tensor generation:  0.026050806045532227
mini_batch_src_global generation:  0.04824376106262207
r_  generation:  0.42635273933410645
local_output_nid generation:  0.02955174446105957
local_in_edges_tensor generation:  0.027508258819580078
mini_batch_src_global generation:  0.04927468299865723
r_  generation:  0.4159722328186035
local_output_nid generation:  0.029470443725585938
local_in_edges_tensor generation:  0.027771711349487305
mini_batch_src_global generation:  0.05091261863708496
r_  generation:  0.4248158931732178
local_output_nid generation:  0.030141115188598633
local_in_edges_tensor generation:  0.025518178939819336
mini_batch_src_global generation:  0.050995826721191406
r_  generation:  0.4079749584197998
local_output_nid generation:  0.029655933380126953
local_in_edges_tensor generation:  0.027484416961669922
mini_batch_src_global generation:  0.048741817474365234
r_  generation:  0.41825199127197266
local_output_nid generation:  0.030055999755859375
local_in_edges_tensor generation:  0.030809879302978516
mini_batch_src_global generation:  0.04921889305114746
r_  generation:  0.4163508415222168
local_output_nid generation:  0.029640674591064453
local_in_edges_tensor generation:  0.027512311935424805
mini_batch_src_global generation:  0.04764819145202637
r_  generation:  0.41765499114990234
local_output_nid generation:  0.03008103370666504
local_in_edges_tensor generation:  0.026152372360229492
mini_batch_src_global generation:  0.04994821548461914
r_  generation:  0.4145846366882324
local_output_nid generation:  0.02955937385559082
local_in_edges_tensor generation:  0.030294418334960938
mini_batch_src_global generation:  0.04843568801879883
r_  generation:  0.4189305305480957
local_output_nid generation:  0.02932596206665039
local_in_edges_tensor generation:  0.029091358184814453
mini_batch_src_global generation:  0.0495297908782959
r_  generation:  0.41202330589294434
local_output_nid generation:  0.02955460548400879
local_in_edges_tensor generation:  0.03069138526916504
mini_batch_src_global generation:  0.04955172538757324
r_  generation:  0.4199554920196533
local_output_nid generation:  0.029262304306030273
local_in_edges_tensor generation:  0.02525043487548828
mini_batch_src_global generation:  0.050058841705322266
r_  generation:  0.4131176471710205
local_output_nid generation:  0.02941131591796875
local_in_edges_tensor generation:  0.035660505294799805
mini_batch_src_global generation:  0.04816389083862305
r_  generation:  0.4215421676635742
local_output_nid generation:  0.02942037582397461
local_in_edges_tensor generation:  0.027072906494140625
mini_batch_src_global generation:  0.050232648849487305
r_  generation:  0.41174793243408203
local_output_nid generation:  0.033475399017333984
local_in_edges_tensor generation:  0.032829999923706055
mini_batch_src_global generation:  0.05775856971740723
r_  generation:  0.4230790138244629
local_output_nid generation:  0.03011798858642578
local_in_edges_tensor generation:  0.026860475540161133
mini_batch_src_global generation:  0.051419734954833984
r_  generation:  0.4134988784790039
local_output_nid generation:  0.02951335906982422
local_in_edges_tensor generation:  0.02570199966430664
mini_batch_src_global generation:  0.048059940338134766
r_  generation:  0.4178032875061035
local_output_nid generation:  0.029453516006469727
local_in_edges_tensor generation:  0.02552199363708496
mini_batch_src_global generation:  0.04974961280822754
r_  generation:  0.411238431930542
local_output_nid generation:  0.029290199279785156
local_in_edges_tensor generation:  0.029422998428344727
mini_batch_src_global generation:  0.047487735748291016
r_  generation:  0.4196634292602539
local_output_nid generation:  0.029136180877685547
local_in_edges_tensor generation:  0.025388240814208984
mini_batch_src_global generation:  0.0491788387298584
r_  generation:  0.41066908836364746
----------------------check_connections_block total spend ----------------------------- 19.699080228805542
generate_one_block  0.5664033889770508
generate_one_block  0.5589148998260498
generate_one_block  0.5528879165649414
generate_one_block  0.5527858734130859
generate_one_block  0.6708018779754639
generate_one_block  0.5537259578704834
generate_one_block  0.5604045391082764
generate_one_block  0.5457396507263184
generate_one_block  0.5584347248077393
generate_one_block  0.5630135536193848
generate_one_block  0.5435028076171875
generate_one_block  0.5500950813293457
generate_one_block  0.5592560768127441
generate_one_block  0.5598373413085938
generate_one_block  0.5579383373260498
generate_one_block  0.5467143058776855
generate_one_block  0.5529780387878418
generate_one_block  0.5693678855895996
generate_one_block  0.5581080913543701
generate_one_block  0.5677230358123779
generate_one_block  0.5624818801879883
generate_one_block  0.5547077655792236
generate_one_block  0.5616655349731445
generate_one_block  0.5557494163513184
generate_one_block  0.5756661891937256
generate_one_block  0.5560567378997803
generate_one_block  0.5588595867156982
generate_one_block  0.5659158229827881
generate_one_block  0.5534019470214844
generate_one_block  0.5507681369781494
generate_one_block  0.5650556087493896
generate_one_block  0.5580995082855225
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12297582626342773  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

connection checking time:  27.287115812301636
block generation total time  24.647082567214966
average batch blocks generation time:  0.7702213302254677
block dataloader generation time/epoch 54.69268377125263
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1051630973815918  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.582679271697998  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10477876663208008  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.813193321228027  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052393913269043  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.845055103302002  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10435247421264648  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.071860790252686  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523843765258789  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.025792598724365  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10457992553710938  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.902746200561523  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10531234741210938  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.271554946899414  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10440874099731445  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.49623680114746  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527372360229492  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.069634914398193  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10459327697753906  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.952582359313965  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052389144897461  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.773783683776855  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10465669631958008  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.87093687057495  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.105316162109375  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.249308109283447  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1046295166015625  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.710991859436035  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527563095092773  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.113685131072998  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10446310043334961  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.303226470947266  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10522079467773438  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.764995098114014  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10518550872802734  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.4336838722229  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528802871704102  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.104640007019043  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10513019561767578  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.311538696289062  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523033142089844  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.958383560180664  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10475635528564453  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.063743591308594  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10525751113891602  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.074369430541992  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10479402542114258  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.78663682937622  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524463653564453  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.015213012695312  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10454320907592773  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.78326416015625  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526323318481445  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.988633155822754  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10464763641357422  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.00399684906006  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10525655746459961  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.929490089416504  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1045694351196289  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.523498058319092  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.105255126953125  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.969643115997314  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1044468879699707  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.666945457458496  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03241601586341858 |0.015236318111419678 |0.41530202329158783 |9.269267320632935e-05 |0.7554479017853737 |0.0045359134674072266 |
----------------------------------------------------------pseudo_mini_loss sum 1.272681713104248
Total (block generation + training)time/epoch 93.89745903015137
Training time/epoch 39.04883098602295
Training time without block to device /epoch 38.56126880645752
Training time without total dataloading part /epoch 37.47149968147278
load block tensor time/epoch 1.0373125076293945
block to device time/epoch 0.4875621795654297
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  8791819
Number of first layer input nodes during this epoch:  4680273
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12295103073120117  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028924226760864258
random selection method range initialization spend 0.006110191345214844
time for parepare:  0.023072242736816406
local_output_nid generation:  0.0018782615661621094
local_in_edges_tensor generation:  0.009050369262695312
mini_batch_src_global generation:  0.0025529861450195312
r_  generation:  0.010724306106567383
local_output_nid generation:  0.0019888877868652344
local_in_edges_tensor generation:  0.0013682842254638672
mini_batch_src_global generation:  0.0020618438720703125
r_  generation:  0.011553525924682617
local_output_nid generation:  0.0021648406982421875
local_in_edges_tensor generation:  0.0013113021850585938
mini_batch_src_global generation:  0.0016758441925048828
r_  generation:  0.010509729385375977
local_output_nid generation:  0.0022122859954833984
local_in_edges_tensor generation:  0.0012824535369873047
mini_batch_src_global generation:  0.0015926361083984375
r_  generation:  0.010718584060668945
local_output_nid generation:  0.0022575855255126953
local_in_edges_tensor generation:  0.0011894702911376953
mini_batch_src_global generation:  0.0015416145324707031
r_  generation:  0.009943008422851562
local_output_nid generation:  0.00226593017578125
local_in_edges_tensor generation:  0.0012252330780029297
mini_batch_src_global generation:  0.0014836788177490234
r_  generation:  0.01062154769897461
local_output_nid generation:  0.0022923946380615234
local_in_edges_tensor generation:  0.0012052059173583984
mini_batch_src_global generation:  0.0014615058898925781
r_  generation:  0.010511398315429688
local_output_nid generation:  0.0023076534271240234
local_in_edges_tensor generation:  0.0012366771697998047
mini_batch_src_global generation:  0.0014355182647705078
r_  generation:  0.010577201843261719
local_output_nid generation:  0.0023071765899658203
local_in_edges_tensor generation:  0.0012753009796142578
mini_batch_src_global generation:  0.0014829635620117188
r_  generation:  0.010548591613769531
local_output_nid generation:  0.0023260116577148438
local_in_edges_tensor generation:  0.001194000244140625
mini_batch_src_global generation:  0.0014421939849853516
r_  generation:  0.023479223251342773
local_output_nid generation:  0.0027234554290771484
local_in_edges_tensor generation:  0.0013897418975830078
mini_batch_src_global generation:  0.0020170211791992188
r_  generation:  0.010835886001586914
local_output_nid generation:  0.002264738082885742
local_in_edges_tensor generation:  0.001142740249633789
mini_batch_src_global generation:  0.00144195556640625
r_  generation:  0.010198354721069336
local_output_nid generation:  0.0021789073944091797
local_in_edges_tensor generation:  0.0010733604431152344
mini_batch_src_global generation:  0.0013718605041503906
r_  generation:  0.010745048522949219
local_output_nid generation:  0.002059459686279297
local_in_edges_tensor generation:  0.0010950565338134766
mini_batch_src_global generation:  0.0012602806091308594
r_  generation:  0.010361671447753906
local_output_nid generation:  0.0020236968994140625
local_in_edges_tensor generation:  0.0010232925415039062
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.010467052459716797
local_output_nid generation:  0.0019352436065673828
local_in_edges_tensor generation:  0.0009744167327880859
mini_batch_src_global generation:  0.0011813640594482422
r_  generation:  0.0103302001953125
local_output_nid generation:  0.0019505023956298828
local_in_edges_tensor generation:  0.0009965896606445312
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  0.010471582412719727
local_output_nid generation:  0.0018720626831054688
local_in_edges_tensor generation:  0.0010235309600830078
mini_batch_src_global generation:  0.0012345314025878906
r_  generation:  0.010388374328613281
local_output_nid generation:  0.001855611801147461
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0011246204376220703
r_  generation:  0.01015615463256836
local_output_nid generation:  0.001809835433959961
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.010617256164550781
local_output_nid generation:  0.0018434524536132812
local_in_edges_tensor generation:  0.0009446144104003906
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.010312318801879883
local_output_nid generation:  0.001768350601196289
local_in_edges_tensor generation:  0.0009388923645019531
mini_batch_src_global generation:  0.0011944770812988281
r_  generation:  0.010500192642211914
local_output_nid generation:  0.0017604827880859375
local_in_edges_tensor generation:  0.001020669937133789
mini_batch_src_global generation:  0.0011186599731445312
r_  generation:  0.010195732116699219
local_output_nid generation:  0.0018014907836914062
local_in_edges_tensor generation:  0.0009953975677490234
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.0102386474609375
local_output_nid generation:  0.0017099380493164062
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.0012137889862060547
r_  generation:  0.010034561157226562
local_output_nid generation:  0.0017251968383789062
local_in_edges_tensor generation:  0.0009388923645019531
mini_batch_src_global generation:  0.0011119842529296875
r_  generation:  0.010278940200805664
local_output_nid generation:  0.001739501953125
local_in_edges_tensor generation:  0.001035451889038086
mini_batch_src_global generation:  0.0010924339294433594
r_  generation:  0.009896278381347656
local_output_nid generation:  0.001667022705078125
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.01047658920288086
local_output_nid generation:  0.0016701221466064453
local_in_edges_tensor generation:  0.0008940696716308594
mini_batch_src_global generation:  0.0011823177337646484
r_  generation:  0.010174274444580078
local_output_nid generation:  0.0016956329345703125
local_in_edges_tensor generation:  0.0008969306945800781
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.010486841201782227
local_output_nid generation:  0.0016450881958007812
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.0011360645294189453
r_  generation:  0.010198593139648438
local_output_nid generation:  0.0016236305236816406
local_in_edges_tensor generation:  0.0008976459503173828
mini_batch_src_global generation:  0.0011050701141357422
r_  generation:  0.010229110717773438
----------------------check_connections_block total spend ----------------------------- 0.6198923587799072
generate_one_block  0.025835275650024414
generate_one_block  0.020899057388305664
generate_one_block  0.018689870834350586
generate_one_block  0.01831364631652832
generate_one_block  0.017216920852661133
generate_one_block  0.01776123046875
generate_one_block  0.017549991607666016
generate_one_block  0.01780223846435547
generate_one_block  0.017835140228271484
generate_one_block  0.017570018768310547
generate_one_block  0.017887353897094727
generate_one_block  0.02008819580078125
generate_one_block  0.019121170043945312
generate_one_block  0.017457008361816406
generate_one_block  0.017651796340942383
generate_one_block  0.017412424087524414
generate_one_block  0.017690420150756836
generate_one_block  0.017573833465576172
generate_one_block  0.01725459098815918
generate_one_block  0.017380952835083008
generate_one_block  0.017374753952026367
generate_one_block  0.01734471321105957
generate_one_block  0.0171048641204834
generate_one_block  0.016848325729370117
generate_one_block  0.016985654830932617
generate_one_block  0.016823768615722656
generate_one_block  0.016609668731689453
generate_one_block  0.017686128616333008
generate_one_block  0.017282724380493164
generate_one_block  0.01763176918029785
generate_one_block  0.01730513572692871
generate_one_block  0.016830921173095703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04950451850891113
gen group dst list time:  0.024204730987548828
time for parepare:  0.02090597152709961
local_output_nid generation:  0.006700038909912109
local_in_edges_tensor generation:  0.01883983612060547
mini_batch_src_global generation:  0.015293121337890625
r_  generation:  0.13892316818237305
local_output_nid generation:  0.008927583694458008
local_in_edges_tensor generation:  0.011193275451660156
mini_batch_src_global generation:  0.019129037857055664
r_  generation:  0.15046143531799316
local_output_nid generation:  0.01177072525024414
local_in_edges_tensor generation:  0.03460264205932617
mini_batch_src_global generation:  0.017873764038085938
r_  generation:  0.15992164611816406
local_output_nid generation:  0.009672403335571289
local_in_edges_tensor generation:  0.010368585586547852
mini_batch_src_global generation:  0.02083897590637207
r_  generation:  0.15529561042785645
local_output_nid generation:  0.00922083854675293
local_in_edges_tensor generation:  0.013274908065795898
mini_batch_src_global generation:  0.018358707427978516
r_  generation:  0.14940977096557617
local_output_nid generation:  0.009262800216674805
local_in_edges_tensor generation:  0.008604288101196289
mini_batch_src_global generation:  0.023116588592529297
r_  generation:  0.1591625213623047
local_output_nid generation:  0.01258087158203125
local_in_edges_tensor generation:  0.008725643157958984
mini_batch_src_global generation:  0.018608808517456055
r_  generation:  0.1539149284362793
local_output_nid generation:  0.009224891662597656
local_in_edges_tensor generation:  0.00862574577331543
mini_batch_src_global generation:  0.019015073776245117
r_  generation:  0.15469002723693848
local_output_nid generation:  0.009426116943359375
local_in_edges_tensor generation:  0.009016275405883789
mini_batch_src_global generation:  0.019746065139770508
r_  generation:  0.15731096267700195
local_output_nid generation:  0.00954437255859375
local_in_edges_tensor generation:  0.008453845977783203
mini_batch_src_global generation:  0.030907392501831055
r_  generation:  0.17551589012145996
local_output_nid generation:  0.014960765838623047
local_in_edges_tensor generation:  0.011750459671020508
mini_batch_src_global generation:  0.02386474609375
r_  generation:  0.18084406852722168
local_output_nid generation:  0.014812707901000977
local_in_edges_tensor generation:  0.011566162109375
mini_batch_src_global generation:  0.02290034294128418
r_  generation:  0.15574049949645996
local_output_nid generation:  0.01266336441040039
local_in_edges_tensor generation:  0.010416507720947266
mini_batch_src_global generation:  0.020273447036743164
r_  generation:  0.16177773475646973
local_output_nid generation:  0.010274171829223633
local_in_edges_tensor generation:  0.009687185287475586
mini_batch_src_global generation:  0.019240379333496094
r_  generation:  0.15713834762573242
local_output_nid generation:  0.009920835494995117
local_in_edges_tensor generation:  0.009361743927001953
mini_batch_src_global generation:  0.019992828369140625
r_  generation:  0.16054558753967285
local_output_nid generation:  0.009745597839355469
local_in_edges_tensor generation:  0.009753704071044922
mini_batch_src_global generation:  0.019684314727783203
r_  generation:  0.15848016738891602
local_output_nid generation:  0.009727239608764648
local_in_edges_tensor generation:  0.009202003479003906
mini_batch_src_global generation:  0.019260644912719727
r_  generation:  0.20235300064086914
local_output_nid generation:  0.010144472122192383
local_in_edges_tensor generation:  0.008362293243408203
mini_batch_src_global generation:  0.020257234573364258
r_  generation:  0.15631532669067383
local_output_nid generation:  0.009450197219848633
local_in_edges_tensor generation:  0.008678913116455078
mini_batch_src_global generation:  0.018980741500854492
r_  generation:  0.15415620803833008
local_output_nid generation:  0.009414196014404297
local_in_edges_tensor generation:  0.008352518081665039
mini_batch_src_global generation:  0.0193634033203125
r_  generation:  0.15500831604003906
local_output_nid generation:  0.009489774703979492
local_in_edges_tensor generation:  0.008485794067382812
mini_batch_src_global generation:  0.019147396087646484
r_  generation:  0.1544182300567627
local_output_nid generation:  0.00953054428100586
local_in_edges_tensor generation:  0.008238554000854492
mini_batch_src_global generation:  0.019030332565307617
r_  generation:  0.1545884609222412
local_output_nid generation:  0.009185075759887695
local_in_edges_tensor generation:  0.009530067443847656
mini_batch_src_global generation:  0.018432140350341797
r_  generation:  0.15221047401428223
local_output_nid generation:  0.009261846542358398
local_in_edges_tensor generation:  0.00827169418334961
mini_batch_src_global generation:  0.0192718505859375
r_  generation:  0.15440773963928223
local_output_nid generation:  0.009361505508422852
local_in_edges_tensor generation:  0.009348869323730469
mini_batch_src_global generation:  0.019171953201293945
r_  generation:  0.15414786338806152
local_output_nid generation:  0.009176254272460938
local_in_edges_tensor generation:  0.008210897445678711
mini_batch_src_global generation:  0.018527984619140625
r_  generation:  0.15220165252685547
local_output_nid generation:  0.009009361267089844
local_in_edges_tensor generation:  0.01021575927734375
mini_batch_src_global generation:  0.018331050872802734
r_  generation:  0.15094208717346191
local_output_nid generation:  0.009484291076660156
local_in_edges_tensor generation:  0.008345842361450195
mini_batch_src_global generation:  0.019543170928955078
r_  generation:  0.15856552124023438
local_output_nid generation:  0.009403467178344727
local_in_edges_tensor generation:  0.009168624877929688
mini_batch_src_global generation:  0.01901388168334961
r_  generation:  0.15375375747680664
local_output_nid generation:  0.009624481201171875
local_in_edges_tensor generation:  0.009019136428833008
mini_batch_src_global generation:  0.01919841766357422
r_  generation:  0.15614938735961914
local_output_nid generation:  0.009424686431884766
local_in_edges_tensor generation:  0.008849382400512695
mini_batch_src_global generation:  0.01889944076538086
r_  generation:  0.15558767318725586
local_output_nid generation:  0.009375333786010742
local_in_edges_tensor generation:  0.008797883987426758
mini_batch_src_global generation:  0.018950462341308594
r_  generation:  0.15374302864074707
----------------------check_connections_block total spend ----------------------------- 7.5659990310668945
generate_one_block  0.2123568058013916
generate_one_block  0.20901823043823242
generate_one_block  0.2120189666748047
generate_one_block  0.21369171142578125
generate_one_block  0.22310805320739746
generate_one_block  0.21128630638122559
generate_one_block  0.20895934104919434
generate_one_block  0.2130892276763916
generate_one_block  0.214569091796875
generate_one_block  0.20788931846618652
generate_one_block  0.21494817733764648
generate_one_block  0.2090437412261963
generate_one_block  0.21112585067749023
generate_one_block  0.2043921947479248
generate_one_block  0.2088158130645752
generate_one_block  0.20850276947021484
generate_one_block  0.2079167366027832
generate_one_block  0.2055807113647461
generate_one_block  0.2019646167755127
generate_one_block  0.21054744720458984
generate_one_block  0.20225119590759277
generate_one_block  0.2042374610900879
generate_one_block  0.20682382583618164
generate_one_block  0.21788525581359863
generate_one_block  0.20485234260559082
generate_one_block  0.199143648147583
generate_one_block  0.19851469993591309
generate_one_block  0.21398305892944336
generate_one_block  0.20696377754211426
generate_one_block  0.20700311660766602
generate_one_block  0.20702695846557617
generate_one_block  0.20337653160095215
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03446698188781738
gen group dst list time:  0.11258721351623535
time for parepare:  0.020884037017822266
local_output_nid generation:  0.025658607482910156
local_in_edges_tensor generation:  0.04575514793395996
mini_batch_src_global generation:  0.03886818885803223
r_  generation:  0.40856099128723145
local_output_nid generation:  0.029977798461914062
local_in_edges_tensor generation:  0.0332028865814209
mini_batch_src_global generation:  0.052779436111450195
r_  generation:  0.40918850898742676
local_output_nid generation:  0.030882835388183594
local_in_edges_tensor generation:  0.03412294387817383
mini_batch_src_global generation:  0.04692411422729492
r_  generation:  0.42966794967651367
local_output_nid generation:  0.03159976005554199
local_in_edges_tensor generation:  0.02872490882873535
mini_batch_src_global generation:  0.050022125244140625
r_  generation:  0.41175055503845215
local_output_nid generation:  0.030931472778320312
local_in_edges_tensor generation:  0.027935504913330078
mini_batch_src_global generation:  0.047415971755981445
r_  generation:  0.4137406349182129
local_output_nid generation:  0.030693531036376953
local_in_edges_tensor generation:  0.027650833129882812
mini_batch_src_global generation:  0.04964280128479004
r_  generation:  0.41412925720214844
local_output_nid generation:  0.028580904006958008
local_in_edges_tensor generation:  0.027613162994384766
mini_batch_src_global generation:  0.04720616340637207
r_  generation:  0.4166102409362793
local_output_nid generation:  0.028768062591552734
local_in_edges_tensor generation:  0.027741432189941406
mini_batch_src_global generation:  0.0512392520904541
r_  generation:  0.4089653491973877
local_output_nid generation:  0.02901172637939453
local_in_edges_tensor generation:  0.028152942657470703
mini_batch_src_global generation:  0.04818534851074219
r_  generation:  0.4222257137298584
local_output_nid generation:  0.02857518196105957
local_in_edges_tensor generation:  0.027084827423095703
mini_batch_src_global generation:  0.04948258399963379
r_  generation:  0.4090604782104492
local_output_nid generation:  0.028862714767456055
local_in_edges_tensor generation:  0.027664899826049805
mini_batch_src_global generation:  0.04765915870666504
r_  generation:  0.42318248748779297
local_output_nid generation:  0.028940439224243164
local_in_edges_tensor generation:  0.0310513973236084
mini_batch_src_global generation:  0.0495142936706543
r_  generation:  0.4146394729614258
local_output_nid generation:  0.02928447723388672
local_in_edges_tensor generation:  0.029807090759277344
mini_batch_src_global generation:  0.04795646667480469
r_  generation:  0.43189525604248047
local_output_nid generation:  0.02869701385498047
local_in_edges_tensor generation:  0.031159639358520508
mini_batch_src_global generation:  0.049677371978759766
r_  generation:  0.4275071620941162
local_output_nid generation:  0.028795719146728516
local_in_edges_tensor generation:  0.025737524032592773
mini_batch_src_global generation:  0.04833698272705078
r_  generation:  0.42513203620910645
local_output_nid generation:  0.029157161712646484
local_in_edges_tensor generation:  0.02657771110534668
mini_batch_src_global generation:  0.049773216247558594
r_  generation:  0.41861867904663086
local_output_nid generation:  0.029019594192504883
local_in_edges_tensor generation:  0.02971625328063965
mini_batch_src_global generation:  0.0482945442199707
r_  generation:  0.42540597915649414
local_output_nid generation:  0.029491901397705078
local_in_edges_tensor generation:  0.026200056076049805
mini_batch_src_global generation:  0.05162382125854492
r_  generation:  0.41700291633605957
local_output_nid generation:  0.02872633934020996
local_in_edges_tensor generation:  0.02917313575744629
mini_batch_src_global generation:  0.0492706298828125
r_  generation:  0.41968512535095215
local_output_nid generation:  0.028847932815551758
local_in_edges_tensor generation:  0.027916431427001953
mini_batch_src_global generation:  0.04915571212768555
r_  generation:  0.4120795726776123
local_output_nid generation:  0.028873205184936523
local_in_edges_tensor generation:  0.027486324310302734
mini_batch_src_global generation:  0.04736733436584473
r_  generation:  0.4217257499694824
local_output_nid generation:  0.02899932861328125
local_in_edges_tensor generation:  0.026123523712158203
mini_batch_src_global generation:  0.049907684326171875
r_  generation:  0.4124305248260498
local_output_nid generation:  0.028830766677856445
local_in_edges_tensor generation:  0.031609296798706055
mini_batch_src_global generation:  0.047167062759399414
r_  generation:  0.41827392578125
local_output_nid generation:  0.02982497215270996
local_in_edges_tensor generation:  0.03259158134460449
mini_batch_src_global generation:  0.04925394058227539
r_  generation:  0.4140646457672119
local_output_nid generation:  0.028881549835205078
local_in_edges_tensor generation:  0.02727651596069336
mini_batch_src_global generation:  0.04671621322631836
r_  generation:  0.42153143882751465
local_output_nid generation:  0.02846217155456543
local_in_edges_tensor generation:  0.028178691864013672
mini_batch_src_global generation:  0.04858756065368652
r_  generation:  0.4245016574859619
local_output_nid generation:  0.029640674591064453
local_in_edges_tensor generation:  0.02909231185913086
mini_batch_src_global generation:  0.04661369323730469
r_  generation:  0.4169137477874756
local_output_nid generation:  0.02945876121520996
local_in_edges_tensor generation:  0.027344465255737305
mini_batch_src_global generation:  0.05106520652770996
r_  generation:  0.41324925422668457
local_output_nid generation:  0.029007911682128906
local_in_edges_tensor generation:  0.02552938461303711
mini_batch_src_global generation:  0.047434091567993164
r_  generation:  0.4213120937347412
local_output_nid generation:  0.0286104679107666
local_in_edges_tensor generation:  0.027559518814086914
mini_batch_src_global generation:  0.04873156547546387
r_  generation:  0.4120941162109375
local_output_nid generation:  0.02876114845275879
local_in_edges_tensor generation:  0.02905726432800293
mini_batch_src_global generation:  0.04671192169189453
r_  generation:  0.41640663146972656
local_output_nid generation:  0.02873826026916504
local_in_edges_tensor generation:  0.02797675132751465
mini_batch_src_global generation:  0.04902243614196777
r_  generation:  0.41539812088012695
----------------------check_connections_block total spend ----------------------------- 19.761943578720093
generate_one_block  0.5626318454742432
generate_one_block  0.5572245121002197
generate_one_block  0.5562746524810791
generate_one_block  0.5523478984832764
generate_one_block  0.6516692638397217
generate_one_block  0.5497927665710449
generate_one_block  0.5630819797515869
generate_one_block  0.5543124675750732
generate_one_block  0.5639266967773438
generate_one_block  0.5509812831878662
generate_one_block  0.556133508682251
generate_one_block  0.5507926940917969
generate_one_block  0.563774824142456
generate_one_block  0.5513401031494141
generate_one_block  0.5535609722137451
generate_one_block  0.561049222946167
generate_one_block  0.55867600440979
generate_one_block  0.5602107048034668
generate_one_block  0.5491983890533447
generate_one_block  0.5489277839660645
generate_one_block  0.5522239208221436
generate_one_block  0.5491511821746826
generate_one_block  0.5545065402984619
generate_one_block  0.5573678016662598
generate_one_block  0.5721971988677979
generate_one_block  0.551323652267456
generate_one_block  0.548790693283081
generate_one_block  0.5658679008483887
generate_one_block  0.5582256317138672
generate_one_block  0.5555768013000488
generate_one_block  0.5611424446105957
generate_one_block  0.5637669563293457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12295103073120117  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

connection checking time:  27.327942609786987
block generation total time  24.58693528175354
average batch blocks generation time:  0.7683417275547981
block dataloader generation time/epoch 54.71159578772152
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052255630493164  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.828367710113525  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10492658615112305  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.110114574432373  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10529708862304688  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.202739715576172  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10489845275878906  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.237691402435303  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10520267486572266  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.711844444274902  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1046442985534668  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.938438892364502  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10525131225585938  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.973883628845215  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10455846786499023  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.05552053451538  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527849197387695  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.17867660522461  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10442733764648438  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.88670253753662  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10530805587768555  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.169414520263672  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10461044311523438  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.72427749633789  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10532426834106445  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.305185794830322  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10443449020385742  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.983352184295654  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10419893264770508  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.038209915161133  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10493040084838867  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.137781620025635  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527753829956055  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.12139320373535  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10499238967895508  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.98026704788208  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521841049194336  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.739439964294434  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10452556610107422  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.951067447662354  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521507263183594  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.77327871322632  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10454845428466797  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.752567768096924  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10518550872802734  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.621220111846924  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1045522689819336  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.877012252807617  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052098274230957  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.74171257019043  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10431385040283203  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.532804012298584  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10412883758544922  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.311824798583984  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10457658767700195  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.039916515350342  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521125793457031  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.747375011444092  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10449886322021484  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.842751502990723  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523271560668945  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.868465423583984  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1047821044921875  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.72990131378174  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03552371263504028 |0.015864431858062744 |0.4177916646003723 |9.407848119735718e-05 |0.7567963376641273 |0.0077724456787109375 |
----------------------------------------------------------pseudo_mini_loss sum 1.2610162496566772
Total (block generation + training)time/epoch 93.92142422059003
Training time/epoch 39.29042315483093
Training time without block to device /epoch 38.782761335372925
Training time without total dataloading part /epoch 37.597599029541016
load block tensor time/epoch 1.136758804321289
block to device time/epoch 0.5076618194580078
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  8790817
Number of first layer input nodes during this epoch:  4679096
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12235450744628906  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024760961532592773
random selection method range initialization spend 0.005280017852783203
time for parepare:  0.017906904220581055
local_output_nid generation:  0.0014417171478271484
local_in_edges_tensor generation:  0.0074083805084228516
mini_batch_src_global generation:  0.0016689300537109375
r_  generation:  0.011177778244018555
local_output_nid generation:  0.001613616943359375
local_in_edges_tensor generation:  0.0010592937469482422
mini_batch_src_global generation:  0.0014913082122802734
r_  generation:  0.010355234146118164
local_output_nid generation:  0.0016264915466308594
local_in_edges_tensor generation:  0.0009779930114746094
mini_batch_src_global generation:  0.001194000244140625
r_  generation:  0.010103940963745117
local_output_nid generation:  0.0015912055969238281
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.001188039779663086
r_  generation:  0.010140180587768555
local_output_nid generation:  0.0015845298767089844
local_in_edges_tensor generation:  0.0009436607360839844
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.010282516479492188
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0009694099426269531
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.010199308395385742
local_output_nid generation:  0.0016100406646728516
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0011866092681884766
r_  generation:  0.010053873062133789
local_output_nid generation:  0.001596212387084961
local_in_edges_tensor generation:  0.0009167194366455078
mini_batch_src_global generation:  0.001196146011352539
r_  generation:  0.010114192962646484
local_output_nid generation:  0.0016176700592041016
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.010080099105834961
local_output_nid generation:  0.0016014575958251953
local_in_edges_tensor generation:  0.00089263916015625
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.010156393051147461
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008649826049804688
mini_batch_src_global generation:  0.0011074542999267578
r_  generation:  0.010087251663208008
local_output_nid generation:  0.0016036033630371094
local_in_edges_tensor generation:  0.0008614063262939453
mini_batch_src_global generation:  0.0011138916015625
r_  generation:  0.010219335556030273
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0008912086486816406
mini_batch_src_global generation:  0.001177072525024414
r_  generation:  0.010297536849975586
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.001161813735961914
r_  generation:  0.01041269302368164
local_output_nid generation:  0.001627206802368164
local_in_edges_tensor generation:  0.0009152889251708984
mini_batch_src_global generation:  0.0012295246124267578
r_  generation:  0.01061248779296875
local_output_nid generation:  0.0015978813171386719
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.010253190994262695
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0011801719665527344
r_  generation:  0.010337352752685547
local_output_nid generation:  0.0016410350799560547
local_in_edges_tensor generation:  0.0009167194366455078
mini_batch_src_global generation:  0.0011668205261230469
r_  generation:  0.010406255722045898
local_output_nid generation:  0.0015799999237060547
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.010314226150512695
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0011470317840576172
r_  generation:  0.010173797607421875
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.000850677490234375
mini_batch_src_global generation:  0.001081705093383789
r_  generation:  0.009730815887451172
local_output_nid generation:  0.0015709400177001953
local_in_edges_tensor generation:  0.0008976459503173828
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.010453939437866211
local_output_nid generation:  0.0015621185302734375
local_in_edges_tensor generation:  0.0008697509765625
mini_batch_src_global generation:  0.00121307373046875
r_  generation:  0.010476112365722656
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.009890079498291016
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.0012316703796386719
r_  generation:  0.010533332824707031
local_output_nid generation:  0.001580953598022461
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.0011639595031738281
r_  generation:  0.010459184646606445
local_output_nid generation:  0.0016062259674072266
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.0012025833129882812
r_  generation:  0.010328054428100586
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0008599758148193359
mini_batch_src_global generation:  0.0011570453643798828
r_  generation:  0.010170221328735352
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0008480548858642578
mini_batch_src_global generation:  0.0011091232299804688
r_  generation:  0.01010751724243164
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0011587142944335938
r_  generation:  0.010375499725341797
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0008740425109863281
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.010289430618286133
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.00086212158203125
mini_batch_src_global generation:  0.0011737346649169922
r_  generation:  0.010440826416015625
----------------------check_connections_block total spend ----------------------------- 0.5665125846862793
generate_one_block  0.024376392364501953
generate_one_block  0.01994800567626953
generate_one_block  0.01840662956237793
generate_one_block  0.017887115478515625
generate_one_block  0.018130779266357422
generate_one_block  0.01743459701538086
generate_one_block  0.01717829704284668
generate_one_block  0.017223596572875977
generate_one_block  0.019616365432739258
generate_one_block  0.017482280731201172
generate_one_block  0.017023086547851562
generate_one_block  0.020184040069580078
generate_one_block  0.01803278923034668
generate_one_block  0.017751455307006836
generate_one_block  0.018035888671875
generate_one_block  0.017346620559692383
generate_one_block  0.017395496368408203
generate_one_block  0.0176699161529541
generate_one_block  0.017297029495239258
generate_one_block  0.017166614532470703
generate_one_block  0.01636528968811035
generate_one_block  0.017508983612060547
generate_one_block  0.017426013946533203
generate_one_block  0.016711950302124023
generate_one_block  0.017780303955078125
generate_one_block  0.017333030700683594
generate_one_block  0.017122507095336914
generate_one_block  0.016962528228759766
generate_one_block  0.01697230339050293
generate_one_block  0.01730656623840332
generate_one_block  0.01732802391052246
generate_one_block  0.017360925674438477
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03584122657775879
gen group dst list time:  0.021526575088500977
time for parepare:  0.02054142951965332
local_output_nid generation:  0.006750345230102539
local_in_edges_tensor generation:  0.019159317016601562
mini_batch_src_global generation:  0.014555215835571289
r_  generation:  0.1441030502319336
local_output_nid generation:  0.008780241012573242
local_in_edges_tensor generation:  0.010824441909790039
mini_batch_src_global generation:  0.018288612365722656
r_  generation:  0.13729429244995117
local_output_nid generation:  0.009425640106201172
local_in_edges_tensor generation:  0.033843994140625
mini_batch_src_global generation:  0.01736593246459961
r_  generation:  0.1487278938293457
local_output_nid generation:  0.009293317794799805
local_in_edges_tensor generation:  0.01054835319519043
mini_batch_src_global generation:  0.017826318740844727
r_  generation:  0.15161919593811035
local_output_nid generation:  0.009566068649291992
local_in_edges_tensor generation:  0.008833169937133789
mini_batch_src_global generation:  0.018424034118652344
r_  generation:  0.15769267082214355
local_output_nid generation:  0.009030580520629883
local_in_edges_tensor generation:  0.013534307479858398
mini_batch_src_global generation:  0.019358158111572266
r_  generation:  0.14975428581237793
local_output_nid generation:  0.008831024169921875
local_in_edges_tensor generation:  0.009844303131103516
mini_batch_src_global generation:  0.018620014190673828
r_  generation:  0.15117168426513672
local_output_nid generation:  0.008826255798339844
local_in_edges_tensor generation:  0.008555889129638672
mini_batch_src_global generation:  0.01855945587158203
r_  generation:  0.1511237621307373
local_output_nid generation:  0.008707761764526367
local_in_edges_tensor generation:  0.009624242782592773
mini_batch_src_global generation:  0.018394947052001953
r_  generation:  0.15020966529846191
local_output_nid generation:  0.00905752182006836
local_in_edges_tensor generation:  0.008790969848632812
mini_batch_src_global generation:  0.018605470657348633
r_  generation:  0.15176129341125488
local_output_nid generation:  0.009115934371948242
local_in_edges_tensor generation:  0.008612394332885742
mini_batch_src_global generation:  0.018217802047729492
r_  generation:  0.15117621421813965
local_output_nid generation:  0.009193181991577148
local_in_edges_tensor generation:  0.00850987434387207
mini_batch_src_global generation:  0.019419431686401367
r_  generation:  0.15160059928894043
local_output_nid generation:  0.009459972381591797
local_in_edges_tensor generation:  0.008483409881591797
mini_batch_src_global generation:  0.020838499069213867
r_  generation:  0.15472936630249023
local_output_nid generation:  0.009307622909545898
local_in_edges_tensor generation:  0.014217853546142578
mini_batch_src_global generation:  0.019228219985961914
r_  generation:  0.15215206146240234
local_output_nid generation:  0.009455442428588867
local_in_edges_tensor generation:  0.00924539566040039
mini_batch_src_global generation:  0.019765377044677734
r_  generation:  0.15622353553771973
local_output_nid generation:  0.009335041046142578
local_in_edges_tensor generation:  0.008445501327514648
mini_batch_src_global generation:  0.019391536712646484
r_  generation:  0.15564250946044922
local_output_nid generation:  0.009429931640625
local_in_edges_tensor generation:  0.009007453918457031
mini_batch_src_global generation:  0.018742799758911133
r_  generation:  0.15536713600158691
local_output_nid generation:  0.009512901306152344
local_in_edges_tensor generation:  0.00915217399597168
mini_batch_src_global generation:  0.019500255584716797
r_  generation:  0.1566026210784912
local_output_nid generation:  0.009363174438476562
local_in_edges_tensor generation:  0.008602380752563477
mini_batch_src_global generation:  0.018636465072631836
r_  generation:  0.15430402755737305
local_output_nid generation:  0.009420156478881836
local_in_edges_tensor generation:  0.008717536926269531
mini_batch_src_global generation:  0.02098393440246582
r_  generation:  0.15054798126220703
local_output_nid generation:  0.009096622467041016
local_in_edges_tensor generation:  0.009385108947753906
mini_batch_src_global generation:  0.018163681030273438
r_  generation:  0.14577388763427734
local_output_nid generation:  0.009383201599121094
local_in_edges_tensor generation:  0.008441448211669922
mini_batch_src_global generation:  0.019095897674560547
r_  generation:  0.15558481216430664
local_output_nid generation:  0.009341239929199219
local_in_edges_tensor generation:  0.010103940963745117
mini_batch_src_global generation:  0.018908977508544922
r_  generation:  0.15497493743896484
local_output_nid generation:  0.009045600891113281
local_in_edges_tensor generation:  0.00809621810913086
mini_batch_src_global generation:  0.018213510513305664
r_  generation:  0.14457464218139648
local_output_nid generation:  0.009641170501708984
local_in_edges_tensor generation:  0.00878000259399414
mini_batch_src_global generation:  0.019295930862426758
r_  generation:  0.16052746772766113
local_output_nid generation:  0.009382009506225586
local_in_edges_tensor generation:  0.010218381881713867
mini_batch_src_global generation:  0.019392728805541992
r_  generation:  0.1563425064086914
local_output_nid generation:  0.00918269157409668
local_in_edges_tensor generation:  0.008231163024902344
mini_batch_src_global generation:  0.018964529037475586
r_  generation:  0.15494227409362793
local_output_nid generation:  0.009225606918334961
local_in_edges_tensor generation:  0.008949518203735352
mini_batch_src_global generation:  0.018669843673706055
r_  generation:  0.1544036865234375
local_output_nid generation:  0.009232759475708008
local_in_edges_tensor generation:  0.008818864822387695
mini_batch_src_global generation:  0.018498659133911133
r_  generation:  0.1537933349609375
local_output_nid generation:  0.009388446807861328
local_in_edges_tensor generation:  0.008928775787353516
mini_batch_src_global generation:  0.0201108455657959
r_  generation:  0.15642356872558594
local_output_nid generation:  0.009202957153320312
local_in_edges_tensor generation:  0.008986234664916992
mini_batch_src_global generation:  0.01926255226135254
r_  generation:  0.15700936317443848
local_output_nid generation:  0.009403228759765625
local_in_edges_tensor generation:  0.009096145629882812
mini_batch_src_global generation:  0.01935553550720215
r_  generation:  0.15738224983215332
----------------------check_connections_block total spend ----------------------------- 7.286601543426514
generate_one_block  0.21179962158203125
generate_one_block  0.19925737380981445
generate_one_block  0.2048797607421875
generate_one_block  0.20903682708740234
generate_one_block  0.22522473335266113
generate_one_block  0.20310163497924805
generate_one_block  0.20156526565551758
generate_one_block  0.20070433616638184
generate_one_block  0.19994640350341797
generate_one_block  0.2026662826538086
generate_one_block  0.20079731941223145
generate_one_block  0.20250606536865234
generate_one_block  0.20314407348632812
generate_one_block  0.203033447265625
generate_one_block  0.20659327507019043
generate_one_block  0.20595264434814453
generate_one_block  0.20877861976623535
generate_one_block  0.21000051498413086
generate_one_block  0.20301222801208496
generate_one_block  0.20604658126831055
generate_one_block  0.19331645965576172
generate_one_block  0.2080988883972168
generate_one_block  0.2038111686706543
generate_one_block  0.18960213661193848
generate_one_block  0.21256279945373535
generate_one_block  0.2088172435760498
generate_one_block  0.20091915130615234
generate_one_block  0.20123052597045898
generate_one_block  0.20029568672180176
generate_one_block  0.20726656913757324
generate_one_block  0.20819735527038574
generate_one_block  0.2094712257385254
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03452801704406738
gen group dst list time:  0.10553193092346191
time for parepare:  0.018728971481323242
local_output_nid generation:  0.024886608123779297
local_in_edges_tensor generation:  0.04088902473449707
mini_batch_src_global generation:  0.03930997848510742
r_  generation:  0.4113271236419678
local_output_nid generation:  0.02960371971130371
local_in_edges_tensor generation:  0.03003716468811035
mini_batch_src_global generation:  0.050780296325683594
r_  generation:  0.4037442207336426
local_output_nid generation:  0.030046463012695312
local_in_edges_tensor generation:  0.027841806411743164
mini_batch_src_global generation:  0.04957246780395508
r_  generation:  0.42206382751464844
local_output_nid generation:  0.02991628646850586
local_in_edges_tensor generation:  0.026934385299682617
mini_batch_src_global generation:  0.04974508285522461
r_  generation:  0.4128146171569824
local_output_nid generation:  0.029985427856445312
local_in_edges_tensor generation:  0.030777454376220703
mini_batch_src_global generation:  0.04992938041687012
r_  generation:  0.42894577980041504
local_output_nid generation:  0.03187918663024902
local_in_edges_tensor generation:  0.028325319290161133
mini_batch_src_global generation:  0.04957270622253418
r_  generation:  0.40834784507751465
local_output_nid generation:  0.027829647064208984
local_in_edges_tensor generation:  0.02561473846435547
mini_batch_src_global generation:  0.05004119873046875
r_  generation:  0.4160594940185547
local_output_nid generation:  0.027888059616088867
local_in_edges_tensor generation:  0.026079893112182617
mini_batch_src_global generation:  0.04948234558105469
r_  generation:  0.410524845123291
local_output_nid generation:  0.027767419815063477
local_in_edges_tensor generation:  0.02714705467224121
mini_batch_src_global generation:  0.04764294624328613
r_  generation:  0.41313743591308594
local_output_nid generation:  0.028046131134033203
local_in_edges_tensor generation:  0.025440216064453125
mini_batch_src_global generation:  0.04928994178771973
r_  generation:  0.40755653381347656
local_output_nid generation:  0.027817964553833008
local_in_edges_tensor generation:  0.029065847396850586
mini_batch_src_global generation:  0.047981977462768555
r_  generation:  0.4173426628112793
local_output_nid generation:  0.028155803680419922
local_in_edges_tensor generation:  0.027701854705810547
mini_batch_src_global generation:  0.04932093620300293
r_  generation:  0.40924525260925293
local_output_nid generation:  0.028094053268432617
local_in_edges_tensor generation:  0.03066253662109375
mini_batch_src_global generation:  0.047759294509887695
r_  generation:  0.41777896881103516
local_output_nid generation:  0.02764725685119629
local_in_edges_tensor generation:  0.02549457550048828
mini_batch_src_global generation:  0.049237966537475586
r_  generation:  0.40947651863098145
local_output_nid generation:  0.028072118759155273
local_in_edges_tensor generation:  0.025794029235839844
mini_batch_src_global generation:  0.04858827590942383
r_  generation:  0.41683149337768555
local_output_nid generation:  0.02819037437438965
local_in_edges_tensor generation:  0.02865743637084961
mini_batch_src_global generation:  0.05208015441894531
r_  generation:  0.4166426658630371
local_output_nid generation:  0.028015851974487305
local_in_edges_tensor generation:  0.02787923812866211
mini_batch_src_global generation:  0.04835176467895508
r_  generation:  0.41768431663513184
local_output_nid generation:  0.02834153175354004
local_in_edges_tensor generation:  0.02729010581970215
mini_batch_src_global generation:  0.04980134963989258
r_  generation:  0.41414570808410645
local_output_nid generation:  0.02803659439086914
local_in_edges_tensor generation:  0.025681734085083008
mini_batch_src_global generation:  0.06060981750488281
r_  generation:  0.427457332611084
local_output_nid generation:  0.02895665168762207
local_in_edges_tensor generation:  0.025804758071899414
mini_batch_src_global generation:  0.0491793155670166
r_  generation:  0.4098031520843506
local_output_nid generation:  0.02775120735168457
local_in_edges_tensor generation:  0.0256805419921875
mini_batch_src_global generation:  0.04734492301940918
r_  generation:  0.41899776458740234
local_output_nid generation:  0.029605865478515625
local_in_edges_tensor generation:  0.027131319046020508
mini_batch_src_global generation:  0.049968719482421875
r_  generation:  0.41597747802734375
local_output_nid generation:  0.028624296188354492
local_in_edges_tensor generation:  0.025636672973632812
mini_batch_src_global generation:  0.04843854904174805
r_  generation:  0.4153900146484375
local_output_nid generation:  0.028441190719604492
local_in_edges_tensor generation:  0.02565908432006836
mini_batch_src_global generation:  0.04876589775085449
r_  generation:  0.4118213653564453
local_output_nid generation:  0.029179096221923828
local_in_edges_tensor generation:  0.027899503707885742
mini_batch_src_global generation:  0.04843473434448242
r_  generation:  0.42014241218566895
local_output_nid generation:  0.02872443199157715
local_in_edges_tensor generation:  0.028494834899902344
mini_batch_src_global generation:  0.049590349197387695
r_  generation:  0.4165940284729004
local_output_nid generation:  0.03040933609008789
local_in_edges_tensor generation:  0.025585651397705078
mini_batch_src_global generation:  0.04821491241455078
r_  generation:  0.41814279556274414
local_output_nid generation:  0.02872443199157715
local_in_edges_tensor generation:  0.027057170867919922
mini_batch_src_global generation:  0.04892778396606445
r_  generation:  0.4112224578857422
local_output_nid generation:  0.028585433959960938
local_in_edges_tensor generation:  0.026909351348876953
mini_batch_src_global generation:  0.04774355888366699
r_  generation:  0.4153134822845459
local_output_nid generation:  0.028813600540161133
local_in_edges_tensor generation:  0.025597333908081055
mini_batch_src_global generation:  0.05154561996459961
r_  generation:  0.4145815372467041
local_output_nid generation:  0.02861785888671875
local_in_edges_tensor generation:  0.02710103988647461
mini_batch_src_global generation:  0.04804205894470215
r_  generation:  0.4156816005706787
local_output_nid generation:  0.02864837646484375
local_in_edges_tensor generation:  0.027255773544311523
mini_batch_src_global generation:  0.04908418655395508
r_  generation:  0.42474961280822754
----------------------check_connections_block total spend ----------------------------- 19.605910539627075
generate_one_block  0.5601096153259277
generate_one_block  0.5466771125793457
generate_one_block  0.555128812789917
generate_one_block  0.5603322982788086
generate_one_block  0.6583030223846436
generate_one_block  0.5455179214477539
generate_one_block  0.5641717910766602
generate_one_block  0.5573358535766602
generate_one_block  0.5453922748565674
generate_one_block  0.5542211532592773
generate_one_block  0.5550060272216797
generate_one_block  0.5556752681732178
generate_one_block  0.552438497543335
generate_one_block  0.5452392101287842
generate_one_block  0.5630357265472412
generate_one_block  0.5591084957122803
generate_one_block  0.5514404773712158
generate_one_block  0.5556960105895996
generate_one_block  0.548346996307373
generate_one_block  0.5522105693817139
generate_one_block  0.5445795059204102
generate_one_block  0.5594401359558105
generate_one_block  0.5496327877044678
generate_one_block  0.5424168109893799
generate_one_block  0.5804626941680908
generate_one_block  0.556779146194458
generate_one_block  0.5507392883300781
generate_one_block  0.5500566959381104
generate_one_block  0.5498700141906738
generate_one_block  0.5558624267578125
generate_one_block  0.554018497467041
generate_one_block  0.5549910068511963
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12235450744628906  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

connection checking time:  26.89251208305359
block generation total time  24.38587236404419
average batch blocks generation time:  0.7620585113763809
block dataloader generation time/epoch 54.687782526016235
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1053309440612793  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.321176528930664  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10444402694702148  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.487629413604736  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10525751113891602  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.968605995178223  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1045527458190918  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.078649044036865  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1053156852722168  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.24290370941162  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10428428649902344  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.798063278198242  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523080825805664  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.91596221923828  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10448408126831055  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.81097984313965  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10519790649414062  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.63437509536743  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10448026657104492  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.717987060546875  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521268844604492  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.764005184173584  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10473823547363281  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.80131959915161  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523843765258789  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.87150478363037  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10451745986938477  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.831527709960938  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528087615966797  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.186770915985107  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1047067642211914  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.08948278427124  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526275634765625  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.090070724487305  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10489654541015625  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.159892082214355  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523033142089844  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.84025812149048  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1047978401184082  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.751562118530273  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1051177978515625  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.2583909034729  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10489463806152344  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.12643814086914  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524559020996094  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.93839406967163  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10451126098632812  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.293389797210693  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.105316162109375  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.26430606842041  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10468149185180664  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.148736476898193  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10522603988647461  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.932872772216797  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10457992553710938  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.78070878982544  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521793365478516  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.771581172943115  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10477781295776367  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.121832847595215  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526371002197266  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.996222972869873  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1045989990234375  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.10460615158081  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03523535281419754 |0.01287849247455597 |0.4165783151984215 |9.109824895858765e-05 |0.7557325810194016 |0.007756233215332031 |
----------------------------------------------------------pseudo_mini_loss sum 1.2483843564987183
Total (block generation + training)time/epoch 93.89219441678789
Training time/epoch 39.112065076828
Training time without block to device /epoch 38.69995331764221
Training time without total dataloading part /epoch 37.524620056152344
load block tensor time/epoch 1.1275312900543213
block to device time/epoch 0.412111759185791
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  8791220
Number of first layer input nodes during this epoch:  4679145
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1228494644165039  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026778459548950195
random selection method range initialization spend 0.0061643123626708984
time for parepare:  0.022821903228759766
local_output_nid generation:  0.0019457340240478516
local_in_edges_tensor generation:  0.005374908447265625
mini_batch_src_global generation:  0.002152681350708008
r_  generation:  0.010684967041015625
local_output_nid generation:  0.0021212100982666016
local_in_edges_tensor generation:  0.0012481212615966797
mini_batch_src_global generation:  0.0018897056579589844
r_  generation:  0.011120319366455078
local_output_nid generation:  0.0022263526916503906
local_in_edges_tensor generation:  0.0011963844299316406
mini_batch_src_global generation:  0.0013613700866699219
r_  generation:  0.009646892547607422
local_output_nid generation:  0.002252817153930664
local_in_edges_tensor generation:  0.0011360645294189453
mini_batch_src_global generation:  0.0014379024505615234
r_  generation:  0.010048389434814453
local_output_nid generation:  0.0022399425506591797
local_in_edges_tensor generation:  0.00116729736328125
mini_batch_src_global generation:  0.0013093948364257812
r_  generation:  0.010065078735351562
local_output_nid generation:  0.0022749900817871094
local_in_edges_tensor generation:  0.0011372566223144531
mini_batch_src_global generation:  0.0012633800506591797
r_  generation:  0.010019063949584961
local_output_nid generation:  0.0022745132446289062
local_in_edges_tensor generation:  0.001135110855102539
mini_batch_src_global generation:  0.0013582706451416016
r_  generation:  0.009955644607543945
local_output_nid generation:  0.0022428035736083984
local_in_edges_tensor generation:  0.0010805130004882812
mini_batch_src_global generation:  0.001207113265991211
r_  generation:  0.015839815139770508
local_output_nid generation:  0.003579378128051758
local_in_edges_tensor generation:  0.0016508102416992188
mini_batch_src_global generation:  0.002053499221801758
r_  generation:  0.012890338897705078
local_output_nid generation:  0.002184152603149414
local_in_edges_tensor generation:  0.0010113716125488281
mini_batch_src_global generation:  0.0012192726135253906
r_  generation:  0.009968280792236328
local_output_nid generation:  0.002043008804321289
local_in_edges_tensor generation:  0.000989675521850586
mini_batch_src_global generation:  0.001186370849609375
r_  generation:  0.01030421257019043
local_output_nid generation:  0.001984834671020508
local_in_edges_tensor generation:  0.0009868144989013672
mini_batch_src_global generation:  0.0011970996856689453
r_  generation:  0.010651111602783203
local_output_nid generation:  0.0019567012786865234
local_in_edges_tensor generation:  0.0009775161743164062
mini_batch_src_global generation:  0.001184701919555664
r_  generation:  0.01040959358215332
local_output_nid generation:  0.0018944740295410156
local_in_edges_tensor generation:  0.0009715557098388672
mini_batch_src_global generation:  0.0011327266693115234
r_  generation:  0.010230064392089844
local_output_nid generation:  0.0018641948699951172
local_in_edges_tensor generation:  0.0009329319000244141
mini_batch_src_global generation:  0.0011818408966064453
r_  generation:  0.010189056396484375
local_output_nid generation:  0.0018458366394042969
local_in_edges_tensor generation:  0.0010628700256347656
mini_batch_src_global generation:  0.0011703968048095703
r_  generation:  0.010873794555664062
local_output_nid generation:  0.0018110275268554688
local_in_edges_tensor generation:  0.0009262561798095703
mini_batch_src_global generation:  0.0011839866638183594
r_  generation:  0.01043844223022461
local_output_nid generation:  0.0017724037170410156
local_in_edges_tensor generation:  0.0009739398956298828
mini_batch_src_global generation:  0.0014121532440185547
r_  generation:  0.00994563102722168
local_output_nid generation:  0.0017850399017333984
local_in_edges_tensor generation:  0.000995635986328125
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.01010751724243164
local_output_nid generation:  0.001760721206665039
local_in_edges_tensor generation:  0.0009126663208007812
mini_batch_src_global generation:  0.001127004623413086
r_  generation:  0.010196208953857422
local_output_nid generation:  0.0017278194427490234
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.010437726974487305
local_output_nid generation:  0.0017161369323730469
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.010591745376586914
local_output_nid generation:  0.0017359256744384766
local_in_edges_tensor generation:  0.0009245872497558594
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.010614395141601562
local_output_nid generation:  0.0017175674438476562
local_in_edges_tensor generation:  0.0009126663208007812
mini_batch_src_global generation:  0.0011625289916992188
r_  generation:  0.010332822799682617
local_output_nid generation:  0.001683950424194336
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0011348724365234375
r_  generation:  0.010294675827026367
local_output_nid generation:  0.0016632080078125
local_in_edges_tensor generation:  0.0008885860443115234
mini_batch_src_global generation:  0.0011341571807861328
r_  generation:  0.010373592376708984
local_output_nid generation:  0.0016644001007080078
local_in_edges_tensor generation:  0.0008914470672607422
mini_batch_src_global generation:  0.0011143684387207031
r_  generation:  0.010129928588867188
local_output_nid generation:  0.0016202926635742188
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.010175466537475586
local_output_nid generation:  0.0016319751739501953
local_in_edges_tensor generation:  0.0008783340454101562
mini_batch_src_global generation:  0.0011632442474365234
r_  generation:  0.010347604751586914
local_output_nid generation:  0.0016150474548339844
local_in_edges_tensor generation:  0.0008974075317382812
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.010428667068481445
local_output_nid generation:  0.0016188621520996094
local_in_edges_tensor generation:  0.0008988380432128906
mini_batch_src_global generation:  0.0010721683502197266
r_  generation:  0.00983428955078125
local_output_nid generation:  0.0016105175018310547
local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.0013599395751953125
r_  generation:  0.010126352310180664
----------------------check_connections_block total spend ----------------------------- 0.5997340679168701
generate_one_block  0.0204927921295166
generate_one_block  0.020174264907836914
generate_one_block  0.0172882080078125
generate_one_block  0.01739215850830078
generate_one_block  0.017409563064575195
generate_one_block  0.017053604125976562
generate_one_block  0.017052173614501953
generate_one_block  0.017079591751098633
generate_one_block  0.01743769645690918
generate_one_block  0.016739368438720703
generate_one_block  0.017518043518066406
generate_one_block  0.02084183692932129
generate_one_block  0.018375396728515625
generate_one_block  0.017477035522460938
generate_one_block  0.01744222640991211
generate_one_block  0.018297672271728516
generate_one_block  0.017725229263305664
generate_one_block  0.016900300979614258
generate_one_block  0.017149925231933594
generate_one_block  0.017216920852661133
generate_one_block  0.017637252807617188
generate_one_block  0.0176849365234375
generate_one_block  0.01761651039123535
generate_one_block  0.017240285873413086
generate_one_block  0.017513751983642578
generate_one_block  0.017379283905029297
generate_one_block  0.017217159271240234
generate_one_block  0.017115354537963867
generate_one_block  0.01746821403503418
generate_one_block  0.017570972442626953
generate_one_block  0.01694202423095703
generate_one_block  0.017165184020996094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06205320358276367
gen group dst list time:  0.02255702018737793
time for parepare:  0.020171165466308594
local_output_nid generation:  0.006437778472900391
local_in_edges_tensor generation:  0.01555776596069336
mini_batch_src_global generation:  0.013850688934326172
r_  generation:  0.13852286338806152
local_output_nid generation:  0.008689641952514648
local_in_edges_tensor generation:  0.01069784164428711
mini_batch_src_global generation:  0.01729559898376465
r_  generation:  0.14182400703430176
local_output_nid generation:  0.00854182243347168
local_in_edges_tensor generation:  0.03489351272583008
mini_batch_src_global generation:  0.01624464988708496
r_  generation:  0.14370012283325195
local_output_nid generation:  0.00919485092163086
local_in_edges_tensor generation:  0.008275985717773438
mini_batch_src_global generation:  0.018923282623291016
r_  generation:  0.1494274139404297
local_output_nid generation:  0.011236190795898438
local_in_edges_tensor generation:  0.012956380844116211
mini_batch_src_global generation:  0.021518468856811523
r_  generation:  0.15387725830078125
local_output_nid generation:  0.009753227233886719
local_in_edges_tensor generation:  0.00853109359741211
mini_batch_src_global generation:  0.018581390380859375
r_  generation:  0.14957118034362793
local_output_nid generation:  0.009276390075683594
local_in_edges_tensor generation:  0.009493350982666016
mini_batch_src_global generation:  0.01815509796142578
r_  generation:  0.15055465698242188
local_output_nid generation:  0.008965015411376953
local_in_edges_tensor generation:  0.008970022201538086
mini_batch_src_global generation:  0.018628597259521484
r_  generation:  0.1490473747253418
local_output_nid generation:  0.009045839309692383
local_in_edges_tensor generation:  0.008394241333007812
mini_batch_src_global generation:  0.01891350746154785
r_  generation:  0.15364766120910645
local_output_nid generation:  0.009109735488891602
local_in_edges_tensor generation:  0.008286476135253906
mini_batch_src_global generation:  0.01848626136779785
r_  generation:  0.14803004264831543
local_output_nid generation:  0.00965118408203125
local_in_edges_tensor generation:  0.010233640670776367
mini_batch_src_global generation:  0.01956009864807129
r_  generation:  0.15453529357910156
local_output_nid generation:  0.009779691696166992
local_in_edges_tensor generation:  0.010995864868164062
mini_batch_src_global generation:  0.020611286163330078
r_  generation:  0.1564493179321289
local_output_nid generation:  0.009824037551879883
local_in_edges_tensor generation:  0.008980274200439453
mini_batch_src_global generation:  0.01951766014099121
r_  generation:  0.1568143367767334
local_output_nid generation:  0.00945734977722168
local_in_edges_tensor generation:  0.008365392684936523
mini_batch_src_global generation:  0.019458293914794922
r_  generation:  0.1984848976135254
local_output_nid generation:  0.009583234786987305
local_in_edges_tensor generation:  0.008544206619262695
mini_batch_src_global generation:  0.032000064849853516
r_  generation:  0.16103196144104004
local_output_nid generation:  0.00977182388305664
local_in_edges_tensor generation:  0.010579347610473633
mini_batch_src_global generation:  0.020777463912963867
r_  generation:  0.16317415237426758
local_output_nid generation:  0.009666919708251953
local_in_edges_tensor generation:  0.009577751159667969
mini_batch_src_global generation:  0.01970505714416504
r_  generation:  0.16227507591247559
local_output_nid generation:  0.009335994720458984
local_in_edges_tensor generation:  0.008070230484008789
mini_batch_src_global generation:  0.018735170364379883
r_  generation:  0.15045499801635742
local_output_nid generation:  0.00943899154663086
local_in_edges_tensor generation:  0.008258581161499023
mini_batch_src_global generation:  0.018290042877197266
r_  generation:  0.15437722206115723
local_output_nid generation:  0.009482860565185547
local_in_edges_tensor generation:  0.008327722549438477
mini_batch_src_global generation:  0.02120518684387207
r_  generation:  0.15560603141784668
local_output_nid generation:  0.00952291488647461
local_in_edges_tensor generation:  0.00925755500793457
mini_batch_src_global generation:  0.021826505661010742
r_  generation:  0.1627519130706787
local_output_nid generation:  0.010744094848632812
local_in_edges_tensor generation:  0.012346982955932617
mini_batch_src_global generation:  0.01974964141845703
r_  generation:  0.15895414352416992
local_output_nid generation:  0.009799718856811523
local_in_edges_tensor generation:  0.010369300842285156
mini_batch_src_global generation:  0.020016193389892578
r_  generation:  0.1600055694580078
local_output_nid generation:  0.009577274322509766
local_in_edges_tensor generation:  0.009868144989013672
mini_batch_src_global generation:  0.019214153289794922
r_  generation:  0.1585550308227539
local_output_nid generation:  0.009678125381469727
local_in_edges_tensor generation:  0.009355783462524414
mini_batch_src_global generation:  0.02198195457458496
r_  generation:  0.16135048866271973
local_output_nid generation:  0.012303352355957031
local_in_edges_tensor generation:  0.012183904647827148
mini_batch_src_global generation:  0.019327878952026367
r_  generation:  0.15944480895996094
local_output_nid generation:  0.009501218795776367
local_in_edges_tensor generation:  0.009854316711425781
mini_batch_src_global generation:  0.018712520599365234
r_  generation:  0.15832281112670898
local_output_nid generation:  0.009621858596801758
local_in_edges_tensor generation:  0.00847625732421875
mini_batch_src_global generation:  0.01886725425720215
r_  generation:  0.16214323043823242
local_output_nid generation:  0.010966777801513672
local_in_edges_tensor generation:  0.009042024612426758
mini_batch_src_global generation:  0.019086837768554688
r_  generation:  0.15789175033569336
local_output_nid generation:  0.009708404541015625
local_in_edges_tensor generation:  0.012301921844482422
mini_batch_src_global generation:  0.01941370964050293
r_  generation:  0.15628671646118164
local_output_nid generation:  0.009348154067993164
local_in_edges_tensor generation:  0.009008646011352539
mini_batch_src_global generation:  0.018294095993041992
r_  generation:  0.150193452835083
local_output_nid generation:  0.009541749954223633
local_in_edges_tensor generation:  0.008501529693603516
mini_batch_src_global generation:  0.01915740966796875
r_  generation:  0.15668463706970215
----------------------check_connections_block total spend ----------------------------- 7.4345643520355225
generate_one_block  0.2129805088043213
generate_one_block  0.19887781143188477
generate_one_block  0.19425201416015625
generate_one_block  0.1966536045074463
generate_one_block  0.22317957878112793
generate_one_block  0.20091032981872559
generate_one_block  0.2003774642944336
generate_one_block  0.19931530952453613
generate_one_block  0.2030327320098877
generate_one_block  0.1958472728729248
generate_one_block  0.20378446578979492
generate_one_block  0.2094717025756836
generate_one_block  0.21697258949279785
generate_one_block  0.20727133750915527
generate_one_block  0.20958900451660156
generate_one_block  0.2182750701904297
generate_one_block  0.21054625511169434
generate_one_block  0.20111608505249023
generate_one_block  0.20000720024108887
generate_one_block  0.20806097984313965
generate_one_block  0.21344971656799316
generate_one_block  0.2088000774383545
generate_one_block  0.211836576461792
generate_one_block  0.20784544944763184
generate_one_block  0.20931148529052734
generate_one_block  0.20803189277648926
generate_one_block  0.20593929290771484
generate_one_block  0.20492863655090332
generate_one_block  0.20972824096679688
generate_one_block  0.20866847038269043
generate_one_block  0.20447850227355957
generate_one_block  0.20787310600280762
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04397106170654297
gen group dst list time:  0.11195659637451172
time for parepare:  0.019317150115966797
local_output_nid generation:  0.0246429443359375
local_in_edges_tensor generation:  0.04541158676147461
mini_batch_src_global generation:  0.03896903991699219
r_  generation:  0.39867639541625977
local_output_nid generation:  0.029213905334472656
local_in_edges_tensor generation:  0.03374600410461426
mini_batch_src_global generation:  0.05063819885253906
r_  generation:  0.4066474437713623
local_output_nid generation:  0.029097795486450195
local_in_edges_tensor generation:  0.029545068740844727
mini_batch_src_global generation:  0.047075510025024414
r_  generation:  0.4086613655090332
local_output_nid generation:  0.029631376266479492
local_in_edges_tensor generation:  0.029051780700683594
mini_batch_src_global generation:  0.04905819892883301
r_  generation:  0.4066152572631836
local_output_nid generation:  0.02953815460205078
local_in_edges_tensor generation:  0.03125262260437012
mini_batch_src_global generation:  0.05021166801452637
r_  generation:  0.4169349670410156
local_output_nid generation:  0.029576778411865234
local_in_edges_tensor generation:  0.03179764747619629
mini_batch_src_global generation:  0.05012917518615723
r_  generation:  0.40747547149658203
local_output_nid generation:  0.02770400047302246
local_in_edges_tensor generation:  0.02870655059814453
mini_batch_src_global generation:  0.0485384464263916
r_  generation:  0.41162800788879395
local_output_nid generation:  0.028434276580810547
local_in_edges_tensor generation:  0.02969074249267578
mini_batch_src_global generation:  0.04944634437561035
r_  generation:  0.4127016067504883
local_output_nid generation:  0.028115034103393555
local_in_edges_tensor generation:  0.02938675880432129
mini_batch_src_global generation:  0.04799675941467285
r_  generation:  0.41459202766418457
local_output_nid generation:  0.028185367584228516
local_in_edges_tensor generation:  0.025626182556152344
mini_batch_src_global generation:  0.04930567741394043
r_  generation:  0.4055600166320801
local_output_nid generation:  0.027899980545043945
local_in_edges_tensor generation:  0.029335498809814453
mini_batch_src_global generation:  0.05009603500366211
r_  generation:  0.415485143661499
local_output_nid generation:  0.0278623104095459
local_in_edges_tensor generation:  0.02943897247314453
mini_batch_src_global generation:  0.050262451171875
r_  generation:  0.4100666046142578
local_output_nid generation:  0.028232574462890625
local_in_edges_tensor generation:  0.031609535217285156
mini_batch_src_global generation:  0.048790693283081055
r_  generation:  0.4166254997253418
local_output_nid generation:  0.02828073501586914
local_in_edges_tensor generation:  0.02790999412536621
mini_batch_src_global generation:  0.04996895790100098
r_  generation:  0.4190242290496826
local_output_nid generation:  0.028880596160888672
local_in_edges_tensor generation:  0.029654264450073242
mini_batch_src_global generation:  0.049547433853149414
r_  generation:  0.4238290786743164
local_output_nid generation:  0.029597997665405273
local_in_edges_tensor generation:  0.029204130172729492
mini_batch_src_global generation:  0.0500333309173584
r_  generation:  0.41057348251342773
local_output_nid generation:  0.02903127670288086
local_in_edges_tensor generation:  0.02818441390991211
mini_batch_src_global generation:  0.04954934120178223
r_  generation:  0.41722965240478516
local_output_nid generation:  0.02870798110961914
local_in_edges_tensor generation:  0.02799510955810547
mini_batch_src_global generation:  0.05006098747253418
r_  generation:  0.40714216232299805
local_output_nid generation:  0.028487682342529297
local_in_edges_tensor generation:  0.02604079246520996
mini_batch_src_global generation:  0.04827618598937988
r_  generation:  0.41107678413391113
local_output_nid generation:  0.0282747745513916
local_in_edges_tensor generation:  0.027462244033813477
mini_batch_src_global generation:  0.05024361610412598
r_  generation:  0.40494465827941895
local_output_nid generation:  0.028354883193969727
local_in_edges_tensor generation:  0.02563309669494629
mini_batch_src_global generation:  0.048665523529052734
r_  generation:  0.41861796379089355
local_output_nid generation:  0.0284726619720459
local_in_edges_tensor generation:  0.027457714080810547
mini_batch_src_global generation:  0.05042767524719238
r_  generation:  0.4102351665496826
local_output_nid generation:  0.028592824935913086
local_in_edges_tensor generation:  0.028516769409179688
mini_batch_src_global generation:  0.048536062240600586
r_  generation:  0.41753363609313965
local_output_nid generation:  0.028285980224609375
local_in_edges_tensor generation:  0.025943279266357422
mini_batch_src_global generation:  0.050737857818603516
r_  generation:  0.4124441146850586
local_output_nid generation:  0.028879880905151367
local_in_edges_tensor generation:  0.026252031326293945
mini_batch_src_global generation:  0.05291342735290527
r_  generation:  0.417025089263916
local_output_nid generation:  0.02873706817626953
local_in_edges_tensor generation:  0.02740764617919922
mini_batch_src_global generation:  0.05054044723510742
r_  generation:  0.4139845371246338
local_output_nid generation:  0.028632640838623047
local_in_edges_tensor generation:  0.028250455856323242
mini_batch_src_global generation:  0.05074882507324219
r_  generation:  0.41838812828063965
local_output_nid generation:  0.028506040573120117
local_in_edges_tensor generation:  0.030579090118408203
mini_batch_src_global generation:  0.05108499526977539
r_  generation:  0.41431283950805664
local_output_nid generation:  0.02888345718383789
local_in_edges_tensor generation:  0.02812480926513672
mini_batch_src_global generation:  0.04899287223815918
r_  generation:  0.4206717014312744
local_output_nid generation:  0.028690338134765625
local_in_edges_tensor generation:  0.03357744216918945
mini_batch_src_global generation:  0.05071520805358887
r_  generation:  0.40979886054992676
local_output_nid generation:  0.02823472023010254
local_in_edges_tensor generation:  0.029400110244750977
mini_batch_src_global generation:  0.04850602149963379
r_  generation:  0.41639065742492676
local_output_nid generation:  0.029407739639282227
local_in_edges_tensor generation:  0.025356531143188477
mini_batch_src_global generation:  0.050414323806762695
r_  generation:  0.4145088195800781
----------------------check_connections_block total spend ----------------------------- 19.601141452789307
generate_one_block  0.566303014755249
generate_one_block  0.5502784252166748
generate_one_block  0.5545704364776611
generate_one_block  0.5514495372772217
generate_one_block  0.6530139446258545
generate_one_block  0.5549919605255127
generate_one_block  0.550532341003418
generate_one_block  0.5508065223693848
generate_one_block  0.5512988567352295
generate_one_block  0.5449965000152588
generate_one_block  0.5558066368103027
generate_one_block  0.5607733726501465
generate_one_block  0.5636203289031982
generate_one_block  0.5563845634460449
generate_one_block  0.5641269683837891
generate_one_block  0.5587325096130371
generate_one_block  0.5578880310058594
generate_one_block  0.5460271835327148
generate_one_block  0.5447986125946045
generate_one_block  0.5439825057983398
generate_one_block  0.5481021404266357
generate_one_block  0.5619933605194092
generate_one_block  0.5526630878448486
generate_one_block  0.5477523803710938
generate_one_block  0.5753984451293945
generate_one_block  0.5579454898834229
generate_one_block  0.556851863861084
generate_one_block  0.551952600479126
generate_one_block  0.5599465370178223
generate_one_block  0.5613448619842529
generate_one_block  0.5448482036590576
generate_one_block  0.551079511642456
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1228494644165039  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

connection checking time:  27.03570580482483
block generation total time  24.461673498153687
average batch blocks generation time:  0.7644272968173027
block dataloader generation time/epoch 54.684901563744795
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521507263183594  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.700429439544678  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10461759567260742  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.639078617095947  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10515975952148438  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.504897594451904  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10477399826049805  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.589336395263672  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10525083541870117  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.991135597229004  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10470294952392578  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.776260375976562  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521125793457031  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.756783962249756  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10467052459716797  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.665072917938232  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524511337280273  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.84918451309204  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10476398468017578  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.551762580871582  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526657104492188  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.05859375  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10456085205078125  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.198229789733887  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527849197387695  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.145212650299072  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10467910766601562  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.01003360748291  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052851676940918  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.14476776123047  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10478639602661133  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.38498544692993  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10531854629516602  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.258201122283936  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10458612442016602  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.609575748443604  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10520172119140625  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.7318754196167  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10457849502563477  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.93604612350464  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1053004264831543  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.14177703857422  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10468530654907227  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.09493398666382  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528564453125  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.040154457092285  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10471343994140625  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.99510431289673  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527801513671875  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.10970401763916  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10482597351074219  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.022549629211426  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523796081542969  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.916728973388672  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10471630096435547  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.852919578552246  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10527658462524414  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.134292125701904  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1049199104309082  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.112170219421387  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10516214370727539  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.469013690948486  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10474538803100586  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.049621105194092  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04109027236700058 |0.016436979174613953 |0.4297190085053444 |9.530037641525269e-05 |0.7614113166928291 |0.005894184112548828 |
----------------------------------------------------------pseudo_mini_loss sum 1.2494653463363647
Total (block generation + training)time/epoch 93.93230971537139
Training time/epoch 40.02108550071716
Training time without block to device /epoch 39.49510216712952
Training time without total dataloading part /epoch 38.12511420249939
load block tensor time/epoch 1.3148887157440186
block to device time/epoch 0.5259833335876465
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  8790226
Number of first layer input nodes during this epoch:  4680478
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12288856506347656  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02879047393798828
random selection method range initialization spend 0.0065937042236328125
time for parepare:  0.02294635772705078
local_output_nid generation:  0.0020182132720947266
local_in_edges_tensor generation:  0.005414724349975586
mini_batch_src_global generation:  0.004312992095947266
r_  generation:  0.010339975357055664
local_output_nid generation:  0.00185394287109375
local_in_edges_tensor generation:  0.001239776611328125
mini_batch_src_global generation:  0.0024063587188720703
r_  generation:  0.010671854019165039
local_output_nid generation:  0.0020532608032226562
local_in_edges_tensor generation:  0.001215219497680664
mini_batch_src_global generation:  0.0016200542449951172
r_  generation:  0.009955883026123047
local_output_nid generation:  0.0021209716796875
local_in_edges_tensor generation:  0.0012063980102539062
mini_batch_src_global generation:  0.0015399456024169922
r_  generation:  0.010159492492675781
local_output_nid generation:  0.0021507740020751953
local_in_edges_tensor generation:  0.0012066364288330078
mini_batch_src_global generation:  0.001486063003540039
r_  generation:  0.010281801223754883
local_output_nid generation:  0.0021893978118896484
local_in_edges_tensor generation:  0.0012156963348388672
mini_batch_src_global generation:  0.0014622211456298828
r_  generation:  0.010270118713378906
local_output_nid generation:  0.0022068023681640625
local_in_edges_tensor generation:  0.0012197494506835938
mini_batch_src_global generation:  0.0013701915740966797
r_  generation:  0.009659051895141602
local_output_nid generation:  0.0022253990173339844
local_in_edges_tensor generation:  0.0011839866638183594
mini_batch_src_global generation:  0.001535654067993164
r_  generation:  0.010516881942749023
local_output_nid generation:  0.002245664596557617
local_in_edges_tensor generation:  0.0011982917785644531
mini_batch_src_global generation:  0.0014829635620117188
r_  generation:  0.010198354721069336
local_output_nid generation:  0.0022716522216796875
local_in_edges_tensor generation:  0.0011730194091796875
mini_batch_src_global generation:  0.0015263557434082031
r_  generation:  0.010423660278320312
local_output_nid generation:  0.0022749900817871094
local_in_edges_tensor generation:  0.0011584758758544922
mini_batch_src_global generation:  0.0013968944549560547
r_  generation:  0.010551691055297852
local_output_nid generation:  0.002263784408569336
local_in_edges_tensor generation:  0.0012171268463134766
mini_batch_src_global generation:  0.0013875961303710938
r_  generation:  0.010402202606201172
local_output_nid generation:  0.0022764205932617188
local_in_edges_tensor generation:  0.001149892807006836
mini_batch_src_global generation:  0.0014295578002929688
r_  generation:  0.010704278945922852
local_output_nid generation:  0.002280712127685547
local_in_edges_tensor generation:  0.001249551773071289
mini_batch_src_global generation:  0.0013954639434814453
r_  generation:  0.010546207427978516
local_output_nid generation:  0.002257108688354492
local_in_edges_tensor generation:  0.0012001991271972656
mini_batch_src_global generation:  0.00142669677734375
r_  generation:  0.010946035385131836
local_output_nid generation:  0.0023031234741210938
local_in_edges_tensor generation:  0.001211404800415039
mini_batch_src_global generation:  0.0015835762023925781
r_  generation:  0.011204957962036133
local_output_nid generation:  0.002294778823852539
local_in_edges_tensor generation:  0.0012218952178955078
mini_batch_src_global generation:  0.0013942718505859375
r_  generation:  0.010505437850952148
local_output_nid generation:  0.0023267269134521484
local_in_edges_tensor generation:  0.0011966228485107422
mini_batch_src_global generation:  0.0013470649719238281
r_  generation:  0.010189294815063477
local_output_nid generation:  0.0023033618927001953
local_in_edges_tensor generation:  0.0011587142944335938
mini_batch_src_global generation:  0.0013458728790283203
r_  generation:  0.010408401489257812
local_output_nid generation:  0.002321958541870117
local_in_edges_tensor generation:  0.001184701919555664
mini_batch_src_global generation:  0.0014934539794921875
r_  generation:  0.010403633117675781
local_output_nid generation:  0.002321958541870117
local_in_edges_tensor generation:  0.001222372055053711
mini_batch_src_global generation:  0.0014178752899169922
r_  generation:  0.010656356811523438
local_output_nid generation:  0.002319812774658203
local_in_edges_tensor generation:  0.001195669174194336
mini_batch_src_global generation:  0.0014660358428955078
r_  generation:  0.010785579681396484
local_output_nid generation:  0.002360105514526367
local_in_edges_tensor generation:  0.0012378692626953125
mini_batch_src_global generation:  0.001447439193725586
r_  generation:  0.010944843292236328
local_output_nid generation:  0.0023622512817382812
local_in_edges_tensor generation:  0.001215219497680664
mini_batch_src_global generation:  0.0013515949249267578
r_  generation:  0.010316848754882812
local_output_nid generation:  0.002367734909057617
local_in_edges_tensor generation:  0.0012173652648925781
mini_batch_src_global generation:  0.0014333724975585938
r_  generation:  0.010181427001953125
local_output_nid generation:  0.002341747283935547
local_in_edges_tensor generation:  0.001188516616821289
mini_batch_src_global generation:  0.0013976097106933594
r_  generation:  0.010704517364501953
local_output_nid generation:  0.0023469924926757812
local_in_edges_tensor generation:  0.0012180805206298828
mini_batch_src_global generation:  0.0014178752899169922
r_  generation:  0.010713577270507812
local_output_nid generation:  0.00235748291015625
local_in_edges_tensor generation:  0.0012097358703613281
mini_batch_src_global generation:  0.001508951187133789
r_  generation:  0.010598182678222656
local_output_nid generation:  0.0023376941680908203
local_in_edges_tensor generation:  0.0011756420135498047
mini_batch_src_global generation:  0.0014281272888183594
r_  generation:  0.010643959045410156
local_output_nid generation:  0.0023386478424072266
local_in_edges_tensor generation:  0.001180887222290039
mini_batch_src_global generation:  0.001397848129272461
r_  generation:  0.010744094848632812
local_output_nid generation:  0.0023217201232910156
local_in_edges_tensor generation:  0.0011794567108154297
mini_batch_src_global generation:  0.0013682842254638672
r_  generation:  0.010278701782226562
local_output_nid generation:  0.0023488998413085938
local_in_edges_tensor generation:  0.0012025833129882812
mini_batch_src_global generation:  0.0014569759368896484
r_  generation:  0.010534524917602539
----------------------check_connections_block total spend ----------------------------- 0.6331560611724854
generate_one_block  0.026595115661621094
generate_one_block  0.02315688133239746
generate_one_block  0.019562244415283203
generate_one_block  0.018882274627685547
generate_one_block  0.018848657608032227
generate_one_block  0.018299341201782227
generate_one_block  0.017232179641723633
generate_one_block  0.018610477447509766
generate_one_block  0.018012285232543945
generate_one_block  0.0185396671295166
generate_one_block  0.018341541290283203
generate_one_block  0.02269911766052246
generate_one_block  0.01992177963256836
generate_one_block  0.018844127655029297
generate_one_block  0.019138574600219727
generate_one_block  0.019285202026367188
generate_one_block  0.01813340187072754
generate_one_block  0.017594337463378906
generate_one_block  0.01801133155822754
generate_one_block  0.017834901809692383
generate_one_block  0.018651485443115234
generate_one_block  0.018459081649780273
generate_one_block  0.018887042999267578
generate_one_block  0.017642974853515625
generate_one_block  0.01773977279663086
generate_one_block  0.01845407485961914
generate_one_block  0.018694400787353516
generate_one_block  0.018015384674072266
generate_one_block  0.018552303314208984
generate_one_block  0.01831650733947754
generate_one_block  0.017739057540893555
generate_one_block  0.01827692985534668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03831052780151367
gen group dst list time:  0.028737306594848633
time for parepare:  0.028865337371826172
local_output_nid generation:  0.009355306625366211
local_in_edges_tensor generation:  0.02072620391845703
mini_batch_src_global generation:  0.020111083984375
r_  generation:  0.15174245834350586
local_output_nid generation:  0.012044429779052734
local_in_edges_tensor generation:  0.01210474967956543
mini_batch_src_global generation:  0.029582500457763672
r_  generation:  0.1730642318725586
local_output_nid generation:  0.010753154754638672
local_in_edges_tensor generation:  0.03801536560058594
mini_batch_src_global generation:  0.03359413146972656
r_  generation:  0.15347528457641602
local_output_nid generation:  0.009618997573852539
local_in_edges_tensor generation:  0.009401559829711914
mini_batch_src_global generation:  0.0224153995513916
r_  generation:  0.15603137016296387
local_output_nid generation:  0.010959863662719727
local_in_edges_tensor generation:  0.010704517364501953
mini_batch_src_global generation:  0.021461963653564453
r_  generation:  0.16010379791259766
local_output_nid generation:  0.009042739868164062
local_in_edges_tensor generation:  0.00903773307800293
mini_batch_src_global generation:  0.022454500198364258
r_  generation:  0.159959077835083
local_output_nid generation:  0.008437871932983398
local_in_edges_tensor generation:  0.010274887084960938
mini_batch_src_global generation:  0.029247760772705078
r_  generation:  0.1560828685760498
local_output_nid generation:  0.013860702514648438
local_in_edges_tensor generation:  0.012785196304321289
mini_batch_src_global generation:  0.023459672927856445
r_  generation:  0.18119406700134277
local_output_nid generation:  0.013345479965209961
local_in_edges_tensor generation:  0.014461755752563477
mini_batch_src_global generation:  0.03885459899902344
r_  generation:  0.19283628463745117
local_output_nid generation:  0.010524749755859375
local_in_edges_tensor generation:  0.015839338302612305
mini_batch_src_global generation:  0.024640321731567383
r_  generation:  0.17206859588623047
local_output_nid generation:  0.010352611541748047
local_in_edges_tensor generation:  0.010428190231323242
mini_batch_src_global generation:  0.0242917537689209
r_  generation:  0.16547727584838867
local_output_nid generation:  0.010177373886108398
local_in_edges_tensor generation:  0.010495185852050781
mini_batch_src_global generation:  0.02319622039794922
r_  generation:  0.1627054214477539
local_output_nid generation:  0.009771108627319336
local_in_edges_tensor generation:  0.009911775588989258
mini_batch_src_global generation:  0.024349451065063477
r_  generation:  0.16450071334838867
local_output_nid generation:  0.009534597396850586
local_in_edges_tensor generation:  0.009113788604736328
mini_batch_src_global generation:  0.02339911460876465
r_  generation:  0.16432642936706543
local_output_nid generation:  0.009955644607543945
local_in_edges_tensor generation:  0.010240316390991211
mini_batch_src_global generation:  0.024657011032104492
r_  generation:  0.17043375968933105
local_output_nid generation:  0.009804248809814453
local_in_edges_tensor generation:  0.011067867279052734
mini_batch_src_global generation:  0.02191448211669922
r_  generation:  0.16909098625183105
local_output_nid generation:  0.009300470352172852
local_in_edges_tensor generation:  0.01042938232421875
mini_batch_src_global generation:  0.03121042251586914
r_  generation:  0.1652545928955078
local_output_nid generation:  0.014528989791870117
local_in_edges_tensor generation:  0.013432741165161133
mini_batch_src_global generation:  0.023897886276245117
r_  generation:  0.15373754501342773
local_output_nid generation:  0.009788274765014648
local_in_edges_tensor generation:  0.009324073791503906
mini_batch_src_global generation:  0.021145343780517578
r_  generation:  0.15932512283325195
local_output_nid generation:  0.009408235549926758
local_in_edges_tensor generation:  0.00895547866821289
mini_batch_src_global generation:  0.02049112319946289
r_  generation:  0.15782690048217773
local_output_nid generation:  0.009636402130126953
local_in_edges_tensor generation:  0.008424043655395508
mini_batch_src_global generation:  0.021448373794555664
r_  generation:  0.1663212776184082
local_output_nid generation:  0.00946950912475586
local_in_edges_tensor generation:  0.00880122184753418
mini_batch_src_global generation:  0.021184921264648438
r_  generation:  0.16503286361694336
local_output_nid generation:  0.009766101837158203
local_in_edges_tensor generation:  0.008582592010498047
mini_batch_src_global generation:  0.022327661514282227
r_  generation:  0.16646075248718262
local_output_nid generation:  0.009175539016723633
local_in_edges_tensor generation:  0.008317947387695312
mini_batch_src_global generation:  0.020453214645385742
r_  generation:  0.15734052658081055
local_output_nid generation:  0.00913238525390625
local_in_edges_tensor generation:  0.008883953094482422
mini_batch_src_global generation:  0.028687000274658203
r_  generation:  0.18318700790405273
local_output_nid generation:  0.010268211364746094
local_in_edges_tensor generation:  0.008702516555786133
mini_batch_src_global generation:  0.0220639705657959
r_  generation:  0.16495466232299805
local_output_nid generation:  0.009933948516845703
local_in_edges_tensor generation:  0.009222984313964844
mini_batch_src_global generation:  0.02119135856628418
r_  generation:  0.16563916206359863
local_output_nid generation:  0.009432077407836914
local_in_edges_tensor generation:  0.008659839630126953
mini_batch_src_global generation:  0.02127242088317871
r_  generation:  0.16159510612487793
local_output_nid generation:  0.00947427749633789
local_in_edges_tensor generation:  0.008582353591918945
mini_batch_src_global generation:  0.02126908302307129
r_  generation:  0.17115330696105957
local_output_nid generation:  0.01119685173034668
local_in_edges_tensor generation:  0.009179115295410156
mini_batch_src_global generation:  0.023360013961791992
r_  generation:  0.1650092601776123
local_output_nid generation:  0.009360551834106445
local_in_edges_tensor generation:  0.008979320526123047
mini_batch_src_global generation:  0.02060699462890625
r_  generation:  0.15767955780029297
local_output_nid generation:  0.00966644287109375
local_in_edges_tensor generation:  0.008692502975463867
mini_batch_src_global generation:  0.020955324172973633
r_  generation:  0.16329383850097656
----------------------check_connections_block total spend ----------------------------- 8.01302981376648
generate_one_block  0.21839499473571777
generate_one_block  0.20576047897338867
generate_one_block  0.19982385635375977
generate_one_block  0.20682644844055176
generate_one_block  0.22212958335876465
generate_one_block  0.20183658599853516
generate_one_block  0.1938343048095703
generate_one_block  0.20948481559753418
generate_one_block  0.19845819473266602
generate_one_block  0.2117774486541748
generate_one_block  0.20580339431762695
generate_one_block  0.20704197883605957
generate_one_block  0.21661686897277832
generate_one_block  0.22447752952575684
generate_one_block  0.22097063064575195
generate_one_block  0.22113800048828125
generate_one_block  0.20708465576171875
generate_one_block  0.20072197914123535
generate_one_block  0.20593905448913574
generate_one_block  0.20908713340759277
generate_one_block  0.21667265892028809
generate_one_block  0.21384334564208984
generate_one_block  0.2153489589691162
generate_one_block  0.2048053741455078
generate_one_block  0.20278358459472656
generate_one_block  0.21343660354614258
generate_one_block  0.21432805061340332
generate_one_block  0.20470738410949707
generate_one_block  0.20869970321655273
generate_one_block  0.2099621295928955
generate_one_block  0.19862079620361328
generate_one_block  0.20876550674438477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03643083572387695
gen group dst list time:  0.11502909660339355
time for parepare:  0.021587371826171875
local_output_nid generation:  0.02794480323791504
local_in_edges_tensor generation:  0.04689526557922363
mini_batch_src_global generation:  0.04881405830383301
r_  generation:  0.41512370109558105
local_output_nid generation:  0.03246903419494629
local_in_edges_tensor generation:  0.033799171447753906
mini_batch_src_global generation:  0.052272796630859375
r_  generation:  0.40569329261779785
local_output_nid generation:  0.032468557357788086
local_in_edges_tensor generation:  0.02645397186279297
mini_batch_src_global generation:  0.05797576904296875
r_  generation:  0.4251422882080078
local_output_nid generation:  0.03272509574890137
local_in_edges_tensor generation:  0.031770944595336914
mini_batch_src_global generation:  0.051886558532714844
r_  generation:  0.41202425956726074
local_output_nid generation:  0.03255105018615723
local_in_edges_tensor generation:  0.03105616569519043
mini_batch_src_global generation:  0.04734921455383301
r_  generation:  0.44444966316223145
local_output_nid generation:  0.03266000747680664
local_in_edges_tensor generation:  0.029764652252197266
mini_batch_src_global generation:  0.05010032653808594
r_  generation:  0.42199039459228516
local_output_nid generation:  0.030351877212524414
local_in_edges_tensor generation:  0.02849125862121582
mini_batch_src_global generation:  0.04861855506896973
r_  generation:  0.4270803928375244
local_output_nid generation:  0.032091379165649414
local_in_edges_tensor generation:  0.03659868240356445
mini_batch_src_global generation:  0.050560951232910156
r_  generation:  0.41145992279052734
local_output_nid generation:  0.030574560165405273
local_in_edges_tensor generation:  0.02838611602783203
mini_batch_src_global generation:  0.04746532440185547
r_  generation:  0.4191093444824219
local_output_nid generation:  0.03095722198486328
local_in_edges_tensor generation:  0.02856731414794922
mini_batch_src_global generation:  0.050553083419799805
r_  generation:  0.4199364185333252
local_output_nid generation:  0.03317904472351074
local_in_edges_tensor generation:  0.032259225845336914
mini_batch_src_global generation:  0.04800820350646973
r_  generation:  0.45037364959716797
local_output_nid generation:  0.03400754928588867
local_in_edges_tensor generation:  0.02874159812927246
mini_batch_src_global generation:  0.05098533630371094
r_  generation:  0.4116225242614746
local_output_nid generation:  0.029292821884155273
local_in_edges_tensor generation:  0.025745153427124023
mini_batch_src_global generation:  0.04802894592285156
r_  generation:  0.4246530532836914
local_output_nid generation:  0.029170751571655273
local_in_edges_tensor generation:  0.028766632080078125
mini_batch_src_global generation:  0.05002617835998535
r_  generation:  0.40958285331726074
local_output_nid generation:  0.029597043991088867
local_in_edges_tensor generation:  0.028035402297973633
mini_batch_src_global generation:  0.04797863960266113
r_  generation:  0.42984867095947266
local_output_nid generation:  0.0296630859375
local_in_edges_tensor generation:  0.027696609497070312
mini_batch_src_global generation:  0.05062222480773926
r_  generation:  0.4149458408355713
local_output_nid generation:  0.02915215492248535
local_in_edges_tensor generation:  0.028028249740600586
mini_batch_src_global generation:  0.04757213592529297
r_  generation:  0.4203784465789795
local_output_nid generation:  0.02878546714782715
local_in_edges_tensor generation:  0.03074812889099121
mini_batch_src_global generation:  0.04940223693847656
r_  generation:  0.4091627597808838
local_output_nid generation:  0.029263019561767578
local_in_edges_tensor generation:  0.02874588966369629
mini_batch_src_global generation:  0.0472722053527832
r_  generation:  0.4260241985321045
local_output_nid generation:  0.02925419807434082
local_in_edges_tensor generation:  0.02777409553527832
mini_batch_src_global generation:  0.05037403106689453
r_  generation:  0.4123499393463135
local_output_nid generation:  0.029486417770385742
local_in_edges_tensor generation:  0.031139612197875977
mini_batch_src_global generation:  0.049643516540527344
r_  generation:  0.4311039447784424
local_output_nid generation:  0.02933526039123535
local_in_edges_tensor generation:  0.031164169311523438
mini_batch_src_global generation:  0.05061173439025879
r_  generation:  0.4155251979827881
local_output_nid generation:  0.03041362762451172
local_in_edges_tensor generation:  0.03134799003601074
mini_batch_src_global generation:  0.04847264289855957
r_  generation:  0.4314131736755371
local_output_nid generation:  0.02910017967224121
local_in_edges_tensor generation:  0.03167533874511719
mini_batch_src_global generation:  0.049547672271728516
r_  generation:  0.42435741424560547
local_output_nid generation:  0.030810117721557617
local_in_edges_tensor generation:  0.029505252838134766
mini_batch_src_global generation:  0.04810595512390137
r_  generation:  0.42440199851989746
local_output_nid generation:  0.029469728469848633
local_in_edges_tensor generation:  0.028023958206176758
mini_batch_src_global generation:  0.05014181137084961
r_  generation:  0.4137306213378906
local_output_nid generation:  0.029587268829345703
local_in_edges_tensor generation:  0.02577686309814453
mini_batch_src_global generation:  0.04791522026062012
r_  generation:  0.42354702949523926
local_output_nid generation:  0.029074668884277344
local_in_edges_tensor generation:  0.027118444442749023
mini_batch_src_global generation:  0.0499730110168457
r_  generation:  0.4143259525299072
local_output_nid generation:  0.029035568237304688
local_in_edges_tensor generation:  0.03636503219604492
mini_batch_src_global generation:  0.04773736000061035
r_  generation:  0.42707252502441406
local_output_nid generation:  0.02924633026123047
local_in_edges_tensor generation:  0.02570509910583496
mini_batch_src_global generation:  0.05000114440917969
r_  generation:  0.41501450538635254
local_output_nid generation:  0.029222965240478516
local_in_edges_tensor generation:  0.03293108940124512
mini_batch_src_global generation:  0.04935264587402344
r_  generation:  0.42438793182373047
local_output_nid generation:  0.029214859008789062
local_in_edges_tensor generation:  0.027526140213012695
mini_batch_src_global generation:  0.05026960372924805
r_  generation:  0.41848134994506836
----------------------check_connections_block total spend ----------------------------- 20.059528589248657
generate_one_block  0.5765030384063721
generate_one_block  0.5605864524841309
generate_one_block  0.5541775226593018
generate_one_block  0.561530351638794
generate_one_block  0.6724977493286133
generate_one_block  0.5557620525360107
generate_one_block  0.5575990676879883
generate_one_block  0.5669658184051514
generate_one_block  0.5500531196594238
generate_one_block  0.567772388458252
generate_one_block  0.560563325881958
generate_one_block  0.5581161975860596
generate_one_block  0.5584263801574707
generate_one_block  0.5535628795623779
generate_one_block  0.5665922164916992
generate_one_block  0.5599901676177979
generate_one_block  0.553091287612915
generate_one_block  0.5448005199432373
generate_one_block  0.5538330078125
generate_one_block  0.5642571449279785
generate_one_block  0.5681483745574951
generate_one_block  0.5619111061096191
generate_one_block  0.5632956027984619
generate_one_block  0.5521259307861328
generate_one_block  0.564033031463623
generate_one_block  0.555211067199707
generate_one_block  0.5681252479553223
generate_one_block  0.5540058612823486
generate_one_block  0.5554447174072266
generate_one_block  0.5629982948303223
generate_one_block  0.5578618049621582
generate_one_block  0.5624477863311768
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.12288856506347656  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

connection checking time:  28.072558403015137
block generation total time  24.721471548080444
average batch blocks generation time:  0.7725459858775139
block dataloader generation time/epoch 54.752858340740204
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10523557662963867  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.815826892852783  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10486698150634766  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.052087783813477  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521411895751953  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.751497745513916  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10496377944946289  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.05868625640869  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10524892807006836  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.038413524627686  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10485506057739258  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.75714111328125  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10508918762207031  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.177759170532227  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10486316680908203  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.099809169769287  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10517740249633789  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.557448863983154  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10487794876098633  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.174612522125244  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526037216186523  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.06929302215576  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10462284088134766  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.981435775756836  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10528135299682617  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.095147132873535  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10462379455566406  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.082011222839355  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1053614616394043  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.457595348358154  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10496139526367188  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.426727771759033  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10521936416625977  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.77544641494751  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10455036163330078  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.364189624786377  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10522222518920898  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.758264541625977  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10463237762451172  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.66438627243042  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10530805587768555  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.254840850830078  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10447549819946289  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.140187740325928  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10532283782958984  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.29969549179077  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10438776016235352  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.618842601776123  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10516738891601562  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.564055919647217  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10487222671508789  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.133431911468506  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1052999496459961  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.216059684753418  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10465526580810547  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.753253936767578  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10526752471923828  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.045165538787842  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.1048130989074707  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 17.100089073181152  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10517311096191406  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.5968279838562  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 0.10497093200683594  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6522216796875 GB
    Memory Allocated: 16.8837571144104  GigaBytes
Max Memory Allocated: 17.72508144378662  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030982792377471924 |0.01570175588130951 |0.420082189142704 |9.258091449737549e-05 |0.7608701139688492 |0.00388336181640625 |
----------------------------------------------------------pseudo_mini_loss sum 1.2495322227478027
Total (block generation + training)time/epoch 94.00534780025482
Training time/epoch 39.348774909973145
Training time without block to device /epoch 38.84631872177124
Training time without total dataloading part /epoch 37.797319650650024
load block tensor time/epoch 0.9914493560791016
block to device time/epoch 0.5024561882019043
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  8798649
Number of first layer input nodes during this epoch:  4684226
