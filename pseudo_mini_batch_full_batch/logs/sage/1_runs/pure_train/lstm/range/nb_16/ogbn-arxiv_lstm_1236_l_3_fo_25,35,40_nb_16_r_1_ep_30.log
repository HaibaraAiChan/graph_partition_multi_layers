Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647796399.6017122
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024512290954589844
range selection method range initialization spend 0.01301121711730957
time for parepare:  0.017778396606445312
local_output_nid generation:  0.0013413429260253906
local_in_edges_tensor generation:  0.003865957260131836
mini_batch_src_global generation:  0.0017714500427246094
r_  generation:  0.01790308952331543
local_output_nid generation:  0.0014219284057617188
local_in_edges_tensor generation:  0.0008983612060546875
mini_batch_src_global generation:  0.002033233642578125
r_  generation:  0.017482280731201172
local_output_nid generation:  0.0014607906341552734
local_in_edges_tensor generation:  0.00084686279296875
mini_batch_src_global generation:  0.0012485980987548828
r_  generation:  0.016955852508544922
local_output_nid generation:  0.0014941692352294922
local_in_edges_tensor generation:  0.0008237361907958984
mini_batch_src_global generation:  0.0011434555053710938
r_  generation:  0.017380714416503906
local_output_nid generation:  0.0014429092407226562
local_in_edges_tensor generation:  0.0008544921875
mini_batch_src_global generation:  0.0013887882232666016
r_  generation:  0.01734304428100586
local_output_nid generation:  0.001451730728149414
local_in_edges_tensor generation:  0.0008335113525390625
mini_batch_src_global generation:  0.0012881755828857422
r_  generation:  0.01809215545654297
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.0008516311645507812
mini_batch_src_global generation:  0.0014874935150146484
r_  generation:  0.0185701847076416
local_output_nid generation:  0.0014805793762207031
local_in_edges_tensor generation:  0.0008540153503417969
mini_batch_src_global generation:  0.001482248306274414
r_  generation:  0.018224239349365234
local_output_nid generation:  0.0014793872833251953
local_in_edges_tensor generation:  0.0008499622344970703
mini_batch_src_global generation:  0.0014493465423583984
r_  generation:  0.0180971622467041
local_output_nid generation:  0.0014927387237548828
local_in_edges_tensor generation:  0.0008208751678466797
mini_batch_src_global generation:  0.0013141632080078125
r_  generation:  0.018258333206176758
local_output_nid generation:  0.0015521049499511719
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.0014486312866210938
r_  generation:  0.01877617835998535
local_output_nid generation:  0.0014977455139160156
local_in_edges_tensor generation:  0.0008263587951660156
mini_batch_src_global generation:  0.0013775825500488281
r_  generation:  0.017926454544067383
local_output_nid generation:  0.0014684200286865234
local_in_edges_tensor generation:  0.0008382797241210938
mini_batch_src_global generation:  0.0014786720275878906
r_  generation:  0.018548011779785156
local_output_nid generation:  0.0014622211456298828
local_in_edges_tensor generation:  0.0008420944213867188
mini_batch_src_global generation:  0.0014033317565917969
r_  generation:  0.01819896697998047
local_output_nid generation:  0.0014710426330566406
local_in_edges_tensor generation:  0.0008118152618408203
mini_batch_src_global generation:  0.0015411376953125
r_  generation:  0.018477916717529297
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.0008289813995361328
mini_batch_src_global generation:  0.0014374256134033203
r_  generation:  0.01887202262878418
----------------------check_connections_block total spend ----------------------------- 0.43577003479003906
generate_one_block  0.027150869369506836
generate_one_block  0.02695775032043457
generate_one_block  0.028326749801635742
generate_one_block  0.027525901794433594
generate_one_block  0.027467966079711914
generate_one_block  0.027547597885131836
generate_one_block  0.02811741828918457
generate_one_block  0.028108835220336914
generate_one_block  0.028467893600463867
generate_one_block  0.027932405471801758
generate_one_block  0.027915477752685547
generate_one_block  0.02683854103088379
generate_one_block  0.027483701705932617
generate_one_block  0.027342796325683594
generate_one_block  0.027068614959716797
generate_one_block  0.027463197708129883
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040782928466796875
gen group dst list time:  0.018637418746948242
time for parepare:  0.01863861083984375
local_output_nid generation:  0.006501197814941406
local_in_edges_tensor generation:  0.015494585037231445
mini_batch_src_global generation:  0.018523693084716797
r_  generation:  0.19226455688476562
local_output_nid generation:  0.009850740432739258
local_in_edges_tensor generation:  0.017634153366088867
mini_batch_src_global generation:  0.023171663284301758
r_  generation:  0.19292092323303223
local_output_nid generation:  0.009966611862182617
local_in_edges_tensor generation:  0.014724493026733398
mini_batch_src_global generation:  0.022385120391845703
r_  generation:  0.19989418983459473
local_output_nid generation:  0.010427713394165039
local_in_edges_tensor generation:  0.014946222305297852
mini_batch_src_global generation:  0.024070024490356445
r_  generation:  0.2051069736480713
local_output_nid generation:  0.010542154312133789
local_in_edges_tensor generation:  0.013396978378295898
mini_batch_src_global generation:  0.025019407272338867
r_  generation:  0.20730042457580566
local_output_nid generation:  0.010844945907592773
local_in_edges_tensor generation:  0.013708114624023438
mini_batch_src_global generation:  0.029108762741088867
r_  generation:  0.21304774284362793
local_output_nid generation:  0.01089620590209961
local_in_edges_tensor generation:  0.0175018310546875
mini_batch_src_global generation:  0.030104875564575195
r_  generation:  0.21392607688903809
local_output_nid generation:  0.011082649230957031
local_in_edges_tensor generation:  0.012292623519897461
mini_batch_src_global generation:  0.02711629867553711
r_  generation:  0.21168017387390137
local_output_nid generation:  0.010947942733764648
local_in_edges_tensor generation:  0.011833429336547852
mini_batch_src_global generation:  0.025694847106933594
r_  generation:  0.2080838680267334
local_output_nid generation:  0.01111459732055664
local_in_edges_tensor generation:  0.01180720329284668
mini_batch_src_global generation:  0.0276491641998291
r_  generation:  0.2088785171508789
local_output_nid generation:  0.011129617691040039
local_in_edges_tensor generation:  0.015661239624023438
mini_batch_src_global generation:  0.026614904403686523
r_  generation:  0.2166743278503418
local_output_nid generation:  0.010919809341430664
local_in_edges_tensor generation:  0.011743545532226562
mini_batch_src_global generation:  0.026378631591796875
r_  generation:  0.2041616439819336
local_output_nid generation:  0.01116037368774414
local_in_edges_tensor generation:  0.015168428421020508
mini_batch_src_global generation:  0.025944948196411133
r_  generation:  0.21574091911315918
local_output_nid generation:  0.011327981948852539
local_in_edges_tensor generation:  0.016050338745117188
mini_batch_src_global generation:  0.026946544647216797
r_  generation:  0.21299982070922852
local_output_nid generation:  0.011023521423339844
local_in_edges_tensor generation:  0.013918876647949219
mini_batch_src_global generation:  0.026448965072631836
r_  generation:  0.21013140678405762
local_output_nid generation:  0.011247873306274414
local_in_edges_tensor generation:  0.013936758041381836
mini_batch_src_global generation:  0.02629232406616211
r_  generation:  0.21241140365600586
----------------------check_connections_block total spend ----------------------------- 4.890604496002197
generate_one_block  0.2728593349456787
generate_one_block  0.2601437568664551
generate_one_block  0.2669851779937744
generate_one_block  0.2735426425933838
generate_one_block  0.2813119888305664
generate_one_block  0.2787613868713379
generate_one_block  0.27674055099487305
generate_one_block  0.2726013660430908
generate_one_block  0.2631049156188965
generate_one_block  0.26874756813049316
generate_one_block  0.27679014205932617
generate_one_block  0.2626049518585205
generate_one_block  0.2698936462402344
generate_one_block  0.2702298164367676
generate_one_block  0.27205681800842285
generate_one_block  0.2704463005065918
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03734445571899414
gen group dst list time:  0.05931210517883301
time for parepare:  0.01870131492614746
local_output_nid generation:  0.023205995559692383
local_in_edges_tensor generation:  0.03821396827697754
mini_batch_src_global generation:  0.04133439064025879
r_  generation:  0.44150352478027344
local_output_nid generation:  0.029222488403320312
local_in_edges_tensor generation:  0.04624176025390625
mini_batch_src_global generation:  0.05139660835266113
r_  generation:  0.44455718994140625
local_output_nid generation:  0.029143095016479492
local_in_edges_tensor generation:  0.046729326248168945
mini_batch_src_global generation:  0.0498502254486084
r_  generation:  0.452451229095459
local_output_nid generation:  0.029509544372558594
local_in_edges_tensor generation:  0.0355992317199707
mini_batch_src_global generation:  0.0529024600982666
r_  generation:  0.45485949516296387
local_output_nid generation:  0.02992701530456543
local_in_edges_tensor generation:  0.031020402908325195
mini_batch_src_global generation:  0.05234336853027344
r_  generation:  0.45614004135131836
local_output_nid generation:  0.030045747756958008
local_in_edges_tensor generation:  0.032474517822265625
mini_batch_src_global generation:  0.053075551986694336
r_  generation:  0.4577980041503906
local_output_nid generation:  0.030025720596313477
local_in_edges_tensor generation:  0.04726862907409668
mini_batch_src_global generation:  0.05182313919067383
r_  generation:  0.4703807830810547
local_output_nid generation:  0.030243635177612305
local_in_edges_tensor generation:  0.03188347816467285
mini_batch_src_global generation:  0.0529932975769043
r_  generation:  0.4518260955810547
local_output_nid generation:  0.02994370460510254
local_in_edges_tensor generation:  0.031305789947509766
mini_batch_src_global generation:  0.052230119705200195
r_  generation:  0.45917272567749023
local_output_nid generation:  0.030124425888061523
local_in_edges_tensor generation:  0.035425662994384766
mini_batch_src_global generation:  0.05599212646484375
r_  generation:  0.46024131774902344
local_output_nid generation:  0.03013324737548828
local_in_edges_tensor generation:  0.03586983680725098
mini_batch_src_global generation:  0.05534076690673828
r_  generation:  0.4595651626586914
local_output_nid generation:  0.029914379119873047
local_in_edges_tensor generation:  0.03193044662475586
mini_batch_src_global generation:  0.053777217864990234
r_  generation:  0.4547383785247803
local_output_nid generation:  0.02996230125427246
local_in_edges_tensor generation:  0.030799388885498047
mini_batch_src_global generation:  0.052521705627441406
r_  generation:  0.46314477920532227
local_output_nid generation:  0.030343055725097656
local_in_edges_tensor generation:  0.043676137924194336
mini_batch_src_global generation:  0.05357480049133301
r_  generation:  0.459857702255249
local_output_nid generation:  0.03018951416015625
local_in_edges_tensor generation:  0.03193855285644531
mini_batch_src_global generation:  0.05226016044616699
r_  generation:  0.45693492889404297
local_output_nid generation:  0.0303342342376709
local_in_edges_tensor generation:  0.035317182540893555
mini_batch_src_global generation:  0.05284738540649414
r_  generation:  0.46523571014404297
----------------------check_connections_block total spend ----------------------------- 10.785678148269653
generate_one_block  0.5739073753356934
generate_one_block  0.6178774833679199
generate_one_block  0.5960001945495605
generate_one_block  0.6103363037109375
generate_one_block  0.62247633934021
generate_one_block  0.6375861167907715
generate_one_block  0.6628379821777344
generate_one_block  0.63653564453125
generate_one_block  0.5828666687011719
generate_one_block  0.6014225482940674
generate_one_block  0.6155238151550293
generate_one_block  0.5821099281311035
generate_one_block  0.5892713069915771
generate_one_block  0.5909340381622314
generate_one_block  0.5949969291687012
generate_one_block  0.5851573944091797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  15.67628264427185
block generation total time  14.036660432815552
average batch blocks generation time:  0.877291277050972
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09504938125610352  GigaBytes
Max Memory Allocated: 0.09504938125610352  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9393310546875 GB
    Memory Allocated: 21.209571361541748  GigaBytes
Max Memory Allocated: 21.27013349533081  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1990966796875 GB
    Memory Allocated: 0.10036802291870117  GigaBytes
Max Memory Allocated: 21.27013349533081  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3455810546875 GB
    Memory Allocated: 20.752607822418213  GigaBytes
Max Memory Allocated: 21.27013349533081  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3475341796875 GB
    Memory Allocated: 0.10108089447021484  GigaBytes
Max Memory Allocated: 21.27013349533081  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0389404296875 GB
    Memory Allocated: 21.043256282806396  GigaBytes
Max Memory Allocated: 21.27013349533081  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 0.10068321228027344  GigaBytes
Max Memory Allocated: 21.27013349533081  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0662841796875 GB
    Memory Allocated: 21.07687759399414  GigaBytes
Max Memory Allocated: 21.27013349533081  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10104179382324219  GigaBytes
Max Memory Allocated: 21.27013349533081  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3260498046875 GB
    Memory Allocated: 20.98357343673706  GigaBytes
Max Memory Allocated: 21.27013349533081  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3260498046875 GB
    Memory Allocated: 0.10078096389770508  GigaBytes
Max Memory Allocated: 21.27013349533081  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1697998046875 GB
    Memory Allocated: 21.43240976333618  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6092529296875 GB
    Memory Allocated: 0.10076761245727539  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0740966796875 GB
    Memory Allocated: 21.40030527114868  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10074186325073242  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 21.292426586151123  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10057353973388672  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 21.033672332763672  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10063600540161133  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 21.08419704437256  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10056209564208984  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 21.273813724517822  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10044240951538086  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 20.734732627868652  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10045385360717773  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 21.09845495223999  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10069036483764648  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 21.192514419555664  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10049581527709961  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 20.972336292266846  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 0.10067224502563477  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1385498046875 GB
    Memory Allocated: 21.132719039916992  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04091854393482208 |0.03814888000488281 |0.41030777990818024 |0.00010086596012115479 |0.5898081362247467 |0.0069963932037353516 |
----------------------------------------------------------pseudo_mini_loss sum 5.388798713684082
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5093643
Number of first layer input nodes during this epoch:  2472116
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 0.13435792922973633  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02180194854736328
range selection method range initialization spend 0.015537738800048828
time for parepare:  0.017107486724853516
local_output_nid generation:  0.0016815662384033203
local_in_edges_tensor generation:  0.005574226379394531
mini_batch_src_global generation:  0.002098560333251953
r_  generation:  0.020010948181152344
local_output_nid generation:  0.001744985580444336
local_in_edges_tensor generation:  0.0009968280792236328
mini_batch_src_global generation:  0.002428770065307617
r_  generation:  0.020282506942749023
local_output_nid generation:  0.0017209053039550781
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0016255378723144531
r_  generation:  0.020207881927490234
local_output_nid generation:  0.0017714500427246094
local_in_edges_tensor generation:  0.0008945465087890625
mini_batch_src_global generation:  0.0016398429870605469
r_  generation:  0.020554304122924805
local_output_nid generation:  0.0017282962799072266
local_in_edges_tensor generation:  0.0009145736694335938
mini_batch_src_global generation:  0.0016264915466308594
r_  generation:  0.01866316795349121
local_output_nid generation:  0.0016584396362304688
local_in_edges_tensor generation:  0.0008976459503173828
mini_batch_src_global generation:  0.0014674663543701172
r_  generation:  0.01956629753112793
local_output_nid generation:  0.0016674995422363281
local_in_edges_tensor generation:  0.00091552734375
mini_batch_src_global generation:  0.0014300346374511719
r_  generation:  0.0196535587310791
local_output_nid generation:  0.0016684532165527344
local_in_edges_tensor generation:  0.000885009765625
mini_batch_src_global generation:  0.0014264583587646484
r_  generation:  0.018781423568725586
local_output_nid generation:  0.001646280288696289
local_in_edges_tensor generation:  0.0008780956268310547
mini_batch_src_global generation:  0.0013759136199951172
r_  generation:  0.019072294235229492
local_output_nid generation:  0.0016245841979980469
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.001432180404663086
r_  generation:  0.018930435180664062
local_output_nid generation:  0.0016069412231445312
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0014240741729736328
r_  generation:  0.019336938858032227
local_output_nid generation:  0.0016312599182128906
local_in_edges_tensor generation:  0.0009281635284423828
mini_batch_src_global generation:  0.0015192031860351562
r_  generation:  0.0196378231048584
local_output_nid generation:  0.001636505126953125
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.0014996528625488281
r_  generation:  0.019787073135375977
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.0008611679077148438
mini_batch_src_global generation:  0.0014650821685791016
r_  generation:  0.019587993621826172
local_output_nid generation:  0.0016260147094726562
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0014557838439941406
r_  generation:  0.019234895706176758
local_output_nid generation:  0.00164031982421875
local_in_edges_tensor generation:  0.0008981227874755859
mini_batch_src_global generation:  0.0014870166778564453
r_  generation:  0.020268678665161133
----------------------check_connections_block total spend ----------------------------- 0.474379301071167
generate_one_block  0.03604722023010254
generate_one_block  0.03124547004699707
generate_one_block  0.03136110305786133
generate_one_block  0.031468868255615234
generate_one_block  0.03203749656677246
generate_one_block  0.03463864326477051
generate_one_block  0.031893014907836914
generate_one_block  0.03155183792114258
generate_one_block  0.030651092529296875
generate_one_block  0.03140854835510254
generate_one_block  0.031435251235961914
generate_one_block  0.032480478286743164
generate_one_block  0.031769752502441406
generate_one_block  0.03127622604370117
generate_one_block  0.0316464900970459
generate_one_block  0.036037445068359375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06555843353271484
gen group dst list time:  0.017346620559692383
time for parepare:  0.019593238830566406
local_output_nid generation:  0.00704193115234375
local_in_edges_tensor generation:  0.018032550811767578
mini_batch_src_global generation:  0.02023768424987793
r_  generation:  0.18994450569152832
local_output_nid generation:  0.01077723503112793
local_in_edges_tensor generation:  0.017177820205688477
mini_batch_src_global generation:  0.02672410011291504
r_  generation:  0.19852352142333984
local_output_nid generation:  0.01133418083190918
local_in_edges_tensor generation:  0.015896081924438477
mini_batch_src_global generation:  0.0256040096282959
r_  generation:  0.20393037796020508
local_output_nid generation:  0.012071371078491211
local_in_edges_tensor generation:  0.014414310455322266
mini_batch_src_global generation:  0.02585911750793457
r_  generation:  0.20381593704223633
local_output_nid generation:  0.012070178985595703
local_in_edges_tensor generation:  0.01457357406616211
mini_batch_src_global generation:  0.026897430419921875
r_  generation:  0.20943522453308105
local_output_nid generation:  0.014864206314086914
local_in_edges_tensor generation:  0.015214920043945312
mini_batch_src_global generation:  0.02767181396484375
r_  generation:  0.21366620063781738
local_output_nid generation:  0.011909008026123047
local_in_edges_tensor generation:  0.01170206069946289
mini_batch_src_global generation:  0.026150941848754883
r_  generation:  0.20796823501586914
local_output_nid generation:  0.011918306350708008
local_in_edges_tensor generation:  0.011029720306396484
mini_batch_src_global generation:  0.02567577362060547
r_  generation:  0.21172142028808594
local_output_nid generation:  0.011952877044677734
local_in_edges_tensor generation:  0.011429309844970703
mini_batch_src_global generation:  0.025614500045776367
r_  generation:  0.20850872993469238
local_output_nid generation:  0.012018918991088867
local_in_edges_tensor generation:  0.01492452621459961
mini_batch_src_global generation:  0.025843381881713867
r_  generation:  0.20776844024658203
local_output_nid generation:  0.012188911437988281
local_in_edges_tensor generation:  0.01325368881225586
mini_batch_src_global generation:  0.02775263786315918
r_  generation:  0.2087564468383789
local_output_nid generation:  0.012453079223632812
local_in_edges_tensor generation:  0.013841629028320312
mini_batch_src_global generation:  0.026526212692260742
r_  generation:  0.21486258506774902
local_output_nid generation:  0.012252569198608398
local_in_edges_tensor generation:  0.015215158462524414
mini_batch_src_global generation:  0.026686429977416992
r_  generation:  0.21205759048461914
local_output_nid generation:  0.012279033660888672
local_in_edges_tensor generation:  0.011558771133422852
mini_batch_src_global generation:  0.026356935501098633
r_  generation:  0.21094346046447754
local_output_nid generation:  0.012294769287109375
local_in_edges_tensor generation:  0.013664722442626953
mini_batch_src_global generation:  0.026276111602783203
r_  generation:  0.2081756591796875
local_output_nid generation:  0.012372970581054688
local_in_edges_tensor generation:  0.013525247573852539
mini_batch_src_global generation:  0.02809429168701172
r_  generation:  0.21584081649780273
----------------------check_connections_block total spend ----------------------------- 4.910711765289307
generate_one_block  0.27905750274658203
generate_one_block  0.27426767349243164
generate_one_block  0.283419132232666
generate_one_block  0.27549099922180176
generate_one_block  0.28122520446777344
generate_one_block  0.28710055351257324
generate_one_block  0.29811859130859375
generate_one_block  0.278287410736084
generate_one_block  0.2747476100921631
generate_one_block  0.2770192623138428
generate_one_block  0.27959108352661133
generate_one_block  0.28565478324890137
generate_one_block  0.2803196907043457
generate_one_block  0.28356122970581055
generate_one_block  0.2867453098297119
generate_one_block  0.2817261219024658
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0334928035736084
gen group dst list time:  0.06411910057067871
time for parepare:  0.018741369247436523
local_output_nid generation:  0.025951385498046875
local_in_edges_tensor generation:  0.058106184005737305
mini_batch_src_global generation:  0.04126262664794922
r_  generation:  0.43852972984313965
local_output_nid generation:  0.029815196990966797
local_in_edges_tensor generation:  0.04464602470397949
mini_batch_src_global generation:  0.05998706817626953
r_  generation:  0.4555954933166504
local_output_nid generation:  0.03179502487182617
local_in_edges_tensor generation:  0.04268598556518555
mini_batch_src_global generation:  0.05678081512451172
r_  generation:  0.4523451328277588
local_output_nid generation:  0.031850576400756836
local_in_edges_tensor generation:  0.03865766525268555
mini_batch_src_global generation:  0.051755666732788086
r_  generation:  0.4462418556213379
local_output_nid generation:  0.03195977210998535
local_in_edges_tensor generation:  0.09050941467285156
mini_batch_src_global generation:  0.054262399673461914
r_  generation:  0.45137476921081543
local_output_nid generation:  0.03020763397216797
local_in_edges_tensor generation:  0.03756880760192871
mini_batch_src_global generation:  0.05181550979614258
r_  generation:  0.45014500617980957
local_output_nid generation:  0.030270099639892578
local_in_edges_tensor generation:  0.029759883880615234
mini_batch_src_global generation:  0.05158829689025879
r_  generation:  0.4510788917541504
local_output_nid generation:  0.030399084091186523
local_in_edges_tensor generation:  0.033109188079833984
mini_batch_src_global generation:  0.05529379844665527
r_  generation:  0.45197319984436035
local_output_nid generation:  0.030390501022338867
local_in_edges_tensor generation:  0.0415186882019043
mini_batch_src_global generation:  0.05153298377990723
r_  generation:  0.4546067714691162
local_output_nid generation:  0.03059077262878418
local_in_edges_tensor generation:  0.030421733856201172
mini_batch_src_global generation:  0.053255319595336914
r_  generation:  0.4601609706878662
local_output_nid generation:  0.03080916404724121
local_in_edges_tensor generation:  0.03027939796447754
mini_batch_src_global generation:  0.05161595344543457
r_  generation:  0.4583721160888672
local_output_nid generation:  0.030713796615600586
local_in_edges_tensor generation:  0.039032697677612305
mini_batch_src_global generation:  0.05526423454284668
r_  generation:  0.4640352725982666
local_output_nid generation:  0.0307466983795166
local_in_edges_tensor generation:  0.030768394470214844
mini_batch_src_global generation:  0.05177474021911621
r_  generation:  0.457089900970459
local_output_nid generation:  0.03094625473022461
local_in_edges_tensor generation:  0.03379559516906738
mini_batch_src_global generation:  0.05266594886779785
r_  generation:  0.45037198066711426
local_output_nid generation:  0.030780792236328125
local_in_edges_tensor generation:  0.034697532653808594
mini_batch_src_global generation:  0.051538944244384766
r_  generation:  0.4535040855407715
local_output_nid generation:  0.030869722366333008
local_in_edges_tensor generation:  0.0457763671875
mini_batch_src_global generation:  0.05198168754577637
r_  generation:  0.45038342475891113
----------------------check_connections_block total spend ----------------------------- 10.816136598587036
generate_one_block  0.6096470355987549
generate_one_block  0.5952413082122803
generate_one_block  0.590709924697876
generate_one_block  0.59698486328125
generate_one_block  0.6004693508148193
generate_one_block  0.6018965244293213
generate_one_block  0.5843634605407715
generate_one_block  0.5832362174987793
generate_one_block  0.635077714920044
generate_one_block  0.5902597904205322
generate_one_block  0.602240800857544
generate_one_block  0.6195275783538818
generate_one_block  0.5961883068084717
generate_one_block  0.5855281352996826
generate_one_block  0.5909192562103271
generate_one_block  0.5963754653930664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 0.13435792922973633  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

connection checking time:  15.726848363876343
block generation total time  14.08499789237976
average batch blocks generation time:  0.880312368273735
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 0.11106300354003906  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 21.18217134475708  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 0.11099767684936523  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 20.96809673309326  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 0.1109156608581543  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 21.143876552581787  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 0.11101961135864258  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 20.99721336364746  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 0.11115694046020508  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 21.223556518554688  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1405029296875 GB
    Memory Allocated: 0.11127328872680664  GigaBytes
Max Memory Allocated: 21.493731021881104  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.4536395072937  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11089086532592773  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.03573179244995  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11101579666137695  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 20.942378997802734  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11081504821777344  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 20.930949211120605  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11101579666137695  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.005778312683105  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11112403869628906  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.036762237548828  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11130046844482422  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.355817317962646  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11106300354003906  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.16187286376953  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11113357543945312  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.090556621551514  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11101245880126953  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.014492988586426  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.1111917495727539  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.22134256362915  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03669646382331848 |0.015638232231140137 |0.3066449612379074 |9.59634780883789e-05 |0.5739107429981232 |0.006268024444580078 |
----------------------------------------------------------pseudo_mini_loss sum 3.8686647415161133
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5091419
Number of first layer input nodes during this epoch:  2471757
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.13501596450805664  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028281450271606445
range selection method range initialization spend 0.01273655891418457
time for parepare:  0.017658472061157227
local_output_nid generation:  0.0016372203826904297
local_in_edges_tensor generation:  0.0076389312744140625
mini_batch_src_global generation:  0.002066373825073242
r_  generation:  0.018505573272705078
local_output_nid generation:  0.0018427371978759766
local_in_edges_tensor generation:  0.0013184547424316406
mini_batch_src_global generation:  0.002335786819458008
r_  generation:  0.018958330154418945
local_output_nid generation:  0.001764059066772461
local_in_edges_tensor generation:  0.0012407302856445312
mini_batch_src_global generation:  0.002013683319091797
r_  generation:  0.018546581268310547
local_output_nid generation:  0.0017266273498535156
local_in_edges_tensor generation:  0.0012083053588867188
mini_batch_src_global generation:  0.0012998580932617188
r_  generation:  0.018282651901245117
local_output_nid generation:  0.0017483234405517578
local_in_edges_tensor generation:  0.0013701915740966797
mini_batch_src_global generation:  0.0016791820526123047
r_  generation:  0.019213199615478516
local_output_nid generation:  0.0016641616821289062
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0014722347259521484
r_  generation:  0.018828392028808594
local_output_nid generation:  0.0016489028930664062
local_in_edges_tensor generation:  0.0010149478912353516
mini_batch_src_global generation:  0.0016169548034667969
r_  generation:  0.019643306732177734
local_output_nid generation:  0.0016613006591796875
local_in_edges_tensor generation:  0.0009868144989013672
mini_batch_src_global generation:  0.001580953598022461
r_  generation:  0.019265174865722656
local_output_nid generation:  0.0017077922821044922
local_in_edges_tensor generation:  0.0010807514190673828
mini_batch_src_global generation:  0.0016012191772460938
r_  generation:  0.0191652774810791
local_output_nid generation:  0.0017175674438476562
local_in_edges_tensor generation:  0.000885009765625
mini_batch_src_global generation:  0.0014719963073730469
r_  generation:  0.01925063133239746
local_output_nid generation:  0.0016808509826660156
local_in_edges_tensor generation:  0.0012307167053222656
mini_batch_src_global generation:  0.0015001296997070312
r_  generation:  0.018906831741333008
local_output_nid generation:  0.0016460418701171875
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0014796257019042969
r_  generation:  0.019394874572753906
local_output_nid generation:  0.0016870498657226562
local_in_edges_tensor generation:  0.0010149478912353516
mini_batch_src_global generation:  0.001486063003540039
r_  generation:  0.019646644592285156
local_output_nid generation:  0.0016453266143798828
local_in_edges_tensor generation:  0.0010526180267333984
mini_batch_src_global generation:  0.0015110969543457031
r_  generation:  0.019957542419433594
local_output_nid generation:  0.001657724380493164
local_in_edges_tensor generation:  0.0010581016540527344
mini_batch_src_global generation:  0.0015032291412353516
r_  generation:  0.019100427627563477
local_output_nid generation:  0.0016796588897705078
local_in_edges_tensor generation:  0.0009014606475830078
mini_batch_src_global generation:  0.0014641284942626953
r_  generation:  0.01930832862854004
----------------------check_connections_block total spend ----------------------------- 0.4713888168334961
generate_one_block  0.03892660140991211
generate_one_block  0.0318601131439209
generate_one_block  0.03124403953552246
generate_one_block  0.031143665313720703
generate_one_block  0.03178906440734863
generate_one_block  0.03287220001220703
generate_one_block  0.03168129920959473
generate_one_block  0.031225204467773438
generate_one_block  0.031130075454711914
generate_one_block  0.031095504760742188
generate_one_block  0.030875444412231445
generate_one_block  0.031183242797851562
generate_one_block  0.03165245056152344
generate_one_block  0.0321352481842041
generate_one_block  0.03034353256225586
generate_one_block  0.031244516372680664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05770707130432129
gen group dst list time:  0.016628265380859375
time for parepare:  0.019316434860229492
local_output_nid generation:  0.0072176456451416016
local_in_edges_tensor generation:  0.022988080978393555
mini_batch_src_global generation:  0.01917576789855957
r_  generation:  0.1889636516571045
local_output_nid generation:  0.010545492172241211
local_in_edges_tensor generation:  0.013994216918945312
mini_batch_src_global generation:  0.025648832321166992
r_  generation:  0.20344138145446777
local_output_nid generation:  0.010734319686889648
local_in_edges_tensor generation:  0.011271953582763672
mini_batch_src_global generation:  0.024851322174072266
r_  generation:  0.20592641830444336
local_output_nid generation:  0.01142430305480957
local_in_edges_tensor generation:  0.011182069778442383
mini_batch_src_global generation:  0.03868865966796875
r_  generation:  0.20926117897033691
local_output_nid generation:  0.011560916900634766
local_in_edges_tensor generation:  0.013042449951171875
mini_batch_src_global generation:  0.030363082885742188
r_  generation:  0.21416687965393066
local_output_nid generation:  0.011722087860107422
local_in_edges_tensor generation:  0.011385917663574219
mini_batch_src_global generation:  0.025873899459838867
r_  generation:  0.21386933326721191
local_output_nid generation:  0.013177871704101562
local_in_edges_tensor generation:  0.01265096664428711
mini_batch_src_global generation:  0.028389692306518555
r_  generation:  0.21809744834899902
local_output_nid generation:  0.012202978134155273
local_in_edges_tensor generation:  0.014867067337036133
mini_batch_src_global generation:  0.031014680862426758
r_  generation:  0.21350455284118652
local_output_nid generation:  0.012313127517700195
local_in_edges_tensor generation:  0.017110586166381836
mini_batch_src_global generation:  0.027262210845947266
r_  generation:  0.20897984504699707
local_output_nid generation:  0.012139320373535156
local_in_edges_tensor generation:  0.01113581657409668
mini_batch_src_global generation:  0.026950359344482422
r_  generation:  0.217026948928833
local_output_nid generation:  0.011538028717041016
local_in_edges_tensor generation:  0.013901710510253906
mini_batch_src_global generation:  0.02678966522216797
r_  generation:  0.2089707851409912
local_output_nid generation:  0.011826276779174805
local_in_edges_tensor generation:  0.01298379898071289
mini_batch_src_global generation:  0.03101491928100586
r_  generation:  0.21640706062316895
local_output_nid generation:  0.011787891387939453
local_in_edges_tensor generation:  0.011892557144165039
mini_batch_src_global generation:  0.026493072509765625
r_  generation:  0.2196943759918213
local_output_nid generation:  0.01205754280090332
local_in_edges_tensor generation:  0.013858795166015625
mini_batch_src_global generation:  0.02754998207092285
r_  generation:  0.21736407279968262
local_output_nid generation:  0.011636972427368164
local_in_edges_tensor generation:  0.011549234390258789
mini_batch_src_global generation:  0.026268959045410156
r_  generation:  0.21033239364624023
local_output_nid generation:  0.011757850646972656
local_in_edges_tensor generation:  0.012603521347045898
mini_batch_src_global generation:  0.026236295700073242
r_  generation:  0.2101118564605713
----------------------check_connections_block total spend ----------------------------- 4.982033729553223
generate_one_block  0.2817652225494385
generate_one_block  0.28377747535705566
generate_one_block  0.2837834358215332
generate_one_block  0.28446221351623535
generate_one_block  0.28431177139282227
generate_one_block  0.2800099849700928
generate_one_block  0.30669641494750977
generate_one_block  0.2810835838317871
generate_one_block  0.27565717697143555
generate_one_block  0.28386974334716797
generate_one_block  0.2756171226501465
generate_one_block  0.27874255180358887
generate_one_block  0.2860298156738281
generate_one_block  0.29052114486694336
generate_one_block  0.2733783721923828
generate_one_block  0.2744593620300293
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03810477256774902
gen group dst list time:  0.059624433517456055
time for parepare:  0.01711583137512207
local_output_nid generation:  0.02558612823486328
local_in_edges_tensor generation:  0.04890108108520508
mini_batch_src_global generation:  0.04265952110290527
r_  generation:  0.43794846534729004
local_output_nid generation:  0.02991175651550293
local_in_edges_tensor generation:  0.038046836853027344
mini_batch_src_global generation:  0.05296206474304199
r_  generation:  0.4464137554168701
local_output_nid generation:  0.03061223030090332
local_in_edges_tensor generation:  0.030326128005981445
mini_batch_src_global generation:  0.05280447006225586
r_  generation:  0.4517383575439453
local_output_nid generation:  0.03094005584716797
local_in_edges_tensor generation:  0.03300595283508301
mini_batch_src_global generation:  0.05182695388793945
r_  generation:  0.4480118751525879
local_output_nid generation:  0.030675172805786133
local_in_edges_tensor generation:  0.07557964324951172
mini_batch_src_global generation:  0.05112266540527344
r_  generation:  0.46399903297424316
local_output_nid generation:  0.031150341033935547
local_in_edges_tensor generation:  0.032419443130493164
mini_batch_src_global generation:  0.053053855895996094
r_  generation:  0.4553709030151367
local_output_nid generation:  0.03095412254333496
local_in_edges_tensor generation:  0.02953195571899414
mini_batch_src_global generation:  0.05364227294921875
r_  generation:  0.45696115493774414
local_output_nid generation:  0.0312497615814209
local_in_edges_tensor generation:  0.03192305564880371
mini_batch_src_global generation:  0.05219149589538574
r_  generation:  0.46088314056396484
local_output_nid generation:  0.03259563446044922
local_in_edges_tensor generation:  0.03146052360534668
mini_batch_src_global generation:  0.052175283432006836
r_  generation:  0.4601926803588867
local_output_nid generation:  0.031912803649902344
local_in_edges_tensor generation:  0.03418874740600586
mini_batch_src_global generation:  0.05451846122741699
r_  generation:  0.46074581146240234
local_output_nid generation:  0.03176522254943848
local_in_edges_tensor generation:  0.03005814552307129
mini_batch_src_global generation:  0.05196881294250488
r_  generation:  0.4633634090423584
local_output_nid generation:  0.032013654708862305
local_in_edges_tensor generation:  0.030522823333740234
mini_batch_src_global generation:  0.05238008499145508
r_  generation:  0.4539196491241455
local_output_nid generation:  0.03176140785217285
local_in_edges_tensor generation:  0.03288888931274414
mini_batch_src_global generation:  0.05337381362915039
r_  generation:  0.4604203701019287
local_output_nid generation:  0.032111167907714844
local_in_edges_tensor generation:  0.03165936470031738
mini_batch_src_global generation:  0.05489802360534668
r_  generation:  0.4555063247680664
local_output_nid generation:  0.03226184844970703
local_in_edges_tensor generation:  0.03035259246826172
mini_batch_src_global generation:  0.05249762535095215
r_  generation:  0.46114253997802734
local_output_nid generation:  0.03218483924865723
local_in_edges_tensor generation:  0.029977083206176758
mini_batch_src_global generation:  0.052167654037475586
r_  generation:  0.45241785049438477
----------------------check_connections_block total spend ----------------------------- 10.788878679275513
generate_one_block  0.5910794734954834
generate_one_block  0.6092314720153809
generate_one_block  0.5815713405609131
generate_one_block  0.5856168270111084
generate_one_block  0.5899274349212646
generate_one_block  0.5885045528411865
generate_one_block  0.5955297946929932
generate_one_block  0.5820169448852539
generate_one_block  0.6499533653259277
generate_one_block  0.5924017429351807
generate_one_block  0.5876357555389404
generate_one_block  0.5816967487335205
generate_one_block  0.5965423583984375
generate_one_block  0.607703685760498
generate_one_block  0.5830035209655762
generate_one_block  0.5924170017242432
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.13501596450805664  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

connection checking time:  15.770912408828735
block generation total time  14.038997411727905
average batch blocks generation time:  0.8774373382329941
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11081600189208984  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 20.90794563293457  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11122894287109375  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.244810104370117  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11104154586791992  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.109508514404297  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11118412017822266  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.173739910125732  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11118030548095703  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.221360206604004  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11114978790283203  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.098376274108887  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11110305786132812  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.34435224533081  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11116504669189453  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.142999172210693  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11069774627685547  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 20.885045528411865  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11119556427001953  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.222890853881836  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11084890365600586  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 20.896480083465576  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11106204986572266  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.031169891357422  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11101436614990234  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.2723650932312  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 0.11134529113769531  GigaBytes
Max Memory Allocated: 21.515650272369385  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 21.49232769012451  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.11083745956420898  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5096435546875 GB
    Memory Allocated: 20.90746545791626  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5115966796875 GB
    Memory Allocated: 0.11105060577392578  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7147216796875 GB
    Memory Allocated: 20.91678476333618  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03798729181289673 |0.01676611602306366 |0.3193386495113373 |9.82433557510376e-05 |0.5670712143182755 |0.004885673522949219 |
----------------------------------------------------------pseudo_mini_loss sum 3.3473968505859375
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5090358
Number of first layer input nodes during this epoch:  2470831
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.7147216796875 GB
    Memory Allocated: 0.13453102111816406  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02198648452758789
range selection method range initialization spend 0.016260623931884766
time for parepare:  0.020595788955688477
local_output_nid generation:  0.0016644001007080078
local_in_edges_tensor generation:  0.008065223693847656
mini_batch_src_global generation:  0.0023431777954101562
r_  generation:  0.02089238166809082
local_output_nid generation:  0.0018720626831054688
local_in_edges_tensor generation:  0.0015821456909179688
mini_batch_src_global generation:  0.0025262832641601562
r_  generation:  0.021767854690551758
local_output_nid generation:  0.001756429672241211
local_in_edges_tensor generation:  0.0013027191162109375
mini_batch_src_global generation:  0.0018832683563232422
r_  generation:  0.0214996337890625
local_output_nid generation:  0.001729726791381836
local_in_edges_tensor generation:  0.0009446144104003906
mini_batch_src_global generation:  0.0018036365509033203
r_  generation:  0.021349191665649414
local_output_nid generation:  0.0016896724700927734
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0036771297454833984
r_  generation:  0.020914316177368164
local_output_nid generation:  0.0017542839050292969
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.0019042491912841797
r_  generation:  0.02158665657043457
local_output_nid generation:  0.0016918182373046875
local_in_edges_tensor generation:  0.001110076904296875
mini_batch_src_global generation:  0.0018391609191894531
r_  generation:  0.03323173522949219
local_output_nid generation:  0.0022134780883789062
local_in_edges_tensor generation:  0.0010941028594970703
mini_batch_src_global generation:  0.0016908645629882812
r_  generation:  0.018453359603881836
local_output_nid generation:  0.001989603042602539
local_in_edges_tensor generation:  0.0012001991271972656
mini_batch_src_global generation:  0.0015120506286621094
r_  generation:  0.01785755157470703
local_output_nid generation:  0.0019218921661376953
local_in_edges_tensor generation:  0.0015110969543457031
mini_batch_src_global generation:  0.0015478134155273438
r_  generation:  0.018268108367919922
local_output_nid generation:  0.0018792152404785156
local_in_edges_tensor generation:  0.0011677742004394531
mini_batch_src_global generation:  0.001425027847290039
r_  generation:  0.018619060516357422
local_output_nid generation:  0.0018782615661621094
local_in_edges_tensor generation:  0.0011572837829589844
mini_batch_src_global generation:  0.001543283462524414
r_  generation:  0.018332481384277344
local_output_nid generation:  0.0018346309661865234
local_in_edges_tensor generation:  0.0010116100311279297
mini_batch_src_global generation:  0.001398324966430664
r_  generation:  0.018663406372070312
local_output_nid generation:  0.0018396377563476562
local_in_edges_tensor generation:  0.0009968280792236328
mini_batch_src_global generation:  0.0015747547149658203
r_  generation:  0.01840519905090332
local_output_nid generation:  0.0017981529235839844
local_in_edges_tensor generation:  0.0010783672332763672
mini_batch_src_global generation:  0.0015342235565185547
r_  generation:  0.018474340438842773
local_output_nid generation:  0.0018181800842285156
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0015106201171875
r_  generation:  0.01889824867248535
----------------------check_connections_block total spend ----------------------------- 0.5111668109893799
generate_one_block  0.03888821601867676
generate_one_block  0.03229331970214844
generate_one_block  0.032878875732421875
generate_one_block  0.03176403045654297
generate_one_block  0.040433406829833984
generate_one_block  0.04283952713012695
generate_one_block  0.03583359718322754
generate_one_block  0.03295302391052246
generate_one_block  0.052776336669921875
generate_one_block  0.03553652763366699
generate_one_block  0.034264326095581055
generate_one_block  0.03298616409301758
generate_one_block  0.03354501724243164
generate_one_block  0.03372764587402344
generate_one_block  0.03330087661743164
generate_one_block  0.032793521881103516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035750389099121094
gen group dst list time:  0.016683340072631836
time for parepare:  0.019416332244873047
local_output_nid generation:  0.0072727203369140625
local_in_edges_tensor generation:  0.02062082290649414
mini_batch_src_global generation:  0.019039630889892578
r_  generation:  0.21274876594543457
local_output_nid generation:  0.010433435440063477
local_in_edges_tensor generation:  0.012056589126586914
mini_batch_src_global generation:  0.024060726165771484
r_  generation:  0.20066332817077637
local_output_nid generation:  0.010819435119628906
local_in_edges_tensor generation:  0.012393474578857422
mini_batch_src_global generation:  0.03397226333618164
r_  generation:  0.2113962173461914
local_output_nid generation:  0.011454105377197266
local_in_edges_tensor generation:  0.011674880981445312
mini_batch_src_global generation:  0.02426457405090332
r_  generation:  0.2105882167816162
local_output_nid generation:  0.011392831802368164
local_in_edges_tensor generation:  0.01099252700805664
mini_batch_src_global generation:  0.025069713592529297
r_  generation:  0.2092435359954834
local_output_nid generation:  0.0121002197265625
local_in_edges_tensor generation:  0.01127004623413086
mini_batch_src_global generation:  0.027234315872192383
r_  generation:  0.22142696380615234
local_output_nid generation:  0.01221323013305664
local_in_edges_tensor generation:  0.012054204940795898
mini_batch_src_global generation:  0.029112577438354492
r_  generation:  0.2199113368988037
local_output_nid generation:  0.01220393180847168
local_in_edges_tensor generation:  0.011219263076782227
mini_batch_src_global generation:  0.028952360153198242
r_  generation:  0.2138051986694336
local_output_nid generation:  0.011993169784545898
local_in_edges_tensor generation:  0.011081218719482422
mini_batch_src_global generation:  0.026236295700073242
r_  generation:  0.2135179042816162
local_output_nid generation:  0.012308835983276367
local_in_edges_tensor generation:  0.012998104095458984
mini_batch_src_global generation:  0.029817819595336914
r_  generation:  0.22096538543701172
local_output_nid generation:  0.012269973754882812
local_in_edges_tensor generation:  0.011406660079956055
mini_batch_src_global generation:  0.027773141860961914
r_  generation:  0.21806573867797852
local_output_nid generation:  0.012284040451049805
local_in_edges_tensor generation:  0.012293100357055664
mini_batch_src_global generation:  0.026640892028808594
r_  generation:  0.2807765007019043
local_output_nid generation:  0.013232231140136719
local_in_edges_tensor generation:  0.015396356582641602
mini_batch_src_global generation:  0.04167938232421875
r_  generation:  0.22567534446716309
local_output_nid generation:  0.01188516616821289
local_in_edges_tensor generation:  0.015669584274291992
mini_batch_src_global generation:  0.03215336799621582
r_  generation:  0.23294711112976074
local_output_nid generation:  0.01197957992553711
local_in_edges_tensor generation:  0.015833616256713867
mini_batch_src_global generation:  0.026578903198242188
r_  generation:  0.21795988082885742
local_output_nid generation:  0.013137578964233398
local_in_edges_tensor generation:  0.011801004409790039
mini_batch_src_global generation:  0.026493072509765625
r_  generation:  0.2146129608154297
----------------------check_connections_block total spend ----------------------------- 5.154218673706055
generate_one_block  0.28794050216674805
generate_one_block  0.2775611877441406
generate_one_block  0.28566646575927734
generate_one_block  0.2763330936431885
generate_one_block  0.27504491806030273
generate_one_block  0.2881150245666504
generate_one_block  0.3092942237854004
generate_one_block  0.27882814407348633
generate_one_block  0.2741553783416748
generate_one_block  0.2991492748260498
generate_one_block  0.2857320308685303
generate_one_block  0.2853713035583496
generate_one_block  0.28946709632873535
generate_one_block  0.28844380378723145
generate_one_block  0.28438615798950195
generate_one_block  0.29308414459228516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037775516510009766
gen group dst list time:  0.06475472450256348
time for parepare:  0.01891636848449707
local_output_nid generation:  0.026148319244384766
local_in_edges_tensor generation:  0.05355715751647949
mini_batch_src_global generation:  0.05606675148010254
r_  generation:  0.49061107635498047
local_output_nid generation:  0.03524518013000488
local_in_edges_tensor generation:  0.04041790962219238
mini_batch_src_global generation:  0.05376267433166504
r_  generation:  0.44794416427612305
local_output_nid generation:  0.03086233139038086
local_in_edges_tensor generation:  0.03422951698303223
mini_batch_src_global generation:  0.05274510383605957
r_  generation:  0.45436978340148926
local_output_nid generation:  0.03125262260437012
local_in_edges_tensor generation:  0.030234336853027344
mini_batch_src_global generation:  0.06381797790527344
r_  generation:  0.4505043029785156
local_output_nid generation:  0.03133440017700195
local_in_edges_tensor generation:  0.07759356498718262
mini_batch_src_global generation:  0.0508725643157959
r_  generation:  0.4627361297607422
local_output_nid generation:  0.030721426010131836
local_in_edges_tensor generation:  0.028516292572021484
mini_batch_src_global generation:  0.05542945861816406
r_  generation:  0.4621438980102539
local_output_nid generation:  0.03107309341430664
local_in_edges_tensor generation:  0.030821561813354492
mini_batch_src_global generation:  0.05249309539794922
r_  generation:  0.4578819274902344
local_output_nid generation:  0.03389477729797363
local_in_edges_tensor generation:  0.03330802917480469
mini_batch_src_global generation:  0.05276083946228027
r_  generation:  0.45711231231689453
local_output_nid generation:  0.031000137329101562
local_in_edges_tensor generation:  0.028763771057128906
mini_batch_src_global generation:  0.05193924903869629
r_  generation:  0.471264123916626
local_output_nid generation:  0.0322418212890625
local_in_edges_tensor generation:  0.04112958908081055
mini_batch_src_global generation:  0.06023120880126953
r_  generation:  0.4573683738708496
local_output_nid generation:  0.03438401222229004
local_in_edges_tensor generation:  0.034891605377197266
mini_batch_src_global generation:  0.05220818519592285
r_  generation:  0.45681095123291016
local_output_nid generation:  0.032431602478027344
local_in_edges_tensor generation:  0.02860236167907715
mini_batch_src_global generation:  0.052643537521362305
r_  generation:  0.4543442726135254
local_output_nid generation:  0.03235220909118652
local_in_edges_tensor generation:  0.0344996452331543
mini_batch_src_global generation:  0.05410170555114746
r_  generation:  0.4584662914276123
local_output_nid generation:  0.03229951858520508
local_in_edges_tensor generation:  0.02861952781677246
mini_batch_src_global generation:  0.052718162536621094
r_  generation:  0.46758008003234863
local_output_nid generation:  0.032381534576416016
local_in_edges_tensor generation:  0.028903484344482422
mini_batch_src_global generation:  0.05238080024719238
r_  generation:  0.4603426456451416
local_output_nid generation:  0.0322413444519043
local_in_edges_tensor generation:  0.0327146053314209
mini_batch_src_global generation:  0.05304312705993652
r_  generation:  0.46098971366882324
----------------------check_connections_block total spend ----------------------------- 10.96196460723877
generate_one_block  0.6133804321289062
generate_one_block  0.5951814651489258
generate_one_block  0.6102430820465088
generate_one_block  0.6099600791931152
generate_one_block  0.6017477512359619
generate_one_block  0.6065003871917725
generate_one_block  0.6078915596008301
generate_one_block  0.5942330360412598
generate_one_block  0.6270577907562256
generate_one_block  0.6060631275177002
generate_one_block  0.5949995517730713
generate_one_block  0.6023199558258057
generate_one_block  0.6074249744415283
generate_one_block  0.5988430976867676
generate_one_block  0.6258189678192139
generate_one_block  0.6143894195556641
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.7147216796875 GB
    Memory Allocated: 0.13453102111816406  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

connection checking time:  16.116183280944824
block generation total time  14.29462742805481
average batch blocks generation time:  0.8934142142534256
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7147216796875 GB
    Memory Allocated: 0.1106724739074707  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7147216796875 GB
    Memory Allocated: 20.728403568267822  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7147216796875 GB
    Memory Allocated: 0.11111259460449219  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7147216796875 GB
    Memory Allocated: 21.05443525314331  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7147216796875 GB
    Memory Allocated: 0.11115503311157227  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0643310546875 GB
    Memory Allocated: 21.387635707855225  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0643310546875 GB
    Memory Allocated: 0.1111297607421875  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0643310546875 GB
    Memory Allocated: 21.08076763153076  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0643310546875 GB
    Memory Allocated: 0.11078310012817383  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0643310546875 GB
    Memory Allocated: 20.93064832687378  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0643310546875 GB
    Memory Allocated: 0.11124610900878906  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.299987316131592  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11095523834228516  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.213808059692383  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11112594604492188  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.076022624969482  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11066961288452148  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.913340091705322  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11120223999023438  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.19626522064209  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11095905303955078  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.025935649871826  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11124229431152344  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.195746898651123  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11102819442749023  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.224189281463623  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11126422882080078  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.212143898010254  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11092710494995117  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.197826862335205  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11123275756835938  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.167497634887695  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04293052852153778 |0.015177518129348755 |0.31191442906856537 |9.867548942565918e-05 |0.5558668226003647 |0.0067005157470703125 |
----------------------------------------------------------pseudo_mini_loss sum 2.7059967517852783
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5090140
Number of first layer input nodes during this epoch:  2470572
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.1348862648010254  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021191835403442383
range selection method range initialization spend 0.01627373695373535
time for parepare:  0.02009272575378418
local_output_nid generation:  0.0016376972198486328
local_in_edges_tensor generation:  0.005602598190307617
mini_batch_src_global generation:  0.0036296844482421875
r_  generation:  0.02234625816345215
local_output_nid generation:  0.002155303955078125
local_in_edges_tensor generation:  0.0013892650604248047
mini_batch_src_global generation:  0.002207040786743164
r_  generation:  0.019460201263427734
local_output_nid generation:  0.0021157264709472656
local_in_edges_tensor generation:  0.0013039112091064453
mini_batch_src_global generation:  0.001453399658203125
r_  generation:  0.0177309513092041
local_output_nid generation:  0.0020885467529296875
local_in_edges_tensor generation:  0.0013663768768310547
mini_batch_src_global generation:  0.0016713142395019531
r_  generation:  0.018298625946044922
local_output_nid generation:  0.0020613670349121094
local_in_edges_tensor generation:  0.0014069080352783203
mini_batch_src_global generation:  0.0016028881072998047
r_  generation:  0.0183563232421875
local_output_nid generation:  0.002065420150756836
local_in_edges_tensor generation:  0.0011544227600097656
mini_batch_src_global generation:  0.0013737678527832031
r_  generation:  0.018427371978759766
local_output_nid generation:  0.0019502639770507812
local_in_edges_tensor generation:  0.0010387897491455078
mini_batch_src_global generation:  0.0015399456024169922
r_  generation:  0.018563032150268555
local_output_nid generation:  0.001880645751953125
local_in_edges_tensor generation:  0.0010113716125488281
mini_batch_src_global generation:  0.001561880111694336
r_  generation:  0.018482685089111328
local_output_nid generation:  0.0019481182098388672
local_in_edges_tensor generation:  0.0010237693786621094
mini_batch_src_global generation:  0.0016393661499023438
r_  generation:  0.018460512161254883
local_output_nid generation:  0.0019049644470214844
local_in_edges_tensor generation:  0.001018524169921875
mini_batch_src_global generation:  0.0014193058013916016
r_  generation:  0.01846003532409668
local_output_nid generation:  0.0019431114196777344
local_in_edges_tensor generation:  0.001194000244140625
mini_batch_src_global generation:  0.001692056655883789
r_  generation:  0.018883466720581055
local_output_nid generation:  0.0018916130065917969
local_in_edges_tensor generation:  0.001031637191772461
mini_batch_src_global generation:  0.0015256404876708984
r_  generation:  0.018633127212524414
local_output_nid generation:  0.0025861263275146484
local_in_edges_tensor generation:  0.0015325546264648438
mini_batch_src_global generation:  0.009562969207763672
r_  generation:  0.02322244644165039
local_output_nid generation:  0.001874685287475586
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.0019316673278808594
r_  generation:  0.03212404251098633
local_output_nid generation:  0.0035169124603271484
local_in_edges_tensor generation:  0.0018625259399414062
mini_batch_src_global generation:  0.004765033721923828
r_  generation:  0.024580717086791992
local_output_nid generation:  0.0017056465148925781
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.019703149795532227
r_  generation:  0.02577829360961914
----------------------check_connections_block total spend ----------------------------- 0.5586585998535156
generate_one_block  0.03930020332336426
generate_one_block  0.031102895736694336
generate_one_block  0.030988454818725586
generate_one_block  0.03212141990661621
generate_one_block  0.031973838806152344
generate_one_block  0.03483295440673828
generate_one_block  0.03226280212402344
generate_one_block  0.03159904479980469
generate_one_block  0.03581404685974121
generate_one_block  0.04629659652709961
generate_one_block  0.035466909408569336
generate_one_block  0.03193235397338867
generate_one_block  0.03154277801513672
generate_one_block  0.046126365661621094
generate_one_block  0.040203094482421875
generate_one_block  0.04040074348449707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03591585159301758
gen group dst list time:  0.019077301025390625
time for parepare:  0.019817590713500977
local_output_nid generation:  0.007284641265869141
local_in_edges_tensor generation:  0.026842117309570312
mini_batch_src_global generation:  0.02083730697631836
r_  generation:  0.1980600357055664
local_output_nid generation:  0.01766180992126465
local_in_edges_tensor generation:  0.02072739601135254
mini_batch_src_global generation:  0.025615453720092773
r_  generation:  0.210953950881958
local_output_nid generation:  0.011978864669799805
local_in_edges_tensor generation:  0.012990474700927734
mini_batch_src_global generation:  0.02520751953125
r_  generation:  0.2109696865081787
local_output_nid generation:  0.011426687240600586
local_in_edges_tensor generation:  0.014947652816772461
mini_batch_src_global generation:  0.02725505828857422
r_  generation:  0.22443270683288574
local_output_nid generation:  0.011617898941040039
local_in_edges_tensor generation:  0.011131763458251953
mini_batch_src_global generation:  0.027425289154052734
r_  generation:  0.22490310668945312
local_output_nid generation:  0.011924982070922852
local_in_edges_tensor generation:  0.015562295913696289
mini_batch_src_global generation:  0.02803945541381836
r_  generation:  0.22729134559631348
local_output_nid generation:  0.011790752410888672
local_in_edges_tensor generation:  0.011058568954467773
mini_batch_src_global generation:  0.02780294418334961
r_  generation:  0.22229433059692383
local_output_nid generation:  0.012015104293823242
local_in_edges_tensor generation:  0.011252164840698242
mini_batch_src_global generation:  0.02819061279296875
r_  generation:  0.23131370544433594
local_output_nid generation:  0.012205839157104492
local_in_edges_tensor generation:  0.012515068054199219
mini_batch_src_global generation:  0.0290677547454834
r_  generation:  0.2312319278717041
local_output_nid generation:  0.012865304946899414
local_in_edges_tensor generation:  0.013752460479736328
mini_batch_src_global generation:  0.02841973304748535
r_  generation:  0.2325282096862793
local_output_nid generation:  0.012065649032592773
local_in_edges_tensor generation:  0.018204927444458008
mini_batch_src_global generation:  0.03183293342590332
r_  generation:  0.22707748413085938
local_output_nid generation:  0.012176752090454102
local_in_edges_tensor generation:  0.01713728904724121
mini_batch_src_global generation:  0.030742883682250977
r_  generation:  0.2464752197265625
local_output_nid generation:  0.014678239822387695
local_in_edges_tensor generation:  0.014383554458618164
mini_batch_src_global generation:  0.02819538116455078
r_  generation:  0.2176816463470459
local_output_nid generation:  0.012382984161376953
local_in_edges_tensor generation:  0.011912822723388672
mini_batch_src_global generation:  0.026447296142578125
r_  generation:  0.2159881591796875
local_output_nid generation:  0.011938810348510742
local_in_edges_tensor generation:  0.011713504791259766
mini_batch_src_global generation:  0.026239395141601562
r_  generation:  0.21290898323059082
local_output_nid generation:  0.011984825134277344
local_in_edges_tensor generation:  0.013824462890625
mini_batch_src_global generation:  0.026586294174194336
r_  generation:  0.2207777500152588
----------------------check_connections_block total spend ----------------------------- 5.239612579345703
generate_one_block  0.28292346000671387
generate_one_block  0.27434325218200684
generate_one_block  0.2758297920227051
generate_one_block  0.2844111919403076
generate_one_block  0.28284597396850586
generate_one_block  0.28615498542785645
generate_one_block  0.2963097095489502
generate_one_block  0.29843974113464355
generate_one_block  0.2849690914154053
generate_one_block  0.28744053840637207
generate_one_block  0.2837958335876465
generate_one_block  0.2862551212310791
generate_one_block  0.29081034660339355
generate_one_block  0.28541135787963867
generate_one_block  0.2830626964569092
generate_one_block  0.2922048568725586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03574061393737793
gen group dst list time:  0.06664490699768066
time for parepare:  0.01884603500366211
local_output_nid generation:  0.02575516700744629
local_in_edges_tensor generation:  0.04872536659240723
mini_batch_src_global generation:  0.04174184799194336
r_  generation:  0.45401930809020996
local_output_nid generation:  0.03195786476135254
local_in_edges_tensor generation:  0.03982281684875488
mini_batch_src_global generation:  0.051297903060913086
r_  generation:  0.44884562492370605
local_output_nid generation:  0.030753135681152344
local_in_edges_tensor generation:  0.032831668853759766
mini_batch_src_global generation:  0.05012178421020508
r_  generation:  0.4508180618286133
local_output_nid generation:  0.031110525131225586
local_in_edges_tensor generation:  0.03842020034790039
mini_batch_src_global generation:  0.053938865661621094
r_  generation:  0.45059895515441895
local_output_nid generation:  0.03123617172241211
local_in_edges_tensor generation:  0.08203554153442383
mini_batch_src_global generation:  0.05349612236022949
r_  generation:  0.4566919803619385
local_output_nid generation:  0.0306704044342041
local_in_edges_tensor generation:  0.029857635498046875
mini_batch_src_global generation:  0.05470442771911621
r_  generation:  0.4568603038787842
local_output_nid generation:  0.030938148498535156
local_in_edges_tensor generation:  0.029296159744262695
mini_batch_src_global generation:  0.051215171813964844
r_  generation:  0.45772480964660645
local_output_nid generation:  0.031052827835083008
local_in_edges_tensor generation:  0.03311800956726074
mini_batch_src_global generation:  0.052488088607788086
r_  generation:  0.4581484794616699
local_output_nid generation:  0.031201601028442383
local_in_edges_tensor generation:  0.03360176086425781
mini_batch_src_global generation:  0.05206751823425293
r_  generation:  0.4553079605102539
local_output_nid generation:  0.031954288482666016
local_in_edges_tensor generation:  0.029273509979248047
mini_batch_src_global generation:  0.052361249923706055
r_  generation:  0.45062756538391113
local_output_nid generation:  0.03135418891906738
local_in_edges_tensor generation:  0.028367996215820312
mini_batch_src_global generation:  0.05377912521362305
r_  generation:  0.45807456970214844
local_output_nid generation:  0.030800819396972656
local_in_edges_tensor generation:  0.028757095336914062
mini_batch_src_global generation:  0.052611589431762695
r_  generation:  0.45349788665771484
local_output_nid generation:  0.03137803077697754
local_in_edges_tensor generation:  0.032930850982666016
mini_batch_src_global generation:  0.053389787673950195
r_  generation:  0.4638092517852783
local_output_nid generation:  0.030996084213256836
local_in_edges_tensor generation:  0.03088068962097168
mini_batch_src_global generation:  0.05505633354187012
r_  generation:  0.455364465713501
local_output_nid generation:  0.031280517578125
local_in_edges_tensor generation:  0.03602933883666992
mini_batch_src_global generation:  0.053491830825805664
r_  generation:  0.4623525142669678
local_output_nid generation:  0.03135418891906738
local_in_edges_tensor generation:  0.03288674354553223
mini_batch_src_global generation:  0.05244898796081543
r_  generation:  0.45999670028686523
----------------------check_connections_block total spend ----------------------------- 10.825062990188599
generate_one_block  0.6139588356018066
generate_one_block  0.5923259258270264
generate_one_block  0.5945658683776855
generate_one_block  0.60679030418396
generate_one_block  0.6026859283447266
generate_one_block  0.6058716773986816
generate_one_block  0.5941548347473145
generate_one_block  0.6072907447814941
generate_one_block  0.6673903465270996
generate_one_block  0.595391035079956
generate_one_block  0.5946815013885498
generate_one_block  0.5981106758117676
generate_one_block  0.6121609210968018
generate_one_block  0.603515625
generate_one_block  0.593388557434082
generate_one_block  0.6125311851501465
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.1348862648010254  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

connection checking time:  16.0646755695343
block generation total time  14.270021915435791
average batch blocks generation time:  0.8918763697147369
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11083793640136719  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.86699104309082  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11104297637939453  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.873292446136475  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11104297637939453  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.01699733734131  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11129474639892578  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.306386947631836  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11114311218261719  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.175499439239502  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11125469207763672  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.22337055206299  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11078977584838867  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.785431385040283  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.1112813949584961  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.24780035018921  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.1110219955444336  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.134333610534668  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11117362976074219  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.105376720428467  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11114978790283203  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.119489669799805  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11121845245361328  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.153518676757812  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.1110239028930664  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.411046504974365  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.1112213134765625  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.180609226226807  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11099576950073242  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.047242641448975  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11133861541748047  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.365639686584473  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04254654049873352 |0.014881640672683716 |0.30568358302116394 |9.457767009735107e-05 |0.5547001659870148 |0.0026388168334960938 |
----------------------------------------------------------pseudo_mini_loss sum 2.3406174182891846
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5092216
Number of first layer input nodes during this epoch:  2471627
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.13451385498046875  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02162957191467285
range selection method range initialization spend 0.012631654739379883
time for parepare:  0.018361568450927734
local_output_nid generation:  0.0016417503356933594
local_in_edges_tensor generation:  0.0061609745025634766
mini_batch_src_global generation:  0.0038595199584960938
r_  generation:  0.022121906280517578
local_output_nid generation:  0.002262592315673828
local_in_edges_tensor generation:  0.0014224052429199219
mini_batch_src_global generation:  0.0024509429931640625
r_  generation:  0.019337892532348633
local_output_nid generation:  0.0021147727966308594
local_in_edges_tensor generation:  0.0013420581817626953
mini_batch_src_global generation:  0.001516103744506836
r_  generation:  0.017563581466674805
local_output_nid generation:  0.002115488052368164
local_in_edges_tensor generation:  0.0010225772857666016
mini_batch_src_global generation:  0.0015516281127929688
r_  generation:  0.01765918731689453
local_output_nid generation:  0.0020356178283691406
local_in_edges_tensor generation:  0.0011112689971923828
mini_batch_src_global generation:  0.0015692710876464844
r_  generation:  0.019092082977294922
local_output_nid generation:  0.0020198822021484375
local_in_edges_tensor generation:  0.001104116439819336
mini_batch_src_global generation:  0.00154876708984375
r_  generation:  0.018866539001464844
local_output_nid generation:  0.0020232200622558594
local_in_edges_tensor generation:  0.001001596450805664
mini_batch_src_global generation:  0.0015587806701660156
r_  generation:  0.01879715919494629
local_output_nid generation:  0.0019180774688720703
local_in_edges_tensor generation:  0.0009806156158447266
mini_batch_src_global generation:  0.0014295578002929688
r_  generation:  0.01806163787841797
local_output_nid generation:  0.0019519329071044922
local_in_edges_tensor generation:  0.0010142326354980469
mini_batch_src_global generation:  0.0016863346099853516
r_  generation:  0.018750429153442383
local_output_nid generation:  0.0018870830535888672
local_in_edges_tensor generation:  0.0009970664978027344
mini_batch_src_global generation:  0.0016400814056396484
r_  generation:  0.018788814544677734
local_output_nid generation:  0.0019674301147460938
local_in_edges_tensor generation:  0.0010128021240234375
mini_batch_src_global generation:  0.0015459060668945312
r_  generation:  0.01892566680908203
local_output_nid generation:  0.0019545555114746094
local_in_edges_tensor generation:  0.0015909671783447266
mini_batch_src_global generation:  0.0015892982482910156
r_  generation:  0.019743919372558594
local_output_nid generation:  0.0019617080688476562
local_in_edges_tensor generation:  0.0012063980102539062
mini_batch_src_global generation:  0.0015769004821777344
r_  generation:  0.019519567489624023
local_output_nid generation:  0.0019199848175048828
local_in_edges_tensor generation:  0.0013132095336914062
mini_batch_src_global generation:  0.0016682147979736328
r_  generation:  0.019435644149780273
local_output_nid generation:  0.0019428730010986328
local_in_edges_tensor generation:  0.0010104179382324219
mini_batch_src_global generation:  0.001598358154296875
r_  generation:  0.01863241195678711
local_output_nid generation:  0.001966714859008789
local_in_edges_tensor generation:  0.0010793209075927734
mini_batch_src_global generation:  0.0016322135925292969
r_  generation:  0.019679546356201172
----------------------check_connections_block total spend ----------------------------- 0.4850459098815918
generate_one_block  0.038687944412231445
generate_one_block  0.03263974189758301
generate_one_block  0.03139209747314453
generate_one_block  0.03204011917114258
generate_one_block  0.03326606750488281
generate_one_block  0.03495383262634277
generate_one_block  0.03309321403503418
generate_one_block  0.03110051155090332
generate_one_block  0.031841278076171875
generate_one_block  0.03151512145996094
generate_one_block  0.03115367889404297
generate_one_block  0.032683372497558594
generate_one_block  0.03202939033508301
generate_one_block  0.035135746002197266
generate_one_block  0.03755998611450195
generate_one_block  0.04674029350280762
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06632518768310547
gen group dst list time:  0.01688528060913086
time for parepare:  0.019655942916870117
local_output_nid generation:  0.0076406002044677734
local_in_edges_tensor generation:  0.017604589462280273
mini_batch_src_global generation:  0.019746780395507812
r_  generation:  0.1890578269958496
local_output_nid generation:  0.010564327239990234
local_in_edges_tensor generation:  0.012774944305419922
mini_batch_src_global generation:  0.025283336639404297
r_  generation:  0.206756591796875
local_output_nid generation:  0.010754108428955078
local_in_edges_tensor generation:  0.010668516159057617
mini_batch_src_global generation:  0.023740291595458984
r_  generation:  0.20222687721252441
local_output_nid generation:  0.014751195907592773
local_in_edges_tensor generation:  0.012068033218383789
mini_batch_src_global generation:  0.024182796478271484
r_  generation:  0.21358656883239746
local_output_nid generation:  0.01207876205444336
local_in_edges_tensor generation:  0.014948844909667969
mini_batch_src_global generation:  0.027838468551635742
r_  generation:  0.2243504524230957
local_output_nid generation:  0.011734962463378906
local_in_edges_tensor generation:  0.017745018005371094
mini_batch_src_global generation:  0.02608799934387207
r_  generation:  0.21853899955749512
local_output_nid generation:  0.012290477752685547
local_in_edges_tensor generation:  0.019400596618652344
mini_batch_src_global generation:  0.02650308609008789
r_  generation:  0.22432613372802734
local_output_nid generation:  0.014313936233520508
local_in_edges_tensor generation:  0.014206647872924805
mini_batch_src_global generation:  0.025959491729736328
r_  generation:  0.20875239372253418
local_output_nid generation:  0.012595653533935547
local_in_edges_tensor generation:  0.011738061904907227
mini_batch_src_global generation:  0.028600215911865234
r_  generation:  0.21241211891174316
local_output_nid generation:  0.01250004768371582
local_in_edges_tensor generation:  0.01226806640625
mini_batch_src_global generation:  0.02604985237121582
r_  generation:  0.2093369960784912
local_output_nid generation:  0.012307405471801758
local_in_edges_tensor generation:  0.011313438415527344
mini_batch_src_global generation:  0.025839567184448242
r_  generation:  0.20718050003051758
local_output_nid generation:  0.012402534484863281
local_in_edges_tensor generation:  0.013200044631958008
mini_batch_src_global generation:  0.026838302612304688
r_  generation:  0.2164473533630371
local_output_nid generation:  0.012853384017944336
local_in_edges_tensor generation:  0.012523651123046875
mini_batch_src_global generation:  0.02679276466369629
r_  generation:  0.21282410621643066
local_output_nid generation:  0.012833118438720703
local_in_edges_tensor generation:  0.011738300323486328
mini_batch_src_global generation:  0.02656269073486328
r_  generation:  0.21452760696411133
local_output_nid generation:  0.012177467346191406
local_in_edges_tensor generation:  0.01167917251586914
mini_batch_src_global generation:  0.02631354331970215
r_  generation:  0.2108299732208252
local_output_nid generation:  0.012128114700317383
local_in_edges_tensor generation:  0.01179361343383789
mini_batch_src_global generation:  0.026343822479248047
r_  generation:  0.21601152420043945
----------------------check_connections_block total spend ----------------------------- 4.970524311065674
generate_one_block  0.2887139320373535
generate_one_block  0.28383970260620117
generate_one_block  0.27703070640563965
generate_one_block  0.28836536407470703
generate_one_block  0.28996896743774414
generate_one_block  0.2857487201690674
generate_one_block  0.3109738826751709
generate_one_block  0.28125739097595215
generate_one_block  0.28725481033325195
generate_one_block  0.28364133834838867
generate_one_block  0.2793562412261963
generate_one_block  0.29921412467956543
generate_one_block  0.2846064567565918
generate_one_block  0.2894401550292969
generate_one_block  0.279294490814209
generate_one_block  0.288649320602417
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03485536575317383
gen group dst list time:  0.06849145889282227
time for parepare:  0.019234895706176758
local_output_nid generation:  0.027154922485351562
local_in_edges_tensor generation:  0.049205780029296875
mini_batch_src_global generation:  0.03993058204650879
r_  generation:  0.44129467010498047
local_output_nid generation:  0.030473709106445312
local_in_edges_tensor generation:  0.037683725357055664
mini_batch_src_global generation:  0.05328559875488281
r_  generation:  0.44321703910827637
local_output_nid generation:  0.03048419952392578
local_in_edges_tensor generation:  0.029701709747314453
mini_batch_src_global generation:  0.050295352935791016
r_  generation:  0.4490814208984375
local_output_nid generation:  0.030849456787109375
local_in_edges_tensor generation:  0.03159928321838379
mini_batch_src_global generation:  0.05437898635864258
r_  generation:  0.45140957832336426
local_output_nid generation:  0.03123641014099121
local_in_edges_tensor generation:  0.07739877700805664
mini_batch_src_global generation:  0.05171823501586914
r_  generation:  0.46867895126342773
local_output_nid generation:  0.031714439392089844
local_in_edges_tensor generation:  0.03336000442504883
mini_batch_src_global generation:  0.05522608757019043
r_  generation:  0.4611055850982666
local_output_nid generation:  0.03247356414794922
local_in_edges_tensor generation:  0.029967308044433594
mini_batch_src_global generation:  0.051192522048950195
r_  generation:  0.46111178398132324
local_output_nid generation:  0.03301835060119629
local_in_edges_tensor generation:  0.031633853912353516
mini_batch_src_global generation:  0.05255603790283203
r_  generation:  0.4554617404937744
local_output_nid generation:  0.03137350082397461
local_in_edges_tensor generation:  0.03300833702087402
mini_batch_src_global generation:  0.05158543586730957
r_  generation:  0.46565842628479004
local_output_nid generation:  0.0315699577331543
local_in_edges_tensor generation:  0.03452134132385254
mini_batch_src_global generation:  0.05282735824584961
r_  generation:  0.45836615562438965
local_output_nid generation:  0.0313868522644043
local_in_edges_tensor generation:  0.03408026695251465
mini_batch_src_global generation:  0.05251169204711914
r_  generation:  0.46026110649108887
local_output_nid generation:  0.03207063674926758
local_in_edges_tensor generation:  0.03458976745605469
mini_batch_src_global generation:  0.05486893653869629
r_  generation:  0.4574272632598877
local_output_nid generation:  0.031526803970336914
local_in_edges_tensor generation:  0.033853769302368164
mini_batch_src_global generation:  0.05190730094909668
r_  generation:  0.48050427436828613
local_output_nid generation:  0.03590273857116699
local_in_edges_tensor generation:  0.03541207313537598
mini_batch_src_global generation:  0.055457353591918945
r_  generation:  0.4557018280029297
local_output_nid generation:  0.03247261047363281
local_in_edges_tensor generation:  0.031116962432861328
mini_batch_src_global generation:  0.05148673057556152
r_  generation:  0.45995044708251953
local_output_nid generation:  0.03238177299499512
local_in_edges_tensor generation:  0.0307157039642334
mini_batch_src_global generation:  0.052855730056762695
r_  generation:  0.4538733959197998
----------------------check_connections_block total spend ----------------------------- 10.84902024269104
generate_one_block  0.6094410419464111
generate_one_block  0.6017649173736572
generate_one_block  0.5965611934661865
generate_one_block  0.6073734760284424
generate_one_block  0.606264591217041
generate_one_block  0.6022684574127197
generate_one_block  0.5959789752960205
generate_one_block  0.5941648483276367
generate_one_block  0.6357429027557373
generate_one_block  0.6034495830535889
generate_one_block  0.5964257717132568
generate_one_block  0.6036980152130127
generate_one_block  0.5944526195526123
generate_one_block  0.6075406074523926
generate_one_block  0.5939764976501465
generate_one_block  0.5998654365539551
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.13451385498046875  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

connection checking time:  15.819544553756714
block generation total time  14.24632453918457
average batch blocks generation time:  0.8903952836990356
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11091375350952148  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.93844985961914  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11128997802734375  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.312314987182617  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11070966720581055  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.813066005706787  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11123275756835938  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.18675136566162  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11122608184814453  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.419113159179688  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11132049560546875  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.32107448577881  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11111688613891602  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.102077960968018  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11110591888427734  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.92026710510254  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11118364334106445  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.200061798095703  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11110115051269531  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.939326286315918  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11065340042114258  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.816876888275146  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11136627197265625  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.437756538391113  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11091470718383789  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.084503173828125  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11128807067871094  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.26054859161377  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11089468002319336  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.91837787628174  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.1112661361694336  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.24137020111084  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04256157577037811 |0.01506185531616211 |0.30449825525283813 |9.369850158691406e-05 |0.558614507317543 |0.005776405334472656 |
----------------------------------------------------------pseudo_mini_loss sum 2.1429171562194824
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5092126
Number of first layer input nodes during this epoch:  2471675
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.13376569747924805  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02308511734008789
range selection method range initialization spend 0.013158321380615234
time for parepare:  0.020459413528442383
local_output_nid generation:  0.001638174057006836
local_in_edges_tensor generation:  0.008290290832519531
mini_batch_src_global generation:  0.0040895938873291016
r_  generation:  0.02198648452758789
local_output_nid generation:  0.002277374267578125
local_in_edges_tensor generation:  0.0021686553955078125
mini_batch_src_global generation:  0.0026831626892089844
r_  generation:  0.020694255828857422
local_output_nid generation:  0.0021948814392089844
local_in_edges_tensor generation:  0.002055644989013672
mini_batch_src_global generation:  0.0030069351196289062
r_  generation:  0.018770217895507812
local_output_nid generation:  0.002145528793334961
local_in_edges_tensor generation:  0.0016741752624511719
mini_batch_src_global generation:  0.0015311241149902344
r_  generation:  0.018687009811401367
local_output_nid generation:  0.0021729469299316406
local_in_edges_tensor generation:  0.00107574462890625
mini_batch_src_global generation:  0.003057718276977539
r_  generation:  0.018944501876831055
local_output_nid generation:  0.0020644664764404297
local_in_edges_tensor generation:  0.0011000633239746094
mini_batch_src_global generation:  0.0016353130340576172
r_  generation:  0.019548892974853516
local_output_nid generation:  0.004198312759399414
local_in_edges_tensor generation:  0.0019407272338867188
mini_batch_src_global generation:  0.003806591033935547
r_  generation:  0.021709680557250977
local_output_nid generation:  0.001894235610961914
local_in_edges_tensor generation:  0.0010194778442382812
mini_batch_src_global generation:  0.0015871524810791016
r_  generation:  0.019756078720092773
local_output_nid generation:  0.001764535903930664
local_in_edges_tensor generation:  0.0010759830474853516
mini_batch_src_global generation:  0.0016674995422363281
r_  generation:  0.021256446838378906
local_output_nid generation:  0.0017499923706054688
local_in_edges_tensor generation:  0.0009171962738037109
mini_batch_src_global generation:  0.001909017562866211
r_  generation:  0.019716501235961914
local_output_nid generation:  0.0017957687377929688
local_in_edges_tensor generation:  0.0009210109710693359
mini_batch_src_global generation:  0.0015952587127685547
r_  generation:  0.019470691680908203
local_output_nid generation:  0.0017001628875732422
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0015494823455810547
r_  generation:  0.019176483154296875
local_output_nid generation:  0.0016965866088867188
local_in_edges_tensor generation:  0.0009760856628417969
mini_batch_src_global generation:  0.0016078948974609375
r_  generation:  0.019802570343017578
local_output_nid generation:  0.0017082691192626953
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.0015482902526855469
r_  generation:  0.031713008880615234
local_output_nid generation:  0.0034906864166259766
local_in_edges_tensor generation:  0.002031087875366211
mini_batch_src_global generation:  0.0036923885345458984
r_  generation:  0.02287006378173828
local_output_nid generation:  0.0016982555389404297
local_in_edges_tensor generation:  0.0009033679962158203
mini_batch_src_global generation:  0.001577138900756836
r_  generation:  0.021077394485473633
----------------------check_connections_block total spend ----------------------------- 0.5444576740264893
generate_one_block  0.03670358657836914
generate_one_block  0.03178095817565918
generate_one_block  0.03227853775024414
generate_one_block  0.0307309627532959
generate_one_block  0.030691862106323242
generate_one_block  0.03516411781311035
generate_one_block  0.03129434585571289
generate_one_block  0.03166007995605469
generate_one_block  0.031716108322143555
generate_one_block  0.03243422508239746
generate_one_block  0.03120899200439453
generate_one_block  0.030766725540161133
generate_one_block  0.03405928611755371
generate_one_block  0.03165149688720703
generate_one_block  0.031519412994384766
generate_one_block  0.0339813232421875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039602041244506836
gen group dst list time:  0.0176846981048584
time for parepare:  0.019570350646972656
local_output_nid generation:  0.0072748661041259766
local_in_edges_tensor generation:  0.02405095100402832
mini_batch_src_global generation:  0.02031254768371582
r_  generation:  0.19874095916748047
local_output_nid generation:  0.010573625564575195
local_in_edges_tensor generation:  0.014086723327636719
mini_batch_src_global generation:  0.02521038055419922
r_  generation:  0.20266079902648926
local_output_nid generation:  0.010664224624633789
local_in_edges_tensor generation:  0.014000415802001953
mini_batch_src_global generation:  0.023904085159301758
r_  generation:  0.20391321182250977
local_output_nid generation:  0.011406660079956055
local_in_edges_tensor generation:  0.013235330581665039
mini_batch_src_global generation:  0.023684263229370117
r_  generation:  0.20320558547973633
local_output_nid generation:  0.011773109436035156
local_in_edges_tensor generation:  0.01213383674621582
mini_batch_src_global generation:  0.025037765502929688
r_  generation:  0.20845460891723633
local_output_nid generation:  0.01164388656616211
local_in_edges_tensor generation:  0.011566877365112305
mini_batch_src_global generation:  0.027322053909301758
r_  generation:  0.21330761909484863
local_output_nid generation:  0.012015342712402344
local_in_edges_tensor generation:  0.01135873794555664
mini_batch_src_global generation:  0.0259702205657959
r_  generation:  0.21095824241638184
local_output_nid generation:  0.012168407440185547
local_in_edges_tensor generation:  0.01144719123840332
mini_batch_src_global generation:  0.026177644729614258
r_  generation:  0.21474862098693848
local_output_nid generation:  0.012290239334106445
local_in_edges_tensor generation:  0.016460657119750977
mini_batch_src_global generation:  0.026456594467163086
r_  generation:  0.22202110290527344
local_output_nid generation:  0.012109756469726562
local_in_edges_tensor generation:  0.018070220947265625
mini_batch_src_global generation:  0.02582693099975586
r_  generation:  0.2167346477508545
local_output_nid generation:  0.012857913970947266
local_in_edges_tensor generation:  0.01582932472229004
mini_batch_src_global generation:  0.027320146560668945
r_  generation:  0.22731781005859375
local_output_nid generation:  0.015908479690551758
local_in_edges_tensor generation:  0.013526678085327148
mini_batch_src_global generation:  0.026072263717651367
r_  generation:  0.210493803024292
local_output_nid generation:  0.015371084213256836
local_in_edges_tensor generation:  0.01204824447631836
mini_batch_src_global generation:  0.027094602584838867
r_  generation:  0.21625041961669922
local_output_nid generation:  0.012676239013671875
local_in_edges_tensor generation:  0.012529611587524414
mini_batch_src_global generation:  0.02696681022644043
r_  generation:  0.21696209907531738
local_output_nid generation:  0.012521743774414062
local_in_edges_tensor generation:  0.01184535026550293
mini_batch_src_global generation:  0.026714563369750977
r_  generation:  0.21390128135681152
local_output_nid generation:  0.01198887825012207
local_in_edges_tensor generation:  0.011764764785766602
mini_batch_src_global generation:  0.02613520622253418
r_  generation:  0.2121889591217041
----------------------check_connections_block total spend ----------------------------- 4.9850006103515625
generate_one_block  0.29393696784973145
generate_one_block  0.27918004989624023
generate_one_block  0.27404284477233887
generate_one_block  0.27523350715637207
generate_one_block  0.2793729305267334
generate_one_block  0.28526735305786133
generate_one_block  0.302426815032959
generate_one_block  0.27991342544555664
generate_one_block  0.2818317413330078
generate_one_block  0.27521824836730957
generate_one_block  0.28539228439331055
generate_one_block  0.2826802730560303
generate_one_block  0.28551506996154785
generate_one_block  0.2863161563873291
generate_one_block  0.2864866256713867
generate_one_block  0.28207993507385254
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034262895584106445
gen group dst list time:  0.0626218318939209
time for parepare:  0.020540237426757812
local_output_nid generation:  0.02555108070373535
local_in_edges_tensor generation:  0.05267047882080078
mini_batch_src_global generation:  0.04468560218811035
r_  generation:  0.4508030414581299
local_output_nid generation:  0.03316092491149902
local_in_edges_tensor generation:  0.03771400451660156
mini_batch_src_global generation:  0.0518341064453125
r_  generation:  0.45625805854797363
local_output_nid generation:  0.03139925003051758
local_in_edges_tensor generation:  0.03358030319213867
mini_batch_src_global generation:  0.05170035362243652
r_  generation:  0.4726142883300781
local_output_nid generation:  0.03335404396057129
local_in_edges_tensor generation:  0.035971641540527344
mini_batch_src_global generation:  0.05500531196594238
r_  generation:  0.45030713081359863
local_output_nid generation:  0.031242847442626953
local_in_edges_tensor generation:  0.08345198631286621
mini_batch_src_global generation:  0.050974369049072266
r_  generation:  0.4557464122772217
local_output_nid generation:  0.03067946434020996
local_in_edges_tensor generation:  0.03181171417236328
mini_batch_src_global generation:  0.052553415298461914
r_  generation:  0.45502805709838867
local_output_nid generation:  0.0303037166595459
local_in_edges_tensor generation:  0.03132128715515137
mini_batch_src_global generation:  0.05126142501831055
r_  generation:  0.460782527923584
local_output_nid generation:  0.030304670333862305
local_in_edges_tensor generation:  0.031400203704833984
mini_batch_src_global generation:  0.052370309829711914
r_  generation:  0.4669976234436035
local_output_nid generation:  0.030697345733642578
local_in_edges_tensor generation:  0.03160262107849121
mini_batch_src_global generation:  0.05349159240722656
r_  generation:  0.4640662670135498
local_output_nid generation:  0.031046152114868164
local_in_edges_tensor generation:  0.029468059539794922
mini_batch_src_global generation:  0.05516648292541504
r_  generation:  0.4578983783721924
local_output_nid generation:  0.030710935592651367
local_in_edges_tensor generation:  0.031032323837280273
mini_batch_src_global generation:  0.051712751388549805
r_  generation:  0.46553492546081543
local_output_nid generation:  0.031835317611694336
local_in_edges_tensor generation:  0.03385782241821289
mini_batch_src_global generation:  0.05286812782287598
r_  generation:  0.45778417587280273
local_output_nid generation:  0.030928611755371094
local_in_edges_tensor generation:  0.0331881046295166
mini_batch_src_global generation:  0.05580401420593262
r_  generation:  0.46534061431884766
local_output_nid generation:  0.03090691566467285
local_in_edges_tensor generation:  0.03204822540283203
mini_batch_src_global generation:  0.053134918212890625
r_  generation:  0.4589266777038574
local_output_nid generation:  0.03139948844909668
local_in_edges_tensor generation:  0.04182934761047363
mini_batch_src_global generation:  0.053694963455200195
r_  generation:  0.46431469917297363
local_output_nid generation:  0.031164884567260742
local_in_edges_tensor generation:  0.03143501281738281
mini_batch_src_global generation:  0.05663633346557617
r_  generation:  0.47736597061157227
----------------------check_connections_block total spend ----------------------------- 10.929654598236084
generate_one_block  0.6091666221618652
generate_one_block  0.5939204692840576
generate_one_block  0.592538595199585
generate_one_block  0.5938136577606201
generate_one_block  0.5953047275543213
generate_one_block  0.6048274040222168
generate_one_block  0.6013309955596924
generate_one_block  0.5985863208770752
generate_one_block  0.6691689491271973
generate_one_block  0.5935027599334717
generate_one_block  0.6065154075622559
generate_one_block  0.5988404750823975
generate_one_block  0.6013374328613281
generate_one_block  0.6019139289855957
generate_one_block  0.5952551364898682
generate_one_block  0.5927181243896484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.13376569747924805  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

connection checking time:  15.914655208587646
block generation total time  14.183635234832764
average batch blocks generation time:  0.8864772021770477
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11108064651489258  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.382150173187256  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.1112070083618164  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.15831232070923  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11083507537841797  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.881429195404053  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.1110544204711914  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.86237668991089  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.1108713150024414  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.014081478118896  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11128902435302734  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.310296535491943  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11084604263305664  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.02817392349243  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11117172241210938  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.08756446838379  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11109209060668945  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.297443866729736  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11109638214111328  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.936917781829834  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11099624633789062  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.12584924697876  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11112403869628906  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.98872184753418  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11097526550292969  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.260432243347168  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11125946044921875  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.261154651641846  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11095809936523438  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.104147911071777  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11114120483398438  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.05117893218994  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0422213077545166 |0.01413699984550476 |0.30569373071193695 |9.40859317779541e-05 |0.5582603514194489 |0.0059604644775390625 |
----------------------------------------------------------pseudo_mini_loss sum 1.9893909692764282
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  5090791
Number of first layer input nodes during this epoch:  2471407
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.13541316986083984  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020718097686767578
range selection method range initialization spend 0.0160675048828125
time for parepare:  0.020016908645629883
local_output_nid generation:  0.001705169677734375
local_in_edges_tensor generation:  0.007163286209106445
mini_batch_src_global generation:  0.002153158187866211
r_  generation:  0.018794536590576172
local_output_nid generation:  0.0018215179443359375
local_in_edges_tensor generation:  0.0012602806091308594
mini_batch_src_global generation:  0.0019838809967041016
r_  generation:  0.019756793975830078
local_output_nid generation:  0.0017657279968261719
local_in_edges_tensor generation:  0.0014274120330810547
mini_batch_src_global generation:  0.001527547836303711
r_  generation:  0.0194854736328125
local_output_nid generation:  0.0017352104187011719
local_in_edges_tensor generation:  0.0010573863983154297
mini_batch_src_global generation:  0.001476287841796875
r_  generation:  0.01929473876953125
local_output_nid generation:  0.0017199516296386719
local_in_edges_tensor generation:  0.001054525375366211
mini_batch_src_global generation:  0.0015268325805664062
r_  generation:  0.02108311653137207
local_output_nid generation:  0.0016868114471435547
local_in_edges_tensor generation:  0.0009992122650146484
mini_batch_src_global generation:  0.0018804073333740234
r_  generation:  0.021712064743041992
local_output_nid generation:  0.00167083740234375
local_in_edges_tensor generation:  0.0009546279907226562
mini_batch_src_global generation:  0.0018715858459472656
r_  generation:  0.02134847640991211
local_output_nid generation:  0.0016682147979736328
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0019075870513916016
r_  generation:  0.0205686092376709
local_output_nid generation:  0.0016601085662841797
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.0018367767333984375
r_  generation:  0.03579282760620117
local_output_nid generation:  0.0023202896118164062
local_in_edges_tensor generation:  0.0016825199127197266
mini_batch_src_global generation:  0.0016331672668457031
r_  generation:  0.01830124855041504
local_output_nid generation:  0.0020427703857421875
local_in_edges_tensor generation:  0.0010275840759277344
mini_batch_src_global generation:  0.0016155242919921875
r_  generation:  0.018462181091308594
local_output_nid generation:  0.0020132064819335938
local_in_edges_tensor generation:  0.0010981559753417969
mini_batch_src_global generation:  0.00154876708984375
r_  generation:  0.018549203872680664
local_output_nid generation:  0.0018973350524902344
local_in_edges_tensor generation:  0.0011074542999267578
mini_batch_src_global generation:  0.0029273033142089844
r_  generation:  0.018563032150268555
local_output_nid generation:  0.001954793930053711
local_in_edges_tensor generation:  0.0010037422180175781
mini_batch_src_global generation:  0.001528024673461914
r_  generation:  0.018651723861694336
local_output_nid generation:  0.0018715858459472656
local_in_edges_tensor generation:  0.0009801387786865234
mini_batch_src_global generation:  0.0013854503631591797
r_  generation:  0.018397092819213867
local_output_nid generation:  0.0018763542175292969
local_in_edges_tensor generation:  0.0013108253479003906
mini_batch_src_global generation:  0.0016963481903076172
r_  generation:  0.01888895034790039
----------------------check_connections_block total spend ----------------------------- 0.509361743927002
generate_one_block  0.04422926902770996
generate_one_block  0.03255748748779297
generate_one_block  0.0325779914855957
generate_one_block  0.032266855239868164
generate_one_block  0.03188157081604004
generate_one_block  0.03518104553222656
generate_one_block  0.03240180015563965
generate_one_block  0.03145480155944824
generate_one_block  0.036715030670166016
generate_one_block  0.03666043281555176
generate_one_block  0.035848379135131836
generate_one_block  0.03133559226989746
generate_one_block  0.03130006790161133
generate_one_block  0.03282594680786133
generate_one_block  0.031054258346557617
generate_one_block  0.04335618019104004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.048026323318481445
gen group dst list time:  0.017351388931274414
time for parepare:  0.020519018173217773
local_output_nid generation:  0.00760197639465332
local_in_edges_tensor generation:  0.018424272537231445
mini_batch_src_global generation:  0.020600318908691406
r_  generation:  0.192030668258667
local_output_nid generation:  0.010490655899047852
local_in_edges_tensor generation:  0.013178348541259766
mini_batch_src_global generation:  0.02396368980407715
r_  generation:  0.19885468482971191
local_output_nid generation:  0.010940313339233398
local_in_edges_tensor generation:  0.011499166488647461
mini_batch_src_global generation:  0.024088144302368164
r_  generation:  0.20740246772766113
local_output_nid generation:  0.011357545852661133
local_in_edges_tensor generation:  0.011734247207641602
mini_batch_src_global generation:  0.024869680404663086
r_  generation:  0.20846152305603027
local_output_nid generation:  0.011787652969360352
local_in_edges_tensor generation:  0.011812686920166016
mini_batch_src_global generation:  0.025692224502563477
r_  generation:  0.21131420135498047
local_output_nid generation:  0.01176762580871582
local_in_edges_tensor generation:  0.011959552764892578
mini_batch_src_global generation:  0.02553105354309082
r_  generation:  0.21272039413452148
local_output_nid generation:  0.011808633804321289
local_in_edges_tensor generation:  0.011728525161743164
mini_batch_src_global generation:  0.02677750587463379
r_  generation:  0.21053767204284668
local_output_nid generation:  0.012138605117797852
local_in_edges_tensor generation:  0.011972427368164062
mini_batch_src_global generation:  0.0257418155670166
r_  generation:  0.2123277187347412
local_output_nid generation:  0.012293338775634766
local_in_edges_tensor generation:  0.013568878173828125
mini_batch_src_global generation:  0.02825474739074707
r_  generation:  0.21346187591552734
local_output_nid generation:  0.01202535629272461
local_in_edges_tensor generation:  0.011975288391113281
mini_batch_src_global generation:  0.027318239212036133
r_  generation:  0.2173769474029541
local_output_nid generation:  0.012068748474121094
local_in_edges_tensor generation:  0.013564825057983398
mini_batch_src_global generation:  0.028220176696777344
r_  generation:  0.22054457664489746
local_output_nid generation:  0.012788534164428711
local_in_edges_tensor generation:  0.018432140350341797
mini_batch_src_global generation:  0.02968764305114746
r_  generation:  0.21891164779663086
local_output_nid generation:  0.01250457763671875
local_in_edges_tensor generation:  0.013144493103027344
mini_batch_src_global generation:  0.030231714248657227
r_  generation:  0.21328115463256836
local_output_nid generation:  0.012517213821411133
local_in_edges_tensor generation:  0.015605688095092773
mini_batch_src_global generation:  0.02640843391418457
r_  generation:  0.2160489559173584
local_output_nid generation:  0.012328624725341797
local_in_edges_tensor generation:  0.011845111846923828
mini_batch_src_global generation:  0.02808690071105957
r_  generation:  0.2286972999572754
local_output_nid generation:  0.014769554138183594
local_in_edges_tensor generation:  0.013914108276367188
mini_batch_src_global generation:  0.026386499404907227
r_  generation:  0.21191716194152832
----------------------check_connections_block total spend ----------------------------- 4.981316804885864
generate_one_block  0.286391019821167
generate_one_block  0.27998852729797363
generate_one_block  0.286165714263916
generate_one_block  0.2873516082763672
generate_one_block  0.28380632400512695
generate_one_block  0.2807791233062744
generate_one_block  0.3052408695220947
generate_one_block  0.28470540046691895
generate_one_block  0.2989184856414795
generate_one_block  0.2837059497833252
generate_one_block  0.28935718536376953
generate_one_block  0.2856459617614746
generate_one_block  0.2880513668060303
generate_one_block  0.28470277786254883
generate_one_block  0.2885456085205078
generate_one_block  0.2864491939544678
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03717637062072754
gen group dst list time:  0.06608772277832031
time for parepare:  0.01897430419921875
local_output_nid generation:  0.02766704559326172
local_in_edges_tensor generation:  0.050750732421875
mini_batch_src_global generation:  0.04203057289123535
r_  generation:  0.4580111503601074
local_output_nid generation:  0.03323030471801758
local_in_edges_tensor generation:  0.035794734954833984
mini_batch_src_global generation:  0.053772926330566406
r_  generation:  0.4482457637786865
local_output_nid generation:  0.03139019012451172
local_in_edges_tensor generation:  0.029639005661010742
mini_batch_src_global generation:  0.05099892616271973
r_  generation:  0.45175743103027344
local_output_nid generation:  0.03101944923400879
local_in_edges_tensor generation:  0.031856536865234375
mini_batch_src_global generation:  0.05222511291503906
r_  generation:  0.44861841201782227
local_output_nid generation:  0.0317683219909668
local_in_edges_tensor generation:  0.08142852783203125
mini_batch_src_global generation:  0.052280426025390625
r_  generation:  0.4668445587158203
local_output_nid generation:  0.03115558624267578
local_in_edges_tensor generation:  0.031264543533325195
mini_batch_src_global generation:  0.05328774452209473
r_  generation:  0.476184606552124
local_output_nid generation:  0.030946969985961914
local_in_edges_tensor generation:  0.02874016761779785
mini_batch_src_global generation:  0.051812171936035156
r_  generation:  0.4641861915588379
local_output_nid generation:  0.031094074249267578
local_in_edges_tensor generation:  0.03084850311279297
mini_batch_src_global generation:  0.05297398567199707
r_  generation:  0.4554131031036377
local_output_nid generation:  0.031242847442626953
local_in_edges_tensor generation:  0.03517961502075195
mini_batch_src_global generation:  0.05206155776977539
r_  generation:  0.46115875244140625
local_output_nid generation:  0.03237605094909668
local_in_edges_tensor generation:  0.03279757499694824
mini_batch_src_global generation:  0.05323386192321777
r_  generation:  0.45652103424072266
local_output_nid generation:  0.03179526329040527
local_in_edges_tensor generation:  0.03141355514526367
mini_batch_src_global generation:  0.05201244354248047
r_  generation:  0.46007204055786133
local_output_nid generation:  0.03130912780761719
local_in_edges_tensor generation:  0.03099846839904785
mini_batch_src_global generation:  0.05282258987426758
r_  generation:  0.4540588855743408
local_output_nid generation:  0.03144407272338867
local_in_edges_tensor generation:  0.03599095344543457
mini_batch_src_global generation:  0.05312323570251465
r_  generation:  0.4581601619720459
local_output_nid generation:  0.03123164176940918
local_in_edges_tensor generation:  0.03539419174194336
mini_batch_src_global generation:  0.057327985763549805
r_  generation:  0.4743325710296631
local_output_nid generation:  0.03414463996887207
local_in_edges_tensor generation:  0.031029224395751953
mini_batch_src_global generation:  0.05308103561401367
r_  generation:  0.4556443691253662
local_output_nid generation:  0.03193354606628418
local_in_edges_tensor generation:  0.029022932052612305
mini_batch_src_global generation:  0.05299687385559082
r_  generation:  0.4505929946899414
----------------------check_connections_block total spend ----------------------------- 10.868701457977295
generate_one_block  0.6078870296478271
generate_one_block  0.5971567630767822
generate_one_block  0.6013987064361572
generate_one_block  0.5940062999725342
generate_one_block  0.6142568588256836
generate_one_block  0.600895881652832
generate_one_block  0.5937459468841553
generate_one_block  0.5981876850128174
generate_one_block  0.6367039680480957
generate_one_block  0.6115293502807617
generate_one_block  0.5928456783294678
generate_one_block  0.5948517322540283
generate_one_block  0.5957489013671875
generate_one_block  0.6031382083892822
generate_one_block  0.61029052734375
generate_one_block  0.5899326801300049
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.13541316986083984  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

connection checking time:  15.85001826286316
block generation total time  14.24238133430481
average batch blocks generation time:  0.8901488333940506
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11121129989624023  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.070963382720947  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11116409301757812  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.071218013763428  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.1110386848449707  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.33832836151123  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11124801635742188  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.2244291305542  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.1111135482788086  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.213845252990723  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11119651794433594  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.093900203704834  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11080741882324219  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.012006759643555  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11117362976074219  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.044270515441895  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11092901229858398  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.056808948516846  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11117839813232422  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.062254905700684  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11100006103515625  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.142300128936768  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11116981506347656  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.03524875640869  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11103105545043945  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.13624858856201  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11117744445800781  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.078747749328613  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11091375350952148  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 21.04141855239868  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11110877990722656  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 20.983456134796143  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04363040626049042 |0.01368984580039978 |0.30782806873321533 |9.229779243469238e-05 |0.5570765733718872 |0.005797386169433594 |
----------------------------------------------------------pseudo_mini_loss sum 1.87699556350708
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  5091186
Number of first layer input nodes during this epoch:  2471623
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.13465356826782227  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02261829376220703
range selection method range initialization spend 0.016135215759277344
time for parepare:  0.01807236671447754
local_output_nid generation:  0.0017023086547851562
local_in_edges_tensor generation:  0.005915164947509766
mini_batch_src_global generation:  0.0023920536041259766
r_  generation:  0.02189779281616211
local_output_nid generation:  0.0017642974853515625
local_in_edges_tensor generation:  0.0027701854705810547
mini_batch_src_global generation:  0.002508401870727539
r_  generation:  0.038031578063964844
local_output_nid generation:  0.0020613670349121094
local_in_edges_tensor generation:  0.0010805130004882812
mini_batch_src_global generation:  0.015239715576171875
r_  generation:  0.02155447006225586
local_output_nid generation:  0.00171661376953125
local_in_edges_tensor generation:  0.0012133121490478516
mini_batch_src_global generation:  0.001949310302734375
r_  generation:  0.022746562957763672
local_output_nid generation:  0.0017538070678710938
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.0018572807312011719
r_  generation:  0.021256685256958008
local_output_nid generation:  0.0016982555389404297
local_in_edges_tensor generation:  0.0010504722595214844
mini_batch_src_global generation:  0.0019969940185546875
r_  generation:  0.021326780319213867
local_output_nid generation:  0.0016937255859375
local_in_edges_tensor generation:  0.0009064674377441406
mini_batch_src_global generation:  0.0019135475158691406
r_  generation:  0.02170252799987793
local_output_nid generation:  0.0016875267028808594
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0016613006591796875
r_  generation:  0.019524812698364258
local_output_nid generation:  0.001697540283203125
local_in_edges_tensor generation:  0.0011932849884033203
mini_batch_src_global generation:  0.0014727115631103516
r_  generation:  0.01936793327331543
local_output_nid generation:  0.0017387866973876953
local_in_edges_tensor generation:  0.0009903907775878906
mini_batch_src_global generation:  0.002651214599609375
r_  generation:  0.021498441696166992
local_output_nid generation:  0.0017349720001220703
local_in_edges_tensor generation:  0.0011641979217529297
mini_batch_src_global generation:  0.0018696784973144531
r_  generation:  0.023878097534179688
local_output_nid generation:  0.0017704963684082031
local_in_edges_tensor generation:  0.0009436607360839844
mini_batch_src_global generation:  0.0019893646240234375
r_  generation:  0.021686553955078125
local_output_nid generation:  0.001703500747680664
local_in_edges_tensor generation:  0.0016694068908691406
mini_batch_src_global generation:  0.0018041133880615234
r_  generation:  0.02163386344909668
local_output_nid generation:  0.0017037391662597656
local_in_edges_tensor generation:  0.0009276866912841797
mini_batch_src_global generation:  0.0018935203552246094
r_  generation:  0.03141593933105469
local_output_nid generation:  0.0022802352905273438
local_in_edges_tensor generation:  0.0016758441925048828
mini_batch_src_global generation:  0.0019366741180419922
r_  generation:  0.020501375198364258
local_output_nid generation:  0.0017850399017333984
local_in_edges_tensor generation:  0.0014836788177490234
mini_batch_src_global generation:  0.0018579959869384766
r_  generation:  0.02157449722290039
----------------------check_connections_block total spend ----------------------------- 0.5732049942016602
generate_one_block  0.03974342346191406
generate_one_block  0.03385734558105469
generate_one_block  0.04325556755065918
generate_one_block  0.03854775428771973
generate_one_block  0.048470497131347656
generate_one_block  0.04456949234008789
generate_one_block  0.032904863357543945
generate_one_block  0.03133654594421387
generate_one_block  0.0328211784362793
generate_one_block  0.03135800361633301
generate_one_block  0.03163027763366699
generate_one_block  0.034723758697509766
generate_one_block  0.034268856048583984
generate_one_block  0.03197360038757324
generate_one_block  0.03446626663208008
generate_one_block  0.032172441482543945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03452277183532715
gen group dst list time:  0.0171201229095459
time for parepare:  0.024496078491210938
local_output_nid generation:  0.007891416549682617
local_in_edges_tensor generation:  0.02038097381591797
mini_batch_src_global generation:  0.020916461944580078
r_  generation:  0.2038567066192627
local_output_nid generation:  0.010571479797363281
local_in_edges_tensor generation:  0.018124818801879883
mini_batch_src_global generation:  0.02563023567199707
r_  generation:  0.21956849098205566
local_output_nid generation:  0.012910127639770508
local_in_edges_tensor generation:  0.01147317886352539
mini_batch_src_global generation:  0.025030851364135742
r_  generation:  0.20830440521240234
local_output_nid generation:  0.011978626251220703
local_in_edges_tensor generation:  0.014840126037597656
mini_batch_src_global generation:  0.024367332458496094
r_  generation:  0.20768475532531738
local_output_nid generation:  0.012321233749389648
local_in_edges_tensor generation:  0.0114288330078125
mini_batch_src_global generation:  0.02559685707092285
r_  generation:  0.21257281303405762
local_output_nid generation:  0.012035131454467773
local_in_edges_tensor generation:  0.012327909469604492
mini_batch_src_global generation:  0.02599954605102539
r_  generation:  0.21273517608642578
local_output_nid generation:  0.01263737678527832
local_in_edges_tensor generation:  0.011477470397949219
mini_batch_src_global generation:  0.026101112365722656
r_  generation:  0.21410751342773438
local_output_nid generation:  0.012567281723022461
local_in_edges_tensor generation:  0.012337684631347656
mini_batch_src_global generation:  0.02743053436279297
r_  generation:  0.21424627304077148
local_output_nid generation:  0.01255178451538086
local_in_edges_tensor generation:  0.012385129928588867
mini_batch_src_global generation:  0.026097536087036133
r_  generation:  0.21060490608215332
local_output_nid generation:  0.012595176696777344
local_in_edges_tensor generation:  0.01130366325378418
mini_batch_src_global generation:  0.025803089141845703
r_  generation:  0.2137753963470459
local_output_nid generation:  0.012051105499267578
local_in_edges_tensor generation:  0.011468887329101562
mini_batch_src_global generation:  0.025968551635742188
r_  generation:  0.21421408653259277
local_output_nid generation:  0.012434959411621094
local_in_edges_tensor generation:  0.011168241500854492
mini_batch_src_global generation:  0.02741718292236328
r_  generation:  0.2153632640838623
local_output_nid generation:  0.012599706649780273
local_in_edges_tensor generation:  0.012300729751586914
mini_batch_src_global generation:  0.026607513427734375
r_  generation:  0.22060537338256836
local_output_nid generation:  0.012777328491210938
local_in_edges_tensor generation:  0.01370382308959961
mini_batch_src_global generation:  0.0270082950592041
r_  generation:  0.2201387882232666
local_output_nid generation:  0.012748241424560547
local_in_edges_tensor generation:  0.015208005905151367
mini_batch_src_global generation:  0.028897762298583984
r_  generation:  0.22130417823791504
local_output_nid generation:  0.013818025588989258
local_in_edges_tensor generation:  0.014430046081542969
mini_batch_src_global generation:  0.026479005813598633
r_  generation:  0.2153782844543457
----------------------check_connections_block total spend ----------------------------- 5.035064220428467
generate_one_block  0.30994367599487305
generate_one_block  0.29018378257751465
generate_one_block  0.28996944427490234
generate_one_block  0.2848024368286133
generate_one_block  0.2835824489593506
generate_one_block  0.28580379486083984
generate_one_block  0.30992817878723145
generate_one_block  0.28585028648376465
generate_one_block  0.27449655532836914
generate_one_block  0.27592945098876953
generate_one_block  0.27701377868652344
generate_one_block  0.281876802444458
generate_one_block  0.28398990631103516
generate_one_block  0.2902958393096924
generate_one_block  0.2917172908782959
generate_one_block  0.2790212631225586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05707359313964844
gen group dst list time:  0.06073427200317383
time for parepare:  0.02064967155456543
local_output_nid generation:  0.025129079818725586
local_in_edges_tensor generation:  0.05143165588378906
mini_batch_src_global generation:  0.04161953926086426
r_  generation:  0.4520087242126465
local_output_nid generation:  0.03259754180908203
local_in_edges_tensor generation:  0.03702878952026367
mini_batch_src_global generation:  0.05252242088317871
r_  generation:  0.45190930366516113
local_output_nid generation:  0.0305025577545166
local_in_edges_tensor generation:  0.03287696838378906
mini_batch_src_global generation:  0.05111861228942871
r_  generation:  0.45972228050231934
local_output_nid generation:  0.03153419494628906
local_in_edges_tensor generation:  0.03252768516540527
mini_batch_src_global generation:  0.053011417388916016
r_  generation:  0.44957447052001953
local_output_nid generation:  0.030906200408935547
local_in_edges_tensor generation:  0.07490897178649902
mini_batch_src_global generation:  0.053086042404174805
r_  generation:  0.4645054340362549
local_output_nid generation:  0.030953407287597656
local_in_edges_tensor generation:  0.0349583625793457
mini_batch_src_global generation:  0.052660465240478516
r_  generation:  0.46149730682373047
local_output_nid generation:  0.030812501907348633
local_in_edges_tensor generation:  0.035326480865478516
mini_batch_src_global generation:  0.05190396308898926
r_  generation:  0.4630568027496338
local_output_nid generation:  0.03412151336669922
local_in_edges_tensor generation:  0.03774142265319824
mini_batch_src_global generation:  0.05722761154174805
r_  generation:  0.46551084518432617
local_output_nid generation:  0.03428912162780762
local_in_edges_tensor generation:  0.035086631774902344
mini_batch_src_global generation:  0.05297374725341797
r_  generation:  0.459822416305542
local_output_nid generation:  0.032106876373291016
local_in_edges_tensor generation:  0.029261350631713867
mini_batch_src_global generation:  0.05280923843383789
r_  generation:  0.456845760345459
local_output_nid generation:  0.03200531005859375
local_in_edges_tensor generation:  0.02858114242553711
mini_batch_src_global generation:  0.05130124092102051
r_  generation:  0.45793771743774414
local_output_nid generation:  0.03192019462585449
local_in_edges_tensor generation:  0.0306851863861084
mini_batch_src_global generation:  0.05253100395202637
r_  generation:  0.45292019844055176
local_output_nid generation:  0.031761884689331055
local_in_edges_tensor generation:  0.03718400001525879
mini_batch_src_global generation:  0.05124998092651367
r_  generation:  0.4610128402709961
local_output_nid generation:  0.032120466232299805
local_in_edges_tensor generation:  0.030397415161132812
mini_batch_src_global generation:  0.055199623107910156
r_  generation:  0.4582335948944092
local_output_nid generation:  0.03185749053955078
local_in_edges_tensor generation:  0.02875065803527832
mini_batch_src_global generation:  0.05178999900817871
r_  generation:  0.4608311653137207
local_output_nid generation:  0.03181815147399902
local_in_edges_tensor generation:  0.030497074127197266
mini_batch_src_global generation:  0.052978515625
r_  generation:  0.45595312118530273
----------------------check_connections_block total spend ----------------------------- 10.862407684326172
generate_one_block  0.6055417060852051
generate_one_block  0.603851318359375
generate_one_block  0.5917859077453613
generate_one_block  0.5911829471588135
generate_one_block  0.5942833423614502
generate_one_block  0.6047945022583008
generate_one_block  0.594036340713501
generate_one_block  0.6020944118499756
generate_one_block  0.6592655181884766
generate_one_block  0.6005399227142334
generate_one_block  0.5973730087280273
generate_one_block  0.5995063781738281
generate_one_block  0.6027836799621582
generate_one_block  0.6035351753234863
generate_one_block  0.5980246067047119
generate_one_block  0.6012365818023682
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.13465356826782227  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

connection checking time:  15.897471904754639
block generation total time  14.244240283966064
average batch blocks generation time:  0.890265017747879
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3143310546875 GB
    Memory Allocated: 0.11126708984375  GigaBytes
Max Memory Allocated: 21.554314136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.5108699798584  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4061279296875 GB
    Memory Allocated: 0.1112508773803711  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8280029296875 GB
    Memory Allocated: 21.17136287689209  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.11106014251708984  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 21.215365886688232  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11114788055419922  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.04222536087036  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11113309860229492  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.196343421936035  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11122894287109375  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.147225856781006  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11098670959472656  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.0863037109375  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11126899719238281  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.264684200286865  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11089038848876953  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 20.858156204223633  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11107540130615234  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 20.895179271697998  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11074018478393555  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 20.790137767791748  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11113739013671875  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.03930377960205  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11105108261108398  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.10036563873291  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11129379272460938  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.283109188079834  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11100482940673828  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.18644142150879  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11107635498046875  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 20.91614055633545  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04297015070915222 |0.014002740383148193 |0.31125977635383606 |9.386241436004639e-05 |0.5626519173383713 |0.006561994552612305 |
----------------------------------------------------------pseudo_mini_loss sum 1.7856611013412476
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  5090910
Number of first layer input nodes during this epoch:  2471818
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.13401079177856445  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02573108673095703
range selection method range initialization spend 0.014079093933105469
time for parepare:  0.023914813995361328
local_output_nid generation:  0.002054452896118164
local_in_edges_tensor generation:  0.007620811462402344
mini_batch_src_global generation:  0.0025484561920166016
r_  generation:  0.018610477447509766
local_output_nid generation:  0.0018711090087890625
local_in_edges_tensor generation:  0.0017046928405761719
mini_batch_src_global generation:  0.0023834705352783203
r_  generation:  0.01933145523071289
local_output_nid generation:  0.0019257068634033203
local_in_edges_tensor generation:  0.0014042854309082031
mini_batch_src_global generation:  0.001605987548828125
r_  generation:  0.018210172653198242
local_output_nid generation:  0.0019292831420898438
local_in_edges_tensor generation:  0.0011091232299804688
mini_batch_src_global generation:  0.0015599727630615234
r_  generation:  0.0178987979888916
local_output_nid generation:  0.001997232437133789
local_in_edges_tensor generation:  0.0010521411895751953
mini_batch_src_global generation:  0.0015320777893066406
r_  generation:  0.01817154884338379
local_output_nid generation:  0.001971721649169922
local_in_edges_tensor generation:  0.001140594482421875
mini_batch_src_global generation:  0.0013644695281982422
r_  generation:  0.026199817657470703
local_output_nid generation:  0.0035963058471679688
local_in_edges_tensor generation:  0.0018565654754638672
mini_batch_src_global generation:  0.004723310470581055
r_  generation:  0.022266149520874023
local_output_nid generation:  0.0019197463989257812
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0018739700317382812
r_  generation:  0.032054901123046875
local_output_nid generation:  0.002182483673095703
local_in_edges_tensor generation:  0.0032570362091064453
mini_batch_src_global generation:  0.0016641616821289062
r_  generation:  0.018559932708740234
local_output_nid generation:  0.0020058155059814453
local_in_edges_tensor generation:  0.0010046958923339844
mini_batch_src_global generation:  0.0015082359313964844
r_  generation:  0.018356800079345703
local_output_nid generation:  0.002024412155151367
local_in_edges_tensor generation:  0.0013699531555175781
mini_batch_src_global generation:  0.0016908645629882812
r_  generation:  0.019395112991333008
local_output_nid generation:  0.002011537551879883
local_in_edges_tensor generation:  0.0010004043579101562
mini_batch_src_global generation:  0.0014715194702148438
r_  generation:  0.02053689956665039
local_output_nid generation:  0.0019659996032714844
local_in_edges_tensor generation:  0.0011417865753173828
mini_batch_src_global generation:  0.0016982555389404297
r_  generation:  0.019242525100708008
local_output_nid generation:  0.0018858909606933594
local_in_edges_tensor generation:  0.0013082027435302734
mini_batch_src_global generation:  0.0015766620635986328
r_  generation:  0.018834590911865234
local_output_nid generation:  0.0019118785858154297
local_in_edges_tensor generation:  0.0010371208190917969
mini_batch_src_global generation:  0.0030062198638916016
r_  generation:  0.01904916763305664
local_output_nid generation:  0.0018808841705322266
local_in_edges_tensor generation:  0.0010187625885009766
mini_batch_src_global generation:  0.0015614032745361328
r_  generation:  0.020328521728515625
----------------------check_connections_block total spend ----------------------------- 0.5220949649810791
generate_one_block  0.039850711822509766
generate_one_block  0.03366732597351074
generate_one_block  0.04182124137878418
generate_one_block  0.03343057632446289
generate_one_block  0.03427004814147949
generate_one_block  0.038004398345947266
generate_one_block  0.03458762168884277
generate_one_block  0.05475282669067383
generate_one_block  0.03443646430969238
generate_one_block  0.053228139877319336
generate_one_block  0.04306817054748535
generate_one_block  0.04738640785217285
generate_one_block  0.03989553451538086
generate_one_block  0.046990394592285156
generate_one_block  0.03536248207092285
generate_one_block  0.03313159942626953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04263615608215332
gen group dst list time:  0.028547286987304688
time for parepare:  0.02160191535949707
local_output_nid generation:  0.008681058883666992
local_in_edges_tensor generation:  0.02261495590209961
mini_batch_src_global generation:  0.020476341247558594
r_  generation:  0.19396066665649414
local_output_nid generation:  0.013815164566040039
local_in_edges_tensor generation:  0.01745319366455078
mini_batch_src_global generation:  0.025430679321289062
r_  generation:  0.20635366439819336
local_output_nid generation:  0.014745950698852539
local_in_edges_tensor generation:  0.016104459762573242
mini_batch_src_global generation:  0.022332429885864258
r_  generation:  0.22606396675109863
local_output_nid generation:  0.016378164291381836
local_in_edges_tensor generation:  0.014570474624633789
mini_batch_src_global generation:  0.02954578399658203
r_  generation:  0.22566747665405273
local_output_nid generation:  0.01458597183227539
local_in_edges_tensor generation:  0.01252889633178711
mini_batch_src_global generation:  0.030269145965576172
r_  generation:  0.2496500015258789
local_output_nid generation:  0.01390695571899414
local_in_edges_tensor generation:  0.013272762298583984
mini_batch_src_global generation:  0.04415750503540039
r_  generation:  0.22545647621154785
local_output_nid generation:  0.014661312103271484
local_in_edges_tensor generation:  0.012259960174560547
mini_batch_src_global generation:  0.03132486343383789
r_  generation:  0.23759126663208008
local_output_nid generation:  0.014732122421264648
local_in_edges_tensor generation:  0.012273788452148438
mini_batch_src_global generation:  0.03439927101135254
r_  generation:  0.2609083652496338
local_output_nid generation:  0.015834331512451172
local_in_edges_tensor generation:  0.016788721084594727
mini_batch_src_global generation:  0.0317685604095459
r_  generation:  0.27346277236938477
local_output_nid generation:  0.018816471099853516
local_in_edges_tensor generation:  0.01184225082397461
mini_batch_src_global generation:  0.04608273506164551
r_  generation:  0.21232318878173828
local_output_nid generation:  0.012624740600585938
local_in_edges_tensor generation:  0.012530803680419922
mini_batch_src_global generation:  0.02906632423400879
r_  generation:  0.2188873291015625
local_output_nid generation:  0.012232065200805664
local_in_edges_tensor generation:  0.011469364166259766
mini_batch_src_global generation:  0.02671074867248535
r_  generation:  0.2128281593322754
local_output_nid generation:  0.012698650360107422
local_in_edges_tensor generation:  0.012154817581176758
mini_batch_src_global generation:  0.028237342834472656
r_  generation:  0.21976566314697266
local_output_nid generation:  0.012919425964355469
local_in_edges_tensor generation:  0.012420415878295898
mini_batch_src_global generation:  0.02770066261291504
r_  generation:  0.2171473503112793
local_output_nid generation:  0.0127716064453125
local_in_edges_tensor generation:  0.011624336242675781
mini_batch_src_global generation:  0.026987314224243164
r_  generation:  0.21776437759399414
local_output_nid generation:  0.012361764907836914
local_in_edges_tensor generation:  0.013972043991088867
mini_batch_src_global generation:  0.026025772094726562
r_  generation:  0.2062232494354248
----------------------check_connections_block total spend ----------------------------- 5.388384819030762
generate_one_block  0.28924131393432617
generate_one_block  0.28504300117492676
generate_one_block  0.2823035717010498
generate_one_block  0.2937932014465332
generate_one_block  0.2849140167236328
generate_one_block  0.2828085422515869
generate_one_block  0.3164842128753662
generate_one_block  0.2904679775238037
generate_one_block  0.27806544303894043
generate_one_block  0.2807276248931885
generate_one_block  0.28968024253845215
generate_one_block  0.279111385345459
generate_one_block  0.2865257263183594
generate_one_block  0.2887692451477051
generate_one_block  0.2828960418701172
generate_one_block  0.27242183685302734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03350996971130371
gen group dst list time:  0.0667867660522461
time for parepare:  0.02015376091003418
local_output_nid generation:  0.02466893196105957
local_in_edges_tensor generation:  0.04513120651245117
mini_batch_src_global generation:  0.041445016860961914
r_  generation:  0.43970608711242676
local_output_nid generation:  0.02941584587097168
local_in_edges_tensor generation:  0.03673052787780762
mini_batch_src_global generation:  0.05382513999938965
r_  generation:  0.4405486583709717
local_output_nid generation:  0.029352426528930664
local_in_edges_tensor generation:  0.03224349021911621
mini_batch_src_global generation:  0.050670623779296875
r_  generation:  0.4485776424407959
local_output_nid generation:  0.02974700927734375
local_in_edges_tensor generation:  0.02881145477294922
mini_batch_src_global generation:  0.051889657974243164
r_  generation:  0.4540865421295166
local_output_nid generation:  0.030497074127197266
local_in_edges_tensor generation:  0.06954717636108398
mini_batch_src_global generation:  0.05316948890686035
r_  generation:  0.45395326614379883
local_output_nid generation:  0.030405282974243164
local_in_edges_tensor generation:  0.02997565269470215
mini_batch_src_global generation:  0.054125070571899414
r_  generation:  0.44908666610717773
local_output_nid generation:  0.03371262550354004
local_in_edges_tensor generation:  0.031180381774902344
mini_batch_src_global generation:  0.05385231971740723
r_  generation:  0.4620840549468994
local_output_nid generation:  0.03073716163635254
local_in_edges_tensor generation:  0.03669428825378418
mini_batch_src_global generation:  0.0558164119720459
r_  generation:  0.471343994140625
local_output_nid generation:  0.03334403038024902
local_in_edges_tensor generation:  0.03534102439880371
mini_batch_src_global generation:  0.0526423454284668
r_  generation:  0.4542417526245117
local_output_nid generation:  0.03143882751464844
local_in_edges_tensor generation:  0.030785083770751953
mini_batch_src_global generation:  0.0543828010559082
r_  generation:  0.4481537342071533
local_output_nid generation:  0.0314183235168457
local_in_edges_tensor generation:  0.02917766571044922
mini_batch_src_global generation:  0.05172133445739746
r_  generation:  0.4531433582305908
local_output_nid generation:  0.03151106834411621
local_in_edges_tensor generation:  0.030222415924072266
mini_batch_src_global generation:  0.05243873596191406
r_  generation:  0.45163559913635254
local_output_nid generation:  0.03166937828063965
local_in_edges_tensor generation:  0.028328895568847656
mini_batch_src_global generation:  0.06195664405822754
r_  generation:  0.4553534984588623
local_output_nid generation:  0.03249192237854004
local_in_edges_tensor generation:  0.032317161560058594
mini_batch_src_global generation:  0.05475044250488281
r_  generation:  0.4507923126220703
local_output_nid generation:  0.03144431114196777
local_in_edges_tensor generation:  0.028775691986083984
mini_batch_src_global generation:  0.05137228965759277
r_  generation:  0.45536112785339355
local_output_nid generation:  0.03134465217590332
local_in_edges_tensor generation:  0.03637862205505371
mini_batch_src_global generation:  0.054110050201416016
r_  generation:  0.44577527046203613
----------------------check_connections_block total spend ----------------------------- 10.73154067993164
generate_one_block  0.605738639831543
generate_one_block  0.6000199317932129
generate_one_block  0.5978994369506836
generate_one_block  0.5953223705291748
generate_one_block  0.5993385314941406
generate_one_block  0.59377121925354
generate_one_block  0.5940341949462891
generate_one_block  0.5967197418212891
generate_one_block  0.6275885105133057
generate_one_block  0.5990197658538818
generate_one_block  0.601931095123291
generate_one_block  0.5945112705230713
generate_one_block  0.6097698211669922
generate_one_block  0.6102676391601562
generate_one_block  0.6059997081756592
generate_one_block  0.5839686393737793
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.13401079177856445  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

connection checking time:  16.119925498962402
block generation total time  14.199153900146484
average batch blocks generation time:  0.8874471187591553
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.1109161376953125  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 20.9730806350708  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11118412017822266  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.107978343963623  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11098623275756836  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.146792888641357  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11116218566894531  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.02453851699829  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11092662811279297  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 20.9891414642334  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11108112335205078  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 20.906744480133057  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11092138290405273  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.06418228149414  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11118698120117188  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.09451913833618  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11104059219360352  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.085042476654053  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11118888854980469  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 21.09922456741333  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.11110115051269531  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2752685546875 GB
    Memory Allocated: 21.481186866760254  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.11119365692138672  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 21.1201810836792  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.11117076873779297  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 21.351717472076416  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.1113748550415039  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 21.441447734832764  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.11113786697387695  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 21.31342601776123  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.1109609603881836  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 20.712478637695312  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04292172193527222 |0.011856645345687866 |0.30468329787254333 |8.819997310638428e-05 |0.5577225685119629 |0.006354093551635742 |
----------------------------------------------------------pseudo_mini_loss sum 1.7184144258499146
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  5092714
Number of first layer input nodes during this epoch:  2471248
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.13471412658691406  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022586345672607422
range selection method range initialization spend 0.016063451766967773
time for parepare:  0.018599510192871094
local_output_nid generation:  0.0016589164733886719
local_in_edges_tensor generation:  0.0077686309814453125
mini_batch_src_global generation:  0.001958131790161133
r_  generation:  0.020085573196411133
local_output_nid generation:  0.0018143653869628906
local_in_edges_tensor generation:  0.0012443065643310547
mini_batch_src_global generation:  0.0022242069244384766
r_  generation:  0.02140021324157715
local_output_nid generation:  0.0016865730285644531
local_in_edges_tensor generation:  0.0016491413116455078
mini_batch_src_global generation:  0.0019292831420898438
r_  generation:  0.020920753479003906
local_output_nid generation:  0.0017116069793701172
local_in_edges_tensor generation:  0.0008797645568847656
mini_batch_src_global generation:  0.0018460750579833984
r_  generation:  0.020956993103027344
local_output_nid generation:  0.0016674995422363281
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.0018270015716552734
r_  generation:  0.019032955169677734
local_output_nid generation:  0.0017163753509521484
local_in_edges_tensor generation:  0.0009069442749023438
mini_batch_src_global generation:  0.0014643669128417969
r_  generation:  0.0191042423248291
local_output_nid generation:  0.0016722679138183594
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.0015213489532470703
r_  generation:  0.019308090209960938
local_output_nid generation:  0.0016417503356933594
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.0015468597412109375
r_  generation:  0.01914381980895996
local_output_nid generation:  0.0016605854034423828
local_in_edges_tensor generation:  0.0008883476257324219
mini_batch_src_global generation:  0.0016036033630371094
r_  generation:  0.03586745262145996
local_output_nid generation:  0.0034193992614746094
local_in_edges_tensor generation:  0.002574443817138672
mini_batch_src_global generation:  0.004220247268676758
r_  generation:  0.021793365478515625
local_output_nid generation:  0.0016601085662841797
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0016138553619384766
r_  generation:  0.02146625518798828
local_output_nid generation:  0.0016646385192871094
local_in_edges_tensor generation:  0.0009140968322753906
mini_batch_src_global generation:  0.0015616416931152344
r_  generation:  0.01934027671813965
local_output_nid generation:  0.0016505718231201172
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0016369819641113281
r_  generation:  0.01979374885559082
local_output_nid generation:  0.0016739368438720703
local_in_edges_tensor generation:  0.0009591579437255859
mini_batch_src_global generation:  0.001537322998046875
r_  generation:  0.01959228515625
local_output_nid generation:  0.0016775131225585938
local_in_edges_tensor generation:  0.0009205341339111328
mini_batch_src_global generation:  0.0015177726745605469
r_  generation:  0.0214388370513916
local_output_nid generation:  0.0016942024230957031
local_in_edges_tensor generation:  0.0009772777557373047
mini_batch_src_global generation:  0.0015327930450439453
r_  generation:  0.019423961639404297
----------------------check_connections_block total spend ----------------------------- 0.518751859664917
generate_one_block  0.031671762466430664
generate_one_block  0.03524446487426758
generate_one_block  0.0318455696105957
generate_one_block  0.031713247299194336
generate_one_block  0.03330063819885254
generate_one_block  0.05169868469238281
generate_one_block  0.03688621520996094
generate_one_block  0.031853437423706055
generate_one_block  0.031763315200805664
generate_one_block  0.03176474571228027
generate_one_block  0.03125119209289551
generate_one_block  0.03117060661315918
generate_one_block  0.031497955322265625
generate_one_block  0.03397321701049805
generate_one_block  0.03510880470275879
generate_one_block  0.03189802169799805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032347679138183594
gen group dst list time:  0.01913166046142578
time for parepare:  0.020754098892211914
local_output_nid generation:  0.007001161575317383
local_in_edges_tensor generation:  0.02285599708557129
mini_batch_src_global generation:  0.019855499267578125
r_  generation:  0.1919083595275879
local_output_nid generation:  0.010388374328613281
local_in_edges_tensor generation:  0.014257669448852539
mini_batch_src_global generation:  0.02431464195251465
r_  generation:  0.20177483558654785
local_output_nid generation:  0.010555505752563477
local_in_edges_tensor generation:  0.011658191680908203
mini_batch_src_global generation:  0.023160457611083984
r_  generation:  0.2053840160369873
local_output_nid generation:  0.011302947998046875
local_in_edges_tensor generation:  0.011906623840332031
mini_batch_src_global generation:  0.024201631546020508
r_  generation:  0.20799636840820312
local_output_nid generation:  0.011452198028564453
local_in_edges_tensor generation:  0.011217594146728516
mini_batch_src_global generation:  0.02535700798034668
r_  generation:  0.20920896530151367
local_output_nid generation:  0.011716604232788086
local_in_edges_tensor generation:  0.010916471481323242
mini_batch_src_global generation:  0.025420665740966797
r_  generation:  0.2113335132598877
local_output_nid generation:  0.011960744857788086
local_in_edges_tensor generation:  0.011758565902709961
mini_batch_src_global generation:  0.025876998901367188
r_  generation:  0.21193337440490723
local_output_nid generation:  0.011955022811889648
local_in_edges_tensor generation:  0.011195659637451172
mini_batch_src_global generation:  0.025751352310180664
r_  generation:  0.2115321159362793
local_output_nid generation:  0.0122528076171875
local_in_edges_tensor generation:  0.012033224105834961
mini_batch_src_global generation:  0.027086257934570312
r_  generation:  0.2168264389038086
local_output_nid generation:  0.012319326400756836
local_in_edges_tensor generation:  0.012496232986450195
mini_batch_src_global generation:  0.027065038681030273
r_  generation:  0.22234869003295898
local_output_nid generation:  0.011883735656738281
local_in_edges_tensor generation:  0.011474132537841797
mini_batch_src_global generation:  0.026595115661621094
r_  generation:  0.21676087379455566
local_output_nid generation:  0.012132406234741211
local_in_edges_tensor generation:  0.011333942413330078
mini_batch_src_global generation:  0.02621626853942871
r_  generation:  0.2142789363861084
local_output_nid generation:  0.012429237365722656
local_in_edges_tensor generation:  0.011548280715942383
mini_batch_src_global generation:  0.026894569396972656
r_  generation:  0.21936464309692383
local_output_nid generation:  0.012373208999633789
local_in_edges_tensor generation:  0.012295722961425781
mini_batch_src_global generation:  0.026546955108642578
r_  generation:  0.21574640274047852
local_output_nid generation:  0.01228022575378418
local_in_edges_tensor generation:  0.01144862174987793
mini_batch_src_global generation:  0.02618885040283203
r_  generation:  0.21820712089538574
local_output_nid generation:  0.012187480926513672
local_in_edges_tensor generation:  0.013363838195800781
mini_batch_src_global generation:  0.028455257415771484
r_  generation:  0.2164602279663086
----------------------check_connections_block total spend ----------------------------- 4.957333326339722
generate_one_block  0.29050779342651367
generate_one_block  0.2856791019439697
generate_one_block  0.2916743755340576
generate_one_block  0.28456544876098633
generate_one_block  0.2809312343597412
generate_one_block  0.2837376594543457
generate_one_block  0.3174300193786621
generate_one_block  0.2795393466949463
generate_one_block  0.2830491065979004
generate_one_block  0.2936422824859619
generate_one_block  0.2846252918243408
generate_one_block  0.2794034481048584
generate_one_block  0.28771209716796875
generate_one_block  0.2855246067047119
generate_one_block  0.277604341506958
generate_one_block  0.28123927116394043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03772091865539551
gen group dst list time:  0.06112384796142578
time for parepare:  0.019199609756469727
local_output_nid generation:  0.0254976749420166
local_in_edges_tensor generation:  0.045264244079589844
mini_batch_src_global generation:  0.04133343696594238
r_  generation:  0.44544506072998047
local_output_nid generation:  0.029982328414916992
local_in_edges_tensor generation:  0.0366976261138916
mini_batch_src_global generation:  0.05210375785827637
r_  generation:  0.4460742473602295
local_output_nid generation:  0.030205249786376953
local_in_edges_tensor generation:  0.02812981605529785
mini_batch_src_global generation:  0.05091047286987305
r_  generation:  0.45752835273742676
local_output_nid generation:  0.03032708168029785
local_in_edges_tensor generation:  0.030245065689086914
mini_batch_src_global generation:  0.05240130424499512
r_  generation:  0.450671911239624
local_output_nid generation:  0.03105616569519043
local_in_edges_tensor generation:  0.07172918319702148
mini_batch_src_global generation:  0.0516507625579834
r_  generation:  0.4589669704437256
local_output_nid generation:  0.030583620071411133
local_in_edges_tensor generation:  0.030547142028808594
mini_batch_src_global generation:  0.053156375885009766
r_  generation:  0.45554065704345703
local_output_nid generation:  0.030922651290893555
local_in_edges_tensor generation:  0.030872583389282227
mini_batch_src_global generation:  0.051367998123168945
r_  generation:  0.46994614601135254
local_output_nid generation:  0.030669689178466797
local_in_edges_tensor generation:  0.03083181381225586
mini_batch_src_global generation:  0.05305075645446777
r_  generation:  0.45867443084716797
local_output_nid generation:  0.03145003318786621
local_in_edges_tensor generation:  0.029267072677612305
mini_batch_src_global generation:  0.05123424530029297
r_  generation:  0.4627089500427246
local_output_nid generation:  0.031038522720336914
local_in_edges_tensor generation:  0.032911062240600586
mini_batch_src_global generation:  0.053737640380859375
r_  generation:  0.4623699188232422
local_output_nid generation:  0.03104257583618164
local_in_edges_tensor generation:  0.03501176834106445
mini_batch_src_global generation:  0.05473804473876953
r_  generation:  0.4622306823730469
local_output_nid generation:  0.03337454795837402
local_in_edges_tensor generation:  0.028877735137939453
mini_batch_src_global generation:  0.053139686584472656
r_  generation:  0.4571495056152344
local_output_nid generation:  0.030974864959716797
local_in_edges_tensor generation:  0.0316472053527832
mini_batch_src_global generation:  0.05375933647155762
r_  generation:  0.46279263496398926
local_output_nid generation:  0.03130388259887695
local_in_edges_tensor generation:  0.032889366149902344
mini_batch_src_global generation:  0.054171085357666016
r_  generation:  0.45567750930786133
local_output_nid generation:  0.03093433380126953
local_in_edges_tensor generation:  0.03356790542602539
mini_batch_src_global generation:  0.05158042907714844
r_  generation:  0.47940587997436523
local_output_nid generation:  0.03400135040283203
local_in_edges_tensor generation:  0.030477523803710938
mini_batch_src_global generation:  0.054268836975097656
r_  generation:  0.45121264457702637
----------------------check_connections_block total spend ----------------------------- 10.826894998550415
generate_one_block  0.6055335998535156
generate_one_block  0.595745325088501
generate_one_block  0.5974955558776855
generate_one_block  0.5963954925537109
generate_one_block  0.590273380279541
generate_one_block  0.6008098125457764
generate_one_block  0.5976502895355225
generate_one_block  0.6094794273376465
generate_one_block  0.6669981479644775
generate_one_block  0.6041412353515625
generate_one_block  0.5981268882751465
generate_one_block  0.5986557006835938
generate_one_block  0.6075024604797363
generate_one_block  0.5942192077636719
generate_one_block  0.5977888107299805
generate_one_block  0.590343713760376
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.13471412658691406  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

connection checking time:  15.784228324890137
block generation total time  14.238024473190308
average batch blocks generation time:  0.8898765295743942
block dataloader generation time/epoch 32.29772686958313
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.11088991165161133  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 20.996676445007324  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.11124992370605469  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 21.198418140411377  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.11101865768432617  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 21.154629230499268  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.11124324798583984  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 21.17373752593994  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.11104583740234375  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 21.05396032333374  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.11117172241210938  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 21.04932403564453  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.1109776496887207  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 21.132362842559814  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.11110591888427734  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 20.917270183563232  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.11098098754882812  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 21.149136543273926  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 0.1114339828491211  GigaBytes
Max Memory Allocated: 21.5729022026062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2772216796875 GB
    Memory Allocated: 21.56395673751831  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0408935546875 GB
    Memory Allocated: 0.11099910736083984  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8182373046875 GB
    Memory Allocated: 21.19644784927368  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8201904296875 GB
    Memory Allocated: 0.11112117767333984  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8240966796875 GB
    Memory Allocated: 21.01323175430298  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8260498046875 GB
    Memory Allocated: 0.11104345321655273  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0369873046875 GB
    Memory Allocated: 21.309709072113037  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0369873046875 GB
    Memory Allocated: 0.11120986938476562  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0389404296875 GB
    Memory Allocated: 21.153364658355713  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 0.1108551025390625  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 20.982402324676514  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4373779296875 GB
    Memory Allocated: 0.11113643646240234  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5682373046875 GB
    Memory Allocated: 20.968351364135742  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0435037761926651 |0.014244556427001953 |0.3158002942800522 |9.039044380187988e-05 |0.5679392069578171 |0.005595684051513672 |
----------------------------------------------------------pseudo_mini_loss sum 1.6560455560684204
Total (block generation + training)time/epoch 47.40505051612854
Training time/epoch 15.107032060623169
Training time without block to device /epoch 14.879119157791138
Training time without total dataloading part /epoch 14.146873950958252
load block tensor time/epoch 0.6960604190826416
block to device time/epoch 0.22791290283203125
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  5091845
Number of first layer input nodes during this epoch:  2471263
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.5701904296875 GB
    Memory Allocated: 0.1340174674987793  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022806882858276367
range selection method range initialization spend 0.014074563980102539
time for parepare:  0.019293546676635742
local_output_nid generation:  0.0017080307006835938
local_in_edges_tensor generation:  0.006510257720947266
mini_batch_src_global generation:  0.001976490020751953
r_  generation:  0.018374204635620117
local_output_nid generation:  0.0017800331115722656
local_in_edges_tensor generation:  0.0014753341674804688
mini_batch_src_global generation:  0.0021762847900390625
r_  generation:  0.020055055618286133
local_output_nid generation:  0.0016922950744628906
local_in_edges_tensor generation:  0.0013506412506103516
mini_batch_src_global generation:  0.0015015602111816406
r_  generation:  0.01956653594970703
local_output_nid generation:  0.0017573833465576172
local_in_edges_tensor generation:  0.0011417865753173828
mini_batch_src_global generation:  0.001538991928100586
r_  generation:  0.019643306732177734
local_output_nid generation:  0.0017185211181640625
local_in_edges_tensor generation:  0.0009233951568603516
mini_batch_src_global generation:  0.0015125274658203125
r_  generation:  0.023112058639526367
local_output_nid generation:  0.0016880035400390625
local_in_edges_tensor generation:  0.001211404800415039
mini_batch_src_global generation:  0.0025968551635742188
r_  generation:  0.02946949005126953
local_output_nid generation:  0.0034780502319335938
local_in_edges_tensor generation:  0.001886606216430664
mini_batch_src_global generation:  0.003912210464477539
r_  generation:  0.022761106491088867
local_output_nid generation:  0.0016782283782958984
local_in_edges_tensor generation:  0.0009984970092773438
mini_batch_src_global generation:  0.0015742778778076172
r_  generation:  0.019215822219848633
local_output_nid generation:  0.0016720294952392578
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.0015649795532226562
r_  generation:  0.03459000587463379
local_output_nid generation:  0.002379179000854492
local_in_edges_tensor generation:  0.0011563301086425781
mini_batch_src_global generation:  0.0018126964569091797
r_  generation:  0.01969313621520996
local_output_nid generation:  0.002051830291748047
local_in_edges_tensor generation:  0.0011417865753173828
mini_batch_src_global generation:  0.0016527175903320312
r_  generation:  0.019385814666748047
local_output_nid generation:  0.0020449161529541016
local_in_edges_tensor generation:  0.0018203258514404297
mini_batch_src_global generation:  0.005498409271240234
r_  generation:  0.022973299026489258
local_output_nid generation:  0.002034902572631836
local_in_edges_tensor generation:  0.001051187515258789
mini_batch_src_global generation:  0.0015628337860107422
r_  generation:  0.01971721649169922
local_output_nid generation:  0.0019004344940185547
local_in_edges_tensor generation:  0.000965118408203125
mini_batch_src_global generation:  0.0015709400177001953
r_  generation:  0.020059823989868164
local_output_nid generation:  0.001749277114868164
local_in_edges_tensor generation:  0.0010716915130615234
mini_batch_src_global generation:  0.0015468597412109375
r_  generation:  0.019703149795532227
local_output_nid generation:  0.001714944839477539
local_in_edges_tensor generation:  0.0009393692016601562
mini_batch_src_global generation:  0.0015673637390136719
r_  generation:  0.019490957260131836
----------------------check_connections_block total spend ----------------------------- 0.5373637676239014
generate_one_block  0.03189539909362793
generate_one_block  0.032193899154663086
generate_one_block  0.03187847137451172
generate_one_block  0.03159594535827637
generate_one_block  0.031096458435058594
generate_one_block  0.032793283462524414
generate_one_block  0.03211045265197754
generate_one_block  0.030678272247314453
generate_one_block  0.031737565994262695
generate_one_block  0.03080129623413086
generate_one_block  0.03159928321838379
generate_one_block  0.031549930572509766
generate_one_block  0.03094649314880371
generate_one_block  0.031362295150756836
generate_one_block  0.03122544288635254
generate_one_block  0.030967235565185547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03475165367126465
gen group dst list time:  0.016644716262817383
time for parepare:  0.02028632164001465
local_output_nid generation:  0.006943941116333008
local_in_edges_tensor generation:  0.02039480209350586
mini_batch_src_global generation:  0.020280838012695312
r_  generation:  0.1908566951751709
local_output_nid generation:  0.01044154167175293
local_in_edges_tensor generation:  0.01348257064819336
mini_batch_src_global generation:  0.024704456329345703
r_  generation:  0.20596766471862793
local_output_nid generation:  0.01065683364868164
local_in_edges_tensor generation:  0.012642860412597656
mini_batch_src_global generation:  0.02351546287536621
r_  generation:  0.20721149444580078
local_output_nid generation:  0.01156473159790039
local_in_edges_tensor generation:  0.011102676391601562
mini_batch_src_global generation:  0.024749279022216797
r_  generation:  0.21278119087219238
local_output_nid generation:  0.011643171310424805
local_in_edges_tensor generation:  0.012720823287963867
mini_batch_src_global generation:  0.025715351104736328
r_  generation:  0.21590232849121094
local_output_nid generation:  0.011761665344238281
local_in_edges_tensor generation:  0.011943340301513672
mini_batch_src_global generation:  0.02588367462158203
r_  generation:  0.20981693267822266
local_output_nid generation:  0.011983394622802734
local_in_edges_tensor generation:  0.011194467544555664
mini_batch_src_global generation:  0.026371002197265625
r_  generation:  0.21286678314208984
local_output_nid generation:  0.011976957321166992
local_in_edges_tensor generation:  0.011338233947753906
mini_batch_src_global generation:  0.02583003044128418
r_  generation:  0.2132420539855957
local_output_nid generation:  0.012297391891479492
local_in_edges_tensor generation:  0.011696338653564453
mini_batch_src_global generation:  0.02910780906677246
r_  generation:  0.2164466381072998
local_output_nid generation:  0.012071609497070312
local_in_edges_tensor generation:  0.011208295822143555
mini_batch_src_global generation:  0.026311159133911133
r_  generation:  0.2139301300048828
local_output_nid generation:  0.011747598648071289
local_in_edges_tensor generation:  0.012258529663085938
mini_batch_src_global generation:  0.027535438537597656
r_  generation:  0.21697354316711426
local_output_nid generation:  0.012053966522216797
local_in_edges_tensor generation:  0.01141810417175293
mini_batch_src_global generation:  0.02630901336669922
r_  generation:  0.21392583847045898
local_output_nid generation:  0.012285470962524414
local_in_edges_tensor generation:  0.01203298568725586
mini_batch_src_global generation:  0.0267183780670166
r_  generation:  0.21749210357666016
local_output_nid generation:  0.012340545654296875
local_in_edges_tensor generation:  0.01230478286743164
mini_batch_src_global generation:  0.02977728843688965
r_  generation:  0.21694183349609375
local_output_nid generation:  0.012302398681640625
local_in_edges_tensor generation:  0.01187896728515625
mini_batch_src_global generation:  0.027117490768432617
r_  generation:  0.21696758270263672
local_output_nid generation:  0.012170076370239258
local_in_edges_tensor generation:  0.012427568435668945
mini_batch_src_global generation:  0.027828216552734375
r_  generation:  0.21315360069274902
----------------------check_connections_block total spend ----------------------------- 4.9603354930877686
generate_one_block  0.2861926555633545
generate_one_block  0.2869589328765869
generate_one_block  0.29018712043762207
generate_one_block  0.298231840133667
generate_one_block  0.30092334747314453
generate_one_block  0.2866387367248535
generate_one_block  0.31907010078430176
generate_one_block  0.2763516902923584
generate_one_block  0.2868163585662842
generate_one_block  0.2797203063964844
generate_one_block  0.28398633003234863
generate_one_block  0.2831583023071289
generate_one_block  0.2839477062225342
generate_one_block  0.28787684440612793
generate_one_block  0.28485584259033203
generate_one_block  0.28225278854370117
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03217601776123047
gen group dst list time:  0.06171727180480957
time for parepare:  0.03272080421447754
local_output_nid generation:  0.025582551956176758
local_in_edges_tensor generation:  0.04692435264587402
mini_batch_src_global generation:  0.039679527282714844
r_  generation:  0.4505581855773926
local_output_nid generation:  0.030865907669067383
local_in_edges_tensor generation:  0.03670167922973633
mini_batch_src_global generation:  0.05625510215759277
r_  generation:  0.4519031047821045
local_output_nid generation:  0.030892610549926758
local_in_edges_tensor generation:  0.034204959869384766
mini_batch_src_global generation:  0.05219721794128418
r_  generation:  0.4602041244506836
local_output_nid generation:  0.03130054473876953
local_in_edges_tensor generation:  0.04431343078613281
mini_batch_src_global generation:  0.05538320541381836
r_  generation:  0.4769630432128906
local_output_nid generation:  0.03530311584472656
local_in_edges_tensor generation:  0.0895390510559082
mini_batch_src_global generation:  0.05666780471801758
r_  generation:  0.4594857692718506
local_output_nid generation:  0.03104710578918457
local_in_edges_tensor generation:  0.03936338424682617
mini_batch_src_global generation:  0.05355238914489746
r_  generation:  0.4529845714569092
local_output_nid generation:  0.030985116958618164
local_in_edges_tensor generation:  0.0316312313079834
mini_batch_src_global generation:  0.052375078201293945
r_  generation:  0.4565556049346924
local_output_nid generation:  0.0311279296875
local_in_edges_tensor generation:  0.03191566467285156
mini_batch_src_global generation:  0.053554534912109375
r_  generation:  0.4518263339996338
local_output_nid generation:  0.031143903732299805
local_in_edges_tensor generation:  0.030411958694458008
mini_batch_src_global generation:  0.052228689193725586
r_  generation:  0.4602384567260742
local_output_nid generation:  0.03107929229736328
local_in_edges_tensor generation:  0.02910900115966797
mini_batch_src_global generation:  0.05328369140625
r_  generation:  0.45456576347351074
local_output_nid generation:  0.03132057189941406
local_in_edges_tensor generation:  0.029415607452392578
mini_batch_src_global generation:  0.05199432373046875
r_  generation:  0.46896982192993164
local_output_nid generation:  0.031186580657958984
local_in_edges_tensor generation:  0.03263092041015625
mini_batch_src_global generation:  0.05334782600402832
r_  generation:  0.45277953147888184
local_output_nid generation:  0.03125739097595215
local_in_edges_tensor generation:  0.032987117767333984
mini_batch_src_global generation:  0.05445694923400879
r_  generation:  0.4585740566253662
local_output_nid generation:  0.031258344650268555
local_in_edges_tensor generation:  0.03360152244567871
mini_batch_src_global generation:  0.055533409118652344
r_  generation:  0.45433974266052246
local_output_nid generation:  0.03137493133544922
local_in_edges_tensor generation:  0.03802204132080078
mini_batch_src_global generation:  0.054395198822021484
r_  generation:  0.4626753330230713
local_output_nid generation:  0.03122091293334961
local_in_edges_tensor generation:  0.03404641151428223
mini_batch_src_global generation:  0.0532834529876709
r_  generation:  0.4556868076324463
----------------------check_connections_block total spend ----------------------------- 10.921696186065674
generate_one_block  0.6165604591369629
generate_one_block  0.6013236045837402
generate_one_block  0.6131772994995117
generate_one_block  0.6122887134552002
generate_one_block  0.5996708869934082
generate_one_block  0.5908200740814209
generate_one_block  0.5978944301605225
generate_one_block  0.5944995880126953
generate_one_block  0.6434793472290039
generate_one_block  0.6015913486480713
generate_one_block  0.609959602355957
generate_one_block  0.5927891731262207
generate_one_block  0.6063125133514404
generate_one_block  0.6078107357025146
generate_one_block  0.5979874134063721
generate_one_block  0.59342360496521
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5701904296875 GB
    Memory Allocated: 0.1340174674987793  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

connection checking time:  15.882031679153442
block generation total time  14.296757698059082
average batch blocks generation time:  0.8935473561286926
block dataloader generation time/epoch 32.38600742816925
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5701904296875 GB
    Memory Allocated: 0.11090326309204102  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5701904296875 GB
    Memory Allocated: 20.912320137023926  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5701904296875 GB
    Memory Allocated: 0.11127948760986328  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8768310546875 GB
    Memory Allocated: 21.254085540771484  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8768310546875 GB
    Memory Allocated: 0.11107301712036133  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8826904296875 GB
    Memory Allocated: 21.14562177658081  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8846435546875 GB
    Memory Allocated: 0.1113443374633789  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 21.38339853286743  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.11107635498046875  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 21.286871433258057  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.1111135482788086  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.95897626876831  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.11116409301757812  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 21.145253658294678  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.11104393005371094  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 20.857411861419678  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.11123228073120117  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 21.255353450775146  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.11116600036621094  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 21.05431318283081  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.11089849472045898  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1971435546875 GB
    Memory Allocated: 21.15366554260254  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11119556427001953  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.091397762298584  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11107873916625977  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.18341302871704  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11130428314208984  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.287156581878662  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11088228225708008  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.141413688659668  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11101055145263672  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 20.803643703460693  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.043096452951431274 |0.013462871313095093 |0.30673909187316895 |9.18954610824585e-05 |0.5592077225446701 |0.006569385528564453 |
----------------------------------------------------------pseudo_mini_loss sum 1.6036326885223389
Total (block generation + training)time/epoch 47.34174728393555
Training time/epoch 14.803905725479126
Training time without block to device /epoch 14.588499784469604
Training time without total dataloading part /epoch 13.863188743591309
load block tensor time/epoch 0.6895432472229004
block to device time/epoch 0.21540594100952148
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  5093385
Number of first layer input nodes during this epoch:  2472328
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.13556480407714844  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023425817489624023
range selection method range initialization spend 0.013477563858032227
time for parepare:  0.01807713508605957
local_output_nid generation:  0.0016665458679199219
local_in_edges_tensor generation:  0.00714421272277832
mini_batch_src_global generation:  0.0016798973083496094
r_  generation:  0.018961191177368164
local_output_nid generation:  0.0018057823181152344
local_in_edges_tensor generation:  0.0012645721435546875
mini_batch_src_global generation:  0.0019145011901855469
r_  generation:  0.0199434757232666
local_output_nid generation:  0.0017442703247070312
local_in_edges_tensor generation:  0.0012295246124267578
mini_batch_src_global generation:  0.0015697479248046875
r_  generation:  0.018827199935913086
local_output_nid generation:  0.0016829967498779297
local_in_edges_tensor generation:  0.0015997886657714844
mini_batch_src_global generation:  0.0015866756439208984
r_  generation:  0.01880168914794922
local_output_nid generation:  0.0016388893127441406
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.0015892982482910156
r_  generation:  0.01920485496520996
local_output_nid generation:  0.0016674995422363281
local_in_edges_tensor generation:  0.0009086132049560547
mini_batch_src_global generation:  0.0015759468078613281
r_  generation:  0.019188642501831055
local_output_nid generation:  0.0016281604766845703
local_in_edges_tensor generation:  0.0009453296661376953
mini_batch_src_global generation:  0.002798795700073242
r_  generation:  0.023708820343017578
local_output_nid generation:  0.002082347869873047
local_in_edges_tensor generation:  0.0012407302856445312
mini_batch_src_global generation:  0.0020415782928466797
r_  generation:  0.021507978439331055
local_output_nid generation:  0.002026081085205078
local_in_edges_tensor generation:  0.0010976791381835938
mini_batch_src_global generation:  0.0019071102142333984
r_  generation:  0.02111506462097168
local_output_nid generation:  0.0019328594207763672
local_in_edges_tensor generation:  0.0010213851928710938
mini_batch_src_global generation:  0.0019431114196777344
r_  generation:  0.02137589454650879
local_output_nid generation:  0.0019009113311767578
local_in_edges_tensor generation:  0.0010290145874023438
mini_batch_src_global generation:  0.0028557777404785156
r_  generation:  0.024576425552368164
local_output_nid generation:  0.003666400909423828
local_in_edges_tensor generation:  0.0018787384033203125
mini_batch_src_global generation:  0.004006147384643555
r_  generation:  0.03393745422363281
local_output_nid generation:  0.003373384475708008
local_in_edges_tensor generation:  0.0018281936645507812
mini_batch_src_global generation:  0.004382133483886719
r_  generation:  0.024133920669555664
local_output_nid generation:  0.0016160011291503906
local_in_edges_tensor generation:  0.0008997917175292969
mini_batch_src_global generation:  0.0020165443420410156
r_  generation:  0.02200913429260254
local_output_nid generation:  0.0016193389892578125
local_in_edges_tensor generation:  0.0009071826934814453
mini_batch_src_global generation:  0.0018956661224365234
r_  generation:  0.021529197692871094
local_output_nid generation:  0.0016050338745117188
local_in_edges_tensor generation:  0.0009806156158447266
mini_batch_src_global generation:  0.0018694400787353516
r_  generation:  0.019495487213134766
----------------------check_connections_block total spend ----------------------------- 0.554135799407959
generate_one_block  0.032279253005981445
generate_one_block  0.03617453575134277
generate_one_block  0.031130075454711914
generate_one_block  0.031158447265625
generate_one_block  0.0493168830871582
generate_one_block  0.03477120399475098
generate_one_block  0.03242325782775879
generate_one_block  0.03116917610168457
generate_one_block  0.031177520751953125
generate_one_block  0.03116750717163086
generate_one_block  0.030846118927001953
generate_one_block  0.031030893325805664
generate_one_block  0.030822277069091797
generate_one_block  0.03364682197570801
generate_one_block  0.03475046157836914
generate_one_block  0.03155040740966797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03237414360046387
gen group dst list time:  0.01898026466369629
time for parepare:  0.020303726196289062
local_output_nid generation:  0.007043361663818359
local_in_edges_tensor generation:  0.022611379623413086
mini_batch_src_global generation:  0.020777463912963867
r_  generation:  0.1955263614654541
local_output_nid generation:  0.010667800903320312
local_in_edges_tensor generation:  0.011851072311401367
mini_batch_src_global generation:  0.024678468704223633
r_  generation:  0.20424699783325195
local_output_nid generation:  0.010899782180786133
local_in_edges_tensor generation:  0.014377355575561523
mini_batch_src_global generation:  0.02478647232055664
r_  generation:  0.20595717430114746
local_output_nid generation:  0.011688709259033203
local_in_edges_tensor generation:  0.014513015747070312
mini_batch_src_global generation:  0.024238109588623047
r_  generation:  0.20781254768371582
local_output_nid generation:  0.011874675750732422
local_in_edges_tensor generation:  0.012751102447509766
mini_batch_src_global generation:  0.025815486907958984
r_  generation:  0.21233773231506348
local_output_nid generation:  0.011687994003295898
local_in_edges_tensor generation:  0.011198759078979492
mini_batch_src_global generation:  0.02582859992980957
r_  generation:  0.21298456192016602
local_output_nid generation:  0.012305021286010742
local_in_edges_tensor generation:  0.011356115341186523
mini_batch_src_global generation:  0.026798248291015625
r_  generation:  0.21738553047180176
local_output_nid generation:  0.012029409408569336
local_in_edges_tensor generation:  0.0119781494140625
mini_batch_src_global generation:  0.02606797218322754
r_  generation:  0.21155405044555664
local_output_nid generation:  0.012354850769042969
local_in_edges_tensor generation:  0.011080741882324219
mini_batch_src_global generation:  0.027636051177978516
r_  generation:  0.2154080867767334
local_output_nid generation:  0.012350320816040039
local_in_edges_tensor generation:  0.011288166046142578
mini_batch_src_global generation:  0.026282787322998047
r_  generation:  0.21712994575500488
local_output_nid generation:  0.012106180191040039
local_in_edges_tensor generation:  0.011357545852661133
mini_batch_src_global generation:  0.028244972229003906
r_  generation:  0.21471548080444336
local_output_nid generation:  0.012445688247680664
local_in_edges_tensor generation:  0.0115509033203125
mini_batch_src_global generation:  0.02667975425720215
r_  generation:  0.21661663055419922
local_output_nid generation:  0.012571573257446289
local_in_edges_tensor generation:  0.012436389923095703
mini_batch_src_global generation:  0.02781391143798828
r_  generation:  0.2162022590637207
local_output_nid generation:  0.012563943862915039
local_in_edges_tensor generation:  0.01151275634765625
mini_batch_src_global generation:  0.02638554573059082
r_  generation:  0.21438169479370117
local_output_nid generation:  0.012368917465209961
local_in_edges_tensor generation:  0.012252092361450195
mini_batch_src_global generation:  0.029630184173583984
r_  generation:  0.21990442276000977
local_output_nid generation:  0.012484073638916016
local_in_edges_tensor generation:  0.012639999389648438
mini_batch_src_global generation:  0.027399778366088867
r_  generation:  0.22057628631591797
----------------------check_connections_block total spend ----------------------------- 4.980726480484009
generate_one_block  0.29506850242614746
generate_one_block  0.2887394428253174
generate_one_block  0.29166483879089355
generate_one_block  0.28432226181030273
generate_one_block  0.28931188583374023
generate_one_block  0.2843902111053467
generate_one_block  0.3179173469543457
generate_one_block  0.27777624130249023
generate_one_block  0.27997732162475586
generate_one_block  0.28510570526123047
generate_one_block  0.2808663845062256
generate_one_block  0.2845757007598877
generate_one_block  0.2812011241912842
generate_one_block  0.2788102626800537
generate_one_block  0.28116536140441895
generate_one_block  0.2869703769683838
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03478288650512695
gen group dst list time:  0.0618443489074707
time for parepare:  0.019165992736816406
local_output_nid generation:  0.025786161422729492
local_in_edges_tensor generation:  0.04773569107055664
mini_batch_src_global generation:  0.04325413703918457
r_  generation:  0.45577001571655273
local_output_nid generation:  0.03103780746459961
local_in_edges_tensor generation:  0.03609132766723633
mini_batch_src_global generation:  0.05256485939025879
r_  generation:  0.4538075923919678
local_output_nid generation:  0.030406951904296875
local_in_edges_tensor generation:  0.03569340705871582
mini_batch_src_global generation:  0.05223822593688965
r_  generation:  0.4553859233856201
local_output_nid generation:  0.030739784240722656
local_in_edges_tensor generation:  0.03088092803955078
mini_batch_src_global generation:  0.05179023742675781
r_  generation:  0.45297670364379883
local_output_nid generation:  0.030814647674560547
local_in_edges_tensor generation:  0.07593226432800293
mini_batch_src_global generation:  0.051499366760253906
r_  generation:  0.4611837863922119
local_output_nid generation:  0.03220009803771973
local_in_edges_tensor generation:  0.03084707260131836
mini_batch_src_global generation:  0.055362701416015625
r_  generation:  0.4584503173828125
local_output_nid generation:  0.031061649322509766
local_in_edges_tensor generation:  0.033348798751831055
mini_batch_src_global generation:  0.055518150329589844
r_  generation:  0.46100687980651855
local_output_nid generation:  0.03187704086303711
local_in_edges_tensor generation:  0.034006595611572266
mini_batch_src_global generation:  0.053099870681762695
r_  generation:  0.4608113765716553
local_output_nid generation:  0.031263113021850586
local_in_edges_tensor generation:  0.03597569465637207
mini_batch_src_global generation:  0.05203819274902344
r_  generation:  0.48139286041259766
local_output_nid generation:  0.034423828125
local_in_edges_tensor generation:  0.03136563301086426
mini_batch_src_global generation:  0.05529141426086426
r_  generation:  0.45509815216064453
local_output_nid generation:  0.03243708610534668
local_in_edges_tensor generation:  0.028923511505126953
mini_batch_src_global generation:  0.053498268127441406
r_  generation:  0.46068906784057617
local_output_nid generation:  0.03200936317443848
local_in_edges_tensor generation:  0.03247785568237305
mini_batch_src_global generation:  0.05278968811035156
r_  generation:  0.4575321674346924
local_output_nid generation:  0.03249931335449219
local_in_edges_tensor generation:  0.029573678970336914
mini_batch_src_global generation:  0.052150726318359375
r_  generation:  0.4605553150177002
local_output_nid generation:  0.032106876373291016
local_in_edges_tensor generation:  0.02863597869873047
mini_batch_src_global generation:  0.05271410942077637
r_  generation:  0.45232152938842773
local_output_nid generation:  0.031931161880493164
local_in_edges_tensor generation:  0.03243446350097656
mini_batch_src_global generation:  0.05308675765991211
r_  generation:  0.4643728733062744
local_output_nid generation:  0.032378435134887695
local_in_edges_tensor generation:  0.028727054595947266
mini_batch_src_global generation:  0.05255746841430664
r_  generation:  0.4666004180908203
----------------------check_connections_block total spend ----------------------------- 10.874061584472656
generate_one_block  0.6152169704437256
generate_one_block  0.601485013961792
generate_one_block  0.5918841361999512
generate_one_block  0.5963308811187744
generate_one_block  0.6043460369110107
generate_one_block  0.6001689434051514
generate_one_block  0.598804235458374
generate_one_block  0.5915415287017822
generate_one_block  0.6666243076324463
generate_one_block  0.5930087566375732
generate_one_block  0.5986762046813965
generate_one_block  0.5987021923065186
generate_one_block  0.6000924110412598
generate_one_block  0.594883918762207
generate_one_block  0.6108040809631348
generate_one_block  0.6137998104095459
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.13556480407714844  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

connection checking time:  15.854788064956665
block generation total time  14.264232397079468
average batch blocks generation time:  0.8915145248174667
block dataloader generation time/epoch 32.398810227712
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.1112208366394043  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.24357318878174  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.1113271713256836  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.370789051055908  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11096000671386719  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.047773838043213  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11115169525146484  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.004997730255127  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.1108865737915039  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.121561527252197  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11121082305908203  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.13687515258789  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11104488372802734  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.218757152557373  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11105060577392578  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 20.842952728271484  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11098337173461914  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.095938682556152  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11120414733886719  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.139606952667236  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11120080947875977  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.05723237991333  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11124610900878906  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.172848224639893  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11085748672485352  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.041919231414795  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11113548278808594  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.024202346801758  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11096858978271484  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.060237884521484  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11118698120117188  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.09179925918579  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04421214759349823 |0.014801710844039917 |0.3041392117738724 |9.296834468841553e-05 |0.5576671063899994 |0.005181550979614258 |
----------------------------------------------------------pseudo_mini_loss sum 1.5537699460983276
Total (block generation + training)time/epoch 47.2955113252004
Training time/epoch 14.77838945388794
Training time without block to device /epoch 14.5415620803833
Training time without total dataloading part /epoch 13.795570135116577
load block tensor time/epoch 0.7073943614959717
block to device time/epoch 0.23682737350463867
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  5092946
Number of first layer input nodes during this epoch:  2472443
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.13483190536499023  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027054548263549805
range selection method range initialization spend 0.013931512832641602
time for parepare:  0.022369861602783203
local_output_nid generation:  0.002043485641479492
local_in_edges_tensor generation:  0.005281686782836914
mini_batch_src_global generation:  0.003762960433959961
r_  generation:  0.018774986267089844
local_output_nid generation:  0.0018498897552490234
local_in_edges_tensor generation:  0.0014348030090332031
mini_batch_src_global generation:  0.0024204254150390625
r_  generation:  0.02106952667236328
local_output_nid generation:  0.0018994808197021484
local_in_edges_tensor generation:  0.001321554183959961
mini_batch_src_global generation:  0.0014841556549072266
r_  generation:  0.017432212829589844
local_output_nid generation:  0.0019817352294921875
local_in_edges_tensor generation:  0.0010609626770019531
mini_batch_src_global generation:  0.0015835762023925781
r_  generation:  0.017878055572509766
local_output_nid generation:  0.001874685287475586
local_in_edges_tensor generation:  0.0011856555938720703
mini_batch_src_global generation:  0.0014939308166503906
r_  generation:  0.017951488494873047
local_output_nid generation:  0.0019001960754394531
local_in_edges_tensor generation:  0.0011243820190429688
mini_batch_src_global generation:  0.0015263557434082031
r_  generation:  0.01808643341064453
local_output_nid generation:  0.0018846988677978516
local_in_edges_tensor generation:  0.0011913776397705078
mini_batch_src_global generation:  0.001514434814453125
r_  generation:  0.02500319480895996
local_output_nid generation:  0.0025315284729003906
local_in_edges_tensor generation:  0.0013496875762939453
mini_batch_src_global generation:  0.015813112258911133
r_  generation:  0.02308034896850586
local_output_nid generation:  0.0018906593322753906
local_in_edges_tensor generation:  0.0010204315185546875
mini_batch_src_global generation:  0.0018818378448486328
r_  generation:  0.028711795806884766
local_output_nid generation:  0.0020728111267089844
local_in_edges_tensor generation:  0.0010447502136230469
mini_batch_src_global generation:  0.0016083717346191406
r_  generation:  0.018121004104614258
local_output_nid generation:  0.001889944076538086
local_in_edges_tensor generation:  0.001016378402709961
mini_batch_src_global generation:  0.0015156269073486328
r_  generation:  0.018096446990966797
local_output_nid generation:  0.0018768310546875
local_in_edges_tensor generation:  0.00102996826171875
mini_batch_src_global generation:  0.0015077590942382812
r_  generation:  0.018147706985473633
local_output_nid generation:  0.001817941665649414
local_in_edges_tensor generation:  0.0010471343994140625
mini_batch_src_global generation:  0.001439809799194336
r_  generation:  0.01875591278076172
local_output_nid generation:  0.0018451213836669922
local_in_edges_tensor generation:  0.0010232925415039062
mini_batch_src_global generation:  0.0015974044799804688
r_  generation:  0.01790452003479004
local_output_nid generation:  0.0017864704132080078
local_in_edges_tensor generation:  0.0010247230529785156
mini_batch_src_global generation:  0.001392364501953125
r_  generation:  0.018607378005981445
local_output_nid generation:  0.0018086433410644531
local_in_edges_tensor generation:  0.0010268688201904297
mini_batch_src_global generation:  0.0015904903411865234
r_  generation:  0.01791834831237793
----------------------check_connections_block total spend ----------------------------- 0.5172908306121826
generate_one_block  0.04651451110839844
generate_one_block  0.043520212173461914
generate_one_block  0.04609560966491699
generate_one_block  0.03232431411743164
generate_one_block  0.03318190574645996
generate_one_block  0.03803372383117676
generate_one_block  0.03400158882141113
generate_one_block  0.034272193908691406
generate_one_block  0.032550811767578125
generate_one_block  0.03300118446350098
generate_one_block  0.03246426582336426
generate_one_block  0.03253626823425293
generate_one_block  0.03435778617858887
generate_one_block  0.0322568416595459
generate_one_block  0.03217673301696777
generate_one_block  0.034570932388305664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03247952461242676
gen group dst list time:  0.019624948501586914
time for parepare:  0.02028346061706543
local_output_nid generation:  0.007258415222167969
local_in_edges_tensor generation:  0.016860485076904297
mini_batch_src_global generation:  0.0204164981842041
r_  generation:  0.219865083694458
local_output_nid generation:  0.010558605194091797
local_in_edges_tensor generation:  0.014256477355957031
mini_batch_src_global generation:  0.04047584533691406
r_  generation:  0.24006223678588867
local_output_nid generation:  0.010693550109863281
local_in_edges_tensor generation:  0.010608673095703125
mini_batch_src_global generation:  0.024626970291137695
r_  generation:  0.20747137069702148
local_output_nid generation:  0.011670589447021484
local_in_edges_tensor generation:  0.011938333511352539
mini_batch_src_global generation:  0.024936199188232422
r_  generation:  0.2171018123626709
local_output_nid generation:  0.011841773986816406
local_in_edges_tensor generation:  0.012941360473632812
mini_batch_src_global generation:  0.02760457992553711
r_  generation:  0.2316267490386963
local_output_nid generation:  0.014667034149169922
local_in_edges_tensor generation:  0.01138758659362793
mini_batch_src_global generation:  0.028041839599609375
r_  generation:  0.2192211151123047
local_output_nid generation:  0.012658119201660156
local_in_edges_tensor generation:  0.014487028121948242
mini_batch_src_global generation:  0.030781030654907227
r_  generation:  0.22597575187683105
local_output_nid generation:  0.013556718826293945
local_in_edges_tensor generation:  0.014594078063964844
mini_batch_src_global generation:  0.029093265533447266
r_  generation:  0.2294933795928955
local_output_nid generation:  0.012239217758178711
local_in_edges_tensor generation:  0.012758493423461914
mini_batch_src_global generation:  0.030457735061645508
r_  generation:  0.21735286712646484
local_output_nid generation:  0.012577056884765625
local_in_edges_tensor generation:  0.018552064895629883
mini_batch_src_global generation:  0.028949975967407227
r_  generation:  0.23158955574035645
local_output_nid generation:  0.014706850051879883
local_in_edges_tensor generation:  0.012650251388549805
mini_batch_src_global generation:  0.026714086532592773
r_  generation:  0.21633195877075195
local_output_nid generation:  0.012367725372314453
local_in_edges_tensor generation:  0.011622428894042969
mini_batch_src_global generation:  0.03903508186340332
r_  generation:  0.24770593643188477
local_output_nid generation:  0.014794111251831055
local_in_edges_tensor generation:  0.012935876846313477
mini_batch_src_global generation:  0.0305023193359375
r_  generation:  0.22387933731079102
local_output_nid generation:  0.012671947479248047
local_in_edges_tensor generation:  0.01122426986694336
mini_batch_src_global generation:  0.026923656463623047
r_  generation:  0.21488666534423828
local_output_nid generation:  0.013066768646240234
local_in_edges_tensor generation:  0.012392282485961914
mini_batch_src_global generation:  0.02861332893371582
r_  generation:  0.2225947380065918
local_output_nid generation:  0.01261591911315918
local_in_edges_tensor generation:  0.012111186981201172
mini_batch_src_global generation:  0.026899099349975586
r_  generation:  0.21565866470336914
----------------------check_connections_block total spend ----------------------------- 5.25642466545105
generate_one_block  0.2833852767944336
generate_one_block  0.28530120849609375
generate_one_block  0.2736814022064209
generate_one_block  0.2813432216644287
generate_one_block  0.28673219680786133
generate_one_block  0.2810239791870117
generate_one_block  0.31063222885131836
generate_one_block  0.29190492630004883
generate_one_block  0.2733125686645508
generate_one_block  0.29859328269958496
generate_one_block  0.2843186855316162
generate_one_block  0.2844362258911133
generate_one_block  0.2971615791320801
generate_one_block  0.2878289222717285
generate_one_block  0.2881951332092285
generate_one_block  0.27887415885925293
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03495430946350098
gen group dst list time:  0.06880950927734375
time for parepare:  0.01914072036743164
local_output_nid generation:  0.02559494972229004
local_in_edges_tensor generation:  0.04680442810058594
mini_batch_src_global generation:  0.05465435981750488
r_  generation:  0.4471924304962158
local_output_nid generation:  0.030411243438720703
local_in_edges_tensor generation:  0.03686881065368652
mini_batch_src_global generation:  0.0532224178314209
r_  generation:  0.4489328861236572
local_output_nid generation:  0.03031158447265625
local_in_edges_tensor generation:  0.03132510185241699
mini_batch_src_global generation:  0.05145120620727539
r_  generation:  0.45812535285949707
local_output_nid generation:  0.029945850372314453
local_in_edges_tensor generation:  0.040938377380371094
mini_batch_src_global generation:  0.0523228645324707
r_  generation:  0.4589383602142334
local_output_nid generation:  0.03246259689331055
local_in_edges_tensor generation:  0.07744002342224121
mini_batch_src_global generation:  0.05373644828796387
r_  generation:  0.46920156478881836
local_output_nid generation:  0.031966209411621094
local_in_edges_tensor generation:  0.043944597244262695
mini_batch_src_global generation:  0.06798672676086426
r_  generation:  0.4536268711090088
local_output_nid generation:  0.032854318618774414
local_in_edges_tensor generation:  0.030310869216918945
mini_batch_src_global generation:  0.051656484603881836
r_  generation:  0.45933985710144043
local_output_nid generation:  0.03179931640625
local_in_edges_tensor generation:  0.03457021713256836
mini_batch_src_global generation:  0.05332446098327637
r_  generation:  0.46008753776550293
local_output_nid generation:  0.03153085708618164
local_in_edges_tensor generation:  0.03015756607055664
mini_batch_src_global generation:  0.05182909965515137
r_  generation:  0.461087703704834
local_output_nid generation:  0.03202176094055176
local_in_edges_tensor generation:  0.0399017333984375
mini_batch_src_global generation:  0.052913665771484375
r_  generation:  0.46283936500549316
local_output_nid generation:  0.031687259674072266
local_in_edges_tensor generation:  0.029080629348754883
mini_batch_src_global generation:  0.0519864559173584
r_  generation:  0.4635775089263916
local_output_nid generation:  0.03172898292541504
local_in_edges_tensor generation:  0.030495405197143555
mini_batch_src_global generation:  0.05420398712158203
r_  generation:  0.45617079734802246
local_output_nid generation:  0.03191995620727539
local_in_edges_tensor generation:  0.04003453254699707
mini_batch_src_global generation:  0.053537845611572266
r_  generation:  0.46696019172668457
local_output_nid generation:  0.03802371025085449
local_in_edges_tensor generation:  0.03699040412902832
mini_batch_src_global generation:  0.06309986114501953
r_  generation:  0.45278406143188477
local_output_nid generation:  0.032050132751464844
local_in_edges_tensor generation:  0.030687808990478516
mini_batch_src_global generation:  0.05371689796447754
r_  generation:  0.45621323585510254
local_output_nid generation:  0.0316317081451416
local_in_edges_tensor generation:  0.028806209564208984
mini_batch_src_global generation:  0.053040504455566406
r_  generation:  0.4505620002746582
----------------------check_connections_block total spend ----------------------------- 10.963762283325195
generate_one_block  0.602557897567749
generate_one_block  0.6001584529876709
generate_one_block  0.5945580005645752
generate_one_block  0.5995619297027588
generate_one_block  0.6020970344543457
generate_one_block  0.6091330051422119
generate_one_block  0.6148734092712402
generate_one_block  0.6060571670532227
generate_one_block  0.6334178447723389
generate_one_block  0.609987735748291
generate_one_block  0.5982816219329834
generate_one_block  0.6075541973114014
generate_one_block  0.6100902557373047
generate_one_block  0.5941300392150879
generate_one_block  0.6191744804382324
generate_one_block  0.5936636924743652
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.13483190536499023  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

connection checking time:  16.220186948776245
block generation total time  14.282021760940552
average batch blocks generation time:  0.8926263600587845
block dataloader generation time/epoch 32.523424446582794
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11064672470092773  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 20.865413188934326  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11123275756835938  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.183706283569336  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11079740524291992  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 20.783204078674316  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11122703552246094  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.146146297454834  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11106681823730469  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.181791305541992  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11119651794433594  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.110605716705322  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11111021041870117  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 21.30597686767578  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.11146688461303711  GigaBytes
Max Memory Allocated: 21.625619888305664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4158935546875 GB
    Memory Allocated: 21.581256866455078  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2811279296875 GB
    Memory Allocated: 0.11087989807128906  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3338623046875 GB
    Memory Allocated: 20.70274066925049  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3358154296875 GB
    Memory Allocated: 0.11120176315307617  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7459716796875 GB
    Memory Allocated: 21.026966094970703  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.11087608337402344  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 20.98095178604126  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.11116266250610352  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 20.98382806777954  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 0.11114883422851562  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9920654296875 GB
    Memory Allocated: 21.328109741210938  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9940185546875 GB
    Memory Allocated: 0.11110734939575195  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9940185546875 GB
    Memory Allocated: 20.953945636749268  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9940185546875 GB
    Memory Allocated: 0.11119365692138672  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0037841796875 GB
    Memory Allocated: 21.272191047668457  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0057373046875 GB
    Memory Allocated: 0.11108064651489258  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0057373046875 GB
    Memory Allocated: 20.86204242706299  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04265369474887848 |0.013757556676864624 |0.30907148122787476 |9.31769609451294e-05 |0.5626621097326279 |0.005526542663574219 |
----------------------------------------------------------pseudo_mini_loss sum 1.5357491970062256
Total (block generation + training)time/epoch 47.41944396495819
Training time/epoch 14.8937349319458
Training time without block to device /epoch 14.673614025115967
Training time without total dataloading part /epoch 13.954754829406738
load block tensor time/epoch 0.6824591159820557
block to device time/epoch 0.22012090682983398
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  5088995
Number of first layer input nodes during this epoch:  2470977
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0057373046875 GB
    Memory Allocated: 0.1326732635498047  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02242255210876465
range selection method range initialization spend 0.01622796058654785
time for parepare:  0.0178682804107666
local_output_nid generation:  0.001649618148803711
local_in_edges_tensor generation:  0.0045757293701171875
mini_batch_src_global generation:  0.0019745826721191406
r_  generation:  0.020880460739135742
local_output_nid generation:  0.0017542839050292969
local_in_edges_tensor generation:  0.001249074935913086
mini_batch_src_global generation:  0.01746535301208496
r_  generation:  0.020044803619384766
local_output_nid generation:  0.0017604827880859375
local_in_edges_tensor generation:  0.0009667873382568359
mini_batch_src_global generation:  0.0014848709106445312
r_  generation:  0.019474029541015625
local_output_nid generation:  0.0017414093017578125
local_in_edges_tensor generation:  0.0014400482177734375
mini_batch_src_global generation:  0.01235651969909668
r_  generation:  0.019002199172973633
local_output_nid generation:  0.0017099380493164062
local_in_edges_tensor generation:  0.0009636878967285156
mini_batch_src_global generation:  0.0015451908111572266
r_  generation:  0.020734548568725586
local_output_nid generation:  0.0017201900482177734
local_in_edges_tensor generation:  0.0011484622955322266
mini_batch_src_global generation:  0.0018985271453857422
r_  generation:  0.021098613739013672
local_output_nid generation:  0.0016908645629882812
local_in_edges_tensor generation:  0.0010116100311279297
mini_batch_src_global generation:  0.0018665790557861328
r_  generation:  0.01969170570373535
local_output_nid generation:  0.0016942024230957031
local_in_edges_tensor generation:  0.0009150505065917969
mini_batch_src_global generation:  0.0016562938690185547
r_  generation:  0.02200174331665039
local_output_nid generation:  0.0016732215881347656
local_in_edges_tensor generation:  0.001071929931640625
mini_batch_src_global generation:  0.001928567886352539
r_  generation:  0.020511150360107422
local_output_nid generation:  0.0017447471618652344
local_in_edges_tensor generation:  0.0009210109710693359
mini_batch_src_global generation:  0.0015587806701660156
r_  generation:  0.02079606056213379
local_output_nid generation:  0.001680135726928711
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.001878499984741211
r_  generation:  0.021296024322509766
local_output_nid generation:  0.0016858577728271484
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.0019114017486572266
r_  generation:  0.02197575569152832
local_output_nid generation:  0.0016956329345703125
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.004442691802978516
r_  generation:  0.019686222076416016
local_output_nid generation:  0.0017459392547607422
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0015377998352050781
r_  generation:  0.021514177322387695
local_output_nid generation:  0.0016889572143554688
local_in_edges_tensor generation:  0.0010802745819091797
mini_batch_src_global generation:  0.002007722854614258
r_  generation:  0.02188706398010254
local_output_nid generation:  0.001699209213256836
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0019502639770507812
r_  generation:  0.02204108238220215
----------------------check_connections_block total spend ----------------------------- 0.5360188484191895
generate_one_block  0.035689592361450195
generate_one_block  0.032475948333740234
generate_one_block  0.031397342681884766
generate_one_block  0.03112506866455078
generate_one_block  0.03171682357788086
generate_one_block  0.03225588798522949
generate_one_block  0.031131267547607422
generate_one_block  0.031914472579956055
generate_one_block  0.031469106674194336
generate_one_block  0.031039953231811523
generate_one_block  0.03069925308227539
generate_one_block  0.03137612342834473
generate_one_block  0.03126025199890137
generate_one_block  0.03135108947753906
generate_one_block  0.031640052795410156
generate_one_block  0.03213906288146973
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029128551483154297
gen group dst list time:  0.0174562931060791
time for parepare:  0.02207350730895996
local_output_nid generation:  0.0072269439697265625
local_in_edges_tensor generation:  0.02159404754638672
mini_batch_src_global generation:  0.02060699462890625
r_  generation:  0.19612479209899902
local_output_nid generation:  0.010593652725219727
local_in_edges_tensor generation:  0.012376546859741211
mini_batch_src_global generation:  0.024944782257080078
r_  generation:  0.2046968936920166
local_output_nid generation:  0.010862350463867188
local_in_edges_tensor generation:  0.01416015625
mini_batch_src_global generation:  0.024816513061523438
r_  generation:  0.20526909828186035
local_output_nid generation:  0.011278152465820312
local_in_edges_tensor generation:  0.014429569244384766
mini_batch_src_global generation:  0.025795936584472656
r_  generation:  0.2075207233428955
local_output_nid generation:  0.011732816696166992
local_in_edges_tensor generation:  0.011871576309204102
mini_batch_src_global generation:  0.025519371032714844
r_  generation:  0.20866990089416504
local_output_nid generation:  0.011884212493896484
local_in_edges_tensor generation:  0.012977123260498047
mini_batch_src_global generation:  0.02858114242553711
r_  generation:  0.20976996421813965
local_output_nid generation:  0.011997461318969727
local_in_edges_tensor generation:  0.01123809814453125
mini_batch_src_global generation:  0.02636098861694336
r_  generation:  0.213883638381958
local_output_nid generation:  0.012772560119628906
local_in_edges_tensor generation:  0.011618852615356445
mini_batch_src_global generation:  0.027064085006713867
r_  generation:  0.22304320335388184
local_output_nid generation:  0.012562990188598633
local_in_edges_tensor generation:  0.015604019165039062
mini_batch_src_global generation:  0.026923656463623047
r_  generation:  0.22431468963623047
local_output_nid generation:  0.01309967041015625
local_in_edges_tensor generation:  0.014183998107910156
mini_batch_src_global generation:  0.02752065658569336
r_  generation:  0.27370405197143555
local_output_nid generation:  0.012985706329345703
local_in_edges_tensor generation:  0.019107580184936523
mini_batch_src_global generation:  0.027995824813842773
r_  generation:  0.2262113094329834
local_output_nid generation:  0.014616250991821289
local_in_edges_tensor generation:  0.014502286911010742
mini_batch_src_global generation:  0.026186704635620117
r_  generation:  0.2120671272277832
local_output_nid generation:  0.012774229049682617
local_in_edges_tensor generation:  0.012097597122192383
mini_batch_src_global generation:  0.026088953018188477
r_  generation:  0.21628332138061523
local_output_nid generation:  0.012988090515136719
local_in_edges_tensor generation:  0.012140035629272461
mini_batch_src_global generation:  0.026511192321777344
r_  generation:  0.21538519859313965
local_output_nid generation:  0.012878179550170898
local_in_edges_tensor generation:  0.011537790298461914
mini_batch_src_global generation:  0.026645660400390625
r_  generation:  0.2158036231994629
local_output_nid generation:  0.01290273666381836
local_in_edges_tensor generation:  0.012368440628051758
mini_batch_src_global generation:  0.02701592445373535
r_  generation:  0.21628427505493164
----------------------check_connections_block total spend ----------------------------- 5.080825567245483
generate_one_block  0.29086756706237793
generate_one_block  0.2869417667388916
generate_one_block  0.2828550338745117
generate_one_block  0.2882955074310303
generate_one_block  0.2881283760070801
generate_one_block  0.28196263313293457
generate_one_block  0.31433939933776855
generate_one_block  0.2968432903289795
generate_one_block  0.29344725608825684
generate_one_block  0.2819943428039551
generate_one_block  0.28289222717285156
generate_one_block  0.28708577156066895
generate_one_block  0.28516173362731934
generate_one_block  0.2890045642852783
generate_one_block  0.2930436134338379
generate_one_block  0.29769110679626465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03384828567504883
gen group dst list time:  0.06919360160827637
time for parepare:  0.01874828338623047
local_output_nid generation:  0.02628493309020996
local_in_edges_tensor generation:  0.050549983978271484
mini_batch_src_global generation:  0.04137063026428223
r_  generation:  0.442598819732666
local_output_nid generation:  0.03079390525817871
local_in_edges_tensor generation:  0.036226749420166016
mini_batch_src_global generation:  0.05400538444519043
r_  generation:  0.4505045413970947
local_output_nid generation:  0.030602455139160156
local_in_edges_tensor generation:  0.02938699722290039
mini_batch_src_global generation:  0.05097031593322754
r_  generation:  0.45673418045043945
local_output_nid generation:  0.030916213989257812
local_in_edges_tensor generation:  0.02873373031616211
mini_batch_src_global generation:  0.052472591400146484
r_  generation:  0.4525599479675293
local_output_nid generation:  0.030627727508544922
local_in_edges_tensor generation:  0.0722956657409668
mini_batch_src_global generation:  0.05121612548828125
r_  generation:  0.4699883460998535
local_output_nid generation:  0.030959129333496094
local_in_edges_tensor generation:  0.030216217041015625
mini_batch_src_global generation:  0.05277132987976074
r_  generation:  0.4595024585723877
local_output_nid generation:  0.030879497528076172
local_in_edges_tensor generation:  0.030780315399169922
mini_batch_src_global generation:  0.051242828369140625
r_  generation:  0.4642775058746338
local_output_nid generation:  0.031543731689453125
local_in_edges_tensor generation:  0.033028364181518555
mini_batch_src_global generation:  0.054769039154052734
r_  generation:  0.46416616439819336
local_output_nid generation:  0.03127717971801758
local_in_edges_tensor generation:  0.02858591079711914
mini_batch_src_global generation:  0.05225849151611328
r_  generation:  0.46224522590637207
local_output_nid generation:  0.03122735023498535
local_in_edges_tensor generation:  0.030719518661499023
mini_batch_src_global generation:  0.05331683158874512
r_  generation:  0.46074867248535156
local_output_nid generation:  0.03242754936218262
local_in_edges_tensor generation:  0.0376887321472168
mini_batch_src_global generation:  0.05169534683227539
r_  generation:  0.4622020721435547
local_output_nid generation:  0.0310971736907959
local_in_edges_tensor generation:  0.03470873832702637
mini_batch_src_global generation:  0.05297541618347168
r_  generation:  0.46260714530944824
local_output_nid generation:  0.03144645690917969
local_in_edges_tensor generation:  0.030504941940307617
mini_batch_src_global generation:  0.0538172721862793
r_  generation:  0.4703991413116455
local_output_nid generation:  0.03360390663146973
local_in_edges_tensor generation:  0.031081438064575195
mini_batch_src_global generation:  0.05520129203796387
r_  generation:  0.4619252681732178
local_output_nid generation:  0.032280921936035156
local_in_edges_tensor generation:  0.02901291847229004
mini_batch_src_global generation:  0.051984310150146484
r_  generation:  0.45993566513061523
local_output_nid generation:  0.0325620174407959
local_in_edges_tensor generation:  0.03030681610107422
mini_batch_src_global generation:  0.05331754684448242
r_  generation:  0.4613349437713623
----------------------check_connections_block total spend ----------------------------- 10.878654479980469
generate_one_block  0.6113171577453613
generate_one_block  0.6037936210632324
generate_one_block  0.5951271057128906
generate_one_block  0.5925331115722656
generate_one_block  0.5927243232727051
generate_one_block  0.597266674041748
generate_one_block  0.5973689556121826
generate_one_block  0.6017594337463379
generate_one_block  0.6661434173583984
generate_one_block  0.5879251956939697
generate_one_block  0.5961833000183105
generate_one_block  0.5987145900726318
generate_one_block  0.5994517803192139
generate_one_block  0.6065926551818848
generate_one_block  0.6064763069152832
generate_one_block  0.6050572395324707
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0057373046875 GB
    Memory Allocated: 0.1326732635498047  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  15.959480047225952
block generation total time  14.298989057540894
average batch blocks generation time:  0.8936868160963058
block dataloader generation time/epoch 32.52207350730896
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0057373046875 GB
    Memory Allocated: 0.11101007461547852  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0057373046875 GB
    Memory Allocated: 21.2458176612854  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0057373046875 GB
    Memory Allocated: 0.11136484146118164  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 21.384695529937744  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.11109638214111328  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 21.08645248413086  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.11119413375854492  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 21.067137241363525  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.11079072952270508  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 21.036154747009277  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.11107778549194336  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 20.840826988220215  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.11088037490844727  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 20.97639513015747  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.11138486862182617  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 21.44284963607788  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.11109638214111328  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 21.29249143600464  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.1110835075378418  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 20.841675758361816  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.11108589172363281  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 21.05646800994873  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.11115312576293945  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 21.011830806732178  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.11101388931274414  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 21.03374481201172  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.11127138137817383  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 21.17570924758911  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2205810546875 GB
    Memory Allocated: 0.1110997200012207  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 21.106905937194824  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11125707626342773  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.193692207336426  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04417400062084198 |0.01149776577949524 |0.30782386660575867 |9.219348430633545e-05 |0.5576919764280319 |0.006644487380981445 |
----------------------------------------------------------pseudo_mini_loss sum 1.5003050565719604
Total (block generation + training)time/epoch 47.39573493003845
Training time/epoch 14.78400468826294
Training time without block to device /epoch 14.600040435791016
Training time without total dataloading part /epoch 13.856373071670532
load block tensor time/epoch 0.7067840099334717
block to device time/epoch 0.18396425247192383
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  5092427
Number of first layer input nodes during this epoch:  2472217
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1348857879638672  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021378755569458008
range selection method range initialization spend 0.020214080810546875
time for parepare:  0.019449234008789062
local_output_nid generation:  0.0016589164733886719
local_in_edges_tensor generation:  0.011886835098266602
mini_batch_src_global generation:  0.003836393356323242
r_  generation:  0.01994800567626953
local_output_nid generation:  0.0021753311157226562
local_in_edges_tensor generation:  0.0017497539520263672
mini_batch_src_global generation:  0.002327442169189453
r_  generation:  0.01944279670715332
local_output_nid generation:  0.002106904983520508
local_in_edges_tensor generation:  0.004666328430175781
mini_batch_src_global generation:  0.0015606880187988281
r_  generation:  0.01801300048828125
local_output_nid generation:  0.0021278858184814453
local_in_edges_tensor generation:  0.0010807514190673828
mini_batch_src_global generation:  0.001573801040649414
r_  generation:  0.01804041862487793
local_output_nid generation:  0.002003908157348633
local_in_edges_tensor generation:  0.0020477771759033203
mini_batch_src_global generation:  0.0015633106231689453
r_  generation:  0.017724275588989258
local_output_nid generation:  0.002030611038208008
local_in_edges_tensor generation:  0.0010256767272949219
mini_batch_src_global generation:  0.001458883285522461
r_  generation:  0.017854928970336914
local_output_nid generation:  0.0019104480743408203
local_in_edges_tensor generation:  0.00142669677734375
mini_batch_src_global generation:  0.0014562606811523438
r_  generation:  0.01837444305419922
local_output_nid generation:  0.0019555091857910156
local_in_edges_tensor generation:  0.0014503002166748047
mini_batch_src_global generation:  0.0015518665313720703
r_  generation:  0.018361806869506836
local_output_nid generation:  0.0019140243530273438
local_in_edges_tensor generation:  0.0011241436004638672
mini_batch_src_global generation:  0.001359701156616211
r_  generation:  0.018348217010498047
local_output_nid generation:  0.0019428730010986328
local_in_edges_tensor generation:  0.0010533332824707031
mini_batch_src_global generation:  0.0015637874603271484
r_  generation:  0.01921844482421875
local_output_nid generation:  0.0019524097442626953
local_in_edges_tensor generation:  0.0011599063873291016
mini_batch_src_global generation:  0.0015840530395507812
r_  generation:  0.018489360809326172
local_output_nid generation:  0.001903533935546875
local_in_edges_tensor generation:  0.0011467933654785156
mini_batch_src_global generation:  0.004462718963623047
r_  generation:  0.02001810073852539
local_output_nid generation:  0.002187490463256836
local_in_edges_tensor generation:  0.0010905265808105469
mini_batch_src_global generation:  0.0015268325805664062
r_  generation:  0.019537687301635742
local_output_nid generation:  0.0018453598022460938
local_in_edges_tensor generation:  0.0009143352508544922
mini_batch_src_global generation:  0.0014908313751220703
r_  generation:  0.018922090530395508
local_output_nid generation:  0.0017137527465820312
local_in_edges_tensor generation:  0.0009183883666992188
mini_batch_src_global generation:  0.0015833377838134766
r_  generation:  0.02062058448791504
local_output_nid generation:  0.0016825199127197266
local_in_edges_tensor generation:  0.0010471343994140625
mini_batch_src_global generation:  0.0018825531005859375
r_  generation:  0.024747610092163086
----------------------check_connections_block total spend ----------------------------- 0.507023811340332
generate_one_block  0.03794741630554199
generate_one_block  0.041929006576538086
generate_one_block  0.05641674995422363
generate_one_block  0.03632855415344238
generate_one_block  0.04853200912475586
generate_one_block  0.04227304458618164
generate_one_block  0.04344654083251953
generate_one_block  0.03400540351867676
generate_one_block  0.03236675262451172
generate_one_block  0.03533768653869629
generate_one_block  0.03808093070983887
generate_one_block  0.05061912536621094
generate_one_block  0.0347135066986084
generate_one_block  0.03353595733642578
generate_one_block  0.04825901985168457
generate_one_block  0.040845632553100586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03937554359436035
gen group dst list time:  0.021777629852294922
time for parepare:  0.02193927764892578
local_output_nid generation:  0.008495569229125977
local_in_edges_tensor generation:  0.022241830825805664
mini_batch_src_global generation:  0.021294593811035156
r_  generation:  0.19748759269714355
local_output_nid generation:  0.018716812133789062
local_in_edges_tensor generation:  0.01872563362121582
mini_batch_src_global generation:  0.027196407318115234
r_  generation:  0.2106764316558838
local_output_nid generation:  0.013356447219848633
local_in_edges_tensor generation:  0.013989686965942383
mini_batch_src_global generation:  0.026230812072753906
r_  generation:  0.2172713279724121
local_output_nid generation:  0.013902664184570312
local_in_edges_tensor generation:  0.012777328491210938
mini_batch_src_global generation:  0.02800917625427246
r_  generation:  0.2221083641052246
local_output_nid generation:  0.014284849166870117
local_in_edges_tensor generation:  0.012315988540649414
mini_batch_src_global generation:  0.02777409553527832
r_  generation:  0.22350406646728516
local_output_nid generation:  0.014117956161499023
local_in_edges_tensor generation:  0.012334585189819336
mini_batch_src_global generation:  0.02873086929321289
r_  generation:  0.22292423248291016
local_output_nid generation:  0.014387130737304688
local_in_edges_tensor generation:  0.012208700180053711
mini_batch_src_global generation:  0.028641939163208008
r_  generation:  0.23085904121398926
local_output_nid generation:  0.01626300811767578
local_in_edges_tensor generation:  0.01281285285949707
mini_batch_src_global generation:  0.028975963592529297
r_  generation:  0.2316126823425293
local_output_nid generation:  0.014544010162353516
local_in_edges_tensor generation:  0.014328241348266602
mini_batch_src_global generation:  0.030411720275878906
r_  generation:  0.23543643951416016
local_output_nid generation:  0.014940023422241211
local_in_edges_tensor generation:  0.013647079467773438
mini_batch_src_global generation:  0.03024601936340332
r_  generation:  0.23583102226257324
local_output_nid generation:  0.01424717903137207
local_in_edges_tensor generation:  0.012543916702270508
mini_batch_src_global generation:  0.030882596969604492
r_  generation:  0.23458385467529297
local_output_nid generation:  0.01419830322265625
local_in_edges_tensor generation:  0.02047419548034668
mini_batch_src_global generation:  0.029008865356445312
r_  generation:  0.22771310806274414
local_output_nid generation:  0.01733231544494629
local_in_edges_tensor generation:  0.016122817993164062
mini_batch_src_global generation:  0.029453277587890625
r_  generation:  0.23754239082336426
local_output_nid generation:  0.01467752456665039
local_in_edges_tensor generation:  0.014393091201782227
mini_batch_src_global generation:  0.029880046844482422
r_  generation:  0.24030327796936035
local_output_nid generation:  0.020710468292236328
local_in_edges_tensor generation:  0.014909744262695312
mini_batch_src_global generation:  0.03073596954345703
r_  generation:  0.21516680717468262
local_output_nid generation:  0.012704133987426758
local_in_edges_tensor generation:  0.012579917907714844
mini_batch_src_global generation:  0.026920318603515625
r_  generation:  0.21439528465270996
----------------------check_connections_block total spend ----------------------------- 5.360454797744751
generate_one_block  0.2942495346069336
generate_one_block  0.27553462982177734
generate_one_block  0.2838931083679199
generate_one_block  0.28728413581848145
generate_one_block  0.2783989906311035
generate_one_block  0.28152966499328613
generate_one_block  0.3097248077392578
generate_one_block  0.28180742263793945
generate_one_block  0.28537893295288086
generate_one_block  0.29340171813964844
generate_one_block  0.2957627773284912
generate_one_block  0.2780275344848633
generate_one_block  0.28835582733154297
generate_one_block  0.27995967864990234
generate_one_block  0.2857084274291992
generate_one_block  0.2852449417114258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03315401077270508
gen group dst list time:  0.06489992141723633
time for parepare:  0.01854419708251953
local_output_nid generation:  0.02845287322998047
local_in_edges_tensor generation:  0.047804832458496094
mini_batch_src_global generation:  0.04180550575256348
r_  generation:  0.44931650161743164
local_output_nid generation:  0.030472755432128906
local_in_edges_tensor generation:  0.038941383361816406
mini_batch_src_global generation:  0.0521085262298584
r_  generation:  0.46895837783813477
local_output_nid generation:  0.033965110778808594
local_in_edges_tensor generation:  0.032538414001464844
mini_batch_src_global generation:  0.05510568618774414
r_  generation:  0.45347023010253906
local_output_nid generation:  0.031476736068725586
local_in_edges_tensor generation:  0.030307769775390625
mini_batch_src_global generation:  0.05224037170410156
r_  generation:  0.4500465393066406
local_output_nid generation:  0.0322728157043457
local_in_edges_tensor generation:  0.0812375545501709
mini_batch_src_global generation:  0.051076650619506836
r_  generation:  0.4569709300994873
local_output_nid generation:  0.03100728988647461
local_in_edges_tensor generation:  0.03063344955444336
mini_batch_src_global generation:  0.05304098129272461
r_  generation:  0.4546830654144287
local_output_nid generation:  0.030975818634033203
local_in_edges_tensor generation:  0.030642986297607422
mini_batch_src_global generation:  0.05172157287597656
r_  generation:  0.46761274337768555
local_output_nid generation:  0.03131222724914551
local_in_edges_tensor generation:  0.03093719482421875
mini_batch_src_global generation:  0.05264472961425781
r_  generation:  0.45294785499572754
local_output_nid generation:  0.031258583068847656
local_in_edges_tensor generation:  0.031215429306030273
mini_batch_src_global generation:  0.05204486846923828
r_  generation:  0.46283411979675293
local_output_nid generation:  0.034812211990356445
local_in_edges_tensor generation:  0.030863523483276367
mini_batch_src_global generation:  0.05336594581604004
r_  generation:  0.46024036407470703
local_output_nid generation:  0.0320436954498291
local_in_edges_tensor generation:  0.03539252281188965
mini_batch_src_global generation:  0.051747798919677734
r_  generation:  0.4612922668457031
local_output_nid generation:  0.03159356117248535
local_in_edges_tensor generation:  0.03249049186706543
mini_batch_src_global generation:  0.053121328353881836
r_  generation:  0.45545339584350586
local_output_nid generation:  0.03305935859680176
local_in_edges_tensor generation:  0.032563209533691406
mini_batch_src_global generation:  0.05225110054016113
r_  generation:  0.4614827632904053
local_output_nid generation:  0.031256914138793945
local_in_edges_tensor generation:  0.02859663963317871
mini_batch_src_global generation:  0.05613422393798828
r_  generation:  0.45267534255981445
local_output_nid generation:  0.03140068054199219
local_in_edges_tensor generation:  0.032993316650390625
mini_batch_src_global generation:  0.05376243591308594
r_  generation:  0.47649240493774414
local_output_nid generation:  0.03596854209899902
local_in_edges_tensor generation:  0.028807640075683594
mini_batch_src_global generation:  0.05372810363769531
r_  generation:  0.45663928985595703
----------------------check_connections_block total spend ----------------------------- 10.880130290985107
generate_one_block  0.6099193096160889
generate_one_block  0.5964634418487549
generate_one_block  0.5957605838775635
generate_one_block  0.6038062572479248
generate_one_block  0.6012082099914551
generate_one_block  0.6130690574645996
generate_one_block  0.6012380123138428
generate_one_block  0.5994584560394287
generate_one_block  0.6329002380371094
generate_one_block  0.6022951602935791
generate_one_block  0.5986752510070801
generate_one_block  0.5939252376556396
generate_one_block  0.6102762222290039
generate_one_block  0.5933613777160645
generate_one_block  0.5977687835693359
generate_one_block  0.6129367351531982
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1348857879638672  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  16.24058508872986
block generation total time  14.247324466705322
average batch blocks generation time:  0.8904577791690826
block dataloader generation time/epoch 32.58514026800791
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11101198196411133  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.092101573944092  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11111974716186523  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.9554705619812  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1109471321105957  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.189175128936768  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11132574081420898  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.299741744995117  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11093521118164062  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.03873634338379  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112065315246582  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.117801189422607  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11113786697387695  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.19558811187744  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112055778503418  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.08711290359497  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11097240447998047  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.266222953796387  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11140871047973633  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.476317882537842  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11061477661132812  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.95902109146118  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11110353469848633  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.914226055145264  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11107778549194336  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.243488788604736  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11102437973022461  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.783386707305908  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1109166145324707  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.053345680236816  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1111750602722168  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.009950637817383  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.042001932859420776 |0.014090552926063538 |0.30579449236392975 |9.347498416900635e-05 |0.5593601018190384 |0.005774259567260742 |
----------------------------------------------------------pseudo_mini_loss sum 1.4596049785614014
Total (block generation + training)time/epoch 47.44390785694122
Training time/epoch 14.784047603607178
Training time without block to device /epoch 14.558598756790161
Training time without total dataloading part /epoch 13.849743366241455
load block tensor time/epoch 0.6720309257507324
block to device time/epoch 0.2254488468170166
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  5090121
Number of first layer input nodes during this epoch:  2470985
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1342310905456543  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02466559410095215
range selection method range initialization spend 0.013818502426147461
time for parepare:  0.021695375442504883
local_output_nid generation:  0.0020194053649902344
local_in_edges_tensor generation:  0.0054891109466552734
mini_batch_src_global generation:  0.0023751258850097656
r_  generation:  0.018319129943847656
local_output_nid generation:  0.001729726791381836
local_in_edges_tensor generation:  0.0014424324035644531
mini_batch_src_global generation:  0.0023276805877685547
r_  generation:  0.019390106201171875
local_output_nid generation:  0.001814126968383789
local_in_edges_tensor generation:  0.00139617919921875
mini_batch_src_global generation:  0.0014972686767578125
r_  generation:  0.017844676971435547
local_output_nid generation:  0.0018377304077148438
local_in_edges_tensor generation:  0.0010497570037841797
mini_batch_src_global generation:  0.001547098159790039
r_  generation:  0.01790165901184082
local_output_nid generation:  0.0018358230590820312
local_in_edges_tensor generation:  0.0013837814331054688
mini_batch_src_global generation:  0.0015420913696289062
r_  generation:  0.017534494400024414
local_output_nid generation:  0.0018134117126464844
local_in_edges_tensor generation:  0.0011959075927734375
mini_batch_src_global generation:  0.0014002323150634766
r_  generation:  0.01814103126525879
local_output_nid generation:  0.0018358230590820312
local_in_edges_tensor generation:  0.001062631607055664
mini_batch_src_global generation:  0.0015437602996826172
r_  generation:  0.018372297286987305
local_output_nid generation:  0.0018067359924316406
local_in_edges_tensor generation:  0.001039743423461914
mini_batch_src_global generation:  0.0014774799346923828
r_  generation:  0.0181887149810791
local_output_nid generation:  0.0018498897552490234
local_in_edges_tensor generation:  0.0011515617370605469
mini_batch_src_global generation:  0.0015780925750732422
r_  generation:  0.018556833267211914
local_output_nid generation:  0.0018515586853027344
local_in_edges_tensor generation:  0.0013396739959716797
mini_batch_src_global generation:  0.001577615737915039
r_  generation:  0.019190073013305664
local_output_nid generation:  0.001880645751953125
local_in_edges_tensor generation:  0.0010826587677001953
mini_batch_src_global generation:  0.0014843940734863281
r_  generation:  0.018694639205932617
local_output_nid generation:  0.0018742084503173828
local_in_edges_tensor generation:  0.0010669231414794922
mini_batch_src_global generation:  0.001554727554321289
r_  generation:  0.01911473274230957
local_output_nid generation:  0.0018305778503417969
local_in_edges_tensor generation:  0.0011594295501708984
mini_batch_src_global generation:  0.0015821456909179688
r_  generation:  0.019194602966308594
local_output_nid generation:  0.0018949508666992188
local_in_edges_tensor generation:  0.0010607242584228516
mini_batch_src_global generation:  0.0015554428100585938
r_  generation:  0.018653154373168945
local_output_nid generation:  0.0018358230590820312
local_in_edges_tensor generation:  0.0011060237884521484
mini_batch_src_global generation:  0.0014088153839111328
r_  generation:  0.018764495849609375
local_output_nid generation:  0.0018553733825683594
local_in_edges_tensor generation:  0.001033782958984375
mini_batch_src_global generation:  0.0015571117401123047
r_  generation:  0.01843738555908203
----------------------check_connections_block total spend ----------------------------- 0.4706730842590332
generate_one_block  0.03995943069458008
generate_one_block  0.03486490249633789
generate_one_block  0.03819870948791504
generate_one_block  0.043807029724121094
generate_one_block  0.03135085105895996
generate_one_block  0.034928083419799805
generate_one_block  0.03377270698547363
generate_one_block  0.03352761268615723
generate_one_block  0.05456995964050293
generate_one_block  0.03483271598815918
generate_one_block  0.03093743324279785
generate_one_block  0.031430721282958984
generate_one_block  0.031972408294677734
generate_one_block  0.031194210052490234
generate_one_block  0.032852888107299805
generate_one_block  0.035086870193481445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033556461334228516
gen group dst list time:  0.016835689544677734
time for parepare:  0.021706581115722656
local_output_nid generation:  0.007287502288818359
local_in_edges_tensor generation:  0.01903700828552246
mini_batch_src_global generation:  0.020446062088012695
r_  generation:  0.19377589225769043
local_output_nid generation:  0.010582685470581055
local_in_edges_tensor generation:  0.014497518539428711
mini_batch_src_global generation:  0.02418065071105957
r_  generation:  0.20288538932800293
local_output_nid generation:  0.010821819305419922
local_in_edges_tensor generation:  0.010722637176513672
mini_batch_src_global generation:  0.025411367416381836
r_  generation:  0.20812439918518066
local_output_nid generation:  0.011254072189331055
local_in_edges_tensor generation:  0.01251220703125
mini_batch_src_global generation:  0.024485111236572266
r_  generation:  0.24305224418640137
local_output_nid generation:  0.011905431747436523
local_in_edges_tensor generation:  0.016631126403808594
mini_batch_src_global generation:  0.026132583618164062
r_  generation:  0.20998859405517578
local_output_nid generation:  0.011952877044677734
local_in_edges_tensor generation:  0.016392946243286133
mini_batch_src_global generation:  0.026844024658203125
r_  generation:  0.2179563045501709
local_output_nid generation:  0.012349128723144531
local_in_edges_tensor generation:  0.014236927032470703
mini_batch_src_global generation:  0.03819990158081055
r_  generation:  0.244964599609375
local_output_nid generation:  0.015286684036254883
local_in_edges_tensor generation:  0.013885498046875
mini_batch_src_global generation:  0.04397869110107422
r_  generation:  0.21167707443237305
local_output_nid generation:  0.01422429084777832
local_in_edges_tensor generation:  0.012313365936279297
mini_batch_src_global generation:  0.02737259864807129
r_  generation:  0.21562719345092773
local_output_nid generation:  0.013253927230834961
local_in_edges_tensor generation:  0.014623403549194336
mini_batch_src_global generation:  0.026778459548950195
r_  generation:  0.21320557594299316
local_output_nid generation:  0.012684106826782227
local_in_edges_tensor generation:  0.011572122573852539
mini_batch_src_global generation:  0.027181386947631836
r_  generation:  0.21167993545532227
local_output_nid generation:  0.01300811767578125
local_in_edges_tensor generation:  0.011459589004516602
mini_batch_src_global generation:  0.027274370193481445
r_  generation:  0.214158296585083
local_output_nid generation:  0.013051271438598633
local_in_edges_tensor generation:  0.01363515853881836
mini_batch_src_global generation:  0.026659011840820312
r_  generation:  0.25986623764038086
local_output_nid generation:  0.012871742248535156
local_in_edges_tensor generation:  0.011749029159545898
mini_batch_src_global generation:  0.027376651763916016
r_  generation:  0.2110271453857422
local_output_nid generation:  0.012896060943603516
local_in_edges_tensor generation:  0.011727571487426758
mini_batch_src_global generation:  0.02626347541809082
r_  generation:  0.21266388893127441
local_output_nid generation:  0.012754440307617188
local_in_edges_tensor generation:  0.01145029067993164
mini_batch_src_global generation:  0.026568174362182617
r_  generation:  0.22562551498413086
----------------------check_connections_block total spend ----------------------------- 5.1444172859191895
generate_one_block  0.3040292263031006
generate_one_block  0.28925657272338867
generate_one_block  0.29010581970214844
generate_one_block  0.29967617988586426
generate_one_block  0.2873711585998535
generate_one_block  0.2816910743713379
generate_one_block  0.3096034526824951
generate_one_block  0.27635765075683594
generate_one_block  0.2885932922363281
generate_one_block  0.2838931083679199
generate_one_block  0.27698469161987305
generate_one_block  0.28310680389404297
generate_one_block  0.2897067070007324
generate_one_block  0.28093910217285156
generate_one_block  0.2840089797973633
generate_one_block  0.2790102958679199
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03338813781738281
gen group dst list time:  0.06133604049682617
time for parepare:  0.020111083984375
local_output_nid generation:  0.02566671371459961
local_in_edges_tensor generation:  0.04738926887512207
mini_batch_src_global generation:  0.041449546813964844
r_  generation:  0.4468846321105957
local_output_nid generation:  0.030606985092163086
local_in_edges_tensor generation:  0.03609299659729004
mini_batch_src_global generation:  0.05208897590637207
r_  generation:  0.44866466522216797
local_output_nid generation:  0.030628681182861328
local_in_edges_tensor generation:  0.030390024185180664
mini_batch_src_global generation:  0.050966501235961914
r_  generation:  0.47052574157714844
local_output_nid generation:  0.03032517433166504
local_in_edges_tensor generation:  0.029691696166992188
mini_batch_src_global generation:  0.054435014724731445
r_  generation:  0.4569270610809326
local_output_nid generation:  0.031575918197631836
local_in_edges_tensor generation:  0.07559633255004883
mini_batch_src_global generation:  0.05125880241394043
r_  generation:  0.4639108180999756
local_output_nid generation:  0.030834197998046875
local_in_edges_tensor generation:  0.03245878219604492
mini_batch_src_global generation:  0.05344581604003906
r_  generation:  0.4627499580383301
local_output_nid generation:  0.03077387809753418
local_in_edges_tensor generation:  0.04007601737976074
mini_batch_src_global generation:  0.05340981483459473
r_  generation:  0.4835348129272461
local_output_nid generation:  0.03360867500305176
local_in_edges_tensor generation:  0.032713890075683594
mini_batch_src_global generation:  0.053418874740600586
r_  generation:  0.4540369510650635
local_output_nid generation:  0.03176140785217285
local_in_edges_tensor generation:  0.03043818473815918
mini_batch_src_global generation:  0.05187678337097168
r_  generation:  0.4580094814300537
local_output_nid generation:  0.032251834869384766
local_in_edges_tensor generation:  0.032132863998413086
mini_batch_src_global generation:  0.05315041542053223
r_  generation:  0.4601104259490967
local_output_nid generation:  0.03184771537780762
local_in_edges_tensor generation:  0.028190135955810547
mini_batch_src_global generation:  0.051666259765625
r_  generation:  0.47399425506591797
local_output_nid generation:  0.031571149826049805
local_in_edges_tensor generation:  0.03088831901550293
mini_batch_src_global generation:  0.0528256893157959
r_  generation:  0.459580659866333
local_output_nid generation:  0.031623125076293945
local_in_edges_tensor generation:  0.03141045570373535
mini_batch_src_global generation:  0.056514739990234375
r_  generation:  0.46195411682128906
local_output_nid generation:  0.03169727325439453
local_in_edges_tensor generation:  0.03057861328125
mini_batch_src_global generation:  0.052614688873291016
r_  generation:  0.4557785987854004
local_output_nid generation:  0.03170514106750488
local_in_edges_tensor generation:  0.029268264770507812
mini_batch_src_global generation:  0.05214881896972656
r_  generation:  0.4621562957763672
local_output_nid generation:  0.03205537796020508
local_in_edges_tensor generation:  0.02830791473388672
mini_batch_src_global generation:  0.052686452865600586
r_  generation:  0.45589685440063477
----------------------check_connections_block total spend ----------------------------- 10.878834962844849
generate_one_block  0.6156420707702637
generate_one_block  0.606112003326416
generate_one_block  0.5996885299682617
generate_one_block  0.6039888858795166
generate_one_block  0.6031746864318848
generate_one_block  0.6038060188293457
generate_one_block  0.6056528091430664
generate_one_block  0.5925579071044922
generate_one_block  0.6713240146636963
generate_one_block  0.5961101055145264
generate_one_block  0.5994391441345215
generate_one_block  0.5984635353088379
generate_one_block  0.6019482612609863
generate_one_block  0.6142044067382812
generate_one_block  0.5959343910217285
generate_one_block  0.5968022346496582
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1342310905456543  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  16.023252248764038
block generation total time  14.309183120727539
average batch blocks generation time:  0.8943239450454712
block dataloader generation time/epoch 32.589631012507844
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11102724075317383  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.18160057067871  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11120176315307617  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.08635377883911  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11084318161010742  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.146604537963867  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11128091812133789  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.210622310638428  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11086416244506836  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.80155849456787  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11122846603393555  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.127644062042236  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11087656021118164  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.085161685943604  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11115026473999023  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.95641326904297  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11107921600341797  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.266021728515625  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11124181747436523  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.178688526153564  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1109781265258789  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.05405330657959  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112523078918457  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.2285795211792  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11108589172363281  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.347256660461426  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11117219924926758  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.017966747283936  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11096525192260742  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.02382516860962  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11114263534545898  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.934025764465332  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.042047008872032166 |0.012388050556182861 |0.30563847720623016 |9.202957153320312e-05 |0.5585758835077286 |0.00569462776184082 |
----------------------------------------------------------pseudo_mini_loss sum 1.4412477016448975
Total (block generation + training)time/epoch 47.4439868586404
Training time/epoch 14.827638864517212
Training time without block to device /epoch 14.629430055618286
Training time without total dataloading part /epoch 13.834596872329712
load block tensor time/epoch 0.6727521419525146
block to device time/epoch 0.19820880889892578
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  5089132
Number of first layer input nodes during this epoch:  2470388
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.13465309143066406  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022432327270507812
range selection method range initialization spend 0.016056537628173828
time for parepare:  0.017843008041381836
local_output_nid generation:  0.0016651153564453125
local_in_edges_tensor generation:  0.013171195983886719
mini_batch_src_global generation:  0.004193544387817383
r_  generation:  0.020155906677246094
local_output_nid generation:  0.0022423267364501953
local_in_edges_tensor generation:  0.0015642642974853516
mini_batch_src_global generation:  0.002172708511352539
r_  generation:  0.020707368850708008
local_output_nid generation:  0.0021352767944335938
local_in_edges_tensor generation:  0.0014789104461669922
mini_batch_src_global generation:  0.0016274452209472656
r_  generation:  0.018428802490234375
local_output_nid generation:  0.002089977264404297
local_in_edges_tensor generation:  0.0017042160034179688
mini_batch_src_global generation:  0.0149688720703125
r_  generation:  0.024117469787597656
local_output_nid generation:  0.0023894309997558594
local_in_edges_tensor generation:  0.001226186752319336
mini_batch_src_global generation:  0.003008604049682617
r_  generation:  0.031273603439331055
local_output_nid generation:  0.0020215511322021484
local_in_edges_tensor generation:  0.001068115234375
mini_batch_src_global generation:  0.009856224060058594
r_  generation:  0.018784523010253906
local_output_nid generation:  0.0019040107727050781
local_in_edges_tensor generation:  0.001399993896484375
mini_batch_src_global generation:  0.0015614032745361328
r_  generation:  0.0183868408203125
local_output_nid generation:  0.0018982887268066406
local_in_edges_tensor generation:  0.0013799667358398438
mini_batch_src_global generation:  0.0014908313751220703
r_  generation:  0.01827716827392578
local_output_nid generation:  0.0019373893737792969
local_in_edges_tensor generation:  0.0011048316955566406
mini_batch_src_global generation:  0.001478433609008789
r_  generation:  0.018270015716552734
local_output_nid generation:  0.001917123794555664
local_in_edges_tensor generation:  0.001013040542602539
mini_batch_src_global generation:  0.0013835430145263672
r_  generation:  0.018294334411621094
local_output_nid generation:  0.0019044876098632812
local_in_edges_tensor generation:  0.0010304450988769531
mini_batch_src_global generation:  0.0015904903411865234
r_  generation:  0.01862025260925293
local_output_nid generation:  0.0018913745880126953
local_in_edges_tensor generation:  0.0010199546813964844
mini_batch_src_global generation:  0.0015387535095214844
r_  generation:  0.018573760986328125
local_output_nid generation:  0.001898050308227539
local_in_edges_tensor generation:  0.0010344982147216797
mini_batch_src_global generation:  0.0014505386352539062
r_  generation:  0.018465042114257812
local_output_nid generation:  0.0019295215606689453
local_in_edges_tensor generation:  0.0010197162628173828
mini_batch_src_global generation:  0.0014376640319824219
r_  generation:  0.018899917602539062
local_output_nid generation:  0.003838062286376953
local_in_edges_tensor generation:  0.0019092559814453125
mini_batch_src_global generation:  0.017887592315673828
r_  generation:  0.023018360137939453
local_output_nid generation:  0.0017886161804199219
local_in_edges_tensor generation:  0.000949859619140625
mini_batch_src_global generation:  0.0019631385803222656
r_  generation:  0.0217893123626709
----------------------check_connections_block total spend ----------------------------- 0.5836498737335205
generate_one_block  0.03284931182861328
generate_one_block  0.031778812408447266
generate_one_block  0.03074026107788086
generate_one_block  0.03200387954711914
generate_one_block  0.03172469139099121
generate_one_block  0.03349590301513672
generate_one_block  0.031194448471069336
generate_one_block  0.03116631507873535
generate_one_block  0.03134012222290039
generate_one_block  0.030905485153198242
generate_one_block  0.03128457069396973
generate_one_block  0.030836820602416992
generate_one_block  0.03071880340576172
generate_one_block  0.03134417533874512
generate_one_block  0.030907630920410156
generate_one_block  0.031678199768066406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03226113319396973
gen group dst list time:  0.015850543975830078
time for parepare:  0.0193936824798584
local_output_nid generation:  0.0073964595794677734
local_in_edges_tensor generation:  0.021886348724365234
mini_batch_src_global generation:  0.020798206329345703
r_  generation:  0.1951277256011963
local_output_nid generation:  0.01052999496459961
local_in_edges_tensor generation:  0.01405191421508789
mini_batch_src_global generation:  0.025362491607666016
r_  generation:  0.23595690727233887
local_output_nid generation:  0.01154470443725586
local_in_edges_tensor generation:  0.014296531677246094
mini_batch_src_global generation:  0.02494668960571289
r_  generation:  0.20167875289916992
local_output_nid generation:  0.011832714080810547
local_in_edges_tensor generation:  0.011368274688720703
mini_batch_src_global generation:  0.02562117576599121
r_  generation:  0.20968985557556152
local_output_nid generation:  0.012012481689453125
local_in_edges_tensor generation:  0.012983083724975586
mini_batch_src_global generation:  0.025906085968017578
r_  generation:  0.21372723579406738
local_output_nid generation:  0.011531829833984375
local_in_edges_tensor generation:  0.014119386672973633
mini_batch_src_global generation:  0.026165008544921875
r_  generation:  0.211287260055542
local_output_nid generation:  0.012074470520019531
local_in_edges_tensor generation:  0.01137852668762207
mini_batch_src_global generation:  0.026396989822387695
r_  generation:  0.20902776718139648
local_output_nid generation:  0.012161016464233398
local_in_edges_tensor generation:  0.011517763137817383
mini_batch_src_global generation:  0.025913000106811523
r_  generation:  0.21111059188842773
local_output_nid generation:  0.012168169021606445
local_in_edges_tensor generation:  0.012273550033569336
mini_batch_src_global generation:  0.03371381759643555
r_  generation:  0.21815824508666992
local_output_nid generation:  0.013727188110351562
local_in_edges_tensor generation:  0.012638092041015625
mini_batch_src_global generation:  0.026445865631103516
r_  generation:  0.21389055252075195
local_output_nid generation:  0.012375593185424805
local_in_edges_tensor generation:  0.011484384536743164
mini_batch_src_global generation:  0.026598453521728516
r_  generation:  0.21413159370422363
local_output_nid generation:  0.012517213821411133
local_in_edges_tensor generation:  0.011593103408813477
mini_batch_src_global generation:  0.02657151222229004
r_  generation:  0.21160125732421875
local_output_nid generation:  0.012682199478149414
local_in_edges_tensor generation:  0.011447429656982422
mini_batch_src_global generation:  0.026767969131469727
r_  generation:  0.21222686767578125
local_output_nid generation:  0.0129241943359375
local_in_edges_tensor generation:  0.012389421463012695
mini_batch_src_global generation:  0.027685880661010742
r_  generation:  0.21677422523498535
local_output_nid generation:  0.012631416320800781
local_in_edges_tensor generation:  0.011549234390258789
mini_batch_src_global generation:  0.026820898056030273
r_  generation:  0.2107982635498047
local_output_nid generation:  0.012679576873779297
local_in_edges_tensor generation:  0.011524200439453125
mini_batch_src_global generation:  0.026805400848388672
r_  generation:  0.2143115997314453
----------------------check_connections_block total spend ----------------------------- 4.983578443527222
generate_one_block  0.2830803394317627
generate_one_block  0.2792642116546631
generate_one_block  0.2767813205718994
generate_one_block  0.2882506847381592
generate_one_block  0.2866225242614746
generate_one_block  0.28241801261901855
generate_one_block  0.3019113540649414
generate_one_block  0.2761080265045166
generate_one_block  0.28280043601989746
generate_one_block  0.2833061218261719
generate_one_block  0.2843160629272461
generate_one_block  0.2776913642883301
generate_one_block  0.27875542640686035
generate_one_block  0.28824663162231445
generate_one_block  0.2754356861114502
generate_one_block  0.2849693298339844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029870033264160156
gen group dst list time:  0.06250905990600586
time for parepare:  0.01891040802001953
local_output_nid generation:  0.0253448486328125
local_in_edges_tensor generation:  0.04739046096801758
mini_batch_src_global generation:  0.04120206832885742
r_  generation:  0.4487740993499756
local_output_nid generation:  0.030180931091308594
local_in_edges_tensor generation:  0.03535270690917969
mini_batch_src_global generation:  0.05187034606933594
r_  generation:  0.44679999351501465
local_output_nid generation:  0.030049562454223633
local_in_edges_tensor generation:  0.03019094467163086
mini_batch_src_global generation:  0.05074262619018555
r_  generation:  0.4551389217376709
local_output_nid generation:  0.030591249465942383
local_in_edges_tensor generation:  0.030553102493286133
mini_batch_src_global generation:  0.052999258041381836
r_  generation:  0.4592468738555908
local_output_nid generation:  0.030659198760986328
local_in_edges_tensor generation:  0.08036947250366211
mini_batch_src_global generation:  0.05305600166320801
r_  generation:  0.47012758255004883
local_output_nid generation:  0.031072139739990234
local_in_edges_tensor generation:  0.029117584228515625
mini_batch_src_global generation:  0.05295109748840332
r_  generation:  0.46399497985839844
local_output_nid generation:  0.031891822814941406
local_in_edges_tensor generation:  0.03530716896057129
mini_batch_src_global generation:  0.05322122573852539
r_  generation:  0.47808337211608887
local_output_nid generation:  0.03438138961791992
local_in_edges_tensor generation:  0.03246450424194336
mini_batch_src_global generation:  0.05532646179199219
r_  generation:  0.4500880241394043
local_output_nid generation:  0.03169107437133789
local_in_edges_tensor generation:  0.02874588966369629
mini_batch_src_global generation:  0.05155301094055176
r_  generation:  0.4606740474700928
local_output_nid generation:  0.032171010971069336
local_in_edges_tensor generation:  0.03017282485961914
mini_batch_src_global generation:  0.05537056922912598
r_  generation:  0.45633482933044434
local_output_nid generation:  0.03157544136047363
local_in_edges_tensor generation:  0.02840280532836914
mini_batch_src_global generation:  0.05176281929016113
r_  generation:  0.4629206657409668
local_output_nid generation:  0.03178977966308594
local_in_edges_tensor generation:  0.030087947845458984
mini_batch_src_global generation:  0.05292463302612305
r_  generation:  0.4676182270050049
local_output_nid generation:  0.031789302825927734
local_in_edges_tensor generation:  0.03074789047241211
mini_batch_src_global generation:  0.05465555191040039
r_  generation:  0.46428561210632324
local_output_nid generation:  0.03214383125305176
local_in_edges_tensor generation:  0.03231072425842285
mini_batch_src_global generation:  0.053453683853149414
r_  generation:  0.4625363349914551
local_output_nid generation:  0.03234672546386719
local_in_edges_tensor generation:  0.03398489952087402
mini_batch_src_global generation:  0.0510563850402832
r_  generation:  0.4645817279815674
local_output_nid generation:  0.032263994216918945
local_in_edges_tensor generation:  0.030122756958007812
mini_batch_src_global generation:  0.05323910713195801
r_  generation:  0.45662903785705566
----------------------check_connections_block total spend ----------------------------- 10.883329153060913
generate_one_block  0.6131412982940674
generate_one_block  0.611391544342041
generate_one_block  0.6058609485626221
generate_one_block  0.6206181049346924
generate_one_block  0.6070139408111572
generate_one_block  0.601243257522583
generate_one_block  0.5972959995269775
generate_one_block  0.5967011451721191
generate_one_block  0.6369202136993408
generate_one_block  0.6052858829498291
generate_one_block  0.6082601547241211
generate_one_block  0.6054213047027588
generate_one_block  0.6168525218963623
generate_one_block  0.6019704341888428
generate_one_block  0.6000955104827881
generate_one_block  0.6006865501403809
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.13465309143066406  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  15.866907596588135
block generation total time  14.258716344833374
average batch blocks generation time:  0.8911697715520859
block dataloader generation time/epoch 32.568699419498444
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11116456985473633  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.298712730407715  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11121225357055664  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.06214427947998  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11103439331054688  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.019012451171875  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1113734245300293  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.372164726257324  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11125040054321289  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.39585542678833  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11129903793334961  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.239866256713867  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11096954345703125  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.035749912261963  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11115503311157227  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.01507329940796  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11082983016967773  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.130733013153076  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11124467849731445  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.17216396331787  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11080169677734375  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.16540288925171  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11117219924926758  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.01712417602539  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11109733581542969  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.085694313049316  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11130475997924805  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.28631019592285  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11099529266357422  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.930480480194092  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11124181747436523  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.15515899658203  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04315803945064545 |0.012297406792640686 |0.3056469261646271 |9.02712345123291e-05 |0.5580987334251404 |0.003912687301635742 |
----------------------------------------------------------pseudo_mini_loss sum 1.4092514514923096
Total (block generation + training)time/epoch 47.410219103097916
Training time/epoch 14.751423835754395
Training time without block to device /epoch 14.554665327072144
Training time without total dataloading part /epoch 13.825287580490112
load block tensor time/epoch 0.6905286312103271
block to device time/epoch 0.19675850868225098
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  5095501
Number of first layer input nodes during this epoch:  2472449
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1338362693786621  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02123117446899414
range selection method range initialization spend 0.015839815139770508
time for parepare:  0.016494035720825195
local_output_nid generation:  0.0016841888427734375
local_in_edges_tensor generation:  0.012342691421508789
mini_batch_src_global generation:  0.004246711730957031
r_  generation:  0.021078824996948242
local_output_nid generation:  0.002247333526611328
local_in_edges_tensor generation:  0.0019769668579101562
mini_batch_src_global generation:  0.003446340560913086
r_  generation:  0.020323753356933594
local_output_nid generation:  0.002174854278564453
local_in_edges_tensor generation:  0.001821279525756836
mini_batch_src_global generation:  0.002920866012573242
r_  generation:  0.018148183822631836
local_output_nid generation:  0.0021820068359375
local_in_edges_tensor generation:  0.001337289810180664
mini_batch_src_global generation:  0.0016582012176513672
r_  generation:  0.018387794494628906
local_output_nid generation:  0.0020780563354492188
local_in_edges_tensor generation:  0.001035451889038086
mini_batch_src_global generation:  0.0014700889587402344
r_  generation:  0.01792430877685547
local_output_nid generation:  0.0021238327026367188
local_in_edges_tensor generation:  0.0010104179382324219
mini_batch_src_global generation:  0.0014882087707519531
r_  generation:  0.018140316009521484
local_output_nid generation:  0.0020270347595214844
local_in_edges_tensor generation:  0.0009706020355224609
mini_batch_src_global generation:  0.0013954639434814453
r_  generation:  0.01827836036682129
local_output_nid generation:  0.002026081085205078
local_in_edges_tensor generation:  0.0010023117065429688
mini_batch_src_global generation:  0.0016016960144042969
r_  generation:  0.01875162124633789
local_output_nid generation:  0.002039670944213867
local_in_edges_tensor generation:  0.0010225772857666016
mini_batch_src_global generation:  0.0014951229095458984
r_  generation:  0.0189974308013916
local_output_nid generation:  0.001987934112548828
local_in_edges_tensor generation:  0.0010077953338623047
mini_batch_src_global generation:  0.001627206802368164
r_  generation:  0.019015073776245117
local_output_nid generation:  0.0019559860229492188
local_in_edges_tensor generation:  0.0019762516021728516
mini_batch_src_global generation:  0.009637117385864258
r_  generation:  0.02343916893005371
local_output_nid generation:  0.0022275447845458984
local_in_edges_tensor generation:  0.00099945068359375
mini_batch_src_global generation:  0.0019736289978027344
r_  generation:  0.020716190338134766
local_output_nid generation:  0.0018377304077148438
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0015418529510498047
r_  generation:  0.019573450088500977
local_output_nid generation:  0.001758575439453125
local_in_edges_tensor generation:  0.0008995532989501953
mini_batch_src_global generation:  0.0015549659729003906
r_  generation:  0.019744396209716797
local_output_nid generation:  0.0016963481903076172
local_in_edges_tensor generation:  0.0009164810180664062
mini_batch_src_global generation:  0.0015594959259033203
r_  generation:  0.02480792999267578
local_output_nid generation:  0.0018661022186279297
local_in_edges_tensor generation:  0.0019845962524414062
mini_batch_src_global generation:  0.007156848907470703
r_  generation:  0.026299238204956055
----------------------check_connections_block total spend ----------------------------- 0.5354263782501221
generate_one_block  0.03450965881347656
generate_one_block  0.047905683517456055
generate_one_block  0.03823232650756836
generate_one_block  0.05116987228393555
generate_one_block  0.04178285598754883
generate_one_block  0.04885101318359375
generate_one_block  0.03358745574951172
generate_one_block  0.0333857536315918
generate_one_block  0.0327906608581543
generate_one_block  0.031693220138549805
generate_one_block  0.032285213470458984
generate_one_block  0.031191587448120117
generate_one_block  0.030714035034179688
generate_one_block  0.0330352783203125
generate_one_block  0.03528285026550293
generate_one_block  0.04613780975341797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0329890251159668
gen group dst list time:  0.019378662109375
time for parepare:  0.021402835845947266
local_output_nid generation:  0.0071353912353515625
local_in_edges_tensor generation:  0.024381399154663086
mini_batch_src_global generation:  0.020249128341674805
r_  generation:  0.19010424613952637
local_output_nid generation:  0.010522603988647461
local_in_edges_tensor generation:  0.01416778564453125
mini_batch_src_global generation:  0.025408506393432617
r_  generation:  0.23568058013916016
local_output_nid generation:  0.013949871063232422
local_in_edges_tensor generation:  0.015152454376220703
mini_batch_src_global generation:  0.027092456817626953
r_  generation:  0.20832371711730957
local_output_nid generation:  0.011274099349975586
local_in_edges_tensor generation:  0.011881113052368164
mini_batch_src_global generation:  0.024297714233398438
r_  generation:  0.20993995666503906
local_output_nid generation:  0.011684417724609375
local_in_edges_tensor generation:  0.011286020278930664
mini_batch_src_global generation:  0.026274919509887695
r_  generation:  0.2088305950164795
local_output_nid generation:  0.011783123016357422
local_in_edges_tensor generation:  0.012073040008544922
mini_batch_src_global generation:  0.025831222534179688
r_  generation:  0.20981979370117188
local_output_nid generation:  0.011871814727783203
local_in_edges_tensor generation:  0.01124429702758789
mini_batch_src_global generation:  0.02603769302368164
r_  generation:  0.21287083625793457
local_output_nid generation:  0.01210784912109375
local_in_edges_tensor generation:  0.015608787536621094
mini_batch_src_global generation:  0.02651238441467285
r_  generation:  0.22098183631896973
local_output_nid generation:  0.011952877044677734
local_in_edges_tensor generation:  0.013020992279052734
mini_batch_src_global generation:  0.026241540908813477
r_  generation:  0.21465516090393066
local_output_nid generation:  0.012361764907836914
local_in_edges_tensor generation:  0.011397123336791992
mini_batch_src_global generation:  0.02628302574157715
r_  generation:  0.21413183212280273
local_output_nid generation:  0.012090444564819336
local_in_edges_tensor generation:  0.01276707649230957
mini_batch_src_global generation:  0.028149127960205078
r_  generation:  0.21929192543029785
local_output_nid generation:  0.011994600296020508
local_in_edges_tensor generation:  0.011670827865600586
mini_batch_src_global generation:  0.02664947509765625
r_  generation:  0.21389484405517578
local_output_nid generation:  0.012169837951660156
local_in_edges_tensor generation:  0.011300802230834961
mini_batch_src_global generation:  0.026220321655273438
r_  generation:  0.20955824851989746
local_output_nid generation:  0.012485504150390625
local_in_edges_tensor generation:  0.011512517929077148
mini_batch_src_global generation:  0.026747941970825195
r_  generation:  0.21506571769714355
local_output_nid generation:  0.012360811233520508
local_in_edges_tensor generation:  0.011556148529052734
mini_batch_src_global generation:  0.026511669158935547
r_  generation:  0.21421003341674805
local_output_nid generation:  0.012705087661743164
local_in_edges_tensor generation:  0.011711835861206055
mini_batch_src_global generation:  0.028045654296875
r_  generation:  0.22213244438171387
----------------------check_connections_block total spend ----------------------------- 5.0023298263549805
generate_one_block  0.2848174571990967
generate_one_block  0.28255534172058105
generate_one_block  0.2895374298095703
generate_one_block  0.28319382667541504
generate_one_block  0.27643918991088867
generate_one_block  0.2788863182067871
generate_one_block  0.3036031723022461
generate_one_block  0.2827463150024414
generate_one_block  0.2745838165283203
generate_one_block  0.2811870574951172
generate_one_block  0.2906785011291504
generate_one_block  0.2885003089904785
generate_one_block  0.28943896293640137
generate_one_block  0.29331350326538086
generate_one_block  0.28649139404296875
generate_one_block  0.3009450435638428
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033263444900512695
gen group dst list time:  0.06789445877075195
time for parepare:  0.018232107162475586
local_output_nid generation:  0.02683877944946289
local_in_edges_tensor generation:  0.0490262508392334
mini_batch_src_global generation:  0.05511665344238281
r_  generation:  0.47983860969543457
local_output_nid generation:  0.033751726150512695
local_in_edges_tensor generation:  0.03645634651184082
mini_batch_src_global generation:  0.05657792091369629
r_  generation:  0.45422887802124023
local_output_nid generation:  0.030292034149169922
local_in_edges_tensor generation:  0.03278374671936035
mini_batch_src_global generation:  0.05408978462219238
r_  generation:  0.47699713706970215
local_output_nid generation:  0.030397653579711914
local_in_edges_tensor generation:  0.03443121910095215
mini_batch_src_global generation:  0.05658841133117676
r_  generation:  0.46596288681030273
local_output_nid generation:  0.03063058853149414
local_in_edges_tensor generation:  0.07783722877502441
mini_batch_src_global generation:  0.05464315414428711
r_  generation:  0.49965763092041016
local_output_nid generation:  0.03485417366027832
local_in_edges_tensor generation:  0.0408785343170166
mini_batch_src_global generation:  0.057370662689208984
r_  generation:  0.45051121711730957
local_output_nid generation:  0.03174471855163574
local_in_edges_tensor generation:  0.0346524715423584
mini_batch_src_global generation:  0.051757097244262695
r_  generation:  0.4586920738220215
local_output_nid generation:  0.03157377243041992
local_in_edges_tensor generation:  0.03060603141784668
mini_batch_src_global generation:  0.05315876007080078
r_  generation:  0.4525265693664551
local_output_nid generation:  0.032176971435546875
local_in_edges_tensor generation:  0.030709028244018555
mini_batch_src_global generation:  0.05205106735229492
r_  generation:  0.45750880241394043
local_output_nid generation:  0.03168988227844238
local_in_edges_tensor generation:  0.03062582015991211
mini_batch_src_global generation:  0.05319643020629883
r_  generation:  0.4525139331817627
local_output_nid generation:  0.0318760871887207
local_in_edges_tensor generation:  0.03304696083068848
mini_batch_src_global generation:  0.05240583419799805
r_  generation:  0.4620957374572754
local_output_nid generation:  0.032006025314331055
local_in_edges_tensor generation:  0.028554916381835938
mini_batch_src_global generation:  0.05304670333862305
r_  generation:  0.46452784538269043
local_output_nid generation:  0.032085418701171875
local_in_edges_tensor generation:  0.030274152755737305
mini_batch_src_global generation:  0.053075313568115234
r_  generation:  0.4621748924255371
local_output_nid generation:  0.0317533016204834
local_in_edges_tensor generation:  0.0328676700592041
mini_batch_src_global generation:  0.05583667755126953
r_  generation:  0.4567444324493408
local_output_nid generation:  0.032062530517578125
local_in_edges_tensor generation:  0.03494548797607422
mini_batch_src_global generation:  0.05227017402648926
r_  generation:  0.45960450172424316
local_output_nid generation:  0.034621477127075195
local_in_edges_tensor generation:  0.03057408332824707
mini_batch_src_global generation:  0.05353093147277832
r_  generation:  0.4731729030609131
----------------------check_connections_block total spend ----------------------------- 11.021153211593628
generate_one_block  0.6155145168304443
generate_one_block  0.596440315246582
generate_one_block  0.5933420658111572
generate_one_block  0.5925948619842529
generate_one_block  0.594207763671875
generate_one_block  0.5971276760101318
generate_one_block  0.6135718822479248
generate_one_block  0.6054470539093018
generate_one_block  0.628000020980835
generate_one_block  0.6070890426635742
generate_one_block  0.610987663269043
generate_one_block  0.6081089973449707
generate_one_block  0.5984082221984863
generate_one_block  0.6062052249908447
generate_one_block  0.605750560760498
generate_one_block  0.6116161346435547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1338362693786621  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  16.02348303794861
block generation total time  14.271329641342163
average batch blocks generation time:  0.8919581025838852
block dataloader generation time/epoch 32.58340814378526
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11118268966674805  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.989534854888916  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11122465133666992  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.10353946685791  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11107110977172852  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.195693969726562  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11120843887329102  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.14688205718994  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11098909378051758  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.923999786376953  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11115026473999023  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.01709747314453  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11106157302856445  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.062135219573975  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11129426956176758  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.27846336364746  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11093759536743164  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.905285835266113  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11122941970825195  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.15876865386963  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112833023071289  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.442328453063965  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1111598014831543  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.00167179107666  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11067342758178711  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.802997589111328  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11124753952026367  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.133408546447754  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11101770401000977  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.074275016784668  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11142206192016602  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.490274906158447  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04253967106342316 |0.014653578400611877 |0.3050839751958847 |9.177625179290771e-05 |0.5592742711305618 |0.0066721439361572266 |
----------------------------------------------------------pseudo_mini_loss sum 1.3923157453536987
Total (block generation + training)time/epoch 47.41909903950162
Training time/epoch 14.788818120956421
Training time without block to device /epoch 14.55436086654663
Training time without total dataloading part /epoch 13.837872505187988
load block tensor time/epoch 0.6806347370147705
block to device time/epoch 0.23445725440979004
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  5092693
Number of first layer input nodes during this epoch:  2472071
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.13462066650390625  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022202014923095703
range selection method range initialization spend 0.01601386070251465
time for parepare:  0.018789291381835938
local_output_nid generation:  0.0017750263214111328
local_in_edges_tensor generation:  0.009423017501831055
mini_batch_src_global generation:  0.002938508987426758
r_  generation:  0.021026134490966797
local_output_nid generation:  0.002170562744140625
local_in_edges_tensor generation:  0.0028917789459228516
mini_batch_src_global generation:  0.005051374435424805
r_  generation:  0.025656700134277344
local_output_nid generation:  0.0021071434020996094
local_in_edges_tensor generation:  0.0012750625610351562
mini_batch_src_global generation:  0.002004384994506836
r_  generation:  0.030730009078979492
local_output_nid generation:  0.0036733150482177734
local_in_edges_tensor generation:  0.003589153289794922
mini_batch_src_global generation:  0.004778385162353516
r_  generation:  0.023599863052368164
local_output_nid generation:  0.0018203258514404297
local_in_edges_tensor generation:  0.0009453296661376953
mini_batch_src_global generation:  0.001991748809814453
r_  generation:  0.021500825881958008
local_output_nid generation:  0.0017457008361816406
local_in_edges_tensor generation:  0.0009918212890625
mini_batch_src_global generation:  0.001947164535522461
r_  generation:  0.026600122451782227
local_output_nid generation:  0.0020673274993896484
local_in_edges_tensor generation:  0.0010924339294433594
mini_batch_src_global generation:  0.0016751289367675781
r_  generation:  0.01971268653869629
local_output_nid generation:  0.0019767284393310547
local_in_edges_tensor generation:  0.0011570453643798828
mini_batch_src_global generation:  0.0016870498657226562
r_  generation:  0.019698143005371094
local_output_nid generation:  0.0019159317016601562
local_in_edges_tensor generation:  0.0012087821960449219
mini_batch_src_global generation:  0.0016450881958007812
r_  generation:  0.018957138061523438
local_output_nid generation:  0.0019087791442871094
local_in_edges_tensor generation:  0.0012700557708740234
mini_batch_src_global generation:  0.0016100406646728516
r_  generation:  0.01894855499267578
local_output_nid generation:  0.002068042755126953
local_in_edges_tensor generation:  0.001180410385131836
mini_batch_src_global generation:  0.008886575698852539
r_  generation:  0.022743701934814453
local_output_nid generation:  0.0017402172088623047
local_in_edges_tensor generation:  0.0009152889251708984
mini_batch_src_global generation:  0.0018839836120605469
r_  generation:  0.03429079055786133
local_output_nid generation:  0.003461599349975586
local_in_edges_tensor generation:  0.002008676528930664
mini_batch_src_global generation:  0.003551006317138672
r_  generation:  0.022960662841796875
local_output_nid generation:  0.0016930103302001953
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0015137195587158203
r_  generation:  0.019643068313598633
local_output_nid generation:  0.0017223358154296875
local_in_edges_tensor generation:  0.0009837150573730469
mini_batch_src_global generation:  0.0015375614166259766
r_  generation:  0.02057480812072754
local_output_nid generation:  0.0017058849334716797
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.0019512176513671875
r_  generation:  0.021609067916870117
----------------------check_connections_block total spend ----------------------------- 0.5964009761810303
generate_one_block  0.036099910736083984
generate_one_block  0.03398561477661133
generate_one_block  0.03309059143066406
generate_one_block  0.03442502021789551
generate_one_block  0.04374051094055176
generate_one_block  0.03458905220031738
generate_one_block  0.032949209213256836
generate_one_block  0.034409523010253906
generate_one_block  0.037610530853271484
generate_one_block  0.04561114311218262
generate_one_block  0.03211402893066406
generate_one_block  0.035794734954833984
generate_one_block  0.03735852241516113
generate_one_block  0.03301715850830078
generate_one_block  0.032985687255859375
generate_one_block  0.0333399772644043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03436017036437988
gen group dst list time:  0.018909215927124023
time for parepare:  0.019681930541992188
local_output_nid generation:  0.007488727569580078
local_in_edges_tensor generation:  0.024759531021118164
mini_batch_src_global generation:  0.021245479583740234
r_  generation:  0.19556236267089844
local_output_nid generation:  0.010772705078125
local_in_edges_tensor generation:  0.01416778564453125
mini_batch_src_global generation:  0.0244905948638916
r_  generation:  0.20377159118652344
local_output_nid generation:  0.010957479476928711
local_in_edges_tensor generation:  0.014710187911987305
mini_batch_src_global generation:  0.023338794708251953
r_  generation:  0.21115541458129883
local_output_nid generation:  0.012048721313476562
local_in_edges_tensor generation:  0.014369726181030273
mini_batch_src_global generation:  0.029160737991333008
r_  generation:  0.21982145309448242
local_output_nid generation:  0.012503623962402344
local_in_edges_tensor generation:  0.020256996154785156
mini_batch_src_global generation:  0.029825448989868164
r_  generation:  0.26067614555358887
local_output_nid generation:  0.019110918045043945
local_in_edges_tensor generation:  0.01822829246520996
mini_batch_src_global generation:  0.03590130805969238
r_  generation:  0.24707508087158203
local_output_nid generation:  0.017305612564086914
local_in_edges_tensor generation:  0.015303850173950195
mini_batch_src_global generation:  0.034180641174316406
r_  generation:  0.2155756950378418
local_output_nid generation:  0.013451814651489258
local_in_edges_tensor generation:  0.012250185012817383
mini_batch_src_global generation:  0.029032230377197266
r_  generation:  0.21732616424560547
local_output_nid generation:  0.0129547119140625
local_in_edges_tensor generation:  0.012485504150390625
mini_batch_src_global generation:  0.02752852439880371
r_  generation:  0.21367502212524414
local_output_nid generation:  0.012624263763427734
local_in_edges_tensor generation:  0.013355016708374023
mini_batch_src_global generation:  0.026346445083618164
r_  generation:  0.21446442604064941
local_output_nid generation:  0.012729883193969727
local_in_edges_tensor generation:  0.011665821075439453
mini_batch_src_global generation:  0.028983354568481445
r_  generation:  0.21635031700134277
local_output_nid generation:  0.012845039367675781
local_in_edges_tensor generation:  0.01201009750366211
mini_batch_src_global generation:  0.025966405868530273
r_  generation:  0.21400189399719238
local_output_nid generation:  0.01279139518737793
local_in_edges_tensor generation:  0.011358976364135742
mini_batch_src_global generation:  0.026523828506469727
r_  generation:  0.22596478462219238
local_output_nid generation:  0.01586151123046875
local_in_edges_tensor generation:  0.011669635772705078
mini_batch_src_global generation:  0.03083062171936035
r_  generation:  0.2145979404449463
local_output_nid generation:  0.013281106948852539
local_in_edges_tensor generation:  0.011580944061279297
mini_batch_src_global generation:  0.02624368667602539
r_  generation:  0.26253437995910645
local_output_nid generation:  0.013418436050415039
local_in_edges_tensor generation:  0.011898279190063477
mini_batch_src_global generation:  0.030228376388549805
r_  generation:  0.2184746265411377
----------------------check_connections_block total spend ----------------------------- 5.269441366195679
generate_one_block  0.30988049507141113
generate_one_block  0.2853109836578369
generate_one_block  0.29230546951293945
generate_one_block  0.30347609519958496
generate_one_block  0.29096198081970215
generate_one_block  0.2894704341888428
generate_one_block  0.316241979598999
generate_one_block  0.289215087890625
generate_one_block  0.2829442024230957
generate_one_block  0.27595949172973633
generate_one_block  0.2816638946533203
generate_one_block  0.28316569328308105
generate_one_block  0.27556920051574707
generate_one_block  0.28372907638549805
generate_one_block  0.2838304042816162
generate_one_block  0.3104212284088135
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03403592109680176
gen group dst list time:  0.06293559074401855
time for parepare:  0.02061176300048828
local_output_nid generation:  0.025952816009521484
local_in_edges_tensor generation:  0.04765820503234863
mini_batch_src_global generation:  0.04123950004577637
r_  generation:  0.4507443904876709
local_output_nid generation:  0.03162097930908203
local_in_edges_tensor generation:  0.04062986373901367
mini_batch_src_global generation:  0.0522310733795166
r_  generation:  0.45350050926208496
local_output_nid generation:  0.032362937927246094
local_in_edges_tensor generation:  0.031816959381103516
mini_batch_src_global generation:  0.051210641860961914
r_  generation:  0.45840907096862793
local_output_nid generation:  0.030505657196044922
local_in_edges_tensor generation:  0.03575301170349121
mini_batch_src_global generation:  0.052597999572753906
r_  generation:  0.47574710845947266
local_output_nid generation:  0.03456544876098633
local_in_edges_tensor generation:  0.09152340888977051
mini_batch_src_global generation:  0.05324387550354004
r_  generation:  0.4551215171813965
local_output_nid generation:  0.03104710578918457
local_in_edges_tensor generation:  0.03215146064758301
mini_batch_src_global generation:  0.052999019622802734
r_  generation:  0.44838905334472656
local_output_nid generation:  0.030895471572875977
local_in_edges_tensor generation:  0.028284788131713867
mini_batch_src_global generation:  0.051537513732910156
r_  generation:  0.45702481269836426
local_output_nid generation:  0.030681133270263672
local_in_edges_tensor generation:  0.035042762756347656
mini_batch_src_global generation:  0.05485796928405762
r_  generation:  0.4559366703033447
local_output_nid generation:  0.030747652053833008
local_in_edges_tensor generation:  0.030459880828857422
mini_batch_src_global generation:  0.05359935760498047
r_  generation:  0.46555018424987793
local_output_nid generation:  0.030850887298583984
local_in_edges_tensor generation:  0.028885841369628906
mini_batch_src_global generation:  0.052785396575927734
r_  generation:  0.4538412094116211
local_output_nid generation:  0.03118443489074707
local_in_edges_tensor generation:  0.028685569763183594
mini_batch_src_global generation:  0.051286935806274414
r_  generation:  0.45851826667785645
local_output_nid generation:  0.033989667892456055
local_in_edges_tensor generation:  0.030949831008911133
mini_batch_src_global generation:  0.05285358428955078
r_  generation:  0.45607423782348633
local_output_nid generation:  0.031041622161865234
local_in_edges_tensor generation:  0.032434701919555664
mini_batch_src_global generation:  0.053107261657714844
r_  generation:  0.46341729164123535
local_output_nid generation:  0.03096771240234375
local_in_edges_tensor generation:  0.030402183532714844
mini_batch_src_global generation:  0.05317378044128418
r_  generation:  0.45346951484680176
local_output_nid generation:  0.030759096145629883
local_in_edges_tensor generation:  0.036847591400146484
mini_batch_src_global generation:  0.05156540870666504
r_  generation:  0.4578664302825928
local_output_nid generation:  0.031159639358520508
local_in_edges_tensor generation:  0.03226327896118164
mini_batch_src_global generation:  0.053105831146240234
r_  generation:  0.45894289016723633
----------------------check_connections_block total spend ----------------------------- 10.857645750045776
generate_one_block  0.6228342056274414
generate_one_block  0.5971124172210693
generate_one_block  0.591942548751831
generate_one_block  0.5992782115936279
generate_one_block  0.5989406108856201
generate_one_block  0.5896165370941162
generate_one_block  0.5976564884185791
generate_one_block  0.6057651042938232
generate_one_block  0.631763219833374
generate_one_block  0.6030724048614502
generate_one_block  0.5971956253051758
generate_one_block  0.596627950668335
generate_one_block  0.5978214740753174
generate_one_block  0.5960099697113037
generate_one_block  0.6016778945922852
generate_one_block  0.6056301593780518
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.13462066650390625  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  16.127087116241455
block generation total time  14.287090539932251
average batch blocks generation time:  0.8929431587457657
block dataloader generation time/epoch 32.60839755535126
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11101675033569336  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.112871646881104  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11123132705688477  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.145482540130615  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11083078384399414  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.98589324951172  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11143255233764648  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.483698844909668  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11113119125366211  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.243059158325195  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11108160018920898  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.90743112564087  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1110219955444336  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.263827800750732  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11135625839233398  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.371402740478516  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1109013557434082  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.05421495437622  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1110529899597168  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.863004207611084  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11082315444946289  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.998335361480713  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11116552352905273  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.057865619659424  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1109170913696289  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.854969024658203  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11118364334106445  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.04412841796875  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11064672470092773  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.95268201828003  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11131715774536133  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.282995223999023  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04272250831127167 |0.014109387993812561 |0.304540291428566 |9.004771709442139e-05 |0.558683916926384 |0.0066187381744384766 |
----------------------------------------------------------pseudo_mini_loss sum 1.3655129671096802
Total (block generation + training)time/epoch 47.43704843521118
Training time/epoch 14.765067100524902
Training time without block to device /epoch 14.539316892623901
Training time without total dataloading part /epoch 13.819646835327148
load block tensor time/epoch 0.6835601329803467
block to device time/epoch 0.22575020790100098
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  5092887
Number of first layer input nodes during this epoch:  2472960
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1355280876159668  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.048035621643066406
range selection method range initialization spend 0.013381242752075195
time for parepare:  0.016730308532714844
local_output_nid generation:  0.0016868114471435547
local_in_edges_tensor generation:  0.0059854984283447266
mini_batch_src_global generation:  0.001466512680053711
r_  generation:  0.01932835578918457
local_output_nid generation:  0.0018720626831054688
local_in_edges_tensor generation:  0.0013055801391601562
mini_batch_src_global generation:  0.001836538314819336
r_  generation:  0.021241188049316406
local_output_nid generation:  0.0017216205596923828
local_in_edges_tensor generation:  0.0017163753509521484
mini_batch_src_global generation:  0.0022792816162109375
r_  generation:  0.02082037925720215
local_output_nid generation:  0.0017192363739013672
local_in_edges_tensor generation:  0.0014290809631347656
mini_batch_src_global generation:  0.0017955303192138672
r_  generation:  0.020897388458251953
local_output_nid generation:  0.001687765121459961
local_in_edges_tensor generation:  0.0012364387512207031
mini_batch_src_global generation:  0.0019037723541259766
r_  generation:  0.02177119255065918
local_output_nid generation:  0.0016787052154541016
local_in_edges_tensor generation:  0.0009641647338867188
mini_batch_src_global generation:  0.0019240379333496094
r_  generation:  0.02142930030822754
local_output_nid generation:  0.001676321029663086
local_in_edges_tensor generation:  0.0012226104736328125
mini_batch_src_global generation:  0.0019221305847167969
r_  generation:  0.021538734436035156
local_output_nid generation:  0.0016913414001464844
local_in_edges_tensor generation:  0.0009274482727050781
mini_batch_src_global generation:  0.001912832260131836
r_  generation:  0.021310091018676758
local_output_nid generation:  0.0016741752624511719
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0018389225006103516
r_  generation:  0.03859877586364746
local_output_nid generation:  0.002656698226928711
local_in_edges_tensor generation:  0.0013186931610107422
mini_batch_src_global generation:  0.006766319274902344
r_  generation:  0.02028679847717285
local_output_nid generation:  0.0016677379608154297
local_in_edges_tensor generation:  0.0009391307830810547
mini_batch_src_global generation:  0.001598358154296875
r_  generation:  0.019711017608642578
local_output_nid generation:  0.0016450881958007812
local_in_edges_tensor generation:  0.0009362697601318359
mini_batch_src_global generation:  0.001552581787109375
r_  generation:  0.01962590217590332
local_output_nid generation:  0.001682281494140625
local_in_edges_tensor generation:  0.0009305477142333984
mini_batch_src_global generation:  0.0015225410461425781
r_  generation:  0.02133011817932129
local_output_nid generation:  0.001672506332397461
local_in_edges_tensor generation:  0.0009303092956542969
mini_batch_src_global generation:  0.001874685287475586
r_  generation:  0.02184009552001953
local_output_nid generation:  0.0016794204711914062
local_in_edges_tensor generation:  0.0010690689086914062
mini_batch_src_global generation:  0.001796722412109375
r_  generation:  0.02138996124267578
local_output_nid generation:  0.0016913414001464844
local_in_edges_tensor generation:  0.0009715557098388672
mini_batch_src_global generation:  0.0019488334655761719
r_  generation:  0.019928455352783203
----------------------check_connections_block total spend ----------------------------- 0.535529613494873
generate_one_block  0.03206920623779297
generate_one_block  0.031738996505737305
generate_one_block  0.03464317321777344
generate_one_block  0.03112316131591797
generate_one_block  0.032324790954589844
generate_one_block  0.0380399227142334
generate_one_block  0.03194141387939453
generate_one_block  0.0307767391204834
generate_one_block  0.030454397201538086
generate_one_block  0.03161215782165527
generate_one_block  0.032124996185302734
generate_one_block  0.031024932861328125
generate_one_block  0.030881404876708984
generate_one_block  0.030579805374145508
generate_one_block  0.030965805053710938
generate_one_block  0.033454179763793945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033359527587890625
gen group dst list time:  0.020363807678222656
time for parepare:  0.020490407943725586
local_output_nid generation:  0.0075206756591796875
local_in_edges_tensor generation:  0.022660017013549805
mini_batch_src_global generation:  0.020684003829956055
r_  generation:  0.19473528861999512
local_output_nid generation:  0.010656118392944336
local_in_edges_tensor generation:  0.012399673461914062
mini_batch_src_global generation:  0.024370908737182617
r_  generation:  0.20148324966430664
local_output_nid generation:  0.010904788970947266
local_in_edges_tensor generation:  0.01427149772644043
mini_batch_src_global generation:  0.02463698387145996
r_  generation:  0.20368480682373047
local_output_nid generation:  0.01184701919555664
local_in_edges_tensor generation:  0.014332056045532227
mini_batch_src_global generation:  0.024174213409423828
r_  generation:  0.20539021492004395
local_output_nid generation:  0.012298822402954102
local_in_edges_tensor generation:  0.01134943962097168
mini_batch_src_global generation:  0.02630901336669922
r_  generation:  0.21684551239013672
local_output_nid generation:  0.01177525520324707
local_in_edges_tensor generation:  0.01110386848449707
mini_batch_src_global generation:  0.02633976936340332
r_  generation:  0.2111368179321289
local_output_nid generation:  0.012306928634643555
local_in_edges_tensor generation:  0.011996984481811523
mini_batch_src_global generation:  0.027536630630493164
r_  generation:  0.21429705619812012
local_output_nid generation:  0.012296199798583984
local_in_edges_tensor generation:  0.01136636734008789
mini_batch_src_global generation:  0.02860713005065918
r_  generation:  0.21301770210266113
local_output_nid generation:  0.012095212936401367
local_in_edges_tensor generation:  0.01455235481262207
mini_batch_src_global generation:  0.026905298233032227
r_  generation:  0.20902538299560547
local_output_nid generation:  0.01261138916015625
local_in_edges_tensor generation:  0.012441873550415039
mini_batch_src_global generation:  0.026424169540405273
r_  generation:  0.21523833274841309
local_output_nid generation:  0.012275457382202148
local_in_edges_tensor generation:  0.011423826217651367
mini_batch_src_global generation:  0.027822256088256836
r_  generation:  0.21760964393615723
local_output_nid generation:  0.012408733367919922
local_in_edges_tensor generation:  0.01249837875366211
mini_batch_src_global generation:  0.027829408645629883
r_  generation:  0.21332716941833496
local_output_nid generation:  0.012583255767822266
local_in_edges_tensor generation:  0.01226186752319336
mini_batch_src_global generation:  0.026499271392822266
r_  generation:  0.21458721160888672
local_output_nid generation:  0.012681245803833008
local_in_edges_tensor generation:  0.012367010116577148
mini_batch_src_global generation:  0.027680635452270508
r_  generation:  0.21363329887390137
local_output_nid generation:  0.012526750564575195
local_in_edges_tensor generation:  0.011476755142211914
mini_batch_src_global generation:  0.02634143829345703
r_  generation:  0.21421480178833008
local_output_nid generation:  0.012825489044189453
local_in_edges_tensor generation:  0.01125478744506836
mini_batch_src_global generation:  0.029236316680908203
r_  generation:  0.21741867065429688
----------------------check_connections_block total spend ----------------------------- 4.958623647689819
generate_one_block  0.2989678382873535
generate_one_block  0.291837215423584
generate_one_block  0.2847902774810791
generate_one_block  0.2913553714752197
generate_one_block  0.29552674293518066
generate_one_block  0.28933072090148926
generate_one_block  0.32517051696777344
generate_one_block  0.2821791172027588
generate_one_block  0.27444982528686523
generate_one_block  0.2857694625854492
generate_one_block  0.2871057987213135
generate_one_block  0.27951717376708984
generate_one_block  0.2784438133239746
generate_one_block  0.27955174446105957
generate_one_block  0.27834367752075195
generate_one_block  0.283428430557251
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03285956382751465
gen group dst list time:  0.0620265007019043
time for parepare:  0.020509719848632812
local_output_nid generation:  0.02624654769897461
local_in_edges_tensor generation:  0.04617667198181152
mini_batch_src_global generation:  0.056391239166259766
r_  generation:  0.4713010787963867
local_output_nid generation:  0.03477168083190918
local_in_edges_tensor generation:  0.03826093673706055
mini_batch_src_global generation:  0.05312347412109375
r_  generation:  0.46223020553588867
local_output_nid generation:  0.03112483024597168
local_in_edges_tensor generation:  0.03985166549682617
mini_batch_src_global generation:  0.05709648132324219
r_  generation:  0.4806997776031494
local_output_nid generation:  0.03437471389770508
local_in_edges_tensor generation:  0.03503894805908203
mini_batch_src_global generation:  0.055211782455444336
r_  generation:  0.45274877548217773
local_output_nid generation:  0.03202080726623535
local_in_edges_tensor generation:  0.08512663841247559
mini_batch_src_global generation:  0.05144214630126953
r_  generation:  0.46210479736328125
local_output_nid generation:  0.030724525451660156
local_in_edges_tensor generation:  0.02892136573791504
mini_batch_src_global generation:  0.05338263511657715
r_  generation:  0.45714831352233887
local_output_nid generation:  0.03126811981201172
local_in_edges_tensor generation:  0.03023242950439453
mini_batch_src_global generation:  0.05400586128234863
r_  generation:  0.4826784133911133
local_output_nid generation:  0.03128623962402344
local_in_edges_tensor generation:  0.03632307052612305
mini_batch_src_global generation:  0.05472517013549805
r_  generation:  0.4564995765686035
local_output_nid generation:  0.03189730644226074
local_in_edges_tensor generation:  0.03332924842834473
mini_batch_src_global generation:  0.05142831802368164
r_  generation:  0.46547555923461914
local_output_nid generation:  0.03160429000854492
local_in_edges_tensor generation:  0.029406309127807617
mini_batch_src_global generation:  0.057376861572265625
r_  generation:  0.46215057373046875
local_output_nid generation:  0.03326725959777832
local_in_edges_tensor generation:  0.03696250915527344
mini_batch_src_global generation:  0.052171945571899414
r_  generation:  0.48618149757385254
local_output_nid generation:  0.0343928337097168
local_in_edges_tensor generation:  0.03537726402282715
mini_batch_src_global generation:  0.05385231971740723
r_  generation:  0.45583152770996094
local_output_nid generation:  0.03219318389892578
local_in_edges_tensor generation:  0.030176877975463867
mini_batch_src_global generation:  0.05356550216674805
r_  generation:  0.46244335174560547
local_output_nid generation:  0.03224325180053711
local_in_edges_tensor generation:  0.02864527702331543
mini_batch_src_global generation:  0.052814483642578125
r_  generation:  0.4531238079071045
local_output_nid generation:  0.03230476379394531
local_in_edges_tensor generation:  0.030547142028808594
mini_batch_src_global generation:  0.051674604415893555
r_  generation:  0.46268773078918457
local_output_nid generation:  0.032216787338256836
local_in_edges_tensor generation:  0.030816078186035156
mini_batch_src_global generation:  0.054781198501586914
r_  generation:  0.4540996551513672
----------------------check_connections_block total spend ----------------------------- 11.046530485153198
generate_one_block  0.6060571670532227
generate_one_block  0.5978455543518066
generate_one_block  0.6105685234069824
generate_one_block  0.607330322265625
generate_one_block  0.6062328815460205
generate_one_block  0.6048429012298584
generate_one_block  0.6070001125335693
generate_one_block  0.6002044677734375
generate_one_block  0.6369562149047852
generate_one_block  0.6127452850341797
generate_one_block  0.6089472770690918
generate_one_block  0.6064553260803223
generate_one_block  0.596909761428833
generate_one_block  0.5967118740081787
generate_one_block  0.6031184196472168
generate_one_block  0.5908803939819336
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1355280876159668  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  16.005154132843018
block generation total time  14.298574209213257
average batch blocks generation time:  0.8936608880758286
block dataloader generation time/epoch 32.61450123786926
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1110072135925293  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.242784023284912  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11127138137817383  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.20723819732666  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11098003387451172  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.077614307403564  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112065315246582  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.080641269683838  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11119985580444336  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.547096252441406  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112666130065918  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.207358837127686  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11120319366455078  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.33759117126465  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11116361618041992  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.030662536621094  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11070489883422852  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.707619667053223  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112818717956543  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.24671220779419  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11125612258911133  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.27389144897461  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11116647720336914  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.02607250213623  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11097574234008789  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.023547172546387  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11116266250610352  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.017104625701904  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11100482940673828  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.983420848846436  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11115121841430664  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.00762701034546  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0424250066280365 |0.013437807559967041 |0.30535805225372314 |9.319186210632324e-05 |0.5594578385353088 |0.006557941436767578 |
----------------------------------------------------------pseudo_mini_loss sum 1.3451061248779297
Total (block generation + training)time/epoch 47.438303687355734
Training time/epoch 14.77507758140564
Training time without block to device /epoch 14.560072660446167
Training time without total dataloading part /epoch 13.84510326385498
load block tensor time/epoch 0.678800106048584
block to device time/epoch 0.21500492095947266
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  5091585
Number of first layer input nodes during this epoch:  2471000
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.134063720703125  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026340246200561523
range selection method range initialization spend 0.012591838836669922
time for parepare:  0.02189922332763672
local_output_nid generation:  0.0020766258239746094
local_in_edges_tensor generation:  0.006430149078369141
mini_batch_src_global generation:  0.0019216537475585938
r_  generation:  0.017391681671142578
local_output_nid generation:  0.0017812252044677734
local_in_edges_tensor generation:  0.0014269351959228516
mini_batch_src_global generation:  0.002144336700439453
r_  generation:  0.018941640853881836
local_output_nid generation:  0.00189971923828125
local_in_edges_tensor generation:  0.0014727115631103516
mini_batch_src_global generation:  0.0016264915466308594
r_  generation:  0.01811051368713379
local_output_nid generation:  0.001886606216430664
local_in_edges_tensor generation:  0.0013842582702636719
mini_batch_src_global generation:  0.0016632080078125
r_  generation:  0.01769256591796875
local_output_nid generation:  0.0019259452819824219
local_in_edges_tensor generation:  0.001232147216796875
mini_batch_src_global generation:  0.00152587890625
r_  generation:  0.017736434936523438
local_output_nid generation:  0.0018768310546875
local_in_edges_tensor generation:  0.00102996826171875
mini_batch_src_global generation:  0.0014336109161376953
r_  generation:  0.017574310302734375
local_output_nid generation:  0.0019383430480957031
local_in_edges_tensor generation:  0.0010266304016113281
mini_batch_src_global generation:  0.0015192031860351562
r_  generation:  0.018033981323242188
local_output_nid generation:  0.001875162124633789
local_in_edges_tensor generation:  0.0011241436004638672
mini_batch_src_global generation:  0.001516580581665039
r_  generation:  0.018289804458618164
local_output_nid generation:  0.004323720932006836
local_in_edges_tensor generation:  0.0020847320556640625
mini_batch_src_global generation:  0.008268356323242188
r_  generation:  0.024019956588745117
local_output_nid generation:  0.0019123554229736328
local_in_edges_tensor generation:  0.00096893310546875
mini_batch_src_global generation:  0.001951456069946289
r_  generation:  0.033283233642578125
local_output_nid generation:  0.0021293163299560547
local_in_edges_tensor generation:  0.000995635986328125
mini_batch_src_global generation:  0.001604318618774414
r_  generation:  0.018510818481445312
local_output_nid generation:  0.0018765926361083984
local_in_edges_tensor generation:  0.00102996826171875
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.018205881118774414
local_output_nid generation:  0.0018961429595947266
local_in_edges_tensor generation:  0.0010197162628173828
mini_batch_src_global generation:  0.0015158653259277344
r_  generation:  0.018425941467285156
local_output_nid generation:  0.0018532276153564453
local_in_edges_tensor generation:  0.0009930133819580078
mini_batch_src_global generation:  0.0016117095947265625
r_  generation:  0.01853632926940918
local_output_nid generation:  0.001870870590209961
local_in_edges_tensor generation:  0.0010929107666015625
mini_batch_src_global generation:  0.0017116069793701172
r_  generation:  0.01864314079284668
local_output_nid generation:  0.0018665790557861328
local_in_edges_tensor generation:  0.0009996891021728516
mini_batch_src_global generation:  0.0014524459838867188
r_  generation:  0.020146608352661133
----------------------check_connections_block total spend ----------------------------- 0.5058636665344238
generate_one_block  0.03935360908508301
generate_one_block  0.03162384033203125
generate_one_block  0.03449082374572754
generate_one_block  0.03374743461608887
generate_one_block  0.03840899467468262
generate_one_block  0.05177593231201172
generate_one_block  0.03652000427246094
generate_one_block  0.03188800811767578
generate_one_block  0.03390049934387207
generate_one_block  0.03135275840759277
generate_one_block  0.031462907791137695
generate_one_block  0.03445172309875488
generate_one_block  0.03158307075500488
generate_one_block  0.03170967102050781
generate_one_block  0.034826040267944336
generate_one_block  0.031824588775634766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02891087532043457
gen group dst list time:  0.01715826988220215
time for parepare:  0.024556398391723633
local_output_nid generation:  0.007634162902832031
local_in_edges_tensor generation:  0.021281003952026367
mini_batch_src_global generation:  0.020499467849731445
r_  generation:  0.19209814071655273
local_output_nid generation:  0.010602474212646484
local_in_edges_tensor generation:  0.016783952713012695
mini_batch_src_global generation:  0.02478933334350586
r_  generation:  0.20999550819396973
local_output_nid generation:  0.011331319808959961
local_in_edges_tensor generation:  0.013633012771606445
mini_batch_src_global generation:  0.027469396591186523
r_  generation:  0.21546268463134766
local_output_nid generation:  0.011888504028320312
local_in_edges_tensor generation:  0.016683578491210938
mini_batch_src_global generation:  0.029772281646728516
r_  generation:  0.21648263931274414
local_output_nid generation:  0.012898683547973633
local_in_edges_tensor generation:  0.014785528182983398
mini_batch_src_global generation:  0.0264890193939209
r_  generation:  0.21125411987304688
local_output_nid generation:  0.01188802719116211
local_in_edges_tensor generation:  0.012888908386230469
mini_batch_src_global generation:  0.025784015655517578
r_  generation:  0.209883451461792
local_output_nid generation:  0.012592792510986328
local_in_edges_tensor generation:  0.011525392532348633
mini_batch_src_global generation:  0.027437210083007812
r_  generation:  0.21384143829345703
local_output_nid generation:  0.012779951095581055
local_in_edges_tensor generation:  0.011419057846069336
mini_batch_src_global generation:  0.02631998062133789
r_  generation:  0.21065568923950195
local_output_nid generation:  0.012824058532714844
local_in_edges_tensor generation:  0.011508941650390625
mini_batch_src_global generation:  0.026745080947875977
r_  generation:  0.21422052383422852
local_output_nid generation:  0.012885332107543945
local_in_edges_tensor generation:  0.013404607772827148
mini_batch_src_global generation:  0.026594877243041992
r_  generation:  0.21534276008605957
local_output_nid generation:  0.012599706649780273
local_in_edges_tensor generation:  0.01137399673461914
mini_batch_src_global generation:  0.028168201446533203
r_  generation:  0.21358132362365723
local_output_nid generation:  0.01287388801574707
local_in_edges_tensor generation:  0.012445211410522461
mini_batch_src_global generation:  0.026427507400512695
r_  generation:  0.21664953231811523
local_output_nid generation:  0.013079166412353516
local_in_edges_tensor generation:  0.011574029922485352
mini_batch_src_global generation:  0.026706457138061523
r_  generation:  0.21857070922851562
local_output_nid generation:  0.012979269027709961
local_in_edges_tensor generation:  0.011656522750854492
mini_batch_src_global generation:  0.026263713836669922
r_  generation:  0.2259199619293213
local_output_nid generation:  0.013445615768432617
local_in_edges_tensor generation:  0.011547565460205078
mini_batch_src_global generation:  0.027321338653564453
r_  generation:  0.22670459747314453
local_output_nid generation:  0.014009237289428711
local_in_edges_tensor generation:  0.018350839614868164
mini_batch_src_global generation:  0.02790379524230957
r_  generation:  0.22067689895629883
----------------------check_connections_block total spend ----------------------------- 5.0616295337677
generate_one_block  0.30326199531555176
generate_one_block  0.2963881492614746
generate_one_block  0.2988741397857666
generate_one_block  0.28485798835754395
generate_one_block  0.28035640716552734
generate_one_block  0.27835965156555176
generate_one_block  0.31429100036621094
generate_one_block  0.2809302806854248
generate_one_block  0.2829914093017578
generate_one_block  0.2887413501739502
generate_one_block  0.28221797943115234
generate_one_block  0.2830784320831299
generate_one_block  0.2865917682647705
generate_one_block  0.28217220306396484
generate_one_block  0.2919607162475586
generate_one_block  0.2792980670928955
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034008026123046875
gen group dst list time:  0.06156802177429199
time for parepare:  0.01820516586303711
local_output_nid generation:  0.025330066680908203
local_in_edges_tensor generation:  0.04772543907165527
mini_batch_src_global generation:  0.05500221252441406
r_  generation:  0.45246362686157227
local_output_nid generation:  0.03131818771362305
local_in_edges_tensor generation:  0.033518075942993164
mini_batch_src_global generation:  0.06673932075500488
r_  generation:  0.4633901119232178
local_output_nid generation:  0.03061223030090332
local_in_edges_tensor generation:  0.04190254211425781
mini_batch_src_global generation:  0.051740407943725586
r_  generation:  0.4723632335662842
local_output_nid generation:  0.032421112060546875
local_in_edges_tensor generation:  0.03821587562561035
mini_batch_src_global generation:  0.06795763969421387
r_  generation:  0.45961737632751465
local_output_nid generation:  0.03232693672180176
local_in_edges_tensor generation:  0.08833503723144531
mini_batch_src_global generation:  0.05099964141845703
r_  generation:  0.456040620803833
local_output_nid generation:  0.030511856079101562
local_in_edges_tensor generation:  0.030168771743774414
mini_batch_src_global generation:  0.05273604393005371
r_  generation:  0.45139217376708984
local_output_nid generation:  0.030969858169555664
local_in_edges_tensor generation:  0.030397415161132812
mini_batch_src_global generation:  0.05323076248168945
r_  generation:  0.47542572021484375
local_output_nid generation:  0.03128480911254883
local_in_edges_tensor generation:  0.028961658477783203
mini_batch_src_global generation:  0.0566558837890625
r_  generation:  0.4565303325653076
local_output_nid generation:  0.03280472755432129
local_in_edges_tensor generation:  0.03449273109436035
mini_batch_src_global generation:  0.05368924140930176
r_  generation:  0.4719209671020508
local_output_nid generation:  0.03157925605773926
local_in_edges_tensor generation:  0.0356898307800293
mini_batch_src_global generation:  0.05361151695251465
r_  generation:  0.45876026153564453
local_output_nid generation:  0.03157997131347656
local_in_edges_tensor generation:  0.0287172794342041
mini_batch_src_global generation:  0.05381298065185547
r_  generation:  0.4836924076080322
local_output_nid generation:  0.03628182411193848
local_in_edges_tensor generation:  0.03484344482421875
mini_batch_src_global generation:  0.05567669868469238
r_  generation:  0.45229220390319824
local_output_nid generation:  0.0320127010345459
local_in_edges_tensor generation:  0.03219318389892578
mini_batch_src_global generation:  0.05344963073730469
r_  generation:  0.46227264404296875
local_output_nid generation:  0.032266855239868164
local_in_edges_tensor generation:  0.02869415283203125
mini_batch_src_global generation:  0.05328035354614258
r_  generation:  0.450211763381958
local_output_nid generation:  0.032096147537231445
local_in_edges_tensor generation:  0.03118896484375
mini_batch_src_global generation:  0.05224895477294922
r_  generation:  0.46709561347961426
local_output_nid generation:  0.03195667266845703
local_in_edges_tensor generation:  0.03095269203186035
mini_batch_src_global generation:  0.0527498722076416
r_  generation:  0.4563941955566406
----------------------check_connections_block total spend ----------------------------- 11.033636331558228
generate_one_block  0.6094846725463867
generate_one_block  0.6016900539398193
generate_one_block  0.6028428077697754
generate_one_block  0.6008541584014893
generate_one_block  0.6000592708587646
generate_one_block  0.6045706272125244
generate_one_block  0.6051008701324463
generate_one_block  0.6121423244476318
generate_one_block  0.6393091678619385
generate_one_block  0.5978145599365234
generate_one_block  0.5969276428222656
generate_one_block  0.5980470180511475
generate_one_block  0.5974020957946777
generate_one_block  0.5984916687011719
generate_one_block  0.6162457466125488
generate_one_block  0.5999364852905273
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.134063720703125  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  16.095265865325928
block generation total time  14.29529070854187
average batch blocks generation time:  0.8934556692838669
block dataloader generation time/epoch 32.621628622214
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1107473373413086  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.82799005508423  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11130571365356445  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.27338457107544  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11114168167114258  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.472347736358643  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11123132705688477  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.121932983398438  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11069059371948242  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.017333984375  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11113214492797852  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.97288227081299  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11085891723632812  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.123196125030518  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11114263534545898  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.974163055419922  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11091232299804688  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.107369899749756  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11127328872680664  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.1862211227417  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11102962493896484  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.07824182510376  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11121225357055664  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.062296390533447  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11107587814331055  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.096403121948242  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11118364334106445  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.059834957122803  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11121463775634766  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.442755222320557  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11116933822631836  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.037021160125732  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04314368963241577 |0.013495251536369324 |0.3077528029680252 |9.462237358093262e-05 |0.5577319860458374 |0.0058689117431640625 |
----------------------------------------------------------pseudo_mini_loss sum 1.3196487426757812
Total (block generation + training)time/epoch 47.443301141262054
Training time/epoch 14.798040866851807
Training time without block to device /epoch 14.582116842269897
Training time without total dataloading part /epoch 13.85513949394226
load block tensor time/epoch 0.6902990341186523
block to device time/epoch 0.21592402458190918
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  5090936
Number of first layer input nodes during this epoch:  2471428
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1340336799621582  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022020339965820312
range selection method range initialization spend 0.015903949737548828
time for parepare:  0.020702600479125977
local_output_nid generation:  0.0017590522766113281
local_in_edges_tensor generation:  0.009366989135742188
mini_batch_src_global generation:  0.002289295196533203
r_  generation:  0.019672870635986328
local_output_nid generation:  0.0017349720001220703
local_in_edges_tensor generation:  0.0018284320831298828
mini_batch_src_global generation:  0.0021820068359375
r_  generation:  0.020596981048583984
local_output_nid generation:  0.0017764568328857422
local_in_edges_tensor generation:  0.0012693405151367188
mini_batch_src_global generation:  0.0015881061553955078
r_  generation:  0.01951289176940918
local_output_nid generation:  0.0017604827880859375
local_in_edges_tensor generation:  0.0015909671783447266
mini_batch_src_global generation:  0.0015718936920166016
r_  generation:  0.019251585006713867
local_output_nid generation:  0.0017011165618896484
local_in_edges_tensor generation:  0.0010254383087158203
mini_batch_src_global generation:  0.001499176025390625
r_  generation:  0.019409894943237305
local_output_nid generation:  0.0016813278198242188
local_in_edges_tensor generation:  0.0010180473327636719
mini_batch_src_global generation:  0.0015168190002441406
r_  generation:  0.019610166549682617
local_output_nid generation:  0.0017161369323730469
local_in_edges_tensor generation:  0.0010111331939697266
mini_batch_src_global generation:  0.0017631053924560547
r_  generation:  0.02001667022705078
local_output_nid generation:  0.0017457008361816406
local_in_edges_tensor generation:  0.0009341239929199219
mini_batch_src_global generation:  0.0015614032745361328
r_  generation:  0.019623756408691406
local_output_nid generation:  0.0016896724700927734
local_in_edges_tensor generation:  0.0009279251098632812
mini_batch_src_global generation:  0.00151824951171875
r_  generation:  0.019323110580444336
local_output_nid generation:  0.0016827583312988281
local_in_edges_tensor generation:  0.0009090900421142578
mini_batch_src_global generation:  0.0015320777893066406
r_  generation:  0.019438982009887695
local_output_nid generation:  0.0016841888427734375
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.0015070438385009766
r_  generation:  0.023786306381225586
local_output_nid generation:  0.0018167495727539062
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0027923583984375
r_  generation:  0.021194934844970703
local_output_nid generation:  0.0016400814056396484
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0015926361083984375
r_  generation:  0.01971125602722168
local_output_nid generation:  0.0016703605651855469
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.0015659332275390625
r_  generation:  0.0194551944732666
local_output_nid generation:  0.001659393310546875
local_in_edges_tensor generation:  0.0009291172027587891
mini_batch_src_global generation:  0.0015308856964111328
r_  generation:  0.019360065460205078
local_output_nid generation:  0.0016889572143554688
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.0015113353729248047
r_  generation:  0.019341707229614258
----------------------check_connections_block total spend ----------------------------- 0.497467041015625
generate_one_block  0.03204846382141113
generate_one_block  0.03196001052856445
generate_one_block  0.031505584716796875
generate_one_block  0.031079769134521484
generate_one_block  0.030846595764160156
generate_one_block  0.033716678619384766
generate_one_block  0.032080888748168945
generate_one_block  0.03127861022949219
generate_one_block  0.030695676803588867
generate_one_block  0.03096938133239746
generate_one_block  0.030858278274536133
generate_one_block  0.031009197235107422
generate_one_block  0.031200885772705078
generate_one_block  0.030646800994873047
generate_one_block  0.030740022659301758
generate_one_block  0.03279614448547363
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03292107582092285
gen group dst list time:  0.01721811294555664
time for parepare:  0.02196025848388672
local_output_nid generation:  0.007589817047119141
local_in_edges_tensor generation:  0.020177602767944336
mini_batch_src_global generation:  0.020487070083618164
r_  generation:  0.1925487518310547
local_output_nid generation:  0.010718345642089844
local_in_edges_tensor generation:  0.014067888259887695
mini_batch_src_global generation:  0.024423599243164062
r_  generation:  0.20360231399536133
local_output_nid generation:  0.011085271835327148
local_in_edges_tensor generation:  0.013758420944213867
mini_batch_src_global generation:  0.023974895477294922
r_  generation:  0.20731687545776367
local_output_nid generation:  0.011550426483154297
local_in_edges_tensor generation:  0.012553215026855469
mini_batch_src_global generation:  0.025390148162841797
r_  generation:  0.20821070671081543
local_output_nid generation:  0.012073278427124023
local_in_edges_tensor generation:  0.01300358772277832
mini_batch_src_global generation:  0.025469303131103516
r_  generation:  0.21128559112548828
local_output_nid generation:  0.011855363845825195
local_in_edges_tensor generation:  0.012190580368041992
mini_batch_src_global generation:  0.025986433029174805
r_  generation:  0.21660852432250977
local_output_nid generation:  0.012471914291381836
local_in_edges_tensor generation:  0.011462926864624023
mini_batch_src_global generation:  0.026619434356689453
r_  generation:  0.21410417556762695
local_output_nid generation:  0.01232600212097168
local_in_edges_tensor generation:  0.011683464050292969
mini_batch_src_global generation:  0.027498960494995117
r_  generation:  0.21702122688293457
local_output_nid generation:  0.012423276901245117
local_in_edges_tensor generation:  0.011464118957519531
mini_batch_src_global generation:  0.026826858520507812
r_  generation:  0.21263647079467773
local_output_nid generation:  0.012307167053222656
local_in_edges_tensor generation:  0.011625289916992188
mini_batch_src_global generation:  0.025730371475219727
r_  generation:  0.2162320613861084
local_output_nid generation:  0.012380838394165039
local_in_edges_tensor generation:  0.01155710220336914
mini_batch_src_global generation:  0.026609182357788086
r_  generation:  0.2173452377319336
local_output_nid generation:  0.012631654739379883
local_in_edges_tensor generation:  0.011665582656860352
mini_batch_src_global generation:  0.026043176651000977
r_  generation:  0.21790504455566406
local_output_nid generation:  0.01265096664428711
local_in_edges_tensor generation:  0.012951135635375977
mini_batch_src_global generation:  0.027331113815307617
r_  generation:  0.22341299057006836
local_output_nid generation:  0.013683319091796875
local_in_edges_tensor generation:  0.011915206909179688
mini_batch_src_global generation:  0.0265047550201416
r_  generation:  0.22255969047546387
local_output_nid generation:  0.01281881332397461
local_in_edges_tensor generation:  0.0183107852935791
mini_batch_src_global generation:  0.026907682418823242
r_  generation:  0.22360730171203613
local_output_nid generation:  0.012758731842041016
local_in_edges_tensor generation:  0.014604806900024414
mini_batch_src_global generation:  0.027855634689331055
r_  generation:  0.21905303001403809
----------------------check_connections_block total spend ----------------------------- 5.021256923675537
generate_one_block  0.3079965114593506
generate_one_block  0.28174877166748047
generate_one_block  0.28736114501953125
generate_one_block  0.28450775146484375
generate_one_block  0.2843654155731201
generate_one_block  0.2868936061859131
generate_one_block  0.31435561180114746
generate_one_block  0.28722500801086426
generate_one_block  0.2837388515472412
generate_one_block  0.28305697441101074
generate_one_block  0.3035600185394287
generate_one_block  0.29179835319519043
generate_one_block  0.2964024543762207
generate_one_block  0.2914884090423584
generate_one_block  0.2871222496032715
generate_one_block  0.2827033996582031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037718772888183594
gen group dst list time:  0.0651850700378418
time for parepare:  0.01992011070251465
local_output_nid generation:  0.026240825653076172
local_in_edges_tensor generation:  0.059623003005981445
mini_batch_src_global generation:  0.04245305061340332
r_  generation:  0.4501659870147705
local_output_nid generation:  0.03156900405883789
local_in_edges_tensor generation:  0.03635764122009277
mini_batch_src_global generation:  0.051805734634399414
r_  generation:  0.44946885108947754
local_output_nid generation:  0.030184030532836914
local_in_edges_tensor generation:  0.030291318893432617
mini_batch_src_global generation:  0.05116724967956543
r_  generation:  0.4550635814666748
local_output_nid generation:  0.030210018157958984
local_in_edges_tensor generation:  0.03310894966125488
mini_batch_src_global generation:  0.05205726623535156
r_  generation:  0.45554280281066895
local_output_nid generation:  0.03276252746582031
local_in_edges_tensor generation:  0.0783686637878418
mini_batch_src_global generation:  0.05382871627807617
r_  generation:  0.47878003120422363
local_output_nid generation:  0.0341031551361084
local_in_edges_tensor generation:  0.03455996513366699
mini_batch_src_global generation:  0.05360865592956543
r_  generation:  0.4535996913909912
local_output_nid generation:  0.03204631805419922
local_in_edges_tensor generation:  0.03113412857055664
mini_batch_src_global generation:  0.05407857894897461
r_  generation:  0.45729541778564453
local_output_nid generation:  0.0317380428314209
local_in_edges_tensor generation:  0.029311418533325195
mini_batch_src_global generation:  0.052670955657958984
r_  generation:  0.4518716335296631
local_output_nid generation:  0.031915903091430664
local_in_edges_tensor generation:  0.03127098083496094
mini_batch_src_global generation:  0.05249214172363281
r_  generation:  0.46213555335998535
local_output_nid generation:  0.031913042068481445
local_in_edges_tensor generation:  0.03110337257385254
mini_batch_src_global generation:  0.05287337303161621
r_  generation:  0.46376466751098633
local_output_nid generation:  0.03179216384887695
local_in_edges_tensor generation:  0.029262542724609375
mini_batch_src_global generation:  0.054059743881225586
r_  generation:  0.46737027168273926
local_output_nid generation:  0.03213214874267578
local_in_edges_tensor generation:  0.029525279998779297
mini_batch_src_global generation:  0.05277514457702637
r_  generation:  0.4580049514770508
local_output_nid generation:  0.03173017501831055
local_in_edges_tensor generation:  0.037201881408691406
mini_batch_src_global generation:  0.05187487602233887
r_  generation:  0.4688093662261963
local_output_nid generation:  0.032173871994018555
local_in_edges_tensor generation:  0.034606218338012695
mini_batch_src_global generation:  0.05611777305603027
r_  generation:  0.45734381675720215
local_output_nid generation:  0.03264570236206055
local_in_edges_tensor generation:  0.029495716094970703
mini_batch_src_global generation:  0.052164316177368164
r_  generation:  0.4670834541320801
local_output_nid generation:  0.03253650665283203
local_in_edges_tensor generation:  0.038176536560058594
mini_batch_src_global generation:  0.055161237716674805
r_  generation:  0.45862913131713867
----------------------check_connections_block total spend ----------------------------- 10.897967100143433
generate_one_block  0.6132359504699707
generate_one_block  0.6110482215881348
generate_one_block  0.6037197113037109
generate_one_block  0.6002273559570312
generate_one_block  0.5957942008972168
generate_one_block  0.5983271598815918
generate_one_block  0.5964481830596924
generate_one_block  0.5988640785217285
generate_one_block  0.6341814994812012
generate_one_block  0.5950093269348145
generate_one_block  0.6087584495544434
generate_one_block  0.6025600433349609
generate_one_block  0.6118085384368896
generate_one_block  0.6036210060119629
generate_one_block  0.6049602031707764
generate_one_block  0.6000664234161377
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1340336799621582  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  15.91922402381897
block generation total time  14.33295488357544
average batch blocks generation time:  0.895809680223465
block dataloader generation time/epoch 32.61275082368117
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11099672317504883  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.0849289894104  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11114168167114258  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.038406372070312  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11104488372802734  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.258201122283936  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11121320724487305  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.07201337814331  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11076927185058594  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.08172369003296  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11129331588745117  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.252949714660645  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1110081672668457  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.22527837753296  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11129522323608398  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.26503038406372  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11097526550292969  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.063778400421143  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11110353469848633  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.916868209838867  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1108698844909668  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.071897506713867  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112065315246582  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.076282024383545  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11107969284057617  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.3275728225708  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11121606826782227  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.10302972793579  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11118507385253906  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.158358573913574  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11112737655639648  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.946942806243896  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04356205463409424 |0.013623014092445374 |0.3059232532978058 |9.106099605560303e-05 |0.5488585978746414 |0.002652406692504883 |
----------------------------------------------------------pseudo_mini_loss sum 1.3086682558059692
Total (block generation + training)time/epoch 47.42010965714088
Training time/epoch 14.635401487350464
Training time without block to device /epoch 14.417433261871338
Training time without total dataloading part /epoch 13.68061900138855
load block tensor time/epoch 0.6969928741455078
block to device time/epoch 0.21796822547912598
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  5093123
Number of first layer input nodes during this epoch:  2471914
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.13405370712280273  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021281957626342773
range selection method range initialization spend 0.015967369079589844
time for parepare:  0.018070220947265625
local_output_nid generation:  0.001699209213256836
local_in_edges_tensor generation:  0.00449061393737793
mini_batch_src_global generation:  0.001980304718017578
r_  generation:  0.02095818519592285
local_output_nid generation:  0.001814126968383789
local_in_edges_tensor generation:  0.0012574195861816406
mini_batch_src_global generation:  0.003220796585083008
r_  generation:  0.02733302116394043
local_output_nid generation:  0.0019011497497558594
local_in_edges_tensor generation:  0.0012812614440917969
mini_batch_src_global generation:  0.0018107891082763672
r_  generation:  0.021691083908081055
local_output_nid generation:  0.001878976821899414
local_in_edges_tensor generation:  0.0010180473327636719
mini_batch_src_global generation:  0.0019459724426269531
r_  generation:  0.0214996337890625
local_output_nid generation:  0.0018658638000488281
local_in_edges_tensor generation:  0.0009183883666992188
mini_batch_src_global generation:  0.001855611801147461
r_  generation:  0.02166438102722168
local_output_nid generation:  0.0018208026885986328
local_in_edges_tensor generation:  0.0009140968322753906
mini_batch_src_global generation:  0.0018658638000488281
r_  generation:  0.02162790298461914
local_output_nid generation:  0.0018198490142822266
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.0023772716522216797
r_  generation:  0.021908283233642578
local_output_nid generation:  0.0018825531005859375
local_in_edges_tensor generation:  0.001003265380859375
mini_batch_src_global generation:  0.0019190311431884766
r_  generation:  0.03556370735168457
local_output_nid generation:  0.002508878707885742
local_in_edges_tensor generation:  0.0020220279693603516
mini_batch_src_global generation:  0.0018115043640136719
r_  generation:  0.018143177032470703
local_output_nid generation:  0.0021452903747558594
local_in_edges_tensor generation:  0.0010783672332763672
mini_batch_src_global generation:  0.0015840530395507812
r_  generation:  0.0184783935546875
local_output_nid generation:  0.00417637825012207
local_in_edges_tensor generation:  0.0025911331176757812
mini_batch_src_global generation:  0.010967731475830078
r_  generation:  0.02325892448425293
local_output_nid generation:  0.0018908977508544922
local_in_edges_tensor generation:  0.0009868144989013672
mini_batch_src_global generation:  0.0018470287322998047
r_  generation:  0.033844709396362305
local_output_nid generation:  0.0029535293579101562
local_in_edges_tensor generation:  0.0012257099151611328
mini_batch_src_global generation:  0.005338430404663086
r_  generation:  0.023005247116088867
local_output_nid generation:  0.0017659664154052734
local_in_edges_tensor generation:  0.0009589195251464844
mini_batch_src_global generation:  0.001932382583618164
r_  generation:  0.022182703018188477
local_output_nid generation:  0.0017848014831542969
local_in_edges_tensor generation:  0.0011525154113769531
mini_batch_src_global generation:  0.002004861831665039
r_  generation:  0.02230072021484375
local_output_nid generation:  0.0017669200897216797
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0019066333770751953
r_  generation:  0.022395610809326172
----------------------check_connections_block total spend ----------------------------- 0.5849685668945312
generate_one_block  0.032109737396240234
generate_one_block  0.03274202346801758
generate_one_block  0.03374361991882324
generate_one_block  0.03277873992919922
generate_one_block  0.04613089561462402
generate_one_block  0.034178733825683594
generate_one_block  0.055400848388671875
generate_one_block  0.03582429885864258
generate_one_block  0.032843589782714844
generate_one_block  0.03184843063354492
generate_one_block  0.03067183494567871
generate_one_block  0.052651405334472656
generate_one_block  0.03368091583251953
generate_one_block  0.031357526779174805
generate_one_block  0.03193259239196777
generate_one_block  0.03296780586242676
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03513598442077637
gen group dst list time:  0.020058155059814453
time for parepare:  0.021036863327026367
local_output_nid generation:  0.007361173629760742
local_in_edges_tensor generation:  0.02558732032775879
mini_batch_src_global generation:  0.022022724151611328
r_  generation:  0.22716116905212402
local_output_nid generation:  0.0106658935546875
local_in_edges_tensor generation:  0.013606548309326172
mini_batch_src_global generation:  0.02812790870666504
r_  generation:  0.2063312530517578
local_output_nid generation:  0.011272430419921875
local_in_edges_tensor generation:  0.012758016586303711
mini_batch_src_global generation:  0.025739669799804688
r_  generation:  0.2109062671661377
local_output_nid generation:  0.011699914932250977
local_in_edges_tensor generation:  0.011569976806640625
mini_batch_src_global generation:  0.02593708038330078
r_  generation:  0.21174955368041992
local_output_nid generation:  0.012095451354980469
local_in_edges_tensor generation:  0.011235713958740234
mini_batch_src_global generation:  0.026592493057250977
r_  generation:  0.21857976913452148
local_output_nid generation:  0.011474847793579102
local_in_edges_tensor generation:  0.010894298553466797
mini_batch_src_global generation:  0.026858806610107422
r_  generation:  0.21180129051208496
local_output_nid generation:  0.01205897331237793
local_in_edges_tensor generation:  0.011284589767456055
mini_batch_src_global generation:  0.027341842651367188
r_  generation:  0.21789288520812988
local_output_nid generation:  0.012355566024780273
local_in_edges_tensor generation:  0.015172004699707031
mini_batch_src_global generation:  0.028110265731811523
r_  generation:  0.27205395698547363
local_output_nid generation:  0.012154340744018555
local_in_edges_tensor generation:  0.011252641677856445
mini_batch_src_global generation:  0.045134782791137695
r_  generation:  0.2167820930480957
local_output_nid generation:  0.01212167739868164
local_in_edges_tensor generation:  0.013036251068115234
mini_batch_src_global generation:  0.02653646469116211
r_  generation:  0.21810674667358398
local_output_nid generation:  0.012288331985473633
local_in_edges_tensor generation:  0.011504888534545898
mini_batch_src_global generation:  0.027520179748535156
r_  generation:  0.2220451831817627
local_output_nid generation:  0.012539863586425781
local_in_edges_tensor generation:  0.014055490493774414
mini_batch_src_global generation:  0.027039527893066406
r_  generation:  0.22217583656311035
local_output_nid generation:  0.0126190185546875
local_in_edges_tensor generation:  0.01646113395690918
mini_batch_src_global generation:  0.028835773468017578
r_  generation:  0.2244868278503418
local_output_nid generation:  0.012794971466064453
local_in_edges_tensor generation:  0.014622688293457031
mini_batch_src_global generation:  0.029051542282104492
r_  generation:  0.22186923027038574
local_output_nid generation:  0.013790130615234375
local_in_edges_tensor generation:  0.012657642364501953
mini_batch_src_global generation:  0.027977943420410156
r_  generation:  0.23608040809631348
local_output_nid generation:  0.015302658081054688
local_in_edges_tensor generation:  0.01548147201538086
mini_batch_src_global generation:  0.027810335159301758
r_  generation:  0.2232193946838379
----------------------check_connections_block total spend ----------------------------- 5.217978000640869
generate_one_block  0.2987215518951416
generate_one_block  0.2807450294494629
generate_one_block  0.28762102127075195
generate_one_block  0.2811884880065918
generate_one_block  0.29048705101013184
generate_one_block  0.27987122535705566
generate_one_block  0.3131136894226074
generate_one_block  0.2936677932739258
generate_one_block  0.2967207431793213
generate_one_block  0.28095149993896484
generate_one_block  0.2886786460876465
generate_one_block  0.2852621078491211
generate_one_block  0.28971004486083984
generate_one_block  0.3014404773712158
generate_one_block  0.2902858257293701
generate_one_block  0.29067325592041016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0333402156829834
gen group dst list time:  0.06510567665100098
time for parepare:  0.019042491912841797
local_output_nid generation:  0.026845693588256836
local_in_edges_tensor generation:  0.048801422119140625
mini_batch_src_global generation:  0.04147005081176758
r_  generation:  0.4591844081878662
local_output_nid generation:  0.034650325775146484
local_in_edges_tensor generation:  0.03107905387878418
mini_batch_src_global generation:  0.05180001258850098
r_  generation:  0.45081114768981934
local_output_nid generation:  0.03184247016906738
local_in_edges_tensor generation:  0.03217172622680664
mini_batch_src_global generation:  0.052643537521362305
r_  generation:  0.4557676315307617
local_output_nid generation:  0.03203010559082031
local_in_edges_tensor generation:  0.03259444236755371
mini_batch_src_global generation:  0.05241513252258301
r_  generation:  0.4514176845550537
local_output_nid generation:  0.032057762145996094
local_in_edges_tensor generation:  0.08082723617553711
mini_batch_src_global generation:  0.05104780197143555
r_  generation:  0.46367835998535156
local_output_nid generation:  0.030868053436279297
local_in_edges_tensor generation:  0.028464317321777344
mini_batch_src_global generation:  0.05304408073425293
r_  generation:  0.45249223709106445
local_output_nid generation:  0.030954837799072266
local_in_edges_tensor generation:  0.02894282341003418
mini_batch_src_global generation:  0.051697731018066406
r_  generation:  0.4623253345489502
local_output_nid generation:  0.03113245964050293
local_in_edges_tensor generation:  0.03430795669555664
mini_batch_src_global generation:  0.053080081939697266
r_  generation:  0.45656418800354004
local_output_nid generation:  0.031153202056884766
local_in_edges_tensor generation:  0.030478715896606445
mini_batch_src_global generation:  0.05166459083557129
r_  generation:  0.4704766273498535
local_output_nid generation:  0.03390216827392578
local_in_edges_tensor generation:  0.027990102767944336
mini_batch_src_global generation:  0.0531613826751709
r_  generation:  0.4559922218322754
local_output_nid generation:  0.031197071075439453
local_in_edges_tensor generation:  0.02987194061279297
mini_batch_src_global generation:  0.053730010986328125
r_  generation:  0.46515583992004395
local_output_nid generation:  0.03131723403930664
local_in_edges_tensor generation:  0.03131604194641113
mini_batch_src_global generation:  0.0535273551940918
r_  generation:  0.46306324005126953
local_output_nid generation:  0.03361105918884277
local_in_edges_tensor generation:  0.03143024444580078
mini_batch_src_global generation:  0.05345630645751953
r_  generation:  0.46510982513427734
local_output_nid generation:  0.03167319297790527
local_in_edges_tensor generation:  0.03516554832458496
mini_batch_src_global generation:  0.05310988426208496
r_  generation:  0.45979881286621094
local_output_nid generation:  0.03188490867614746
local_in_edges_tensor generation:  0.033037424087524414
mini_batch_src_global generation:  0.052008867263793945
r_  generation:  0.46650171279907227
local_output_nid generation:  0.034110069274902344
local_in_edges_tensor generation:  0.03234553337097168
mini_batch_src_global generation:  0.05332541465759277
r_  generation:  0.4597287178039551
----------------------check_connections_block total spend ----------------------------- 10.881273746490479
generate_one_block  0.617194652557373
generate_one_block  0.5997953414916992
generate_one_block  0.5994460582733154
generate_one_block  0.6034388542175293
generate_one_block  0.6012167930603027
generate_one_block  0.5972824096679688
generate_one_block  0.5983891487121582
generate_one_block  0.6158204078674316
generate_one_block  0.6294300556182861
generate_one_block  0.5919134616851807
generate_one_block  0.6083521842956543
generate_one_block  0.5939710140228271
generate_one_block  0.6016459465026855
generate_one_block  0.6137175559997559
generate_one_block  0.6029307842254639
generate_one_block  0.604917049407959
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.13405370712280273  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  16.099251747131348
block generation total time  14.32860016822815
average batch blocks generation time:  0.8955375105142593
block dataloader generation time/epoch 32.63144336427961
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11113691329956055  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.155912399291992  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11114358901977539  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.967670917510986  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112065315246582  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.289315700531006  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11118745803833008  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.055137634277344  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11109352111816406  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.28483772277832  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11109018325805664  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.91153860092163  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1110696792602539  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.166677474975586  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11127424240112305  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.198939323425293  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1109151840209961  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.8887939453125  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11107015609741211  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.890725135803223  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11106204986572266  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.117854118347168  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11109590530395508  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.89830446243286  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11125040054321289  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.199808597564697  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11130380630493164  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.277692317962646  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11113309860229492  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.321666717529297  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11131525039672852  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.31101131439209  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04279366135597229 |0.013495028018951416 |0.3065437376499176 |9.179115295410156e-05 |0.5589184612035751 |0.005773305892944336 |
----------------------------------------------------------pseudo_mini_loss sum 1.2849948406219482
Total (block generation + training)time/epoch 47.43769119467054
Training time/epoch 14.791563272476196
Training time without block to device /epoch 14.575642824172974
Training time without total dataloading part /epoch 13.854637145996094
load block tensor time/epoch 0.6846985816955566
block to device time/epoch 0.21592044830322266
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  5094141
Number of first layer input nodes during this epoch:  2472941
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1339106559753418  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02166271209716797
range selection method range initialization spend 0.01612257957458496
time for parepare:  0.01952981948852539
local_output_nid generation:  0.001646280288696289
local_in_edges_tensor generation:  0.0055425167083740234
mini_batch_src_global generation:  0.0034999847412109375
r_  generation:  0.02267622947692871
local_output_nid generation:  0.00205230712890625
local_in_edges_tensor generation:  0.0013153553009033203
mini_batch_src_global generation:  0.002129077911376953
r_  generation:  0.019181489944458008
local_output_nid generation:  0.001979827880859375
local_in_edges_tensor generation:  0.0010330677032470703
mini_batch_src_global generation:  0.0014612674713134766
r_  generation:  0.017187118530273438
local_output_nid generation:  0.0019698143005371094
local_in_edges_tensor generation:  0.0011131763458251953
mini_batch_src_global generation:  0.0014865398406982422
r_  generation:  0.01754927635192871
local_output_nid generation:  0.0019516944885253906
local_in_edges_tensor generation:  0.0014081001281738281
mini_batch_src_global generation:  0.0016415119171142578
r_  generation:  0.018052101135253906
local_output_nid generation:  0.0019767284393310547
local_in_edges_tensor generation:  0.0010364055633544922
mini_batch_src_global generation:  0.0013620853424072266
r_  generation:  0.018141746520996094
local_output_nid generation:  0.001997709274291992
local_in_edges_tensor generation:  0.0010714530944824219
mini_batch_src_global generation:  0.0016028881072998047
r_  generation:  0.018251895904541016
local_output_nid generation:  0.001964092254638672
local_in_edges_tensor generation:  0.001024007797241211
mini_batch_src_global generation:  0.0015001296997070312
r_  generation:  0.01827096939086914
local_output_nid generation:  0.0019583702087402344
local_in_edges_tensor generation:  0.0010504722595214844
mini_batch_src_global generation:  0.0016455650329589844
r_  generation:  0.018215656280517578
local_output_nid generation:  0.001975536346435547
local_in_edges_tensor generation:  0.001131296157836914
mini_batch_src_global generation:  0.0013813972473144531
r_  generation:  0.018707752227783203
local_output_nid generation:  0.001986980438232422
local_in_edges_tensor generation:  0.0011317729949951172
mini_batch_src_global generation:  0.0017108917236328125
r_  generation:  0.018952131271362305
local_output_nid generation:  0.001969575881958008
local_in_edges_tensor generation:  0.0010516643524169922
mini_batch_src_global generation:  0.0014858245849609375
r_  generation:  0.01845717430114746
local_output_nid generation:  0.001974821090698242
local_in_edges_tensor generation:  0.0017507076263427734
mini_batch_src_global generation:  0.010010004043579102
r_  generation:  0.024289369583129883
local_output_nid generation:  0.0021855831146240234
local_in_edges_tensor generation:  0.0011141300201416016
mini_batch_src_global generation:  0.0019330978393554688
r_  generation:  0.02024364471435547
local_output_nid generation:  0.00185394287109375
local_in_edges_tensor generation:  0.0009579658508300781
mini_batch_src_global generation:  0.0015904903411865234
r_  generation:  0.0199127197265625
local_output_nid generation:  0.0017325878143310547
local_in_edges_tensor generation:  0.0010058879852294922
mini_batch_src_global generation:  0.0015540122985839844
r_  generation:  0.019774436950683594
----------------------check_connections_block total spend ----------------------------- 0.49976444244384766
generate_one_block  0.03232979774475098
generate_one_block  0.030857086181640625
generate_one_block  0.03038477897644043
generate_one_block  0.030632972717285156
generate_one_block  0.031452178955078125
generate_one_block  0.03346395492553711
generate_one_block  0.03163599967956543
generate_one_block  0.03049325942993164
generate_one_block  0.03084278106689453
generate_one_block  0.030913114547729492
generate_one_block  0.03145146369934082
generate_one_block  0.03099536895751953
generate_one_block  0.03124260902404785
generate_one_block  0.03132033348083496
generate_one_block  0.031473636627197266
generate_one_block  0.03331637382507324
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03205251693725586
gen group dst list time:  0.017380237579345703
time for parepare:  0.021297931671142578
local_output_nid generation:  0.0074541568756103516
local_in_edges_tensor generation:  0.018938541412353516
mini_batch_src_global generation:  0.020854711532592773
r_  generation:  0.1945812702178955
local_output_nid generation:  0.010632753372192383
local_in_edges_tensor generation:  0.012928247451782227
mini_batch_src_global generation:  0.024236440658569336
r_  generation:  0.20140790939331055
local_output_nid generation:  0.010820865631103516
local_in_edges_tensor generation:  0.011337518692016602
mini_batch_src_global generation:  0.023068904876708984
r_  generation:  0.20333576202392578
local_output_nid generation:  0.01137542724609375
local_in_edges_tensor generation:  0.012477874755859375
mini_batch_src_global generation:  0.024387598037719727
r_  generation:  0.20769858360290527
local_output_nid generation:  0.011901140213012695
local_in_edges_tensor generation:  0.013315200805664062
mini_batch_src_global generation:  0.026292085647583008
r_  generation:  0.2148582935333252
local_output_nid generation:  0.011460304260253906
local_in_edges_tensor generation:  0.011196136474609375
mini_batch_src_global generation:  0.026070833206176758
r_  generation:  0.2119147777557373
local_output_nid generation:  0.012215852737426758
local_in_edges_tensor generation:  0.011044740676879883
mini_batch_src_global generation:  0.026635169982910156
r_  generation:  0.2172842025756836
local_output_nid generation:  0.012032508850097656
local_in_edges_tensor generation:  0.011265754699707031
mini_batch_src_global generation:  0.025799274444580078
r_  generation:  0.20815658569335938
local_output_nid generation:  0.012130498886108398
local_in_edges_tensor generation:  0.011311054229736328
mini_batch_src_global generation:  0.027446269989013672
r_  generation:  0.21793127059936523
local_output_nid generation:  0.012319087982177734
local_in_edges_tensor generation:  0.012833356857299805
mini_batch_src_global generation:  0.02618408203125
r_  generation:  0.2140963077545166
local_output_nid generation:  0.012395381927490234
local_in_edges_tensor generation:  0.011318683624267578
mini_batch_src_global generation:  0.0272216796875
r_  generation:  0.22197580337524414
local_output_nid generation:  0.012334823608398438
local_in_edges_tensor generation:  0.011458396911621094
mini_batch_src_global generation:  0.026747941970825195
r_  generation:  0.21676325798034668
local_output_nid generation:  0.012356281280517578
local_in_edges_tensor generation:  0.013007879257202148
mini_batch_src_global generation:  0.026410341262817383
r_  generation:  0.21876049041748047
local_output_nid generation:  0.014080524444580078
local_in_edges_tensor generation:  0.011502742767333984
mini_batch_src_global generation:  0.027127981185913086
r_  generation:  0.22185063362121582
local_output_nid generation:  0.015089273452758789
local_in_edges_tensor generation:  0.012962102890014648
mini_batch_src_global generation:  0.028254032135009766
r_  generation:  0.22644758224487305
local_output_nid generation:  0.012591361999511719
local_in_edges_tensor generation:  0.020426511764526367
mini_batch_src_global generation:  0.027769088745117188
r_  generation:  0.2234349250793457
----------------------check_connections_block total spend ----------------------------- 5.007331132888794
generate_one_block  0.30484724044799805
generate_one_block  0.2900679111480713
generate_one_block  0.28292155265808105
generate_one_block  0.2810347080230713
generate_one_block  0.2920994758605957
generate_one_block  0.28069519996643066
generate_one_block  0.31830406188964844
generate_one_block  0.276822566986084
generate_one_block  0.28226661682128906
generate_one_block  0.2858004570007324
generate_one_block  0.2910022735595703
generate_one_block  0.28685426712036133
generate_one_block  0.2959887981414795
generate_one_block  0.2937006950378418
generate_one_block  0.2924830913543701
generate_one_block  0.2903599739074707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033380985260009766
gen group dst list time:  0.06569218635559082
time for parepare:  0.01914525032043457
local_output_nid generation:  0.02563953399658203
local_in_edges_tensor generation:  0.04628181457519531
mini_batch_src_global generation:  0.04188966751098633
r_  generation:  0.4512619972229004
local_output_nid generation:  0.031356096267700195
local_in_edges_tensor generation:  0.03632950782775879
mini_batch_src_global generation:  0.055936336517333984
r_  generation:  0.45359158515930176
local_output_nid generation:  0.03094768524169922
local_in_edges_tensor generation:  0.032813072204589844
mini_batch_src_global generation:  0.05087876319885254
r_  generation:  0.4652078151702881
local_output_nid generation:  0.03214097023010254
local_in_edges_tensor generation:  0.03173947334289551
mini_batch_src_global generation:  0.05195355415344238
r_  generation:  0.4510343074798584
local_output_nid generation:  0.03167986869812012
local_in_edges_tensor generation:  0.08733558654785156
mini_batch_src_global generation:  0.05109572410583496
r_  generation:  0.45903992652893066
local_output_nid generation:  0.03088521957397461
local_in_edges_tensor generation:  0.028612136840820312
mini_batch_src_global generation:  0.052782535552978516
r_  generation:  0.4551997184753418
local_output_nid generation:  0.0308992862701416
local_in_edges_tensor generation:  0.02899932861328125
mini_batch_src_global generation:  0.05326223373413086
r_  generation:  0.46221923828125
local_output_nid generation:  0.030806779861450195
local_in_edges_tensor generation:  0.0287320613861084
mini_batch_src_global generation:  0.05306696891784668
r_  generation:  0.46645140647888184
local_output_nid generation:  0.030780792236328125
local_in_edges_tensor generation:  0.030152082443237305
mini_batch_src_global generation:  0.05353546142578125
r_  generation:  0.464064359664917
local_output_nid generation:  0.030576229095458984
local_in_edges_tensor generation:  0.0329279899597168
mini_batch_src_global generation:  0.053244590759277344
r_  generation:  0.45833754539489746
local_output_nid generation:  0.03096461296081543
local_in_edges_tensor generation:  0.03059077262878418
mini_batch_src_global generation:  0.05173635482788086
r_  generation:  0.4613018035888672
local_output_nid generation:  0.031228303909301758
local_in_edges_tensor generation:  0.037918806076049805
mini_batch_src_global generation:  0.05316877365112305
r_  generation:  0.4545471668243408
local_output_nid generation:  0.031182527542114258
local_in_edges_tensor generation:  0.03181171417236328
mini_batch_src_global generation:  0.05394411087036133
r_  generation:  0.4600703716278076
local_output_nid generation:  0.03099513053894043
local_in_edges_tensor generation:  0.032402753829956055
mini_batch_src_global generation:  0.05289745330810547
r_  generation:  0.4554741382598877
local_output_nid generation:  0.03137946128845215
local_in_edges_tensor generation:  0.03250527381896973
mini_batch_src_global generation:  0.05416297912597656
r_  generation:  0.45891880989074707
local_output_nid generation:  0.031049251556396484
local_in_edges_tensor generation:  0.030930280685424805
mini_batch_src_global generation:  0.053987979888916016
r_  generation:  0.46981072425842285
----------------------check_connections_block total spend ----------------------------- 10.888223648071289
generate_one_block  0.6108675003051758
generate_one_block  0.595001220703125
generate_one_block  0.5930137634277344
generate_one_block  0.5929081439971924
generate_one_block  0.6040940284729004
generate_one_block  0.594454288482666
generate_one_block  0.6042585372924805
generate_one_block  0.5924806594848633
generate_one_block  0.641486644744873
generate_one_block  0.6000316143035889
generate_one_block  0.601510763168335
generate_one_block  0.6002440452575684
generate_one_block  0.599360466003418
generate_one_block  0.6017985343933105
generate_one_block  0.6067192554473877
generate_one_block  0.5976510047912598
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1339106559753418  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  15.895554780960083
block generation total time  14.281129360198975
average batch blocks generation time:  0.8925705850124359
block dataloader generation time/epoch 32.62170360883077
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11093854904174805  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.09462881088257  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11116456985473633  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.003477573394775  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11102104187011719  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.95754098892212  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1111607551574707  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.027509212493896  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11109685897827148  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.352258682250977  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11116838455200195  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.02277183532715  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11098098754882812  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.267257690429688  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11099481582641602  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.76773977279663  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11102962493896484  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.145545482635498  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11119222640991211  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.08072328567505  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11100625991821289  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.273271560668945  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11116647720336914  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.999831199645996  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11092662811279297  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.01582908630371  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112980842590332  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.248576641082764  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11101675033569336  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.312710762023926  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11117792129516602  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.066299438476562  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.042707815766334534 |0.014506682753562927 |0.3047567903995514 |9.06139612197876e-05 |0.5585543364286423 |0.004287004470825195 |
----------------------------------------------------------pseudo_mini_loss sum 1.2733708620071411
Total (block generation + training)time/epoch 47.4257702032725
Training time/epoch 14.773292064666748
Training time without block to device /epoch 14.541185140609741
Training time without total dataloading part /epoch 13.81871485710144
load block tensor time/epoch 0.6833250522613525
block to device time/epoch 0.23210692405700684
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  5090930
Number of first layer input nodes during this epoch:  2470806
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.13475561141967773  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02090930938720703
range selection method range initialization spend 0.013668298721313477
time for parepare:  0.018324613571166992
local_output_nid generation:  0.0017025470733642578
local_in_edges_tensor generation:  0.008363723754882812
mini_batch_src_global generation:  0.003675222396850586
r_  generation:  0.020551443099975586
local_output_nid generation:  0.002186298370361328
local_in_edges_tensor generation:  0.0014109611511230469
mini_batch_src_global generation:  0.0025663375854492188
r_  generation:  0.02027750015258789
local_output_nid generation:  0.0021719932556152344
local_in_edges_tensor generation:  0.0010488033294677734
mini_batch_src_global generation:  0.0014891624450683594
r_  generation:  0.01877307891845703
local_output_nid generation:  0.0020842552185058594
local_in_edges_tensor generation:  0.0012812614440917969
mini_batch_src_global generation:  0.0014472007751464844
r_  generation:  0.018720626831054688
local_output_nid generation:  0.0020325183868408203
local_in_edges_tensor generation:  0.0011377334594726562
mini_batch_src_global generation:  0.0015773773193359375
r_  generation:  0.019165754318237305
local_output_nid generation:  0.0020351409912109375
local_in_edges_tensor generation:  0.0009925365447998047
mini_batch_src_global generation:  0.0015444755554199219
r_  generation:  0.018980979919433594
local_output_nid generation:  0.0019500255584716797
local_in_edges_tensor generation:  0.0013720989227294922
mini_batch_src_global generation:  0.0016679763793945312
r_  generation:  0.01964855194091797
local_output_nid generation:  0.0028688907623291016
local_in_edges_tensor generation:  0.0012693405151367188
mini_batch_src_global generation:  0.008740901947021484
r_  generation:  0.03403210639953613
local_output_nid generation:  0.002076864242553711
local_in_edges_tensor generation:  0.0012140274047851562
mini_batch_src_global generation:  0.0016214847564697266
r_  generation:  0.019431591033935547
local_output_nid generation:  0.0018584728240966797
local_in_edges_tensor generation:  0.0010728836059570312
mini_batch_src_global generation:  0.0015914440155029297
r_  generation:  0.019152402877807617
local_output_nid generation:  0.001924753189086914
local_in_edges_tensor generation:  0.0010271072387695312
mini_batch_src_global generation:  0.0017468929290771484
r_  generation:  0.019884586334228516
local_output_nid generation:  0.001905679702758789
local_in_edges_tensor generation:  0.000997781753540039
mini_batch_src_global generation:  0.0015714168548583984
r_  generation:  0.019322872161865234
local_output_nid generation:  0.0021021366119384766
local_in_edges_tensor generation:  0.001064300537109375
mini_batch_src_global generation:  0.005091667175292969
r_  generation:  0.026636600494384766
local_output_nid generation:  0.0018537044525146484
local_in_edges_tensor generation:  0.0009491443634033203
mini_batch_src_global generation:  0.0019137859344482422
r_  generation:  0.021755218505859375
local_output_nid generation:  0.0017142295837402344
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.001581430435180664
r_  generation:  0.019515275955200195
local_output_nid generation:  0.0016760826110839844
local_in_edges_tensor generation:  0.0008938312530517578
mini_batch_src_global generation:  0.0015518665313720703
r_  generation:  0.01934218406677246
----------------------check_connections_block total spend ----------------------------- 0.5393002033233643
generate_one_block  0.032037973403930664
generate_one_block  0.030963420867919922
generate_one_block  0.030975341796875
generate_one_block  0.03103351593017578
generate_one_block  0.03134894371032715
generate_one_block  0.033063650131225586
generate_one_block  0.032096147537231445
generate_one_block  0.03149771690368652
generate_one_block  0.03094005584716797
generate_one_block  0.030816316604614258
generate_one_block  0.03136634826660156
generate_one_block  0.031141042709350586
generate_one_block  0.031007051467895508
generate_one_block  0.03136944770812988
generate_one_block  0.03075861930847168
generate_one_block  0.0312647819519043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032431840896606445
gen group dst list time:  0.017024517059326172
time for parepare:  0.02108454704284668
local_output_nid generation:  0.007601261138916016
local_in_edges_tensor generation:  0.018510103225708008
mini_batch_src_global generation:  0.020508527755737305
r_  generation:  0.19313597679138184
local_output_nid generation:  0.0105133056640625
local_in_edges_tensor generation:  0.013005495071411133
mini_batch_src_global generation:  0.02928328514099121
r_  generation:  0.1979074478149414
local_output_nid generation:  0.010815858840942383
local_in_edges_tensor generation:  0.013269901275634766
mini_batch_src_global generation:  0.022943496704101562
r_  generation:  0.2015237808227539
local_output_nid generation:  0.011686563491821289
local_in_edges_tensor generation:  0.012768745422363281
mini_batch_src_global generation:  0.024173974990844727
r_  generation:  0.20574235916137695
local_output_nid generation:  0.012099981307983398
local_in_edges_tensor generation:  0.01306915283203125
mini_batch_src_global generation:  0.0262601375579834
r_  generation:  0.21875
local_output_nid generation:  0.011745214462280273
local_in_edges_tensor generation:  0.011476516723632812
mini_batch_src_global generation:  0.028520822525024414
r_  generation:  0.2105391025543213
local_output_nid generation:  0.012359619140625
local_in_edges_tensor generation:  0.011561870574951172
mini_batch_src_global generation:  0.026703834533691406
r_  generation:  0.2176823616027832
local_output_nid generation:  0.012296676635742188
local_in_edges_tensor generation:  0.01303863525390625
mini_batch_src_global generation:  0.026607036590576172
r_  generation:  0.21440625190734863
local_output_nid generation:  0.012130498886108398
local_in_edges_tensor generation:  0.011518478393554688
mini_batch_src_global generation:  0.026268482208251953
r_  generation:  0.2142488956451416
local_output_nid generation:  0.012153387069702148
local_in_edges_tensor generation:  0.01166677474975586
mini_batch_src_global generation:  0.026587963104248047
r_  generation:  0.21572208404541016
local_output_nid generation:  0.012201070785522461
local_in_edges_tensor generation:  0.012287616729736328
mini_batch_src_global generation:  0.027858495712280273
r_  generation:  0.22213220596313477
local_output_nid generation:  0.01248621940612793
local_in_edges_tensor generation:  0.011897802352905273
mini_batch_src_global generation:  0.026587486267089844
r_  generation:  0.21573877334594727
local_output_nid generation:  0.012488603591918945
local_in_edges_tensor generation:  0.011554956436157227
mini_batch_src_global generation:  0.026627063751220703
r_  generation:  0.21786761283874512
local_output_nid generation:  0.012542486190795898
local_in_edges_tensor generation:  0.011499881744384766
mini_batch_src_global generation:  0.028739213943481445
r_  generation:  0.2148444652557373
local_output_nid generation:  0.012246131896972656
local_in_edges_tensor generation:  0.011608600616455078
mini_batch_src_global generation:  0.026351451873779297
r_  generation:  0.21360993385314941
local_output_nid generation:  0.012521505355834961
local_in_edges_tensor generation:  0.012451887130737305
mini_batch_src_global generation:  0.02739858627319336
r_  generation:  0.21529626846313477
----------------------check_connections_block total spend ----------------------------- 4.96572208404541
generate_one_block  0.28723669052124023
generate_one_block  0.2750053405761719
generate_one_block  0.27283477783203125
generate_one_block  0.2759697437286377
generate_one_block  0.28945469856262207
generate_one_block  0.2806839942932129
generate_one_block  0.3118579387664795
generate_one_block  0.28643798828125
generate_one_block  0.27782320976257324
generate_one_block  0.28438782691955566
generate_one_block  0.2886228561401367
generate_one_block  0.2846999168395996
generate_one_block  0.27894139289855957
generate_one_block  0.28386831283569336
generate_one_block  0.2782106399536133
generate_one_block  0.29098057746887207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03319883346557617
gen group dst list time:  0.06256437301635742
time for parepare:  0.017857789993286133
local_output_nid generation:  0.029305696487426758
local_in_edges_tensor generation:  0.04206132888793945
mini_batch_src_global generation:  0.040743350982666016
r_  generation:  0.45539093017578125
local_output_nid generation:  0.03306388854980469
local_in_edges_tensor generation:  0.03697633743286133
mini_batch_src_global generation:  0.05227398872375488
r_  generation:  0.45346975326538086
local_output_nid generation:  0.03058791160583496
local_in_edges_tensor generation:  0.03250861167907715
mini_batch_src_global generation:  0.05277228355407715
r_  generation:  0.47307753562927246
local_output_nid generation:  0.03339719772338867
local_in_edges_tensor generation:  0.032132625579833984
mini_batch_src_global generation:  0.05528736114501953
r_  generation:  0.445798397064209
local_output_nid generation:  0.031880855560302734
local_in_edges_tensor generation:  0.08662748336791992
mini_batch_src_global generation:  0.0532686710357666
r_  generation:  0.45897746086120605
local_output_nid generation:  0.031224489212036133
local_in_edges_tensor generation:  0.030963659286499023
mini_batch_src_global generation:  0.052800893783569336
r_  generation:  0.45273566246032715
local_output_nid generation:  0.030772924423217773
local_in_edges_tensor generation:  0.02891230583190918
mini_batch_src_global generation:  0.0514063835144043
r_  generation:  0.4603080749511719
local_output_nid generation:  0.030707120895385742
local_in_edges_tensor generation:  0.030510663986206055
mini_batch_src_global generation:  0.05450773239135742
r_  generation:  0.4677248001098633
local_output_nid generation:  0.030693531036376953
local_in_edges_tensor generation:  0.028473615646362305
mini_batch_src_global generation:  0.051964521408081055
r_  generation:  0.4593985080718994
local_output_nid generation:  0.032920122146606445
local_in_edges_tensor generation:  0.029004812240600586
mini_batch_src_global generation:  0.05304360389709473
r_  generation:  0.4577314853668213
local_output_nid generation:  0.030964136123657227
local_in_edges_tensor generation:  0.03426337242126465
mini_batch_src_global generation:  0.05192065238952637
r_  generation:  0.46370601654052734
local_output_nid generation:  0.03213095664978027
local_in_edges_tensor generation:  0.04017162322998047
mini_batch_src_global generation:  0.05307364463806152
r_  generation:  0.46377110481262207
local_output_nid generation:  0.03344368934631348
local_in_edges_tensor generation:  0.030972719192504883
mini_batch_src_global generation:  0.05427050590515137
r_  generation:  0.46737027168273926
local_output_nid generation:  0.031115293502807617
local_in_edges_tensor generation:  0.030501842498779297
mini_batch_src_global generation:  0.05487203598022461
r_  generation:  0.4568667411804199
local_output_nid generation:  0.031047344207763672
local_in_edges_tensor generation:  0.03086376190185547
mini_batch_src_global generation:  0.05331301689147949
r_  generation:  0.46222615242004395
local_output_nid generation:  0.032706260681152344
local_in_edges_tensor generation:  0.03559374809265137
mini_batch_src_global generation:  0.05342364311218262
r_  generation:  0.478226900100708
----------------------check_connections_block total spend ----------------------------- 10.917914867401123
generate_one_block  0.6089286804199219
generate_one_block  0.5913338661193848
generate_one_block  0.587061882019043
generate_one_block  0.5867536067962646
generate_one_block  0.5941648483276367
generate_one_block  0.5942294597625732
generate_one_block  0.5973315238952637
generate_one_block  0.5989601612091064
generate_one_block  0.6288762092590332
generate_one_block  0.6003472805023193
generate_one_block  0.5999529361724854
generate_one_block  0.6039190292358398
generate_one_block  0.5975470542907715
generate_one_block  0.5934336185455322
generate_one_block  0.5950241088867188
generate_one_block  0.5923366546630859
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.13475561141967773  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  15.883636951446533
block generation total time  14.11721682548523
average batch blocks generation time:  0.8823260515928268
block dataloader generation time/epoch 32.59906330704689
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11103630065917969  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.181396484375  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11110734939575195  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.932689666748047  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11084318161010742  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.891579627990723  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11111307144165039  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.941689491271973  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11117887496948242  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.316284656524658  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1111454963684082  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.01609516143799  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11112117767333984  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.297297477722168  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11130666732788086  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.238470554351807  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11087846755981445  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.938222885131836  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11125516891479492  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.16594123840332  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11099052429199219  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.34190082550049  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11128950119018555  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.25624179840088  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11101102828979492  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.047805786132812  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11122274398803711  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.12070322036743  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1107940673828125  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.928968906402588  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11122465133666992  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.12808609008789  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04212452471256256 |0.013179570436477661 |0.3032914698123932 |9.129941463470459e-05 |0.5593506097793579 |0.005654335021972656 |
----------------------------------------------------------pseudo_mini_loss sum 1.2576065063476562
Total (block generation + training)time/epoch 47.39852802455425
Training time/epoch 14.730193614959717
Training time without block to device /epoch 14.519320487976074
Training time without total dataloading part /epoch 13.809388399124146
load block tensor time/epoch 0.673992395401001
block to device time/epoch 0.21087312698364258
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  5089785
Number of first layer input nodes during this epoch:  2471244
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1344313621520996  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024631738662719727
range selection method range initialization spend 0.01322484016418457
time for parepare:  0.02413463592529297
local_output_nid generation:  0.0020439624786376953
local_in_edges_tensor generation:  0.007743358612060547
mini_batch_src_global generation:  0.002318859100341797
r_  generation:  0.017676115036010742
local_output_nid generation:  0.0019338130950927734
local_in_edges_tensor generation:  0.0021648406982421875
mini_batch_src_global generation:  0.002599477767944336
r_  generation:  0.02062845230102539
local_output_nid generation:  0.0019240379333496094
local_in_edges_tensor generation:  0.0010461807250976562
mini_batch_src_global generation:  0.001645803451538086
r_  generation:  0.017867088317871094
local_output_nid generation:  0.001996755599975586
local_in_edges_tensor generation:  0.0021424293518066406
mini_batch_src_global generation:  0.0016181468963623047
r_  generation:  0.01828289031982422
local_output_nid generation:  0.001913309097290039
local_in_edges_tensor generation:  0.0015218257904052734
mini_batch_src_global generation:  0.001483917236328125
r_  generation:  0.018895864486694336
local_output_nid generation:  0.0019960403442382812
local_in_edges_tensor generation:  0.0013468265533447266
mini_batch_src_global generation:  0.0015475749969482422
r_  generation:  0.019124507904052734
local_output_nid generation:  0.00193023681640625
local_in_edges_tensor generation:  0.0010859966278076172
mini_batch_src_global generation:  0.0016283988952636719
r_  generation:  0.018947362899780273
local_output_nid generation:  0.001956462860107422
local_in_edges_tensor generation:  0.0013580322265625
mini_batch_src_global generation:  0.0015740394592285156
r_  generation:  0.01894521713256836
local_output_nid generation:  0.002023458480834961
local_in_edges_tensor generation:  0.0010833740234375
mini_batch_src_global generation:  0.0016179084777832031
r_  generation:  0.0191192626953125
local_output_nid generation:  0.0019519329071044922
local_in_edges_tensor generation:  0.001177072525024414
mini_batch_src_global generation:  0.001573324203491211
r_  generation:  0.019167423248291016
local_output_nid generation:  0.001987457275390625
local_in_edges_tensor generation:  0.00104522705078125
mini_batch_src_global generation:  0.0016064643859863281
r_  generation:  0.01953577995300293
local_output_nid generation:  0.0020325183868408203
local_in_edges_tensor generation:  0.0010335445404052734
mini_batch_src_global generation:  0.0016498565673828125
r_  generation:  0.01968860626220703
local_output_nid generation:  0.002004384994506836
local_in_edges_tensor generation:  0.0010406970977783203
mini_batch_src_global generation:  0.0015730857849121094
r_  generation:  0.019351959228515625
local_output_nid generation:  0.001973390579223633
local_in_edges_tensor generation:  0.0010192394256591797
mini_batch_src_global generation:  0.0017685890197753906
r_  generation:  0.020169734954833984
local_output_nid generation:  0.0020210742950439453
local_in_edges_tensor generation:  0.0010035037994384766
mini_batch_src_global generation:  0.0016782283782958984
r_  generation:  0.019381999969482422
local_output_nid generation:  0.001940011978149414
local_in_edges_tensor generation:  0.0010111331939697266
mini_batch_src_global generation:  0.0015711784362792969
r_  generation:  0.01904749870300293
----------------------check_connections_block total spend ----------------------------- 0.4959437847137451
generate_one_block  0.03522539138793945
generate_one_block  0.03670024871826172
generate_one_block  0.03230786323547363
generate_one_block  0.03252744674682617
generate_one_block  0.0328826904296875
generate_one_block  0.03588461875915527
generate_one_block  0.03242063522338867
generate_one_block  0.031632184982299805
generate_one_block  0.031691789627075195
generate_one_block  0.033041954040527344
generate_one_block  0.03274369239807129
generate_one_block  0.03172707557678223
generate_one_block  0.03389096260070801
generate_one_block  0.038224220275878906
generate_one_block  0.03320169448852539
generate_one_block  0.03435397148132324
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03250265121459961
gen group dst list time:  0.0186309814453125
time for parepare:  0.032625436782836914
local_output_nid generation:  0.008020639419555664
local_in_edges_tensor generation:  0.019400835037231445
mini_batch_src_global generation:  0.020372390747070312
r_  generation:  0.18916559219360352
local_output_nid generation:  0.010701179504394531
local_in_edges_tensor generation:  0.014547109603881836
mini_batch_src_global generation:  0.026038408279418945
r_  generation:  0.2038111686706543
local_output_nid generation:  0.010654687881469727
local_in_edges_tensor generation:  0.010585784912109375
mini_batch_src_global generation:  0.024173974990844727
r_  generation:  0.19997882843017578
local_output_nid generation:  0.011692285537719727
local_in_edges_tensor generation:  0.01430368423461914
mini_batch_src_global generation:  0.025454998016357422
r_  generation:  0.20629382133483887
local_output_nid generation:  0.012171268463134766
local_in_edges_tensor generation:  0.011635303497314453
mini_batch_src_global generation:  0.025986433029174805
r_  generation:  0.21384167671203613
local_output_nid generation:  0.011988401412963867
local_in_edges_tensor generation:  0.013112783432006836
mini_batch_src_global generation:  0.026318073272705078
r_  generation:  0.2153000831604004
local_output_nid generation:  0.012134552001953125
local_in_edges_tensor generation:  0.011235713958740234
mini_batch_src_global generation:  0.02759552001953125
r_  generation:  0.2115628719329834
local_output_nid generation:  0.012180089950561523
local_in_edges_tensor generation:  0.012876033782958984
mini_batch_src_global generation:  0.02620220184326172
r_  generation:  0.2474212646484375
local_output_nid generation:  0.019416093826293945
local_in_edges_tensor generation:  0.01652693748474121
mini_batch_src_global generation:  0.03146624565124512
r_  generation:  0.23414945602416992
local_output_nid generation:  0.019799470901489258
local_in_edges_tensor generation:  0.016973257064819336
mini_batch_src_global generation:  0.03125953674316406
r_  generation:  0.23407363891601562
local_output_nid generation:  0.020001649856567383
local_in_edges_tensor generation:  0.01464533805847168
mini_batch_src_global generation:  0.03158092498779297
r_  generation:  0.2171952724456787
local_output_nid generation:  0.013090848922729492
local_in_edges_tensor generation:  0.012166976928710938
mini_batch_src_global generation:  0.02676248550415039
r_  generation:  0.21472477912902832
local_output_nid generation:  0.012627601623535156
local_in_edges_tensor generation:  0.011794090270996094
mini_batch_src_global generation:  0.026754140853881836
r_  generation:  0.2155296802520752
local_output_nid generation:  0.012909173965454102
local_in_edges_tensor generation:  0.012680292129516602
mini_batch_src_global generation:  0.028851032257080078
r_  generation:  0.22342228889465332
local_output_nid generation:  0.012552976608276367
local_in_edges_tensor generation:  0.011751651763916016
mini_batch_src_global generation:  0.028914690017700195
r_  generation:  0.21891045570373535
local_output_nid generation:  0.012563705444335938
local_in_edges_tensor generation:  0.011509418487548828
mini_batch_src_global generation:  0.026459932327270508
r_  generation:  0.21795392036437988
----------------------check_connections_block total spend ----------------------------- 5.129201889038086
generate_one_block  0.2960078716278076
generate_one_block  0.30194568634033203
generate_one_block  0.27767086029052734
generate_one_block  0.2824418544769287
generate_one_block  0.28903841972351074
generate_one_block  0.2867116928100586
generate_one_block  0.30578064918518066
generate_one_block  0.2783515453338623
generate_one_block  0.2801244258880615
generate_one_block  0.2854952812194824
generate_one_block  0.291363000869751
generate_one_block  0.2821824550628662
generate_one_block  0.27839231491088867
generate_one_block  0.29516172409057617
generate_one_block  0.28383398056030273
generate_one_block  0.2780451774597168
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03437399864196777
gen group dst list time:  0.0656270980834961
time for parepare:  0.020047426223754883
local_output_nid generation:  0.025962352752685547
local_in_edges_tensor generation:  0.047815561294555664
mini_batch_src_global generation:  0.041521310806274414
r_  generation:  0.44306516647338867
local_output_nid generation:  0.03171515464782715
local_in_edges_tensor generation:  0.036214351654052734
mini_batch_src_global generation:  0.05218791961669922
r_  generation:  0.4498322010040283
local_output_nid generation:  0.04225659370422363
local_in_edges_tensor generation:  0.030016422271728516
mini_batch_src_global generation:  0.0505070686340332
r_  generation:  0.4575772285461426
local_output_nid generation:  0.03058147430419922
local_in_edges_tensor generation:  0.03337430953979492
mini_batch_src_global generation:  0.052477121353149414
r_  generation:  0.4550468921661377
local_output_nid generation:  0.03054046630859375
local_in_edges_tensor generation:  0.07729554176330566
mini_batch_src_global generation:  0.05523061752319336
r_  generation:  0.4614379405975342
local_output_nid generation:  0.030677080154418945
local_in_edges_tensor generation:  0.03907346725463867
mini_batch_src_global generation:  0.05354046821594238
r_  generation:  0.4774305820465088
local_output_nid generation:  0.034674882888793945
local_in_edges_tensor generation:  0.03239250183105469
mini_batch_src_global generation:  0.055176734924316406
r_  generation:  0.45867443084716797
local_output_nid generation:  0.03133845329284668
local_in_edges_tensor generation:  0.029974699020385742
mini_batch_src_global generation:  0.053574323654174805
r_  generation:  0.45301270484924316
local_output_nid generation:  0.03158283233642578
local_in_edges_tensor generation:  0.02867293357849121
mini_batch_src_global generation:  0.05171799659729004
r_  generation:  0.45610737800598145
local_output_nid generation:  0.03195691108703613
local_in_edges_tensor generation:  0.032427072525024414
mini_batch_src_global generation:  0.05280876159667969
r_  generation:  0.45677828788757324
local_output_nid generation:  0.03173255920410156
local_in_edges_tensor generation:  0.03055095672607422
mini_batch_src_global generation:  0.052802324295043945
r_  generation:  0.46643614768981934
local_output_nid generation:  0.0318753719329834
local_in_edges_tensor generation:  0.03244137763977051
mini_batch_src_global generation:  0.05275416374206543
r_  generation:  0.45044541358947754
local_output_nid generation:  0.03161311149597168
local_in_edges_tensor generation:  0.027862548828125
mini_batch_src_global generation:  0.05176591873168945
r_  generation:  0.45831847190856934
local_output_nid generation:  0.032105445861816406
local_in_edges_tensor generation:  0.038423776626586914
mini_batch_src_global generation:  0.053528785705566406
r_  generation:  0.45377302169799805
local_output_nid generation:  0.03206777572631836
local_in_edges_tensor generation:  0.03264975547790527
mini_batch_src_global generation:  0.05244851112365723
r_  generation:  0.4573807716369629
local_output_nid generation:  0.03194117546081543
local_in_edges_tensor generation:  0.02977466583251953
mini_batch_src_global generation:  0.05371356010437012
r_  generation:  0.46015477180480957
----------------------check_connections_block total spend ----------------------------- 10.852035999298096
generate_one_block  0.6107289791107178
generate_one_block  0.6069726943969727
generate_one_block  0.6059763431549072
generate_one_block  0.5987107753753662
generate_one_block  0.6018006801605225
generate_one_block  0.5971369743347168
generate_one_block  0.5931026935577393
generate_one_block  0.5939731597900391
generate_one_block  0.6348485946655273
generate_one_block  0.5956087112426758
generate_one_block  0.5960390567779541
generate_one_block  0.5920188426971436
generate_one_block  0.5973899364471436
generate_one_block  0.6145932674407959
generate_one_block  0.5939197540283203
generate_one_block  0.5996592044830322
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1344313621520996  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  15.981237888336182
block generation total time  14.225026607513428
average batch blocks generation time:  0.8890641629695892
block dataloader generation time/epoch 32.59207161735086
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11086893081665039  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.917063236236572  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11135435104370117  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.37263822555542  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11087751388549805  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.807255268096924  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11123418807983398  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.133695125579834  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11125707626342773  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.334898471832275  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11132669448852539  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.322946548461914  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1109476089477539  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.06168270111084  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11111974716186523  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.916390419006348  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11098909378051758  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.992480278015137  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112208366394043  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.11572790145874  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11114072799682617  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.22361135482788  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11112451553344727  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.99233913421631  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11090421676635742  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.95035696029663  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11144208908081055  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.523391723632812  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11105537414550781  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.12353754043579  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11117219924926758  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.00595712661743  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.042524874210357666 |0.011625126004219055 |0.30436527729034424 |9.132921695709229e-05 |0.5584087818861008 |0.006604671478271484 |
----------------------------------------------------------pseudo_mini_loss sum 1.2454904317855835
Total (block generation + training)time/epoch 47.386585488038904
Training time/epoch 14.715045690536499
Training time without block to device /epoch 14.529043674468994
Training time without total dataloading part /epoch 13.812450885772705
load block tensor time/epoch 0.6803979873657227
block to device time/epoch 0.18600201606750488
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  5093060
Number of first layer input nodes during this epoch:  2472605
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1347503662109375  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021150588989257812
range selection method range initialization spend 0.012809514999389648
time for parepare:  0.018899917602539062
local_output_nid generation:  0.0017049312591552734
local_in_edges_tensor generation:  0.0064089298248291016
mini_batch_src_global generation:  0.001607656478881836
r_  generation:  0.01868891716003418
local_output_nid generation:  0.0018134117126464844
local_in_edges_tensor generation:  0.0012705326080322266
mini_batch_src_global generation:  0.0019550323486328125
r_  generation:  0.020168542861938477
local_output_nid generation:  0.0017066001892089844
local_in_edges_tensor generation:  0.0012826919555664062
mini_batch_src_global generation:  0.0014722347259521484
r_  generation:  0.019342899322509766
local_output_nid generation:  0.0017504692077636719
local_in_edges_tensor generation:  0.0011777877807617188
mini_batch_src_global generation:  0.0015110969543457031
r_  generation:  0.01837468147277832
local_output_nid generation:  0.0016748905181884766
local_in_edges_tensor generation:  0.0010082721710205078
mini_batch_src_global generation:  0.0014958381652832031
r_  generation:  0.019015789031982422
local_output_nid generation:  0.0016894340515136719
local_in_edges_tensor generation:  0.0008995532989501953
mini_batch_src_global generation:  0.0015265941619873047
r_  generation:  0.019272327423095703
local_output_nid generation:  0.001661539077758789
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0015501976013183594
r_  generation:  0.019649267196655273
local_output_nid generation:  0.001697540283203125
local_in_edges_tensor generation:  0.001054525375366211
mini_batch_src_global generation:  0.0015490055084228516
r_  generation:  0.02982497215270996
local_output_nid generation:  0.002213716506958008
local_in_edges_tensor generation:  0.0011408329010009766
mini_batch_src_global generation:  0.0017147064208984375
r_  generation:  0.019868850708007812
local_output_nid generation:  0.0022988319396972656
local_in_edges_tensor generation:  0.0019724369049072266
mini_batch_src_global generation:  0.005269289016723633
r_  generation:  0.02336716651916504
local_output_nid generation:  0.0019807815551757812
local_in_edges_tensor generation:  0.0009288787841796875
mini_batch_src_global generation:  0.0015897750854492188
r_  generation:  0.019980907440185547
local_output_nid generation:  0.0017390251159667969
local_in_edges_tensor generation:  0.0009839534759521484
mini_batch_src_global generation:  0.0015459060668945312
r_  generation:  0.019518136978149414
local_output_nid generation:  0.0016655921936035156
local_in_edges_tensor generation:  0.0010559558868408203
mini_batch_src_global generation:  0.001573801040649414
r_  generation:  0.02199101448059082
local_output_nid generation:  0.0016777515411376953
local_in_edges_tensor generation:  0.0009088516235351562
mini_batch_src_global generation:  0.0019292831420898438
r_  generation:  0.019986629486083984
local_output_nid generation:  0.0016608238220214844
local_in_edges_tensor generation:  0.0009105205535888672
mini_batch_src_global generation:  0.0015797615051269531
r_  generation:  0.019449710845947266
local_output_nid generation:  0.0016620159149169922
local_in_edges_tensor generation:  0.0009949207305908203
mini_batch_src_global generation:  0.0016884803771972656
r_  generation:  0.019794225692749023
----------------------check_connections_block total spend ----------------------------- 0.5089206695556641
generate_one_block  0.031763553619384766
generate_one_block  0.03179001808166504
generate_one_block  0.03164553642272949
generate_one_block  0.029998302459716797
generate_one_block  0.031017541885375977
generate_one_block  0.033313751220703125
generate_one_block  0.031850576400756836
generate_one_block  0.03171348571777344
generate_one_block  0.03108692169189453
generate_one_block  0.030404329299926758
generate_one_block  0.03504753112792969
generate_one_block  0.04906868934631348
generate_one_block  0.038934946060180664
generate_one_block  0.03127694129943848
generate_one_block  0.03087639808654785
generate_one_block  0.03169131278991699
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03166031837463379
gen group dst list time:  0.01663517951965332
time for parepare:  0.0207822322845459
local_output_nid generation:  0.0074558258056640625
local_in_edges_tensor generation:  0.01978754997253418
mini_batch_src_global generation:  0.020468711853027344
r_  generation:  0.18856072425842285
local_output_nid generation:  0.010629653930664062
local_in_edges_tensor generation:  0.014364957809448242
mini_batch_src_global generation:  0.02563786506652832
r_  generation:  0.20515179634094238
local_output_nid generation:  0.01150822639465332
local_in_edges_tensor generation:  0.014353513717651367
mini_batch_src_global generation:  0.02365899085998535
r_  generation:  0.21140313148498535
local_output_nid generation:  0.011518001556396484
local_in_edges_tensor generation:  0.01586318016052246
mini_batch_src_global generation:  0.029778003692626953
r_  generation:  0.20511579513549805
local_output_nid generation:  0.013011455535888672
local_in_edges_tensor generation:  0.011992692947387695
mini_batch_src_global generation:  0.025772571563720703
r_  generation:  0.20770573616027832
local_output_nid generation:  0.011791706085205078
local_in_edges_tensor generation:  0.010988235473632812
mini_batch_src_global generation:  0.025966882705688477
r_  generation:  0.2095036506652832
local_output_nid generation:  0.012530088424682617
local_in_edges_tensor generation:  0.01110076904296875
mini_batch_src_global generation:  0.027780771255493164
r_  generation:  0.21263957023620605
local_output_nid generation:  0.012686729431152344
local_in_edges_tensor generation:  0.012373208999633789
mini_batch_src_global generation:  0.027290821075439453
r_  generation:  0.21639585494995117
local_output_nid generation:  0.01247096061706543
local_in_edges_tensor generation:  0.01148080825805664
mini_batch_src_global generation:  0.026927471160888672
r_  generation:  0.21113085746765137
local_output_nid generation:  0.012531757354736328
local_in_edges_tensor generation:  0.011070966720581055
mini_batch_src_global generation:  0.026012897491455078
r_  generation:  0.20987606048583984
local_output_nid generation:  0.012938737869262695
local_in_edges_tensor generation:  0.01139521598815918
mini_batch_src_global generation:  0.027736663818359375
r_  generation:  0.21598410606384277
local_output_nid generation:  0.012797117233276367
local_in_edges_tensor generation:  0.011398553848266602
mini_batch_src_global generation:  0.0263979434967041
r_  generation:  0.2192366123199463
local_output_nid generation:  0.012967824935913086
local_in_edges_tensor generation:  0.012533187866210938
mini_batch_src_global generation:  0.026897668838500977
r_  generation:  0.21944904327392578
local_output_nid generation:  0.012926101684570312
local_in_edges_tensor generation:  0.011437654495239258
mini_batch_src_global generation:  0.026939868927001953
r_  generation:  0.21859240531921387
local_output_nid generation:  0.012818336486816406
local_in_edges_tensor generation:  0.011676549911499023
mini_batch_src_global generation:  0.026981830596923828
r_  generation:  0.21426653861999512
local_output_nid generation:  0.012909412384033203
local_in_edges_tensor generation:  0.01157832145690918
mini_batch_src_global generation:  0.026996135711669922
r_  generation:  0.21825146675109863
----------------------check_connections_block total spend ----------------------------- 4.972554922103882
generate_one_block  0.2904648780822754
generate_one_block  0.2843647003173828
generate_one_block  0.285780668258667
generate_one_block  0.27872586250305176
generate_one_block  0.2810513973236084
generate_one_block  0.29165077209472656
generate_one_block  0.3124349117279053
generate_one_block  0.29642486572265625
generate_one_block  0.28357672691345215
generate_one_block  0.27852392196655273
generate_one_block  0.2896432876586914
generate_one_block  0.29041194915771484
generate_one_block  0.28980326652526855
generate_one_block  0.2890441417694092
generate_one_block  0.27996206283569336
generate_one_block  0.28528857231140137
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0345458984375
gen group dst list time:  0.06807804107666016
time for parepare:  0.018796205520629883
local_output_nid generation:  0.026134252548217773
local_in_edges_tensor generation:  0.04803943634033203
mini_batch_src_global generation:  0.03993725776672363
r_  generation:  0.442136287689209
local_output_nid generation:  0.0315098762512207
local_in_edges_tensor generation:  0.035645246505737305
mini_batch_src_global generation:  0.051894187927246094
r_  generation:  0.4429607391357422
local_output_nid generation:  0.030405044555664062
local_in_edges_tensor generation:  0.03242993354797363
mini_batch_src_global generation:  0.05160045623779297
r_  generation:  0.45625805854797363
local_output_nid generation:  0.030180692672729492
local_in_edges_tensor generation:  0.02816915512084961
mini_batch_src_global generation:  0.05254101753234863
r_  generation:  0.45601844787597656
local_output_nid generation:  0.030447721481323242
local_in_edges_tensor generation:  0.07121467590332031
mini_batch_src_global generation:  0.05608081817626953
r_  generation:  0.45978331565856934
local_output_nid generation:  0.030595064163208008
local_in_edges_tensor generation:  0.030570030212402344
mini_batch_src_global generation:  0.053189992904663086
r_  generation:  0.4557774066925049
local_output_nid generation:  0.03207516670227051
local_in_edges_tensor generation:  0.03559422492980957
mini_batch_src_global generation:  0.05330157279968262
r_  generation:  0.4653053283691406
local_output_nid generation:  0.030922889709472656
local_in_edges_tensor generation:  0.02880239486694336
mini_batch_src_global generation:  0.05264782905578613
r_  generation:  0.45595431327819824
local_output_nid generation:  0.031004905700683594
local_in_edges_tensor generation:  0.029396533966064453
mini_batch_src_global generation:  0.052956342697143555
r_  generation:  0.46041107177734375
local_output_nid generation:  0.0332033634185791
local_in_edges_tensor generation:  0.03734540939331055
mini_batch_src_global generation:  0.054296016693115234
r_  generation:  0.45261216163635254
local_output_nid generation:  0.0311582088470459
local_in_edges_tensor generation:  0.03497934341430664
mini_batch_src_global generation:  0.05188894271850586
r_  generation:  0.46451330184936523
local_output_nid generation:  0.031208038330078125
local_in_edges_tensor generation:  0.030640840530395508
mini_batch_src_global generation:  0.055161237716674805
r_  generation:  0.47292280197143555
local_output_nid generation:  0.0340428352355957
local_in_edges_tensor generation:  0.03068089485168457
mini_batch_src_global generation:  0.0535740852355957
r_  generation:  0.45893001556396484
local_output_nid generation:  0.031992197036743164
local_in_edges_tensor generation:  0.030678749084472656
mini_batch_src_global generation:  0.05251049995422363
r_  generation:  0.4534730911254883
local_output_nid generation:  0.03188776969909668
local_in_edges_tensor generation:  0.028830289840698242
mini_batch_src_global generation:  0.05146384239196777
r_  generation:  0.4587113857269287
local_output_nid generation:  0.032196044921875
local_in_edges_tensor generation:  0.03045034408569336
mini_batch_src_global generation:  0.05516672134399414
r_  generation:  0.45767879486083984
----------------------check_connections_block total spend ----------------------------- 10.812791585922241
generate_one_block  0.6123037338256836
generate_one_block  0.5990848541259766
generate_one_block  0.6072816848754883
generate_one_block  0.5908129215240479
generate_one_block  0.597419023513794
generate_one_block  0.5976085662841797
generate_one_block  0.5991041660308838
generate_one_block  0.6026842594146729
generate_one_block  0.6247282028198242
generate_one_block  0.5881123542785645
generate_one_block  0.6032094955444336
generate_one_block  0.5981903076171875
generate_one_block  0.6035692691802979
generate_one_block  0.5960700511932373
generate_one_block  0.600452184677124
generate_one_block  0.6053564548492432
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1347503662109375  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  15.785346508026123
block generation total time  14.233139514923096
average batch blocks generation time:  0.8895712196826935
block dataloader generation time/epoch 32.575144370396934
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11080789566040039  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.965500354766846  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11127138137817383  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.20907735824585  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1110982894897461  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.185129165649414  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11099767684936523  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.715075492858887  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11091327667236328  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.002188205718994  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11118745803833008  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.03770112991333  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1110086441040039  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.146448135375977  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11127901077270508  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.235690116882324  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11079883575439453  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.98790740966797  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11107778549194336  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.86108160018921  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11122417449951172  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.21468496322632  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11126279830932617  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.173815727233887  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11113834381103516  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.31143569946289  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11130762100219727  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.2769455909729  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1110539436340332  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.082632064819336  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1113133430480957  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.30678653717041  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03981754183769226 |0.015174701809883118 |0.3054355978965759 |9.462237358093262e-05 |0.5571267902851105 |0.005411624908447266 |
----------------------------------------------------------pseudo_mini_loss sum 1.234751582145691
Total (block generation + training)time/epoch 47.365875985887314
Training time/epoch 14.726213932037354
Training time without block to device /epoch 14.483418703079224
Training time without total dataloading part /epoch 13.807923793792725
load block tensor time/epoch 0.6370806694030762
block to device time/epoch 0.24279522895812988
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  5092473
Number of first layer input nodes during this epoch:  2471990
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1350398063659668  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022129297256469727
range selection method range initialization spend 0.015892505645751953
time for parepare:  0.019952774047851562
local_output_nid generation:  0.0017094612121582031
local_in_edges_tensor generation:  0.005442142486572266
mini_batch_src_global generation:  0.0021238327026367188
r_  generation:  0.021579742431640625
local_output_nid generation:  0.0018360614776611328
local_in_edges_tensor generation:  0.0012764930725097656
mini_batch_src_global generation:  0.002492666244506836
r_  generation:  0.021495580673217773
local_output_nid generation:  0.001772165298461914
local_in_edges_tensor generation:  0.0012662410736083984
mini_batch_src_global generation:  0.0018181800842285156
r_  generation:  0.02098250389099121
local_output_nid generation:  0.0017430782318115234
local_in_edges_tensor generation:  0.0010251998901367188
mini_batch_src_global generation:  0.0018680095672607422
r_  generation:  0.021241188049316406
local_output_nid generation:  0.0017385482788085938
local_in_edges_tensor generation:  0.0016181468963623047
mini_batch_src_global generation:  0.00299835205078125
r_  generation:  0.02149367332458496
local_output_nid generation:  0.0017161369323730469
local_in_edges_tensor generation:  0.0010063648223876953
mini_batch_src_global generation:  0.001970052719116211
r_  generation:  0.030382633209228516
local_output_nid generation:  0.0022687911987304688
local_in_edges_tensor generation:  0.0011658668518066406
mini_batch_src_global generation:  0.0016849040985107422
r_  generation:  0.01926875114440918
local_output_nid generation:  0.002075672149658203
local_in_edges_tensor generation:  0.0010533332824707031
mini_batch_src_global generation:  0.0015780925750732422
r_  generation:  0.018533945083618164
local_output_nid generation:  0.0020704269409179688
local_in_edges_tensor generation:  0.0010600090026855469
mini_batch_src_global generation:  0.00156402587890625
r_  generation:  0.018452882766723633
local_output_nid generation:  0.002056121826171875
local_in_edges_tensor generation:  0.0011768341064453125
mini_batch_src_global generation:  0.0014307498931884766
r_  generation:  0.018706321716308594
local_output_nid generation:  0.001990079879760742
local_in_edges_tensor generation:  0.0010111331939697266
mini_batch_src_global generation:  0.0016634464263916016
r_  generation:  0.018451213836669922
local_output_nid generation:  0.0019762516021728516
local_in_edges_tensor generation:  0.0022439956665039062
mini_batch_src_global generation:  0.0016362667083740234
r_  generation:  0.019332170486450195
local_output_nid generation:  0.001926422119140625
local_in_edges_tensor generation:  0.0010159015655517578
mini_batch_src_global generation:  0.0015537738800048828
r_  generation:  0.018140077590942383
local_output_nid generation:  0.0018813610076904297
local_in_edges_tensor generation:  0.001184225082397461
mini_batch_src_global generation:  0.0015342235565185547
r_  generation:  0.018700838088989258
local_output_nid generation:  0.0018589496612548828
local_in_edges_tensor generation:  0.0009813308715820312
mini_batch_src_global generation:  0.001371145248413086
r_  generation:  0.02037334442138672
local_output_nid generation:  0.0038194656372070312
local_in_edges_tensor generation:  0.0019097328186035156
mini_batch_src_global generation:  0.0063323974609375
r_  generation:  0.02573680877685547
----------------------check_connections_block total spend ----------------------------- 0.5324599742889404
generate_one_block  0.03912663459777832
generate_one_block  0.0305936336517334
generate_one_block  0.031159400939941406
generate_one_block  0.030495643615722656
generate_one_block  0.03193235397338867
generate_one_block  0.034467458724975586
generate_one_block  0.0323944091796875
generate_one_block  0.031067371368408203
generate_one_block  0.03142905235290527
generate_one_block  0.03186941146850586
generate_one_block  0.03129291534423828
generate_one_block  0.035338640213012695
generate_one_block  0.03700065612792969
generate_one_block  0.0312955379486084
generate_one_block  0.031572818756103516
generate_one_block  0.03473353385925293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03204202651977539
gen group dst list time:  0.01754164695739746
time for parepare:  0.02135014533996582
local_output_nid generation:  0.007506370544433594
local_in_edges_tensor generation:  0.017850637435913086
mini_batch_src_global generation:  0.020620346069335938
r_  generation:  0.19065618515014648
local_output_nid generation:  0.010499715805053711
local_in_edges_tensor generation:  0.012460947036743164
mini_batch_src_global generation:  0.023995637893676758
r_  generation:  0.19337677955627441
local_output_nid generation:  0.010885000228881836
local_in_edges_tensor generation:  0.011446952819824219
mini_batch_src_global generation:  0.0245664119720459
r_  generation:  0.20272159576416016
local_output_nid generation:  0.011567115783691406
local_in_edges_tensor generation:  0.012469053268432617
mini_batch_src_global generation:  0.023978710174560547
r_  generation:  0.20404911041259766
local_output_nid generation:  0.012042999267578125
local_in_edges_tensor generation:  0.014803171157836914
mini_batch_src_global generation:  0.026299476623535156
r_  generation:  0.2129826545715332
local_output_nid generation:  0.011539936065673828
local_in_edges_tensor generation:  0.014082670211791992
mini_batch_src_global generation:  0.027367591857910156
r_  generation:  0.213395357131958
local_output_nid generation:  0.012186765670776367
local_in_edges_tensor generation:  0.011507511138916016
mini_batch_src_global generation:  0.02709341049194336
r_  generation:  0.22293567657470703
local_output_nid generation:  0.012189626693725586
local_in_edges_tensor generation:  0.014137983322143555
mini_batch_src_global generation:  0.02671957015991211
r_  generation:  0.21552681922912598
local_output_nid generation:  0.012408018112182617
local_in_edges_tensor generation:  0.01288914680480957
mini_batch_src_global generation:  0.026214599609375
r_  generation:  0.25229787826538086
local_output_nid generation:  0.012532949447631836
local_in_edges_tensor generation:  0.017194032669067383
mini_batch_src_global generation:  0.0294492244720459
r_  generation:  0.2195279598236084
local_output_nid generation:  0.01327061653137207
local_in_edges_tensor generation:  0.014278411865234375
mini_batch_src_global generation:  0.03639101982116699
r_  generation:  0.2152538299560547
local_output_nid generation:  0.01395273208618164
local_in_edges_tensor generation:  0.012691259384155273
mini_batch_src_global generation:  0.028216838836669922
r_  generation:  0.21981191635131836
local_output_nid generation:  0.012743473052978516
local_in_edges_tensor generation:  0.011603593826293945
mini_batch_src_global generation:  0.027618885040283203
r_  generation:  0.21173834800720215
local_output_nid generation:  0.012860774993896484
local_in_edges_tensor generation:  0.011285781860351562
mini_batch_src_global generation:  0.02686595916748047
r_  generation:  0.21393370628356934
local_output_nid generation:  0.013154268264770508
local_in_edges_tensor generation:  0.011638879776000977
mini_batch_src_global generation:  0.02683734893798828
r_  generation:  0.21638727188110352
local_output_nid generation:  0.012829065322875977
local_in_edges_tensor generation:  0.011615753173828125
mini_batch_src_global generation:  0.026631593704223633
r_  generation:  0.21419143676757812
----------------------check_connections_block total spend ----------------------------- 5.027581691741943
generate_one_block  0.2864968776702881
generate_one_block  0.27294445037841797
generate_one_block  0.28227972984313965
generate_one_block  0.2886629104614258
generate_one_block  0.2936074733734131
generate_one_block  0.3007814884185791
generate_one_block  0.31983518600463867
generate_one_block  0.2853052616119385
generate_one_block  0.2833743095397949
generate_one_block  0.2877323627471924
generate_one_block  0.28873443603515625
generate_one_block  0.29642629623413086
generate_one_block  0.28321146965026855
generate_one_block  0.2844367027282715
generate_one_block  0.2932252883911133
generate_one_block  0.2816288471221924
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03381919860839844
gen group dst list time:  0.06881165504455566
time for parepare:  0.018858671188354492
local_output_nid generation:  0.02553868293762207
local_in_edges_tensor generation:  0.05157613754272461
mini_batch_src_global generation:  0.053705692291259766
r_  generation:  0.44959068298339844
local_output_nid generation:  0.03155779838562012
local_in_edges_tensor generation:  0.03624439239501953
mini_batch_src_global generation:  0.05310177803039551
r_  generation:  0.4459357261657715
local_output_nid generation:  0.0307464599609375
local_in_edges_tensor generation:  0.030857563018798828
mini_batch_src_global generation:  0.05160880088806152
r_  generation:  0.45763349533081055
local_output_nid generation:  0.030313968658447266
local_in_edges_tensor generation:  0.030674457550048828
mini_batch_src_global generation:  0.052526235580444336
r_  generation:  0.4480109214782715
local_output_nid generation:  0.03015589714050293
local_in_edges_tensor generation:  0.07268452644348145
mini_batch_src_global generation:  0.052381277084350586
r_  generation:  0.4643113613128662
local_output_nid generation:  0.030409574508666992
local_in_edges_tensor generation:  0.03204703330993652
mini_batch_src_global generation:  0.05318737030029297
r_  generation:  0.4533967971801758
local_output_nid generation:  0.03063201904296875
local_in_edges_tensor generation:  0.03101968765258789
mini_batch_src_global generation:  0.06343507766723633
r_  generation:  0.4719352722167969
local_output_nid generation:  0.030884265899658203
local_in_edges_tensor generation:  0.03644609451293945
mini_batch_src_global generation:  0.05362415313720703
r_  generation:  0.4709811210632324
local_output_nid generation:  0.03198575973510742
local_in_edges_tensor generation:  0.03969693183898926
mini_batch_src_global generation:  0.0737767219543457
r_  generation:  0.46162891387939453
local_output_nid generation:  0.033248186111450195
local_in_edges_tensor generation:  0.029057025909423828
mini_batch_src_global generation:  0.05342698097229004
r_  generation:  0.45101308822631836
local_output_nid generation:  0.032088518142700195
local_in_edges_tensor generation:  0.0321650505065918
mini_batch_src_global generation:  0.051543235778808594
r_  generation:  0.4569857120513916
local_output_nid generation:  0.03191518783569336
local_in_edges_tensor generation:  0.03068685531616211
mini_batch_src_global generation:  0.0528414249420166
r_  generation:  0.45542240142822266
local_output_nid generation:  0.03186464309692383
local_in_edges_tensor generation:  0.03227663040161133
mini_batch_src_global generation:  0.05172610282897949
r_  generation:  0.4638822078704834
local_output_nid generation:  0.03222846984863281
local_in_edges_tensor generation:  0.03060293197631836
mini_batch_src_global generation:  0.052945852279663086
r_  generation:  0.45258307456970215
local_output_nid generation:  0.032228946685791016
local_in_edges_tensor generation:  0.030103683471679688
mini_batch_src_global generation:  0.05215740203857422
r_  generation:  0.4583148956298828
local_output_nid generation:  0.03211092948913574
local_in_edges_tensor generation:  0.028425216674804688
mini_batch_src_global generation:  0.05300760269165039
r_  generation:  0.4508187770843506
----------------------check_connections_block total spend ----------------------------- 10.89907693862915
generate_one_block  0.6059198379516602
generate_one_block  0.5945992469787598
generate_one_block  0.6164312362670898
generate_one_block  0.6020231246948242
generate_one_block  0.6123204231262207
generate_one_block  0.6038162708282471
generate_one_block  0.5941858291625977
generate_one_block  0.594456672668457
generate_one_block  0.6268801689147949
generate_one_block  0.615659236907959
generate_one_block  0.595909833908081
generate_one_block  0.603325605392456
generate_one_block  0.5968747138977051
generate_one_block  0.5952756404876709
generate_one_block  0.6006600856781006
generate_one_block  0.6001083850860596
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1350398063659668  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  15.926658630371094
block generation total time  14.287129402160645
average batch blocks generation time:  0.8929455876350403
block dataloader generation time/epoch 32.571998495804635
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.111053466796875  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.971717834472656  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11092519760131836  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.641726970672607  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1108846664428711  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.037943840026855  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11110639572143555  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.94374418258667  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11113739013671875  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.300254821777344  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11123228073120117  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.138346672058105  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11100006103515625  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.354082107543945  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11113977432250977  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.95781183242798  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1109161376953125  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.032835960388184  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11127519607543945  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.216565132141113  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11098432540893555  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.032097339630127  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11142492294311523  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.497779369354248  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11082792282104492  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.026145458221436  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11121892929077148  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.09060764312744  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11095476150512695  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.225847244262695  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1111903190612793  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.090222358703613  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03912349045276642 |0.013091981410980225 |0.30436816811561584 |9.287893772125244e-05 |0.5564009696245193 |0.0057299137115478516 |
----------------------------------------------------------pseudo_mini_loss sum 1.2197086811065674
Total (block generation + training)time/epoch 47.35539630839699
Training time/epoch 14.651146650314331
Training time without block to device /epoch 14.441674947738647
Training time without total dataloading part /epoch 13.779522180557251
load block tensor time/epoch 0.6259758472442627
block to device time/epoch 0.2094717025756836
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  5088581
Number of first layer input nodes during this epoch:  2470646
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.13458633422851562  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02227473258972168
range selection method range initialization spend 0.01258087158203125
time for parepare:  0.017084360122680664
local_output_nid generation:  0.0017025470733642578
local_in_edges_tensor generation:  0.007575511932373047
mini_batch_src_global generation:  0.003196239471435547
r_  generation:  0.029401302337646484
local_output_nid generation:  0.002867460250854492
local_in_edges_tensor generation:  0.002202272415161133
mini_batch_src_global generation:  0.002869129180908203
r_  generation:  0.020637035369873047
local_output_nid generation:  0.0016574859619140625
local_in_edges_tensor generation:  0.0011653900146484375
mini_batch_src_global generation:  0.0014584064483642578
r_  generation:  0.018926620483398438
local_output_nid generation:  0.0017158985137939453
local_in_edges_tensor generation:  0.0015499591827392578
mini_batch_src_global generation:  0.003912687301635742
r_  generation:  0.02495121955871582
local_output_nid generation:  0.003390073776245117
local_in_edges_tensor generation:  0.0018258094787597656
mini_batch_src_global generation:  0.004277706146240234
r_  generation:  0.022449493408203125
local_output_nid generation:  0.0016283988952636719
local_in_edges_tensor generation:  0.001196146011352539
mini_batch_src_global generation:  0.001581430435180664
r_  generation:  0.031206369400024414
local_output_nid generation:  0.0026404857635498047
local_in_edges_tensor generation:  0.001344919204711914
mini_batch_src_global generation:  0.0019288063049316406
r_  generation:  0.018374204635620117
local_output_nid generation:  0.0019664764404296875
local_in_edges_tensor generation:  0.001131296157836914
mini_batch_src_global generation:  0.0015382766723632812
r_  generation:  0.01789546012878418
local_output_nid generation:  0.0019452571868896484
local_in_edges_tensor generation:  0.0010716915130615234
mini_batch_src_global generation:  0.0015285015106201172
r_  generation:  0.0186002254486084
local_output_nid generation:  0.0019123554229736328
local_in_edges_tensor generation:  0.001214742660522461
mini_batch_src_global generation:  0.0014946460723876953
r_  generation:  0.018780231475830078
local_output_nid generation:  0.0019435882568359375
local_in_edges_tensor generation:  0.0010335445404052734
mini_batch_src_global generation:  0.0017242431640625
r_  generation:  0.018734455108642578
local_output_nid generation:  0.0018870830535888672
local_in_edges_tensor generation:  0.0010116100311279297
mini_batch_src_global generation:  0.0015892982482910156
r_  generation:  0.01858234405517578
local_output_nid generation:  0.0018639564514160156
local_in_edges_tensor generation:  0.0010068416595458984
mini_batch_src_global generation:  0.0016131401062011719
r_  generation:  0.0186004638671875
local_output_nid generation:  0.0018749237060546875
local_in_edges_tensor generation:  0.0010564327239990234
mini_batch_src_global generation:  0.0015361309051513672
r_  generation:  0.018081188201904297
local_output_nid generation:  0.0018825531005859375
local_in_edges_tensor generation:  0.001031637191772461
mini_batch_src_global generation:  0.001520395278930664
r_  generation:  0.018578290939331055
local_output_nid generation:  0.0018208026885986328
local_in_edges_tensor generation:  0.0010077953338623047
mini_batch_src_global generation:  0.0014538764953613281
r_  generation:  0.019049644470214844
----------------------check_connections_block total spend ----------------------------- 0.531322717666626
generate_one_block  0.03320717811584473
generate_one_block  0.03997683525085449
generate_one_block  0.031548500061035156
generate_one_block  0.031537532806396484
generate_one_block  0.03323674201965332
generate_one_block  0.037018537521362305
generate_one_block  0.03365278244018555
generate_one_block  0.030884742736816406
generate_one_block  0.03129291534423828
generate_one_block  0.03159666061401367
generate_one_block  0.031247377395629883
generate_one_block  0.03148508071899414
generate_one_block  0.04533052444458008
generate_one_block  0.03401947021484375
generate_one_block  0.0316622257232666
generate_one_block  0.03536081314086914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03836226463317871
gen group dst list time:  0.019443035125732422
time for parepare:  0.020442485809326172
local_output_nid generation:  0.0075185298919677734
local_in_edges_tensor generation:  0.018019437789916992
mini_batch_src_global generation:  0.020520925521850586
r_  generation:  0.18958330154418945
local_output_nid generation:  0.010562896728515625
local_in_edges_tensor generation:  0.012922525405883789
mini_batch_src_global generation:  0.024409055709838867
r_  generation:  0.19966745376586914
local_output_nid generation:  0.011124372482299805
local_in_edges_tensor generation:  0.01128077507019043
mini_batch_src_global generation:  0.024015188217163086
r_  generation:  0.20905113220214844
local_output_nid generation:  0.012498855590820312
local_in_edges_tensor generation:  0.013988256454467773
mini_batch_src_global generation:  0.02449655532836914
r_  generation:  0.21589922904968262
local_output_nid generation:  0.012911319732666016
local_in_edges_tensor generation:  0.013492584228515625
mini_batch_src_global generation:  0.0258481502532959
r_  generation:  0.21420717239379883
local_output_nid generation:  0.01178121566772461
local_in_edges_tensor generation:  0.014676570892333984
mini_batch_src_global generation:  0.026433229446411133
r_  generation:  0.2305769920349121
local_output_nid generation:  0.014144659042358398
local_in_edges_tensor generation:  0.013016223907470703
mini_batch_src_global generation:  0.026999235153198242
r_  generation:  0.21300339698791504
local_output_nid generation:  0.012542247772216797
local_in_edges_tensor generation:  0.012811422348022461
mini_batch_src_global generation:  0.026304244995117188
r_  generation:  0.20996570587158203
local_output_nid generation:  0.012734413146972656
local_in_edges_tensor generation:  0.011493206024169922
mini_batch_src_global generation:  0.028046369552612305
r_  generation:  0.21500301361083984
local_output_nid generation:  0.012993574142456055
local_in_edges_tensor generation:  0.014544248580932617
mini_batch_src_global generation:  0.026862382888793945
r_  generation:  0.21640229225158691
local_output_nid generation:  0.01268148422241211
local_in_edges_tensor generation:  0.011458158493041992
mini_batch_src_global generation:  0.027222156524658203
r_  generation:  0.213623046875
local_output_nid generation:  0.012766361236572266
local_in_edges_tensor generation:  0.011598348617553711
mini_batch_src_global generation:  0.026548147201538086
r_  generation:  0.27404069900512695
local_output_nid generation:  0.012601137161254883
local_in_edges_tensor generation:  0.012370109558105469
mini_batch_src_global generation:  0.027703523635864258
r_  generation:  0.21441864967346191
local_output_nid generation:  0.012825727462768555
local_in_edges_tensor generation:  0.011552810668945312
mini_batch_src_global generation:  0.026323318481445312
r_  generation:  0.21148276329040527
local_output_nid generation:  0.012818336486816406
local_in_edges_tensor generation:  0.011548995971679688
mini_batch_src_global generation:  0.028922557830810547
r_  generation:  0.2156224250793457
local_output_nid generation:  0.012890815734863281
local_in_edges_tensor generation:  0.012047767639160156
mini_batch_src_global generation:  0.029166221618652344
r_  generation:  0.2197554111480713
----------------------check_connections_block total spend ----------------------------- 5.0612101554870605
generate_one_block  0.2991454601287842
generate_one_block  0.28177738189697266
generate_one_block  0.2836470603942871
generate_one_block  0.28276515007019043
generate_one_block  0.27997469902038574
generate_one_block  0.28638577461242676
generate_one_block  0.3057880401611328
generate_one_block  0.2787954807281494
generate_one_block  0.2888360023498535
generate_one_block  0.2941141128540039
generate_one_block  0.2926619052886963
generate_one_block  0.2876749038696289
generate_one_block  0.28926944732666016
generate_one_block  0.2810251712799072
generate_one_block  0.27993059158325195
generate_one_block  0.28476691246032715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03309011459350586
gen group dst list time:  0.06485915184020996
time for parepare:  0.018092870712280273
local_output_nid generation:  0.02625584602355957
local_in_edges_tensor generation:  0.04692840576171875
mini_batch_src_global generation:  0.05327916145324707
r_  generation:  0.4534306526184082
local_output_nid generation:  0.03145337104797363
local_in_edges_tensor generation:  0.03365802764892578
mini_batch_src_global generation:  0.05365157127380371
r_  generation:  0.4928112030029297
local_output_nid generation:  0.035518646240234375
local_in_edges_tensor generation:  0.039313316345214844
mini_batch_src_global generation:  0.06235980987548828
r_  generation:  0.45437026023864746
local_output_nid generation:  0.0312809944152832
local_in_edges_tensor generation:  0.03068852424621582
mini_batch_src_global generation:  0.05464458465576172
r_  generation:  0.4512817859649658
local_output_nid generation:  0.0321497917175293
local_in_edges_tensor generation:  0.08038997650146484
mini_batch_src_global generation:  0.0517885684967041
r_  generation:  0.45618557929992676
local_output_nid generation:  0.031134605407714844
local_in_edges_tensor generation:  0.028965473175048828
mini_batch_src_global generation:  0.055135488510131836
r_  generation:  0.4678072929382324
local_output_nid generation:  0.030687808990478516
local_in_edges_tensor generation:  0.030855417251586914
mini_batch_src_global generation:  0.054548025131225586
r_  generation:  0.4716362953186035
local_output_nid generation:  0.031345367431640625
local_in_edges_tensor generation:  0.03461647033691406
mini_batch_src_global generation:  0.05283498764038086
r_  generation:  0.4591550827026367
local_output_nid generation:  0.03349804878234863
local_in_edges_tensor generation:  0.032343149185180664
mini_batch_src_global generation:  0.05243349075317383
r_  generation:  0.46483945846557617
local_output_nid generation:  0.03131556510925293
local_in_edges_tensor generation:  0.036632537841796875
mini_batch_src_global generation:  0.056334733963012695
r_  generation:  0.4757528305053711
local_output_nid generation:  0.0342707633972168
local_in_edges_tensor generation:  0.03846597671508789
mini_batch_src_global generation:  0.053852081298828125
r_  generation:  0.45828914642333984
local_output_nid generation:  0.03206133842468262
local_in_edges_tensor generation:  0.030362844467163086
mini_batch_src_global generation:  0.05286741256713867
r_  generation:  0.451479434967041
local_output_nid generation:  0.03216814994812012
local_in_edges_tensor generation:  0.031055450439453125
mini_batch_src_global generation:  0.05153632164001465
r_  generation:  0.4566807746887207
local_output_nid generation:  0.032163381576538086
local_in_edges_tensor generation:  0.030406951904296875
mini_batch_src_global generation:  0.05275464057922363
r_  generation:  0.45187950134277344
local_output_nid generation:  0.03204083442687988
local_in_edges_tensor generation:  0.030525684356689453
mini_batch_src_global generation:  0.05354619026184082
r_  generation:  0.4601874351501465
local_output_nid generation:  0.03228044509887695
local_in_edges_tensor generation:  0.032289981842041016
mini_batch_src_global generation:  0.053050994873046875
r_  generation:  0.4544060230255127
----------------------check_connections_block total spend ----------------------------- 11.016634225845337
generate_one_block  0.6227002143859863
generate_one_block  0.60504150390625
generate_one_block  0.6004884243011475
generate_one_block  0.6047983169555664
generate_one_block  0.6011552810668945
generate_one_block  0.6082150936126709
generate_one_block  0.6171250343322754
generate_one_block  0.6061661243438721
generate_one_block  0.637906551361084
generate_one_block  0.6033716201782227
generate_one_block  0.5980994701385498
generate_one_block  0.5972089767456055
generate_one_block  0.6028704643249512
generate_one_block  0.6084733009338379
generate_one_block  0.5996034145355225
generate_one_block  0.6171603202819824
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.13458633422851562  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

connection checking time:  16.077844381332397
block generation total time  14.326942205429077
average batch blocks generation time:  0.8954338878393173
block dataloader generation time/epoch 32.57889835834503
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11105966567993164  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.111775875091553  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11119604110717773  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.09390878677368  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11094284057617188  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.08499240875244  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11123418807983398  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.134029388427734  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11087656021118164  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.017664432525635  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11132574081420898  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.313929557800293  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11105489730834961  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.05533266067505  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11116552352905273  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.022920608520508  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11105728149414062  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.238791942596436  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1113133430480957  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.271793365478516  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11086177825927734  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.123827934265137  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112065315246582  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.098772525787354  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11095714569091797  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.028952598571777  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11113786697387695  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.95166778564453  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.11080121994018555  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 20.941951274871826  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 0.1112518310546875  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.155681610107422  GigaBytes
Max Memory Allocated: 21.6437349319458  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.039109423756599426 |0.012265786528587341 |0.3049028515815735 |9.210407733917236e-05 |0.5571497529745102 |0.005788087844848633 |
----------------------------------------------------------pseudo_mini_loss sum 1.2166213989257812
Total (block generation + training)time/epoch 47.356055688858035
Training time/epoch 14.658349514007568
Training time without block to device /epoch 14.462096929550171
Training time without total dataloading part /epoch 13.800103425979614
load block tensor time/epoch 0.6257507801055908
block to device time/epoch 0.19625258445739746
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  5091923
Number of first layer input nodes during this epoch:  2471898
