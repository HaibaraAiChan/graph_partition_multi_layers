Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647803151.8971298
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026870250701904297
range selection method range initialization spend 0.013263225555419922
time for parepare:  0.018074750900268555
local_output_nid generation:  0.0007543563842773438
local_in_edges_tensor generation:  0.0038340091705322266
mini_batch_src_global generation:  0.0015168190002441406
r_  generation:  0.010248899459838867
local_output_nid generation:  0.0007071495056152344
local_in_edges_tensor generation:  0.0005905628204345703
mini_batch_src_global generation:  0.0015528202056884766
r_  generation:  0.009555339813232422
local_output_nid generation:  0.0007193088531494141
local_in_edges_tensor generation:  0.0005118846893310547
mini_batch_src_global generation:  0.0009968280792236328
r_  generation:  0.009245634078979492
local_output_nid generation:  0.0007348060607910156
local_in_edges_tensor generation:  0.0004992485046386719
mini_batch_src_global generation:  0.0008852481842041016
r_  generation:  0.008589506149291992
local_output_nid generation:  0.0007238388061523438
local_in_edges_tensor generation:  0.0005388259887695312
mini_batch_src_global generation:  0.000919342041015625
r_  generation:  0.009343862533569336
local_output_nid generation:  0.0007307529449462891
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.0009365081787109375
r_  generation:  0.009275197982788086
local_output_nid generation:  0.0007345676422119141
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0010216236114501953
r_  generation:  0.009357452392578125
local_output_nid generation:  0.0007579326629638672
local_in_edges_tensor generation:  0.0005052089691162109
mini_batch_src_global generation:  0.0010623931884765625
r_  generation:  0.009874343872070312
local_output_nid generation:  0.0007424354553222656
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.0009312629699707031
r_  generation:  0.009578943252563477
local_output_nid generation:  0.0007386207580566406
local_in_edges_tensor generation:  0.00048351287841796875
mini_batch_src_global generation:  0.000949859619140625
r_  generation:  0.009694337844848633
local_output_nid generation:  0.000743865966796875
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.0010340213775634766
r_  generation:  0.01012730598449707
local_output_nid generation:  0.00074005126953125
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.0010046958923339844
r_  generation:  0.009985208511352539
local_output_nid generation:  0.0007946491241455078
local_in_edges_tensor generation:  0.0005145072937011719
mini_batch_src_global generation:  0.001020669937133789
r_  generation:  0.010142087936401367
local_output_nid generation:  0.0007443428039550781
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.001047372817993164
r_  generation:  0.010267496109008789
local_output_nid generation:  0.0007557868957519531
local_in_edges_tensor generation:  0.0005285739898681641
mini_batch_src_global generation:  0.0011112689971923828
r_  generation:  0.010328531265258789
local_output_nid generation:  0.0007510185241699219
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.00101470947265625
r_  generation:  0.009972333908081055
local_output_nid generation:  0.0007565021514892578
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0010597705841064453
r_  generation:  0.009594917297363281
local_output_nid generation:  0.0007472038269042969
local_in_edges_tensor generation:  0.0004913806915283203
mini_batch_src_global generation:  0.0010747909545898438
r_  generation:  0.010263919830322266
local_output_nid generation:  0.0007503032684326172
local_in_edges_tensor generation:  0.0005016326904296875
mini_batch_src_global generation:  0.0010344982147216797
r_  generation:  0.009816646575927734
local_output_nid generation:  0.0007810592651367188
local_in_edges_tensor generation:  0.00048279762268066406
mini_batch_src_global generation:  0.00101470947265625
r_  generation:  0.009839534759521484
local_output_nid generation:  0.0007526874542236328
local_in_edges_tensor generation:  0.0004787445068359375
mini_batch_src_global generation:  0.0010085105895996094
r_  generation:  0.010014772415161133
local_output_nid generation:  0.0007665157318115234
local_in_edges_tensor generation:  0.0005052089691162109
mini_batch_src_global generation:  0.0010907649993896484
r_  generation:  0.010413885116577148
local_output_nid generation:  0.0007579326629638672
local_in_edges_tensor generation:  0.0004849433898925781
mini_batch_src_global generation:  0.0010485649108886719
r_  generation:  0.009851217269897461
local_output_nid generation:  0.0007457733154296875
local_in_edges_tensor generation:  0.0004916191101074219
mini_batch_src_global generation:  0.0010669231414794922
r_  generation:  0.009737253189086914
local_output_nid generation:  0.0007696151733398438
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.001046895980834961
r_  generation:  0.010076761245727539
local_output_nid generation:  0.0007550716400146484
local_in_edges_tensor generation:  0.00048470497131347656
mini_batch_src_global generation:  0.0010478496551513672
r_  generation:  0.010049819946289062
local_output_nid generation:  0.0007617473602294922
local_in_edges_tensor generation:  0.0004754066467285156
mini_batch_src_global generation:  0.0010094642639160156
r_  generation:  0.00979471206665039
local_output_nid generation:  0.0007388591766357422
local_in_edges_tensor generation:  0.00046181678771972656
mini_batch_src_global generation:  0.000993490219116211
r_  generation:  0.010084390640258789
local_output_nid generation:  0.0007960796356201172
local_in_edges_tensor generation:  0.0004994869232177734
mini_batch_src_global generation:  0.0010290145874023438
r_  generation:  0.010102272033691406
local_output_nid generation:  0.0007548332214355469
local_in_edges_tensor generation:  0.004221439361572266
mini_batch_src_global generation:  0.0012276172637939453
r_  generation:  0.009911298751831055
local_output_nid generation:  0.0008032321929931641
local_in_edges_tensor generation:  0.0005106925964355469
mini_batch_src_global generation:  0.0010671615600585938
r_  generation:  0.009704828262329102
local_output_nid generation:  0.0007662773132324219
local_in_edges_tensor generation:  0.0004975795745849609
mini_batch_src_global generation:  0.0010764598846435547
r_  generation:  0.010122299194335938
----------------------check_connections_block total spend ----------------------------- 0.48697924613952637
generate_one_block  0.015619516372680664
generate_one_block  0.015092611312866211
generate_one_block  0.014869928359985352
generate_one_block  0.01392817497253418
generate_one_block  0.014775514602661133
generate_one_block  0.014611244201660156
generate_one_block  0.014560937881469727
generate_one_block  0.01540994644165039
generate_one_block  0.014673233032226562
generate_one_block  0.015136480331420898
generate_one_block  0.01529836654663086
generate_one_block  0.015159845352172852
generate_one_block  0.015067577362060547
generate_one_block  0.015340805053710938
generate_one_block  0.01560211181640625
generate_one_block  0.014512300491333008
generate_one_block  0.01437687873840332
generate_one_block  0.015466690063476562
generate_one_block  0.014621973037719727
generate_one_block  0.014637231826782227
generate_one_block  0.014846563339233398
generate_one_block  0.015188455581665039
generate_one_block  0.014489173889160156
generate_one_block  0.014098167419433594
generate_one_block  0.015045642852783203
generate_one_block  0.014915943145751953
generate_one_block  0.01456308364868164
generate_one_block  0.014831066131591797
generate_one_block  0.014909982681274414
generate_one_block  0.014449834823608398
generate_one_block  0.014561891555786133
generate_one_block  0.015275001525878906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044534921646118164
gen group dst list time:  0.023129701614379883
time for parepare:  0.01972794532775879
local_output_nid generation:  0.004441261291503906
local_in_edges_tensor generation:  0.01361083984375
mini_batch_src_global generation:  0.0166473388671875
r_  generation:  0.16244912147521973
local_output_nid generation:  0.008661985397338867
local_in_edges_tensor generation:  0.014411449432373047
mini_batch_src_global generation:  0.020738601684570312
r_  generation:  0.16500163078308105
local_output_nid generation:  0.008445978164672852
local_in_edges_tensor generation:  0.011497259140014648
mini_batch_src_global generation:  0.01927638053894043
r_  generation:  0.16684484481811523
local_output_nid generation:  0.00836038589477539
local_in_edges_tensor generation:  0.009877681732177734
mini_batch_src_global generation:  0.019687414169311523
r_  generation:  0.1608290672302246
local_output_nid generation:  0.008823871612548828
local_in_edges_tensor generation:  0.011635303497314453
mini_batch_src_global generation:  0.020879030227661133
r_  generation:  0.17325806617736816
local_output_nid generation:  0.00902414321899414
local_in_edges_tensor generation:  0.008910417556762695
mini_batch_src_global generation:  0.022064924240112305
r_  generation:  0.17057514190673828
local_output_nid generation:  0.009058713912963867
local_in_edges_tensor generation:  0.008769512176513672
mini_batch_src_global generation:  0.022015810012817383
r_  generation:  0.17834186553955078
local_output_nid generation:  0.00956273078918457
local_in_edges_tensor generation:  0.010917425155639648
mini_batch_src_global generation:  0.023937702178955078
r_  generation:  0.18012452125549316
local_output_nid generation:  0.009320974349975586
local_in_edges_tensor generation:  0.010731935501098633
mini_batch_src_global generation:  0.02236652374267578
r_  generation:  0.175978422164917
local_output_nid generation:  0.00957798957824707
local_in_edges_tensor generation:  0.010562658309936523
mini_batch_src_global generation:  0.023879528045654297
r_  generation:  0.17769765853881836
local_output_nid generation:  0.009584188461303711
local_in_edges_tensor generation:  0.010722637176513672
mini_batch_src_global generation:  0.023320436477661133
r_  generation:  0.18130922317504883
local_output_nid generation:  0.009776592254638672
local_in_edges_tensor generation:  0.013952493667602539
mini_batch_src_global generation:  0.023440837860107422
r_  generation:  0.18035244941711426
local_output_nid generation:  0.009754419326782227
local_in_edges_tensor generation:  0.010790109634399414
mini_batch_src_global generation:  0.023055076599121094
r_  generation:  0.18056654930114746
local_output_nid generation:  0.009793519973754883
local_in_edges_tensor generation:  0.010957956314086914
mini_batch_src_global generation:  0.02460503578186035
r_  generation:  0.18579864501953125
local_output_nid generation:  0.010098457336425781
local_in_edges_tensor generation:  0.0142364501953125
mini_batch_src_global generation:  0.023888587951660156
r_  generation:  0.18671917915344238
local_output_nid generation:  0.009508609771728516
local_in_edges_tensor generation:  0.009558916091918945
mini_batch_src_global generation:  0.023354530334472656
r_  generation:  0.17509937286376953
local_output_nid generation:  0.009392976760864258
local_in_edges_tensor generation:  0.008989334106445312
mini_batch_src_global generation:  0.022181272506713867
r_  generation:  0.1723616123199463
local_output_nid generation:  0.010166406631469727
local_in_edges_tensor generation:  0.009698629379272461
mini_batch_src_global generation:  0.023670196533203125
r_  generation:  0.18924641609191895
local_output_nid generation:  0.009694099426269531
local_in_edges_tensor generation:  0.010727643966674805
mini_batch_src_global generation:  0.023201465606689453
r_  generation:  0.17922043800354004
local_output_nid generation:  0.009613513946533203
local_in_edges_tensor generation:  0.009230375289916992
mini_batch_src_global generation:  0.022426366806030273
r_  generation:  0.17630910873413086
local_output_nid generation:  0.00974273681640625
local_in_edges_tensor generation:  0.011031627655029297
mini_batch_src_global generation:  0.024532079696655273
r_  generation:  0.18197417259216309
local_output_nid generation:  0.01000666618347168
local_in_edges_tensor generation:  0.012791872024536133
mini_batch_src_global generation:  0.02500128746032715
r_  generation:  0.1886138916015625
local_output_nid generation:  0.00956273078918457
local_in_edges_tensor generation:  0.009340047836303711
mini_batch_src_global generation:  0.0232083797454834
r_  generation:  0.17509818077087402
local_output_nid generation:  0.009427785873413086
local_in_edges_tensor generation:  0.009000301361083984
mini_batch_src_global generation:  0.021928071975708008
r_  generation:  0.17102265357971191
local_output_nid generation:  0.009992122650146484
local_in_edges_tensor generation:  0.012387990951538086
mini_batch_src_global generation:  0.022890329360961914
r_  generation:  0.18466925621032715
local_output_nid generation:  0.009739398956298828
local_in_edges_tensor generation:  0.011110305786132812
mini_batch_src_global generation:  0.02315521240234375
r_  generation:  0.17947101593017578
local_output_nid generation:  0.009779691696166992
local_in_edges_tensor generation:  0.009392976760864258
mini_batch_src_global generation:  0.02276325225830078
r_  generation:  0.17777466773986816
local_output_nid generation:  0.009856939315795898
local_in_edges_tensor generation:  0.012425661087036133
mini_batch_src_global generation:  0.022748947143554688
r_  generation:  0.1810600757598877
local_output_nid generation:  0.009946584701538086
local_in_edges_tensor generation:  0.009540796279907227
mini_batch_src_global generation:  0.022923707962036133
r_  generation:  0.1804203987121582
local_output_nid generation:  0.009619951248168945
local_in_edges_tensor generation:  0.009215831756591797
mini_batch_src_global generation:  0.025913238525390625
r_  generation:  0.1752302646636963
local_output_nid generation:  0.009533405303955078
local_in_edges_tensor generation:  0.011520147323608398
mini_batch_src_global generation:  0.021910905838012695
r_  generation:  0.17589235305786133
local_output_nid generation:  0.010000228881835938
local_in_edges_tensor generation:  0.01074361801147461
mini_batch_src_global generation:  0.024930715560913086
r_  generation:  0.18431949615478516
----------------------check_connections_block total spend ----------------------------- 8.368393898010254
generate_one_block  0.23724794387817383
generate_one_block  0.22706079483032227
generate_one_block  0.24691319465637207
generate_one_block  0.21473026275634766
generate_one_block  0.22764110565185547
generate_one_block  0.2286686897277832
generate_one_block  0.2231299877166748
generate_one_block  0.23250937461853027
generate_one_block  0.22440171241760254
generate_one_block  0.2275090217590332
generate_one_block  0.2333519458770752
generate_one_block  0.23462581634521484
generate_one_block  0.22763776779174805
generate_one_block  0.24026918411254883
generate_one_block  0.2406759262084961
generate_one_block  0.24534130096435547
generate_one_block  0.21465086936950684
generate_one_block  0.24272441864013672
generate_one_block  0.2239851951599121
generate_one_block  0.22233343124389648
generate_one_block  0.22923731803894043
generate_one_block  0.238447904586792
generate_one_block  0.2208864688873291
generate_one_block  0.2137925624847412
generate_one_block  0.23025155067443848
generate_one_block  0.23080134391784668
generate_one_block  0.21919775009155273
generate_one_block  0.2281954288482666
generate_one_block  0.22774672508239746
generate_one_block  0.22133183479309082
generate_one_block  0.22095441818237305
generate_one_block  0.23315930366516113
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041321754455566406
gen group dst list time:  0.10336709022521973
time for parepare:  0.018925905227661133
local_output_nid generation:  0.02212357521057129
local_in_edges_tensor generation:  0.07116198539733887
mini_batch_src_global generation:  0.04470419883728027
r_  generation:  0.42400574684143066
local_output_nid generation:  0.030518770217895508
local_in_edges_tensor generation:  0.042337894439697266
mini_batch_src_global generation:  0.0647895336151123
r_  generation:  0.4375486373901367
local_output_nid generation:  0.02870917320251465
local_in_edges_tensor generation:  0.04374122619628906
mini_batch_src_global generation:  0.05167222023010254
r_  generation:  0.4286460876464844
local_output_nid generation:  0.028629779815673828
local_in_edges_tensor generation:  0.036425113677978516
mini_batch_src_global generation:  0.049475669860839844
r_  generation:  0.4192357063293457
local_output_nid generation:  0.03968381881713867
local_in_edges_tensor generation:  0.0312802791595459
mini_batch_src_global generation:  0.050080060958862305
r_  generation:  0.4289090633392334
local_output_nid generation:  0.028159379959106445
local_in_edges_tensor generation:  0.03201913833618164
mini_batch_src_global generation:  0.054103851318359375
r_  generation:  0.42763495445251465
local_output_nid generation:  0.027893781661987305
local_in_edges_tensor generation:  0.028557777404785156
mini_batch_src_global generation:  0.05085921287536621
r_  generation:  0.4294712543487549
local_output_nid generation:  0.028556108474731445
local_in_edges_tensor generation:  0.03573942184448242
mini_batch_src_global generation:  0.053740739822387695
r_  generation:  0.4309811592102051
local_output_nid generation:  0.028079748153686523
local_in_edges_tensor generation:  0.028059720993041992
mini_batch_src_global generation:  0.05055642127990723
r_  generation:  0.4329509735107422
local_output_nid generation:  0.02835369110107422
local_in_edges_tensor generation:  0.03169727325439453
mini_batch_src_global generation:  0.05089569091796875
r_  generation:  0.42662858963012695
local_output_nid generation:  0.028280973434448242
local_in_edges_tensor generation:  0.03631711006164551
mini_batch_src_global generation:  0.053899526596069336
r_  generation:  0.4340794086456299
local_output_nid generation:  0.028959035873413086
local_in_edges_tensor generation:  0.03553056716918945
mini_batch_src_global generation:  0.05058026313781738
r_  generation:  0.43607640266418457
local_output_nid generation:  0.02834177017211914
local_in_edges_tensor generation:  0.03212475776672363
mini_batch_src_global generation:  0.05088615417480469
r_  generation:  0.4329550266265869
local_output_nid generation:  0.02863907814025879
local_in_edges_tensor generation:  0.031674861907958984
mini_batch_src_global generation:  0.053710222244262695
r_  generation:  0.4363749027252197
local_output_nid generation:  0.029726028442382812
local_in_edges_tensor generation:  0.03506207466125488
mini_batch_src_global generation:  0.054718017578125
r_  generation:  0.433976411819458
local_output_nid generation:  0.028284311294555664
local_in_edges_tensor generation:  0.028674840927124023
mini_batch_src_global generation:  0.051439762115478516
r_  generation:  0.4288814067840576
local_output_nid generation:  0.028598308563232422
local_in_edges_tensor generation:  0.027956724166870117
mini_batch_src_global generation:  0.05160784721374512
r_  generation:  0.4362168312072754
local_output_nid generation:  0.028961658477783203
local_in_edges_tensor generation:  0.04346346855163574
mini_batch_src_global generation:  0.051221370697021484
r_  generation:  0.44096946716308594
local_output_nid generation:  0.02849864959716797
local_in_edges_tensor generation:  0.030291080474853516
mini_batch_src_global generation:  0.051978349685668945
r_  generation:  0.43464183807373047
local_output_nid generation:  0.02863764762878418
local_in_edges_tensor generation:  0.02919793128967285
mini_batch_src_global generation:  0.05082583427429199
r_  generation:  0.4306979179382324
local_output_nid generation:  0.0285189151763916
local_in_edges_tensor generation:  0.032106637954711914
mini_batch_src_global generation:  0.05131649971008301
r_  generation:  0.4372901916503906
local_output_nid generation:  0.028897523880004883
local_in_edges_tensor generation:  0.03658628463745117
mini_batch_src_global generation:  0.05119037628173828
r_  generation:  0.43473076820373535
local_output_nid generation:  0.028259992599487305
local_in_edges_tensor generation:  0.0283963680267334
mini_batch_src_global generation:  0.05172300338745117
r_  generation:  0.4337160587310791
local_output_nid generation:  0.028098583221435547
local_in_edges_tensor generation:  0.03418779373168945
mini_batch_src_global generation:  0.051482439041137695
r_  generation:  0.42993617057800293
local_output_nid generation:  0.028553247451782227
local_in_edges_tensor generation:  0.03215479850769043
mini_batch_src_global generation:  0.05143260955810547
r_  generation:  0.4365065097808838
local_output_nid generation:  0.028167009353637695
local_in_edges_tensor generation:  0.03509354591369629
mini_batch_src_global generation:  0.0515894889831543
r_  generation:  0.4316723346710205
local_output_nid generation:  0.028600692749023438
local_in_edges_tensor generation:  0.031160593032836914
mini_batch_src_global generation:  0.05425524711608887
r_  generation:  0.4322543144226074
local_output_nid generation:  0.028543710708618164
local_in_edges_tensor generation:  0.03200936317443848
mini_batch_src_global generation:  0.05403399467468262
r_  generation:  0.444368839263916
local_output_nid generation:  0.02902078628540039
local_in_edges_tensor generation:  0.035565853118896484
mini_batch_src_global generation:  0.05135512351989746
r_  generation:  0.43492722511291504
local_output_nid generation:  0.028348207473754883
local_in_edges_tensor generation:  0.028436660766601562
mini_batch_src_global generation:  0.05124783515930176
r_  generation:  0.42704176902770996
local_output_nid generation:  0.028174161911010742
local_in_edges_tensor generation:  0.028136253356933594
mini_batch_src_global generation:  0.05410313606262207
r_  generation:  0.4285159111022949
local_output_nid generation:  0.028619766235351562
local_in_edges_tensor generation:  0.03612542152404785
mini_batch_src_global generation:  0.05417227745056152
r_  generation:  0.43459296226501465
----------------------check_connections_block total spend ----------------------------- 20.6492977142334
generate_one_block  0.6799187660217285
generate_one_block  0.5609264373779297
generate_one_block  0.5616605281829834
generate_one_block  0.5449786186218262
generate_one_block  0.5550322532653809
generate_one_block  0.5648720264434814
generate_one_block  0.548342227935791
generate_one_block  0.5633611679077148
generate_one_block  0.5560498237609863
generate_one_block  0.5491788387298584
generate_one_block  0.5578570365905762
generate_one_block  0.5679459571838379
generate_one_block  0.5775024890899658
generate_one_block  0.5559577941894531
generate_one_block  0.5538361072540283
generate_one_block  0.5550591945648193
generate_one_block  0.5506882667541504
generate_one_block  0.560551643371582
generate_one_block  0.5474183559417725
generate_one_block  0.5505359172821045
generate_one_block  0.5659325122833252
generate_one_block  0.5582568645477295
generate_one_block  0.5382988452911377
generate_one_block  0.540015697479248
generate_one_block  0.5560905933380127
generate_one_block  0.55501389503479
generate_one_block  0.5494556427001953
generate_one_block  0.5570030212402344
generate_one_block  0.5482687950134277
generate_one_block  0.5409255027770996
generate_one_block  0.5387167930603027
generate_one_block  0.5619151592254639
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  29.017691612243652
block generation total time  25.200977325439453
average batch blocks generation time:  0.7875305414199829
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09048843383789062  GigaBytes
Max Memory Allocated: 0.09048843383789062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0838623046875 GB
    Memory Allocated: 19.17943000793457  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1561279296875 GB
    Memory Allocated: 0.09634923934936523  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1561279296875 GB
    Memory Allocated: 18.881990909576416  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1561279296875 GB
    Memory Allocated: 0.09634113311767578  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.84646463394165  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.09559059143066406  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.282619953155518  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.09632682800292969  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.89783477783203  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.0963282585144043  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.79331874847412  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.09599685668945312  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 18.687039852142334  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.09686517715454102  GigaBytes
Max Memory Allocated: 19.279011726379395  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.29031991958618  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09604787826538086  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.816925525665283  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09616994857788086  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.84381866455078  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09621047973632812  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.15648078918457  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09644126892089844  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.256062507629395  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09605741500854492  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.114562034606934  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09658479690551758  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.23002052307129  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09664583206176758  GigaBytes
Max Memory Allocated: 19.379573345184326  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.4607834815979  GigaBytes
Max Memory Allocated: 19.558717250823975  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09612464904785156  GigaBytes
Max Memory Allocated: 19.558717250823975  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.832808017730713  GigaBytes
Max Memory Allocated: 19.558717250823975  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09620952606201172  GigaBytes
Max Memory Allocated: 19.558717250823975  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.56173086166382  GigaBytes
Max Memory Allocated: 19.558717250823975  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09671258926391602  GigaBytes
Max Memory Allocated: 19.558717250823975  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.520389080047607  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09612321853637695  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.884286403656006  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09617280960083008  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.732670307159424  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09606266021728516  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.081168174743652  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09650897979736328  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.364580154418945  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09580659866333008  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.58332347869873  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09567499160766602  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.43977403640747  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09634113311767578  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.12330675125122  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09600448608398438  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.90415334701538  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09613180160522461  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.727503299713135  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09639120101928711  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.043705940246582  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09627914428710938  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.8795166015625  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09582805633544922  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.505535125732422  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09585762023925781  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.56135845184326  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.09633398056030273  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.207743167877197  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03758958727121353 |0.03375270217657089 |0.5917280614376068 |0.00010763853788375854 |1.089052453637123 |0.012565135955810547 |
----------------------------------------------------------pseudo_mini_loss sum 5.395556926727295
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9121591
Number of first layer input nodes during this epoch:  4765383
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.12700223922729492  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.1735532283782959
range selection method range initialization spend 0.01646113395690918
time for parepare:  0.017988204956054688
local_output_nid generation:  0.0009071826934814453
local_in_edges_tensor generation:  0.0060923099517822266
mini_batch_src_global generation:  0.0019910335540771484
r_  generation:  0.01166534423828125
local_output_nid generation:  0.0010123252868652344
local_in_edges_tensor generation:  0.0006902217864990234
mini_batch_src_global generation:  0.001611471176147461
r_  generation:  0.010540246963500977
local_output_nid generation:  0.0009579658508300781
local_in_edges_tensor generation:  0.0006301403045654297
mini_batch_src_global generation:  0.0011379718780517578
r_  generation:  0.009692907333374023
local_output_nid generation:  0.0009343624114990234
local_in_edges_tensor generation:  0.0005941390991210938
mini_batch_src_global generation:  0.0010578632354736328
r_  generation:  0.009558916091918945
local_output_nid generation:  0.0009026527404785156
local_in_edges_tensor generation:  0.0005779266357421875
mini_batch_src_global generation:  0.0010237693786621094
r_  generation:  0.009391069412231445
local_output_nid generation:  0.0008993148803710938
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.001142740249633789
r_  generation:  0.01044011116027832
local_output_nid generation:  0.0008671283721923828
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.001085042953491211
r_  generation:  0.009973287582397461
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0005629062652587891
mini_batch_src_global generation:  0.0010542869567871094
r_  generation:  0.009860992431640625
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005693435668945312
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.009932518005371094
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0011126995086669922
r_  generation:  0.010396718978881836
local_output_nid generation:  0.0009036064147949219
local_in_edges_tensor generation:  0.0005893707275390625
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.010567426681518555
local_output_nid generation:  0.0008831024169921875
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.0011823177337646484
r_  generation:  0.01010441780090332
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005736351013183594
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.010463953018188477
local_output_nid generation:  0.0008687973022460938
local_in_edges_tensor generation:  0.0005769729614257812
mini_batch_src_global generation:  0.0011568069458007812
r_  generation:  0.0101776123046875
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0005643367767333984
mini_batch_src_global generation:  0.0010914802551269531
r_  generation:  0.010086536407470703
local_output_nid generation:  0.0008687973022460938
local_in_edges_tensor generation:  0.0005805492401123047
mini_batch_src_global generation:  0.0011241436004638672
r_  generation:  0.010070323944091797
local_output_nid generation:  0.0008487701416015625
local_in_edges_tensor generation:  0.0005431175231933594
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.010149478912353516
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0005600452423095703
mini_batch_src_global generation:  0.0010762214660644531
r_  generation:  0.009932756423950195
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0010933876037597656
r_  generation:  0.010149955749511719
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005450248718261719
mini_batch_src_global generation:  0.0010614395141601562
r_  generation:  0.009967565536499023
local_output_nid generation:  0.0008592605590820312
local_in_edges_tensor generation:  0.0005407333374023438
mini_batch_src_global generation:  0.0011792182922363281
r_  generation:  0.010267257690429688
local_output_nid generation:  0.0008525848388671875
local_in_edges_tensor generation:  0.0005733966827392578
mini_batch_src_global generation:  0.0011548995971679688
r_  generation:  0.0101318359375
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0005795955657958984
mini_batch_src_global generation:  0.0011568069458007812
r_  generation:  0.010471582412719727
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0005829334259033203
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.010674715042114258
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.010284423828125
local_output_nid generation:  0.0008761882781982422
local_in_edges_tensor generation:  0.0005555152893066406
mini_batch_src_global generation:  0.001146078109741211
r_  generation:  0.01019287109375
local_output_nid generation:  0.0008518695831298828
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.0011563301086425781
r_  generation:  0.010373353958129883
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.010106325149536133
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0005657672882080078
mini_batch_src_global generation:  0.0010976791381835938
r_  generation:  0.010170936584472656
local_output_nid generation:  0.0008528232574462891
local_in_edges_tensor generation:  0.0005733966827392578
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.01006937026977539
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.0011088848114013672
r_  generation:  0.010330438613891602
local_output_nid generation:  0.0008609294891357422
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.010523080825805664
----------------------check_connections_block total spend ----------------------------- 0.514493465423584
generate_one_block  0.03567194938659668
generate_one_block  0.02293109893798828
generate_one_block  0.020029067993164062
generate_one_block  0.01901841163635254
generate_one_block  0.018671512603759766
generate_one_block  0.020438194274902344
generate_one_block  0.01901841163635254
generate_one_block  0.032236576080322266
generate_one_block  0.01882624626159668
generate_one_block  0.01911449432373047
generate_one_block  0.019154071807861328
generate_one_block  0.01861572265625
generate_one_block  0.018988609313964844
generate_one_block  0.018512487411499023
generate_one_block  0.018103361129760742
generate_one_block  0.018254995346069336
generate_one_block  0.018140792846679688
generate_one_block  0.017899751663208008
generate_one_block  0.018251895904541016
generate_one_block  0.017850637435913086
generate_one_block  0.018385648727416992
generate_one_block  0.01839733123779297
generate_one_block  0.018743038177490234
generate_one_block  0.019085168838500977
generate_one_block  0.01841425895690918
generate_one_block  0.018138408660888672
generate_one_block  0.018456220626831055
generate_one_block  0.017995834350585938
generate_one_block  0.018210172653198242
generate_one_block  0.018070697784423828
generate_one_block  0.018434524536132812
generate_one_block  0.018453359603881836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05624985694885254
gen group dst list time:  0.02507162094116211
time for parepare:  0.021324872970581055
local_output_nid generation:  0.00630640983581543
local_in_edges_tensor generation:  0.016927003860473633
mini_batch_src_global generation:  0.0161130428314209
r_  generation:  0.17448711395263672
local_output_nid generation:  0.009166479110717773
local_in_edges_tensor generation:  0.012242794036865234
mini_batch_src_global generation:  0.03207087516784668
r_  generation:  0.1762070655822754
local_output_nid generation:  0.012784957885742188
local_in_edges_tensor generation:  0.03489542007446289
mini_batch_src_global generation:  0.03533649444580078
r_  generation:  0.18538141250610352
local_output_nid generation:  0.011407852172851562
local_in_edges_tensor generation:  0.01282501220703125
mini_batch_src_global generation:  0.0256040096282959
r_  generation:  0.18880867958068848
local_output_nid generation:  0.010926246643066406
local_in_edges_tensor generation:  0.009288787841796875
mini_batch_src_global generation:  0.025374650955200195
r_  generation:  0.18898487091064453
local_output_nid generation:  0.013454437255859375
local_in_edges_tensor generation:  0.013179779052734375
mini_batch_src_global generation:  0.02954721450805664
r_  generation:  0.20513415336608887
local_output_nid generation:  0.010097980499267578
local_in_edges_tensor generation:  0.012471199035644531
mini_batch_src_global generation:  0.029474973678588867
r_  generation:  0.19483113288879395
local_output_nid generation:  0.010005950927734375
local_in_edges_tensor generation:  0.009125947952270508
mini_batch_src_global generation:  0.02913975715637207
r_  generation:  0.19031095504760742
local_output_nid generation:  0.010832548141479492
local_in_edges_tensor generation:  0.009380102157592773
mini_batch_src_global generation:  0.026020288467407227
r_  generation:  0.19185447692871094
local_output_nid generation:  0.01139068603515625
local_in_edges_tensor generation:  0.01301121711730957
mini_batch_src_global generation:  0.027619600296020508
r_  generation:  0.19965744018554688
local_output_nid generation:  0.011420488357543945
local_in_edges_tensor generation:  0.011208534240722656
mini_batch_src_global generation:  0.02822566032409668
r_  generation:  0.207505464553833
local_output_nid generation:  0.013689041137695312
local_in_edges_tensor generation:  0.01287841796875
mini_batch_src_global generation:  0.026627063751220703
r_  generation:  0.21108770370483398
local_output_nid generation:  0.015888452529907227
local_in_edges_tensor generation:  0.015914440155029297
mini_batch_src_global generation:  0.028133392333984375
r_  generation:  0.2058115005493164
local_output_nid generation:  0.011214971542358398
local_in_edges_tensor generation:  0.011540651321411133
mini_batch_src_global generation:  0.026319265365600586
r_  generation:  0.19698882102966309
local_output_nid generation:  0.010919570922851562
local_in_edges_tensor generation:  0.010100841522216797
mini_batch_src_global generation:  0.025686979293823242
r_  generation:  0.1951901912689209
local_output_nid generation:  0.011267662048339844
local_in_edges_tensor generation:  0.011519432067871094
mini_batch_src_global generation:  0.026345014572143555
r_  generation:  0.19769620895385742
local_output_nid generation:  0.011437654495239258
local_in_edges_tensor generation:  0.012572050094604492
mini_batch_src_global generation:  0.02655792236328125
r_  generation:  0.19640159606933594
local_output_nid generation:  0.01101374626159668
local_in_edges_tensor generation:  0.009535551071166992
mini_batch_src_global generation:  0.025523662567138672
r_  generation:  0.1961362361907959
local_output_nid generation:  0.01058053970336914
local_in_edges_tensor generation:  0.011391162872314453
mini_batch_src_global generation:  0.027527809143066406
r_  generation:  0.1955580711364746
local_output_nid generation:  0.010431766510009766
local_in_edges_tensor generation:  0.010312795639038086
mini_batch_src_global generation:  0.025184154510498047
r_  generation:  0.1930394172668457
local_output_nid generation:  0.010444402694702148
local_in_edges_tensor generation:  0.010373592376708984
mini_batch_src_global generation:  0.027355194091796875
r_  generation:  0.20903468132019043
local_output_nid generation:  0.010563850402832031
local_in_edges_tensor generation:  0.011275768280029297
mini_batch_src_global generation:  0.026697158813476562
r_  generation:  0.19943499565124512
local_output_nid generation:  0.010883808135986328
local_in_edges_tensor generation:  0.012999773025512695
mini_batch_src_global generation:  0.027060270309448242
r_  generation:  0.20171809196472168
local_output_nid generation:  0.012540340423583984
local_in_edges_tensor generation:  0.011933326721191406
mini_batch_src_global generation:  0.0287477970123291
r_  generation:  0.21081233024597168
local_output_nid generation:  0.010628461837768555
local_in_edges_tensor generation:  0.009889602661132812
mini_batch_src_global generation:  0.02723407745361328
r_  generation:  0.19994139671325684
local_output_nid generation:  0.010628938674926758
local_in_edges_tensor generation:  0.012894153594970703
mini_batch_src_global generation:  0.026603221893310547
r_  generation:  0.206193208694458
local_output_nid generation:  0.01172018051147461
local_in_edges_tensor generation:  0.01758885383605957
mini_batch_src_global generation:  0.027104616165161133
r_  generation:  0.20162343978881836
local_output_nid generation:  0.010426521301269531
local_in_edges_tensor generation:  0.022875070571899414
mini_batch_src_global generation:  0.050266265869140625
r_  generation:  0.1859738826751709
local_output_nid generation:  0.013204574584960938
local_in_edges_tensor generation:  0.011134147644042969
mini_batch_src_global generation:  0.02425670623779297
r_  generation:  0.181959867477417
local_output_nid generation:  0.008780479431152344
local_in_edges_tensor generation:  0.009901285171508789
mini_batch_src_global generation:  0.023169517517089844
r_  generation:  0.18117523193359375
local_output_nid generation:  0.008905649185180664
local_in_edges_tensor generation:  0.010359525680541992
mini_batch_src_global generation:  0.02315354347229004
r_  generation:  0.1821141242980957
local_output_nid generation:  0.008815765380859375
local_in_edges_tensor generation:  0.01042795181274414
mini_batch_src_global generation:  0.023415565490722656
r_  generation:  0.1855146884918213
----------------------check_connections_block total spend ----------------------------- 9.365530252456665
generate_one_block  0.25463080406188965
generate_one_block  0.23880839347839355
generate_one_block  0.2381436824798584
generate_one_block  0.24207234382629395
generate_one_block  0.27527952194213867
generate_one_block  0.261627197265625
generate_one_block  0.24178338050842285
generate_one_block  0.23843026161193848
generate_one_block  0.25264930725097656
generate_one_block  0.25601840019226074
generate_one_block  0.2548534870147705
generate_one_block  0.24550223350524902
generate_one_block  0.25905776023864746
generate_one_block  0.2384052276611328
generate_one_block  0.239945650100708
generate_one_block  0.2458202838897705
generate_one_block  0.24038958549499512
generate_one_block  0.241485595703125
generate_one_block  0.2404630184173584
generate_one_block  0.24184370040893555
generate_one_block  0.24316811561584473
generate_one_block  0.26189541816711426
generate_one_block  0.2587394714355469
generate_one_block  0.2587287425994873
generate_one_block  0.2570350170135498
generate_one_block  0.24996495246887207
generate_one_block  0.2534339427947998
generate_one_block  0.24653840065002441
generate_one_block  0.2447664737701416
generate_one_block  0.2514219284057617
generate_one_block  0.2461256980895996
generate_one_block  0.25054073333740234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04618239402770996
gen group dst list time:  0.11824989318847656
time for parepare:  0.018825531005859375
local_output_nid generation:  0.025307655334472656
local_in_edges_tensor generation:  0.05387711524963379
mini_batch_src_global generation:  0.0397028923034668
r_  generation:  0.44129204750061035
local_output_nid generation:  0.03011178970336914
local_in_edges_tensor generation:  0.04233980178833008
mini_batch_src_global generation:  0.050005435943603516
r_  generation:  0.42403721809387207
local_output_nid generation:  0.030042409896850586
local_in_edges_tensor generation:  0.03109431266784668
mini_batch_src_global generation:  0.0489962100982666
r_  generation:  0.4320988655090332
local_output_nid generation:  0.028311491012573242
local_in_edges_tensor generation:  0.027191877365112305
mini_batch_src_global generation:  0.04950737953186035
r_  generation:  0.4204418659210205
local_output_nid generation:  0.02864861488342285
local_in_edges_tensor generation:  0.034633636474609375
mini_batch_src_global generation:  0.04993128776550293
r_  generation:  0.4292747974395752
local_output_nid generation:  0.02891826629638672
local_in_edges_tensor generation:  0.034740447998046875
mini_batch_src_global generation:  0.05098748207092285
r_  generation:  0.43134474754333496
local_output_nid generation:  0.028882265090942383
local_in_edges_tensor generation:  0.02668905258178711
mini_batch_src_global generation:  0.05072021484375
r_  generation:  0.432675838470459
local_output_nid generation:  0.02895665168762207
local_in_edges_tensor generation:  0.03121352195739746
mini_batch_src_global generation:  0.05086398124694824
r_  generation:  0.42905735969543457
local_output_nid generation:  0.031568050384521484
local_in_edges_tensor generation:  0.03919792175292969
mini_batch_src_global generation:  0.05508708953857422
r_  generation:  0.43778562545776367
local_output_nid generation:  0.029598712921142578
local_in_edges_tensor generation:  0.028050661087036133
mini_batch_src_global generation:  0.05136919021606445
r_  generation:  0.438551664352417
local_output_nid generation:  0.02966594696044922
local_in_edges_tensor generation:  0.03172755241394043
mini_batch_src_global generation:  0.05440235137939453
r_  generation:  0.44185709953308105
local_output_nid generation:  0.029523611068725586
local_in_edges_tensor generation:  0.03279423713684082
mini_batch_src_global generation:  0.05124044418334961
r_  generation:  0.4343736171722412
local_output_nid generation:  0.029713153839111328
local_in_edges_tensor generation:  0.02783799171447754
mini_batch_src_global generation:  0.05219078063964844
r_  generation:  0.4362833499908447
local_output_nid generation:  0.03345322608947754
local_in_edges_tensor generation:  0.03594017028808594
mini_batch_src_global generation:  0.05070638656616211
r_  generation:  0.43547606468200684
local_output_nid generation:  0.029396533966064453
local_in_edges_tensor generation:  0.031132221221923828
mini_batch_src_global generation:  0.05178976058959961
r_  generation:  0.44127488136291504
local_output_nid generation:  0.030835628509521484
local_in_edges_tensor generation:  0.03621268272399902
mini_batch_src_global generation:  0.05230283737182617
r_  generation:  0.44248151779174805
local_output_nid generation:  0.03187394142150879
local_in_edges_tensor generation:  0.04265093803405762
mini_batch_src_global generation:  0.05182361602783203
r_  generation:  0.4383389949798584
local_output_nid generation:  0.03095245361328125
local_in_edges_tensor generation:  0.028836727142333984
mini_batch_src_global generation:  0.05133676528930664
r_  generation:  0.43466782569885254
local_output_nid generation:  0.030161619186401367
local_in_edges_tensor generation:  0.02861475944519043
mini_batch_src_global generation:  0.050215721130371094
r_  generation:  0.44173264503479004
local_output_nid generation:  0.030134916305541992
local_in_edges_tensor generation:  0.03198409080505371
mini_batch_src_global generation:  0.05160045623779297
r_  generation:  0.4320948123931885
local_output_nid generation:  0.030138492584228516
local_in_edges_tensor generation:  0.0357818603515625
mini_batch_src_global generation:  0.05045676231384277
r_  generation:  0.4332108497619629
local_output_nid generation:  0.030524730682373047
local_in_edges_tensor generation:  0.0357203483581543
mini_batch_src_global generation:  0.07030963897705078
r_  generation:  0.44065308570861816
local_output_nid generation:  0.030507326126098633
local_in_edges_tensor generation:  0.03143763542175293
mini_batch_src_global generation:  0.051549434661865234
r_  generation:  0.4408540725708008
local_output_nid generation:  0.0304262638092041
local_in_edges_tensor generation:  0.031307220458984375
mini_batch_src_global generation:  0.05318474769592285
r_  generation:  0.44405508041381836
local_output_nid generation:  0.03213334083557129
local_in_edges_tensor generation:  0.031908273696899414
mini_batch_src_global generation:  0.05550980567932129
r_  generation:  0.4449276924133301
local_output_nid generation:  0.030180692672729492
local_in_edges_tensor generation:  0.028116226196289062
mini_batch_src_global generation:  0.05234098434448242
r_  generation:  0.43445682525634766
local_output_nid generation:  0.03032231330871582
local_in_edges_tensor generation:  0.03246641159057617
mini_batch_src_global generation:  0.051618337631225586
r_  generation:  0.4427633285522461
local_output_nid generation:  0.031072139739990234
local_in_edges_tensor generation:  0.04119729995727539
mini_batch_src_global generation:  0.0672457218170166
r_  generation:  0.4365522861480713
local_output_nid generation:  0.031320810317993164
local_in_edges_tensor generation:  0.03454160690307617
mini_batch_src_global generation:  0.0511012077331543
r_  generation:  0.43306493759155273
local_output_nid generation:  0.030317306518554688
local_in_edges_tensor generation:  0.030118703842163086
mini_batch_src_global generation:  0.05144238471984863
r_  generation:  0.43175435066223145
local_output_nid generation:  0.03017115592956543
local_in_edges_tensor generation:  0.03416943550109863
mini_batch_src_global generation:  0.05096888542175293
r_  generation:  0.4337432384490967
local_output_nid generation:  0.030043601989746094
local_in_edges_tensor generation:  0.029933452606201172
mini_batch_src_global generation:  0.051252126693725586
r_  generation:  0.430858850479126
----------------------check_connections_block total spend ----------------------------- 20.82197856903076
generate_one_block  0.5880677700042725
generate_one_block  0.580963134765625
generate_one_block  0.5758140087127686
generate_one_block  0.5719044208526611
generate_one_block  0.6819794178009033
generate_one_block  0.5772225856781006
generate_one_block  0.5826222896575928
generate_one_block  0.5785617828369141
generate_one_block  0.5893561840057373
generate_one_block  0.5836400985717773
generate_one_block  0.587064266204834
generate_one_block  0.5689411163330078
generate_one_block  0.5817773342132568
generate_one_block  0.5716445446014404
generate_one_block  0.5753414630889893
generate_one_block  0.5828585624694824
generate_one_block  0.5845339298248291
generate_one_block  0.5776534080505371
generate_one_block  0.5712192058563232
generate_one_block  0.5993013381958008
generate_one_block  0.59334397315979
generate_one_block  0.5897400379180908
generate_one_block  0.5917456150054932
generate_one_block  0.5837869644165039
generate_one_block  0.5936274528503418
generate_one_block  0.5861682891845703
generate_one_block  0.5847015380859375
generate_one_block  0.5741145610809326
generate_one_block  0.5840620994567871
generate_one_block  0.5790648460388184
generate_one_block  0.5793945789337158
generate_one_block  0.5832748413085938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.12700223922729492  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

connection checking time:  30.187508821487427
block generation total time  26.703060388565063
average batch blocks generation time:  0.8344706371426582
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.1066584587097168  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.776490688323975  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.10649538040161133  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.8790545463562  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.10662317276000977  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.598724842071533  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.1056971549987793  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.66492795944214  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.10637569427490234  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.557993412017822  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.1068263053894043  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.457784175872803  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.10631847381591797  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.750221252441406  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.10663652420043945  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.626057624816895  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.10788631439208984  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 18.854063510894775  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.10678243637084961  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 19.234522819519043  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4510498046875 GB
    Memory Allocated: 0.10701465606689453  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 19.371184825897217  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10642719268798828  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.95152521133423  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10669088363647461  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.334375381469727  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10646581649780273  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.643455028533936  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10624265670776367  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.667770385742188  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10675621032714844  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.925164699554443  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10657596588134766  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.767730712890625  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10632801055908203  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.69456148147583  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10629510879516602  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.672856330871582  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1065363883972168  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.55245542526245  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10657453536987305  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.726327896118164  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10684919357299805  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.946689128875732  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10692453384399414  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.190105438232422  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10677003860473633  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.397351264953613  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10690736770629883  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.142533779144287  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10651636123657227  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.0391583442688  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10671567916870117  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.190508365631104  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10669136047363281  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.8416748046875  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10647773742675781  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.91581964492798  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10678482055664062  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.878732681274414  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10651397705078125  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.7969970703125  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10646343231201172  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.108566284179688  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030545637011528015 |0.020941399037837982 |0.5593290477991104 |9.632110595703125e-05 |1.0707540437579155 |0.009822845458984375 |
----------------------------------------------------------pseudo_mini_loss sum 3.9401516914367676
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9112886
Number of first layer input nodes during this epoch:  4761241
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1264791488647461  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.035909414291381836
range selection method range initialization spend 0.013548135757446289
time for parepare:  0.019443750381469727
local_output_nid generation:  0.0009441375732421875
local_in_edges_tensor generation:  0.00401759147644043
mini_batch_src_global generation:  0.0015211105346679688
r_  generation:  0.010367155075073242
local_output_nid generation:  0.0009756088256835938
local_in_edges_tensor generation:  0.0006859302520751953
mini_batch_src_global generation:  0.0015072822570800781
r_  generation:  0.010245561599731445
local_output_nid generation:  0.0009360313415527344
local_in_edges_tensor generation:  0.00063323974609375
mini_batch_src_global generation:  0.0011205673217773438
r_  generation:  0.009722232818603516
local_output_nid generation:  0.0009198188781738281
local_in_edges_tensor generation:  0.0006115436553955078
mini_batch_src_global generation:  0.0011756420135498047
r_  generation:  0.010102987289428711
local_output_nid generation:  0.0008869171142578125
local_in_edges_tensor generation:  0.0005934238433837891
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.00974130630493164
local_output_nid generation:  0.0008871555328369141
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0011010169982910156
r_  generation:  0.009783267974853516
local_output_nid generation:  0.0008921623229980469
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.010137081146240234
local_output_nid generation:  0.0008778572082519531
local_in_edges_tensor generation:  0.0005762577056884766
mini_batch_src_global generation:  0.0010738372802734375
r_  generation:  0.009847164154052734
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.010534048080444336
local_output_nid generation:  0.0008900165557861328
local_in_edges_tensor generation:  0.0005857944488525391
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.010077476501464844
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0005795955657958984
mini_batch_src_global generation:  0.0011217594146728516
r_  generation:  0.010366201400756836
local_output_nid generation:  0.0008842945098876953
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0010890960693359375
r_  generation:  0.009737014770507812
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0005943775177001953
mini_batch_src_global generation:  0.0012290477752685547
r_  generation:  0.010358810424804688
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.001172780990600586
r_  generation:  0.010499238967895508
local_output_nid generation:  0.0008833408355712891
local_in_edges_tensor generation:  0.000583648681640625
mini_batch_src_global generation:  0.0011622905731201172
r_  generation:  0.010409116744995117
local_output_nid generation:  0.000896453857421875
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0012083053588867188
r_  generation:  0.010176658630371094
local_output_nid generation:  0.000881195068359375
local_in_edges_tensor generation:  0.0006070137023925781
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.010080814361572266
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0005693435668945312
mini_batch_src_global generation:  0.0010936260223388672
r_  generation:  0.010031700134277344
local_output_nid generation:  0.0008885860443115234
local_in_edges_tensor generation:  0.0005903244018554688
mini_batch_src_global generation:  0.0012390613555908203
r_  generation:  0.01054692268371582
local_output_nid generation:  0.0008828639984130859
local_in_edges_tensor generation:  0.0005609989166259766
mini_batch_src_global generation:  0.0011143684387207031
r_  generation:  0.009893655776977539
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005679130554199219
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.009946346282958984
local_output_nid generation:  0.0008766651153564453
local_in_edges_tensor generation:  0.0005557537078857422
mini_batch_src_global generation:  0.0011105537414550781
r_  generation:  0.009908199310302734
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.00116729736328125
r_  generation:  0.010343074798583984
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0005719661712646484
mini_batch_src_global generation:  0.0011708736419677734
r_  generation:  0.01016378402709961
local_output_nid generation:  0.0008676052093505859
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0012009143829345703
r_  generation:  0.010072946548461914
local_output_nid generation:  0.0009169578552246094
local_in_edges_tensor generation:  0.0006098747253417969
mini_batch_src_global generation:  0.0011639595031738281
r_  generation:  0.010509729385375977
local_output_nid generation:  0.0008816719055175781
local_in_edges_tensor generation:  0.0006079673767089844
mini_batch_src_global generation:  0.001222848892211914
r_  generation:  0.010956525802612305
local_output_nid generation:  0.0009644031524658203
local_in_edges_tensor generation:  0.0006661415100097656
mini_batch_src_global generation:  0.001329660415649414
r_  generation:  0.010910511016845703
local_output_nid generation:  0.0009653568267822266
local_in_edges_tensor generation:  0.0005867481231689453
mini_batch_src_global generation:  0.0012090206146240234
r_  generation:  0.010310173034667969
local_output_nid generation:  0.0009427070617675781
local_in_edges_tensor generation:  0.0006086826324462891
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.010263681411743164
local_output_nid generation:  0.0008823871612548828
local_in_edges_tensor generation:  0.0006172657012939453
mini_batch_src_global generation:  0.0011661052703857422
r_  generation:  0.010513782501220703
local_output_nid generation:  0.00087738037109375
local_in_edges_tensor generation:  0.0005867481231689453
mini_batch_src_global generation:  0.0012264251708984375
r_  generation:  0.01048898696899414
----------------------check_connections_block total spend ----------------------------- 0.5165116786956787
generate_one_block  0.0245058536529541
generate_one_block  0.020386695861816406
generate_one_block  0.01890397071838379
generate_one_block  0.01915431022644043
generate_one_block  0.018500328063964844
generate_one_block  0.01832890510559082
generate_one_block  0.018816232681274414
generate_one_block  0.018327713012695312
generate_one_block  0.01957535743713379
generate_one_block  0.018425703048706055
generate_one_block  0.018982648849487305
generate_one_block  0.017957210540771484
generate_one_block  0.01916050910949707
generate_one_block  0.01905226707458496
generate_one_block  0.019134998321533203
generate_one_block  0.01864457130432129
generate_one_block  0.01831960678100586
generate_one_block  0.018201112747192383
generate_one_block  0.019072771072387695
generate_one_block  0.01795029640197754
generate_one_block  0.01797652244567871
generate_one_block  0.017823219299316406
generate_one_block  0.018640995025634766
generate_one_block  0.01834845542907715
generate_one_block  0.01831674575805664
generate_one_block  0.019151687622070312
generate_one_block  0.01931929588317871
generate_one_block  0.01871514320373535
generate_one_block  0.021618366241455078
generate_one_block  0.019610881805419922
generate_one_block  0.018419504165649414
generate_one_block  0.018854856491088867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038346052169799805
gen group dst list time:  0.023433208465576172
time for parepare:  0.02006220817565918
local_output_nid generation:  0.005418300628662109
local_in_edges_tensor generation:  0.027602195739746094
mini_batch_src_global generation:  0.01755666732788086
r_  generation:  0.1551988124847412
local_output_nid generation:  0.007488727569580078
local_in_edges_tensor generation:  0.013147115707397461
mini_batch_src_global generation:  0.021454572677612305
r_  generation:  0.16225671768188477
local_output_nid generation:  0.007677555084228516
local_in_edges_tensor generation:  0.031218767166137695
mini_batch_src_global generation:  0.020462989807128906
r_  generation:  0.17140841484069824
local_output_nid generation:  0.008280277252197266
local_in_edges_tensor generation:  0.010636091232299805
mini_batch_src_global generation:  0.021953582763671875
r_  generation:  0.17706704139709473
local_output_nid generation:  0.008498907089233398
local_in_edges_tensor generation:  0.009221315383911133
mini_batch_src_global generation:  0.021326065063476562
r_  generation:  0.17623496055603027
local_output_nid generation:  0.008522272109985352
local_in_edges_tensor generation:  0.009097814559936523
mini_batch_src_global generation:  0.021758079528808594
r_  generation:  0.17639923095703125
local_output_nid generation:  0.008678197860717773
local_in_edges_tensor generation:  0.01078176498413086
mini_batch_src_global generation:  0.02275538444519043
r_  generation:  0.18447232246398926
local_output_nid generation:  0.008976459503173828
local_in_edges_tensor generation:  0.010077476501464844
mini_batch_src_global generation:  0.022422075271606445
r_  generation:  0.17755866050720215
local_output_nid generation:  0.009019851684570312
local_in_edges_tensor generation:  0.010166406631469727
mini_batch_src_global generation:  0.025798320770263672
r_  generation:  0.18766093254089355
local_output_nid generation:  0.008722066879272461
local_in_edges_tensor generation:  0.020227432250976562
mini_batch_src_global generation:  0.023191213607788086
r_  generation:  0.1786046028137207
local_output_nid generation:  0.008781194686889648
local_in_edges_tensor generation:  0.009473800659179688
mini_batch_src_global generation:  0.02450847625732422
r_  generation:  0.18578600883483887
local_output_nid generation:  0.00834512710571289
local_in_edges_tensor generation:  0.009916543960571289
mini_batch_src_global generation:  0.02270817756652832
r_  generation:  0.1728675365447998
local_output_nid generation:  0.009154081344604492
local_in_edges_tensor generation:  0.009382963180541992
mini_batch_src_global generation:  0.023220300674438477
r_  generation:  0.1859428882598877
local_output_nid generation:  0.009022712707519531
local_in_edges_tensor generation:  0.010454654693603516
mini_batch_src_global generation:  0.02380967140197754
r_  generation:  0.1848151683807373
local_output_nid generation:  0.009054183959960938
local_in_edges_tensor generation:  0.00925755500793457
mini_batch_src_global generation:  0.023009538650512695
r_  generation:  0.18190526962280273
local_output_nid generation:  0.008890867233276367
local_in_edges_tensor generation:  0.008835792541503906
mini_batch_src_global generation:  0.023050785064697266
r_  generation:  0.1793050765991211
local_output_nid generation:  0.008868694305419922
local_in_edges_tensor generation:  0.008976936340332031
mini_batch_src_global generation:  0.022460460662841797
r_  generation:  0.17783403396606445
local_output_nid generation:  0.008771181106567383
local_in_edges_tensor generation:  0.008838415145874023
mini_batch_src_global generation:  0.024429798126220703
r_  generation:  0.1772618293762207
local_output_nid generation:  0.009172916412353516
local_in_edges_tensor generation:  0.009629964828491211
mini_batch_src_global generation:  0.023426532745361328
r_  generation:  0.18676233291625977
local_output_nid generation:  0.008514165878295898
local_in_edges_tensor generation:  0.008994102478027344
mini_batch_src_global generation:  0.02326679229736328
r_  generation:  0.17914652824401855
local_output_nid generation:  0.008738517761230469
local_in_edges_tensor generation:  0.008686304092407227
mini_batch_src_global generation:  0.022724390029907227
r_  generation:  0.17957329750061035
local_output_nid generation:  0.008806228637695312
local_in_edges_tensor generation:  0.009776830673217773
mini_batch_src_global generation:  0.022383928298950195
r_  generation:  0.17543816566467285
local_output_nid generation:  0.009009361267089844
local_in_edges_tensor generation:  0.009021997451782227
mini_batch_src_global generation:  0.022905826568603516
r_  generation:  0.18473434448242188
local_output_nid generation:  0.009000301361083984
local_in_edges_tensor generation:  0.008828878402709961
mini_batch_src_global generation:  0.02351832389831543
r_  generation:  0.17964863777160645
local_output_nid generation:  0.009072303771972656
local_in_edges_tensor generation:  0.009019851684570312
mini_batch_src_global generation:  0.022658824920654297
r_  generation:  0.1845719814300537
local_output_nid generation:  0.009336709976196289
local_in_edges_tensor generation:  0.011388301849365234
mini_batch_src_global generation:  0.02480936050415039
r_  generation:  0.18853402137756348
local_output_nid generation:  0.009471654891967773
local_in_edges_tensor generation:  0.010059356689453125
mini_batch_src_global generation:  0.024367809295654297
r_  generation:  0.1996927261352539
local_output_nid generation:  0.01115727424621582
local_in_edges_tensor generation:  0.008998632431030273
mini_batch_src_global generation:  0.02904510498046875
r_  generation:  0.18649792671203613
local_output_nid generation:  0.008671760559082031
local_in_edges_tensor generation:  0.00946354866027832
mini_batch_src_global generation:  0.023504972457885742
r_  generation:  0.17922139167785645
local_output_nid generation:  0.008704900741577148
local_in_edges_tensor generation:  0.008930206298828125
mini_batch_src_global generation:  0.022844791412353516
r_  generation:  0.17915892601013184
local_output_nid generation:  0.008697271347045898
local_in_edges_tensor generation:  0.008870840072631836
mini_batch_src_global generation:  0.022748708724975586
r_  generation:  0.1802361011505127
local_output_nid generation:  0.0088653564453125
local_in_edges_tensor generation:  0.009740114212036133
mini_batch_src_global generation:  0.02338266372680664
r_  generation:  0.18291473388671875
----------------------check_connections_block total spend ----------------------------- 8.4673011302948
generate_one_block  0.2380833625793457
generate_one_block  0.2357926368713379
generate_one_block  0.2394404411315918
generate_one_block  0.24569249153137207
generate_one_block  0.2696101665496826
generate_one_block  0.2386765480041504
generate_one_block  0.244337797164917
generate_one_block  0.23960471153259277
generate_one_block  0.25020480155944824
generate_one_block  0.24845480918884277
generate_one_block  0.25055789947509766
generate_one_block  0.24011611938476562
generate_one_block  0.2517232894897461
generate_one_block  0.24768543243408203
generate_one_block  0.2442333698272705
generate_one_block  0.24271178245544434
generate_one_block  0.23543405532836914
generate_one_block  0.23492836952209473
generate_one_block  0.2524416446685791
generate_one_block  0.23815011978149414
generate_one_block  0.2380845546722412
generate_one_block  0.23193883895874023
generate_one_block  0.2449626922607422
generate_one_block  0.23890256881713867
generate_one_block  0.23984098434448242
generate_one_block  0.2577207088470459
generate_one_block  0.2556757926940918
generate_one_block  0.24820637702941895
generate_one_block  0.2399921417236328
generate_one_block  0.2409195899963379
generate_one_block  0.2417607307434082
generate_one_block  0.24446415901184082
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03868412971496582
gen group dst list time:  0.10717082023620605
time for parepare:  0.020400285720825195
local_output_nid generation:  0.025402307510375977
local_in_edges_tensor generation:  0.053693294525146484
mini_batch_src_global generation:  0.03941011428833008
r_  generation:  0.41994690895080566
local_output_nid generation:  0.029936552047729492
local_in_edges_tensor generation:  0.03575730323791504
mini_batch_src_global generation:  0.049808502197265625
r_  generation:  0.4251894950866699
local_output_nid generation:  0.028461456298828125
local_in_edges_tensor generation:  0.03058910369873047
mini_batch_src_global generation:  0.04926109313964844
r_  generation:  0.43056559562683105
local_output_nid generation:  0.0288543701171875
local_in_edges_tensor generation:  0.029578208923339844
mini_batch_src_global generation:  0.05179262161254883
r_  generation:  0.4298555850982666
local_output_nid generation:  0.029201269149780273
local_in_edges_tensor generation:  0.030945777893066406
mini_batch_src_global generation:  0.05202436447143555
r_  generation:  0.4351787567138672
local_output_nid generation:  0.02898550033569336
local_in_edges_tensor generation:  0.03184771537780762
mini_batch_src_global generation:  0.0522465705871582
r_  generation:  0.43114423751831055
local_output_nid generation:  0.029065370559692383
local_in_edges_tensor generation:  0.027626514434814453
mini_batch_src_global generation:  0.05105018615722656
r_  generation:  0.43666505813598633
local_output_nid generation:  0.03094649314880371
local_in_edges_tensor generation:  0.029542922973632812
mini_batch_src_global generation:  0.05205821990966797
r_  generation:  0.4337441921234131
local_output_nid generation:  0.029228925704956055
local_in_edges_tensor generation:  0.02914285659790039
mini_batch_src_global generation:  0.05144834518432617
r_  generation:  0.43917155265808105
local_output_nid generation:  0.0291750431060791
local_in_edges_tensor generation:  0.031522274017333984
mini_batch_src_global generation:  0.052010536193847656
r_  generation:  0.4364645481109619
local_output_nid generation:  0.029001712799072266
local_in_edges_tensor generation:  0.027868270874023438
mini_batch_src_global generation:  0.05185508728027344
r_  generation:  0.4364299774169922
local_output_nid generation:  0.029041767120361328
local_in_edges_tensor generation:  0.027901887893676758
mini_batch_src_global generation:  0.052062273025512695
r_  generation:  0.43216419219970703
local_output_nid generation:  0.0292203426361084
local_in_edges_tensor generation:  0.029587984085083008
mini_batch_src_global generation:  0.051497459411621094
r_  generation:  0.4377436637878418
local_output_nid generation:  0.029782772064208984
local_in_edges_tensor generation:  0.0312504768371582
mini_batch_src_global generation:  0.05181121826171875
r_  generation:  0.43616533279418945
local_output_nid generation:  0.02899026870727539
local_in_edges_tensor generation:  0.03162670135498047
mini_batch_src_global generation:  0.05119442939758301
r_  generation:  0.43591952323913574
local_output_nid generation:  0.0289766788482666
local_in_edges_tensor generation:  0.028224706649780273
mini_batch_src_global generation:  0.052332401275634766
r_  generation:  0.4356954097747803
local_output_nid generation:  0.029117345809936523
local_in_edges_tensor generation:  0.027861833572387695
mini_batch_src_global generation:  0.05320906639099121
r_  generation:  0.4322845935821533
local_output_nid generation:  0.029424190521240234
local_in_edges_tensor generation:  0.028294086456298828
mini_batch_src_global generation:  0.05212283134460449
r_  generation:  0.4332730770111084
local_output_nid generation:  0.029211997985839844
local_in_edges_tensor generation:  0.03455615043640137
mini_batch_src_global generation:  0.053395986557006836
r_  generation:  0.43790602684020996
local_output_nid generation:  0.0300900936126709
local_in_edges_tensor generation:  0.027834653854370117
mini_batch_src_global generation:  0.051744699478149414
r_  generation:  0.4322981834411621
local_output_nid generation:  0.02915048599243164
local_in_edges_tensor generation:  0.028026342391967773
mini_batch_src_global generation:  0.05101633071899414
r_  generation:  0.44055891036987305
local_output_nid generation:  0.028754472732543945
local_in_edges_tensor generation:  0.028711795806884766
mini_batch_src_global generation:  0.0515437126159668
r_  generation:  0.4352993965148926
local_output_nid generation:  0.028935909271240234
local_in_edges_tensor generation:  0.0282440185546875
mini_batch_src_global generation:  0.05128026008605957
r_  generation:  0.4343225955963135
local_output_nid generation:  0.028697967529296875
local_in_edges_tensor generation:  0.027699708938598633
mini_batch_src_global generation:  0.053385257720947266
r_  generation:  0.4378197193145752
local_output_nid generation:  0.029367923736572266
local_in_edges_tensor generation:  0.03133702278137207
mini_batch_src_global generation:  0.0515139102935791
r_  generation:  0.4345543384552002
local_output_nid generation:  0.029405593872070312
local_in_edges_tensor generation:  0.0327303409576416
mini_batch_src_global generation:  0.05204510688781738
r_  generation:  0.4366629123687744
local_output_nid generation:  0.02904534339904785
local_in_edges_tensor generation:  0.030689239501953125
mini_batch_src_global generation:  0.052823543548583984
r_  generation:  0.45387697219848633
local_output_nid generation:  0.03208613395690918
local_in_edges_tensor generation:  0.028394699096679688
mini_batch_src_global generation:  0.053749799728393555
r_  generation:  0.4371144771575928
local_output_nid generation:  0.03012871742248535
local_in_edges_tensor generation:  0.02774214744567871
mini_batch_src_global generation:  0.05158638954162598
r_  generation:  0.4310925006866455
local_output_nid generation:  0.031078815460205078
local_in_edges_tensor generation:  0.028187990188598633
mini_batch_src_global generation:  0.051962852478027344
r_  generation:  0.43303728103637695
local_output_nid generation:  0.029744625091552734
local_in_edges_tensor generation:  0.02822136878967285
mini_batch_src_global generation:  0.051406145095825195
r_  generation:  0.43193721771240234
local_output_nid generation:  0.03002762794494629
local_in_edges_tensor generation:  0.027621030807495117
mini_batch_src_global generation:  0.052086591720581055
r_  generation:  0.438460111618042
----------------------check_connections_block total spend ----------------------------- 20.60253643989563
generate_one_block  0.576730489730835
generate_one_block  0.5739657878875732
generate_one_block  0.5779783725738525
generate_one_block  0.5851860046386719
generate_one_block  0.6807763576507568
generate_one_block  0.5717921257019043
generate_one_block  0.5782439708709717
generate_one_block  0.5805435180664062
generate_one_block  0.5785210132598877
generate_one_block  0.5815613269805908
generate_one_block  0.5791404247283936
generate_one_block  0.5696525573730469
generate_one_block  0.5789990425109863
generate_one_block  0.582495927810669
generate_one_block  0.5846092700958252
generate_one_block  0.5930895805358887
generate_one_block  0.5888164043426514
generate_one_block  0.5822708606719971
generate_one_block  0.5830724239349365
generate_one_block  0.5781049728393555
generate_one_block  0.5750899314880371
generate_one_block  0.5724103450775146
generate_one_block  0.580859899520874
generate_one_block  0.5771422386169434
generate_one_block  0.6011836528778076
generate_one_block  0.5948629379272461
generate_one_block  0.5923402309417725
generate_one_block  0.5908000469207764
generate_one_block  0.5734741687774658
generate_one_block  0.578618049621582
generate_one_block  0.5814933776855469
generate_one_block  0.5914306640625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1264791488647461  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

connection checking time:  29.06983757019043
block generation total time  26.525604963302612
average batch blocks generation time:  0.8289251551032066
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1064143180847168  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.576776027679443  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10661602020263672  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.73821210861206  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10640144348144531  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.84003448486328  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10684728622436523  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.262178897857666  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10682249069213867  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.91382884979248  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.106597900390625  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.856313228607178  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10692071914672852  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.15422296524048  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10638666152954102  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.876450061798096  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10697412490844727  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.414947986602783  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.106597900390625  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.021775245666504  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1069183349609375  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.255160331726074  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10636663436889648  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.532813549041748  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10662984848022461  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.29690647125244  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1068258285522461  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.224166870117188  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10658740997314453  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.97594928741455  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10657453536987305  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.86357545852661  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10657644271850586  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.717285633087158  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10636329650878906  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.67441177368164  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10664892196655273  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.283244132995605  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1062459945678711  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.57267713546753  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10664701461791992  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.733112812042236  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10600852966308594  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.430228233337402  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10645580291748047  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.924236297607422  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1063385009765625  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.699172496795654  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1067495346069336  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.823734760284424  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10666894912719727  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.355960369110107  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1068120002746582  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.35783338546753  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10692739486694336  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.308141231536865  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10643911361694336  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.55570888519287  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1064748764038086  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.733595848083496  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10639142990112305  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.73332977294922  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10667610168457031  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.95456075668335  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03009943664073944 |0.02146657556295395 |0.5565475225448608 |9.624660015106201e-05 |1.0674601793289185 |0.008922338485717773 |
----------------------------------------------------------pseudo_mini_loss sum 3.4922502040863037
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  9112439
Number of first layer input nodes during this epoch:  4761186
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.12639570236206055  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02555537223815918
range selection method range initialization spend 0.01326608657836914
time for parepare:  0.020352602005004883
local_output_nid generation:  0.0009429454803466797
local_in_edges_tensor generation:  0.00445246696472168
mini_batch_src_global generation:  0.001605987548828125
r_  generation:  0.01065969467163086
local_output_nid generation:  0.0009634494781494141
local_in_edges_tensor generation:  0.0006792545318603516
mini_batch_src_global generation:  0.001550912857055664
r_  generation:  0.009931325912475586
local_output_nid generation:  0.0009458065032958984
local_in_edges_tensor generation:  0.0006315708160400391
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.010030984878540039
local_output_nid generation:  0.0008807182312011719
local_in_edges_tensor generation:  0.0006062984466552734
mini_batch_src_global generation:  0.0010602474212646484
r_  generation:  0.009625434875488281
local_output_nid generation:  0.0008783340454101562
local_in_edges_tensor generation:  0.0005927085876464844
mini_batch_src_global generation:  0.0011126995086669922
r_  generation:  0.010315656661987305
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0005834102630615234
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  0.010442972183227539
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0005948543548583984
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.010055780410766602
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.010331869125366211
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0005631446838378906
mini_batch_src_global generation:  0.0010886192321777344
r_  generation:  0.009866714477539062
local_output_nid generation:  0.000885009765625
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.0011777877807617188
r_  generation:  0.01013636589050293
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.010906457901000977
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.0005507469177246094
mini_batch_src_global generation:  0.0011014938354492188
r_  generation:  0.010155439376831055
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.0011668205261230469
r_  generation:  0.010532617568969727
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.001146554946899414
r_  generation:  0.010293960571289062
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0005714893341064453
mini_batch_src_global generation:  0.0012083053588867188
r_  generation:  0.010512113571166992
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005671977996826172
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.00997614860534668
local_output_nid generation:  0.0008473396301269531
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.010242700576782227
local_output_nid generation:  0.0008509159088134766
local_in_edges_tensor generation:  0.0005559921264648438
mini_batch_src_global generation:  0.0010960102081298828
r_  generation:  0.009872913360595703
local_output_nid generation:  0.0008554458618164062
local_in_edges_tensor generation:  0.0005648136138916016
mini_batch_src_global generation:  0.0012080669403076172
r_  generation:  0.010029077529907227
local_output_nid generation:  0.0008578300476074219
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.01074528694152832
local_output_nid generation:  0.0008547306060791016
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0012145042419433594
r_  generation:  0.010243654251098633
local_output_nid generation:  0.0008487701416015625
local_in_edges_tensor generation:  0.000705718994140625
mini_batch_src_global generation:  0.0011930465698242188
r_  generation:  0.010260343551635742
local_output_nid generation:  0.0008695125579833984
local_in_edges_tensor generation:  0.0005445480346679688
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.01013803482055664
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0005731582641601562
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.010344982147216797
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.0012183189392089844
r_  generation:  0.010426998138427734
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0005791187286376953
mini_batch_src_global generation:  0.0011973381042480469
r_  generation:  0.010523080825805664
local_output_nid generation:  0.0009028911590576172
local_in_edges_tensor generation:  0.000598907470703125
mini_batch_src_global generation:  0.0012078285217285156
r_  generation:  0.010697364807128906
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0005667209625244141
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.010314702987670898
local_output_nid generation:  0.0008933544158935547
local_in_edges_tensor generation:  0.0005660057067871094
mini_batch_src_global generation:  0.001209259033203125
r_  generation:  0.01028895378112793
local_output_nid generation:  0.0008590221405029297
local_in_edges_tensor generation:  0.0005736351013183594
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.010201692581176758
local_output_nid generation:  0.0008921623229980469
local_in_edges_tensor generation:  0.0005803108215332031
mini_batch_src_global generation:  0.0011591911315917969
r_  generation:  0.010414361953735352
local_output_nid generation:  0.0008497238159179688
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0011019706726074219
r_  generation:  0.010210037231445312
----------------------check_connections_block total spend ----------------------------- 0.5182855129241943
generate_one_block  0.024844646453857422
generate_one_block  0.019568681716918945
generate_one_block  0.01902627944946289
generate_one_block  0.017741680145263672
generate_one_block  0.018857240676879883
generate_one_block  0.01868128776550293
generate_one_block  0.017973661422729492
generate_one_block  0.018402814865112305
generate_one_block  0.017520666122436523
generate_one_block  0.017960071563720703
generate_one_block  0.019046783447265625
generate_one_block  0.017867565155029297
generate_one_block  0.01854848861694336
generate_one_block  0.018087387084960938
generate_one_block  0.01839590072631836
generate_one_block  0.0172426700592041
generate_one_block  0.01793193817138672
generate_one_block  0.017410993576049805
generate_one_block  0.017663002014160156
generate_one_block  0.01889801025390625
generate_one_block  0.017827749252319336
generate_one_block  0.017829179763793945
generate_one_block  0.018034696578979492
generate_one_block  0.01818561553955078
generate_one_block  0.018166065216064453
generate_one_block  0.01837754249572754
generate_one_block  0.018717050552368164
generate_one_block  0.018073081970214844
generate_one_block  0.017895936965942383
generate_one_block  0.017803668975830078
generate_one_block  0.018208026885986328
generate_one_block  0.017797231674194336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.047797441482543945
gen group dst list time:  0.023042917251586914
time for parepare:  0.020133495330810547
local_output_nid generation:  0.0052585601806640625
local_in_edges_tensor generation:  0.014718770980834961
mini_batch_src_global generation:  0.01745462417602539
r_  generation:  0.15982723236083984
local_output_nid generation:  0.0072672367095947266
local_in_edges_tensor generation:  0.010279655456542969
mini_batch_src_global generation:  0.019848346710205078
r_  generation:  0.1577615737915039
local_output_nid generation:  0.007839679718017578
local_in_edges_tensor generation:  0.029727697372436523
mini_batch_src_global generation:  0.020394086837768555
r_  generation:  0.17613720893859863
local_output_nid generation:  0.0077724456787109375
local_in_edges_tensor generation:  0.00811004638671875
mini_batch_src_global generation:  0.020045995712280273
r_  generation:  0.16872644424438477
local_output_nid generation:  0.008685588836669922
local_in_edges_tensor generation:  0.008804559707641602
mini_batch_src_global generation:  0.022265911102294922
r_  generation:  0.18282747268676758
local_output_nid generation:  0.008682966232299805
local_in_edges_tensor generation:  0.008738040924072266
mini_batch_src_global generation:  0.022267818450927734
r_  generation:  0.17939543724060059
local_output_nid generation:  0.008492708206176758
local_in_edges_tensor generation:  0.008693933486938477
mini_batch_src_global generation:  0.021643400192260742
r_  generation:  0.17211651802062988
local_output_nid generation:  0.008608341217041016
local_in_edges_tensor generation:  0.008678913116455078
mini_batch_src_global generation:  0.022836685180664062
r_  generation:  0.18100547790527344
local_output_nid generation:  0.008072376251220703
local_in_edges_tensor generation:  0.008473634719848633
mini_batch_src_global generation:  0.022282123565673828
r_  generation:  0.1746196746826172
local_output_nid generation:  0.00837254524230957
local_in_edges_tensor generation:  0.008545160293579102
mini_batch_src_global generation:  0.022056102752685547
r_  generation:  0.1782374382019043
local_output_nid generation:  0.008824586868286133
local_in_edges_tensor generation:  0.010929107666015625
mini_batch_src_global generation:  0.024593591690063477
r_  generation:  0.1899261474609375
local_output_nid generation:  0.008511781692504883
local_in_edges_tensor generation:  0.008626699447631836
mini_batch_src_global generation:  0.022745370864868164
r_  generation:  0.17585492134094238
local_output_nid generation:  0.00904226303100586
local_in_edges_tensor generation:  0.009466171264648438
mini_batch_src_global generation:  0.023734092712402344
r_  generation:  0.18268871307373047
local_output_nid generation:  0.008857488632202148
local_in_edges_tensor generation:  0.00902557373046875
mini_batch_src_global generation:  0.022998571395874023
r_  generation:  0.18384695053100586
local_output_nid generation:  0.009161710739135742
local_in_edges_tensor generation:  0.009530067443847656
mini_batch_src_global generation:  0.024070024490356445
r_  generation:  0.18777060508728027
local_output_nid generation:  0.008766889572143555
local_in_edges_tensor generation:  0.008686065673828125
mini_batch_src_global generation:  0.0226285457611084
r_  generation:  0.1868441104888916
local_output_nid generation:  0.011318683624267578
local_in_edges_tensor generation:  0.008931398391723633
mini_batch_src_global generation:  0.022787809371948242
r_  generation:  0.18266582489013672
local_output_nid generation:  0.008894681930541992
local_in_edges_tensor generation:  0.009166240692138672
mini_batch_src_global generation:  0.022481203079223633
r_  generation:  0.17752528190612793
local_output_nid generation:  0.00903010368347168
local_in_edges_tensor generation:  0.009489774703979492
mini_batch_src_global generation:  0.023350000381469727
r_  generation:  0.18310070037841797
local_output_nid generation:  0.009623527526855469
local_in_edges_tensor generation:  0.009546756744384766
mini_batch_src_global generation:  0.024136066436767578
r_  generation:  0.1922149658203125
local_output_nid generation:  0.008995294570922852
local_in_edges_tensor generation:  0.009490489959716797
mini_batch_src_global generation:  0.022700786590576172
r_  generation:  0.18156886100769043
local_output_nid generation:  0.009244680404663086
local_in_edges_tensor generation:  0.009021520614624023
mini_batch_src_global generation:  0.022907257080078125
r_  generation:  0.18183255195617676
local_output_nid generation:  0.009270429611206055
local_in_edges_tensor generation:  0.010467767715454102
mini_batch_src_global generation:  0.023720264434814453
r_  generation:  0.19274020195007324
local_output_nid generation:  0.009428739547729492
local_in_edges_tensor generation:  0.009560108184814453
mini_batch_src_global generation:  0.023860931396484375
r_  generation:  0.18732333183288574
local_output_nid generation:  0.009366750717163086
local_in_edges_tensor generation:  0.009271621704101562
mini_batch_src_global generation:  0.023233413696289062
r_  generation:  0.18509244918823242
local_output_nid generation:  0.009406328201293945
local_in_edges_tensor generation:  0.009955644607543945
mini_batch_src_global generation:  0.024173974990844727
r_  generation:  0.18657255172729492
local_output_nid generation:  0.009632587432861328
local_in_edges_tensor generation:  0.010238170623779297
mini_batch_src_global generation:  0.024982452392578125
r_  generation:  0.1932203769683838
local_output_nid generation:  0.009184837341308594
local_in_edges_tensor generation:  0.008946657180786133
mini_batch_src_global generation:  0.023550987243652344
r_  generation:  0.18019914627075195
local_output_nid generation:  0.009261846542358398
local_in_edges_tensor generation:  0.009093523025512695
mini_batch_src_global generation:  0.024089336395263672
r_  generation:  0.18548941612243652
local_output_nid generation:  0.009253740310668945
local_in_edges_tensor generation:  0.009862899780273438
mini_batch_src_global generation:  0.02336740493774414
r_  generation:  0.1819779872894287
local_output_nid generation:  0.009290933609008789
local_in_edges_tensor generation:  0.009311676025390625
mini_batch_src_global generation:  0.023461341857910156
r_  generation:  0.1867382526397705
local_output_nid generation:  0.008854150772094727
local_in_edges_tensor generation:  0.008907079696655273
mini_batch_src_global generation:  0.023054838180541992
r_  generation:  0.180159330368042
----------------------check_connections_block total spend ----------------------------- 8.45809268951416
generate_one_block  0.2357633113861084
generate_one_block  0.22033190727233887
generate_one_block  0.24262237548828125
generate_one_block  0.23097825050354004
generate_one_block  0.2804405689239502
generate_one_block  0.24244165420532227
generate_one_block  0.23046278953552246
generate_one_block  0.24646520614624023
generate_one_block  0.23167204856872559
generate_one_block  0.23333024978637695
generate_one_block  0.25493621826171875
generate_one_block  0.23422932624816895
generate_one_block  0.24187755584716797
generate_one_block  0.2416670322418213
generate_one_block  0.24671602249145508
generate_one_block  0.22974658012390137
generate_one_block  0.23946666717529297
generate_one_block  0.23512482643127441
generate_one_block  0.23904085159301758
generate_one_block  0.25794315338134766
generate_one_block  0.23503351211547852
generate_one_block  0.2407371997833252
generate_one_block  0.24520015716552734
generate_one_block  0.24863100051879883
generate_one_block  0.24167752265930176
generate_one_block  0.24662280082702637
generate_one_block  0.25864744186401367
generate_one_block  0.23774504661560059
generate_one_block  0.24089908599853516
generate_one_block  0.23986601829528809
generate_one_block  0.24802160263061523
generate_one_block  0.23825287818908691
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03589630126953125
gen group dst list time:  0.10404849052429199
time for parepare:  0.019169330596923828
local_output_nid generation:  0.023928165435791016
local_in_edges_tensor generation:  0.03981924057006836
mini_batch_src_global generation:  0.03966331481933594
r_  generation:  0.4270670413970947
local_output_nid generation:  0.029674768447875977
local_in_edges_tensor generation:  0.03247976303100586
mini_batch_src_global generation:  0.0503232479095459
r_  generation:  0.41709327697753906
local_output_nid generation:  0.029189109802246094
local_in_edges_tensor generation:  0.030103206634521484
mini_batch_src_global generation:  0.05091357231140137
r_  generation:  0.43552398681640625
local_output_nid generation:  0.02872633934020996
local_in_edges_tensor generation:  0.028059959411621094
mini_batch_src_global generation:  0.05126309394836426
r_  generation:  0.43062591552734375
local_output_nid generation:  0.02904820442199707
local_in_edges_tensor generation:  0.028283119201660156
mini_batch_src_global generation:  0.05048847198486328
r_  generation:  0.43873143196105957
local_output_nid generation:  0.02924203872680664
local_in_edges_tensor generation:  0.029006242752075195
mini_batch_src_global generation:  0.0531163215637207
r_  generation:  0.4381430149078369
local_output_nid generation:  0.029134511947631836
local_in_edges_tensor generation:  0.027454137802124023
mini_batch_src_global generation:  0.04959607124328613
r_  generation:  0.43682050704956055
local_output_nid generation:  0.029273033142089844
local_in_edges_tensor generation:  0.02640390396118164
mini_batch_src_global generation:  0.05088329315185547
r_  generation:  0.43493151664733887
local_output_nid generation:  0.028835773468017578
local_in_edges_tensor generation:  0.02702927589416504
mini_batch_src_global generation:  0.050055742263793945
r_  generation:  0.432797908782959
local_output_nid generation:  0.02890801429748535
local_in_edges_tensor generation:  0.02860426902770996
mini_batch_src_global generation:  0.05144381523132324
r_  generation:  0.4354712963104248
local_output_nid generation:  0.029328346252441406
local_in_edges_tensor generation:  0.031276702880859375
mini_batch_src_global generation:  0.0501556396484375
r_  generation:  0.44133806228637695
local_output_nid generation:  0.02881908416748047
local_in_edges_tensor generation:  0.02887272834777832
mini_batch_src_global generation:  0.05115842819213867
r_  generation:  0.43439722061157227
local_output_nid generation:  0.0291290283203125
local_in_edges_tensor generation:  0.02860736846923828
mini_batch_src_global generation:  0.05229306221008301
r_  generation:  0.44244980812072754
local_output_nid generation:  0.02916884422302246
local_in_edges_tensor generation:  0.028705835342407227
mini_batch_src_global generation:  0.0524139404296875
r_  generation:  0.43533897399902344
local_output_nid generation:  0.02923440933227539
local_in_edges_tensor generation:  0.02860236167907715
mini_batch_src_global generation:  0.05036473274230957
r_  generation:  0.4401390552520752
local_output_nid generation:  0.029152393341064453
local_in_edges_tensor generation:  0.027361631393432617
mini_batch_src_global generation:  0.05108451843261719
r_  generation:  0.43793630599975586
local_output_nid generation:  0.029117345809936523
local_in_edges_tensor generation:  0.0268096923828125
mini_batch_src_global generation:  0.05188488960266113
r_  generation:  0.4413490295410156
local_output_nid generation:  0.029192447662353516
local_in_edges_tensor generation:  0.027921438217163086
mini_batch_src_global generation:  0.050901174545288086
r_  generation:  0.4360382556915283
local_output_nid generation:  0.02934408187866211
local_in_edges_tensor generation:  0.0287930965423584
mini_batch_src_global generation:  0.05189251899719238
r_  generation:  0.4426600933074951
local_output_nid generation:  0.029655933380126953
local_in_edges_tensor generation:  0.029793739318847656
mini_batch_src_global generation:  0.05085635185241699
r_  generation:  0.44078969955444336
local_output_nid generation:  0.029648542404174805
local_in_edges_tensor generation:  0.026731491088867188
mini_batch_src_global generation:  0.050092458724975586
r_  generation:  0.44243478775024414
local_output_nid generation:  0.02960371971130371
local_in_edges_tensor generation:  0.02898693084716797
mini_batch_src_global generation:  0.051518917083740234
r_  generation:  0.4388101100921631
local_output_nid generation:  0.029502391815185547
local_in_edges_tensor generation:  0.030836820602416992
mini_batch_src_global generation:  0.052247047424316406
r_  generation:  0.44041872024536133
local_output_nid generation:  0.02950429916381836
local_in_edges_tensor generation:  0.02949357032775879
mini_batch_src_global generation:  0.051236629486083984
r_  generation:  0.44193243980407715
local_output_nid generation:  0.029471397399902344
local_in_edges_tensor generation:  0.02983832359313965
mini_batch_src_global generation:  0.05091500282287598
r_  generation:  0.43911075592041016
local_output_nid generation:  0.029513120651245117
local_in_edges_tensor generation:  0.02733445167541504
mini_batch_src_global generation:  0.05275440216064453
r_  generation:  0.43885040283203125
local_output_nid generation:  0.02946639060974121
local_in_edges_tensor generation:  0.03298640251159668
mini_batch_src_global generation:  0.05048561096191406
r_  generation:  0.4394848346710205
local_output_nid generation:  0.02941417694091797
local_in_edges_tensor generation:  0.02699756622314453
mini_batch_src_global generation:  0.051076412200927734
r_  generation:  0.4360063076019287
local_output_nid generation:  0.02955484390258789
local_in_edges_tensor generation:  0.027754545211791992
mini_batch_src_global generation:  0.05171084403991699
r_  generation:  0.4390544891357422
local_output_nid generation:  0.029474496841430664
local_in_edges_tensor generation:  0.031162738800048828
mini_batch_src_global generation:  0.05227470397949219
r_  generation:  0.4371299743652344
local_output_nid generation:  0.029536008834838867
local_in_edges_tensor generation:  0.029679298400878906
mini_batch_src_global generation:  0.05135798454284668
r_  generation:  0.4377453327178955
local_output_nid generation:  0.02922224998474121
local_in_edges_tensor generation:  0.02771759033203125
mini_batch_src_global generation:  0.05212259292602539
r_  generation:  0.4402644634246826
----------------------check_connections_block total spend ----------------------------- 20.61879324913025
generate_one_block  0.5754258632659912
generate_one_block  0.5655927658081055
generate_one_block  0.5818164348602295
generate_one_block  0.5785446166992188
generate_one_block  0.6635770797729492
generate_one_block  0.5908088684082031
generate_one_block  0.5767626762390137
generate_one_block  0.5750777721405029
generate_one_block  0.5792660713195801
generate_one_block  0.5783872604370117
generate_one_block  0.5834915637969971
generate_one_block  0.5751855373382568
generate_one_block  0.5814008712768555
generate_one_block  0.5852997303009033
generate_one_block  0.5872557163238525
generate_one_block  0.5742506980895996
generate_one_block  0.5855472087860107
generate_one_block  0.5779266357421875
generate_one_block  0.5872020721435547
generate_one_block  0.5926003456115723
generate_one_block  0.5803217887878418
generate_one_block  0.5805435180664062
generate_one_block  0.5997471809387207
generate_one_block  0.5790688991546631
generate_one_block  0.5958151817321777
generate_one_block  0.5833055973052979
generate_one_block  0.5871644020080566
generate_one_block  0.5768489837646484
generate_one_block  0.590155839920044
generate_one_block  0.586437463760376
generate_one_block  0.582294225692749
generate_one_block  0.5800802707672119
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.12639570236206055  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

connection checking time:  29.07688593864441
block generation total time  26.45379400253296
average batch blocks generation time:  0.826681062579155
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10674476623535156  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.82041645050049  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1058192253112793  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.041059970855713  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1068120002746582  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.190481185913086  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10639715194702148  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.56290102005005  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10686445236206055  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.329201698303223  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10678291320800781  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.119024753570557  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10677766799926758  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.563427448272705  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10665416717529297  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.031521797180176  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10625600814819336  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.568021297454834  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10650348663330078  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.69939661026001  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10687446594238281  GigaBytes
Max Memory Allocated: 19.62562608718872  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.548835277557373  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10621166229248047  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.710315227508545  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1067957878112793  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.067883014678955  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10657453536987305  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.01282548904419  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10677480697631836  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.2272310256958  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10625648498535156  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.477538585662842  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10652303695678711  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.84162139892578  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1062307357788086  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.457046031951904  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10678863525390625  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.94119691848755  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10689735412597656  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.457462787628174  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10663747787475586  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.748453617095947  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.106536865234375  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.818886756896973  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10691213607788086  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.087978839874268  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10697221755981445  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.18405532836914  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10670328140258789  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.913070678710938  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10659980773925781  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.148984909057617  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10682296752929688  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.473644733428955  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10642719268798828  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.822087287902832  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10695409774780273  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.057462692260742  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10663843154907227  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.908746242523193  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10651969909667969  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.242684841156006  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10648727416992188  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.681175231933594  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03017689287662506 |0.020229555666446686 |0.5569199621677399 |9.506940841674805e-05 |1.0700379833579063 |0.00965261459350586 |
----------------------------------------------------------pseudo_mini_loss sum 2.7887110710144043
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  9116363
Number of first layer input nodes during this epoch:  4762581
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1265721321105957  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02505040168762207
range selection method range initialization spend 0.01508331298828125
time for parepare:  0.01828169822692871
local_output_nid generation:  0.0009307861328125
local_in_edges_tensor generation:  0.0038564205169677734
mini_batch_src_global generation:  0.001531362533569336
r_  generation:  0.010727167129516602
local_output_nid generation:  0.0009713172912597656
local_in_edges_tensor generation:  0.0006730556488037109
mini_batch_src_global generation:  0.0014052391052246094
r_  generation:  0.010357379913330078
local_output_nid generation:  0.0008952617645263672
local_in_edges_tensor generation:  0.0006177425384521484
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.009466886520385742
local_output_nid generation:  0.0009074211120605469
local_in_edges_tensor generation:  0.0005805492401123047
mini_batch_src_global generation:  0.0010409355163574219
r_  generation:  0.009647846221923828
local_output_nid generation:  0.0008795261383056641
local_in_edges_tensor generation:  0.0005793571472167969
mini_batch_src_global generation:  0.0011096000671386719
r_  generation:  0.009565353393554688
local_output_nid generation:  0.0009062290191650391
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.0010640621185302734
r_  generation:  0.009837627410888672
local_output_nid generation:  0.0008618831634521484
local_in_edges_tensor generation:  0.0005934238433837891
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.01043844223022461
local_output_nid generation:  0.0008676052093505859
local_in_edges_tensor generation:  0.0005645751953125
mini_batch_src_global generation:  0.0011816024780273438
r_  generation:  0.010050773620605469
local_output_nid generation:  0.0008649826049804688
local_in_edges_tensor generation:  0.0005784034729003906
mini_batch_src_global generation:  0.0011234283447265625
r_  generation:  0.010184288024902344
local_output_nid generation:  0.0008857250213623047
local_in_edges_tensor generation:  0.0005762577056884766
mini_batch_src_global generation:  0.0011458396911621094
r_  generation:  0.010024785995483398
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.010358095169067383
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.0010943412780761719
r_  generation:  0.009997844696044922
local_output_nid generation:  0.0008792877197265625
local_in_edges_tensor generation:  0.0006091594696044922
mini_batch_src_global generation:  0.0011129379272460938
r_  generation:  0.00977325439453125
local_output_nid generation:  0.0008604526519775391
local_in_edges_tensor generation:  0.000576019287109375
mini_batch_src_global generation:  0.0011157989501953125
r_  generation:  0.010282278060913086
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.001142263412475586
r_  generation:  0.01034092903137207
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0005712509155273438
mini_batch_src_global generation:  0.0011227130889892578
r_  generation:  0.010061979293823242
local_output_nid generation:  0.0008764266967773438
local_in_edges_tensor generation:  0.0005793571472167969
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.010373830795288086
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0005476474761962891
mini_batch_src_global generation:  0.0010790824890136719
r_  generation:  0.0100555419921875
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005578994750976562
mini_batch_src_global generation:  0.001108407974243164
r_  generation:  0.009965896606445312
local_output_nid generation:  0.000865936279296875
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0011339187622070312
r_  generation:  0.01023411750793457
local_output_nid generation:  0.0008766651153564453
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.001154184341430664
r_  generation:  0.010316133499145508
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0005841255187988281
mini_batch_src_global generation:  0.0011835098266601562
r_  generation:  0.010284423828125
local_output_nid generation:  0.0008566379547119141
local_in_edges_tensor generation:  0.0005762577056884766
mini_batch_src_global generation:  0.0011603832244873047
r_  generation:  0.010312557220458984
local_output_nid generation:  0.0008907318115234375
local_in_edges_tensor generation:  0.0005578994750976562
mini_batch_src_global generation:  0.0011420249938964844
r_  generation:  0.010284662246704102
local_output_nid generation:  0.0008695125579833984
local_in_edges_tensor generation:  0.0005857944488525391
mini_batch_src_global generation:  0.0011773109436035156
r_  generation:  0.010663270950317383
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0005750656127929688
mini_batch_src_global generation:  0.0011434555053710938
r_  generation:  0.01037454605102539
local_output_nid generation:  0.0008637905120849609
local_in_edges_tensor generation:  0.0005643367767333984
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.010141134262084961
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0005729198455810547
mini_batch_src_global generation:  0.0011663436889648438
r_  generation:  0.010095357894897461
local_output_nid generation:  0.0008528232574462891
local_in_edges_tensor generation:  0.0005803108215332031
mini_batch_src_global generation:  0.0011091232299804688
r_  generation:  0.010103940963745117
local_output_nid generation:  0.000850677490234375
local_in_edges_tensor generation:  0.0005562305450439453
mini_batch_src_global generation:  0.0012080669403076172
r_  generation:  0.010082721710205078
local_output_nid generation:  0.0008687973022460938
local_in_edges_tensor generation:  0.0005741119384765625
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.01049041748046875
local_output_nid generation:  0.0008482933044433594
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.0011775493621826172
r_  generation:  0.010369539260864258
----------------------check_connections_block total spend ----------------------------- 0.5101490020751953
generate_one_block  0.02396702766418457
generate_one_block  0.0200502872467041
generate_one_block  0.018087387084960938
generate_one_block  0.017884016036987305
generate_one_block  0.017861366271972656
generate_one_block  0.018117189407348633
generate_one_block  0.018698453903198242
generate_one_block  0.018038034439086914
generate_one_block  0.01818108558654785
generate_one_block  0.017734289169311523
generate_one_block  0.018303632736206055
generate_one_block  0.017842769622802734
generate_one_block  0.017270565032958984
generate_one_block  0.017940282821655273
generate_one_block  0.01813983917236328
generate_one_block  0.01764082908630371
generate_one_block  0.01823878288269043
generate_one_block  0.01764655113220215
generate_one_block  0.0175015926361084
generate_one_block  0.017826557159423828
generate_one_block  0.01820683479309082
generate_one_block  0.01787590980529785
generate_one_block  0.018029451370239258
generate_one_block  0.01802968978881836
generate_one_block  0.018601179122924805
generate_one_block  0.018279075622558594
generate_one_block  0.017772912979125977
generate_one_block  0.017748117446899414
generate_one_block  0.01762843132019043
generate_one_block  0.01755833625793457
generate_one_block  0.018306493759155273
generate_one_block  0.018220901489257812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03960609436035156
gen group dst list time:  0.022228479385375977
time for parepare:  0.02013230323791504
local_output_nid generation:  0.0052928924560546875
local_in_edges_tensor generation:  0.015467643737792969
mini_batch_src_global generation:  0.016760826110839844
r_  generation:  0.15912508964538574
local_output_nid generation:  0.00751948356628418
local_in_edges_tensor generation:  0.012076377868652344
mini_batch_src_global generation:  0.02146434783935547
r_  generation:  0.16270661354064941
local_output_nid generation:  0.007636547088623047
local_in_edges_tensor generation:  0.03372025489807129
mini_batch_src_global generation:  0.018969297409057617
r_  generation:  0.16524410247802734
local_output_nid generation:  0.007878303527832031
local_in_edges_tensor generation:  0.008193492889404297
mini_batch_src_global generation:  0.026871204376220703
r_  generation:  0.17234349250793457
local_output_nid generation:  0.0091094970703125
local_in_edges_tensor generation:  0.008245706558227539
mini_batch_src_global generation:  0.020474672317504883
r_  generation:  0.16970062255859375
local_output_nid generation:  0.00873422622680664
local_in_edges_tensor generation:  0.009932518005371094
mini_batch_src_global generation:  0.022511005401611328
r_  generation:  0.17582941055297852
local_output_nid generation:  0.009086847305297852
local_in_edges_tensor generation:  0.009957551956176758
mini_batch_src_global generation:  0.023553133010864258
r_  generation:  0.17940354347229004
local_output_nid generation:  0.008767843246459961
local_in_edges_tensor generation:  0.008823156356811523
mini_batch_src_global generation:  0.022563695907592773
r_  generation:  0.1788933277130127
local_output_nid generation:  0.008631229400634766
local_in_edges_tensor generation:  0.008756160736083984
mini_batch_src_global generation:  0.0236814022064209
r_  generation:  0.18041157722473145
local_output_nid generation:  0.008589506149291992
local_in_edges_tensor generation:  0.008882522583007812
mini_batch_src_global generation:  0.02274465560913086
r_  generation:  0.1771564483642578
local_output_nid generation:  0.009060859680175781
local_in_edges_tensor generation:  0.008855819702148438
mini_batch_src_global generation:  0.022954702377319336
r_  generation:  0.1820077896118164
local_output_nid generation:  0.008845806121826172
local_in_edges_tensor generation:  0.008886098861694336
mini_batch_src_global generation:  0.022578954696655273
r_  generation:  0.1754450798034668
local_output_nid generation:  0.008743047714233398
local_in_edges_tensor generation:  0.008718729019165039
mini_batch_src_global generation:  0.023337364196777344
r_  generation:  0.169846773147583
local_output_nid generation:  0.009095430374145508
local_in_edges_tensor generation:  0.008924722671508789
mini_batch_src_global generation:  0.024628639221191406
r_  generation:  0.17767882347106934
local_output_nid generation:  0.00922536849975586
local_in_edges_tensor generation:  0.009964466094970703
mini_batch_src_global generation:  0.023378849029541016
r_  generation:  0.18547868728637695
local_output_nid generation:  0.009060144424438477
local_in_edges_tensor generation:  0.00860452651977539
mini_batch_src_global generation:  0.02233743667602539
r_  generation:  0.17906761169433594
local_output_nid generation:  0.009350061416625977
local_in_edges_tensor generation:  0.008880376815795898
mini_batch_src_global generation:  0.02422332763671875
r_  generation:  0.1844327449798584
local_output_nid generation:  0.009089469909667969
local_in_edges_tensor generation:  0.008579254150390625
mini_batch_src_global generation:  0.022696256637573242
r_  generation:  0.17940402030944824
local_output_nid generation:  0.00893545150756836
local_in_edges_tensor generation:  0.008791208267211914
mini_batch_src_global generation:  0.02243328094482422
r_  generation:  0.17812442779541016
local_output_nid generation:  0.009183406829833984
local_in_edges_tensor generation:  0.009418725967407227
mini_batch_src_global generation:  0.022489547729492188
r_  generation:  0.17798399925231934
local_output_nid generation:  0.009316682815551758
local_in_edges_tensor generation:  0.009668588638305664
mini_batch_src_global generation:  0.022684574127197266
r_  generation:  0.18241667747497559
local_output_nid generation:  0.009227275848388672
local_in_edges_tensor generation:  0.009412765502929688
mini_batch_src_global generation:  0.02263331413269043
r_  generation:  0.17903971672058105
local_output_nid generation:  0.00933527946472168
local_in_edges_tensor generation:  0.009500265121459961
mini_batch_src_global generation:  0.02276444435119629
r_  generation:  0.18189716339111328
local_output_nid generation:  0.009388446807861328
local_in_edges_tensor generation:  0.009531974792480469
mini_batch_src_global generation:  0.022942304611206055
r_  generation:  0.18438076972961426
local_output_nid generation:  0.009556055068969727
local_in_edges_tensor generation:  0.009645700454711914
mini_batch_src_global generation:  0.023856163024902344
r_  generation:  0.1872706413269043
local_output_nid generation:  0.0095062255859375
local_in_edges_tensor generation:  0.009587287902832031
mini_batch_src_global generation:  0.025687456130981445
r_  generation:  0.1860659122467041
local_output_nid generation:  0.00930333137512207
local_in_edges_tensor generation:  0.009521245956420898
mini_batch_src_global generation:  0.024881839752197266
r_  generation:  0.18416166305541992
local_output_nid generation:  0.009299516677856445
local_in_edges_tensor generation:  0.00937199592590332
mini_batch_src_global generation:  0.0227658748626709
r_  generation:  0.18257808685302734
local_output_nid generation:  0.009263277053833008
local_in_edges_tensor generation:  0.00876164436340332
mini_batch_src_global generation:  0.022292613983154297
r_  generation:  0.18060851097106934
local_output_nid generation:  0.009270668029785156
local_in_edges_tensor generation:  0.009355783462524414
mini_batch_src_global generation:  0.023885726928710938
r_  generation:  0.18270182609558105
local_output_nid generation:  0.009492158889770508
local_in_edges_tensor generation:  0.009604692459106445
mini_batch_src_global generation:  0.023485898971557617
r_  generation:  0.18725991249084473
local_output_nid generation:  0.009474515914916992
local_in_edges_tensor generation:  0.008938074111938477
mini_batch_src_global generation:  0.023468732833862305
r_  generation:  0.18502044677734375
----------------------check_connections_block total spend ----------------------------- 8.384219646453857
generate_one_block  0.2447493076324463
generate_one_block  0.2321760654449463
generate_one_block  0.23264193534851074
generate_one_block  0.236069917678833
generate_one_block  0.2605016231536865
generate_one_block  0.24152851104736328
generate_one_block  0.24661993980407715
generate_one_block  0.24353361129760742
generate_one_block  0.24665141105651855
generate_one_block  0.23957538604736328
generate_one_block  0.24697399139404297
generate_one_block  0.23607516288757324
generate_one_block  0.22789430618286133
generate_one_block  0.23840665817260742
generate_one_block  0.25145888328552246
generate_one_block  0.23463129997253418
generate_one_block  0.24889516830444336
generate_one_block  0.2412278652191162
generate_one_block  0.23560857772827148
generate_one_block  0.2441401481628418
generate_one_block  0.248063325881958
generate_one_block  0.24414849281311035
generate_one_block  0.24663543701171875
generate_one_block  0.24852776527404785
generate_one_block  0.2558281421661377
generate_one_block  0.25023722648620605
generate_one_block  0.24303388595581055
generate_one_block  0.24109482765197754
generate_one_block  0.23826265335083008
generate_one_block  0.24187469482421875
generate_one_block  0.2532672882080078
generate_one_block  0.24985003471374512
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034377098083496094
gen group dst list time:  0.10812616348266602
time for parepare:  0.020548105239868164
local_output_nid generation:  0.024312973022460938
local_in_edges_tensor generation:  0.0436251163482666
mini_batch_src_global generation:  0.04015040397644043
r_  generation:  0.4248828887939453
local_output_nid generation:  0.029586315155029297
local_in_edges_tensor generation:  0.033650875091552734
mini_batch_src_global generation:  0.050193071365356445
r_  generation:  0.4196772575378418
local_output_nid generation:  0.030019044876098633
local_in_edges_tensor generation:  0.030686616897583008
mini_batch_src_global generation:  0.048804283142089844
r_  generation:  0.43311047554016113
local_output_nid generation:  0.028746366500854492
local_in_edges_tensor generation:  0.026195287704467773
mini_batch_src_global generation:  0.050750017166137695
r_  generation:  0.4240684509277344
local_output_nid generation:  0.028536558151245117
local_in_edges_tensor generation:  0.026645421981811523
mini_batch_src_global generation:  0.050769805908203125
r_  generation:  0.43756747245788574
local_output_nid generation:  0.02860736846923828
local_in_edges_tensor generation:  0.028721094131469727
mini_batch_src_global generation:  0.052451372146606445
r_  generation:  0.42906641960144043
local_output_nid generation:  0.029486894607543945
local_in_edges_tensor generation:  0.02965712547302246
mini_batch_src_global generation:  0.05213451385498047
r_  generation:  0.4387092590332031
local_output_nid generation:  0.029016733169555664
local_in_edges_tensor generation:  0.028277873992919922
mini_batch_src_global generation:  0.05299711227416992
r_  generation:  0.4327073097229004
local_output_nid generation:  0.029084205627441406
local_in_edges_tensor generation:  0.02648472785949707
mini_batch_src_global generation:  0.05133938789367676
r_  generation:  0.438107967376709
local_output_nid generation:  0.02863764762878418
local_in_edges_tensor generation:  0.026511430740356445
mini_batch_src_global generation:  0.052213191986083984
r_  generation:  0.4297161102294922
local_output_nid generation:  0.028856277465820312
local_in_edges_tensor generation:  0.028673648834228516
mini_batch_src_global generation:  0.054395437240600586
r_  generation:  0.4385709762573242
local_output_nid generation:  0.02916693687438965
local_in_edges_tensor generation:  0.028844356536865234
mini_batch_src_global generation:  0.05420255661010742
r_  generation:  0.43279314041137695
local_output_nid generation:  0.028986692428588867
local_in_edges_tensor generation:  0.027115583419799805
mini_batch_src_global generation:  0.05068540573120117
r_  generation:  0.4379873275756836
local_output_nid generation:  0.029160737991333008
local_in_edges_tensor generation:  0.027081012725830078
mini_batch_src_global generation:  0.05182051658630371
r_  generation:  0.4313087463378906
local_output_nid generation:  0.02912616729736328
local_in_edges_tensor generation:  0.032288312911987305
mini_batch_src_global generation:  0.05090832710266113
r_  generation:  0.4386756420135498
local_output_nid generation:  0.028980255126953125
local_in_edges_tensor generation:  0.030867338180541992
mini_batch_src_global generation:  0.05405306816101074
r_  generation:  0.44191527366638184
local_output_nid generation:  0.028847455978393555
local_in_edges_tensor generation:  0.030476093292236328
mini_batch_src_global generation:  0.050635576248168945
r_  generation:  0.4367811679840088
local_output_nid generation:  0.028584003448486328
local_in_edges_tensor generation:  0.02901911735534668
mini_batch_src_global generation:  0.05243039131164551
r_  generation:  0.42896175384521484
local_output_nid generation:  0.02859973907470703
local_in_edges_tensor generation:  0.02942657470703125
mini_batch_src_global generation:  0.050362348556518555
r_  generation:  0.43593358993530273
local_output_nid generation:  0.0288543701171875
local_in_edges_tensor generation:  0.026907682418823242
mini_batch_src_global generation:  0.05406832695007324
r_  generation:  0.4300103187561035
local_output_nid generation:  0.029471874237060547
local_in_edges_tensor generation:  0.028516054153442383
mini_batch_src_global generation:  0.05147910118103027
r_  generation:  0.44128870964050293
local_output_nid generation:  0.028924226760864258
local_in_edges_tensor generation:  0.030742168426513672
mini_batch_src_global generation:  0.0519866943359375
r_  generation:  0.4337434768676758
local_output_nid generation:  0.029361963272094727
local_in_edges_tensor generation:  0.029038667678833008
mini_batch_src_global generation:  0.051549673080444336
r_  generation:  0.44045186042785645
local_output_nid generation:  0.02924823760986328
local_in_edges_tensor generation:  0.027292490005493164
mini_batch_src_global generation:  0.052152395248413086
r_  generation:  0.4426300525665283
local_output_nid generation:  0.029273033142089844
local_in_edges_tensor generation:  0.027276992797851562
mini_batch_src_global generation:  0.0505223274230957
r_  generation:  0.44132089614868164
local_output_nid generation:  0.029427289962768555
local_in_edges_tensor generation:  0.026381254196166992
mini_batch_src_global generation:  0.05409812927246094
r_  generation:  0.4380214214324951
local_output_nid generation:  0.029233932495117188
local_in_edges_tensor generation:  0.03376007080078125
mini_batch_src_global generation:  0.060189247131347656
r_  generation:  0.4363973140716553
local_output_nid generation:  0.030054569244384766
local_in_edges_tensor generation:  0.027196645736694336
mini_batch_src_global generation:  0.051714181900024414
r_  generation:  0.4364340305328369
local_output_nid generation:  0.029729604721069336
local_in_edges_tensor generation:  0.028886795043945312
mini_batch_src_global generation:  0.0511016845703125
r_  generation:  0.4381263256072998
local_output_nid generation:  0.029165267944335938
local_in_edges_tensor generation:  0.026963472366333008
mini_batch_src_global generation:  0.05192732810974121
r_  generation:  0.43150854110717773
local_output_nid generation:  0.02896261215209961
local_in_edges_tensor generation:  0.027022123336791992
mini_batch_src_global generation:  0.054680585861206055
r_  generation:  0.4348921775817871
local_output_nid generation:  0.029236555099487305
local_in_edges_tensor generation:  0.03055405616760254
mini_batch_src_global generation:  0.0556638240814209
r_  generation:  0.4377915859222412
----------------------check_connections_block total spend ----------------------------- 20.60865807533264
generate_one_block  0.5789012908935547
generate_one_block  0.5697135925292969
generate_one_block  0.5817909240722656
generate_one_block  0.5687499046325684
generate_one_block  0.6692655086517334
generate_one_block  0.5817193984985352
generate_one_block  0.5775954723358154
generate_one_block  0.5810961723327637
generate_one_block  0.5849213600158691
generate_one_block  0.5708582401275635
generate_one_block  0.5757076740264893
generate_one_block  0.575157642364502
generate_one_block  0.5736725330352783
generate_one_block  0.5818233489990234
generate_one_block  0.5940732955932617
generate_one_block  0.5829622745513916
generate_one_block  0.5930142402648926
generate_one_block  0.5732467174530029
generate_one_block  0.57088303565979
generate_one_block  0.5823819637298584
generate_one_block  0.5876247882843018
generate_one_block  0.5788547992706299
generate_one_block  0.5757324695587158
generate_one_block  0.5891075134277344
generate_one_block  0.5897178649902344
generate_one_block  0.5908381938934326
generate_one_block  0.5806429386138916
generate_one_block  0.5764219760894775
generate_one_block  0.5869283676147461
generate_one_block  0.5824544429779053
generate_one_block  0.5824663639068604
generate_one_block  0.5965783596038818
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1265721321105957  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

connection checking time:  28.9928777217865
block generation total time  26.475086212158203
average batch blocks generation time:  0.8273464441299438
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10656118392944336  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.874916553497314  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10651874542236328  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.590378761291504  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10641860961914062  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.623780727386475  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10630130767822266  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.665156364440918  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10659599304199219  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.60866403579712  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10671138763427734  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.916068077087402  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10686874389648438  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.233022212982178  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10673856735229492  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.1028413772583  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10807991027832031  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.263454914093018  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10653448104858398  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.887756824493408  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1067967414855957  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.234636306762695  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10650157928466797  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.70899200439453  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10620498657226562  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.260671138763428  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10655546188354492  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.778900146484375  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10667705535888672  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.294817447662354  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10669422149658203  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.71778678894043  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1067962646484375  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.260818481445312  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1064906120300293  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.81297254562378  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10613250732421875  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.681567668914795  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10638856887817383  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.71904706954956  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10700654983520508  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.047654151916504  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10671710968017578  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.888992309570312  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10647439956665039  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.972177505493164  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10675621032714844  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.13576078414917  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10654020309448242  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.27653408050537  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10670995712280273  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.335681915283203  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10674858093261719  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.03781747817993  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10659074783325195  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.854549884796143  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10667276382446289  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.745824813842773  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1065073013305664  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.742691040039062  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10668659210205078  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.310662269592285  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10686874389648438  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.270317554473877  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02960081398487091 |0.021912992000579834 |0.5542652234435081 |9.553879499435425e-05 |1.065575785934925 |0.009520769119262695 |
----------------------------------------------------------pseudo_mini_loss sum 2.408595561981201
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  9116338
Number of first layer input nodes during this epoch:  4763100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1267542839050293  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029135942459106445
range selection method range initialization spend 0.014116764068603516
time for parepare:  0.024156808853149414
local_output_nid generation:  0.00124359130859375
local_in_edges_tensor generation:  0.004911184310913086
mini_batch_src_global generation:  0.004674673080444336
r_  generation:  0.010751485824584961
local_output_nid generation:  0.0011184215545654297
local_in_edges_tensor generation:  0.0007779598236083984
mini_batch_src_global generation:  0.0019314289093017578
r_  generation:  0.011017560958862305
local_output_nid generation:  0.0010111331939697266
local_in_edges_tensor generation:  0.0007665157318115234
mini_batch_src_global generation:  0.0015802383422851562
r_  generation:  0.010604619979858398
local_output_nid generation:  0.0009868144989013672
local_in_edges_tensor generation:  0.00069427490234375
mini_batch_src_global generation:  0.0015163421630859375
r_  generation:  0.010633468627929688
local_output_nid generation:  0.0010175704956054688
local_in_edges_tensor generation:  0.0007424354553222656
mini_batch_src_global generation:  0.0014870166778564453
r_  generation:  0.010178565979003906
local_output_nid generation:  0.0010089874267578125
local_in_edges_tensor generation:  0.0006732940673828125
mini_batch_src_global generation:  0.0014333724975585938
r_  generation:  0.009900093078613281
local_output_nid generation:  0.0010573863983154297
local_in_edges_tensor generation:  0.0006842613220214844
mini_batch_src_global generation:  0.0015344619750976562
r_  generation:  0.010812044143676758
local_output_nid generation:  0.0010662078857421875
local_in_edges_tensor generation:  0.0013713836669921875
mini_batch_src_global generation:  0.004078388214111328
r_  generation:  0.017436981201171875
local_output_nid generation:  0.0013427734375
local_in_edges_tensor generation:  0.0007026195526123047
mini_batch_src_global generation:  0.0016148090362548828
r_  generation:  0.01131582260131836
local_output_nid generation:  0.0010406970977783203
local_in_edges_tensor generation:  0.0006375312805175781
mini_batch_src_global generation:  0.001323699951171875
r_  generation:  0.010474205017089844
local_output_nid generation:  0.0009813308715820312
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.0037975311279296875
r_  generation:  0.010785341262817383
local_output_nid generation:  0.0009486675262451172
local_in_edges_tensor generation:  0.0006470680236816406
mini_batch_src_global generation:  0.0011868476867675781
r_  generation:  0.010106563568115234
local_output_nid generation:  0.0009305477142333984
local_in_edges_tensor generation:  0.0006327629089355469
mini_batch_src_global generation:  0.0011477470397949219
r_  generation:  0.009788751602172852
local_output_nid generation:  0.0009033679962158203
local_in_edges_tensor generation:  0.0006515979766845703
mini_batch_src_global generation:  0.0012021064758300781
r_  generation:  0.01042628288269043
local_output_nid generation:  0.0009057521820068359
local_in_edges_tensor generation:  0.0005996227264404297
mini_batch_src_global generation:  0.0011281967163085938
r_  generation:  0.00984501838684082
local_output_nid generation:  0.0009036064147949219
local_in_edges_tensor generation:  0.0006515979766845703
mini_batch_src_global generation:  0.0011415481567382812
r_  generation:  0.010224580764770508
local_output_nid generation:  0.0008890628814697266
local_in_edges_tensor generation:  0.0006144046783447266
mini_batch_src_global generation:  0.0011892318725585938
r_  generation:  0.01049494743347168
local_output_nid generation:  0.0009212493896484375
local_in_edges_tensor generation:  0.0006601810455322266
mini_batch_src_global generation:  0.0013959407806396484
r_  generation:  0.010338068008422852
local_output_nid generation:  0.0008871555328369141
local_in_edges_tensor generation:  0.0006067752838134766
mini_batch_src_global generation:  0.0012841224670410156
r_  generation:  0.010297536849975586
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0006306171417236328
mini_batch_src_global generation:  0.0011982917785644531
r_  generation:  0.009903669357299805
local_output_nid generation:  0.0009019374847412109
local_in_edges_tensor generation:  0.0006513595581054688
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.010030508041381836
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.0005941390991210938
mini_batch_src_global generation:  0.0011723041534423828
r_  generation:  0.010015010833740234
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0006232261657714844
mini_batch_src_global generation:  0.0012805461883544922
r_  generation:  0.010750532150268555
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0006208419799804688
mini_batch_src_global generation:  0.0011959075927734375
r_  generation:  0.013069868087768555
local_output_nid generation:  0.00093841552734375
local_in_edges_tensor generation:  0.0006511211395263672
mini_batch_src_global generation:  0.0014684200286865234
r_  generation:  0.01076507568359375
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0006082057952880859
mini_batch_src_global generation:  0.001178741455078125
r_  generation:  0.010224342346191406
local_output_nid generation:  0.0008862018585205078
local_in_edges_tensor generation:  0.0006515979766845703
mini_batch_src_global generation:  0.0013039112091064453
r_  generation:  0.010606765747070312
local_output_nid generation:  0.0008823871612548828
local_in_edges_tensor generation:  0.00060272216796875
mini_batch_src_global generation:  0.0011570453643798828
r_  generation:  0.010245323181152344
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0006403923034667969
mini_batch_src_global generation:  0.0011403560638427734
r_  generation:  0.010074615478515625
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0006349086761474609
mini_batch_src_global generation:  0.0011439323425292969
r_  generation:  0.010140180587768555
local_output_nid generation:  0.0008795261383056641
local_in_edges_tensor generation:  0.0006172657012939453
mini_batch_src_global generation:  0.001172780990600586
r_  generation:  0.01240229606628418
local_output_nid generation:  0.0008778572082519531
local_in_edges_tensor generation:  0.0007193088531494141
mini_batch_src_global generation:  0.0012233257293701172
r_  generation:  0.010787487030029297
----------------------check_connections_block total spend ----------------------------- 0.5653462409973145
generate_one_block  0.02643752098083496
generate_one_block  0.019772052764892578
generate_one_block  0.018674373626708984
generate_one_block  0.021010875701904297
generate_one_block  0.017913341522216797
generate_one_block  0.017308473587036133
generate_one_block  0.018599748611450195
generate_one_block  0.01737809181213379
generate_one_block  0.018695354461669922
generate_one_block  0.021122455596923828
generate_one_block  0.018670320510864258
generate_one_block  0.017873525619506836
generate_one_block  0.017139673233032227
generate_one_block  0.01838827133178711
generate_one_block  0.017118453979492188
generate_one_block  0.019788265228271484
generate_one_block  0.018174171447753906
generate_one_block  0.017941713333129883
generate_one_block  0.01785421371459961
generate_one_block  0.017293453216552734
generate_one_block  0.020918607711791992
generate_one_block  0.019806623458862305
generate_one_block  0.018929004669189453
generate_one_block  0.018504619598388672
generate_one_block  0.01868891716003418
generate_one_block  0.017971277236938477
generate_one_block  0.022990942001342773
generate_one_block  0.018135786056518555
generate_one_block  0.017673969268798828
generate_one_block  0.017415285110473633
generate_one_block  0.018250226974487305
generate_one_block  0.02179241180419922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07518315315246582
gen group dst list time:  0.029001712799072266
time for parepare:  0.024019718170166016
local_output_nid generation:  0.006476640701293945
local_in_edges_tensor generation:  0.016702651977539062
mini_batch_src_global generation:  0.019902467727661133
r_  generation:  0.1677241325378418
local_output_nid generation:  0.007454633712768555
local_in_edges_tensor generation:  0.010601997375488281
mini_batch_src_global generation:  0.023516416549682617
r_  generation:  0.16109228134155273
local_output_nid generation:  0.009557485580444336
local_in_edges_tensor generation:  0.03221416473388672
mini_batch_src_global generation:  0.020478487014770508
r_  generation:  0.17473959922790527
local_output_nid generation:  0.008303642272949219
local_in_edges_tensor generation:  0.011708974838256836
mini_batch_src_global generation:  0.021357059478759766
r_  generation:  0.18919134140014648
local_output_nid generation:  0.01210331916809082
local_in_edges_tensor generation:  0.008551836013793945
mini_batch_src_global generation:  0.021669626235961914
r_  generation:  0.17511844635009766
local_output_nid generation:  0.008126497268676758
local_in_edges_tensor generation:  0.00806570053100586
mini_batch_src_global generation:  0.031100988388061523
r_  generation:  0.18715715408325195
local_output_nid generation:  0.014092683792114258
local_in_edges_tensor generation:  0.012001991271972656
mini_batch_src_global generation:  0.026719331741333008
r_  generation:  0.20075678825378418
local_output_nid generation:  0.011564970016479492
local_in_edges_tensor generation:  0.00967097282409668
mini_batch_src_global generation:  0.0285646915435791
r_  generation:  0.17394804954528809
local_output_nid generation:  0.00972747802734375
local_in_edges_tensor generation:  0.010010719299316406
mini_batch_src_global generation:  0.024272680282592773
r_  generation:  0.18496918678283691
local_output_nid generation:  0.00969386100769043
local_in_edges_tensor generation:  0.010185480117797852
mini_batch_src_global generation:  0.02576923370361328
r_  generation:  0.1842350959777832
local_output_nid generation:  0.00997614860534668
local_in_edges_tensor generation:  0.009872198104858398
mini_batch_src_global generation:  0.02429032325744629
r_  generation:  0.195115327835083
local_output_nid generation:  0.009288311004638672
local_in_edges_tensor generation:  0.008443355560302734
mini_batch_src_global generation:  0.023504018783569336
r_  generation:  0.17732930183410645
local_output_nid generation:  0.009166717529296875
local_in_edges_tensor generation:  0.008334636688232422
mini_batch_src_global generation:  0.02194499969482422
r_  generation:  0.17232251167297363
local_output_nid generation:  0.009378194808959961
local_in_edges_tensor generation:  0.008605718612670898
mini_batch_src_global generation:  0.02428126335144043
r_  generation:  0.18593692779541016
local_output_nid generation:  0.008844852447509766
local_in_edges_tensor generation:  0.008996248245239258
mini_batch_src_global generation:  0.022764205932617188
r_  generation:  0.1761474609375
local_output_nid generation:  0.009101629257202148
local_in_edges_tensor generation:  0.008646965026855469
mini_batch_src_global generation:  0.022998332977294922
r_  generation:  0.1843852996826172
local_output_nid generation:  0.009337663650512695
local_in_edges_tensor generation:  0.010374307632446289
mini_batch_src_global generation:  0.023355484008789062
r_  generation:  0.18429327011108398
local_output_nid generation:  0.009096384048461914
local_in_edges_tensor generation:  0.009387016296386719
mini_batch_src_global generation:  0.02465653419494629
r_  generation:  0.1845247745513916
local_output_nid generation:  0.009118080139160156
local_in_edges_tensor generation:  0.008623838424682617
mini_batch_src_global generation:  0.023535728454589844
r_  generation:  0.18486714363098145
local_output_nid generation:  0.010277748107910156
local_in_edges_tensor generation:  0.009357213973999023
mini_batch_src_global generation:  0.022858142852783203
r_  generation:  0.1802363395690918
local_output_nid generation:  0.008885383605957031
local_in_edges_tensor generation:  0.008465051651000977
mini_batch_src_global generation:  0.023096084594726562
r_  generation:  0.17795872688293457
local_output_nid generation:  0.008883237838745117
local_in_edges_tensor generation:  0.009689092636108398
mini_batch_src_global generation:  0.024733543395996094
r_  generation:  0.18349623680114746
local_output_nid generation:  0.00951528549194336
local_in_edges_tensor generation:  0.012514591217041016
mini_batch_src_global generation:  0.023917436599731445
r_  generation:  0.19275188446044922
local_output_nid generation:  0.009086132049560547
local_in_edges_tensor generation:  0.010601520538330078
mini_batch_src_global generation:  0.024138927459716797
r_  generation:  0.18786168098449707
local_output_nid generation:  0.009448051452636719
local_in_edges_tensor generation:  0.009795904159545898
mini_batch_src_global generation:  0.023766756057739258
r_  generation:  0.18988704681396484
local_output_nid generation:  0.00999307632446289
local_in_edges_tensor generation:  0.01074361801147461
mini_batch_src_global generation:  0.02341008186340332
r_  generation:  0.18770885467529297
local_output_nid generation:  0.01031494140625
local_in_edges_tensor generation:  0.012796878814697266
mini_batch_src_global generation:  0.0258181095123291
r_  generation:  0.19267010688781738
local_output_nid generation:  0.009285688400268555
local_in_edges_tensor generation:  0.00996541976928711
mini_batch_src_global generation:  0.02318286895751953
r_  generation:  0.18178248405456543
local_output_nid generation:  0.009139299392700195
local_in_edges_tensor generation:  0.010561227798461914
mini_batch_src_global generation:  0.02382349967956543
r_  generation:  0.18527889251708984
local_output_nid generation:  0.009087085723876953
local_in_edges_tensor generation:  0.0087127685546875
mini_batch_src_global generation:  0.022617816925048828
r_  generation:  0.18505096435546875
local_output_nid generation:  0.011261701583862305
local_in_edges_tensor generation:  0.009959936141967773
mini_batch_src_global generation:  0.024361133575439453
r_  generation:  0.18511462211608887
local_output_nid generation:  0.009381771087646484
local_in_edges_tensor generation:  0.010276317596435547
mini_batch_src_global generation:  0.023503780364990234
r_  generation:  0.18544983863830566
----------------------check_connections_block total spend ----------------------------- 8.65516185760498
generate_one_block  0.2579643726348877
generate_one_block  0.23189401626586914
generate_one_block  0.2387242317199707
generate_one_block  0.2503039836883545
generate_one_block  0.2728583812713623
generate_one_block  0.23270153999328613
generate_one_block  0.2668445110321045
generate_one_block  0.23573660850524902
generate_one_block  0.251659631729126
generate_one_block  0.2568936347961426
generate_one_block  0.25794267654418945
generate_one_block  0.23841071128845215
generate_one_block  0.2337932586669922
generate_one_block  0.2540106773376465
generate_one_block  0.23308873176574707
generate_one_block  0.25055503845214844
generate_one_block  0.24759817123413086
generate_one_block  0.2493269443511963
generate_one_block  0.24465203285217285
generate_one_block  0.24142885208129883
generate_one_block  0.23824405670166016
generate_one_block  0.2402324676513672
generate_one_block  0.2571067810058594
generate_one_block  0.24904561042785645
generate_one_block  0.2532477378845215
generate_one_block  0.23954129219055176
generate_one_block  0.25470399856567383
generate_one_block  0.23870277404785156
generate_one_block  0.2409803867340088
generate_one_block  0.23519277572631836
generate_one_block  0.2480626106262207
generate_one_block  0.24399447441101074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03765106201171875
gen group dst list time:  0.1142723560333252
time for parepare:  0.01862049102783203
local_output_nid generation:  0.02521228790283203
local_in_edges_tensor generation:  0.05066847801208496
mini_batch_src_global generation:  0.040316104888916016
r_  generation:  0.4279193878173828
local_output_nid generation:  0.02996039390563965
local_in_edges_tensor generation:  0.033399105072021484
mini_batch_src_global generation:  0.05056118965148926
r_  generation:  0.4202730655670166
local_output_nid generation:  0.03042459487915039
local_in_edges_tensor generation:  0.028263568878173828
mini_batch_src_global generation:  0.04954195022583008
r_  generation:  0.4311974048614502
local_output_nid generation:  0.03070068359375
local_in_edges_tensor generation:  0.029694795608520508
mini_batch_src_global generation:  0.052416324615478516
r_  generation:  0.4338376522064209
local_output_nid generation:  0.028560876846313477
local_in_edges_tensor generation:  0.028544187545776367
mini_batch_src_global generation:  0.05017709732055664
r_  generation:  0.4307975769042969
local_output_nid generation:  0.028519868850708008
local_in_edges_tensor generation:  0.026473283767700195
mini_batch_src_global generation:  0.05368494987487793
r_  generation:  0.4282820224761963
local_output_nid generation:  0.02897334098815918
local_in_edges_tensor generation:  0.026118040084838867
mini_batch_src_global generation:  0.05113935470581055
r_  generation:  0.4369792938232422
local_output_nid generation:  0.028705358505249023
local_in_edges_tensor generation:  0.03506207466125488
mini_batch_src_global generation:  0.05367469787597656
r_  generation:  0.4328732490539551
local_output_nid generation:  0.030202388763427734
local_in_edges_tensor generation:  0.028592824935913086
mini_batch_src_global generation:  0.05253911018371582
r_  generation:  0.4392738342285156
local_output_nid generation:  0.030630826950073242
local_in_edges_tensor generation:  0.027973413467407227
mini_batch_src_global generation:  0.05354785919189453
r_  generation:  0.4384469985961914
local_output_nid generation:  0.02952432632446289
local_in_edges_tensor generation:  0.030310630798339844
mini_batch_src_global generation:  0.050957679748535156
r_  generation:  0.4445915222167969
local_output_nid generation:  0.028856754302978516
local_in_edges_tensor generation:  0.028507232666015625
mini_batch_src_global generation:  0.05130481719970703
r_  generation:  0.4307279586791992
local_output_nid generation:  0.029073476791381836
local_in_edges_tensor generation:  0.029175281524658203
mini_batch_src_global generation:  0.054056406021118164
r_  generation:  0.44059181213378906
local_output_nid generation:  0.029139280319213867
local_in_edges_tensor generation:  0.029078245162963867
mini_batch_src_global generation:  0.07188081741333008
r_  generation:  0.4667210578918457
local_output_nid generation:  0.0324854850769043
local_in_edges_tensor generation:  0.033112525939941406
mini_batch_src_global generation:  0.056377410888671875
r_  generation:  0.4402894973754883
local_output_nid generation:  0.030292510986328125
local_in_edges_tensor generation:  0.03051590919494629
mini_batch_src_global generation:  0.053498268127441406
r_  generation:  0.4424161911010742
local_output_nid generation:  0.030336380004882812
local_in_edges_tensor generation:  0.028657197952270508
mini_batch_src_global generation:  0.052796125411987305
r_  generation:  0.4438471794128418
local_output_nid generation:  0.030070781707763672
local_in_edges_tensor generation:  0.0272524356842041
mini_batch_src_global generation:  0.05367732048034668
r_  generation:  0.453052282333374
local_output_nid generation:  0.029952526092529297
local_in_edges_tensor generation:  0.028772830963134766
mini_batch_src_global generation:  0.05276179313659668
r_  generation:  0.4417867660522461
local_output_nid generation:  0.03013134002685547
local_in_edges_tensor generation:  0.03006601333618164
mini_batch_src_global generation:  0.0518491268157959
r_  generation:  0.43669939041137695
local_output_nid generation:  0.032325029373168945
local_in_edges_tensor generation:  0.0344090461730957
mini_batch_src_global generation:  0.05233359336853027
r_  generation:  0.44128990173339844
local_output_nid generation:  0.030848264694213867
local_in_edges_tensor generation:  0.03097987174987793
mini_batch_src_global generation:  0.052918195724487305
r_  generation:  0.4392380714416504
local_output_nid generation:  0.030348777770996094
local_in_edges_tensor generation:  0.03255939483642578
mini_batch_src_global generation:  0.050390005111694336
r_  generation:  0.44706249237060547
local_output_nid generation:  0.03001570701599121
local_in_edges_tensor generation:  0.02899646759033203
mini_batch_src_global generation:  0.052518606185913086
r_  generation:  0.44960927963256836
local_output_nid generation:  0.029935121536254883
local_in_edges_tensor generation:  0.029665470123291016
mini_batch_src_global generation:  0.05390620231628418
r_  generation:  0.44565916061401367
local_output_nid generation:  0.0313875675201416
local_in_edges_tensor generation:  0.02875208854675293
mini_batch_src_global generation:  0.05198049545288086
r_  generation:  0.4358668327331543
local_output_nid generation:  0.0305330753326416
local_in_edges_tensor generation:  0.032497406005859375
mini_batch_src_global generation:  0.05115461349487305
r_  generation:  0.44318580627441406
local_output_nid generation:  0.030243635177612305
local_in_edges_tensor generation:  0.026906251907348633
mini_batch_src_global generation:  0.0517270565032959
r_  generation:  0.43647336959838867
local_output_nid generation:  0.029979944229125977
local_in_edges_tensor generation:  0.026800870895385742
mini_batch_src_global generation:  0.050179481506347656
r_  generation:  0.43903493881225586
local_output_nid generation:  0.030019760131835938
local_in_edges_tensor generation:  0.02810525894165039
mini_batch_src_global generation:  0.053223371505737305
r_  generation:  0.44489002227783203
local_output_nid generation:  0.03304481506347656
local_in_edges_tensor generation:  0.029028892517089844
mini_batch_src_global generation:  0.05118918418884277
r_  generation:  0.4448225498199463
local_output_nid generation:  0.0305178165435791
local_in_edges_tensor generation:  0.030860424041748047
mini_batch_src_global generation:  0.052138566970825195
r_  generation:  0.4394962787628174
----------------------check_connections_block total spend ----------------------------- 20.86790943145752
generate_one_block  0.596276044845581
generate_one_block  0.5813572406768799
generate_one_block  0.5866758823394775
generate_one_block  0.5905940532684326
generate_one_block  0.6887264251708984
generate_one_block  0.5792109966278076
generate_one_block  0.5871248245239258
generate_one_block  0.5916261672973633
generate_one_block  0.5836341381072998
generate_one_block  0.589604377746582
generate_one_block  0.5968129634857178
generate_one_block  0.5817742347717285
generate_one_block  0.5745337009429932
generate_one_block  0.5758581161499023
generate_one_block  0.5716328620910645
generate_one_block  0.5855340957641602
generate_one_block  0.5840132236480713
generate_one_block  0.5818352699279785
generate_one_block  0.5956318378448486
generate_one_block  0.5753922462463379
generate_one_block  0.5817439556121826
generate_one_block  0.5777480602264404
generate_one_block  0.5886578559875488
generate_one_block  0.5818099975585938
generate_one_block  0.5993762016296387
generate_one_block  0.5836124420166016
generate_one_block  0.5882656574249268
generate_one_block  0.5787019729614258
generate_one_block  0.5748238563537598
generate_one_block  0.5824429988861084
generate_one_block  0.5854086875915527
generate_one_block  0.5886497497558594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1267542839050293  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

connection checking time:  29.5230712890625
block generation total time  26.694533109664917
average batch blocks generation time:  0.8342041596770287
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10691356658935547  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.0794620513916  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10605955123901367  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.400446891784668  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10675191879272461  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.947399139404297  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10682868957519531  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.31690549850464  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10627365112304688  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.740567207336426  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10605859756469727  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.252808094024658  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.106842041015625  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.36537218093872  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10644197463989258  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.61162233352661  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10699892044067383  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.383875846862793  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10699176788330078  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.25316333770752  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10699748992919922  GigaBytes
Max Memory Allocated: 19.649134635925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.621140956878662  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10617637634277344  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.509806156158447  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10639286041259766  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.440157890319824  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10675239562988281  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.149209022521973  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1061849594116211  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.385525226593018  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10665702819824219  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.08831214904785  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10696220397949219  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.039747714996338  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10663604736328125  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.13227653503418  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10662698745727539  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.98474407196045  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1065530776977539  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.57292890548706  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10638093948364258  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.565014839172363  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10615301132202148  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.624730110168457  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10715770721435547  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.42512798309326  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1065373420715332  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.042885303497314  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10672807693481445  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.215961456298828  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1067500114440918  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.85051393508911  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10683870315551758  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.411359786987305  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10657691955566406  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.745211124420166  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.1062936782836914  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.784928798675537  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10648107528686523  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 18.591640949249268  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10672521591186523  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.106353759765625  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10677862167358398  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.001575469970703  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03495854139328003 |0.0214332714676857 |0.5535042658448219 |9.631365537643433e-05 |1.0604502856731415 |0.005454063415527344 |
----------------------------------------------------------pseudo_mini_loss sum 2.181994676589966
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  9115023
Number of first layer input nodes during this epoch:  4762214
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.12686586380004883  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030730247497558594
range selection method range initialization spend 0.013390779495239258
time for parepare:  0.020131349563598633
local_output_nid generation:  0.0010094642639160156
local_in_edges_tensor generation:  0.006978511810302734
mini_batch_src_global generation:  0.0015940666198730469
r_  generation:  0.010840892791748047
local_output_nid generation:  0.0009832382202148438
local_in_edges_tensor generation:  0.0006844997406005859
mini_batch_src_global generation:  0.0016832351684570312
r_  generation:  0.010986328125
local_output_nid generation:  0.0009241104125976562
local_in_edges_tensor generation:  0.0006108283996582031
mini_batch_src_global generation:  0.0011398792266845703
r_  generation:  0.010067939758300781
local_output_nid generation:  0.0009131431579589844
local_in_edges_tensor generation:  0.0006108283996582031
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.009933948516845703
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.000591278076171875
mini_batch_src_global generation:  0.001039266586303711
r_  generation:  0.00945425033569336
local_output_nid generation:  0.0008792877197265625
local_in_edges_tensor generation:  0.000598907470703125
mini_batch_src_global generation:  0.0011150836944580078
r_  generation:  0.01004648208618164
local_output_nid generation:  0.0009653568267822266
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0011625289916992188
r_  generation:  0.010069131851196289
local_output_nid generation:  0.0008990764617919922
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.009846687316894531
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0005779266357421875
mini_batch_src_global generation:  0.0011034011840820312
r_  generation:  0.009983301162719727
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.009866952896118164
local_output_nid generation:  0.000881195068359375
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.010208845138549805
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.000598907470703125
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  0.01018834114074707
local_output_nid generation:  0.0008614063262939453
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.001096963882446289
r_  generation:  0.010097026824951172
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.01025390625
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.010236024856567383
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.001150369644165039
r_  generation:  0.010701656341552734
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0005931854248046875
mini_batch_src_global generation:  0.001192331314086914
r_  generation:  0.010564088821411133
local_output_nid generation:  0.0008873939514160156
local_in_edges_tensor generation:  0.0006022453308105469
mini_batch_src_global generation:  0.0012056827545166016
r_  generation:  0.010227441787719727
local_output_nid generation:  0.0008552074432373047
local_in_edges_tensor generation:  0.0005662441253662109
mini_batch_src_global generation:  0.0011858940124511719
r_  generation:  0.010323524475097656
local_output_nid generation:  0.0009031295776367188
local_in_edges_tensor generation:  0.0005819797515869141
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.010066032409667969
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005667209625244141
mini_batch_src_global generation:  0.0011851787567138672
r_  generation:  0.01031947135925293
local_output_nid generation:  0.0009024143218994141
local_in_edges_tensor generation:  0.0005908012390136719
mini_batch_src_global generation:  0.0011811256408691406
r_  generation:  0.01030588150024414
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0005676746368408203
mini_batch_src_global generation:  0.0011026859283447266
r_  generation:  0.010097742080688477
local_output_nid generation:  0.0008461475372314453
local_in_edges_tensor generation:  0.0005614757537841797
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.009912967681884766
local_output_nid generation:  0.0008554458618164062
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.001249551773071289
r_  generation:  0.010640382766723633
local_output_nid generation:  0.000850677490234375
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.0011904239654541016
r_  generation:  0.010395526885986328
local_output_nid generation:  0.0008687973022460938
local_in_edges_tensor generation:  0.0005991458892822266
mini_batch_src_global generation:  0.0011570453643798828
r_  generation:  0.010430097579956055
local_output_nid generation:  0.000858306884765625
local_in_edges_tensor generation:  0.0005784034729003906
mini_batch_src_global generation:  0.0011699199676513672
r_  generation:  0.010064363479614258
local_output_nid generation:  0.0008542537689208984
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.0012083053588867188
r_  generation:  0.010334968566894531
local_output_nid generation:  0.0008699893951416016
local_in_edges_tensor generation:  0.0005800724029541016
mini_batch_src_global generation:  0.001154184341430664
r_  generation:  0.010432958602905273
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.010274171829223633
local_output_nid generation:  0.0008671283721923828
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.0011789798736572266
r_  generation:  0.010154247283935547
----------------------check_connections_block total spend ----------------------------- 0.5182652473449707
generate_one_block  0.024867773056030273
generate_one_block  0.02155756950378418
generate_one_block  0.019005298614501953
generate_one_block  0.0185701847076416
generate_one_block  0.01755499839782715
generate_one_block  0.0182647705078125
generate_one_block  0.018038034439086914
generate_one_block  0.017574310302734375
generate_one_block  0.0181734561920166
generate_one_block  0.017791271209716797
generate_one_block  0.018344640731811523
generate_one_block  0.01854991912841797
generate_one_block  0.01790332794189453
generate_one_block  0.018208026885986328
generate_one_block  0.020407438278198242
generate_one_block  0.01863384246826172
generate_one_block  0.018413305282592773
generate_one_block  0.018138885498046875
generate_one_block  0.017908096313476562
generate_one_block  0.017929792404174805
generate_one_block  0.01811051368713379
generate_one_block  0.018219709396362305
generate_one_block  0.017919540405273438
generate_one_block  0.01756739616394043
generate_one_block  0.0188906192779541
generate_one_block  0.018095016479492188
generate_one_block  0.018543243408203125
generate_one_block  0.017798185348510742
generate_one_block  0.018214941024780273
generate_one_block  0.01840949058532715
generate_one_block  0.018030166625976562
generate_one_block  0.018100976943969727
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04873943328857422
gen group dst list time:  0.023245573043823242
time for parepare:  0.02194523811340332
local_output_nid generation:  0.005602359771728516
local_in_edges_tensor generation:  0.01832413673400879
mini_batch_src_global generation:  0.018239974975585938
r_  generation:  0.16362667083740234
local_output_nid generation:  0.007918596267700195
local_in_edges_tensor generation:  0.01040506362915039
mini_batch_src_global generation:  0.022923707962036133
r_  generation:  0.17364907264709473
local_output_nid generation:  0.007899045944213867
local_in_edges_tensor generation:  0.032271623611450195
mini_batch_src_global generation:  0.020256757736206055
r_  generation:  0.17348575592041016
local_output_nid generation:  0.008251428604125977
local_in_edges_tensor generation:  0.00847005844116211
mini_batch_src_global generation:  0.0210115909576416
r_  generation:  0.1741046905517578
local_output_nid generation:  0.008270502090454102
local_in_edges_tensor generation:  0.010754108428955078
mini_batch_src_global generation:  0.0214231014251709
r_  generation:  0.17117762565612793
local_output_nid generation:  0.008674860000610352
local_in_edges_tensor generation:  0.009357452392578125
mini_batch_src_global generation:  0.022622108459472656
r_  generation:  0.17578625679016113
local_output_nid generation:  0.008612632751464844
local_in_edges_tensor generation:  0.009830474853515625
mini_batch_src_global generation:  0.022835731506347656
r_  generation:  0.1759321689605713
local_output_nid generation:  0.008190631866455078
local_in_edges_tensor generation:  0.009212970733642578
mini_batch_src_global generation:  0.02154254913330078
r_  generation:  0.1699368953704834
local_output_nid generation:  0.008382797241210938
local_in_edges_tensor generation:  0.008852958679199219
mini_batch_src_global generation:  0.022541284561157227
r_  generation:  0.17862296104431152
local_output_nid generation:  0.00858759880065918
local_in_edges_tensor generation:  0.008643388748168945
mini_batch_src_global generation:  0.0226438045501709
r_  generation:  0.17734980583190918
local_output_nid generation:  0.00873255729675293
local_in_edges_tensor generation:  0.008847475051879883
mini_batch_src_global generation:  0.023111343383789062
r_  generation:  0.18541717529296875
local_output_nid generation:  0.009022235870361328
local_in_edges_tensor generation:  0.012208223342895508
mini_batch_src_global generation:  0.023783206939697266
r_  generation:  0.1827237606048584
local_output_nid generation:  0.008882522583007812
local_in_edges_tensor generation:  0.009107589721679688
mini_batch_src_global generation:  0.02284383773803711
r_  generation:  0.17908453941345215
local_output_nid generation:  0.009091377258300781
local_in_edges_tensor generation:  0.008880615234375
mini_batch_src_global generation:  0.023244142532348633
r_  generation:  0.1814258098602295
local_output_nid generation:  0.008942842483520508
local_in_edges_tensor generation:  0.009012460708618164
mini_batch_src_global generation:  0.02292346954345703
r_  generation:  0.17877721786499023
local_output_nid generation:  0.009154081344604492
local_in_edges_tensor generation:  0.009142637252807617
mini_batch_src_global generation:  0.02431654930114746
r_  generation:  0.18455195426940918
local_output_nid generation:  0.009042024612426758
local_in_edges_tensor generation:  0.010401010513305664
mini_batch_src_global generation:  0.023652315139770508
r_  generation:  0.18529582023620605
local_output_nid generation:  0.011574029922485352
local_in_edges_tensor generation:  0.012276172637939453
mini_batch_src_global generation:  0.023216962814331055
r_  generation:  0.1786048412322998
local_output_nid generation:  0.008949995040893555
local_in_edges_tensor generation:  0.009223222732543945
mini_batch_src_global generation:  0.02274918556213379
r_  generation:  0.17803120613098145
local_output_nid generation:  0.009099483489990234
local_in_edges_tensor generation:  0.008714437484741211
mini_batch_src_global generation:  0.022884607315063477
r_  generation:  0.1787712574005127
local_output_nid generation:  0.009118318557739258
local_in_edges_tensor generation:  0.008805990219116211
mini_batch_src_global generation:  0.023004770278930664
r_  generation:  0.18528437614440918
local_output_nid generation:  0.009165048599243164
local_in_edges_tensor generation:  0.00899958610534668
mini_batch_src_global generation:  0.02307724952697754
r_  generation:  0.18349123001098633
local_output_nid generation:  0.008957862854003906
local_in_edges_tensor generation:  0.008769512176513672
mini_batch_src_global generation:  0.022652626037597656
r_  generation:  0.18042707443237305
local_output_nid generation:  0.008861303329467773
local_in_edges_tensor generation:  0.008675336837768555
mini_batch_src_global generation:  0.02283763885498047
r_  generation:  0.1780080795288086
local_output_nid generation:  0.00947117805480957
local_in_edges_tensor generation:  0.01011037826538086
mini_batch_src_global generation:  0.023929119110107422
r_  generation:  0.19027233123779297
local_output_nid generation:  0.00885319709777832
local_in_edges_tensor generation:  0.01030731201171875
mini_batch_src_global generation:  0.023429155349731445
r_  generation:  0.18139934539794922
local_output_nid generation:  0.009238004684448242
local_in_edges_tensor generation:  0.00983881950378418
mini_batch_src_global generation:  0.024340152740478516
r_  generation:  0.18677401542663574
local_output_nid generation:  0.009063720703125
local_in_edges_tensor generation:  0.008830070495605469
mini_batch_src_global generation:  0.023289918899536133
r_  generation:  0.18027997016906738
local_output_nid generation:  0.009144783020019531
local_in_edges_tensor generation:  0.009558677673339844
mini_batch_src_global generation:  0.024103641510009766
r_  generation:  0.1847667694091797
local_output_nid generation:  0.009208440780639648
local_in_edges_tensor generation:  0.01114201545715332
mini_batch_src_global generation:  0.02321457862854004
r_  generation:  0.1810131072998047
local_output_nid generation:  0.009188175201416016
local_in_edges_tensor generation:  0.008970260620117188
mini_batch_src_global generation:  0.022733449935913086
r_  generation:  0.18257856369018555
local_output_nid generation:  0.009046554565429688
local_in_edges_tensor generation:  0.008761882781982422
mini_batch_src_global generation:  0.02302718162536621
r_  generation:  0.17655658721923828
----------------------check_connections_block total spend ----------------------------- 8.418240785598755
generate_one_block  0.2464308738708496
generate_one_block  0.25393176078796387
generate_one_block  0.24611806869506836
generate_one_block  0.2467191219329834
generate_one_block  0.25984930992126465
generate_one_block  0.2411201000213623
generate_one_block  0.23928141593933105
generate_one_block  0.23090910911560059
generate_one_block  0.2427055835723877
generate_one_block  0.24672865867614746
generate_one_block  0.2518186569213867
generate_one_block  0.24948692321777344
generate_one_block  0.23938751220703125
generate_one_block  0.24437856674194336
generate_one_block  0.23882627487182617
generate_one_block  0.25009989738464355
generate_one_block  0.25522923469543457
generate_one_block  0.2427675724029541
generate_one_block  0.23691296577453613
generate_one_block  0.24276494979858398
generate_one_block  0.2455897331237793
generate_one_block  0.24465274810791016
generate_one_block  0.2416234016418457
generate_one_block  0.24005508422851562
generate_one_block  0.25800275802612305
generate_one_block  0.24358320236206055
generate_one_block  0.25044941902160645
generate_one_block  0.24114751815795898
generate_one_block  0.251903772354126
generate_one_block  0.24744462966918945
generate_one_block  0.24365901947021484
generate_one_block  0.2361752986907959
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03502464294433594
gen group dst list time:  0.10716938972473145
time for parepare:  0.019359588623046875
local_output_nid generation:  0.025876283645629883
local_in_edges_tensor generation:  0.040381669998168945
mini_batch_src_global generation:  0.040157318115234375
r_  generation:  0.42784667015075684
local_output_nid generation:  0.030799150466918945
local_in_edges_tensor generation:  0.03420877456665039
mini_batch_src_global generation:  0.05481386184692383
r_  generation:  0.43230104446411133
local_output_nid generation:  0.030614376068115234
local_in_edges_tensor generation:  0.026626110076904297
mini_batch_src_global generation:  0.051283836364746094
r_  generation:  0.43647050857543945
local_output_nid generation:  0.03087139129638672
local_in_edges_tensor generation:  0.028621435165405273
mini_batch_src_global generation:  0.05036640167236328
r_  generation:  0.43824148178100586
local_output_nid generation:  0.030574321746826172
local_in_edges_tensor generation:  0.028162479400634766
mini_batch_src_global generation:  0.049780845642089844
r_  generation:  0.4333648681640625
local_output_nid generation:  0.029419422149658203
local_in_edges_tensor generation:  0.028624773025512695
mini_batch_src_global generation:  0.05098462104797363
r_  generation:  0.4376664161682129
local_output_nid generation:  0.029285907745361328
local_in_edges_tensor generation:  0.030672788619995117
mini_batch_src_global generation:  0.052314043045043945
r_  generation:  0.4376070499420166
local_output_nid generation:  0.029587745666503906
local_in_edges_tensor generation:  0.028974533081054688
mini_batch_src_global generation:  0.051500558853149414
r_  generation:  0.4310111999511719
local_output_nid generation:  0.029206514358520508
local_in_edges_tensor generation:  0.02635645866394043
mini_batch_src_global generation:  0.050398826599121094
r_  generation:  0.43902015686035156
local_output_nid generation:  0.029375076293945312
local_in_edges_tensor generation:  0.028562068939208984
mini_batch_src_global generation:  0.05183815956115723
r_  generation:  0.4410700798034668
local_output_nid generation:  0.029564857482910156
local_in_edges_tensor generation:  0.031504154205322266
mini_batch_src_global generation:  0.05047202110290527
r_  generation:  0.4385645389556885
local_output_nid generation:  0.029965877532958984
local_in_edges_tensor generation:  0.030426025390625
mini_batch_src_global generation:  0.05334901809692383
r_  generation:  0.4356694221496582
local_output_nid generation:  0.029262065887451172
local_in_edges_tensor generation:  0.030068397521972656
mini_batch_src_global generation:  0.05064821243286133
r_  generation:  0.43532419204711914
local_output_nid generation:  0.029268980026245117
local_in_edges_tensor generation:  0.027517318725585938
mini_batch_src_global generation:  0.05188417434692383
r_  generation:  0.4359548091888428
local_output_nid generation:  0.028996944427490234
local_in_edges_tensor generation:  0.027367353439331055
mini_batch_src_global generation:  0.05108523368835449
r_  generation:  0.4362959861755371
local_output_nid generation:  0.029239177703857422
local_in_edges_tensor generation:  0.027552127838134766
mini_batch_src_global generation:  0.051912784576416016
r_  generation:  0.4350006580352783
local_output_nid generation:  0.029459476470947266
local_in_edges_tensor generation:  0.03023672103881836
mini_batch_src_global generation:  0.052748918533325195
r_  generation:  0.4383225440979004
local_output_nid generation:  0.02962636947631836
local_in_edges_tensor generation:  0.02871847152709961
mini_batch_src_global generation:  0.05220651626586914
r_  generation:  0.4378981590270996
local_output_nid generation:  0.029624462127685547
local_in_edges_tensor generation:  0.028964519500732422
mini_batch_src_global generation:  0.05155301094055176
r_  generation:  0.45493626594543457
local_output_nid generation:  0.032222747802734375
local_in_edges_tensor generation:  0.026583433151245117
mini_batch_src_global generation:  0.053340911865234375
r_  generation:  0.4330427646636963
local_output_nid generation:  0.03055262565612793
local_in_edges_tensor generation:  0.030922651290893555
mini_batch_src_global generation:  0.050946712493896484
r_  generation:  0.432891845703125
local_output_nid generation:  0.03040766716003418
local_in_edges_tensor generation:  0.02647995948791504
mini_batch_src_global generation:  0.05384230613708496
r_  generation:  0.4360222816467285
local_output_nid generation:  0.030507564544677734
local_in_edges_tensor generation:  0.02756953239440918
mini_batch_src_global generation:  0.050776004791259766
r_  generation:  0.4333226680755615
local_output_nid generation:  0.030249834060668945
local_in_edges_tensor generation:  0.0287020206451416
mini_batch_src_global generation:  0.05360555648803711
r_  generation:  0.4363865852355957
local_output_nid generation:  0.030350685119628906
local_in_edges_tensor generation:  0.02883005142211914
mini_batch_src_global generation:  0.0532526969909668
r_  generation:  0.44324803352355957
local_output_nid generation:  0.030331134796142578
local_in_edges_tensor generation:  0.028519630432128906
mini_batch_src_global generation:  0.052512407302856445
r_  generation:  0.435244083404541
local_output_nid generation:  0.030255794525146484
local_in_edges_tensor generation:  0.028619050979614258
mini_batch_src_global generation:  0.05144834518432617
r_  generation:  0.4356961250305176
local_output_nid generation:  0.030208110809326172
local_in_edges_tensor generation:  0.027417421340942383
mini_batch_src_global generation:  0.0526583194732666
r_  generation:  0.4328944683074951
local_output_nid generation:  0.030320167541503906
local_in_edges_tensor generation:  0.026532411575317383
mini_batch_src_global generation:  0.053757667541503906
r_  generation:  0.4412093162536621
local_output_nid generation:  0.0304563045501709
local_in_edges_tensor generation:  0.027315139770507812
mini_batch_src_global generation:  0.05161643028259277
r_  generation:  0.43422794342041016
local_output_nid generation:  0.030368566513061523
local_in_edges_tensor generation:  0.02822589874267578
mini_batch_src_global generation:  0.0512697696685791
r_  generation:  0.4399571418762207
local_output_nid generation:  0.03045344352722168
local_in_edges_tensor generation:  0.029309511184692383
mini_batch_src_global generation:  0.051846981048583984
r_  generation:  0.4359138011932373
----------------------check_connections_block total spend ----------------------------- 20.663599491119385
generate_one_block  0.5874881744384766
generate_one_block  0.5871083736419678
generate_one_block  0.57633376121521
generate_one_block  0.5733447074890137
generate_one_block  0.6679298877716064
generate_one_block  0.5792019367218018
generate_one_block  0.5761682987213135
generate_one_block  0.5708212852478027
generate_one_block  0.5760006904602051
generate_one_block  0.5815048217773438
generate_one_block  0.5876166820526123
generate_one_block  0.5879085063934326
generate_one_block  0.5720076560974121
generate_one_block  0.5769574642181396
generate_one_block  0.5711178779602051
generate_one_block  0.5773682594299316
generate_one_block  0.5840175151824951
generate_one_block  0.5775871276855469
generate_one_block  0.5761079788208008
generate_one_block  0.5777976512908936
generate_one_block  0.5788438320159912
generate_one_block  0.5813806056976318
generate_one_block  0.5714352130889893
generate_one_block  0.5752246379852295
generate_one_block  0.6070327758789062
generate_one_block  0.5800633430480957
generate_one_block  0.5804922580718994
generate_one_block  0.5762920379638672
generate_one_block  0.5830426216125488
generate_one_block  0.5752365589141846
generate_one_block  0.5808110237121582
generate_one_block  0.5784094333648682
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.12686586380004883  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

connection checking time:  29.08184027671814
block generation total time  26.48240613937378
average batch blocks generation time:  0.8275751918554306
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10687446594238281  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 19.1847186088562  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 0.10691976547241211  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3143310546875 GB
    Memory Allocated: 19.41826105117798  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.1066751480102539  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 19.119429111480713  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10678720474243164  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 19.03719186782837  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10622978210449219  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.391031742095947  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10653877258300781  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.896095752716064  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10642433166503906  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.7480411529541  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10634040832519531  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.3254337310791  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10637044906616211  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.850313186645508  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10646343231201172  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.866506576538086  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10665607452392578  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 19.16379165649414  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.1067495346069336  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 19.254767417907715  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10616207122802734  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.727280139923096  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.1067352294921875  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 19.08497714996338  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10614299774169922  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.637237548828125  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10667991638183594  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 19.236518383026123  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10658454895019531  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 19.188324451446533  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.1065669059753418  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.909757614135742  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10676336288452148  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.565524578094482  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10660934448242188  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.73275089263916  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10664176940917969  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.88316011428833  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10658121109008789  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.9757719039917  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10647869110107422  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.59787654876709  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.10657358169555664  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 18.6864595413208  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3944091796875 GB
    Memory Allocated: 0.1069035530090332  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4080810546875 GB
    Memory Allocated: 19.45720386505127  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10647106170654297  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.93284273147583  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10678815841674805  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.203436851501465  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10658550262451172  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.764718055725098  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10663843154907227  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.07079553604126  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10663747787475586  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.90842914581299  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10652399063110352  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.807453632354736  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10642051696777344  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.68596601486206  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031251080334186554 |0.020074598491191864 |0.5943054929375648 |9.595602750778198e-05 |1.0615205466747284 |0.008156538009643555 |
----------------------------------------------------------pseudo_mini_loss sum 2.053075075149536
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  9109801
Number of first layer input nodes during this epoch:  4760989
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.1262040138244629  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030942201614379883
range selection method range initialization spend 0.014763832092285156
time for parepare:  0.027299165725708008
local_output_nid generation:  0.002539396286010742
local_in_edges_tensor generation:  0.008188724517822266
mini_batch_src_global generation:  0.003401517868041992
r_  generation:  0.013607025146484375
local_output_nid generation:  0.0012059211730957031
local_in_edges_tensor generation:  0.0007174015045166016
mini_batch_src_global generation:  0.0018649101257324219
r_  generation:  0.010663986206054688
local_output_nid generation:  0.0010263919830322266
local_in_edges_tensor generation:  0.0006129741668701172
mini_batch_src_global generation:  0.0012307167053222656
r_  generation:  0.010046720504760742
local_output_nid generation:  0.0009918212890625
local_in_edges_tensor generation:  0.0005803108215332031
mini_batch_src_global generation:  0.001209259033203125
r_  generation:  0.009891748428344727
local_output_nid generation:  0.0009515285491943359
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.0011742115020751953
r_  generation:  0.010066747665405273
local_output_nid generation:  0.0009336471557617188
local_in_edges_tensor generation:  0.0005941390991210938
mini_batch_src_global generation:  0.0012280941009521484
r_  generation:  0.010399341583251953
local_output_nid generation:  0.0009834766387939453
local_in_edges_tensor generation:  0.0005567073822021484
mini_batch_src_global generation:  0.001203775405883789
r_  generation:  0.010277986526489258
local_output_nid generation:  0.0009601116180419922
local_in_edges_tensor generation:  0.0005838871002197266
mini_batch_src_global generation:  0.0011668205261230469
r_  generation:  0.01016378402709961
local_output_nid generation:  0.0009152889251708984
local_in_edges_tensor generation:  0.0005774497985839844
mini_batch_src_global generation:  0.0011811256408691406
r_  generation:  0.010068893432617188
local_output_nid generation:  0.0009067058563232422
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.001207113265991211
r_  generation:  0.010386228561401367
local_output_nid generation:  0.0009036064147949219
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0012445449829101562
r_  generation:  0.010367393493652344
local_output_nid generation:  0.0009047985076904297
local_in_edges_tensor generation:  0.0005743503570556641
mini_batch_src_global generation:  0.0011794567108154297
r_  generation:  0.010521650314331055
local_output_nid generation:  0.0008962154388427734
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.0011749267578125
r_  generation:  0.009791851043701172
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0005860328674316406
mini_batch_src_global generation:  0.0011844635009765625
r_  generation:  0.010504007339477539
local_output_nid generation:  0.0009050369262695312
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0011796951293945312
r_  generation:  0.010270833969116211
local_output_nid generation:  0.0009319782257080078
local_in_edges_tensor generation:  0.0005788803100585938
mini_batch_src_global generation:  0.0011773109436035156
r_  generation:  0.01028132438659668
local_output_nid generation:  0.0009183883666992188
local_in_edges_tensor generation:  0.0005750656127929688
mini_batch_src_global generation:  0.001199483871459961
r_  generation:  0.01058650016784668
local_output_nid generation:  0.0009260177612304688
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.0011627674102783203
r_  generation:  0.01007986068725586
local_output_nid generation:  0.0009303092956542969
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.009966373443603516
local_output_nid generation:  0.0009226799011230469
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.0012423992156982422
r_  generation:  0.010336160659790039
local_output_nid generation:  0.0009179115295410156
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.010339736938476562
local_output_nid generation:  0.0009179115295410156
local_in_edges_tensor generation:  0.0005781650543212891
mini_batch_src_global generation:  0.0012445449829101562
r_  generation:  0.010660648345947266
local_output_nid generation:  0.0009226799011230469
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.0011937618255615234
r_  generation:  0.010476350784301758
local_output_nid generation:  0.0009105205535888672
local_in_edges_tensor generation:  0.0005650520324707031
mini_batch_src_global generation:  0.0011610984802246094
r_  generation:  0.010182380676269531
local_output_nid generation:  0.0009300708770751953
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.0011894702911376953
r_  generation:  0.01019144058227539
local_output_nid generation:  0.0009157657623291016
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.010311365127563477
local_output_nid generation:  0.0009160041809082031
local_in_edges_tensor generation:  0.0005927085876464844
mini_batch_src_global generation:  0.0012617111206054688
r_  generation:  0.010508060455322266
local_output_nid generation:  0.0009109973907470703
local_in_edges_tensor generation:  0.0005712509155273438
mini_batch_src_global generation:  0.0011777877807617188
r_  generation:  0.010173559188842773
local_output_nid generation:  0.0009038448333740234
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0011646747589111328
r_  generation:  0.010069608688354492
local_output_nid generation:  0.0009112358093261719
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0012392997741699219
r_  generation:  0.01043558120727539
local_output_nid generation:  0.0009143352508544922
local_in_edges_tensor generation:  0.0005710124969482422
mini_batch_src_global generation:  0.0011777877807617188
r_  generation:  0.010377645492553711
local_output_nid generation:  0.0009109973907470703
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0012509822845458984
r_  generation:  0.010408163070678711
----------------------check_connections_block total spend ----------------------------- 0.5412173271179199
generate_one_block  0.025220632553100586
generate_one_block  0.021996259689331055
generate_one_block  0.018683910369873047
generate_one_block  0.018935203552246094
generate_one_block  0.01887035369873047
generate_one_block  0.019315004348754883
generate_one_block  0.01869988441467285
generate_one_block  0.018767595291137695
generate_one_block  0.0184023380279541
generate_one_block  0.018917083740234375
generate_one_block  0.018605709075927734
generate_one_block  0.0192720890045166
generate_one_block  0.017821550369262695
generate_one_block  0.019174575805664062
generate_one_block  0.0183870792388916
generate_one_block  0.01862192153930664
generate_one_block  0.019017934799194336
generate_one_block  0.018211841583251953
generate_one_block  0.018044471740722656
generate_one_block  0.018680095672607422
generate_one_block  0.01851654052734375
generate_one_block  0.01899433135986328
generate_one_block  0.018680572509765625
generate_one_block  0.01827263832092285
generate_one_block  0.018273591995239258
generate_one_block  0.01860189437866211
generate_one_block  0.018793106079101562
generate_one_block  0.018399477005004883
generate_one_block  0.018146753311157227
generate_one_block  0.01878190040588379
generate_one_block  0.01839613914489746
generate_one_block  0.018845796585083008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04125499725341797
gen group dst list time:  0.026230573654174805
time for parepare:  0.022370576858520508
local_output_nid generation:  0.0055997371673583984
local_in_edges_tensor generation:  0.016442060470581055
mini_batch_src_global generation:  0.019449710845947266
r_  generation:  0.16091561317443848
local_output_nid generation:  0.008011341094970703
local_in_edges_tensor generation:  0.010602951049804688
mini_batch_src_global generation:  0.024008989334106445
r_  generation:  0.17409253120422363
local_output_nid generation:  0.007713794708251953
local_in_edges_tensor generation:  0.032247066497802734
mini_batch_src_global generation:  0.020073890686035156
r_  generation:  0.16703414916992188
local_output_nid generation:  0.008356571197509766
local_in_edges_tensor generation:  0.00809931755065918
mini_batch_src_global generation:  0.0215604305267334
r_  generation:  0.21054911613464355
local_output_nid generation:  0.00858759880065918
local_in_edges_tensor generation:  0.008940696716308594
mini_batch_src_global generation:  0.021586179733276367
r_  generation:  0.17892837524414062
local_output_nid generation:  0.009216547012329102
local_in_edges_tensor generation:  0.009247064590454102
mini_batch_src_global generation:  0.02319788932800293
r_  generation:  0.18367505073547363
local_output_nid generation:  0.00901341438293457
local_in_edges_tensor generation:  0.00921940803527832
mini_batch_src_global generation:  0.022665023803710938
r_  generation:  0.18135309219360352
local_output_nid generation:  0.008395910263061523
local_in_edges_tensor generation:  0.009017229080200195
mini_batch_src_global generation:  0.02254033088684082
r_  generation:  0.20978593826293945
local_output_nid generation:  0.013356685638427734
local_in_edges_tensor generation:  0.012443065643310547
mini_batch_src_global generation:  0.026248693466186523
r_  generation:  0.19846153259277344
local_output_nid generation:  0.014526128768920898
local_in_edges_tensor generation:  0.012888431549072266
mini_batch_src_global generation:  0.026301145553588867
r_  generation:  0.2056574821472168
local_output_nid generation:  0.013141870498657227
local_in_edges_tensor generation:  0.010535717010498047
mini_batch_src_global generation:  0.02650165557861328
r_  generation:  0.22019028663635254
local_output_nid generation:  0.010339736938476562
local_in_edges_tensor generation:  0.01018977165222168
mini_batch_src_global generation:  0.024331331253051758
r_  generation:  0.18498015403747559
local_output_nid generation:  0.011421442031860352
local_in_edges_tensor generation:  0.008502483367919922
mini_batch_src_global generation:  0.022298574447631836
r_  generation:  0.1800827980041504
local_output_nid generation:  0.009612798690795898
local_in_edges_tensor generation:  0.012463569641113281
mini_batch_src_global generation:  0.02440929412841797
r_  generation:  0.19008898735046387
local_output_nid generation:  0.011350393295288086
local_in_edges_tensor generation:  0.012441158294677734
mini_batch_src_global generation:  0.022873878479003906
r_  generation:  0.181044340133667
local_output_nid generation:  0.009078264236450195
local_in_edges_tensor generation:  0.009599447250366211
mini_batch_src_global generation:  0.023773908615112305
r_  generation:  0.18606114387512207
local_output_nid generation:  0.013255119323730469
local_in_edges_tensor generation:  0.011992692947387695
mini_batch_src_global generation:  0.023601531982421875
r_  generation:  0.1934795379638672
local_output_nid generation:  0.009063482284545898
local_in_edges_tensor generation:  0.009633779525756836
mini_batch_src_global generation:  0.024655818939208984
r_  generation:  0.18210625648498535
local_output_nid generation:  0.009109020233154297
local_in_edges_tensor generation:  0.009254932403564453
mini_batch_src_global generation:  0.022568702697753906
r_  generation:  0.1807572841644287
local_output_nid generation:  0.00925898551940918
local_in_edges_tensor generation:  0.009925365447998047
mini_batch_src_global generation:  0.024801015853881836
r_  generation:  0.1981797218322754
local_output_nid generation:  0.011470794677734375
local_in_edges_tensor generation:  0.009606122970581055
mini_batch_src_global generation:  0.023865222930908203
r_  generation:  0.1890733242034912
local_output_nid generation:  0.009830713272094727
local_in_edges_tensor generation:  0.009242057800292969
mini_batch_src_global generation:  0.02386617660522461
r_  generation:  0.18841552734375
local_output_nid generation:  0.009588003158569336
local_in_edges_tensor generation:  0.011144876480102539
mini_batch_src_global generation:  0.024261474609375
r_  generation:  0.18366599082946777
local_output_nid generation:  0.009424209594726562
local_in_edges_tensor generation:  0.00870656967163086
mini_batch_src_global generation:  0.02338552474975586
r_  generation:  0.18386340141296387
local_output_nid generation:  0.009181737899780273
local_in_edges_tensor generation:  0.008679866790771484
mini_batch_src_global generation:  0.023211240768432617
r_  generation:  0.22581028938293457
local_output_nid generation:  0.009376287460327148
local_in_edges_tensor generation:  0.008948326110839844
mini_batch_src_global generation:  0.023077011108398438
r_  generation:  0.17938017845153809
local_output_nid generation:  0.009558677673339844
local_in_edges_tensor generation:  0.009757041931152344
mini_batch_src_global generation:  0.023936033248901367
r_  generation:  0.1852245330810547
local_output_nid generation:  0.009456157684326172
local_in_edges_tensor generation:  0.008749723434448242
mini_batch_src_global generation:  0.023494482040405273
r_  generation:  0.18135905265808105
local_output_nid generation:  0.009314298629760742
local_in_edges_tensor generation:  0.008604049682617188
mini_batch_src_global generation:  0.02328968048095703
r_  generation:  0.18265056610107422
local_output_nid generation:  0.009509801864624023
local_in_edges_tensor generation:  0.010433673858642578
mini_batch_src_global generation:  0.02361011505126953
r_  generation:  0.21815013885498047
local_output_nid generation:  0.009366750717163086
local_in_edges_tensor generation:  0.008867740631103516
mini_batch_src_global generation:  0.023192405700683594
r_  generation:  0.17997360229492188
local_output_nid generation:  0.009540557861328125
local_in_edges_tensor generation:  0.009009599685668945
mini_batch_src_global generation:  0.02300095558166504
r_  generation:  0.1817328929901123
----------------------check_connections_block total spend ----------------------------- 8.830969095230103
generate_one_block  0.2565455436706543
generate_one_block  0.27073001861572266
generate_one_block  0.24248170852661133
generate_one_block  0.25051426887512207
generate_one_block  0.2859065532684326
generate_one_block  0.2573516368865967
generate_one_block  0.2586371898651123
generate_one_block  0.24498319625854492
generate_one_block  0.24817991256713867
generate_one_block  0.2472672462463379
generate_one_block  0.24047470092773438
generate_one_block  0.25011754035949707
generate_one_block  0.23515939712524414
generate_one_block  0.2549750804901123
generate_one_block  0.2364637851715088
generate_one_block  0.2517433166503906
generate_one_block  0.2564206123352051
generate_one_block  0.2410736083984375
generate_one_block  0.24449491500854492
generate_one_block  0.2608766555786133
generate_one_block  0.24483847618103027
generate_one_block  0.25282931327819824
generate_one_block  0.24538874626159668
generate_one_block  0.24513483047485352
generate_one_block  0.2439422607421875
generate_one_block  0.24431157112121582
generate_one_block  0.24913692474365234
generate_one_block  0.2486405372619629
generate_one_block  0.25535035133361816
generate_one_block  0.2570345401763916
generate_one_block  0.24621868133544922
generate_one_block  0.2459697723388672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0471949577331543
gen group dst list time:  0.11362600326538086
time for parepare:  0.01959085464477539
local_output_nid generation:  0.026057004928588867
local_in_edges_tensor generation:  0.04621076583862305
mini_batch_src_global generation:  0.055052995681762695
r_  generation:  0.4267716407775879
local_output_nid generation:  0.03067803382873535
local_in_edges_tensor generation:  0.03341364860534668
mini_batch_src_global generation:  0.05268573760986328
r_  generation:  0.4242696762084961
local_output_nid generation:  0.030214548110961914
local_in_edges_tensor generation:  0.030182600021362305
mini_batch_src_global generation:  0.04927992820739746
r_  generation:  0.436800479888916
local_output_nid generation:  0.03084588050842285
local_in_edges_tensor generation:  0.035675048828125
mini_batch_src_global generation:  0.05279064178466797
r_  generation:  0.4409515857696533
local_output_nid generation:  0.030973434448242188
local_in_edges_tensor generation:  0.03418850898742676
mini_batch_src_global generation:  0.05180501937866211
r_  generation:  0.45922064781188965
local_output_nid generation:  0.0344998836517334
local_in_edges_tensor generation:  0.03061532974243164
mini_batch_src_global generation:  0.05767393112182617
r_  generation:  0.43027687072753906
local_output_nid generation:  0.030060768127441406
local_in_edges_tensor generation:  0.026468753814697266
mini_batch_src_global generation:  0.05071210861206055
r_  generation:  0.43912267684936523
local_output_nid generation:  0.030046939849853516
local_in_edges_tensor generation:  0.028549909591674805
mini_batch_src_global generation:  0.05132603645324707
r_  generation:  0.4335365295410156
local_output_nid generation:  0.030106067657470703
local_in_edges_tensor generation:  0.028912782669067383
mini_batch_src_global generation:  0.052556514739990234
r_  generation:  0.4537975788116455
local_output_nid generation:  0.030346393585205078
local_in_edges_tensor generation:  0.028731584548950195
mini_batch_src_global generation:  0.05359625816345215
r_  generation:  0.43787598609924316
local_output_nid generation:  0.030199289321899414
local_in_edges_tensor generation:  0.03308391571044922
mini_batch_src_global generation:  0.050789594650268555
r_  generation:  0.44478368759155273
local_output_nid generation:  0.03193163871765137
local_in_edges_tensor generation:  0.03359222412109375
mini_batch_src_global generation:  0.051876068115234375
r_  generation:  0.4407386779785156
local_output_nid generation:  0.03050851821899414
local_in_edges_tensor generation:  0.02885293960571289
mini_batch_src_global generation:  0.05009651184082031
r_  generation:  0.4368267059326172
local_output_nid generation:  0.03056812286376953
local_in_edges_tensor generation:  0.03220820426940918
mini_batch_src_global generation:  0.0556485652923584
r_  generation:  0.437760591506958
local_output_nid generation:  0.029973506927490234
local_in_edges_tensor generation:  0.032346248626708984
mini_batch_src_global generation:  0.0525212287902832
r_  generation:  0.44834256172180176
local_output_nid generation:  0.031203031539916992
local_in_edges_tensor generation:  0.028666973114013672
mini_batch_src_global generation:  0.06113481521606445
r_  generation:  0.4374887943267822
local_output_nid generation:  0.031400203704833984
local_in_edges_tensor generation:  0.03046441078186035
mini_batch_src_global generation:  0.05277681350708008
r_  generation:  0.44172072410583496
local_output_nid generation:  0.03018474578857422
local_in_edges_tensor generation:  0.029071331024169922
mini_batch_src_global generation:  0.051909446716308594
r_  generation:  0.43146324157714844
local_output_nid generation:  0.030194759368896484
local_in_edges_tensor generation:  0.026630163192749023
mini_batch_src_global generation:  0.05047464370727539
r_  generation:  0.4379246234893799
local_output_nid generation:  0.030225038528442383
local_in_edges_tensor generation:  0.029765605926513672
mini_batch_src_global generation:  0.05188941955566406
r_  generation:  0.4437077045440674
local_output_nid generation:  0.030210018157958984
local_in_edges_tensor generation:  0.027235031127929688
mini_batch_src_global generation:  0.05078005790710449
r_  generation:  0.43395090103149414
local_output_nid generation:  0.030752182006835938
local_in_edges_tensor generation:  0.02837395668029785
mini_batch_src_global generation:  0.05329298973083496
r_  generation:  0.4348273277282715
local_output_nid generation:  0.030277252197265625
local_in_edges_tensor generation:  0.027216196060180664
mini_batch_src_global generation:  0.05008697509765625
r_  generation:  0.43463635444641113
local_output_nid generation:  0.030306577682495117
local_in_edges_tensor generation:  0.027963638305664062
mini_batch_src_global generation:  0.05115365982055664
r_  generation:  0.43126893043518066
local_output_nid generation:  0.030144691467285156
local_in_edges_tensor generation:  0.028762340545654297
mini_batch_src_global generation:  0.05010533332824707
r_  generation:  0.4371798038482666
local_output_nid generation:  0.030632734298706055
local_in_edges_tensor generation:  0.03203296661376953
mini_batch_src_global generation:  0.05379176139831543
r_  generation:  0.4334373474121094
local_output_nid generation:  0.030268430709838867
local_in_edges_tensor generation:  0.026856184005737305
mini_batch_src_global generation:  0.05004072189331055
r_  generation:  0.4382591247558594
local_output_nid generation:  0.03029155731201172
local_in_edges_tensor generation:  0.02843475341796875
mini_batch_src_global generation:  0.05193328857421875
r_  generation:  0.43250298500061035
local_output_nid generation:  0.030117034912109375
local_in_edges_tensor generation:  0.029756784439086914
mini_batch_src_global generation:  0.05395650863647461
r_  generation:  0.43346714973449707
local_output_nid generation:  0.03023505210876465
local_in_edges_tensor generation:  0.03032517433166504
mini_batch_src_global generation:  0.05170631408691406
r_  generation:  0.43881940841674805
local_output_nid generation:  0.03018808364868164
local_in_edges_tensor generation:  0.026942968368530273
mini_batch_src_global generation:  0.05015110969543457
r_  generation:  0.4414031505584717
local_output_nid generation:  0.032026052474975586
local_in_edges_tensor generation:  0.028486967086791992
mini_batch_src_global generation:  0.05172896385192871
r_  generation:  0.4412875175476074
----------------------check_connections_block total spend ----------------------------- 20.84241795539856
generate_one_block  0.6034178733825684
generate_one_block  0.5940732955932617
generate_one_block  0.5789697170257568
generate_one_block  0.5846641063690186
generate_one_block  0.6860249042510986
generate_one_block  0.5895862579345703
generate_one_block  0.589606523513794
generate_one_block  0.5871694087982178
generate_one_block  0.5883331298828125
generate_one_block  0.5941276550292969
generate_one_block  0.589688777923584
generate_one_block  0.592806339263916
generate_one_block  0.5797121524810791
generate_one_block  0.5934228897094727
generate_one_block  0.5928750038146973
generate_one_block  0.589430570602417
generate_one_block  0.5897116661071777
generate_one_block  0.5784792900085449
generate_one_block  0.5818212032318115
generate_one_block  0.5948264598846436
generate_one_block  0.5882580280303955
generate_one_block  0.5936770439147949
generate_one_block  0.5933551788330078
generate_one_block  0.5859227180480957
generate_one_block  0.6023774147033691
generate_one_block  0.5877702236175537
generate_one_block  0.5917258262634277
generate_one_block  0.5834367275238037
generate_one_block  0.5790321826934814
generate_one_block  0.5941696166992188
generate_one_block  0.5804653167724609
generate_one_block  0.5878450870513916
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.1262040138244629  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

connection checking time:  29.673387050628662
block generation total time  26.959975481033325
average batch blocks generation time:  0.8424992337822914
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10688066482543945  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.82152557373047  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.1070718765258789  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.262946128845215  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10619163513183594  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.523927211761475  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10661745071411133  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.003347873687744  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10656261444091797  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.967225074768066  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10660219192504883  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.192689418792725  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10652923583984375  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.0697922706604  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10649442672729492  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.86754035949707  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.1066594123840332  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.78428363800049  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.1067352294921875  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.012669563293457  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10648536682128906  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.75023365020752  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10672473907470703  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.09226894378662  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10567474365234375  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.27284002304077  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10685062408447266  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.287343978881836  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10620546340942383  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.553940773010254  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10669660568237305  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.99289560317993  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10675430297851562  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.15462064743042  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10662698745727539  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.63868761062622  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10644674301147461  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.618746280670166  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10690546035766602  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.259787559509277  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10662651062011719  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.95417070388794  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10698604583740234  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.291375160217285  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10652303695678711  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.933736324310303  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.1063990592956543  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.921828269958496  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10654783248901367  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.918925762176514  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10664510726928711  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.855504989624023  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10664701461791992  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.097066402435303  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10668087005615234  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.814058303833008  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10647439956665039  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.57591152191162  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.1064605712890625  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.114994049072266  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10642671585083008  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.77292013168335  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.10664653778076172  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 18.880538940429688  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0375688374042511 |0.022144868969917297 |0.5614795982837677 |9.918957948684692e-05 |1.062119722366333 |0.008388042449951172 |
----------------------------------------------------------pseudo_mini_loss sum 1.948652744293213
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  9110610
Number of first layer input nodes during this epoch:  4761536
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.1267871856689453  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028650760650634766
range selection method range initialization spend 0.016071796417236328
time for parepare:  0.02487659454345703
local_output_nid generation:  0.001247406005859375
local_in_edges_tensor generation:  0.004978179931640625
mini_batch_src_global generation:  0.0025289058685302734
r_  generation:  0.01141977310180664
local_output_nid generation:  0.001027822494506836
local_in_edges_tensor generation:  0.0007901191711425781
mini_batch_src_global generation:  0.002111196517944336
r_  generation:  0.011808156967163086
local_output_nid generation:  0.0010159015655517578
local_in_edges_tensor generation:  0.0008249282836914062
mini_batch_src_global generation:  0.0015664100646972656
r_  generation:  0.010673999786376953
local_output_nid generation:  0.001026153564453125
local_in_edges_tensor generation:  0.0007388591766357422
mini_batch_src_global generation:  0.0015053749084472656
r_  generation:  0.010070085525512695
local_output_nid generation:  0.0010113716125488281
local_in_edges_tensor generation:  0.0006883144378662109
mini_batch_src_global generation:  0.0014276504516601562
r_  generation:  0.010037660598754883
local_output_nid generation:  0.0010287761688232422
local_in_edges_tensor generation:  0.0006799697875976562
mini_batch_src_global generation:  0.0014510154724121094
r_  generation:  0.010778427124023438
local_output_nid generation:  0.0010402202606201172
local_in_edges_tensor generation:  0.0006532669067382812
mini_batch_src_global generation:  0.0014030933380126953
r_  generation:  0.010596513748168945
local_output_nid generation:  0.0010609626770019531
local_in_edges_tensor generation:  0.0006864070892333984
mini_batch_src_global generation:  0.0013811588287353516
r_  generation:  0.010300397872924805
local_output_nid generation:  0.0010256767272949219
local_in_edges_tensor generation:  0.0006873607635498047
mini_batch_src_global generation:  0.0014014244079589844
r_  generation:  0.010670661926269531
local_output_nid generation:  0.002386808395385742
local_in_edges_tensor generation:  0.0013670921325683594
mini_batch_src_global generation:  0.0034651756286621094
r_  generation:  0.014496088027954102
local_output_nid generation:  0.0011937618255615234
local_in_edges_tensor generation:  0.0006814002990722656
mini_batch_src_global generation:  0.0015208721160888672
r_  generation:  0.010897159576416016
local_output_nid generation:  0.001043558120727539
local_in_edges_tensor generation:  0.0006012916564941406
mini_batch_src_global generation:  0.0014879703521728516
r_  generation:  0.010649442672729492
local_output_nid generation:  0.0009884834289550781
local_in_edges_tensor generation:  0.0006103515625
mini_batch_src_global generation:  0.0012066364288330078
r_  generation:  0.012402772903442383
local_output_nid generation:  0.0009922981262207031
local_in_edges_tensor generation:  0.0006947517395019531
mini_batch_src_global generation:  0.0014922618865966797
r_  generation:  0.01061701774597168
local_output_nid generation:  0.0009260177612304688
local_in_edges_tensor generation:  0.0006802082061767578
mini_batch_src_global generation:  0.0012941360473632812
r_  generation:  0.01023554801940918
local_output_nid generation:  0.0008823871612548828
local_in_edges_tensor generation:  0.0006184577941894531
mini_batch_src_global generation:  0.0012187957763671875
r_  generation:  0.010695934295654297
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0006132125854492188
mini_batch_src_global generation:  0.0014717578887939453
r_  generation:  0.010651111602783203
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0006070137023925781
mini_batch_src_global generation:  0.0011832714080810547
r_  generation:  0.009903907775878906
local_output_nid generation:  0.0008943080902099609
local_in_edges_tensor generation:  0.0006394386291503906
mini_batch_src_global generation:  0.0014379024505615234
r_  generation:  0.01029205322265625
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0006327629089355469
mini_batch_src_global generation:  0.0011582374572753906
r_  generation:  0.01193547248840332
local_output_nid generation:  0.0008993148803710938
local_in_edges_tensor generation:  0.0006110668182373047
mini_batch_src_global generation:  0.0011930465698242188
r_  generation:  0.00991201400756836
local_output_nid generation:  0.0008718967437744141
local_in_edges_tensor generation:  0.0006058216094970703
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.01028895378112793
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0006215572357177734
mini_batch_src_global generation:  0.001214742660522461
r_  generation:  0.010147333145141602
local_output_nid generation:  0.0008454322814941406
local_in_edges_tensor generation:  0.0006220340728759766
mini_batch_src_global generation:  0.0012211799621582031
r_  generation:  0.010494232177734375
local_output_nid generation:  0.0008566379547119141
local_in_edges_tensor generation:  0.0006477832794189453
mini_batch_src_global generation:  0.00118255615234375
r_  generation:  0.010239362716674805
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0006597042083740234
mini_batch_src_global generation:  0.0012063980102539062
r_  generation:  0.01052093505859375
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0006034374237060547
mini_batch_src_global generation:  0.0011413097381591797
r_  generation:  0.012389659881591797
local_output_nid generation:  0.0008771419525146484
local_in_edges_tensor generation:  0.0007472038269042969
mini_batch_src_global generation:  0.0012502670288085938
r_  generation:  0.010965108871459961
local_output_nid generation:  0.0008869171142578125
local_in_edges_tensor generation:  0.0006239414215087891
mini_batch_src_global generation:  0.0012028217315673828
r_  generation:  0.010097980499267578
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0007266998291015625
mini_batch_src_global generation:  0.0012478828430175781
r_  generation:  0.010676383972167969
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.0011796951293945312
r_  generation:  0.010108470916748047
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0006608963012695312
mini_batch_src_global generation:  0.0015387535095214844
r_  generation:  0.010386228561401367
----------------------check_connections_block total spend ----------------------------- 0.5621490478515625
generate_one_block  0.03143882751464844
generate_one_block  0.021329402923583984
generate_one_block  0.01945352554321289
generate_one_block  0.018217802047729492
generate_one_block  0.0185854434967041
generate_one_block  0.020708322525024414
generate_one_block  0.018666505813598633
generate_one_block  0.01814126968383789
generate_one_block  0.01883840560913086
generate_one_block  0.018157243728637695
generate_one_block  0.018512248992919922
generate_one_block  0.020867109298706055
generate_one_block  0.0184023380279541
generate_one_block  0.01900339126586914
generate_one_block  0.01813530921936035
generate_one_block  0.01872086524963379
generate_one_block  0.02030205726623535
generate_one_block  0.017731189727783203
generate_one_block  0.018346786499023438
generate_one_block  0.018061399459838867
generate_one_block  0.01758432388305664
generate_one_block  0.01806187629699707
generate_one_block  0.022161483764648438
generate_one_block  0.019123315811157227
generate_one_block  0.01795220375061035
generate_one_block  0.01833319664001465
generate_one_block  0.018347740173339844
generate_one_block  0.022612571716308594
generate_one_block  0.019927024841308594
generate_one_block  0.019130945205688477
generate_one_block  0.018064498901367188
generate_one_block  0.018400907516479492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041715383529663086
gen group dst list time:  0.026680469512939453
time for parepare:  0.024576663970947266
local_output_nid generation:  0.00652003288269043
local_in_edges_tensor generation:  0.017503976821899414
mini_batch_src_global generation:  0.021177291870117188
r_  generation:  0.17150592803955078
local_output_nid generation:  0.007776975631713867
local_in_edges_tensor generation:  0.01103663444519043
mini_batch_src_global generation:  0.024988412857055664
r_  generation:  0.19533109664916992
local_output_nid generation:  0.01112985610961914
local_in_edges_tensor generation:  0.038022756576538086
mini_batch_src_global generation:  0.023958921432495117
r_  generation:  0.17574834823608398
local_output_nid generation:  0.007908821105957031
local_in_edges_tensor generation:  0.010545730590820312
mini_batch_src_global generation:  0.023191213607788086
r_  generation:  0.17287111282348633
local_output_nid generation:  0.008651971817016602
local_in_edges_tensor generation:  0.00830984115600586
mini_batch_src_global generation:  0.021786212921142578
r_  generation:  0.17479181289672852
local_output_nid generation:  0.009052515029907227
local_in_edges_tensor generation:  0.009418487548828125
mini_batch_src_global generation:  0.022798776626586914
r_  generation:  0.18174290657043457
local_output_nid generation:  0.008757591247558594
local_in_edges_tensor generation:  0.008516311645507812
mini_batch_src_global generation:  0.02279210090637207
r_  generation:  0.18131542205810547
local_output_nid generation:  0.008433341979980469
local_in_edges_tensor generation:  0.009343147277832031
mini_batch_src_global generation:  0.033651113510131836
r_  generation:  0.19948267936706543
local_output_nid generation:  0.016503095626831055
local_in_edges_tensor generation:  0.01527714729309082
mini_batch_src_global generation:  0.02779674530029297
r_  generation:  0.20803546905517578
local_output_nid generation:  0.01784062385559082
local_in_edges_tensor generation:  0.013730049133300781
mini_batch_src_global generation:  0.0411374568939209
r_  generation:  0.18760395050048828
local_output_nid generation:  0.012238740921020508
local_in_edges_tensor generation:  0.009952306747436523
mini_batch_src_global generation:  0.03858757019042969
r_  generation:  0.18494272232055664
local_output_nid generation:  0.009868144989013672
local_in_edges_tensor generation:  0.01131296157836914
mini_batch_src_global generation:  0.027181148529052734
r_  generation:  0.1855299472808838
local_output_nid generation:  0.009271621704101562
local_in_edges_tensor generation:  0.008740425109863281
mini_batch_src_global generation:  0.0355374813079834
r_  generation:  0.2221074104309082
local_output_nid generation:  0.010257244110107422
local_in_edges_tensor generation:  0.0096282958984375
mini_batch_src_global generation:  0.026242971420288086
r_  generation:  0.18599343299865723
local_output_nid generation:  0.009305953979492188
local_in_edges_tensor generation:  0.009760618209838867
mini_batch_src_global generation:  0.02311992645263672
r_  generation:  0.18072962760925293
local_output_nid generation:  0.009307861328125
local_in_edges_tensor generation:  0.009567499160766602
mini_batch_src_global generation:  0.02392435073852539
r_  generation:  0.1829204559326172
local_output_nid generation:  0.009389162063598633
local_in_edges_tensor generation:  0.0088348388671875
mini_batch_src_global generation:  0.023649215698242188
r_  generation:  0.18909668922424316
local_output_nid generation:  0.008791208267211914
local_in_edges_tensor generation:  0.010875701904296875
mini_batch_src_global generation:  0.02269911766052246
r_  generation:  0.17191314697265625
local_output_nid generation:  0.009313583374023438
local_in_edges_tensor generation:  0.00881338119506836
mini_batch_src_global generation:  0.024088144302368164
r_  generation:  0.18037819862365723
local_output_nid generation:  0.00925898551940918
local_in_edges_tensor generation:  0.00861978530883789
mini_batch_src_global generation:  0.02265143394470215
r_  generation:  0.1788008213043213
local_output_nid generation:  0.008991479873657227
local_in_edges_tensor generation:  0.008397579193115234
mini_batch_src_global generation:  0.02356100082397461
r_  generation:  0.17486906051635742
local_output_nid generation:  0.009210586547851562
local_in_edges_tensor generation:  0.008595943450927734
mini_batch_src_global generation:  0.023058176040649414
r_  generation:  0.18442320823669434
local_output_nid generation:  0.009146928787231445
local_in_edges_tensor generation:  0.009356260299682617
mini_batch_src_global generation:  0.022877216339111328
r_  generation:  0.18146944046020508
local_output_nid generation:  0.011974096298217773
local_in_edges_tensor generation:  0.01326608657836914
mini_batch_src_global generation:  0.023720979690551758
r_  generation:  0.1867842674255371
local_output_nid generation:  0.009102344512939453
local_in_edges_tensor generation:  0.010075092315673828
mini_batch_src_global generation:  0.023083925247192383
r_  generation:  0.18282389640808105
local_output_nid generation:  0.009856939315795898
local_in_edges_tensor generation:  0.010065317153930664
mini_batch_src_global generation:  0.02451181411743164
r_  generation:  0.18858027458190918
local_output_nid generation:  0.00936126708984375
local_in_edges_tensor generation:  0.010608434677124023
mini_batch_src_global generation:  0.025182247161865234
r_  generation:  0.18335580825805664
local_output_nid generation:  0.00997781753540039
local_in_edges_tensor generation:  0.014502525329589844
mini_batch_src_global generation:  0.025417566299438477
r_  generation:  0.19635605812072754
local_output_nid generation:  0.010345935821533203
local_in_edges_tensor generation:  0.008788824081420898
mini_batch_src_global generation:  0.023477792739868164
r_  generation:  0.19189214706420898
local_output_nid generation:  0.011715173721313477
local_in_edges_tensor generation:  0.008932113647460938
mini_batch_src_global generation:  0.024999618530273438
r_  generation:  0.2304065227508545
local_output_nid generation:  0.014867305755615234
local_in_edges_tensor generation:  0.012616872787475586
mini_batch_src_global generation:  0.031195878982543945
r_  generation:  0.182373046875
local_output_nid generation:  0.011251449584960938
local_in_edges_tensor generation:  0.01081538200378418
mini_batch_src_global generation:  0.024237871170043945
r_  generation:  0.18572258949279785
----------------------check_connections_block total spend ----------------------------- 8.926565170288086
generate_one_block  0.28923988342285156
generate_one_block  0.25026893615722656
generate_one_block  0.24921774864196777
generate_one_block  0.24174857139587402
generate_one_block  0.2770395278930664
generate_one_block  0.25249338150024414
generate_one_block  0.24405741691589355
generate_one_block  0.24306559562683105
generate_one_block  0.25551748275756836
generate_one_block  0.24859261512756348
generate_one_block  0.25403261184692383
generate_one_block  0.26082658767700195
generate_one_block  0.251772403717041
generate_one_block  0.25734519958496094
generate_one_block  0.24932575225830078
generate_one_block  0.2592027187347412
generate_one_block  0.2511105537414551
generate_one_block  0.23443293571472168
generate_one_block  0.24059081077575684
generate_one_block  0.3677024841308594
generate_one_block  0.23410344123840332
generate_one_block  0.243119478225708
generate_one_block  0.2459883689880371
generate_one_block  0.255695104598999
generate_one_block  0.2580685615539551
generate_one_block  0.25177669525146484
generate_one_block  0.2456836700439453
generate_one_block  0.2635221481323242
generate_one_block  0.24963760375976562
generate_one_block  0.26198244094848633
generate_one_block  0.2420210838317871
generate_one_block  0.24836516380310059
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03795051574707031
gen group dst list time:  0.10907483100891113
time for parepare:  0.019562721252441406
local_output_nid generation:  0.02670884132385254
local_in_edges_tensor generation:  0.04578828811645508
mini_batch_src_global generation:  0.0403752326965332
r_  generation:  0.43273329734802246
local_output_nid generation:  0.030457496643066406
local_in_edges_tensor generation:  0.03449058532714844
mini_batch_src_global generation:  0.05491280555725098
r_  generation:  0.42172837257385254
local_output_nid generation:  0.03120732307434082
local_in_edges_tensor generation:  0.030354738235473633
mini_batch_src_global generation:  0.05124807357788086
r_  generation:  0.4385378360748291
local_output_nid generation:  0.031169652938842773
local_in_edges_tensor generation:  0.029149770736694336
mini_batch_src_global generation:  0.05518078804016113
r_  generation:  0.44788265228271484
local_output_nid generation:  0.03412461280822754
local_in_edges_tensor generation:  0.028350114822387695
mini_batch_src_global generation:  0.05173468589782715
r_  generation:  0.43332409858703613
local_output_nid generation:  0.03032231330871582
local_in_edges_tensor generation:  0.029735088348388672
mini_batch_src_global generation:  0.05178213119506836
r_  generation:  0.43810129165649414
local_output_nid generation:  0.029779672622680664
local_in_edges_tensor generation:  0.027379751205444336
mini_batch_src_global generation:  0.05068778991699219
r_  generation:  0.43726634979248047
local_output_nid generation:  0.030137300491333008
local_in_edges_tensor generation:  0.028224468231201172
mini_batch_src_global generation:  0.05123400688171387
r_  generation:  0.4337499141693115
local_output_nid generation:  0.030534982681274414
local_in_edges_tensor generation:  0.029773950576782227
mini_batch_src_global generation:  0.05129218101501465
r_  generation:  0.44222426414489746
local_output_nid generation:  0.030287742614746094
local_in_edges_tensor generation:  0.030181407928466797
mini_batch_src_global generation:  0.05171775817871094
r_  generation:  0.4331839084625244
local_output_nid generation:  0.029974699020385742
local_in_edges_tensor generation:  0.03259134292602539
mini_batch_src_global generation:  0.0509798526763916
r_  generation:  0.4364781379699707
local_output_nid generation:  0.03023505210876465
local_in_edges_tensor generation:  0.03229475021362305
mini_batch_src_global generation:  0.05151534080505371
r_  generation:  0.4415135383605957
local_output_nid generation:  0.03055572509765625
local_in_edges_tensor generation:  0.03110218048095703
mini_batch_src_global generation:  0.050841331481933594
r_  generation:  0.4344360828399658
local_output_nid generation:  0.030340909957885742
local_in_edges_tensor generation:  0.02680206298828125
mini_batch_src_global generation:  0.051612138748168945
r_  generation:  0.4387032985687256
local_output_nid generation:  0.03119635581970215
local_in_edges_tensor generation:  0.029761552810668945
mini_batch_src_global generation:  0.05067801475524902
r_  generation:  0.43999171257019043
local_output_nid generation:  0.030411243438720703
local_in_edges_tensor generation:  0.028153657913208008
mini_batch_src_global generation:  0.05296778678894043
r_  generation:  0.43961381912231445
local_output_nid generation:  0.03059864044189453
local_in_edges_tensor generation:  0.028649091720581055
mini_batch_src_global generation:  0.05115246772766113
r_  generation:  0.44336771965026855
local_output_nid generation:  0.030474424362182617
local_in_edges_tensor generation:  0.03253817558288574
mini_batch_src_global generation:  0.05139303207397461
r_  generation:  0.4320061206817627
local_output_nid generation:  0.030475139617919922
local_in_edges_tensor generation:  0.03312563896179199
mini_batch_src_global generation:  0.05247664451599121
r_  generation:  0.43517112731933594
local_output_nid generation:  0.030287504196166992
local_in_edges_tensor generation:  0.02649545669555664
mini_batch_src_global generation:  0.05311870574951172
r_  generation:  0.43302106857299805
local_output_nid generation:  0.030266284942626953
local_in_edges_tensor generation:  0.02629256248474121
mini_batch_src_global generation:  0.05166482925415039
r_  generation:  0.44417452812194824
local_output_nid generation:  0.030653715133666992
local_in_edges_tensor generation:  0.0284731388092041
mini_batch_src_global generation:  0.05268716812133789
r_  generation:  0.4421241283416748
local_output_nid generation:  0.03385329246520996
local_in_edges_tensor generation:  0.029680728912353516
mini_batch_src_global generation:  0.05200624465942383
r_  generation:  0.43454694747924805
local_output_nid generation:  0.030411958694458008
local_in_edges_tensor generation:  0.027797222137451172
mini_batch_src_global generation:  0.05155158042907715
r_  generation:  0.43216776847839355
local_output_nid generation:  0.03051471710205078
local_in_edges_tensor generation:  0.028841257095336914
mini_batch_src_global generation:  0.05065464973449707
r_  generation:  0.4364910125732422
local_output_nid generation:  0.030884981155395508
local_in_edges_tensor generation:  0.03249812126159668
mini_batch_src_global generation:  0.05362510681152344
r_  generation:  0.43674302101135254
local_output_nid generation:  0.030663251876831055
local_in_edges_tensor generation:  0.026888608932495117
mini_batch_src_global generation:  0.0505678653717041
r_  generation:  0.43545007705688477
local_output_nid generation:  0.03282809257507324
local_in_edges_tensor generation:  0.0301206111907959
mini_batch_src_global generation:  0.05220627784729004
r_  generation:  0.44777870178222656
local_output_nid generation:  0.03045797348022461
local_in_edges_tensor generation:  0.02893829345703125
mini_batch_src_global generation:  0.050818681716918945
r_  generation:  0.43555712699890137
local_output_nid generation:  0.0308074951171875
local_in_edges_tensor generation:  0.026801347732543945
mini_batch_src_global generation:  0.051868438720703125
r_  generation:  0.4410121440887451
local_output_nid generation:  0.03064870834350586
local_in_edges_tensor generation:  0.02741551399230957
mini_batch_src_global generation:  0.05069112777709961
r_  generation:  0.438246488571167
local_output_nid generation:  0.030630111694335938
local_in_edges_tensor generation:  0.026781320571899414
mini_batch_src_global generation:  0.05353093147277832
r_  generation:  0.4366004467010498
----------------------check_connections_block total spend ----------------------------- 20.765225172042847
generate_one_block  0.7095866203308105
generate_one_block  0.5838625431060791
generate_one_block  0.5878992080688477
generate_one_block  0.5883345603942871
generate_one_block  0.5795247554779053
generate_one_block  0.58998703956604
generate_one_block  0.5877368450164795
generate_one_block  0.5828099250793457
generate_one_block  0.5872771739959717
generate_one_block  0.5899982452392578
generate_one_block  0.5989916324615479
generate_one_block  0.5877015590667725
generate_one_block  0.581336498260498
generate_one_block  0.5884671211242676
generate_one_block  0.5887899398803711
generate_one_block  0.586409330368042
generate_one_block  0.5888476371765137
generate_one_block  0.5787770748138428
generate_one_block  0.5840256214141846
generate_one_block  0.5828781127929688
generate_one_block  0.5861554145812988
generate_one_block  0.5857460498809814
generate_one_block  0.5947098731994629
generate_one_block  0.582726240158081
generate_one_block  0.5878536701202393
generate_one_block  0.5948266983032227
generate_one_block  0.5792770385742188
generate_one_block  0.5976231098175049
generate_one_block  0.5808742046356201
generate_one_block  0.5920257568359375
generate_one_block  0.5825104713439941
generate_one_block  0.6069614887237549
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.1267871856689453  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

connection checking time:  29.691790342330933
block generation total time  27.102078437805176
average batch blocks generation time:  0.8469399511814117
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 0.1072545051574707  GigaBytes
Max Memory Allocated: 19.727712154388428  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 19.631625175476074  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5037841796875 GB
    Memory Allocated: 0.10666131973266602  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.9197998046875 GB
    Memory Allocated: 19.018839836120605  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4451904296875 GB
    Memory Allocated: 0.10687923431396484  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4451904296875 GB
    Memory Allocated: 19.085419178009033  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9686279296875 GB
    Memory Allocated: 0.1066579818725586  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9686279296875 GB
    Memory Allocated: 18.785531520843506  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9686279296875 GB
    Memory Allocated: 0.10633563995361328  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9686279296875 GB
    Memory Allocated: 18.759990215301514  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9686279296875 GB
    Memory Allocated: 0.1069488525390625  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9862060546875 GB
    Memory Allocated: 19.292388439178467  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9881591796875 GB
    Memory Allocated: 0.10632658004760742  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9881591796875 GB
    Memory Allocated: 18.87942934036255  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9881591796875 GB
    Memory Allocated: 0.10634613037109375  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9901123046875 GB
    Memory Allocated: 18.804144859313965  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9920654296875 GB
    Memory Allocated: 0.1068873405456543  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9920654296875 GB
    Memory Allocated: 19.184902667999268  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9920654296875 GB
    Memory Allocated: 0.10654687881469727  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9920654296875 GB
    Memory Allocated: 18.72994041442871  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9920654296875 GB
    Memory Allocated: 0.10675716400146484  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0428466796875 GB
    Memory Allocated: 19.118769645690918  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0447998046875 GB
    Memory Allocated: 0.1066293716430664  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0447998046875 GB
    Memory Allocated: 19.14971160888672  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0447998046875 GB
    Memory Allocated: 0.1062617301940918  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0447998046875 GB
    Memory Allocated: 18.726045608520508  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0447998046875 GB
    Memory Allocated: 0.10673856735229492  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0447998046875 GB
    Memory Allocated: 19.088815689086914  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0447998046875 GB
    Memory Allocated: 0.10656213760375977  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0447998046875 GB
    Memory Allocated: 18.967681884765625  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0447998046875 GB
    Memory Allocated: 0.10665035247802734  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0447998046875 GB
    Memory Allocated: 19.142992973327637  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10694646835327148  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 19.157958984375  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10630226135253906  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.16560125350952  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10660505294799805  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.615792274475098  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.1063528060913086  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.467827320098877  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10625505447387695  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.441158294677734  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10668182373046875  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.742021560668945  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10672426223754883  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.759360790252686  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10640096664428711  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 19.031169414520264  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10662126541137695  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.73991584777832  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10671520233154297  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 19.085947513580322  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10660123825073242  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.619598865509033  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10712051391601562  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 19.59870147705078  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10653400421142578  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.590229511260986  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10708141326904297  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 19.387025833129883  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10657978057861328  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.54542112350464  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10649776458740234  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.874401569366455  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03394681215286255 |0.018860965967178345 |0.5557534024119377 |9.50843095779419e-05 |1.0612150728702545 |0.00585627555847168 |
----------------------------------------------------------pseudo_mini_loss sum 1.8444329500198364
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  9118225
Number of first layer input nodes during this epoch:  4764184
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.12634515762329102  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03242158889770508
range selection method range initialization spend 0.016815662384033203
time for parepare:  0.022594213485717773
local_output_nid generation:  0.0013213157653808594
local_in_edges_tensor generation:  0.0068132877349853516
mini_batch_src_global generation:  0.0025730133056640625
r_  generation:  0.01169586181640625
local_output_nid generation:  0.0010805130004882812
local_in_edges_tensor generation:  0.0007550716400146484
mini_batch_src_global generation:  0.001729726791381836
r_  generation:  0.01119852066040039
local_output_nid generation:  0.0010733604431152344
local_in_edges_tensor generation:  0.0007083415985107422
mini_batch_src_global generation:  0.0013349056243896484
r_  generation:  0.010323762893676758
local_output_nid generation:  0.0010356903076171875
local_in_edges_tensor generation:  0.0006906986236572266
mini_batch_src_global generation:  0.001361846923828125
r_  generation:  0.01037144660949707
local_output_nid generation:  0.0010433197021484375
local_in_edges_tensor generation:  0.0006918907165527344
mini_batch_src_global generation:  0.0014424324035644531
r_  generation:  0.010450124740600586
local_output_nid generation:  0.001043081283569336
local_in_edges_tensor generation:  0.0006666183471679688
mini_batch_src_global generation:  0.0013954639434814453
r_  generation:  0.010450601577758789
local_output_nid generation:  0.0010328292846679688
local_in_edges_tensor generation:  0.0007321834564208984
mini_batch_src_global generation:  0.0013988018035888672
r_  generation:  0.011152267456054688
local_output_nid generation:  0.0010519027709960938
local_in_edges_tensor generation:  0.0006811618804931641
mini_batch_src_global generation:  0.0012700557708740234
r_  generation:  0.010106086730957031
local_output_nid generation:  0.0010724067687988281
local_in_edges_tensor generation:  0.0006656646728515625
mini_batch_src_global generation:  0.0013492107391357422
r_  generation:  0.010149478912353516
local_output_nid generation:  0.0010557174682617188
local_in_edges_tensor generation:  0.0006716251373291016
mini_batch_src_global generation:  0.0013003349304199219
r_  generation:  0.010663032531738281
local_output_nid generation:  0.0010683536529541016
local_in_edges_tensor generation:  0.0006773471832275391
mini_batch_src_global generation:  0.0013728141784667969
r_  generation:  0.010679244995117188
local_output_nid generation:  0.0010581016540527344
local_in_edges_tensor generation:  0.0006797313690185547
mini_batch_src_global generation:  0.0014431476593017578
r_  generation:  0.010520219802856445
local_output_nid generation:  0.00106048583984375
local_in_edges_tensor generation:  0.0006573200225830078
mini_batch_src_global generation:  0.0013148784637451172
r_  generation:  0.01069498062133789
local_output_nid generation:  0.0010876655578613281
local_in_edges_tensor generation:  0.0006608963012695312
mini_batch_src_global generation:  0.0013844966888427734
r_  generation:  0.01060795783996582
local_output_nid generation:  0.001087188720703125
local_in_edges_tensor generation:  0.0006723403930664062
mini_batch_src_global generation:  0.0013759136199951172
r_  generation:  0.010790824890136719
local_output_nid generation:  0.0010745525360107422
local_in_edges_tensor generation:  0.0006911754608154297
mini_batch_src_global generation:  0.0013763904571533203
r_  generation:  0.01092076301574707
local_output_nid generation:  0.0010967254638671875
local_in_edges_tensor generation:  0.0006678104400634766
mini_batch_src_global generation:  0.0014162063598632812
r_  generation:  0.010733842849731445
local_output_nid generation:  0.00106048583984375
local_in_edges_tensor generation:  0.0006647109985351562
mini_batch_src_global generation:  0.0014507770538330078
r_  generation:  0.01065206527709961
local_output_nid generation:  0.0010755062103271484
local_in_edges_tensor generation:  0.0006501674652099609
mini_batch_src_global generation:  0.0013725757598876953
r_  generation:  0.010500192642211914
local_output_nid generation:  0.0010609626770019531
local_in_edges_tensor generation:  0.0006792545318603516
mini_batch_src_global generation:  0.0014226436614990234
r_  generation:  0.010980606079101562
local_output_nid generation:  0.0010654926300048828
local_in_edges_tensor generation:  0.0007004737854003906
mini_batch_src_global generation:  0.001569986343383789
r_  generation:  0.011041402816772461
local_output_nid generation:  0.0010690689086914062
local_in_edges_tensor generation:  0.0006883144378662109
mini_batch_src_global generation:  0.0014140605926513672
r_  generation:  0.011245965957641602
local_output_nid generation:  0.001077890396118164
local_in_edges_tensor generation:  0.0006661415100097656
mini_batch_src_global generation:  0.001569986343383789
r_  generation:  0.010843992233276367
local_output_nid generation:  0.001070261001586914
local_in_edges_tensor generation:  0.0006706714630126953
mini_batch_src_global generation:  0.001367330551147461
r_  generation:  0.01080465316772461
local_output_nid generation:  0.0010890960693359375
local_in_edges_tensor generation:  0.0006694793701171875
mini_batch_src_global generation:  0.0014705657958984375
r_  generation:  0.011031389236450195
local_output_nid generation:  0.0010600090026855469
local_in_edges_tensor generation:  0.0006768703460693359
mini_batch_src_global generation:  0.0014691352844238281
r_  generation:  0.011215925216674805
local_output_nid generation:  0.0010530948638916016
local_in_edges_tensor generation:  0.0006482601165771484
mini_batch_src_global generation:  0.0015215873718261719
r_  generation:  0.010753393173217773
local_output_nid generation:  0.0010600090026855469
local_in_edges_tensor generation:  0.0006804466247558594
mini_batch_src_global generation:  0.0013988018035888672
r_  generation:  0.011019706726074219
local_output_nid generation:  0.0010547637939453125
local_in_edges_tensor generation:  0.0006556510925292969
mini_batch_src_global generation:  0.001462697982788086
r_  generation:  0.011093616485595703
local_output_nid generation:  0.0010690689086914062
local_in_edges_tensor generation:  0.0006747245788574219
mini_batch_src_global generation:  0.0015137195587158203
r_  generation:  0.010811805725097656
local_output_nid generation:  0.0011096000671386719
local_in_edges_tensor generation:  0.0006654262542724609
mini_batch_src_global generation:  0.0013735294342041016
r_  generation:  0.010640144348144531
local_output_nid generation:  0.0010633468627929688
local_in_edges_tensor generation:  0.0006623268127441406
mini_batch_src_global generation:  0.0013113021850585938
r_  generation:  0.010236024856567383
----------------------check_connections_block total spend ----------------------------- 0.5626537799835205
generate_one_block  0.036505937576293945
generate_one_block  0.02065300941467285
generate_one_block  0.019156932830810547
generate_one_block  0.01856398582458496
generate_one_block  0.019103527069091797
generate_one_block  0.018364429473876953
generate_one_block  0.019681930541992188
generate_one_block  0.017806053161621094
generate_one_block  0.020084142684936523
generate_one_block  0.01860523223876953
generate_one_block  0.0184481143951416
generate_one_block  0.01825118064880371
generate_one_block  0.018494844436645508
generate_one_block  0.018493175506591797
generate_one_block  0.02065253257751465
generate_one_block  0.018763303756713867
generate_one_block  0.018454790115356445
generate_one_block  0.01828742027282715
generate_one_block  0.018123388290405273
generate_one_block  0.02055191993713379
generate_one_block  0.01898026466369629
generate_one_block  0.0192105770111084
generate_one_block  0.021073341369628906
generate_one_block  0.01876664161682129
generate_one_block  0.019137859344482422
generate_one_block  0.02043008804321289
generate_one_block  0.01882314682006836
generate_one_block  0.018973588943481445
generate_one_block  0.018942594528198242
generate_one_block  0.018429279327392578
generate_one_block  0.020615816116333008
generate_one_block  0.017781734466552734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06121087074279785
gen group dst list time:  0.024889707565307617
time for parepare:  0.02197551727294922
local_output_nid generation:  0.005708456039428711
local_in_edges_tensor generation:  0.018505096435546875
mini_batch_src_global generation:  0.017503023147583008
r_  generation:  0.1627039909362793
local_output_nid generation:  0.007778167724609375
local_in_edges_tensor generation:  0.010686635971069336
mini_batch_src_global generation:  0.020569562911987305
r_  generation:  0.16356539726257324
local_output_nid generation:  0.008167743682861328
local_in_edges_tensor generation:  0.03383970260620117
mini_batch_src_global generation:  0.020839929580688477
r_  generation:  0.17323541641235352
local_output_nid generation:  0.008387565612792969
local_in_edges_tensor generation:  0.008783578872680664
mini_batch_src_global generation:  0.020461559295654297
r_  generation:  0.17237496376037598
local_output_nid generation:  0.008719921112060547
local_in_edges_tensor generation:  0.009269237518310547
mini_batch_src_global generation:  0.022161006927490234
r_  generation:  0.18035888671875
local_output_nid generation:  0.008486270904541016
local_in_edges_tensor generation:  0.008144855499267578
mini_batch_src_global generation:  0.021505355834960938
r_  generation:  0.1718294620513916
local_output_nid generation:  0.008584737777709961
local_in_edges_tensor generation:  0.00977325439453125
mini_batch_src_global generation:  0.024815082550048828
r_  generation:  0.1922013759613037
local_output_nid generation:  0.008094072341918945
local_in_edges_tensor generation:  0.009424448013305664
mini_batch_src_global generation:  0.022153377532958984
r_  generation:  0.17212843894958496
local_output_nid generation:  0.008142948150634766
local_in_edges_tensor generation:  0.008388042449951172
mini_batch_src_global generation:  0.022053956985473633
r_  generation:  0.17708134651184082
local_output_nid generation:  0.008563041687011719
local_in_edges_tensor generation:  0.009466409683227539
mini_batch_src_global generation:  0.023528575897216797
r_  generation:  0.1788957118988037
local_output_nid generation:  0.008647680282592773
local_in_edges_tensor generation:  0.009183645248413086
mini_batch_src_global generation:  0.022713661193847656
r_  generation:  0.18130874633789062
local_output_nid generation:  0.008710861206054688
local_in_edges_tensor generation:  0.008485794067382812
mini_batch_src_global generation:  0.022713184356689453
r_  generation:  0.17490768432617188
local_output_nid generation:  0.008898735046386719
local_in_edges_tensor generation:  0.009261131286621094
mini_batch_src_global generation:  0.023505687713623047
r_  generation:  0.1798567771911621
local_output_nid generation:  0.009062767028808594
local_in_edges_tensor generation:  0.009490013122558594
mini_batch_src_global generation:  0.02329564094543457
r_  generation:  0.18712568283081055
local_output_nid generation:  0.009063243865966797
local_in_edges_tensor generation:  0.009424448013305664
mini_batch_src_global generation:  0.022884845733642578
r_  generation:  0.18620896339416504
local_output_nid generation:  0.00909423828125
local_in_edges_tensor generation:  0.0098114013671875
mini_batch_src_global generation:  0.023824691772460938
r_  generation:  0.19075965881347656
local_output_nid generation:  0.008918285369873047
local_in_edges_tensor generation:  0.009467124938964844
mini_batch_src_global generation:  0.02293705940246582
r_  generation:  0.1838526725769043
local_output_nid generation:  0.008928775787353516
local_in_edges_tensor generation:  0.008649349212646484
mini_batch_src_global generation:  0.023189544677734375
r_  generation:  0.1793520450592041
local_output_nid generation:  0.008989095687866211
local_in_edges_tensor generation:  0.008636713027954102
mini_batch_src_global generation:  0.022396087646484375
r_  generation:  0.1814274787902832
local_output_nid generation:  0.009226322174072266
local_in_edges_tensor generation:  0.009811639785766602
mini_batch_src_global generation:  0.02437591552734375
r_  generation:  0.18756699562072754
local_output_nid generation:  0.009343385696411133
local_in_edges_tensor generation:  0.009227752685546875
mini_batch_src_global generation:  0.025300025939941406
r_  generation:  0.19064545631408691
local_output_nid generation:  0.009455204010009766
local_in_edges_tensor generation:  0.010616540908813477
mini_batch_src_global generation:  0.02479839324951172
r_  generation:  0.1961662769317627
local_output_nid generation:  0.00925302505493164
local_in_edges_tensor generation:  0.009691953659057617
mini_batch_src_global generation:  0.023553848266601562
r_  generation:  0.1883542537689209
local_output_nid generation:  0.00908517837524414
local_in_edges_tensor generation:  0.00894021987915039
mini_batch_src_global generation:  0.02518320083618164
r_  generation:  0.18148064613342285
local_output_nid generation:  0.009575128555297852
local_in_edges_tensor generation:  0.00980234146118164
mini_batch_src_global generation:  0.023612260818481445
r_  generation:  0.18958711624145508
local_output_nid generation:  0.00944066047668457
local_in_edges_tensor generation:  0.009422779083251953
mini_batch_src_global generation:  0.023740053176879883
r_  generation:  0.18687725067138672
local_output_nid generation:  0.009503364562988281
local_in_edges_tensor generation:  0.009902715682983398
mini_batch_src_global generation:  0.0242156982421875
r_  generation:  0.18971467018127441
local_output_nid generation:  0.009531259536743164
local_in_edges_tensor generation:  0.009690046310424805
mini_batch_src_global generation:  0.024013519287109375
r_  generation:  0.18840765953063965
local_output_nid generation:  0.009120464324951172
local_in_edges_tensor generation:  0.008999824523925781
mini_batch_src_global generation:  0.024271726608276367
r_  generation:  0.1907646656036377
local_output_nid generation:  0.009238958358764648
local_in_edges_tensor generation:  0.009671449661254883
mini_batch_src_global generation:  0.02315354347229004
r_  generation:  0.18121814727783203
local_output_nid generation:  0.009205341339111328
local_in_edges_tensor generation:  0.00879049301147461
mini_batch_src_global generation:  0.023140907287597656
r_  generation:  0.1817631721496582
local_output_nid generation:  0.00888967514038086
local_in_edges_tensor generation:  0.009006738662719727
mini_batch_src_global generation:  0.022130966186523438
r_  generation:  0.17632555961608887
----------------------check_connections_block total spend ----------------------------- 8.506750345230103
generate_one_block  0.25861239433288574
generate_one_block  0.24154376983642578
generate_one_block  0.25072693824768066
generate_one_block  0.2448873519897461
generate_one_block  0.27974462509155273
generate_one_block  0.24329543113708496
generate_one_block  0.26859498023986816
generate_one_block  0.23787140846252441
generate_one_block  0.2390916347503662
generate_one_block  0.25081396102905273
generate_one_block  0.24749755859375
generate_one_block  0.2414703369140625
generate_one_block  0.24472594261169434
generate_one_block  0.2505815029144287
generate_one_block  0.24743199348449707
generate_one_block  0.25340723991394043
generate_one_block  0.24363160133361816
generate_one_block  0.23844218254089355
generate_one_block  0.24307560920715332
generate_one_block  0.2616105079650879
generate_one_block  0.2547452449798584
generate_one_block  0.265411376953125
generate_one_block  0.2542135715484619
generate_one_block  0.2446589469909668
generate_one_block  0.26795172691345215
generate_one_block  0.25607943534851074
generate_one_block  0.2554600238800049
generate_one_block  0.25764989852905273
generate_one_block  0.25814342498779297
generate_one_block  0.2473289966583252
generate_one_block  0.24252629280090332
generate_one_block  0.2353801727294922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033914804458618164
gen group dst list time:  0.1110694408416748
time for parepare:  0.020307540893554688
local_output_nid generation:  0.025489091873168945
local_in_edges_tensor generation:  0.0430300235748291
mini_batch_src_global generation:  0.03950667381286621
r_  generation:  0.42673492431640625
local_output_nid generation:  0.030365467071533203
local_in_edges_tensor generation:  0.033922433853149414
mini_batch_src_global generation:  0.05092453956604004
r_  generation:  0.4185965061187744
local_output_nid generation:  0.030796051025390625
local_in_edges_tensor generation:  0.0322566032409668
mini_batch_src_global generation:  0.05116724967956543
r_  generation:  0.4345970153808594
local_output_nid generation:  0.031225204467773438
local_in_edges_tensor generation:  0.029980182647705078
mini_batch_src_global generation:  0.050293684005737305
r_  generation:  0.42812132835388184
local_output_nid generation:  0.031179189682006836
local_in_edges_tensor generation:  0.03333568572998047
mini_batch_src_global generation:  0.0508270263671875
r_  generation:  0.43880772590637207
local_output_nid generation:  0.03067636489868164
local_in_edges_tensor generation:  0.027128219604492188
mini_batch_src_global generation:  0.051336050033569336
r_  generation:  0.43393969535827637
local_output_nid generation:  0.02918863296508789
local_in_edges_tensor generation:  0.028766632080078125
mini_batch_src_global generation:  0.05272173881530762
r_  generation:  0.44005846977233887
local_output_nid generation:  0.029947757720947266
local_in_edges_tensor generation:  0.029071807861328125
mini_batch_src_global generation:  0.051993370056152344
r_  generation:  0.4290611743927002
local_output_nid generation:  0.031114816665649414
local_in_edges_tensor generation:  0.026791095733642578
mini_batch_src_global generation:  0.0502619743347168
r_  generation:  0.4334752559661865
local_output_nid generation:  0.029863834381103516
local_in_edges_tensor generation:  0.027898788452148438
mini_batch_src_global generation:  0.05141139030456543
r_  generation:  0.43913722038269043
local_output_nid generation:  0.02932429313659668
local_in_edges_tensor generation:  0.02856135368347168
mini_batch_src_global generation:  0.05075836181640625
r_  generation:  0.4352846145629883
local_output_nid generation:  0.029277563095092773
local_in_edges_tensor generation:  0.030996322631835938
mini_batch_src_global generation:  0.05201983451843262
r_  generation:  0.4397273063659668
local_output_nid generation:  0.029463529586791992
local_in_edges_tensor generation:  0.028132200241088867
mini_batch_src_global generation:  0.05252480506896973
r_  generation:  0.4488790035247803
local_output_nid generation:  0.032746315002441406
local_in_edges_tensor generation:  0.030927181243896484
mini_batch_src_global generation:  0.05296134948730469
r_  generation:  0.4371674060821533
local_output_nid generation:  0.030474424362182617
local_in_edges_tensor generation:  0.028310775756835938
mini_batch_src_global generation:  0.05252981185913086
r_  generation:  0.435894250869751
local_output_nid generation:  0.030457735061645508
local_in_edges_tensor generation:  0.02736210823059082
mini_batch_src_global generation:  0.05157065391540527
r_  generation:  0.432861328125
local_output_nid generation:  0.030306577682495117
local_in_edges_tensor generation:  0.030235767364501953
mini_batch_src_global generation:  0.050542354583740234
r_  generation:  0.4443998336791992
local_output_nid generation:  0.029957056045532227
local_in_edges_tensor generation:  0.027817964553833008
mini_batch_src_global generation:  0.051476478576660156
r_  generation:  0.43180418014526367
local_output_nid generation:  0.029929637908935547
local_in_edges_tensor generation:  0.0281980037689209
mini_batch_src_global generation:  0.050865888595581055
r_  generation:  0.43578577041625977
local_output_nid generation:  0.030641555786132812
local_in_edges_tensor generation:  0.028818845748901367
mini_batch_src_global generation:  0.05352163314819336
r_  generation:  0.44672107696533203
local_output_nid generation:  0.030324935913085938
local_in_edges_tensor generation:  0.02820611000061035
mini_batch_src_global generation:  0.05085492134094238
r_  generation:  0.43852877616882324
local_output_nid generation:  0.030617713928222656
local_in_edges_tensor generation:  0.029522418975830078
mini_batch_src_global generation:  0.05173182487487793
r_  generation:  0.43970584869384766
local_output_nid generation:  0.030271530151367188
local_in_edges_tensor generation:  0.03050827980041504
mini_batch_src_global generation:  0.05023193359375
r_  generation:  0.4370262622833252
local_output_nid generation:  0.030279874801635742
local_in_edges_tensor generation:  0.02869892120361328
mini_batch_src_global generation:  0.05190014839172363
r_  generation:  0.4339902400970459
local_output_nid generation:  0.03093123435974121
local_in_edges_tensor generation:  0.028479337692260742
mini_batch_src_global generation:  0.052644968032836914
r_  generation:  0.4424717426300049
local_output_nid generation:  0.030684232711791992
local_in_edges_tensor generation:  0.035108327865600586
mini_batch_src_global generation:  0.0584871768951416
r_  generation:  0.44267725944519043
local_output_nid generation:  0.030960559844970703
local_in_edges_tensor generation:  0.02735161781311035
mini_batch_src_global generation:  0.050901174545288086
r_  generation:  0.44173431396484375
local_output_nid generation:  0.030699491500854492
local_in_edges_tensor generation:  0.031980037689208984
mini_batch_src_global generation:  0.05448126792907715
r_  generation:  0.43901968002319336
local_output_nid generation:  0.032475948333740234
local_in_edges_tensor generation:  0.03183770179748535
mini_batch_src_global generation:  0.0526583194732666
r_  generation:  0.4383096694946289
local_output_nid generation:  0.030717134475708008
local_in_edges_tensor generation:  0.030117273330688477
mini_batch_src_global generation:  0.051668643951416016
r_  generation:  0.437283992767334
local_output_nid generation:  0.030271291732788086
local_in_edges_tensor generation:  0.029233694076538086
mini_batch_src_global generation:  0.05063009262084961
r_  generation:  0.43489909172058105
local_output_nid generation:  0.030186176300048828
local_in_edges_tensor generation:  0.02771162986755371
mini_batch_src_global generation:  0.05156970024108887
r_  generation:  0.4355762004852295
----------------------check_connections_block total spend ----------------------------- 20.71116042137146
generate_one_block  0.5999467372894287
generate_one_block  0.5811874866485596
generate_one_block  0.5937492847442627
generate_one_block  0.586432933807373
generate_one_block  0.6984140872955322
generate_one_block  0.5760080814361572
generate_one_block  0.5875322818756104
generate_one_block  0.5789673328399658
generate_one_block  0.5824825763702393
generate_one_block  0.5877964496612549
generate_one_block  0.5878825187683105
generate_one_block  0.5785555839538574
generate_one_block  0.5808389186859131
generate_one_block  0.5967319011688232
generate_one_block  0.5920636653900146
generate_one_block  0.5935018062591553
generate_one_block  0.5830698013305664
generate_one_block  0.5783474445343018
generate_one_block  0.5802571773529053
generate_one_block  0.5924253463745117
generate_one_block  0.5823071002960205
generate_one_block  0.5968785285949707
generate_one_block  0.5897955894470215
generate_one_block  0.5807955265045166
generate_one_block  0.6083078384399414
generate_one_block  0.5874042510986328
generate_one_block  0.6012759208679199
generate_one_block  0.5873475074768066
generate_one_block  0.5890188217163086
generate_one_block  0.5930812358856201
generate_one_block  0.5779321193695068
generate_one_block  0.5812027454376221
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.12634515762329102  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

connection checking time:  29.217910766601562
block generation total time  26.93814468383789
average batch blocks generation time:  0.8418170213699341
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10664606094360352  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.932215213775635  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10642623901367188  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.525352478027344  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10665750503540039  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 19.013628482818604  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.10643482208251953  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 18.605817317962646  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 0.1069631576538086  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5740966796875 GB
    Memory Allocated: 19.139955520629883  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5760498046875 GB
    Memory Allocated: 0.10602712631225586  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5760498046875 GB
    Memory Allocated: 18.40835952758789  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5760498046875 GB
    Memory Allocated: 0.10696792602539062  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6326904296875 GB
    Memory Allocated: 19.61625099182129  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.9373779296875 GB
    Memory Allocated: 0.10615921020507812  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 18.26198673248291  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1307373046875 GB
    Memory Allocated: 0.10622262954711914  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1307373046875 GB
    Memory Allocated: 18.471993923187256  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1307373046875 GB
    Memory Allocated: 0.10668802261352539  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3338623046875 GB
    Memory Allocated: 18.92800807952881  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3377685546875 GB
    Memory Allocated: 0.10617208480834961  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3377685546875 GB
    Memory Allocated: 18.77901840209961  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3377685546875 GB
    Memory Allocated: 0.10606241226196289  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3377685546875 GB
    Memory Allocated: 18.489700317382812  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3377685546875 GB
    Memory Allocated: 0.10635566711425781  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3377685546875 GB
    Memory Allocated: 18.660137176513672  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3377685546875 GB
    Memory Allocated: 0.10666036605834961  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3377685546875 GB
    Memory Allocated: 18.924964904785156  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 0.10670900344848633  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 18.80823802947998  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 0.10683393478393555  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 19.174787521362305  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 0.10673141479492188  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 18.777295112609863  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 0.10635948181152344  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 18.482687950134277  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 0.10643291473388672  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 18.681681156158447  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 0.10675430297851562  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 19.18058443069458  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 0.10657358169555664  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 19.165430068969727  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 0.1070103645324707  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9471435546875 GB
    Memory Allocated: 19.576714515686035  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10659408569335938  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.997836112976074  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1065225601196289  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.66644287109375  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10681486129760742  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.279959201812744  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10680150985717773  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.15907049179077  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10696744918823242  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.33701181411743  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10688257217407227  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.253875255584717  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1066904067993164  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.256672382354736  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10677194595336914  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.885334968566895  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10624933242797852  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.52388286590576  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1061868667602539  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.381699562072754  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03361520916223526 |0.019835151731967926 |0.5564726814627647 |9.65222716331482e-05 |1.0610375255346298 |0.010174274444580078 |
----------------------------------------------------------pseudo_mini_loss sum 1.7683660984039307
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  9110328
Number of first layer input nodes during this epoch:  4760601
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12586545944213867  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023380756378173828
range selection method range initialization spend 0.013684988021850586
time for parepare:  0.018207788467407227
local_output_nid generation:  0.0009617805480957031
local_in_edges_tensor generation:  0.006136417388916016
mini_batch_src_global generation:  0.002982616424560547
r_  generation:  0.014625787734985352
local_output_nid generation:  0.001337289810180664
local_in_edges_tensor generation:  0.0008227825164794922
mini_batch_src_global generation:  0.001979827880859375
r_  generation:  0.011490583419799805
local_output_nid generation:  0.0011572837829589844
local_in_edges_tensor generation:  0.0007190704345703125
mini_batch_src_global generation:  0.0013494491577148438
r_  generation:  0.010644197463989258
local_output_nid generation:  0.0011491775512695312
local_in_edges_tensor generation:  0.00069427490234375
mini_batch_src_global generation:  0.0013012886047363281
r_  generation:  0.010079383850097656
local_output_nid generation:  0.0011212825775146484
local_in_edges_tensor generation:  0.0006916522979736328
mini_batch_src_global generation:  0.0013442039489746094
r_  generation:  0.010471582412719727
local_output_nid generation:  0.0011296272277832031
local_in_edges_tensor generation:  0.0006539821624755859
mini_batch_src_global generation:  0.0014269351959228516
r_  generation:  0.010442256927490234
local_output_nid generation:  0.0011327266693115234
local_in_edges_tensor generation:  0.000640869140625
mini_batch_src_global generation:  0.0013356208801269531
r_  generation:  0.01061868667602539
local_output_nid generation:  0.0011522769927978516
local_in_edges_tensor generation:  0.0006852149963378906
mini_batch_src_global generation:  0.001481771469116211
r_  generation:  0.01063990592956543
local_output_nid generation:  0.0010821819305419922
local_in_edges_tensor generation:  0.0006380081176757812
mini_batch_src_global generation:  0.0012998580932617188
r_  generation:  0.010419607162475586
local_output_nid generation:  0.002348184585571289
local_in_edges_tensor generation:  0.0013439655303955078
mini_batch_src_global generation:  0.00334930419921875
r_  generation:  0.018545150756835938
local_output_nid generation:  0.0010924339294433594
local_in_edges_tensor generation:  0.0006353855133056641
mini_batch_src_global generation:  0.0014050006866455078
r_  generation:  0.01082158088684082
local_output_nid generation:  0.0009791851043701172
local_in_edges_tensor generation:  0.0005900859832763672
mini_batch_src_global generation:  0.0012545585632324219
r_  generation:  0.010109186172485352
local_output_nid generation:  0.0009377002716064453
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0012171268463134766
r_  generation:  0.010164260864257812
local_output_nid generation:  0.0009121894836425781
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.0011756420135498047
r_  generation:  0.01032567024230957
local_output_nid generation:  0.0009107589721679688
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0011715888977050781
r_  generation:  0.010317802429199219
local_output_nid generation:  0.0008819103240966797
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.001186370849609375
r_  generation:  0.010030508041381836
local_output_nid generation:  0.0008838176727294922
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.0011610984802246094
r_  generation:  0.01025533676147461
local_output_nid generation:  0.0008838176727294922
local_in_edges_tensor generation:  0.0005662441253662109
mini_batch_src_global generation:  0.0011737346649169922
r_  generation:  0.010547399520874023
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0006127357482910156
mini_batch_src_global generation:  0.0013751983642578125
r_  generation:  0.010634899139404297
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.000579833984375
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.010528087615966797
local_output_nid generation:  0.0008699893951416016
local_in_edges_tensor generation:  0.0005784034729003906
mini_batch_src_global generation:  0.001211404800415039
r_  generation:  0.011923551559448242
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.0014405250549316406
r_  generation:  0.010550498962402344
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0005645751953125
mini_batch_src_global generation:  0.0011708736419677734
r_  generation:  0.010168075561523438
local_output_nid generation:  0.0008676052093505859
local_in_edges_tensor generation:  0.0005643367767333984
mini_batch_src_global generation:  0.0011944770812988281
r_  generation:  0.010159015655517578
local_output_nid generation:  0.0008578300476074219
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.001142263412475586
r_  generation:  0.010300159454345703
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.0011913776397705078
r_  generation:  0.010550260543823242
local_output_nid generation:  0.0008566379547119141
local_in_edges_tensor generation:  0.000545501708984375
mini_batch_src_global generation:  0.0011703968048095703
r_  generation:  0.010302543640136719
local_output_nid generation:  0.0008516311645507812
local_in_edges_tensor generation:  0.0006022453308105469
mini_batch_src_global generation:  0.0012199878692626953
r_  generation:  0.011928319931030273
local_output_nid generation:  0.0008554458618164062
local_in_edges_tensor generation:  0.0005381107330322266
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.010580778121948242
local_output_nid generation:  0.0008463859558105469
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.0011358261108398438
r_  generation:  0.010061264038085938
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005404949188232422
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.01044917106628418
local_output_nid generation:  0.0008528232574462891
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.010039806365966797
----------------------check_connections_block total spend ----------------------------- 0.5584406852722168
generate_one_block  0.027976274490356445
generate_one_block  0.02295827865600586
generate_one_block  0.019578218460083008
generate_one_block  0.018498897552490234
generate_one_block  0.01853013038635254
generate_one_block  0.0185697078704834
generate_one_block  0.019855022430419922
generate_one_block  0.018721342086791992
generate_one_block  0.018529653549194336
generate_one_block  0.0182647705078125
generate_one_block  0.018520832061767578
generate_one_block  0.018172502517700195
generate_one_block  0.019460201263427734
generate_one_block  0.018604278564453125
generate_one_block  0.018273115158081055
generate_one_block  0.018007755279541016
generate_one_block  0.01834249496459961
generate_one_block  0.019008636474609375
generate_one_block  0.02039957046508789
generate_one_block  0.0189056396484375
generate_one_block  0.018387556076049805
generate_one_block  0.018476247787475586
generate_one_block  0.02059006690979004
generate_one_block  0.01978588104248047
generate_one_block  0.018578529357910156
generate_one_block  0.018991947174072266
generate_one_block  0.018619298934936523
generate_one_block  0.0184628963470459
generate_one_block  0.01841449737548828
generate_one_block  0.01939105987548828
generate_one_block  0.01859283447265625
generate_one_block  0.017974853515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038004398345947266
gen group dst list time:  0.024338245391845703
time for parepare:  0.022130727767944336
local_output_nid generation:  0.0055255889892578125
local_in_edges_tensor generation:  0.016050100326538086
mini_batch_src_global generation:  0.017844200134277344
r_  generation:  0.16138172149658203
local_output_nid generation:  0.007729530334472656
local_in_edges_tensor generation:  0.01332855224609375
mini_batch_src_global generation:  0.023146629333496094
r_  generation:  0.2000267505645752
local_output_nid generation:  0.00820302963256836
local_in_edges_tensor generation:  0.034435272216796875
mini_batch_src_global generation:  0.022197484970092773
r_  generation:  0.21560049057006836
local_output_nid generation:  0.011412620544433594
local_in_edges_tensor generation:  0.010131120681762695
mini_batch_src_global generation:  0.02405261993408203
r_  generation:  0.18463897705078125
local_output_nid generation:  0.008537054061889648
local_in_edges_tensor generation:  0.011607646942138672
mini_batch_src_global generation:  0.02540755271911621
r_  generation:  0.18590569496154785
local_output_nid generation:  0.009659290313720703
local_in_edges_tensor generation:  0.009263753890991211
mini_batch_src_global generation:  0.022214412689208984
r_  generation:  0.18105244636535645
local_output_nid generation:  0.008483171463012695
local_in_edges_tensor generation:  0.01204061508178711
mini_batch_src_global generation:  0.022733688354492188
r_  generation:  0.1802680492401123
local_output_nid generation:  0.00865030288696289
local_in_edges_tensor generation:  0.009004831314086914
mini_batch_src_global generation:  0.02385711669921875
r_  generation:  0.18253493309020996
local_output_nid generation:  0.00865626335144043
local_in_edges_tensor generation:  0.008731603622436523
mini_batch_src_global generation:  0.023219823837280273
r_  generation:  0.1793806552886963
local_output_nid generation:  0.008882522583007812
local_in_edges_tensor generation:  0.010361909866333008
mini_batch_src_global generation:  0.0227813720703125
r_  generation:  0.1761796474456787
local_output_nid generation:  0.0089263916015625
local_in_edges_tensor generation:  0.008948802947998047
mini_batch_src_global generation:  0.023431062698364258
r_  generation:  0.18258261680603027
local_output_nid generation:  0.00900578498840332
local_in_edges_tensor generation:  0.008666276931762695
mini_batch_src_global generation:  0.02314448356628418
r_  generation:  0.17631816864013672
local_output_nid generation:  0.009047508239746094
local_in_edges_tensor generation:  0.009327173233032227
mini_batch_src_global generation:  0.023845434188842773
r_  generation:  0.17930173873901367
local_output_nid generation:  0.009221076965332031
local_in_edges_tensor generation:  0.010276079177856445
mini_batch_src_global generation:  0.023513317108154297
r_  generation:  0.18415331840515137
local_output_nid generation:  0.009047985076904297
local_in_edges_tensor generation:  0.00873422622680664
mini_batch_src_global generation:  0.025844335556030273
r_  generation:  0.1912071704864502
local_output_nid generation:  0.013349056243896484
local_in_edges_tensor generation:  0.009731292724609375
mini_batch_src_global generation:  0.02307295799255371
r_  generation:  0.17527246475219727
local_output_nid generation:  0.009303569793701172
local_in_edges_tensor generation:  0.008607625961303711
mini_batch_src_global generation:  0.023885488510131836
r_  generation:  0.17927837371826172
local_output_nid generation:  0.009813308715820312
local_in_edges_tensor generation:  0.00967097282409668
mini_batch_src_global generation:  0.024143218994140625
r_  generation:  0.1848292350769043
local_output_nid generation:  0.009752750396728516
local_in_edges_tensor generation:  0.009841442108154297
mini_batch_src_global generation:  0.02419734001159668
r_  generation:  0.18954801559448242
local_output_nid generation:  0.00959324836730957
local_in_edges_tensor generation:  0.009727716445922852
mini_batch_src_global generation:  0.024358034133911133
r_  generation:  0.1870875358581543
local_output_nid generation:  0.009510993957519531
local_in_edges_tensor generation:  0.009520530700683594
mini_batch_src_global generation:  0.02366495132446289
r_  generation:  0.18284392356872559
local_output_nid generation:  0.009573936462402344
local_in_edges_tensor generation:  0.00981760025024414
mini_batch_src_global generation:  0.02387857437133789
r_  generation:  0.18613529205322266
local_output_nid generation:  0.009491205215454102
local_in_edges_tensor generation:  0.009412527084350586
mini_batch_src_global generation:  0.02327275276184082
r_  generation:  0.1861734390258789
local_output_nid generation:  0.009344100952148438
local_in_edges_tensor generation:  0.009267568588256836
mini_batch_src_global generation:  0.022971391677856445
r_  generation:  0.1764998435974121
local_output_nid generation:  0.012527942657470703
local_in_edges_tensor generation:  0.008947134017944336
mini_batch_src_global generation:  0.023261308670043945
r_  generation:  0.18767333030700684
local_output_nid generation:  0.00974416732788086
local_in_edges_tensor generation:  0.012122392654418945
mini_batch_src_global generation:  0.0246279239654541
r_  generation:  0.1894073486328125
local_output_nid generation:  0.009476661682128906
local_in_edges_tensor generation:  0.009636163711547852
mini_batch_src_global generation:  0.02397298812866211
r_  generation:  0.18494248390197754
local_output_nid generation:  0.011133432388305664
local_in_edges_tensor generation:  0.010024070739746094
mini_batch_src_global generation:  0.02364325523376465
r_  generation:  0.18782615661621094
local_output_nid generation:  0.009544849395751953
local_in_edges_tensor generation:  0.009629249572753906
mini_batch_src_global generation:  0.024377822875976562
r_  generation:  0.18722081184387207
local_output_nid generation:  0.009283065795898438
local_in_edges_tensor generation:  0.008583784103393555
mini_batch_src_global generation:  0.022801876068115234
r_  generation:  0.17867231369018555
local_output_nid generation:  0.009481191635131836
local_in_edges_tensor generation:  0.010365009307861328
mini_batch_src_global generation:  0.024692535400390625
r_  generation:  0.18607211112976074
local_output_nid generation:  0.009370803833007812
local_in_edges_tensor generation:  0.008818626403808594
mini_batch_src_global generation:  0.02278280258178711
r_  generation:  0.17650079727172852
----------------------check_connections_block total spend ----------------------------- 8.666984796524048
generate_one_block  0.2548525333404541
generate_one_block  0.2494063377380371
generate_one_block  0.252469539642334
generate_one_block  0.25090980529785156
generate_one_block  0.25908923149108887
generate_one_block  0.25092339515686035
generate_one_block  0.24645018577575684
generate_one_block  0.2583048343658447
generate_one_block  0.24656248092651367
generate_one_block  0.2449193000793457
generate_one_block  0.25275707244873047
generate_one_block  0.24275994300842285
generate_one_block  0.24652695655822754
generate_one_block  0.25725698471069336
generate_one_block  0.2434215545654297
generate_one_block  0.23954463005065918
generate_one_block  0.24041748046875
generate_one_block  0.2570009231567383
generate_one_block  0.25516581535339355
generate_one_block  0.26552653312683105
generate_one_block  0.24786782264709473
generate_one_block  0.24929141998291016
generate_one_block  0.24933481216430664
generate_one_block  0.2415304183959961
generate_one_block  0.24914860725402832
generate_one_block  0.25610828399658203
generate_one_block  0.24990630149841309
generate_one_block  0.2494525909423828
generate_one_block  0.24977803230285645
generate_one_block  0.24492311477661133
generate_one_block  0.2597794532775879
generate_one_block  0.23742938041687012
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03474259376525879
gen group dst list time:  0.11442089080810547
time for parepare:  0.01978135108947754
local_output_nid generation:  0.024746179580688477
local_in_edges_tensor generation:  0.046015024185180664
mini_batch_src_global generation:  0.04026365280151367
r_  generation:  0.4215080738067627
local_output_nid generation:  0.030316829681396484
local_in_edges_tensor generation:  0.03390908241271973
mini_batch_src_global generation:  0.0523374080657959
r_  generation:  0.4228334426879883
local_output_nid generation:  0.030855178833007812
local_in_edges_tensor generation:  0.031943559646606445
mini_batch_src_global generation:  0.04918694496154785
r_  generation:  0.43700218200683594
local_output_nid generation:  0.03343367576599121
local_in_edges_tensor generation:  0.026791810989379883
mini_batch_src_global generation:  0.05073881149291992
r_  generation:  0.43020009994506836
local_output_nid generation:  0.03043675422668457
local_in_edges_tensor generation:  0.028162717819213867
mini_batch_src_global generation:  0.05025792121887207
r_  generation:  0.43665122985839844
local_output_nid generation:  0.0317990779876709
local_in_edges_tensor generation:  0.0304107666015625
mini_batch_src_global generation:  0.051412105560302734
r_  generation:  0.4368915557861328
local_output_nid generation:  0.029709577560424805
local_in_edges_tensor generation:  0.028214454650878906
mini_batch_src_global generation:  0.051345109939575195
r_  generation:  0.43771934509277344
local_output_nid generation:  0.028998136520385742
local_in_edges_tensor generation:  0.028649091720581055
mini_batch_src_global generation:  0.052190303802490234
r_  generation:  0.4448404312133789
local_output_nid generation:  0.029105663299560547
local_in_edges_tensor generation:  0.03216886520385742
mini_batch_src_global generation:  0.051596879959106445
r_  generation:  0.4388284683227539
local_output_nid generation:  0.029253721237182617
local_in_edges_tensor generation:  0.028273582458496094
mini_batch_src_global generation:  0.051647186279296875
r_  generation:  0.43607020378112793
local_output_nid generation:  0.029812097549438477
local_in_edges_tensor generation:  0.03053140640258789
mini_batch_src_global generation:  0.05161333084106445
r_  generation:  0.4397895336151123
local_output_nid generation:  0.029375791549682617
local_in_edges_tensor generation:  0.03032851219177246
mini_batch_src_global generation:  0.05175900459289551
r_  generation:  0.4374117851257324
local_output_nid generation:  0.02946758270263672
local_in_edges_tensor generation:  0.030874252319335938
mini_batch_src_global generation:  0.0514063835144043
r_  generation:  0.4513227939605713
local_output_nid generation:  0.03237605094909668
local_in_edges_tensor generation:  0.03052544593811035
mini_batch_src_global generation:  0.05449628829956055
r_  generation:  0.44007325172424316
local_output_nid generation:  0.03011012077331543
local_in_edges_tensor generation:  0.029122114181518555
mini_batch_src_global generation:  0.05078935623168945
r_  generation:  0.43238139152526855
local_output_nid generation:  0.030132055282592773
local_in_edges_tensor generation:  0.028980731964111328
mini_batch_src_global generation:  0.05193281173706055
r_  generation:  0.43425583839416504
local_output_nid generation:  0.03016519546508789
local_in_edges_tensor generation:  0.028870105743408203
mini_batch_src_global generation:  0.05205535888671875
r_  generation:  0.4352107048034668
local_output_nid generation:  0.03026294708251953
local_in_edges_tensor generation:  0.028228282928466797
mini_batch_src_global generation:  0.051938772201538086
r_  generation:  0.43597960472106934
local_output_nid generation:  0.030488967895507812
local_in_edges_tensor generation:  0.03314638137817383
mini_batch_src_global generation:  0.0511164665222168
r_  generation:  0.43790125846862793
local_output_nid generation:  0.030349254608154297
local_in_edges_tensor generation:  0.028515338897705078
mini_batch_src_global generation:  0.05281496047973633
r_  generation:  0.4429337978363037
local_output_nid generation:  0.03017711639404297
local_in_edges_tensor generation:  0.02865457534790039
mini_batch_src_global generation:  0.05067753791809082
r_  generation:  0.4387087821960449
local_output_nid generation:  0.03043055534362793
local_in_edges_tensor generation:  0.026582717895507812
mini_batch_src_global generation:  0.05218839645385742
r_  generation:  0.4550597667694092
local_output_nid generation:  0.030245065689086914
local_in_edges_tensor generation:  0.030905961990356445
mini_batch_src_global generation:  0.05144953727722168
r_  generation:  0.43558812141418457
local_output_nid generation:  0.03315019607543945
local_in_edges_tensor generation:  0.026885032653808594
mini_batch_src_global generation:  0.051737070083618164
r_  generation:  0.44269776344299316
local_output_nid generation:  0.030242443084716797
local_in_edges_tensor generation:  0.028290987014770508
mini_batch_src_global generation:  0.051499128341674805
r_  generation:  0.43782997131347656
local_output_nid generation:  0.030553102493286133
local_in_edges_tensor generation:  0.029607534408569336
mini_batch_src_global generation:  0.05161094665527344
r_  generation:  0.4399704933166504
local_output_nid generation:  0.030434131622314453
local_in_edges_tensor generation:  0.029831886291503906
mini_batch_src_global generation:  0.05285358428955078
r_  generation:  0.43908214569091797
local_output_nid generation:  0.03023505210876465
local_in_edges_tensor generation:  0.02941131591796875
mini_batch_src_global generation:  0.05240607261657715
r_  generation:  0.4339311122894287
local_output_nid generation:  0.03117990493774414
local_in_edges_tensor generation:  0.031167984008789062
mini_batch_src_global generation:  0.05117630958557129
r_  generation:  0.4332873821258545
local_output_nid generation:  0.030216217041015625
local_in_edges_tensor generation:  0.027985095977783203
mini_batch_src_global generation:  0.05394411087036133
r_  generation:  0.43077898025512695
local_output_nid generation:  0.030327320098876953
local_in_edges_tensor generation:  0.026462554931640625
mini_batch_src_global generation:  0.05141401290893555
r_  generation:  0.4387481212615967
local_output_nid generation:  0.030097246170043945
local_in_edges_tensor generation:  0.027603864669799805
mini_batch_src_global generation:  0.051741600036621094
r_  generation:  0.4361443519592285
----------------------check_connections_block total spend ----------------------------- 20.74457573890686
generate_one_block  0.5997068881988525
generate_one_block  0.5906505584716797
generate_one_block  0.5870330333709717
generate_one_block  0.5937237739562988
generate_one_block  0.6856253147125244
generate_one_block  0.5910201072692871
generate_one_block  0.5907561779022217
generate_one_block  0.5841019153594971
generate_one_block  0.585641622543335
generate_one_block  0.578139066696167
generate_one_block  0.5909512042999268
generate_one_block  0.5815491676330566
generate_one_block  0.5909121036529541
generate_one_block  0.591552734375
generate_one_block  0.581932544708252
generate_one_block  0.5887043476104736
generate_one_block  0.5879075527191162
generate_one_block  0.5983402729034424
generate_one_block  0.5972328186035156
generate_one_block  0.5847067832946777
generate_one_block  0.58461594581604
generate_one_block  0.5880889892578125
generate_one_block  0.5812692642211914
generate_one_block  0.5854682922363281
generate_one_block  0.6098160743713379
generate_one_block  0.5933401584625244
generate_one_block  0.5909912586212158
generate_one_block  0.5882527828216553
generate_one_block  0.57767653465271
generate_one_block  0.5905709266662598
generate_one_block  0.5911269187927246
generate_one_block  0.5811049938201904
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12586545944213867  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

connection checking time:  29.411560535430908
block generation total time  26.941325902938843
average batch blocks generation time:  0.8419164344668388
block dataloader generation time/epoch 59.73320174217224
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10625982284545898  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.587443828582764  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10655784606933594  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.058023929595947  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10672569274902344  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.161120414733887  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10668373107910156  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.079366207122803  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10625553131103516  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.763957977294922  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10702657699584961  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.952198028564453  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10683012008666992  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.849555492401123  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10660409927368164  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.130460739135742  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10677003860473633  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.789324283599854  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10642480850219727  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.622586727142334  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10681438446044922  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.093404293060303  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10628175735473633  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.62302827835083  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10655689239501953  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.815539360046387  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1066441535949707  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.06684923171997  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1063222885131836  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.74300718307495  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1065835952758789  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.620586395263672  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10660076141357422  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.697659015655518  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10688114166259766  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.277594566345215  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10704612731933594  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.354673385620117  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10678386688232422  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.3898286819458  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10663986206054688  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.971219062805176  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1066441535949707  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.14391279220581  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10652589797973633  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.86151361465454  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10662078857421875  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.701095581054688  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10671091079711914  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.057409286499023  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10675859451293945  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.268139362335205  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10661745071411133  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.03843927383423  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10672855377197266  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.05685567855835  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10644245147705078  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.910075187683105  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10642337799072266  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.59480619430542  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10668706893920898  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.063724040985107  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10623455047607422  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.486361980438232  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030534550547599792 |0.020990386605262756 |0.5565441772341728 |9.626150131225586e-05 |1.0609491467475891 |0.005298614501953125 |
----------------------------------------------------------pseudo_mini_loss sum 1.7130674123764038
Total (block generation + training)time/epoch 113.2076621055603
Training time/epoch 53.474172830581665
Training time without block to device /epoch 52.80248045921326
Training time without total dataloading part /epoch 51.76816534996033
load block tensor time/epoch 0.9771056175231934
block to device time/epoch 0.6716923713684082
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  9115847
Number of first layer input nodes during this epoch:  4762007
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12627315521240234  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024890899658203125
range selection method range initialization spend 0.017067670822143555
time for parepare:  0.019496917724609375
local_output_nid generation:  0.0010318756103515625
local_in_edges_tensor generation:  0.005296230316162109
mini_batch_src_global generation:  0.002050638198852539
r_  generation:  0.012015819549560547
local_output_nid generation:  0.0010173320770263672
local_in_edges_tensor generation:  0.0006916522979736328
mini_batch_src_global generation:  0.0015759468078613281
r_  generation:  0.01074075698852539
local_output_nid generation:  0.0009677410125732422
local_in_edges_tensor generation:  0.0006289482116699219
mini_batch_src_global generation:  0.0011682510375976562
r_  generation:  0.009762287139892578
local_output_nid generation:  0.0009317398071289062
local_in_edges_tensor generation:  0.0005977153778076172
mini_batch_src_global generation:  0.0011286735534667969
r_  generation:  0.010133981704711914
local_output_nid generation:  0.0008931159973144531
local_in_edges_tensor generation:  0.0005917549133300781
mini_batch_src_global generation:  0.001100778579711914
r_  generation:  0.010014057159423828
local_output_nid generation:  0.0008935928344726562
local_in_edges_tensor generation:  0.0005841255187988281
mini_batch_src_global generation:  0.0011250972747802734
r_  generation:  0.010122060775756836
local_output_nid generation:  0.0009176731109619141
local_in_edges_tensor generation:  0.0005767345428466797
mini_batch_src_global generation:  0.0012309551239013672
r_  generation:  0.010574817657470703
local_output_nid generation:  0.0009322166442871094
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.0012178421020507812
r_  generation:  0.010468482971191406
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005788803100585938
mini_batch_src_global generation:  0.0011017322540283203
r_  generation:  0.01030588150024414
local_output_nid generation:  0.0008814334869384766
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0011322498321533203
r_  generation:  0.010137796401977539
local_output_nid generation:  0.0008802413940429688
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.010277032852172852
local_output_nid generation:  0.0008530616760253906
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0011205673217773438
r_  generation:  0.010142087936401367
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.001209259033203125
r_  generation:  0.010376214981079102
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005733966827392578
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.01029515266418457
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.009998559951782227
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005662441253662109
mini_batch_src_global generation:  0.0012154579162597656
r_  generation:  0.010234355926513672
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005784034729003906
mini_batch_src_global generation:  0.0012328624725341797
r_  generation:  0.010601282119750977
local_output_nid generation:  0.0008571147918701172
local_in_edges_tensor generation:  0.0005953311920166016
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010486125946044922
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0005638599395751953
mini_batch_src_global generation:  0.0011415481567382812
r_  generation:  0.010170698165893555
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0005676746368408203
mini_batch_src_global generation:  0.0011441707611083984
r_  generation:  0.010117292404174805
local_output_nid generation:  0.0008523464202880859
local_in_edges_tensor generation:  0.0005657672882080078
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.010676383972167969
local_output_nid generation:  0.0008587837219238281
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0011785030364990234
r_  generation:  0.01024770736694336
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.010356664657592773
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.0005893707275390625
mini_batch_src_global generation:  0.0011816024780273438
r_  generation:  0.010512113571166992
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0005598068237304688
mini_batch_src_global generation:  0.0011470317840576172
r_  generation:  0.009984254837036133
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005671977996826172
mini_batch_src_global generation:  0.001168966293334961
r_  generation:  0.010627269744873047
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.010673999786376953
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0012543201446533203
r_  generation:  0.010582685470581055
local_output_nid generation:  0.0008587837219238281
local_in_edges_tensor generation:  0.0005557537078857422
mini_batch_src_global generation:  0.0011739730834960938
r_  generation:  0.01053619384765625
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005609989166259766
mini_batch_src_global generation:  0.0011584758758544922
r_  generation:  0.010478734970092773
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.0012018680572509766
r_  generation:  0.010279178619384766
local_output_nid generation:  0.0008661746978759766
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.009935140609741211
----------------------check_connections_block total spend ----------------------------- 0.5228791236877441
generate_one_block  0.024759292602539062
generate_one_block  0.020674705505371094
generate_one_block  0.019001245498657227
generate_one_block  0.01912403106689453
generate_one_block  0.01873183250427246
generate_one_block  0.01885390281677246
generate_one_block  0.019142627716064453
generate_one_block  0.018899202346801758
generate_one_block  0.019098758697509766
generate_one_block  0.018786191940307617
generate_one_block  0.018686771392822266
generate_one_block  0.018427371978759766
generate_one_block  0.018601417541503906
generate_one_block  0.018470048904418945
generate_one_block  0.019629955291748047
generate_one_block  0.01834249496459961
generate_one_block  0.01890397071838379
generate_one_block  0.0187685489654541
generate_one_block  0.01816868782043457
generate_one_block  0.018141984939575195
generate_one_block  0.0191800594329834
generate_one_block  0.018465042114257812
generate_one_block  0.020694971084594727
generate_one_block  0.019005298614501953
generate_one_block  0.01784372329711914
generate_one_block  0.018812179565429688
generate_one_block  0.0187530517578125
generate_one_block  0.018735170364379883
generate_one_block  0.018723011016845703
generate_one_block  0.01825737953186035
generate_one_block  0.018126726150512695
generate_one_block  0.01790165901184082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03973507881164551
gen group dst list time:  0.02596426010131836
time for parepare:  0.022127628326416016
local_output_nid generation:  0.005441904067993164
local_in_edges_tensor generation:  0.01680612564086914
mini_batch_src_global generation:  0.017362594604492188
r_  generation:  0.1844773292541504
local_output_nid generation:  0.012659311294555664
local_in_edges_tensor generation:  0.01309347152709961
mini_batch_src_global generation:  0.02173471450805664
r_  generation:  0.1778578758239746
local_output_nid generation:  0.013000726699829102
local_in_edges_tensor generation:  0.04400897026062012
mini_batch_src_global generation:  0.021956443786621094
r_  generation:  0.18147873878479004
local_output_nid generation:  0.014026165008544922
local_in_edges_tensor generation:  0.013659954071044922
mini_batch_src_global generation:  0.023731470108032227
r_  generation:  0.19026422500610352
local_output_nid generation:  0.014322757720947266
local_in_edges_tensor generation:  0.015269756317138672
mini_batch_src_global generation:  0.03129434585571289
r_  generation:  0.19244027137756348
local_output_nid generation:  0.012776851654052734
local_in_edges_tensor generation:  0.009165287017822266
mini_batch_src_global generation:  0.026560544967651367
r_  generation:  0.1937417984008789
local_output_nid generation:  0.011993885040283203
local_in_edges_tensor generation:  0.009047508239746094
mini_batch_src_global generation:  0.027295827865600586
r_  generation:  0.19806122779846191
local_output_nid generation:  0.009302616119384766
local_in_edges_tensor generation:  0.009366750717163086
mini_batch_src_global generation:  0.028845787048339844
r_  generation:  0.19668269157409668
local_output_nid generation:  0.008960485458374023
local_in_edges_tensor generation:  0.008783102035522461
mini_batch_src_global generation:  0.02517247200012207
r_  generation:  0.1954326629638672
local_output_nid generation:  0.012552976608276367
local_in_edges_tensor generation:  0.012199640274047852
mini_batch_src_global generation:  0.025285720825195312
r_  generation:  0.20103883743286133
local_output_nid generation:  0.009592294692993164
local_in_edges_tensor generation:  0.012891530990600586
mini_batch_src_global generation:  0.027489423751831055
r_  generation:  0.1914355754852295
local_output_nid generation:  0.00957345962524414
local_in_edges_tensor generation:  0.008737325668334961
mini_batch_src_global generation:  0.026039600372314453
r_  generation:  0.19553780555725098
local_output_nid generation:  0.012600183486938477
local_in_edges_tensor generation:  0.010661602020263672
mini_batch_src_global generation:  0.025418519973754883
r_  generation:  0.19949555397033691
local_output_nid generation:  0.009699106216430664
local_in_edges_tensor generation:  0.01018214225769043
mini_batch_src_global generation:  0.02700948715209961
r_  generation:  0.19496989250183105
local_output_nid generation:  0.009542465209960938
local_in_edges_tensor generation:  0.011594057083129883
mini_batch_src_global generation:  0.02464151382446289
r_  generation:  0.18623113632202148
local_output_nid generation:  0.009590625762939453
local_in_edges_tensor generation:  0.010583639144897461
mini_batch_src_global generation:  0.024959564208984375
r_  generation:  0.2038586139678955
local_output_nid generation:  0.012079715728759766
local_in_edges_tensor generation:  0.010605812072753906
mini_batch_src_global generation:  0.025876283645629883
r_  generation:  0.1923675537109375
local_output_nid generation:  0.01004338264465332
local_in_edges_tensor generation:  0.009525775909423828
mini_batch_src_global generation:  0.025662660598754883
r_  generation:  0.19415807723999023
local_output_nid generation:  0.009822845458984375
local_in_edges_tensor generation:  0.009444713592529297
mini_batch_src_global generation:  0.025111913681030273
r_  generation:  0.18961024284362793
local_output_nid generation:  0.00984334945678711
local_in_edges_tensor generation:  0.009406566619873047
mini_batch_src_global generation:  0.025531530380249023
r_  generation:  0.19483375549316406
local_output_nid generation:  0.0103912353515625
local_in_edges_tensor generation:  0.009749650955200195
mini_batch_src_global generation:  0.026454687118530273
r_  generation:  0.19697117805480957
local_output_nid generation:  0.009917259216308594
local_in_edges_tensor generation:  0.009678840637207031
mini_batch_src_global generation:  0.025275707244873047
r_  generation:  0.19215726852416992
local_output_nid generation:  0.009824514389038086
local_in_edges_tensor generation:  0.01002049446105957
mini_batch_src_global generation:  0.0349583625793457
r_  generation:  0.1930675506591797
local_output_nid generation:  0.010107040405273438
local_in_edges_tensor generation:  0.00914764404296875
mini_batch_src_global generation:  0.03796267509460449
r_  generation:  0.20767855644226074
local_output_nid generation:  0.009872198104858398
local_in_edges_tensor generation:  0.008900642395019531
mini_batch_src_global generation:  0.02665233612060547
r_  generation:  0.19408440589904785
local_output_nid generation:  0.011263608932495117
local_in_edges_tensor generation:  0.011983156204223633
mini_batch_src_global generation:  0.027264118194580078
r_  generation:  0.20557260513305664
local_output_nid generation:  0.010166645050048828
local_in_edges_tensor generation:  0.01575493812561035
mini_batch_src_global generation:  0.027408361434936523
r_  generation:  0.19759607315063477
local_output_nid generation:  0.009968280792236328
local_in_edges_tensor generation:  0.010201692581176758
mini_batch_src_global generation:  0.026257753372192383
r_  generation:  0.20193147659301758
local_output_nid generation:  0.010091543197631836
local_in_edges_tensor generation:  0.010649442672729492
mini_batch_src_global generation:  0.025841712951660156
r_  generation:  0.19624567031860352
local_output_nid generation:  0.009958028793334961
local_in_edges_tensor generation:  0.010708332061767578
mini_batch_src_global generation:  0.025365114212036133
r_  generation:  0.19270563125610352
local_output_nid generation:  0.009809017181396484
local_in_edges_tensor generation:  0.010232686996459961
mini_batch_src_global generation:  0.02515554428100586
r_  generation:  0.18775296211242676
local_output_nid generation:  0.009702682495117188
local_in_edges_tensor generation:  0.00885772705078125
mini_batch_src_global generation:  0.024505138397216797
r_  generation:  0.1895451545715332
----------------------check_connections_block total spend ----------------------------- 9.237384557723999
generate_one_block  0.26410818099975586
generate_one_block  0.2507925033569336
generate_one_block  0.24908900260925293
generate_one_block  0.25932860374450684
generate_one_block  0.27707552909851074
generate_one_block  0.2495260238647461
generate_one_block  0.2554781436920166
generate_one_block  0.2485487461090088
generate_one_block  0.25134873390197754
generate_one_block  0.24989962577819824
generate_one_block  0.23969364166259766
generate_one_block  0.24201703071594238
generate_one_block  0.25153064727783203
generate_one_block  0.24927496910095215
generate_one_block  0.2505183219909668
generate_one_block  0.2469933032989502
generate_one_block  0.25444674491882324
generate_one_block  0.25235414505004883
generate_one_block  0.24640941619873047
generate_one_block  0.25449252128601074
generate_one_block  0.26139307022094727
generate_one_block  0.2466750144958496
generate_one_block  0.2438509464263916
generate_one_block  0.2590622901916504
generate_one_block  0.24701380729675293
generate_one_block  0.2580866813659668
generate_one_block  0.25278592109680176
generate_one_block  0.2546980381011963
generate_one_block  0.2504849433898926
generate_one_block  0.245741605758667
generate_one_block  0.24486708641052246
generate_one_block  0.24092650413513184
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03474903106689453
gen group dst list time:  0.11638307571411133
time for parepare:  0.02094101905822754
local_output_nid generation:  0.02577662467956543
local_in_edges_tensor generation:  0.04549980163574219
mini_batch_src_global generation:  0.040521860122680664
r_  generation:  0.42519497871398926
local_output_nid generation:  0.03069472312927246
local_in_edges_tensor generation:  0.031998634338378906
mini_batch_src_global generation:  0.052876949310302734
r_  generation:  0.4239468574523926
local_output_nid generation:  0.030601024627685547
local_in_edges_tensor generation:  0.0267179012298584
mini_batch_src_global generation:  0.049866437911987305
r_  generation:  0.43093180656433105
local_output_nid generation:  0.03324103355407715
local_in_edges_tensor generation:  0.02983403205871582
mini_batch_src_global generation:  0.05270218849182129
r_  generation:  0.4332997798919678
local_output_nid generation:  0.03125190734863281
local_in_edges_tensor generation:  0.03139305114746094
mini_batch_src_global generation:  0.04986906051635742
r_  generation:  0.4398493766784668
local_output_nid generation:  0.03094339370727539
local_in_edges_tensor generation:  0.026660442352294922
mini_batch_src_global generation:  0.05205225944519043
r_  generation:  0.4378237724304199
local_output_nid generation:  0.029415369033813477
local_in_edges_tensor generation:  0.027630090713500977
mini_batch_src_global generation:  0.05430912971496582
r_  generation:  0.4414339065551758
local_output_nid generation:  0.03077530860900879
local_in_edges_tensor generation:  0.0293428897857666
mini_batch_src_global generation:  0.052345991134643555
r_  generation:  0.43904900550842285
local_output_nid generation:  0.032273054122924805
local_in_edges_tensor generation:  0.0269467830657959
mini_batch_src_global generation:  0.05485725402832031
r_  generation:  0.44137001037597656
local_output_nid generation:  0.029531002044677734
local_in_edges_tensor generation:  0.026412487030029297
mini_batch_src_global generation:  0.05224275588989258
r_  generation:  0.43839597702026367
local_output_nid generation:  0.028918027877807617
local_in_edges_tensor generation:  0.03201484680175781
mini_batch_src_global generation:  0.04998660087585449
r_  generation:  0.4379465579986572
local_output_nid generation:  0.029085874557495117
local_in_edges_tensor generation:  0.027579784393310547
mini_batch_src_global generation:  0.05377984046936035
r_  generation:  0.439838171005249
local_output_nid generation:  0.029162168502807617
local_in_edges_tensor generation:  0.026978015899658203
mini_batch_src_global generation:  0.05201125144958496
r_  generation:  0.4369375705718994
local_output_nid generation:  0.029126882553100586
local_in_edges_tensor generation:  0.030580759048461914
mini_batch_src_global generation:  0.051348209381103516
r_  generation:  0.4375619888305664
local_output_nid generation:  0.02939629554748535
local_in_edges_tensor generation:  0.03170943260192871
mini_batch_src_global generation:  0.05209970474243164
r_  generation:  0.4364335536956787
local_output_nid generation:  0.029428482055664062
local_in_edges_tensor generation:  0.031355857849121094
mini_batch_src_global generation:  0.051952362060546875
r_  generation:  0.4354093074798584
local_output_nid generation:  0.0296785831451416
local_in_edges_tensor generation:  0.030788183212280273
mini_batch_src_global generation:  0.0502471923828125
r_  generation:  0.43731212615966797
local_output_nid generation:  0.02967691421508789
local_in_edges_tensor generation:  0.029348134994506836
mini_batch_src_global generation:  0.05206179618835449
r_  generation:  0.43634772300720215
local_output_nid generation:  0.02982926368713379
local_in_edges_tensor generation:  0.03047776222229004
mini_batch_src_global generation:  0.05036616325378418
r_  generation:  0.43807506561279297
local_output_nid generation:  0.02949666976928711
local_in_edges_tensor generation:  0.028801679611206055
mini_batch_src_global generation:  0.05119633674621582
r_  generation:  0.4594869613647461
local_output_nid generation:  0.032459259033203125
local_in_edges_tensor generation:  0.029398441314697266
mini_batch_src_global generation:  0.054903507232666016
r_  generation:  0.4393644332885742
local_output_nid generation:  0.030271053314208984
local_in_edges_tensor generation:  0.029391050338745117
mini_batch_src_global generation:  0.05183911323547363
r_  generation:  0.43720030784606934
local_output_nid generation:  0.030248403549194336
local_in_edges_tensor generation:  0.027004241943359375
mini_batch_src_global generation:  0.05056405067443848
r_  generation:  0.43804144859313965
local_output_nid generation:  0.03036332130432129
local_in_edges_tensor generation:  0.026919841766357422
mini_batch_src_global generation:  0.05284690856933594
r_  generation:  0.4386289119720459
local_output_nid generation:  0.030281543731689453
local_in_edges_tensor generation:  0.028816938400268555
mini_batch_src_global generation:  0.0506131649017334
r_  generation:  0.4381742477416992
local_output_nid generation:  0.03104567527770996
local_in_edges_tensor generation:  0.029067039489746094
mini_batch_src_global generation:  0.051561594009399414
r_  generation:  0.44414854049682617
local_output_nid generation:  0.03088545799255371
local_in_edges_tensor generation:  0.029041051864624023
mini_batch_src_global generation:  0.05025839805603027
r_  generation:  0.44200634956359863
local_output_nid generation:  0.03089761734008789
local_in_edges_tensor generation:  0.029584646224975586
mini_batch_src_global generation:  0.051639556884765625
r_  generation:  0.4385952949523926
local_output_nid generation:  0.041998863220214844
local_in_edges_tensor generation:  0.02926325798034668
mini_batch_src_global generation:  0.05065441131591797
r_  generation:  0.4400002956390381
local_output_nid generation:  0.0301971435546875
local_in_edges_tensor generation:  0.029313087463378906
mini_batch_src_global generation:  0.050981998443603516
r_  generation:  0.4356973171234131
local_output_nid generation:  0.0301821231842041
local_in_edges_tensor generation:  0.026623964309692383
mini_batch_src_global generation:  0.05000138282775879
r_  generation:  0.43737006187438965
local_output_nid generation:  0.030016422271728516
local_in_edges_tensor generation:  0.027017593383789062
mini_batch_src_global generation:  0.05297207832336426
r_  generation:  0.43832921981811523
----------------------check_connections_block total spend ----------------------------- 20.767975568771362
generate_one_block  0.6008074283599854
generate_one_block  0.5908877849578857
generate_one_block  0.5802884101867676
generate_one_block  0.5890753269195557
generate_one_block  0.6916816234588623
generate_one_block  0.5845870971679688
generate_one_block  0.5878138542175293
generate_one_block  0.5880923271179199
generate_one_block  0.5841615200042725
generate_one_block  0.5851809978485107
generate_one_block  0.5777091979980469
generate_one_block  0.5906822681427002
generate_one_block  0.5905201435089111
generate_one_block  0.5880317687988281
generate_one_block  0.5816762447357178
generate_one_block  0.5965139865875244
generate_one_block  0.5892114639282227
generate_one_block  0.5876603126525879
generate_one_block  0.5915477275848389
generate_one_block  0.5840065479278564
generate_one_block  0.5924050807952881
generate_one_block  0.5822629928588867
generate_one_block  0.5932984352111816
generate_one_block  0.5953781604766846
generate_one_block  0.5946905612945557
generate_one_block  0.5937502384185791
generate_one_block  0.5882856845855713
generate_one_block  0.5882346630096436
generate_one_block  0.5842554569244385
generate_one_block  0.578561544418335
generate_one_block  0.5839836597442627
generate_one_block  0.5796067714691162
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12627315521240234  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

connection checking time:  30.00536012649536
block generation total time  26.963361024856567
average batch blocks generation time:  0.8426050320267677
block dataloader generation time/epoch 60.02330279350281
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10647726058959961  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.8765869140625  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10658597946166992  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.636295318603516  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10652399063110352  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.75722599029541  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10668039321899414  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.195831775665283  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10674715042114258  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.091280460357666  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1067805290222168  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.02694606781006  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10712289810180664  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.33374834060669  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10682392120361328  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.150057315826416  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10693740844726562  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.14477777481079  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10665702819824219  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.067389488220215  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1065526008605957  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.61491298675537  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10655736923217773  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.80860424041748  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10677194595336914  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.045098304748535  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10682868957519531  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.860486030578613  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10632801055908203  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.47136926651001  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10698890686035156  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.891522884368896  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10668134689331055  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.027033805847168  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10675764083862305  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.065360069274902  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10685205459594727  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.82724952697754  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10653495788574219  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.873347759246826  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10692882537841797  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.274629592895508  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10643815994262695  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.833672523498535  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10624551773071289  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.66124725341797  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1067352294921875  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.18660879135132  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10624980926513672  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.58435583114624  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10699272155761719  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.222190380096436  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1067509651184082  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.125372409820557  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10673284530639648  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.19837188720703  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10680675506591797  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.080543518066406  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1061248779296875  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.732911586761475  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10627937316894531  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.55914878845215  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1063241958618164  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.428754806518555  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03499867022037506 |0.022017911076545715 |0.5610155686736107 |0.00010517984628677368 |1.062153771519661 |0.009900808334350586 |
----------------------------------------------------------pseudo_mini_loss sum 1.648684024810791
Total (block generation + training)time/epoch 113.67628705501556
Training time/epoch 53.83126497268677
Training time without block to device /epoch 53.126691818237305
Training time without total dataloading part /epoch 51.95468544960022
load block tensor time/epoch 1.119957447052002
block to device time/epoch 0.7045731544494629
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  9119912
Number of first layer input nodes during this epoch:  4764542
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12623262405395508  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03044867515563965
range selection method range initialization spend 0.01602959632873535
time for parepare:  0.02614879608154297
local_output_nid generation:  0.0012464523315429688
local_in_edges_tensor generation:  0.007919549942016602
mini_batch_src_global generation:  0.0022830963134765625
r_  generation:  0.011203289031982422
local_output_nid generation:  0.0010843276977539062
local_in_edges_tensor generation:  0.0007843971252441406
mini_batch_src_global generation:  0.0020055770874023438
r_  generation:  0.011420726776123047
local_output_nid generation:  0.0010592937469482422
local_in_edges_tensor generation:  0.0006818771362304688
mini_batch_src_global generation:  0.0013720989227294922
r_  generation:  0.010478496551513672
local_output_nid generation:  0.0010437965393066406
local_in_edges_tensor generation:  0.0006887912750244141
mini_batch_src_global generation:  0.001354217529296875
r_  generation:  0.010573625564575195
local_output_nid generation:  0.0010526180267333984
local_in_edges_tensor generation:  0.0006766319274902344
mini_batch_src_global generation:  0.001314401626586914
r_  generation:  0.009981632232666016
local_output_nid generation:  0.0010528564453125
local_in_edges_tensor generation:  0.00064849853515625
mini_batch_src_global generation:  0.001325845718383789
r_  generation:  0.010488748550415039
local_output_nid generation:  0.0024106502532958984
local_in_edges_tensor generation:  0.001344442367553711
mini_batch_src_global generation:  0.003018617630004883
r_  generation:  0.01428675651550293
local_output_nid generation:  0.0011401176452636719
local_in_edges_tensor generation:  0.0006420612335205078
mini_batch_src_global generation:  0.001417398452758789
r_  generation:  0.010528326034545898
local_output_nid generation:  0.0010001659393310547
local_in_edges_tensor generation:  0.0005853176116943359
mini_batch_src_global generation:  0.001241922378540039
r_  generation:  0.010158777236938477
local_output_nid generation:  0.0009646415710449219
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.010367393493652344
local_output_nid generation:  0.0009295940399169922
local_in_edges_tensor generation:  0.0005993843078613281
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.010502099990844727
local_output_nid generation:  0.00092315673828125
local_in_edges_tensor generation:  0.0005750656127929688
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.009951591491699219
local_output_nid generation:  0.0009047985076904297
local_in_edges_tensor generation:  0.0005872249603271484
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.01031184196472168
local_output_nid generation:  0.0008909702301025391
local_in_edges_tensor generation:  0.0005657672882080078
mini_batch_src_global generation:  0.0011458396911621094
r_  generation:  0.01042318344116211
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0011272430419921875
r_  generation:  0.010268211364746094
local_output_nid generation:  0.0008914470672607422
local_in_edges_tensor generation:  0.0005719661712646484
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.010242938995361328
local_output_nid generation:  0.0008900165557861328
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0011341571807861328
r_  generation:  0.010365486145019531
local_output_nid generation:  0.0008893013000488281
local_in_edges_tensor generation:  0.0006086826324462891
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.010137796401977539
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0011591911315917969
r_  generation:  0.010200262069702148
local_output_nid generation:  0.0008869171142578125
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.0012252330780029297
r_  generation:  0.010353326797485352
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.010602951049804688
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005667209625244141
mini_batch_src_global generation:  0.0011150836944580078
r_  generation:  0.009988546371459961
local_output_nid generation:  0.0008761882781982422
local_in_edges_tensor generation:  0.0005762577056884766
mini_batch_src_global generation:  0.001196146011352539
r_  generation:  0.010197639465332031
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0006127357482910156
mini_batch_src_global generation:  0.0012619495391845703
r_  generation:  0.010676145553588867
local_output_nid generation:  0.0008728504180908203
local_in_edges_tensor generation:  0.0005593299865722656
mini_batch_src_global generation:  0.0011894702911376953
r_  generation:  0.009875297546386719
local_output_nid generation:  0.0008699893951416016
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0012099742889404297
r_  generation:  0.010737180709838867
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005638599395751953
mini_batch_src_global generation:  0.0011472702026367188
r_  generation:  0.010167121887207031
local_output_nid generation:  0.0008580684661865234
local_in_edges_tensor generation:  0.0005769729614257812
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.01054525375366211
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0006074905395507812
mini_batch_src_global generation:  0.0012254714965820312
r_  generation:  0.01015925407409668
local_output_nid generation:  0.0010013580322265625
local_in_edges_tensor generation:  0.0005984306335449219
mini_batch_src_global generation:  0.0011451244354248047
r_  generation:  0.01009368896484375
local_output_nid generation:  0.0009202957153320312
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.0012679100036621094
r_  generation:  0.010401010513305664
local_output_nid generation:  0.0009126663208007812
local_in_edges_tensor generation:  0.0005719661712646484
mini_batch_src_global generation:  0.001199483871459961
r_  generation:  0.010108709335327148
----------------------check_connections_block total spend ----------------------------- 0.5499362945556641
generate_one_block  0.02572345733642578
generate_one_block  0.020900726318359375
generate_one_block  0.01954174041748047
generate_one_block  0.019006729125976562
generate_one_block  0.01808905601501465
generate_one_block  0.018388986587524414
generate_one_block  0.018123865127563477
generate_one_block  0.018462657928466797
generate_one_block  0.01819324493408203
generate_one_block  0.01851511001586914
generate_one_block  0.01833486557006836
generate_one_block  0.01788163185119629
generate_one_block  0.018635988235473633
generate_one_block  0.018532991409301758
generate_one_block  0.01816868782043457
generate_one_block  0.01786017417907715
generate_one_block  0.018439054489135742
generate_one_block  0.017948389053344727
generate_one_block  0.018073558807373047
generate_one_block  0.018358945846557617
generate_one_block  0.018578529357910156
generate_one_block  0.017743349075317383
generate_one_block  0.020678281784057617
generate_one_block  0.019625425338745117
generate_one_block  0.017530441284179688
generate_one_block  0.01922464370727539
generate_one_block  0.018038034439086914
generate_one_block  0.01864027976989746
generate_one_block  0.018151521682739258
generate_one_block  0.018020153045654297
generate_one_block  0.018294811248779297
generate_one_block  0.017995119094848633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039771318435668945
gen group dst list time:  0.02581024169921875
time for parepare:  0.02231311798095703
local_output_nid generation:  0.0057294368743896484
local_in_edges_tensor generation:  0.01677727699279785
mini_batch_src_global generation:  0.020350933074951172
r_  generation:  0.1708061695098877
local_output_nid generation:  0.007895708084106445
local_in_edges_tensor generation:  0.011416196823120117
mini_batch_src_global generation:  0.02279806137084961
r_  generation:  0.2048323154449463
local_output_nid generation:  0.016819477081298828
local_in_edges_tensor generation:  0.04357790946960449
mini_batch_src_global generation:  0.02368330955505371
r_  generation:  0.18169784545898438
local_output_nid generation:  0.009691238403320312
local_in_edges_tensor generation:  0.009412527084350586
mini_batch_src_global generation:  0.022602319717407227
r_  generation:  0.18093252182006836
local_output_nid generation:  0.008693218231201172
local_in_edges_tensor generation:  0.011266946792602539
mini_batch_src_global generation:  0.022339820861816406
r_  generation:  0.1766223907470703
local_output_nid generation:  0.008687496185302734
local_in_edges_tensor generation:  0.00918722152709961
mini_batch_src_global generation:  0.0224151611328125
r_  generation:  0.17963171005249023
local_output_nid generation:  0.008667945861816406
local_in_edges_tensor generation:  0.008516311645507812
mini_batch_src_global generation:  0.02306222915649414
r_  generation:  0.17604947090148926
local_output_nid generation:  0.008425712585449219
local_in_edges_tensor generation:  0.008709430694580078
mini_batch_src_global generation:  0.023225069046020508
r_  generation:  0.18348336219787598
local_output_nid generation:  0.008538484573364258
local_in_edges_tensor generation:  0.011631488800048828
mini_batch_src_global generation:  0.023123979568481445
r_  generation:  0.17975759506225586
local_output_nid generation:  0.008861780166625977
local_in_edges_tensor generation:  0.008865118026733398
mini_batch_src_global generation:  0.023253440856933594
r_  generation:  0.18403339385986328
local_output_nid generation:  0.008962392807006836
local_in_edges_tensor generation:  0.008692264556884766
mini_batch_src_global generation:  0.023256778717041016
r_  generation:  0.18501067161560059
local_output_nid generation:  0.008654356002807617
local_in_edges_tensor generation:  0.009309768676757812
mini_batch_src_global generation:  0.022412538528442383
r_  generation:  0.17898201942443848
local_output_nid generation:  0.009076118469238281
local_in_edges_tensor generation:  0.014697551727294922
mini_batch_src_global generation:  0.024151086807250977
r_  generation:  0.19030547142028809
local_output_nid generation:  0.00902700424194336
local_in_edges_tensor generation:  0.012004613876342773
mini_batch_src_global generation:  0.023458480834960938
r_  generation:  0.18830513954162598
local_output_nid generation:  0.009636878967285156
local_in_edges_tensor generation:  0.011556148529052734
mini_batch_src_global generation:  0.02353501319885254
r_  generation:  0.18308210372924805
local_output_nid generation:  0.00875234603881836
local_in_edges_tensor generation:  0.01018834114074707
mini_batch_src_global generation:  0.023466825485229492
r_  generation:  0.17758774757385254
local_output_nid generation:  0.009105443954467773
local_in_edges_tensor generation:  0.009720802307128906
mini_batch_src_global generation:  0.02360820770263672
r_  generation:  0.18558716773986816
local_output_nid generation:  0.008959293365478516
local_in_edges_tensor generation:  0.008878231048583984
mini_batch_src_global generation:  0.02348947525024414
r_  generation:  0.18170595169067383
local_output_nid generation:  0.009034156799316406
local_in_edges_tensor generation:  0.008884906768798828
mini_batch_src_global generation:  0.024715423583984375
r_  generation:  0.18534231185913086
local_output_nid generation:  0.009107112884521484
local_in_edges_tensor generation:  0.011191844940185547
mini_batch_src_global generation:  0.023428678512573242
r_  generation:  0.18611884117126465
local_output_nid generation:  0.009361028671264648
local_in_edges_tensor generation:  0.009001731872558594
mini_batch_src_global generation:  0.02337169647216797
r_  generation:  0.18509554862976074
local_output_nid generation:  0.008903741836547852
local_in_edges_tensor generation:  0.009626626968383789
mini_batch_src_global generation:  0.0238494873046875
r_  generation:  0.1832444667816162
local_output_nid generation:  0.00945734977722168
local_in_edges_tensor generation:  0.009782791137695312
mini_batch_src_global generation:  0.023705720901489258
r_  generation:  0.19028973579406738
local_output_nid generation:  0.009439229965209961
local_in_edges_tensor generation:  0.012096643447875977
mini_batch_src_global generation:  0.026571273803710938
r_  generation:  0.19197750091552734
local_output_nid generation:  0.008773565292358398
local_in_edges_tensor generation:  0.010496139526367188
mini_batch_src_global generation:  0.022833585739135742
r_  generation:  0.1764833927154541
local_output_nid generation:  0.00962519645690918
local_in_edges_tensor generation:  0.013571739196777344
mini_batch_src_global generation:  0.024379253387451172
r_  generation:  0.20548391342163086
local_output_nid generation:  0.01136636734008789
local_in_edges_tensor generation:  0.009685039520263672
mini_batch_src_global generation:  0.02378106117248535
r_  generation:  0.17795538902282715
local_output_nid generation:  0.009371519088745117
local_in_edges_tensor generation:  0.009421348571777344
mini_batch_src_global generation:  0.02444171905517578
r_  generation:  0.18576717376708984
local_output_nid generation:  0.009170055389404297
local_in_edges_tensor generation:  0.011456489562988281
mini_batch_src_global generation:  0.023609638214111328
r_  generation:  0.18415451049804688
local_output_nid generation:  0.009256601333618164
local_in_edges_tensor generation:  0.008859872817993164
mini_batch_src_global generation:  0.023424148559570312
r_  generation:  0.18563079833984375
local_output_nid generation:  0.009325742721557617
local_in_edges_tensor generation:  0.00922703742980957
mini_batch_src_global generation:  0.023652076721191406
r_  generation:  0.18471741676330566
local_output_nid generation:  0.009252309799194336
local_in_edges_tensor generation:  0.009196281433105469
mini_batch_src_global generation:  0.02281355857849121
r_  generation:  0.17875266075134277
----------------------check_connections_block total spend ----------------------------- 8.657926321029663
generate_one_block  0.268613338470459
generate_one_block  0.24601292610168457
generate_one_block  0.2537388801574707
generate_one_block  0.24573302268981934
generate_one_block  0.25151705741882324
generate_one_block  0.24629783630371094
generate_one_block  0.23731708526611328
generate_one_block  0.2517709732055664
generate_one_block  0.252352237701416
generate_one_block  0.2653319835662842
generate_one_block  0.25133562088012695
generate_one_block  0.24187445640563965
generate_one_block  0.2525167465209961
generate_one_block  0.25449657440185547
generate_one_block  0.24734854698181152
generate_one_block  0.24024057388305664
generate_one_block  0.2541162967681885
generate_one_block  0.24782276153564453
generate_one_block  0.25603652000427246
generate_one_block  0.2617802619934082
generate_one_block  0.2507357597351074
generate_one_block  0.23955845832824707
generate_one_block  0.24576330184936523
generate_one_block  0.2567179203033447
generate_one_block  0.23471498489379883
generate_one_block  0.26544737815856934
generate_one_block  0.24294805526733398
generate_one_block  0.2512660026550293
generate_one_block  0.24929165840148926
generate_one_block  0.24598932266235352
generate_one_block  0.24955224990844727
generate_one_block  0.23934578895568848
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034517765045166016
gen group dst list time:  0.1142277717590332
time for parepare:  0.021170377731323242
local_output_nid generation:  0.026354074478149414
local_in_edges_tensor generation:  0.04213714599609375
mini_batch_src_global generation:  0.03974723815917969
r_  generation:  0.42531633377075195
local_output_nid generation:  0.031113386154174805
local_in_edges_tensor generation:  0.033918142318725586
mini_batch_src_global generation:  0.05258345603942871
r_  generation:  0.42301058769226074
local_output_nid generation:  0.03149700164794922
local_in_edges_tensor generation:  0.028426408767700195
mini_batch_src_global generation:  0.049758195877075195
r_  generation:  0.43270230293273926
local_output_nid generation:  0.031429290771484375
local_in_edges_tensor generation:  0.02695155143737793
mini_batch_src_global generation:  0.05062603950500488
r_  generation:  0.43047356605529785
local_output_nid generation:  0.031275033950805664
local_in_edges_tensor generation:  0.02823328971862793
mini_batch_src_global generation:  0.05050253868103027
r_  generation:  0.4447054862976074
local_output_nid generation:  0.03143715858459473
local_in_edges_tensor generation:  0.028169631958007812
mini_batch_src_global generation:  0.050904273986816406
r_  generation:  0.43549156188964844
local_output_nid generation:  0.03001999855041504
local_in_edges_tensor generation:  0.028128385543823242
mini_batch_src_global generation:  0.05290675163269043
r_  generation:  0.43657708168029785
local_output_nid generation:  0.029943227767944336
local_in_edges_tensor generation:  0.030721426010131836
mini_batch_src_global generation:  0.05107474327087402
r_  generation:  0.4398672580718994
local_output_nid generation:  0.02978372573852539
local_in_edges_tensor generation:  0.03486371040344238
mini_batch_src_global generation:  0.05120658874511719
r_  generation:  0.44002676010131836
local_output_nid generation:  0.03035712242126465
local_in_edges_tensor generation:  0.028511524200439453
mini_batch_src_global generation:  0.0530698299407959
r_  generation:  0.44062376022338867
local_output_nid generation:  0.030562162399291992
local_in_edges_tensor generation:  0.03128480911254883
mini_batch_src_global generation:  0.052886009216308594
r_  generation:  0.4422881603240967
local_output_nid generation:  0.030005216598510742
local_in_edges_tensor generation:  0.02705860137939453
mini_batch_src_global generation:  0.05147957801818848
r_  generation:  0.4388163089752197
local_output_nid generation:  0.0298612117767334
local_in_edges_tensor generation:  0.028291940689086914
mini_batch_src_global generation:  0.050330162048339844
r_  generation:  0.44060397148132324
local_output_nid generation:  0.0302431583404541
local_in_edges_tensor generation:  0.03327131271362305
mini_batch_src_global generation:  0.05222606658935547
r_  generation:  0.4421555995941162
local_output_nid generation:  0.03017449378967285
local_in_edges_tensor generation:  0.02837371826171875
mini_batch_src_global generation:  0.0526423454284668
r_  generation:  0.4404416084289551
local_output_nid generation:  0.030525684356689453
local_in_edges_tensor generation:  0.028532743453979492
mini_batch_src_global generation:  0.05347394943237305
r_  generation:  0.43776535987854004
local_output_nid generation:  0.030320167541503906
local_in_edges_tensor generation:  0.029565811157226562
mini_batch_src_global generation:  0.05032682418823242
r_  generation:  0.44032740592956543
local_output_nid generation:  0.0312807559967041
local_in_edges_tensor generation:  0.02832484245300293
mini_batch_src_global generation:  0.05386495590209961
r_  generation:  0.45465087890625
local_output_nid generation:  0.030085325241088867
local_in_edges_tensor generation:  0.028979063034057617
mini_batch_src_global generation:  0.060515403747558594
r_  generation:  0.4382190704345703
local_output_nid generation:  0.031656742095947266
local_in_edges_tensor generation:  0.028204679489135742
mini_batch_src_global generation:  0.051772117614746094
r_  generation:  0.4432854652404785
local_output_nid generation:  0.030434846878051758
local_in_edges_tensor generation:  0.02978229522705078
mini_batch_src_global generation:  0.050683021545410156
r_  generation:  0.4395632743835449
local_output_nid generation:  0.03037571907043457
local_in_edges_tensor generation:  0.02762770652770996
mini_batch_src_global generation:  0.05147123336791992
r_  generation:  0.43426942825317383
local_output_nid generation:  0.03022027015686035
local_in_edges_tensor generation:  0.02710413932800293
mini_batch_src_global generation:  0.05072331428527832
r_  generation:  0.4367246627807617
local_output_nid generation:  0.03082108497619629
local_in_edges_tensor generation:  0.03449535369873047
mini_batch_src_global generation:  0.05201864242553711
r_  generation:  0.4420607089996338
local_output_nid generation:  0.030274391174316406
local_in_edges_tensor generation:  0.027248382568359375
mini_batch_src_global generation:  0.05100059509277344
r_  generation:  0.4338035583496094
local_output_nid generation:  0.030698299407958984
local_in_edges_tensor generation:  0.027469635009765625
mini_batch_src_global generation:  0.05149412155151367
r_  generation:  0.44028449058532715
local_output_nid generation:  0.030150413513183594
local_in_edges_tensor generation:  0.026674270629882812
mini_batch_src_global generation:  0.05041956901550293
r_  generation:  0.4356980323791504
local_output_nid generation:  0.030332565307617188
local_in_edges_tensor generation:  0.026874303817749023
mini_batch_src_global generation:  0.05323195457458496
r_  generation:  0.4413936138153076
local_output_nid generation:  0.03026747703552246
local_in_edges_tensor generation:  0.03210186958312988
mini_batch_src_global generation:  0.05136704444885254
r_  generation:  0.4537065029144287
local_output_nid generation:  0.03015613555908203
local_in_edges_tensor generation:  0.026792526245117188
mini_batch_src_global generation:  0.05120253562927246
r_  generation:  0.4431777000427246
local_output_nid generation:  0.030313968658447266
local_in_edges_tensor generation:  0.028779983520507812
mini_batch_src_global generation:  0.052373409271240234
r_  generation:  0.4451334476470947
local_output_nid generation:  0.03203272819519043
local_in_edges_tensor generation:  0.027536869049072266
mini_batch_src_global generation:  0.0516970157623291
r_  generation:  0.4396820068359375
----------------------check_connections_block total spend ----------------------------- 20.79180932044983
generate_one_block  0.6025288105010986
generate_one_block  0.5860326290130615
generate_one_block  0.5840437412261963
generate_one_block  0.5828680992126465
generate_one_block  0.6823949813842773
generate_one_block  0.5913348197937012
generate_one_block  0.5870258808135986
generate_one_block  0.5853965282440186
generate_one_block  0.5882987976074219
generate_one_block  0.5931086540222168
generate_one_block  0.5912206172943115
generate_one_block  0.5758826732635498
generate_one_block  0.5870091915130615
generate_one_block  0.5912902355194092
generate_one_block  0.5839993953704834
generate_one_block  0.5814223289489746
generate_one_block  0.5872480869293213
generate_one_block  0.5912518501281738
generate_one_block  0.5783143043518066
generate_one_block  0.5809063911437988
generate_one_block  0.5871977806091309
generate_one_block  0.5817532539367676
generate_one_block  0.5793499946594238
generate_one_block  0.5956096649169922
generate_one_block  0.5995075702667236
generate_one_block  0.6008169651031494
generate_one_block  0.5853273868560791
generate_one_block  0.5849063396453857
generate_one_block  0.5926110744476318
generate_one_block  0.5845620632171631
generate_one_block  0.5908992290496826
generate_one_block  0.5809714794158936
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12623262405395508  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

connection checking time:  29.449735641479492
block generation total time  26.892675399780273
average batch blocks generation time:  0.8403961062431335
block dataloader generation time/epoch 59.940462589263916
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10712146759033203  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.263267040252686  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10680341720581055  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.97898817062378  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10686826705932617  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.29987382888794  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10676765441894531  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.98996067047119  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10624408721923828  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.447621822357178  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1065206527709961  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.95363759994507  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10655975341796875  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.561694145202637  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10637760162353516  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.126052379608154  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10642147064208984  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.77591037750244  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10647201538085938  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.029008388519287  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10711145401000977  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.114249229431152  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10642862319946289  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.485772609710693  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10677576065063477  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.009438037872314  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10679340362548828  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.101176261901855  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10639572143554688  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.810000896453857  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10641956329345703  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.601245403289795  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10673332214355469  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.00735902786255  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1065678596496582  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.87134075164795  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10630130767822266  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.928911209106445  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10664033889770508  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.0826416015625  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10668182373046875  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.98719835281372  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1065220832824707  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.37431001663208  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10643434524536133  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.84255361557007  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1071462631225586  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.306559562683105  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10626077651977539  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.377557277679443  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10703849792480469  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.52955150604248  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10631179809570312  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.575194358825684  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10672140121459961  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.01755666732788  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10675573348999023  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.000037670135498  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10639333724975586  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.86671018600464  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10675716400146484  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.058043479919434  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10651206970214844  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.690272331237793  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030367553234100342 |0.021822690963745117 |0.5609649047255516 |0.0001007765531539917 |1.0819678828120232 |0.00495457649230957 |
----------------------------------------------------------pseudo_mini_loss sum 1.602566123008728
Total (block generation + training)time/epoch 113.81624738375346
Training time/epoch 54.321134090423584
Training time without block to device /epoch 53.62280797958374
Training time without total dataloading part /epoch 52.58202862739563
load block tensor time/epoch 0.9717617034912109
block to device time/epoch 0.6983261108398438
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  9115138
Number of first layer input nodes during this epoch:  4763250
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12628507614135742  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023631572723388672
range selection method range initialization spend 0.01793813705444336
time for parepare:  0.02099013328552246
local_output_nid generation:  0.0009965896606445312
local_in_edges_tensor generation:  0.005122184753417969
mini_batch_src_global generation:  0.003396749496459961
r_  generation:  0.015802383422851562
local_output_nid generation:  0.0013163089752197266
local_in_edges_tensor generation:  0.0009167194366455078
mini_batch_src_global generation:  0.002232789993286133
r_  generation:  0.011897802352905273
local_output_nid generation:  0.0012400150299072266
local_in_edges_tensor generation:  0.0008058547973632812
mini_batch_src_global generation:  0.0015125274658203125
r_  generation:  0.010378122329711914
local_output_nid generation:  0.00118255615234375
local_in_edges_tensor generation:  0.0008275508880615234
mini_batch_src_global generation:  0.0015745162963867188
r_  generation:  0.010438203811645508
local_output_nid generation:  0.001146078109741211
local_in_edges_tensor generation:  0.0007369518280029297
mini_batch_src_global generation:  0.001491546630859375
r_  generation:  0.0102996826171875
local_output_nid generation:  0.0011878013610839844
local_in_edges_tensor generation:  0.0008425712585449219
mini_batch_src_global generation:  0.0014281272888183594
r_  generation:  0.010106325149536133
local_output_nid generation:  0.0011644363403320312
local_in_edges_tensor generation:  0.0006799697875976562
mini_batch_src_global generation:  0.0014395713806152344
r_  generation:  0.01055598258972168
local_output_nid generation:  0.0011782646179199219
local_in_edges_tensor generation:  0.0006885528564453125
mini_batch_src_global generation:  0.0014281272888183594
r_  generation:  0.010793209075927734
local_output_nid generation:  0.001123189926147461
local_in_edges_tensor generation:  0.0008118152618408203
mini_batch_src_global generation:  0.0014531612396240234
r_  generation:  0.010580301284790039
local_output_nid generation:  0.0011005401611328125
local_in_edges_tensor generation:  0.0006692409515380859
mini_batch_src_global generation:  0.0013895034790039062
r_  generation:  0.010700702667236328
local_output_nid generation:  0.0011107921600341797
local_in_edges_tensor generation:  0.0006542205810546875
mini_batch_src_global generation:  0.0014290809631347656
r_  generation:  0.010716438293457031
local_output_nid generation:  0.0010647773742675781
local_in_edges_tensor generation:  0.0006635189056396484
mini_batch_src_global generation:  0.0014801025390625
r_  generation:  0.010596752166748047
local_output_nid generation:  0.0010704994201660156
local_in_edges_tensor generation:  0.0006635189056396484
mini_batch_src_global generation:  0.0013804435729980469
r_  generation:  0.010905027389526367
local_output_nid generation:  0.0011327266693115234
local_in_edges_tensor generation:  0.0007331371307373047
mini_batch_src_global generation:  0.0013837814331054688
r_  generation:  0.010496377944946289
local_output_nid generation:  0.0010838508605957031
local_in_edges_tensor generation:  0.0007891654968261719
mini_batch_src_global generation:  0.0014023780822753906
r_  generation:  0.011644840240478516
local_output_nid generation:  0.0011475086212158203
local_in_edges_tensor generation:  0.0008268356323242188
mini_batch_src_global generation:  0.0015187263488769531
r_  generation:  0.011265993118286133
local_output_nid generation:  0.0010895729064941406
local_in_edges_tensor generation:  0.0007426738739013672
mini_batch_src_global generation:  0.001394510269165039
r_  generation:  0.010525226593017578
local_output_nid generation:  0.0010912418365478516
local_in_edges_tensor generation:  0.0008432865142822266
mini_batch_src_global generation:  0.0015268325805664062
r_  generation:  0.010207653045654297
local_output_nid generation:  0.0010824203491210938
local_in_edges_tensor generation:  0.0007257461547851562
mini_batch_src_global generation:  0.001413583755493164
r_  generation:  0.010889291763305664
local_output_nid generation:  0.0010890960693359375
local_in_edges_tensor generation:  0.0007169246673583984
mini_batch_src_global generation:  0.0013844966888427734
r_  generation:  0.010507345199584961
local_output_nid generation:  0.0011208057403564453
local_in_edges_tensor generation:  0.0008115768432617188
mini_batch_src_global generation:  0.0014030933380126953
r_  generation:  0.010105371475219727
local_output_nid generation:  0.0010628700256347656
local_in_edges_tensor generation:  0.0007598400115966797
mini_batch_src_global generation:  0.0014386177062988281
r_  generation:  0.010983943939208984
local_output_nid generation:  0.0010685920715332031
local_in_edges_tensor generation:  0.0007488727569580078
mini_batch_src_global generation:  0.001390695571899414
r_  generation:  0.010318994522094727
local_output_nid generation:  0.0010600090026855469
local_in_edges_tensor generation:  0.0006616115570068359
mini_batch_src_global generation:  0.0014064311981201172
r_  generation:  0.010862350463867188
local_output_nid generation:  0.0010466575622558594
local_in_edges_tensor generation:  0.0006814002990722656
mini_batch_src_global generation:  0.0014450550079345703
r_  generation:  0.010849237442016602
local_output_nid generation:  0.001096963882446289
local_in_edges_tensor generation:  0.0006508827209472656
mini_batch_src_global generation:  0.0016171932220458984
r_  generation:  0.01591801643371582
local_output_nid generation:  0.002346038818359375
local_in_edges_tensor generation:  0.0013599395751953125
mini_batch_src_global generation:  0.0030410289764404297
r_  generation:  0.0138092041015625
local_output_nid generation:  0.0010790824890136719
local_in_edges_tensor generation:  0.0006320476531982422
mini_batch_src_global generation:  0.0015397071838378906
r_  generation:  0.010090827941894531
local_output_nid generation:  0.0009670257568359375
local_in_edges_tensor generation:  0.0006563663482666016
mini_batch_src_global generation:  0.0013957023620605469
r_  generation:  0.01060342788696289
local_output_nid generation:  0.0009491443634033203
local_in_edges_tensor generation:  0.0006260871887207031
mini_batch_src_global generation:  0.0012955665588378906
r_  generation:  0.01059865951538086
local_output_nid generation:  0.0009143352508544922
local_in_edges_tensor generation:  0.0005729198455810547
mini_batch_src_global generation:  0.0015194416046142578
r_  generation:  0.010796546936035156
local_output_nid generation:  0.0008985996246337891
local_in_edges_tensor generation:  0.0006604194641113281
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.009659767150878906
----------------------check_connections_block total spend ----------------------------- 0.5843822956085205
generate_one_block  0.027354001998901367
generate_one_block  0.021050214767456055
generate_one_block  0.019258975982666016
generate_one_block  0.019091129302978516
generate_one_block  0.020763158798217773
generate_one_block  0.018071651458740234
generate_one_block  0.018668413162231445
generate_one_block  0.019036531448364258
generate_one_block  0.01855182647705078
generate_one_block  0.020127296447753906
generate_one_block  0.01876521110534668
generate_one_block  0.018614768981933594
generate_one_block  0.018840551376342773
generate_one_block  0.018375396728515625
generate_one_block  0.018946170806884766
generate_one_block  0.021442174911499023
generate_one_block  0.018157005310058594
generate_one_block  0.01786351203918457
generate_one_block  0.01883220672607422
generate_one_block  0.01816701889038086
generate_one_block  0.01922321319580078
generate_one_block  0.019245147705078125
generate_one_block  0.02021050453186035
generate_one_block  0.01949143409729004
generate_one_block  0.018754243850708008
generate_one_block  0.019092798233032227
generate_one_block  0.01977229118347168
generate_one_block  0.018044710159301758
generate_one_block  0.01906418800354004
generate_one_block  0.01860189437866211
generate_one_block  0.018663406372070312
generate_one_block  0.018689632415771484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03958845138549805
gen group dst list time:  0.02563953399658203
time for parepare:  0.021918535232543945
local_output_nid generation:  0.005671024322509766
local_in_edges_tensor generation:  0.017806529998779297
mini_batch_src_global generation:  0.019542455673217773
r_  generation:  0.16060328483581543
local_output_nid generation:  0.008224964141845703
local_in_edges_tensor generation:  0.010098934173583984
mini_batch_src_global generation:  0.03401350975036621
r_  generation:  0.18416523933410645
local_output_nid generation:  0.009167909622192383
local_in_edges_tensor generation:  0.03511524200439453
mini_batch_src_global generation:  0.02469635009765625
r_  generation:  0.17906880378723145
local_output_nid generation:  0.008624553680419922
local_in_edges_tensor generation:  0.010188102722167969
mini_batch_src_global generation:  0.025197744369506836
r_  generation:  0.18352627754211426
local_output_nid generation:  0.008646011352539062
local_in_edges_tensor generation:  0.008256912231445312
mini_batch_src_global generation:  0.025143861770629883
r_  generation:  0.1783292293548584
local_output_nid generation:  0.008418083190917969
local_in_edges_tensor generation:  0.009782075881958008
mini_batch_src_global generation:  0.03748440742492676
r_  generation:  0.17664504051208496
local_output_nid generation:  0.008603811264038086
local_in_edges_tensor generation:  0.008648395538330078
mini_batch_src_global generation:  0.02353358268737793
r_  generation:  0.20865345001220703
local_output_nid generation:  0.010139703750610352
local_in_edges_tensor generation:  0.01081228256225586
mini_batch_src_global generation:  0.040947675704956055
r_  generation:  0.1831662654876709
local_output_nid generation:  0.009929895401000977
local_in_edges_tensor generation:  0.00977635383605957
mini_batch_src_global generation:  0.023218631744384766
r_  generation:  0.18009138107299805
local_output_nid generation:  0.009409904479980469
local_in_edges_tensor generation:  0.009438037872314453
mini_batch_src_global generation:  0.023115158081054688
r_  generation:  0.181748628616333
local_output_nid generation:  0.009406089782714844
local_in_edges_tensor generation:  0.008692264556884766
mini_batch_src_global generation:  0.023000717163085938
r_  generation:  0.1794571876525879
local_output_nid generation:  0.00946354866027832
local_in_edges_tensor generation:  0.008613348007202148
mini_batch_src_global generation:  0.023756027221679688
r_  generation:  0.17931485176086426
local_output_nid generation:  0.00945425033569336
local_in_edges_tensor generation:  0.009677410125732422
mini_batch_src_global generation:  0.023810386657714844
r_  generation:  0.1848156452178955
local_output_nid generation:  0.009323835372924805
local_in_edges_tensor generation:  0.008732080459594727
mini_batch_src_global generation:  0.023125410079956055
r_  generation:  0.18283748626708984
local_output_nid generation:  0.009571552276611328
local_in_edges_tensor generation:  0.009035348892211914
mini_batch_src_global generation:  0.023509740829467773
r_  generation:  0.18423032760620117
local_output_nid generation:  0.009778261184692383
local_in_edges_tensor generation:  0.009859800338745117
mini_batch_src_global generation:  0.02533698081970215
r_  generation:  0.19310903549194336
local_output_nid generation:  0.009219169616699219
local_in_edges_tensor generation:  0.008666753768920898
mini_batch_src_global generation:  0.022956371307373047
r_  generation:  0.17864418029785156
local_output_nid generation:  0.009068965911865234
local_in_edges_tensor generation:  0.008387565612792969
mini_batch_src_global generation:  0.022427082061767578
r_  generation:  0.21480560302734375
local_output_nid generation:  0.015332460403442383
local_in_edges_tensor generation:  0.012470006942749023
mini_batch_src_global generation:  0.0288851261138916
r_  generation:  0.21319007873535156
local_output_nid generation:  0.016340255737304688
local_in_edges_tensor generation:  0.015131235122680664
mini_batch_src_global generation:  0.029520750045776367
r_  generation:  0.18498468399047852
local_output_nid generation:  0.012909889221191406
local_in_edges_tensor generation:  0.008801937103271484
mini_batch_src_global generation:  0.022113800048828125
r_  generation:  0.1753392219543457
local_output_nid generation:  0.010755062103271484
local_in_edges_tensor generation:  0.009952068328857422
mini_batch_src_global generation:  0.02462935447692871
r_  generation:  0.23963284492492676
local_output_nid generation:  0.009455442428588867
local_in_edges_tensor generation:  0.01152944564819336
mini_batch_src_global generation:  0.023129701614379883
r_  generation:  0.17919182777404785
local_output_nid generation:  0.009745121002197266
local_in_edges_tensor generation:  0.011275768280029297
mini_batch_src_global generation:  0.024810791015625
r_  generation:  0.19026875495910645
local_output_nid generation:  0.009493589401245117
local_in_edges_tensor generation:  0.014157295227050781
mini_batch_src_global generation:  0.023273229598999023
r_  generation:  0.18247580528259277
local_output_nid generation:  0.009629487991333008
local_in_edges_tensor generation:  0.009784460067749023
mini_batch_src_global generation:  0.023891210556030273
r_  generation:  0.1903369426727295
local_output_nid generation:  0.009100914001464844
local_in_edges_tensor generation:  0.009644508361816406
mini_batch_src_global generation:  0.022953033447265625
r_  generation:  0.17868638038635254
local_output_nid generation:  0.008992910385131836
local_in_edges_tensor generation:  0.009346485137939453
mini_batch_src_global generation:  0.02326822280883789
r_  generation:  0.17984676361083984
local_output_nid generation:  0.009279251098632812
local_in_edges_tensor generation:  0.010455131530761719
mini_batch_src_global generation:  0.024591684341430664
r_  generation:  0.1884479522705078
local_output_nid generation:  0.009454488754272461
local_in_edges_tensor generation:  0.00966787338256836
mini_batch_src_global generation:  0.02344226837158203
r_  generation:  0.18204283714294434
local_output_nid generation:  0.009406566619873047
local_in_edges_tensor generation:  0.009744882583618164
mini_batch_src_global generation:  0.023934125900268555
r_  generation:  0.18683719635009766
local_output_nid generation:  0.00903773307800293
local_in_edges_tensor generation:  0.010229349136352539
mini_batch_src_global generation:  0.02257370948791504
r_  generation:  0.18034148216247559
----------------------check_connections_block total spend ----------------------------- 8.819775581359863
generate_one_block  0.26343727111816406
generate_one_block  0.24712729454040527
generate_one_block  0.2498934268951416
generate_one_block  0.260451078414917
generate_one_block  0.2622067928314209
generate_one_block  0.23370671272277832
generate_one_block  0.25058984756469727
generate_one_block  0.2513566017150879
generate_one_block  0.2450547218322754
generate_one_block  0.2539522647857666
generate_one_block  0.2440035343170166
generate_one_block  0.24632692337036133
generate_one_block  0.25735044479370117
generate_one_block  0.2679128646850586
generate_one_block  0.2579052448272705
generate_one_block  0.2665712833404541
generate_one_block  0.24364972114562988
generate_one_block  0.24323391914367676
generate_one_block  0.25597143173217773
generate_one_block  0.2537424564361572
generate_one_block  0.2372570037841797
generate_one_block  0.25716185569763184
generate_one_block  0.23772811889648438
generate_one_block  0.25478029251098633
generate_one_block  0.2469947338104248
generate_one_block  0.2534916400909424
generate_one_block  0.24010419845581055
generate_one_block  0.24519562721252441
generate_one_block  0.26070094108581543
generate_one_block  0.24735641479492188
generate_one_block  0.24886393547058105
generate_one_block  0.23183679580688477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034384965896606445
gen group dst list time:  0.11364269256591797
time for parepare:  0.019952058792114258
local_output_nid generation:  0.025293350219726562
local_in_edges_tensor generation:  0.045211076736450195
mini_batch_src_global generation:  0.03949713706970215
r_  generation:  0.4199666976928711
local_output_nid generation:  0.029987096786499023
local_in_edges_tensor generation:  0.03603410720825195
mini_batch_src_global generation:  0.05262947082519531
r_  generation:  0.4274146556854248
local_output_nid generation:  0.03299355506896973
local_in_edges_tensor generation:  0.030864477157592773
mini_batch_src_global generation:  0.04975438117980957
r_  generation:  0.4375302791595459
local_output_nid generation:  0.03160881996154785
local_in_edges_tensor generation:  0.030568361282348633
mini_batch_src_global generation:  0.05053353309631348
r_  generation:  0.4360020160675049
local_output_nid generation:  0.030542850494384766
local_in_edges_tensor generation:  0.030690670013427734
mini_batch_src_global generation:  0.05066990852355957
r_  generation:  0.4441077709197998
local_output_nid generation:  0.03299975395202637
local_in_edges_tensor generation:  0.02816629409790039
mini_batch_src_global generation:  0.05290865898132324
r_  generation:  0.42999863624572754
local_output_nid generation:  0.030282258987426758
local_in_edges_tensor generation:  0.0280458927154541
mini_batch_src_global generation:  0.051276206970214844
r_  generation:  0.4376235008239746
local_output_nid generation:  0.030598163604736328
local_in_edges_tensor generation:  0.027985811233520508
mini_batch_src_global generation:  0.05378985404968262
r_  generation:  0.43368053436279297
local_output_nid generation:  0.029903650283813477
local_in_edges_tensor generation:  0.02675461769104004
mini_batch_src_global generation:  0.05055975914001465
r_  generation:  0.43654847145080566
local_output_nid generation:  0.029955625534057617
local_in_edges_tensor generation:  0.027411222457885742
mini_batch_src_global generation:  0.05193924903869629
r_  generation:  0.4350147247314453
local_output_nid generation:  0.029802322387695312
local_in_edges_tensor generation:  0.02789306640625
mini_batch_src_global generation:  0.051232099533081055
r_  generation:  0.4405536651611328
local_output_nid generation:  0.030081510543823242
local_in_edges_tensor generation:  0.028375864028930664
mini_batch_src_global generation:  0.053591251373291016
r_  generation:  0.43822193145751953
local_output_nid generation:  0.030128955841064453
local_in_edges_tensor generation:  0.029278993606567383
mini_batch_src_global generation:  0.050760746002197266
r_  generation:  0.4395136833190918
local_output_nid generation:  0.02998805046081543
local_in_edges_tensor generation:  0.02825307846069336
mini_batch_src_global generation:  0.05176115036010742
r_  generation:  0.43848633766174316
local_output_nid generation:  0.03066563606262207
local_in_edges_tensor generation:  0.033780574798583984
mini_batch_src_global generation:  0.050568580627441406
r_  generation:  0.4419403076171875
local_output_nid generation:  0.030344247817993164
local_in_edges_tensor generation:  0.03281235694885254
mini_batch_src_global generation:  0.05489516258239746
r_  generation:  0.44033288955688477
local_output_nid generation:  0.03004932403564453
local_in_edges_tensor generation:  0.027895450592041016
mini_batch_src_global generation:  0.05057930946350098
r_  generation:  0.4385964870452881
local_output_nid generation:  0.03003382682800293
local_in_edges_tensor generation:  0.026253700256347656
mini_batch_src_global generation:  0.052377939224243164
r_  generation:  0.4343595504760742
local_output_nid generation:  0.030642986297607422
local_in_edges_tensor generation:  0.028864145278930664
mini_batch_src_global generation:  0.05360007286071777
r_  generation:  0.4425356388092041
local_output_nid generation:  0.030238866806030273
local_in_edges_tensor generation:  0.028462648391723633
mini_batch_src_global generation:  0.05358695983886719
r_  generation:  0.43225598335266113
local_output_nid generation:  0.02987980842590332
local_in_edges_tensor generation:  0.03243708610534668
mini_batch_src_global generation:  0.050133705139160156
r_  generation:  0.4340062141418457
local_output_nid generation:  0.031453847885131836
local_in_edges_tensor generation:  0.02820277214050293
mini_batch_src_global generation:  0.05156731605529785
r_  generation:  0.43684911727905273
local_output_nid generation:  0.03006267547607422
local_in_edges_tensor generation:  0.02719569206237793
mini_batch_src_global generation:  0.05137300491333008
r_  generation:  0.4453747272491455
local_output_nid generation:  0.030252695083618164
local_in_edges_tensor generation:  0.02812790870666504
mini_batch_src_global generation:  0.054479122161865234
r_  generation:  0.4446225166320801
local_output_nid generation:  0.03423666954040527
local_in_edges_tensor generation:  0.028337717056274414
mini_batch_src_global generation:  0.05394172668457031
r_  generation:  0.43796682357788086
local_output_nid generation:  0.030422210693359375
local_in_edges_tensor generation:  0.027146339416503906
mini_batch_src_global generation:  0.0518183708190918
r_  generation:  0.4360697269439697
local_output_nid generation:  0.030187129974365234
local_in_edges_tensor generation:  0.030103683471679688
mini_batch_src_global generation:  0.05072474479675293
r_  generation:  0.43462371826171875
local_output_nid generation:  0.030225753784179688
local_in_edges_tensor generation:  0.027339696884155273
mini_batch_src_global generation:  0.05309414863586426
r_  generation:  0.443192720413208
local_output_nid generation:  0.03104686737060547
local_in_edges_tensor generation:  0.029481172561645508
mini_batch_src_global generation:  0.05015730857849121
r_  generation:  0.44413018226623535
local_output_nid generation:  0.030887365341186523
local_in_edges_tensor generation:  0.02897024154663086
mini_batch_src_global generation:  0.0516970157623291
r_  generation:  0.43788719177246094
local_output_nid generation:  0.030364036560058594
local_in_edges_tensor generation:  0.028820037841796875
mini_batch_src_global generation:  0.05088543891906738
r_  generation:  0.4381082057952881
local_output_nid generation:  0.030137062072753906
local_in_edges_tensor generation:  0.02918553352355957
mini_batch_src_global generation:  0.050737619400024414
r_  generation:  0.43378686904907227
----------------------check_connections_block total spend ----------------------------- 20.76211452484131
generate_one_block  0.5970456600189209
generate_one_block  0.5798332691192627
generate_one_block  0.5845723152160645
generate_one_block  0.5842390060424805
generate_one_block  0.6862871646881104
generate_one_block  0.5847733020782471
generate_one_block  0.59047532081604
generate_one_block  0.5907070636749268
generate_one_block  0.5799088478088379
generate_one_block  0.5884866714477539
generate_one_block  0.5887980461120605
generate_one_block  0.5865626335144043
generate_one_block  0.5898988246917725
generate_one_block  0.589515209197998
generate_one_block  0.588813066482544
generate_one_block  0.5934474468231201
generate_one_block  0.5793440341949463
generate_one_block  0.5818221569061279
generate_one_block  0.5962228775024414
generate_one_block  0.5855770111083984
generate_one_block  0.5821542739868164
generate_one_block  0.5890216827392578
generate_one_block  0.5814456939697266
generate_one_block  0.5871710777282715
generate_one_block  0.6069238185882568
generate_one_block  0.5946142673492432
generate_one_block  0.5822765827178955
generate_one_block  0.5847322940826416
generate_one_block  0.5948276519775391
generate_one_block  0.5900759696960449
generate_one_block  0.5815451145172119
generate_one_block  0.5791370868682861
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12628507614135742  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

connection checking time:  29.581890106201172
block generation total time  26.916170835494995
average batch blocks generation time:  0.8411303386092186
block dataloader generation time/epoch 59.948515474796295
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10628986358642578  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.552298069000244  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10605955123901367  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.724708080291748  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.106689453125  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.93508768081665  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10672664642333984  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.13075065612793  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10635852813720703  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.645052433013916  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10646629333496094  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.400803565979004  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10658121109008789  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.05738067626953  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10652494430541992  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.089136123657227  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10636615753173828  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.878087043762207  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10673666000366211  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.074666023254395  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10653877258300781  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.88716745376587  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10669946670532227  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.940014839172363  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10669326782226562  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.222092628479004  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10666465759277344  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.962815284729004  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1068429946899414  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.184279918670654  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1071929931640625  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.557298183441162  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10640239715576172  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.611909866333008  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10632753372192383  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.551916122436523  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10697364807128906  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.169087409973145  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10625505447387695  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.83005714416504  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1061391830444336  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.261666297912598  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10675525665283203  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.25062656402588  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10633134841918945  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.528244972229004  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1066751480102539  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.198657512664795  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10650157928466797  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.838729858398438  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1069784164428711  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.209914684295654  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10629987716674805  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.644230365753174  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10638427734375  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.786357402801514  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10686588287353516  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.293015003204346  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10701227188110352  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.994970321655273  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10671472549438477  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.987547874450684  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10616922378540039  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.23356008529663  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.036140650510787964 |0.0211501345038414 |0.5566064342856407 |9.627640247344971e-05 |1.0630027875304222 |0.008948326110839844 |
----------------------------------------------------------pseudo_mini_loss sum 1.5549436807632446
Total (block generation + training)time/epoch 113.78734266757965
Training time/epoch 53.72768211364746
Training time without block to device /epoch 53.050877809524536
Training time without total dataloading part /epoch 51.839524269104004
load block tensor time/epoch 1.1565008163452148
block to device time/epoch 0.6768043041229248
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  9108249
Number of first layer input nodes during this epoch:  4760283
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12595319747924805  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.048719167709350586
range selection method range initialization spend 0.014186382293701172
time for parepare:  0.020557641983032227
local_output_nid generation:  0.0009663105010986328
local_in_edges_tensor generation:  0.009345054626464844
mini_batch_src_global generation:  0.0015811920166015625
r_  generation:  0.011167526245117188
local_output_nid generation:  0.0009801387786865234
local_in_edges_tensor generation:  0.000698089599609375
mini_batch_src_global generation:  0.00165557861328125
r_  generation:  0.010743141174316406
local_output_nid generation:  0.0009250640869140625
local_in_edges_tensor generation:  0.0006299018859863281
mini_batch_src_global generation:  0.0011298656463623047
r_  generation:  0.010154008865356445
local_output_nid generation:  0.0008838176727294922
local_in_edges_tensor generation:  0.0005948543548583984
mini_batch_src_global generation:  0.0011322498321533203
r_  generation:  0.010193824768066406
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.001068115234375
r_  generation:  0.009847640991210938
local_output_nid generation:  0.0008831024169921875
local_in_edges_tensor generation:  0.0006010532379150391
mini_batch_src_global generation:  0.001130819320678711
r_  generation:  0.010172367095947266
local_output_nid generation:  0.0009050369262695312
local_in_edges_tensor generation:  0.0005650520324707031
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.01019144058227539
local_output_nid generation:  0.00091552734375
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.00990748405456543
local_output_nid generation:  0.0008780956268310547
local_in_edges_tensor generation:  0.0005762577056884766
mini_batch_src_global generation:  0.001087188720703125
r_  generation:  0.01008462905883789
local_output_nid generation:  0.0008568763732910156
local_in_edges_tensor generation:  0.0006077289581298828
mini_batch_src_global generation:  0.00122833251953125
r_  generation:  0.010468721389770508
local_output_nid generation:  0.0008764266967773438
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.009806632995605469
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0005791187286376953
mini_batch_src_global generation:  0.0011196136474609375
r_  generation:  0.009955406188964844
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0010988712310791016
r_  generation:  0.010165929794311523
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005853176116943359
mini_batch_src_global generation:  0.0012161731719970703
r_  generation:  0.010261297225952148
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005824565887451172
mini_batch_src_global generation:  0.0012791156768798828
r_  generation:  0.010890960693359375
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0012063980102539062
r_  generation:  0.010423421859741211
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.0012416839599609375
r_  generation:  0.010460138320922852
local_output_nid generation:  0.0008637905120849609
local_in_edges_tensor generation:  0.0005700588226318359
mini_batch_src_global generation:  0.001154184341430664
r_  generation:  0.010243415832519531
local_output_nid generation:  0.0008945465087890625
local_in_edges_tensor generation:  0.0005860328674316406
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.009709596633911133
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.0005915164947509766
mini_batch_src_global generation:  0.0011947154998779297
r_  generation:  0.010298967361450195
local_output_nid generation:  0.0008816719055175781
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0011913776397705078
r_  generation:  0.010027647018432617
local_output_nid generation:  0.0008757114410400391
local_in_edges_tensor generation:  0.0005612373352050781
mini_batch_src_global generation:  0.0011246204376220703
r_  generation:  0.010193347930908203
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.00116729736328125
r_  generation:  0.010520219802856445
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0005428791046142578
mini_batch_src_global generation:  0.0011920928955078125
r_  generation:  0.010337591171264648
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005800724029541016
mini_batch_src_global generation:  0.001161336898803711
r_  generation:  0.010343313217163086
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005731582641601562
mini_batch_src_global generation:  0.0012104511260986328
r_  generation:  0.010131597518920898
local_output_nid generation:  0.0008780956268310547
local_in_edges_tensor generation:  0.0005519390106201172
mini_batch_src_global generation:  0.001130819320678711
r_  generation:  0.010301828384399414
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005805492401123047
mini_batch_src_global generation:  0.0012030601501464844
r_  generation:  0.010713338851928711
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005805492401123047
mini_batch_src_global generation:  0.0011985301971435547
r_  generation:  0.010735034942626953
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.010333061218261719
local_output_nid generation:  0.0008604526519775391
local_in_edges_tensor generation:  0.0005676746368408203
mini_batch_src_global generation:  0.001148223876953125
r_  generation:  0.010266542434692383
local_output_nid generation:  0.0008738040924072266
local_in_edges_tensor generation:  0.0005712509155273438
mini_batch_src_global generation:  0.001178741455078125
r_  generation:  0.010609149932861328
----------------------check_connections_block total spend ----------------------------- 0.5239696502685547
generate_one_block  0.025465011596679688
generate_one_block  0.020969867706298828
generate_one_block  0.019426345825195312
generate_one_block  0.01920604705810547
generate_one_block  0.018234729766845703
generate_one_block  0.01870441436767578
generate_one_block  0.018471717834472656
generate_one_block  0.018382787704467773
generate_one_block  0.01817607879638672
generate_one_block  0.019071102142333984
generate_one_block  0.017512083053588867
generate_one_block  0.018236398696899414
generate_one_block  0.018282413482666016
generate_one_block  0.018581867218017578
generate_one_block  0.01940178871154785
generate_one_block  0.018923282623291016
generate_one_block  0.018587589263916016
generate_one_block  0.018494844436645508
generate_one_block  0.01742863655090332
generate_one_block  0.01832270622253418
generate_one_block  0.01781010627746582
generate_one_block  0.018260955810546875
generate_one_block  0.021010637283325195
generate_one_block  0.018458127975463867
generate_one_block  0.018506288528442383
generate_one_block  0.018105268478393555
generate_one_block  0.018342018127441406
generate_one_block  0.018970727920532227
generate_one_block  0.018857955932617188
generate_one_block  0.01833200454711914
generate_one_block  0.018146514892578125
generate_one_block  0.0188291072845459
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040888071060180664
gen group dst list time:  0.022823572158813477
time for parepare:  0.02196502685546875
local_output_nid generation:  0.005672454833984375
local_in_edges_tensor generation:  0.017978668212890625
mini_batch_src_global generation:  0.019118070602416992
r_  generation:  0.16819262504577637
local_output_nid generation:  0.007807493209838867
local_in_edges_tensor generation:  0.011160612106323242
mini_batch_src_global generation:  0.02302408218383789
r_  generation:  0.1717538833618164
local_output_nid generation:  0.008070707321166992
local_in_edges_tensor generation:  0.03450369834899902
mini_batch_src_global generation:  0.022731542587280273
r_  generation:  0.18056750297546387
local_output_nid generation:  0.008597135543823242
local_in_edges_tensor generation:  0.011456727981567383
mini_batch_src_global generation:  0.022975444793701172
r_  generation:  0.18262600898742676
local_output_nid generation:  0.008636236190795898
local_in_edges_tensor generation:  0.011285543441772461
mini_batch_src_global generation:  0.023074626922607422
r_  generation:  0.17705416679382324
local_output_nid generation:  0.008863449096679688
local_in_edges_tensor generation:  0.0108489990234375
mini_batch_src_global generation:  0.02505207061767578
r_  generation:  0.18224501609802246
local_output_nid generation:  0.008801937103271484
local_in_edges_tensor generation:  0.009571075439453125
mini_batch_src_global generation:  0.023099422454833984
r_  generation:  0.1831645965576172
local_output_nid generation:  0.008383512496948242
local_in_edges_tensor generation:  0.008928775787353516
mini_batch_src_global generation:  0.023397445678710938
r_  generation:  0.18122553825378418
local_output_nid generation:  0.00837564468383789
local_in_edges_tensor generation:  0.008904457092285156
mini_batch_src_global generation:  0.023750782012939453
r_  generation:  0.1774303913116455
local_output_nid generation:  0.00904393196105957
local_in_edges_tensor generation:  0.009103536605834961
mini_batch_src_global generation:  0.025490760803222656
r_  generation:  0.18876338005065918
local_output_nid generation:  0.008428812026977539
local_in_edges_tensor generation:  0.011505365371704102
mini_batch_src_global generation:  0.023520708084106445
r_  generation:  0.17462944984436035
local_output_nid generation:  0.008852958679199219
local_in_edges_tensor generation:  0.010092973709106445
mini_batch_src_global generation:  0.023240089416503906
r_  generation:  0.18159246444702148
local_output_nid generation:  0.009050846099853516
local_in_edges_tensor generation:  0.009671688079833984
mini_batch_src_global generation:  0.023013830184936523
r_  generation:  0.1809549331665039
local_output_nid generation:  0.009421110153198242
local_in_edges_tensor generation:  0.0108184814453125
mini_batch_src_global generation:  0.023117542266845703
r_  generation:  0.18526172637939453
local_output_nid generation:  0.009634971618652344
local_in_edges_tensor generation:  0.010210275650024414
mini_batch_src_global generation:  0.024500370025634766
r_  generation:  0.1934947967529297
local_output_nid generation:  0.009186029434204102
local_in_edges_tensor generation:  0.012193918228149414
mini_batch_src_global generation:  0.02449631690979004
r_  generation:  0.1878659725189209
local_output_nid generation:  0.009183883666992188
local_in_edges_tensor generation:  0.013417959213256836
mini_batch_src_global generation:  0.024962902069091797
r_  generation:  0.19043445587158203
local_output_nid generation:  0.009263277053833008
local_in_edges_tensor generation:  0.009326934814453125
mini_batch_src_global generation:  0.024008512496948242
r_  generation:  0.18932127952575684
local_output_nid generation:  0.008927345275878906
local_in_edges_tensor generation:  0.011434555053710938
mini_batch_src_global generation:  0.02387714385986328
r_  generation:  0.17850303649902344
local_output_nid generation:  0.011491537094116211
local_in_edges_tensor generation:  0.01065683364868164
mini_batch_src_global generation:  0.02307438850402832
r_  generation:  0.18484044075012207
local_output_nid generation:  0.009003162384033203
local_in_edges_tensor generation:  0.009239435195922852
mini_batch_src_global generation:  0.024616718292236328
r_  generation:  0.1802971363067627
local_output_nid generation:  0.009337663650512695
local_in_edges_tensor generation:  0.009253978729248047
mini_batch_src_global generation:  0.02339911460876465
r_  generation:  0.18457913398742676
local_output_nid generation:  0.009379148483276367
local_in_edges_tensor generation:  0.011453628540039062
mini_batch_src_global generation:  0.025274991989135742
r_  generation:  0.18796920776367188
local_output_nid generation:  0.010064363479614258
local_in_edges_tensor generation:  0.011661767959594727
mini_batch_src_global generation:  0.023671388626098633
r_  generation:  0.18152284622192383
local_output_nid generation:  0.009395122528076172
local_in_edges_tensor generation:  0.009283304214477539
mini_batch_src_global generation:  0.024153470993041992
r_  generation:  0.1859734058380127
local_output_nid generation:  0.009120702743530273
local_in_edges_tensor generation:  0.009772777557373047
mini_batch_src_global generation:  0.023252010345458984
r_  generation:  0.18421316146850586
local_output_nid generation:  0.011401176452636719
local_in_edges_tensor generation:  0.00914764404296875
mini_batch_src_global generation:  0.02339315414428711
r_  generation:  0.18535876274108887
local_output_nid generation:  0.009784936904907227
local_in_edges_tensor generation:  0.011629104614257812
mini_batch_src_global generation:  0.0237734317779541
r_  generation:  0.1878368854522705
local_output_nid generation:  0.009748220443725586
local_in_edges_tensor generation:  0.009061336517333984
mini_batch_src_global generation:  0.02315044403076172
r_  generation:  0.18473577499389648
local_output_nid generation:  0.009455680847167969
local_in_edges_tensor generation:  0.009713888168334961
mini_batch_src_global generation:  0.023003101348876953
r_  generation:  0.18322300910949707
local_output_nid generation:  0.009244203567504883
local_in_edges_tensor generation:  0.009003877639770508
mini_batch_src_global generation:  0.022901058197021484
r_  generation:  0.18173694610595703
local_output_nid generation:  0.009865999221801758
local_in_edges_tensor generation:  0.009932279586791992
mini_batch_src_global generation:  0.02462005615234375
r_  generation:  0.1875135898590088
----------------------check_connections_block total spend ----------------------------- 8.635072708129883
generate_one_block  0.26792478561401367
generate_one_block  0.24708938598632812
generate_one_block  0.2518587112426758
generate_one_block  0.25426411628723145
generate_one_block  0.2586967945098877
generate_one_block  0.24921679496765137
generate_one_block  0.24983549118041992
generate_one_block  0.24740004539489746
generate_one_block  0.2403116226196289
generate_one_block  0.26116299629211426
generate_one_block  0.23551106452941895
generate_one_block  0.2436981201171875
generate_one_block  0.24493670463562012
generate_one_block  0.24612760543823242
generate_one_block  0.25867295265197754
generate_one_block  0.2536587715148926
generate_one_block  0.25708651542663574
generate_one_block  0.26126742362976074
generate_one_block  0.2375659942626953
generate_one_block  0.2533426284790039
generate_one_block  0.23637938499450684
generate_one_block  0.24828076362609863
generate_one_block  0.2528514862060547
generate_one_block  0.24278974533081055
generate_one_block  0.24937057495117188
generate_one_block  0.242659330368042
generate_one_block  0.24861574172973633
generate_one_block  0.2602560520172119
generate_one_block  0.24832487106323242
generate_one_block  0.2499842643737793
generate_one_block  0.2427232265472412
generate_one_block  0.25609326362609863
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041684865951538086
gen group dst list time:  0.11347341537475586
time for parepare:  0.019945621490478516
local_output_nid generation:  0.025229692459106445
local_in_edges_tensor generation:  0.05179738998413086
mini_batch_src_global generation:  0.04132390022277832
r_  generation:  0.4257030487060547
local_output_nid generation:  0.03059554100036621
local_in_edges_tensor generation:  0.03470420837402344
mini_batch_src_global generation:  0.05292487144470215
r_  generation:  0.4247570037841797
local_output_nid generation:  0.03062605857849121
local_in_edges_tensor generation:  0.030143022537231445
mini_batch_src_global generation:  0.049775123596191406
r_  generation:  0.4374806880950928
local_output_nid generation:  0.03289484977722168
local_in_edges_tensor generation:  0.03202366828918457
mini_batch_src_global generation:  0.05073046684265137
r_  generation:  0.43265271186828613
local_output_nid generation:  0.03133797645568848
local_in_edges_tensor generation:  0.035597801208496094
mini_batch_src_global generation:  0.050580739974975586
r_  generation:  0.4370839595794678
local_output_nid generation:  0.03165030479431152
local_in_edges_tensor generation:  0.02783203125
mini_batch_src_global generation:  0.05195808410644531
r_  generation:  0.435746431350708
local_output_nid generation:  0.03027820587158203
local_in_edges_tensor generation:  0.03331613540649414
mini_batch_src_global generation:  0.05129289627075195
r_  generation:  0.4393930435180664
local_output_nid generation:  0.029572486877441406
local_in_edges_tensor generation:  0.02962470054626465
mini_batch_src_global generation:  0.05218148231506348
r_  generation:  0.448749303817749
local_output_nid generation:  0.03205370903015137
local_in_edges_tensor generation:  0.02887558937072754
mini_batch_src_global generation:  0.052417755126953125
r_  generation:  0.433211088180542
local_output_nid generation:  0.030027151107788086
local_in_edges_tensor generation:  0.029666423797607422
mini_batch_src_global generation:  0.05396533012390137
r_  generation:  0.43700361251831055
local_output_nid generation:  0.029895544052124023
local_in_edges_tensor generation:  0.027112245559692383
mini_batch_src_global generation:  0.05136370658874512
r_  generation:  0.4314401149749756
local_output_nid generation:  0.030444622039794922
local_in_edges_tensor generation:  0.029119014739990234
mini_batch_src_global generation:  0.054343223571777344
r_  generation:  0.43834567070007324
local_output_nid generation:  0.03006744384765625
local_in_edges_tensor generation:  0.030648231506347656
mini_batch_src_global generation:  0.05174875259399414
r_  generation:  0.4320821762084961
local_output_nid generation:  0.03053593635559082
local_in_edges_tensor generation:  0.02786087989807129
mini_batch_src_global generation:  0.054086923599243164
r_  generation:  0.4330103397369385
local_output_nid generation:  0.03064274787902832
local_in_edges_tensor generation:  0.033158302307128906
mini_batch_src_global generation:  0.05169248580932617
r_  generation:  0.4401435852050781
local_output_nid generation:  0.030521869659423828
local_in_edges_tensor generation:  0.030512571334838867
mini_batch_src_global generation:  0.05270552635192871
r_  generation:  0.44853854179382324
local_output_nid generation:  0.030059099197387695
local_in_edges_tensor generation:  0.030803203582763672
mini_batch_src_global generation:  0.05202960968017578
r_  generation:  0.4381294250488281
local_output_nid generation:  0.03014230728149414
local_in_edges_tensor generation:  0.02811741828918457
mini_batch_src_global generation:  0.052127838134765625
r_  generation:  0.4343836307525635
local_output_nid generation:  0.029967546463012695
local_in_edges_tensor generation:  0.03165793418884277
mini_batch_src_global generation:  0.05119013786315918
r_  generation:  0.4313793182373047
local_output_nid generation:  0.029951095581054688
local_in_edges_tensor generation:  0.028242826461791992
mini_batch_src_global generation:  0.05164957046508789
r_  generation:  0.43561744689941406
local_output_nid generation:  0.03035879135131836
local_in_edges_tensor generation:  0.029528379440307617
mini_batch_src_global generation:  0.05090951919555664
r_  generation:  0.4368131160736084
local_output_nid generation:  0.0303804874420166
local_in_edges_tensor generation:  0.03221893310546875
mini_batch_src_global generation:  0.05223584175109863
r_  generation:  0.43767786026000977
local_output_nid generation:  0.030716896057128906
local_in_edges_tensor generation:  0.030774831771850586
mini_batch_src_global generation:  0.05182766914367676
r_  generation:  0.43636012077331543
local_output_nid generation:  0.030261754989624023
local_in_edges_tensor generation:  0.02877664566040039
mini_batch_src_global generation:  0.054056644439697266
r_  generation:  0.4310483932495117
local_output_nid generation:  0.030637025833129883
local_in_edges_tensor generation:  0.02799057960510254
mini_batch_src_global generation:  0.05130648612976074
r_  generation:  0.4360814094543457
local_output_nid generation:  0.03018784523010254
local_in_edges_tensor generation:  0.0285642147064209
mini_batch_src_global generation:  0.05210280418395996
r_  generation:  0.43648195266723633
local_output_nid generation:  0.030858755111694336
local_in_edges_tensor generation:  0.027039051055908203
mini_batch_src_global generation:  0.05168294906616211
r_  generation:  0.43868112564086914
local_output_nid generation:  0.03201937675476074
local_in_edges_tensor generation:  0.033121347427368164
mini_batch_src_global generation:  0.05212903022766113
r_  generation:  0.4400448799133301
local_output_nid generation:  0.031830549240112305
local_in_edges_tensor generation:  0.029681921005249023
mini_batch_src_global generation:  0.051910400390625
r_  generation:  0.43931102752685547
local_output_nid generation:  0.030550479888916016
local_in_edges_tensor generation:  0.0300290584564209
mini_batch_src_global generation:  0.052249908447265625
r_  generation:  0.43863606452941895
local_output_nid generation:  0.030265092849731445
local_in_edges_tensor generation:  0.02752232551574707
mini_batch_src_global generation:  0.05151677131652832
r_  generation:  0.4388728141784668
local_output_nid generation:  0.030547380447387695
local_in_edges_tensor generation:  0.029718399047851562
mini_batch_src_global generation:  0.0536799430847168
r_  generation:  0.4399406909942627
----------------------check_connections_block total spend ----------------------------- 20.761794328689575
generate_one_block  0.6033833026885986
generate_one_block  0.5881814956665039
generate_one_block  0.589754581451416
generate_one_block  0.5836269855499268
generate_one_block  0.6834456920623779
generate_one_block  0.5906944274902344
generate_one_block  0.5821826457977295
generate_one_block  0.5837123394012451
generate_one_block  0.5890889167785645
generate_one_block  0.5900897979736328
generate_one_block  0.579653263092041
generate_one_block  0.5874998569488525
generate_one_block  0.5798695087432861
generate_one_block  0.5880670547485352
generate_one_block  0.5929489135742188
generate_one_block  0.595379114151001
generate_one_block  0.5836284160614014
generate_one_block  0.5912673473358154
generate_one_block  0.5775482654571533
generate_one_block  0.5859568119049072
generate_one_block  0.5894811153411865
generate_one_block  0.5821547508239746
generate_one_block  0.597553014755249
generate_one_block  0.5779125690460205
generate_one_block  0.6041438579559326
generate_one_block  0.5813083648681641
generate_one_block  0.5899784564971924
generate_one_block  0.5965242385864258
generate_one_block  0.5875661373138428
generate_one_block  0.5821692943572998
generate_one_block  0.5853378772735596
generate_one_block  0.5999627113342285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12595319747924805  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

connection checking time:  29.396867036819458
block generation total time  26.918028354644775
average batch blocks generation time:  0.8411883860826492
block dataloader generation time/epoch 59.9112850189209
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10677576065063477  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.13397216796875  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10649776458740234  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.945398330688477  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10661458969116211  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.25264263153076  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1068878173828125  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.253754138946533  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10640859603881836  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.69415855407715  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10695934295654297  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.065110206604004  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10662555694580078  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.937891483306885  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10635137557983398  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.938708782196045  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10615205764770508  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.507515907287598  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10661554336547852  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.321269512176514  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10602378845214844  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.33111810684204  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10677385330200195  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.807281970977783  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10617494583129883  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.737576484680176  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10678482055664062  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.922665119171143  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10711240768432617  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.48841094970703  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10685062408447266  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.1775860786438  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10656070709228516  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.220147609710693  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1066431999206543  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.12726926803589  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10622882843017578  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.44693660736084  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10649633407592773  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.807610511779785  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10650634765625  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.488189220428467  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10655498504638672  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.91805124282837  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1067819595336914  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.060333728790283  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10600519180297852  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.650184154510498  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10667896270751953  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.87890625  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1064605712890625  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.503851890563965  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10680437088012695  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.870742321014404  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10704278945922852  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.283960342407227  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10687637329101562  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.969974040985107  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10655879974365234  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.90471315383911  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10637903213500977  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.643784523010254  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10689449310302734  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.13228702545166  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030877038836479187 |0.021349333226680756 |0.5565219819545746 |9.576976299285889e-05 |1.0636365786194801 |0.006369352340698242 |
----------------------------------------------------------pseudo_mini_loss sum 1.5279490947723389
Total (block generation + training)time/epoch 113.70024175643921
Training time/epoch 53.589213371276855
Training time without block to device /epoch 52.90603470802307
Training time without total dataloading part /epoch 51.85450792312622
load block tensor time/epoch 0.988065242767334
block to device time/epoch 0.6831786632537842
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  9113193
Number of first layer input nodes during this epoch:  4761418
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12756776809692383  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028347492218017578
range selection method range initialization spend 0.015328168869018555
time for parepare:  0.025943994522094727
local_output_nid generation:  0.0012505054473876953
local_in_edges_tensor generation:  0.007687091827392578
mini_batch_src_global generation:  0.0020983219146728516
r_  generation:  0.010673999786376953
local_output_nid generation:  0.001004934310913086
local_in_edges_tensor generation:  0.0007638931274414062
mini_batch_src_global generation:  0.001882314682006836
r_  generation:  0.011932611465454102
local_output_nid generation:  0.0010173320770263672
local_in_edges_tensor generation:  0.0007448196411132812
mini_batch_src_global generation:  0.0014238357543945312
r_  generation:  0.010351181030273438
local_output_nid generation:  0.0010292530059814453
local_in_edges_tensor generation:  0.0006871223449707031
mini_batch_src_global generation:  0.0012371540069580078
r_  generation:  0.010017633438110352
local_output_nid generation:  0.0010457038879394531
local_in_edges_tensor generation:  0.0006625652313232422
mini_batch_src_global generation:  0.0013561248779296875
r_  generation:  0.01056671142578125
local_output_nid generation:  0.0010635852813720703
local_in_edges_tensor generation:  0.0006952285766601562
mini_batch_src_global generation:  0.0012791156768798828
r_  generation:  0.010423660278320312
local_output_nid generation:  0.0010581016540527344
local_in_edges_tensor generation:  0.0006618499755859375
mini_batch_src_global generation:  0.0012717247009277344
r_  generation:  0.010561943054199219
local_output_nid generation:  0.0010845661163330078
local_in_edges_tensor generation:  0.0007269382476806641
mini_batch_src_global generation:  0.0015418529510498047
r_  generation:  0.010802268981933594
local_output_nid generation:  0.0010366439819335938
local_in_edges_tensor generation:  0.0006916522979736328
mini_batch_src_global generation:  0.0013775825500488281
r_  generation:  0.010715961456298828
local_output_nid generation:  0.0010433197021484375
local_in_edges_tensor generation:  0.0007607936859130859
mini_batch_src_global generation:  0.0012559890747070312
r_  generation:  0.010394096374511719
local_output_nid generation:  0.0010983943939208984
local_in_edges_tensor generation:  0.0006694793701171875
mini_batch_src_global generation:  0.0014505386352539062
r_  generation:  0.010534048080444336
local_output_nid generation:  0.0010409355163574219
local_in_edges_tensor generation:  0.0006566047668457031
mini_batch_src_global generation:  0.0012958049774169922
r_  generation:  0.010768651962280273
local_output_nid generation:  0.0010464191436767578
local_in_edges_tensor generation:  0.0006644725799560547
mini_batch_src_global generation:  0.0013363361358642578
r_  generation:  0.010715723037719727
local_output_nid generation:  0.0010440349578857422
local_in_edges_tensor generation:  0.0007195472717285156
mini_batch_src_global generation:  0.001325368881225586
r_  generation:  0.010704755783081055
local_output_nid generation:  0.00104522705078125
local_in_edges_tensor generation:  0.0006656646728515625
mini_batch_src_global generation:  0.0012729167938232422
r_  generation:  0.010775089263916016
local_output_nid generation:  0.0010797977447509766
local_in_edges_tensor generation:  0.0006492137908935547
mini_batch_src_global generation:  0.001470804214477539
r_  generation:  0.010629892349243164
local_output_nid generation:  0.0010609626770019531
local_in_edges_tensor generation:  0.0006670951843261719
mini_batch_src_global generation:  0.0013582706451416016
r_  generation:  0.010846138000488281
local_output_nid generation:  0.0010089874267578125
local_in_edges_tensor generation:  0.000640869140625
mini_batch_src_global generation:  0.0012786388397216797
r_  generation:  0.010589122772216797
local_output_nid generation:  0.0009961128234863281
local_in_edges_tensor generation:  0.0007638931274414062
mini_batch_src_global generation:  0.0014004707336425781
r_  generation:  0.01117086410522461
local_output_nid generation:  0.0009722709655761719
local_in_edges_tensor generation:  0.0007226467132568359
mini_batch_src_global generation:  0.0014522075653076172
r_  generation:  0.01078343391418457
local_output_nid generation:  0.0009963512420654297
local_in_edges_tensor generation:  0.0006711483001708984
mini_batch_src_global generation:  0.0013232231140136719
r_  generation:  0.010424375534057617
local_output_nid generation:  0.0010082721710205078
local_in_edges_tensor generation:  0.0006685256958007812
mini_batch_src_global generation:  0.0014464855194091797
r_  generation:  0.010649919509887695
local_output_nid generation:  0.0009925365447998047
local_in_edges_tensor generation:  0.0006568431854248047
mini_batch_src_global generation:  0.0013120174407958984
r_  generation:  0.010521888732910156
local_output_nid generation:  0.0010352134704589844
local_in_edges_tensor generation:  0.0006387233734130859
mini_batch_src_global generation:  0.0012743473052978516
r_  generation:  0.010394811630249023
local_output_nid generation:  0.0009891986846923828
local_in_edges_tensor generation:  0.0007226467132568359
mini_batch_src_global generation:  0.0013730525970458984
r_  generation:  0.010832786560058594
local_output_nid generation:  0.0009930133819580078
local_in_edges_tensor generation:  0.0006783008575439453
mini_batch_src_global generation:  0.0013616085052490234
r_  generation:  0.01057744026184082
local_output_nid generation:  0.0010058879852294922
local_in_edges_tensor generation:  0.00066375732421875
mini_batch_src_global generation:  0.001360177993774414
r_  generation:  0.010468482971191406
local_output_nid generation:  0.0009989738464355469
local_in_edges_tensor generation:  0.00064849853515625
mini_batch_src_global generation:  0.0013287067413330078
r_  generation:  0.010375738143920898
local_output_nid generation:  0.0010251998901367188
local_in_edges_tensor generation:  0.0006978511810302734
mini_batch_src_global generation:  0.0013191699981689453
r_  generation:  0.01030874252319336
local_output_nid generation:  0.0009908676147460938
local_in_edges_tensor generation:  0.0006520748138427734
mini_batch_src_global generation:  0.0013127326965332031
r_  generation:  0.01062631607055664
local_output_nid generation:  0.001026153564453125
local_in_edges_tensor generation:  0.0006537437438964844
mini_batch_src_global generation:  0.0014710426330566406
r_  generation:  0.010334253311157227
local_output_nid generation:  0.0009756088256835938
local_in_edges_tensor generation:  0.0006546974182128906
mini_batch_src_global generation:  0.0013251304626464844
r_  generation:  0.010165214538574219
----------------------check_connections_block total spend ----------------------------- 0.5581798553466797
generate_one_block  0.036302804946899414
generate_one_block  0.021811962127685547
generate_one_block  0.02465367317199707
generate_one_block  0.018676280975341797
generate_one_block  0.019170522689819336
generate_one_block  0.018645286560058594
generate_one_block  0.018757104873657227
generate_one_block  0.02375173568725586
generate_one_block  0.01896953582763672
generate_one_block  0.018216848373413086
generate_one_block  0.018600940704345703
generate_one_block  0.018898487091064453
generate_one_block  0.020612716674804688
generate_one_block  0.018999576568603516
generate_one_block  0.018453359603881836
generate_one_block  0.018507719039916992
generate_one_block  0.01865220069885254
generate_one_block  0.0185546875
generate_one_block  0.01973128318786621
generate_one_block  0.019176959991455078
generate_one_block  0.018087148666381836
generate_one_block  0.019064903259277344
generate_one_block  0.02100229263305664
generate_one_block  0.02058124542236328
generate_one_block  0.019025564193725586
generate_one_block  0.018625974655151367
generate_one_block  0.018240690231323242
generate_one_block  0.018088579177856445
generate_one_block  0.019957780838012695
generate_one_block  0.018756628036499023
generate_one_block  0.018280029296875
generate_one_block  0.01819777488708496
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07771778106689453
gen group dst list time:  0.024330854415893555
time for parepare:  0.022884845733642578
local_output_nid generation:  0.0057523250579833984
local_in_edges_tensor generation:  0.017731904983520508
mini_batch_src_global generation:  0.01912975311279297
r_  generation:  0.16137981414794922
local_output_nid generation:  0.007978439331054688
local_in_edges_tensor generation:  0.011173725128173828
mini_batch_src_global generation:  0.022114276885986328
r_  generation:  0.17521429061889648
local_output_nid generation:  0.007938861846923828
local_in_edges_tensor generation:  0.03307962417602539
mini_batch_src_global generation:  0.02908945083618164
r_  generation:  0.17551302909851074
local_output_nid generation:  0.009070396423339844
local_in_edges_tensor generation:  0.008412361145019531
mini_batch_src_global generation:  0.020659923553466797
r_  generation:  0.1720113754272461
local_output_nid generation:  0.008937358856201172
local_in_edges_tensor generation:  0.009347677230834961
mini_batch_src_global generation:  0.02354121208190918
r_  generation:  0.17972302436828613
local_output_nid generation:  0.009040117263793945
local_in_edges_tensor generation:  0.008922100067138672
mini_batch_src_global generation:  0.02213883399963379
r_  generation:  0.17821693420410156
local_output_nid generation:  0.009319543838500977
local_in_edges_tensor generation:  0.009001970291137695
mini_batch_src_global generation:  0.02290821075439453
r_  generation:  0.17936205863952637
local_output_nid generation:  0.008894920349121094
local_in_edges_tensor generation:  0.011942625045776367
mini_batch_src_global generation:  0.0276031494140625
r_  generation:  0.2405104637145996
local_output_nid generation:  0.00858306884765625
local_in_edges_tensor generation:  0.008678436279296875
mini_batch_src_global generation:  0.03661227226257324
r_  generation:  0.18225383758544922
local_output_nid generation:  0.008919715881347656
local_in_edges_tensor generation:  0.008500814437866211
mini_batch_src_global generation:  0.022609710693359375
r_  generation:  0.17768144607543945
local_output_nid generation:  0.009184598922729492
local_in_edges_tensor generation:  0.008519887924194336
mini_batch_src_global generation:  0.02325272560119629
r_  generation:  0.18037772178649902
local_output_nid generation:  0.009316682815551758
local_in_edges_tensor generation:  0.008923053741455078
mini_batch_src_global generation:  0.023143768310546875
r_  generation:  0.1834266185760498
local_output_nid generation:  0.009236574172973633
local_in_edges_tensor generation:  0.00933384895324707
mini_batch_src_global generation:  0.023696422576904297
r_  generation:  0.1826636791229248
local_output_nid generation:  0.011405467987060547
local_in_edges_tensor generation:  0.009576559066772461
mini_batch_src_global generation:  0.02342963218688965
r_  generation:  0.1925203800201416
local_output_nid generation:  0.00915217399597168
local_in_edges_tensor generation:  0.009345769882202148
mini_batch_src_global generation:  0.023689985275268555
r_  generation:  0.22242999076843262
local_output_nid generation:  0.015473127365112305
local_in_edges_tensor generation:  0.012604236602783203
mini_batch_src_global generation:  0.029448986053466797
r_  generation:  0.1919112205505371
local_output_nid generation:  0.010164976119995117
local_in_edges_tensor generation:  0.00971078872680664
mini_batch_src_global generation:  0.023973464965820312
r_  generation:  0.18500685691833496
local_output_nid generation:  0.00957489013671875
local_in_edges_tensor generation:  0.009554624557495117
mini_batch_src_global generation:  0.02359938621520996
r_  generation:  0.19416546821594238
local_output_nid generation:  0.009826421737670898
local_in_edges_tensor generation:  0.00963902473449707
mini_batch_src_global generation:  0.024399280548095703
r_  generation:  0.1887364387512207
local_output_nid generation:  0.009680509567260742
local_in_edges_tensor generation:  0.009899616241455078
mini_batch_src_global generation:  0.02416825294494629
r_  generation:  0.1920933723449707
local_output_nid generation:  0.009027242660522461
local_in_edges_tensor generation:  0.008496284484863281
mini_batch_src_global generation:  0.0259091854095459
r_  generation:  0.17558860778808594
local_output_nid generation:  0.009804010391235352
local_in_edges_tensor generation:  0.008890390396118164
mini_batch_src_global generation:  0.0248410701751709
r_  generation:  0.18925881385803223
local_output_nid generation:  0.009143352508544922
local_in_edges_tensor generation:  0.0086822509765625
mini_batch_src_global generation:  0.023364782333374023
r_  generation:  0.17946958541870117
local_output_nid generation:  0.009096622467041016
local_in_edges_tensor generation:  0.008402585983276367
mini_batch_src_global generation:  0.022458553314208984
r_  generation:  0.17937469482421875
local_output_nid generation:  0.009493827819824219
local_in_edges_tensor generation:  0.009920358657836914
mini_batch_src_global generation:  0.024098873138427734
r_  generation:  0.19189977645874023
local_output_nid generation:  0.009525299072265625
local_in_edges_tensor generation:  0.009562492370605469
mini_batch_src_global generation:  0.023311376571655273
r_  generation:  0.18865323066711426
local_output_nid generation:  0.009183883666992188
local_in_edges_tensor generation:  0.012305021286010742
mini_batch_src_global generation:  0.025645017623901367
r_  generation:  0.1827540397644043
local_output_nid generation:  0.010176420211791992
local_in_edges_tensor generation:  0.012124300003051758
mini_batch_src_global generation:  0.02220940589904785
r_  generation:  0.18576812744140625
local_output_nid generation:  0.00927281379699707
local_in_edges_tensor generation:  0.011071205139160156
mini_batch_src_global generation:  0.024731874465942383
r_  generation:  0.18772459030151367
local_output_nid generation:  0.009363889694213867
local_in_edges_tensor generation:  0.010783672332763672
mini_batch_src_global generation:  0.023543834686279297
r_  generation:  0.18569421768188477
local_output_nid generation:  0.009326696395874023
local_in_edges_tensor generation:  0.011675596237182617
mini_batch_src_global generation:  0.023270606994628906
r_  generation:  0.18433618545532227
local_output_nid generation:  0.009384632110595703
local_in_edges_tensor generation:  0.009636163711547852
mini_batch_src_global generation:  0.022809505462646484
r_  generation:  0.19226789474487305
----------------------check_connections_block total spend ----------------------------- 8.747830867767334
generate_one_block  0.2613835334777832
generate_one_block  0.2518582344055176
generate_one_block  0.2452073097229004
generate_one_block  0.23883557319641113
generate_one_block  0.26850080490112305
generate_one_block  0.24474525451660156
generate_one_block  0.24582362174987793
generate_one_block  0.2580885887145996
generate_one_block  0.26745104789733887
generate_one_block  0.24245452880859375
generate_one_block  0.24782514572143555
generate_one_block  0.25209641456604004
generate_one_block  0.25023841857910156
generate_one_block  0.25462913513183594
generate_one_block  0.24811244010925293
generate_one_block  0.25370025634765625
generate_one_block  0.2566213607788086
generate_one_block  0.25763630867004395
generate_one_block  0.2607886791229248
generate_one_block  0.26825380325317383
generate_one_block  0.24030256271362305
generate_one_block  0.2567458152770996
generate_one_block  0.2424945831298828
generate_one_block  0.23824214935302734
generate_one_block  0.2635829448699951
generate_one_block  0.25228142738342285
generate_one_block  0.24107789993286133
generate_one_block  0.23460030555725098
generate_one_block  0.24500441551208496
generate_one_block  0.24853920936584473
generate_one_block  0.24692916870117188
generate_one_block  0.24314308166503906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0395207405090332
gen group dst list time:  0.11731433868408203
time for parepare:  0.019100427627563477
local_output_nid generation:  0.02591729164123535
local_in_edges_tensor generation:  0.048589229583740234
mini_batch_src_global generation:  0.040433645248413086
r_  generation:  0.4290730953216553
local_output_nid generation:  0.030808687210083008
local_in_edges_tensor generation:  0.0353093147277832
mini_batch_src_global generation:  0.05080676078796387
r_  generation:  0.4377920627593994
local_output_nid generation:  0.030821800231933594
local_in_edges_tensor generation:  0.03035759925842285
mini_batch_src_global generation:  0.0495607852935791
r_  generation:  0.43845391273498535
local_output_nid generation:  0.031152963638305664
local_in_edges_tensor generation:  0.028642892837524414
mini_batch_src_global generation:  0.05221247673034668
r_  generation:  0.43094635009765625
local_output_nid generation:  0.03089141845703125
local_in_edges_tensor generation:  0.03192257881164551
mini_batch_src_global generation:  0.0500941276550293
r_  generation:  0.4418449401855469
local_output_nid generation:  0.030994653701782227
local_in_edges_tensor generation:  0.028891563415527344
mini_batch_src_global generation:  0.05470108985900879
r_  generation:  0.436018705368042
local_output_nid generation:  0.03079509735107422
local_in_edges_tensor generation:  0.030548572540283203
mini_batch_src_global generation:  0.051267385482788086
r_  generation:  0.4404160976409912
local_output_nid generation:  0.03205394744873047
local_in_edges_tensor generation:  0.031029462814331055
mini_batch_src_global generation:  0.051500558853149414
r_  generation:  0.43952393531799316
local_output_nid generation:  0.02991485595703125
local_in_edges_tensor generation:  0.030186176300048828
mini_batch_src_global generation:  0.051699161529541016
r_  generation:  0.44716525077819824
local_output_nid generation:  0.029664993286132812
local_in_edges_tensor generation:  0.029295921325683594
mini_batch_src_global generation:  0.05426192283630371
r_  generation:  0.4362375736236572
local_output_nid generation:  0.029581069946289062
local_in_edges_tensor generation:  0.027135372161865234
mini_batch_src_global generation:  0.053320884704589844
r_  generation:  0.4425215721130371
local_output_nid generation:  0.02975177764892578
local_in_edges_tensor generation:  0.03088092803955078
mini_batch_src_global generation:  0.052018165588378906
r_  generation:  0.43860960006713867
local_output_nid generation:  0.031682729721069336
local_in_edges_tensor generation:  0.02875971794128418
mini_batch_src_global generation:  0.05144000053405762
r_  generation:  0.4414234161376953
local_output_nid generation:  0.030056238174438477
local_in_edges_tensor generation:  0.030514001846313477
mini_batch_src_global generation:  0.05235624313354492
r_  generation:  0.43586206436157227
local_output_nid generation:  0.0299832820892334
local_in_edges_tensor generation:  0.029573917388916016
mini_batch_src_global generation:  0.05101609230041504
r_  generation:  0.4414389133453369
local_output_nid generation:  0.029831409454345703
local_in_edges_tensor generation:  0.03098607063293457
mini_batch_src_global generation:  0.0651397705078125
r_  generation:  0.4468820095062256
local_output_nid generation:  0.031972646713256836
local_in_edges_tensor generation:  0.029241561889648438
mini_batch_src_global generation:  0.05273699760437012
r_  generation:  0.4414188861846924
local_output_nid generation:  0.030687808990478516
local_in_edges_tensor generation:  0.02895522117614746
mini_batch_src_global generation:  0.05212044715881348
r_  generation:  0.43880653381347656
local_output_nid generation:  0.03082585334777832
local_in_edges_tensor generation:  0.027353525161743164
mini_batch_src_global generation:  0.05330467224121094
r_  generation:  0.444551944732666
local_output_nid generation:  0.03107142448425293
local_in_edges_tensor generation:  0.029226064682006836
mini_batch_src_global generation:  0.052310943603515625
r_  generation:  0.4373154640197754
local_output_nid generation:  0.03000617027282715
local_in_edges_tensor generation:  0.042482852935791016
mini_batch_src_global generation:  0.050650596618652344
r_  generation:  0.43746328353881836
local_output_nid generation:  0.030471086502075195
local_in_edges_tensor generation:  0.0273895263671875
mini_batch_src_global generation:  0.052321434020996094
r_  generation:  0.4349839687347412
local_output_nid generation:  0.030278444290161133
local_in_edges_tensor generation:  0.026453256607055664
mini_batch_src_global generation:  0.05121636390686035
r_  generation:  0.43906116485595703
local_output_nid generation:  0.03061699867248535
local_in_edges_tensor generation:  0.027881383895874023
mini_batch_src_global generation:  0.052045345306396484
r_  generation:  0.4326295852661133
local_output_nid generation:  0.030332088470458984
local_in_edges_tensor generation:  0.02632427215576172
mini_batch_src_global generation:  0.05633974075317383
r_  generation:  0.4409294128417969
local_output_nid generation:  0.03232598304748535
local_in_edges_tensor generation:  0.02832627296447754
mini_batch_src_global generation:  0.05403423309326172
r_  generation:  0.43502283096313477
local_output_nid generation:  0.030314207077026367
local_in_edges_tensor generation:  0.02714085578918457
mini_batch_src_global generation:  0.05151867866516113
r_  generation:  0.44437265396118164
local_output_nid generation:  0.030504941940307617
local_in_edges_tensor generation:  0.03200197219848633
mini_batch_src_global generation:  0.05197024345397949
r_  generation:  0.43561434745788574
local_output_nid generation:  0.03013324737548828
local_in_edges_tensor generation:  0.026932477951049805
mini_batch_src_global generation:  0.050818681716918945
r_  generation:  0.44428491592407227
local_output_nid generation:  0.03160977363586426
local_in_edges_tensor generation:  0.028799772262573242
mini_batch_src_global generation:  0.05439615249633789
r_  generation:  0.4376058578491211
local_output_nid generation:  0.03245186805725098
local_in_edges_tensor generation:  0.029679298400878906
mini_batch_src_global generation:  0.05165982246398926
r_  generation:  0.44062376022338867
local_output_nid generation:  0.03048849105834961
local_in_edges_tensor generation:  0.02887558937072754
mini_batch_src_global generation:  0.053746700286865234
r_  generation:  0.4404127597808838
----------------------check_connections_block total spend ----------------------------- 20.866163969039917
generate_one_block  0.6031148433685303
generate_one_block  0.5899145603179932
generate_one_block  0.5802385807037354
generate_one_block  0.5815517902374268
generate_one_block  0.6823892593383789
generate_one_block  0.5850808620452881
generate_one_block  0.5876915454864502
generate_one_block  0.591242790222168
generate_one_block  0.5893726348876953
generate_one_block  0.5839657783508301
generate_one_block  0.5834476947784424
generate_one_block  0.5889942646026611
generate_one_block  0.5882081985473633
generate_one_block  0.5902938842773438
generate_one_block  0.5899477005004883
generate_one_block  0.5879168510437012
generate_one_block  0.5897679328918457
generate_one_block  0.586216926574707
generate_one_block  0.5923182964324951
generate_one_block  0.5871481895446777
generate_one_block  0.592310905456543
generate_one_block  0.5886011123657227
generate_one_block  0.585831880569458
generate_one_block  0.5848293304443359
generate_one_block  0.6070280075073242
generate_one_block  0.5902717113494873
generate_one_block  0.5833277702331543
generate_one_block  0.5804815292358398
generate_one_block  0.5875020027160645
generate_one_block  0.6017322540283203
generate_one_block  0.5856437683105469
generate_one_block  0.5841915607452393
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12756776809692383  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

connection checking time:  29.61399483680725
block generation total time  26.957768440246582
average batch blocks generation time:  0.8424302637577057
block dataloader generation time/epoch 59.93440067768097
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10625457763671875  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.680662155151367  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10684490203857422  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.068291187286377  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10635709762573242  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.81311559677124  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10639238357543945  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.639577388763428  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1064906120300293  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.033462524414062  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10664558410644531  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.830252170562744  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10657644271850586  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.9215726852417  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10704183578491211  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.373969554901123  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1066288948059082  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.062271118164062  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10636615753173828  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.585463047027588  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10640192031860352  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.815030574798584  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10671377182006836  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.032560348510742  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10663890838623047  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.928526878356934  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10676240921020508  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.184170246124268  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10641765594482422  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.88373374938965  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10685110092163086  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.09288215637207  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10687828063964844  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.194467067718506  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10652923583984375  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.13587188720703  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10691070556640625  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.326640605926514  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1070709228515625  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.308741092681885  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10585594177246094  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.31823444366455  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10681438446044922  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.26651954650879  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10640144348144531  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.711105346679688  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10638046264648438  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.559231281280518  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10689544677734375  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.389970302581787  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10644674301147461  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.874256134033203  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10650348663330078  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.66722822189331  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10631227493286133  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.354717254638672  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10635519027709961  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.738207817077637  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1068720817565918  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.941329956054688  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10651493072509766  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.829418182373047  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10661840438842773  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.79875946044922  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03373508155345917 |0.021235324442386627 |0.5565756186842918 |9.653717279434204e-05 |1.0623774006962776 |0.005693197250366211 |
----------------------------------------------------------pseudo_mini_loss sum 1.4957256317138672
Total (block generation + training)time/epoch 113.6982847849528
Training time/epoch 53.63825178146362
Training time without block to device /epoch 52.95872139930725
Training time without total dataloading part /epoch 51.81527900695801
load block tensor time/epoch 1.0795226097106934
block to device time/epoch 0.6795303821563721
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  9113085
Number of first layer input nodes during this epoch:  4760924
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12650632858276367  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024711132049560547
range selection method range initialization spend 0.01669025421142578
time for parepare:  0.020599365234375
local_output_nid generation:  0.0010547637939453125
local_in_edges_tensor generation:  0.006763935089111328
mini_batch_src_global generation:  0.0023040771484375
r_  generation:  0.012433290481567383
local_output_nid generation:  0.0010051727294921875
local_in_edges_tensor generation:  0.0006742477416992188
mini_batch_src_global generation:  0.0016057491302490234
r_  generation:  0.01077127456665039
local_output_nid generation:  0.0009539127349853516
local_in_edges_tensor generation:  0.0005893707275390625
mini_batch_src_global generation:  0.0011360645294189453
r_  generation:  0.009970664978027344
local_output_nid generation:  0.0009281635284423828
local_in_edges_tensor generation:  0.0005872249603271484
mini_batch_src_global generation:  0.001100301742553711
r_  generation:  0.010045051574707031
local_output_nid generation:  0.000911712646484375
local_in_edges_tensor generation:  0.0005810260772705078
mini_batch_src_global generation:  0.0011034011840820312
r_  generation:  0.010075569152832031
local_output_nid generation:  0.000896453857421875
local_in_edges_tensor generation:  0.000579833984375
mini_batch_src_global generation:  0.0011241436004638672
r_  generation:  0.010045766830444336
local_output_nid generation:  0.0008995532989501953
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.0011126995086669922
r_  generation:  0.010231971740722656
local_output_nid generation:  0.0009071826934814453
local_in_edges_tensor generation:  0.0005905628204345703
mini_batch_src_global generation:  0.0011272430419921875
r_  generation:  0.010305166244506836
local_output_nid generation:  0.0008845329284667969
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.001146554946899414
r_  generation:  0.009696483612060547
local_output_nid generation:  0.0008885860443115234
local_in_edges_tensor generation:  0.0005693435668945312
mini_batch_src_global generation:  0.0011463165283203125
r_  generation:  0.009981870651245117
local_output_nid generation:  0.0008795261383056641
local_in_edges_tensor generation:  0.0005705356597900391
mini_batch_src_global generation:  0.0011131763458251953
r_  generation:  0.010153055191040039
local_output_nid generation:  0.0008871555328369141
local_in_edges_tensor generation:  0.0005705356597900391
mini_batch_src_global generation:  0.0011446475982666016
r_  generation:  0.01033782958984375
local_output_nid generation:  0.0008785724639892578
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0011091232299804688
r_  generation:  0.010241985321044922
local_output_nid generation:  0.0008826255798339844
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.0011379718780517578
r_  generation:  0.010298967361450195
local_output_nid generation:  0.00087738037109375
local_in_edges_tensor generation:  0.0005676746368408203
mini_batch_src_global generation:  0.001112222671508789
r_  generation:  0.009954690933227539
local_output_nid generation:  0.0008790493011474609
local_in_edges_tensor generation:  0.0005974769592285156
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.010525941848754883
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.0005645751953125
mini_batch_src_global generation:  0.001201629638671875
r_  generation:  0.010197639465332031
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.010625839233398438
local_output_nid generation:  0.0008754730224609375
local_in_edges_tensor generation:  0.0005803108215332031
mini_batch_src_global generation:  0.0012326240539550781
r_  generation:  0.010480642318725586
local_output_nid generation:  0.0008864402770996094
local_in_edges_tensor generation:  0.0006091594696044922
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.010684967041015625
local_output_nid generation:  0.0008842945098876953
local_in_edges_tensor generation:  0.0005714893341064453
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.009884119033813477
local_output_nid generation:  0.0008828639984130859
local_in_edges_tensor generation:  0.0005671977996826172
mini_batch_src_global generation:  0.0012118816375732422
r_  generation:  0.010279178619384766
local_output_nid generation:  0.0008671283721923828
local_in_edges_tensor generation:  0.0005705356597900391
mini_batch_src_global generation:  0.0011785030364990234
r_  generation:  0.010490655899047852
local_output_nid generation:  0.0008838176727294922
local_in_edges_tensor generation:  0.0005743503570556641
mini_batch_src_global generation:  0.0012290477752685547
r_  generation:  0.010399103164672852
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.0011928081512451172
r_  generation:  0.010486125946044922
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0012464523315429688
r_  generation:  0.010493278503417969
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.01039576530456543
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0012009143829345703
r_  generation:  0.009990692138671875
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005550384521484375
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.010461807250976562
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0005631446838378906
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.009979963302612305
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005593299865722656
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.010454416275024414
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.001184701919555664
r_  generation:  0.009824275970458984
----------------------check_connections_block total spend ----------------------------- 0.5241830348968506
generate_one_block  0.025681495666503906
generate_one_block  0.020812511444091797
generate_one_block  0.019094228744506836
generate_one_block  0.018781661987304688
generate_one_block  0.018802881240844727
generate_one_block  0.0184173583984375
generate_one_block  0.018683671951293945
generate_one_block  0.018661975860595703
generate_one_block  0.017586469650268555
generate_one_block  0.018001079559326172
generate_one_block  0.018409013748168945
generate_one_block  0.01876211166381836
generate_one_block  0.018270254135131836
generate_one_block  0.018527507781982422
generate_one_block  0.01772618293762207
generate_one_block  0.01893925666809082
generate_one_block  0.018355131149291992
generate_one_block  0.018963336944580078
generate_one_block  0.018590450286865234
generate_one_block  0.019057750701904297
generate_one_block  0.017652511596679688
generate_one_block  0.018453598022460938
generate_one_block  0.021033287048339844
generate_one_block  0.018976926803588867
generate_one_block  0.018756389617919922
generate_one_block  0.0187985897064209
generate_one_block  0.01865386962890625
generate_one_block  0.01785755157470703
generate_one_block  0.01870131492614746
generate_one_block  0.017734527587890625
generate_one_block  0.018671512603759766
generate_one_block  0.017580032348632812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040056467056274414
gen group dst list time:  0.023276329040527344
time for parepare:  0.022711753845214844
local_output_nid generation:  0.005854606628417969
local_in_edges_tensor generation:  0.018190860748291016
mini_batch_src_global generation:  0.018845081329345703
r_  generation:  0.16398882865905762
local_output_nid generation:  0.007982015609741211
local_in_edges_tensor generation:  0.010799407958984375
mini_batch_src_global generation:  0.02249908447265625
r_  generation:  0.1659700870513916
local_output_nid generation:  0.008069992065429688
local_in_edges_tensor generation:  0.03394675254821777
mini_batch_src_global generation:  0.02167224884033203
r_  generation:  0.17107892036437988
local_output_nid generation:  0.008391857147216797
local_in_edges_tensor generation:  0.01161503791809082
mini_batch_src_global generation:  0.02123093605041504
r_  generation:  0.17392659187316895
local_output_nid generation:  0.008849143981933594
local_in_edges_tensor generation:  0.011618614196777344
mini_batch_src_global generation:  0.0239408016204834
r_  generation:  0.18103718757629395
local_output_nid generation:  0.008779287338256836
local_in_edges_tensor generation:  0.008621454238891602
mini_batch_src_global generation:  0.022735118865966797
r_  generation:  0.17787432670593262
local_output_nid generation:  0.008922100067138672
local_in_edges_tensor generation:  0.008773088455200195
mini_batch_src_global generation:  0.023810863494873047
r_  generation:  0.18094110488891602
local_output_nid generation:  0.008798837661743164
local_in_edges_tensor generation:  0.008787155151367188
mini_batch_src_global generation:  0.02344799041748047
r_  generation:  0.18311309814453125
local_output_nid generation:  0.008323431015014648
local_in_edges_tensor generation:  0.011200428009033203
mini_batch_src_global generation:  0.0233914852142334
r_  generation:  0.17253494262695312
local_output_nid generation:  0.008882522583007812
local_in_edges_tensor generation:  0.008669376373291016
mini_batch_src_global generation:  0.02357172966003418
r_  generation:  0.1792306900024414
local_output_nid generation:  0.009007453918457031
local_in_edges_tensor generation:  0.00968790054321289
mini_batch_src_global generation:  0.022826671600341797
r_  generation:  0.21729373931884766
local_output_nid generation:  0.014602422714233398
local_in_edges_tensor generation:  0.012995243072509766
mini_batch_src_global generation:  0.030318737030029297
r_  generation:  0.18473577499389648
local_output_nid generation:  0.011697530746459961
local_in_edges_tensor generation:  0.008549928665161133
mini_batch_src_global generation:  0.0235140323638916
r_  generation:  0.18118023872375488
local_output_nid generation:  0.009945154190063477
local_in_edges_tensor generation:  0.008897542953491211
mini_batch_src_global generation:  0.02388620376586914
r_  generation:  0.22704577445983887
local_output_nid generation:  0.013969182968139648
local_in_edges_tensor generation:  0.011635780334472656
mini_batch_src_global generation:  0.028333425521850586
r_  generation:  0.192732572555542
local_output_nid generation:  0.011036157608032227
local_in_edges_tensor generation:  0.010726690292358398
mini_batch_src_global generation:  0.024892091751098633
r_  generation:  0.19339728355407715
local_output_nid generation:  0.01054692268371582
local_in_edges_tensor generation:  0.009986639022827148
mini_batch_src_global generation:  0.026465654373168945
r_  generation:  0.18931150436401367
local_output_nid generation:  0.009721994400024414
local_in_edges_tensor generation:  0.012339591979980469
mini_batch_src_global generation:  0.025696992874145508
r_  generation:  0.19405603408813477
local_output_nid generation:  0.00926971435546875
local_in_edges_tensor generation:  0.014147043228149414
mini_batch_src_global generation:  0.024199247360229492
r_  generation:  0.20473074913024902
local_output_nid generation:  0.009521961212158203
local_in_edges_tensor generation:  0.010591983795166016
mini_batch_src_global generation:  0.026362180709838867
r_  generation:  0.19159817695617676
local_output_nid generation:  0.008966922760009766
local_in_edges_tensor generation:  0.017360925674438477
mini_batch_src_global generation:  0.022803068161010742
r_  generation:  0.1797466278076172
local_output_nid generation:  0.009293317794799805
local_in_edges_tensor generation:  0.009061574935913086
mini_batch_src_global generation:  0.02579474449157715
r_  generation:  0.19657421112060547
local_output_nid generation:  0.011468172073364258
local_in_edges_tensor generation:  0.009409904479980469
mini_batch_src_global generation:  0.023374080657958984
r_  generation:  0.18297934532165527
local_output_nid generation:  0.00946187973022461
local_in_edges_tensor generation:  0.009987354278564453
mini_batch_src_global generation:  0.024374961853027344
r_  generation:  0.18653535842895508
local_output_nid generation:  0.009654760360717773
local_in_edges_tensor generation:  0.008851766586303711
mini_batch_src_global generation:  0.023255109786987305
r_  generation:  0.1857001781463623
local_output_nid generation:  0.009656190872192383
local_in_edges_tensor generation:  0.009800434112548828
mini_batch_src_global generation:  0.024954557418823242
r_  generation:  0.18790340423583984
local_output_nid generation:  0.009396553039550781
local_in_edges_tensor generation:  0.00889730453491211
mini_batch_src_global generation:  0.023694753646850586
r_  generation:  0.18573451042175293
local_output_nid generation:  0.009140729904174805
local_in_edges_tensor generation:  0.010136842727661133
mini_batch_src_global generation:  0.023920774459838867
r_  generation:  0.17918848991394043
local_output_nid generation:  0.009488582611083984
local_in_edges_tensor generation:  0.009267091751098633
mini_batch_src_global generation:  0.02401900291442871
r_  generation:  0.1879887580871582
local_output_nid generation:  0.009098052978515625
local_in_edges_tensor generation:  0.008666753768920898
mini_batch_src_global generation:  0.02281475067138672
r_  generation:  0.17459797859191895
local_output_nid generation:  0.009726524353027344
local_in_edges_tensor generation:  0.008910655975341797
mini_batch_src_global generation:  0.023376941680908203
r_  generation:  0.18710947036743164
local_output_nid generation:  0.009065866470336914
local_in_edges_tensor generation:  0.008560657501220703
mini_batch_src_global generation:  0.022959232330322266
r_  generation:  0.17690396308898926
----------------------check_connections_block total spend ----------------------------- 8.741924524307251
generate_one_block  0.2604644298553467
generate_one_block  0.25072193145751953
generate_one_block  0.2422497272491455
generate_one_block  0.24461960792541504
generate_one_block  0.2680165767669678
generate_one_block  0.24217748641967773
generate_one_block  0.2507607936859131
generate_one_block  0.24854207038879395
generate_one_block  0.23364472389221191
generate_one_block  0.24170804023742676
generate_one_block  0.23889780044555664
generate_one_block  0.24629926681518555
generate_one_block  0.2471325397491455
generate_one_block  0.24805188179016113
generate_one_block  0.23320364952087402
generate_one_block  0.2549757957458496
generate_one_block  0.2515404224395752
generate_one_block  0.2546713352203369
generate_one_block  0.24761104583740234
generate_one_block  0.2577638626098633
generate_one_block  0.2451157569885254
generate_one_block  0.24660396575927734
generate_one_block  0.2522895336151123
generate_one_block  0.2551908493041992
generate_one_block  0.2529256343841553
generate_one_block  0.254331111907959
generate_one_block  0.2544426918029785
generate_one_block  0.241851806640625
generate_one_block  0.25712156295776367
generate_one_block  0.2407360076904297
generate_one_block  0.25603437423706055
generate_one_block  0.235914945602417
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03524661064147949
gen group dst list time:  0.11461257934570312
time for parepare:  0.021754741668701172
local_output_nid generation:  0.026337862014770508
local_in_edges_tensor generation:  0.04755043983459473
mini_batch_src_global generation:  0.04029536247253418
r_  generation:  0.4280087947845459
local_output_nid generation:  0.030535459518432617
local_in_edges_tensor generation:  0.034104347229003906
mini_batch_src_global generation:  0.050874948501586914
r_  generation:  0.4378821849822998
local_output_nid generation:  0.033751487731933594
local_in_edges_tensor generation:  0.03143882751464844
mini_batch_src_global generation:  0.051628828048706055
r_  generation:  0.43343448638916016
local_output_nid generation:  0.031348228454589844
local_in_edges_tensor generation:  0.026720762252807617
mini_batch_src_global generation:  0.05045485496520996
r_  generation:  0.42652273178100586
local_output_nid generation:  0.031707048416137695
local_in_edges_tensor generation:  0.029982328414916992
mini_batch_src_global generation:  0.05054426193237305
r_  generation:  0.43428969383239746
local_output_nid generation:  0.03159022331237793
local_in_edges_tensor generation:  0.026409626007080078
mini_batch_src_global generation:  0.051392555236816406
r_  generation:  0.43096041679382324
local_output_nid generation:  0.030237197875976562
local_in_edges_tensor generation:  0.03103160858154297
mini_batch_src_global generation:  0.050913333892822266
r_  generation:  0.4355003833770752
local_output_nid generation:  0.030412673950195312
local_in_edges_tensor generation:  0.02680802345275879
mini_batch_src_global generation:  0.05122804641723633
r_  generation:  0.4333608150482178
local_output_nid generation:  0.03088665008544922
local_in_edges_tensor generation:  0.028817415237426758
mini_batch_src_global generation:  0.051294565200805664
r_  generation:  0.43463563919067383
local_output_nid generation:  0.030311107635498047
local_in_edges_tensor generation:  0.027640342712402344
mini_batch_src_global generation:  0.05209994316101074
r_  generation:  0.43311023712158203
local_output_nid generation:  0.030116796493530273
local_in_edges_tensor generation:  0.02962660789489746
mini_batch_src_global generation:  0.05127906799316406
r_  generation:  0.43773794174194336
local_output_nid generation:  0.031033992767333984
local_in_edges_tensor generation:  0.032378435134887695
mini_batch_src_global generation:  0.05243062973022461
r_  generation:  0.4430537223815918
local_output_nid generation:  0.03022027015686035
local_in_edges_tensor generation:  0.03265833854675293
mini_batch_src_global generation:  0.05070233345031738
r_  generation:  0.43630027770996094
local_output_nid generation:  0.03038334846496582
local_in_edges_tensor generation:  0.028325796127319336
mini_batch_src_global generation:  0.052019596099853516
r_  generation:  0.4328892230987549
local_output_nid generation:  0.029935836791992188
local_in_edges_tensor generation:  0.030826807022094727
mini_batch_src_global generation:  0.0509645938873291
r_  generation:  0.43082618713378906
local_output_nid generation:  0.03040337562561035
local_in_edges_tensor generation:  0.02887582778930664
mini_batch_src_global generation:  0.05254530906677246
r_  generation:  0.4348759651184082
local_output_nid generation:  0.03043985366821289
local_in_edges_tensor generation:  0.030333757400512695
mini_batch_src_global generation:  0.05251121520996094
r_  generation:  0.43545103073120117
local_output_nid generation:  0.03023529052734375
local_in_edges_tensor generation:  0.027493715286254883
mini_batch_src_global generation:  0.05201983451843262
r_  generation:  0.43842196464538574
local_output_nid generation:  0.03069472312927246
local_in_edges_tensor generation:  0.02781963348388672
mini_batch_src_global generation:  0.05096578598022461
r_  generation:  0.4423213005065918
local_output_nid generation:  0.030571460723876953
local_in_edges_tensor generation:  0.029155731201171875
mini_batch_src_global generation:  0.0523378849029541
r_  generation:  0.444549560546875
local_output_nid generation:  0.03035426139831543
local_in_edges_tensor generation:  0.028766870498657227
mini_batch_src_global generation:  0.05258607864379883
r_  generation:  0.44196534156799316
local_output_nid generation:  0.03220725059509277
local_in_edges_tensor generation:  0.0286865234375
mini_batch_src_global generation:  0.05414319038391113
r_  generation:  0.43964290618896484
local_output_nid generation:  0.030278682708740234
local_in_edges_tensor generation:  0.03280806541442871
mini_batch_src_global generation:  0.05263924598693848
r_  generation:  0.43999528884887695
local_output_nid generation:  0.03055882453918457
local_in_edges_tensor generation:  0.033330440521240234
mini_batch_src_global generation:  0.05335545539855957
r_  generation:  0.4373621940612793
local_output_nid generation:  0.030976295471191406
local_in_edges_tensor generation:  0.030317306518554688
mini_batch_src_global generation:  0.05173659324645996
r_  generation:  0.44288206100463867
local_output_nid generation:  0.03047347068786621
local_in_edges_tensor generation:  0.030128955841064453
mini_batch_src_global generation:  0.053314924240112305
r_  generation:  0.45841407775878906
local_output_nid generation:  0.034256935119628906
local_in_edges_tensor generation:  0.027667522430419922
mini_batch_src_global generation:  0.05202603340148926
r_  generation:  0.4379572868347168
local_output_nid generation:  0.03031015396118164
local_in_edges_tensor generation:  0.0304110050201416
mini_batch_src_global generation:  0.05332660675048828
r_  generation:  0.43497157096862793
local_output_nid generation:  0.03034663200378418
local_in_edges_tensor generation:  0.027057170867919922
mini_batch_src_global generation:  0.05097627639770508
r_  generation:  0.435819149017334
local_output_nid generation:  0.030460596084594727
local_in_edges_tensor generation:  0.027322769165039062
mini_batch_src_global generation:  0.05180096626281738
r_  generation:  0.4333469867706299
local_output_nid generation:  0.030618667602539062
local_in_edges_tensor generation:  0.029002666473388672
mini_batch_src_global generation:  0.050748586654663086
r_  generation:  0.4391212463378906
local_output_nid generation:  0.03018951416015625
local_in_edges_tensor generation:  0.02810955047607422
mini_batch_src_global generation:  0.05120277404785156
r_  generation:  0.4333384037017822
----------------------check_connections_block total spend ----------------------------- 20.739795923233032
generate_one_block  0.6108696460723877
generate_one_block  0.5876960754394531
generate_one_block  0.5806910991668701
generate_one_block  0.574639081954956
generate_one_block  0.6924295425415039
generate_one_block  0.5857071876525879
generate_one_block  0.5927505493164062
generate_one_block  0.577439546585083
generate_one_block  0.5775682926177979
generate_one_block  0.5878911018371582
generate_one_block  0.5863234996795654
generate_one_block  0.5894820690155029
generate_one_block  0.5878434181213379
generate_one_block  0.5953071117401123
generate_one_block  0.579317569732666
generate_one_block  0.5909545421600342
generate_one_block  0.58689284324646
generate_one_block  0.5829117298126221
generate_one_block  0.5843510627746582
generate_one_block  0.5938963890075684
generate_one_block  0.5861449241638184
generate_one_block  0.5886242389678955
generate_one_block  0.582852840423584
generate_one_block  0.588151216506958
generate_one_block  0.6080892086029053
generate_one_block  0.5873556137084961
generate_one_block  0.5857782363891602
generate_one_block  0.5785701274871826
generate_one_block  0.5902419090270996
generate_one_block  0.592238187789917
generate_one_block  0.5884523391723633
generate_one_block  0.5851931571960449
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12650632858276367  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

connection checking time:  29.481720447540283
block generation total time  26.862265586853027
average batch blocks generation time:  0.8394457995891571
block dataloader generation time/epoch 59.890565974371775
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10703372955322266  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.179195880889893  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10639572143554688  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.739799976348877  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10673046112060547  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.881720542907715  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10651016235351562  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.86117124557495  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10656309127807617  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.23335075378418  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10642719268798828  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.885331630706787  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10688304901123047  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.136425495147705  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10659074783325195  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.048296451568604  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10631513595581055  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.417515754699707  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10671186447143555  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.67570161819458  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10651588439941406  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.7217116355896  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1064906120300293  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.022212028503418  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10656118392944336  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.92733860015869  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10662984848022461  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.055147647857666  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10616016387939453  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.39763879776001  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1068410873413086  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.273780822753906  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10679054260253906  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.92531442642212  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10657548904418945  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.20536470413208  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10658693313598633  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.96754217147827  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10684442520141602  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.187572479248047  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10638999938964844  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.512629508972168  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10668611526489258  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.988707065582275  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10645198822021484  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.83380365371704  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10672998428344727  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.145100116729736  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10682392120361328  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.080711364746094  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1065664291381836  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.102588653564453  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10683012008666992  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.110200881958008  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10652494430541992  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.65027379989624  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10665607452392578  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.22136688232422  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.106597900390625  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.39969491958618  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10680103302001953  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.156415462493896  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10635042190551758  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.5241641998291  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03514658659696579 |0.020199067890644073 |0.5564036592841148 |9.360164403915405e-05 |1.0642122849822044 |0.005281686782836914 |
----------------------------------------------------------pseudo_mini_loss sum 1.4639359712600708
Total (block generation + training)time/epoch 113.64430832862854
Training time/epoch 53.69265627861023
Training time without block to device /epoch 53.04628610610962
Training time without total dataloading part /epoch 51.86798715591431
load block tensor time/epoch 1.1246907711029053
block to device time/epoch 0.6463701725006104
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  9116523
Number of first layer input nodes during this epoch:  4762030
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12655162811279297  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025326251983642578
range selection method range initialization spend 0.014479637145996094
time for parepare:  0.018032550811767578
local_output_nid generation:  0.0010099411010742188
local_in_edges_tensor generation:  0.007575035095214844
mini_batch_src_global generation:  0.001425027847290039
r_  generation:  0.011255025863647461
local_output_nid generation:  0.0009844303131103516
local_in_edges_tensor generation:  0.0007441043853759766
mini_batch_src_global generation:  0.0014424324035644531
r_  generation:  0.010852575302124023
local_output_nid generation:  0.0009334087371826172
local_in_edges_tensor generation:  0.0006422996520996094
mini_batch_src_global generation:  0.0011761188507080078
r_  generation:  0.009747982025146484
local_output_nid generation:  0.0009334087371826172
local_in_edges_tensor generation:  0.0006854534149169922
mini_batch_src_global generation:  0.001119852066040039
r_  generation:  0.009982585906982422
local_output_nid generation:  0.0009043216705322266
local_in_edges_tensor generation:  0.0006136894226074219
mini_batch_src_global generation:  0.001050710678100586
r_  generation:  0.009593009948730469
local_output_nid generation:  0.0008912086486816406
local_in_edges_tensor generation:  0.0005679130554199219
mini_batch_src_global generation:  0.0012259483337402344
r_  generation:  0.009682655334472656
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0006351470947265625
mini_batch_src_global generation:  0.0012493133544921875
r_  generation:  0.010386466979980469
local_output_nid generation:  0.0008804798126220703
local_in_edges_tensor generation:  0.0006320476531982422
mini_batch_src_global generation:  0.0011315345764160156
r_  generation:  0.0102386474609375
local_output_nid generation:  0.0008838176727294922
local_in_edges_tensor generation:  0.0006220340728759766
mini_batch_src_global generation:  0.0011088848114013672
r_  generation:  0.010118961334228516
local_output_nid generation:  0.0008780956268310547
local_in_edges_tensor generation:  0.0006406307220458984
mini_batch_src_global generation:  0.0011394023895263672
r_  generation:  0.01047968864440918
local_output_nid generation:  0.0008816719055175781
local_in_edges_tensor generation:  0.0006191730499267578
mini_batch_src_global generation:  0.0011854171752929688
r_  generation:  0.010133504867553711
local_output_nid generation:  0.0008933544158935547
local_in_edges_tensor generation:  0.0005965232849121094
mini_batch_src_global generation:  0.0012979507446289062
r_  generation:  0.010656118392944336
local_output_nid generation:  0.0009000301361083984
local_in_edges_tensor generation:  0.0006198883056640625
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.010341644287109375
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.0011296272277832031
r_  generation:  0.010070323944091797
local_output_nid generation:  0.0008990764617919922
local_in_edges_tensor generation:  0.0006155967712402344
mini_batch_src_global generation:  0.0011796951293945312
r_  generation:  0.009979009628295898
local_output_nid generation:  0.0008883476257324219
local_in_edges_tensor generation:  0.0005731582641601562
mini_batch_src_global generation:  0.001088857650756836
r_  generation:  0.010214090347290039
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0006840229034423828
mini_batch_src_global generation:  0.001123666763305664
r_  generation:  0.010161876678466797
local_output_nid generation:  0.0008766651153564453
local_in_edges_tensor generation:  0.0005660057067871094
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.01017904281616211
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.0005621910095214844
mini_batch_src_global generation:  0.0010991096496582031
r_  generation:  0.010335922241210938
local_output_nid generation:  0.0009129047393798828
local_in_edges_tensor generation:  0.0006103515625
mini_batch_src_global generation:  0.0012083053588867188
r_  generation:  0.010304689407348633
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.001087188720703125
r_  generation:  0.010183334350585938
local_output_nid generation:  0.0008728504180908203
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0012450218200683594
r_  generation:  0.010338544845581055
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.00055694580078125
mini_batch_src_global generation:  0.0012140274047851562
r_  generation:  0.010321378707885742
local_output_nid generation:  0.0008616447448730469
local_in_edges_tensor generation:  0.0005705356597900391
mini_batch_src_global generation:  0.0011403560638427734
r_  generation:  0.0099029541015625
local_output_nid generation:  0.0008814334869384766
local_in_edges_tensor generation:  0.0005612373352050781
mini_batch_src_global generation:  0.001157522201538086
r_  generation:  0.009984254837036133
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005886554718017578
mini_batch_src_global generation:  0.0011250972747802734
r_  generation:  0.010393857955932617
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0005741119384765625
mini_batch_src_global generation:  0.0012328624725341797
r_  generation:  0.010518789291381836
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0006690025329589844
mini_batch_src_global generation:  0.0012416839599609375
r_  generation:  0.010504961013793945
local_output_nid generation:  0.0008637905120849609
local_in_edges_tensor generation:  0.0005772113800048828
mini_batch_src_global generation:  0.0011935234069824219
r_  generation:  0.009970426559448242
local_output_nid generation:  0.0008578300476074219
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0011191368103027344
r_  generation:  0.010106801986694336
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0006251335144042969
mini_batch_src_global generation:  0.001111745834350586
r_  generation:  0.0099945068359375
local_output_nid generation:  0.0008614063262939453
local_in_edges_tensor generation:  0.0005650520324707031
mini_batch_src_global generation:  0.0011074542999267578
r_  generation:  0.00997161865234375
----------------------check_connections_block total spend ----------------------------- 0.5178258419036865
generate_one_block  0.026186227798461914
generate_one_block  0.02095198631286621
generate_one_block  0.01856851577758789
generate_one_block  0.018880844116210938
generate_one_block  0.01801919937133789
generate_one_block  0.017820119857788086
generate_one_block  0.019238710403442383
generate_one_block  0.018651247024536133
generate_one_block  0.018665552139282227
generate_one_block  0.019022464752197266
generate_one_block  0.018161773681640625
generate_one_block  0.019589662551879883
generate_one_block  0.018415212631225586
generate_one_block  0.01817607879638672
generate_one_block  0.018016576766967773
generate_one_block  0.01827716827392578
generate_one_block  0.01822805404663086
generate_one_block  0.018210649490356445
generate_one_block  0.01824355125427246
generate_one_block  0.018416166305541992
generate_one_block  0.018276691436767578
generate_one_block  0.018735170364379883
generate_one_block  0.02065896987915039
generate_one_block  0.01807570457458496
generate_one_block  0.018087148666381836
generate_one_block  0.018515348434448242
generate_one_block  0.01877617835998535
generate_one_block  0.018726110458374023
generate_one_block  0.017910003662109375
generate_one_block  0.018210411071777344
generate_one_block  0.018031597137451172
generate_one_block  0.018109560012817383
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040268659591674805
gen group dst list time:  0.02062368392944336
time for parepare:  0.01983356475830078
local_output_nid generation:  0.005800485610961914
local_in_edges_tensor generation:  0.01748514175415039
mini_batch_src_global generation:  0.018729209899902344
r_  generation:  0.16921782493591309
local_output_nid generation:  0.00778961181640625
local_in_edges_tensor generation:  0.011245965957641602
mini_batch_src_global generation:  0.022304773330688477
r_  generation:  0.17171335220336914
local_output_nid generation:  0.007725954055786133
local_in_edges_tensor generation:  0.03352642059326172
mini_batch_src_global generation:  0.021197080612182617
r_  generation:  0.16764259338378906
local_output_nid generation:  0.008207082748413086
local_in_edges_tensor generation:  0.008327960968017578
mini_batch_src_global generation:  0.021686792373657227
r_  generation:  0.17990541458129883
local_output_nid generation:  0.008453369140625
local_in_edges_tensor generation:  0.010507583618164062
mini_batch_src_global generation:  0.023357391357421875
r_  generation:  0.17475056648254395
local_output_nid generation:  0.008490800857543945
local_in_edges_tensor generation:  0.009603023529052734
mini_batch_src_global generation:  0.021730899810791016
r_  generation:  0.1724863052368164
local_output_nid generation:  0.009144067764282227
local_in_edges_tensor generation:  0.008901834487915039
mini_batch_src_global generation:  0.027457475662231445
r_  generation:  0.1867508888244629
local_output_nid generation:  0.008640766143798828
local_in_edges_tensor generation:  0.010975360870361328
mini_batch_src_global generation:  0.023444414138793945
r_  generation:  0.18206524848937988
local_output_nid generation:  0.00857853889465332
local_in_edges_tensor generation:  0.009476661682128906
mini_batch_src_global generation:  0.02397942543029785
r_  generation:  0.18299341201782227
local_output_nid generation:  0.00908660888671875
local_in_edges_tensor generation:  0.009645223617553711
mini_batch_src_global generation:  0.02386617660522461
r_  generation:  0.18746018409729004
local_output_nid generation:  0.008767366409301758
local_in_edges_tensor generation:  0.008499622344970703
mini_batch_src_global generation:  0.023522138595581055
r_  generation:  0.17652034759521484
local_output_nid generation:  0.009311199188232422
local_in_edges_tensor generation:  0.009158849716186523
mini_batch_src_global generation:  0.0242769718170166
r_  generation:  0.18424081802368164
local_output_nid generation:  0.009013175964355469
local_in_edges_tensor generation:  0.008836507797241211
mini_batch_src_global generation:  0.024204730987548828
r_  generation:  0.1787724494934082
local_output_nid generation:  0.008959770202636719
local_in_edges_tensor generation:  0.011638641357421875
mini_batch_src_global generation:  0.023396968841552734
r_  generation:  0.1797010898590088
local_output_nid generation:  0.009002923965454102
local_in_edges_tensor generation:  0.008778810501098633
mini_batch_src_global generation:  0.02308368682861328
r_  generation:  0.17864751815795898
local_output_nid generation:  0.008987188339233398
local_in_edges_tensor generation:  0.00868988037109375
mini_batch_src_global generation:  0.02310633659362793
r_  generation:  0.17850399017333984
local_output_nid generation:  0.00887155532836914
local_in_edges_tensor generation:  0.008616447448730469
mini_batch_src_global generation:  0.023290157318115234
r_  generation:  0.1803879737854004
local_output_nid generation:  0.009156465530395508
local_in_edges_tensor generation:  0.008962392807006836
mini_batch_src_global generation:  0.024057388305664062
r_  generation:  0.1823441982269287
local_output_nid generation:  0.009150266647338867
local_in_edges_tensor generation:  0.00874948501586914
mini_batch_src_global generation:  0.023546695709228516
r_  generation:  0.1809546947479248
local_output_nid generation:  0.009172439575195312
local_in_edges_tensor generation:  0.009569883346557617
mini_batch_src_global generation:  0.024435758590698242
r_  generation:  0.1819016933441162
local_output_nid generation:  0.009111881256103516
local_in_edges_tensor generation:  0.009390115737915039
mini_batch_src_global generation:  0.023843050003051758
r_  generation:  0.18511176109313965
local_output_nid generation:  0.009133577346801758
local_in_edges_tensor generation:  0.009064912796020508
mini_batch_src_global generation:  0.02368450164794922
r_  generation:  0.18209242820739746
local_output_nid generation:  0.00920248031616211
local_in_edges_tensor generation:  0.009671211242675781
mini_batch_src_global generation:  0.0232698917388916
r_  generation:  0.18234038352966309
local_output_nid generation:  0.008969783782958984
local_in_edges_tensor generation:  0.008758068084716797
mini_batch_src_global generation:  0.022639751434326172
r_  generation:  0.17363405227661133
local_output_nid generation:  0.009097099304199219
local_in_edges_tensor generation:  0.008994817733764648
mini_batch_src_global generation:  0.022995710372924805
r_  generation:  0.17936968803405762
local_output_nid generation:  0.00916147232055664
local_in_edges_tensor generation:  0.009514808654785156
mini_batch_src_global generation:  0.02376079559326172
r_  generation:  0.1841895580291748
local_output_nid generation:  0.009401559829711914
local_in_edges_tensor generation:  0.009597539901733398
mini_batch_src_global generation:  0.023262500762939453
r_  generation:  0.18418288230895996
local_output_nid generation:  0.009307622909545898
local_in_edges_tensor generation:  0.009709596633911133
mini_batch_src_global generation:  0.0239107608795166
r_  generation:  0.18591737747192383
local_output_nid generation:  0.00891733169555664
local_in_edges_tensor generation:  0.008841753005981445
mini_batch_src_global generation:  0.022734880447387695
r_  generation:  0.17703509330749512
local_output_nid generation:  0.009044885635375977
local_in_edges_tensor generation:  0.008806943893432617
mini_batch_src_global generation:  0.024096965789794922
r_  generation:  0.17990350723266602
local_output_nid generation:  0.009970903396606445
local_in_edges_tensor generation:  0.009686946868896484
mini_batch_src_global generation:  0.02271103858947754
r_  generation:  0.1837453842163086
local_output_nid generation:  0.009015321731567383
local_in_edges_tensor generation:  0.008692264556884766
mini_batch_src_global generation:  0.023013830184936523
r_  generation:  0.18237948417663574
----------------------check_connections_block total spend ----------------------------- 8.452768564224243
generate_one_block  0.25533461570739746
generate_one_block  0.2483680248260498
generate_one_block  0.2365720272064209
generate_one_block  0.24988865852355957
generate_one_block  0.256847620010376
generate_one_block  0.2385416030883789
generate_one_block  0.2553737163543701
generate_one_block  0.25078773498535156
generate_one_block  0.2503378391265869
generate_one_block  0.25708556175231934
generate_one_block  0.23748183250427246
generate_one_block  0.25058794021606445
generate_one_block  0.24606609344482422
generate_one_block  0.24411678314208984
generate_one_block  0.23955702781677246
generate_one_block  0.24252104759216309
generate_one_block  0.24308395385742188
generate_one_block  0.24777507781982422
generate_one_block  0.24622082710266113
generate_one_block  0.25267529487609863
generate_one_block  0.2484910488128662
generate_one_block  0.2471158504486084
generate_one_block  0.24506711959838867
generate_one_block  0.23398804664611816
generate_one_block  0.24224019050598145
generate_one_block  0.2571375370025635
generate_one_block  0.24804282188415527
generate_one_block  0.2532474994659424
generate_one_block  0.23681426048278809
generate_one_block  0.24311399459838867
generate_one_block  0.24399256706237793
generate_one_block  0.24691152572631836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03625822067260742
gen group dst list time:  0.11014795303344727
time for parepare:  0.018564701080322266
local_output_nid generation:  0.024249792098999023
local_in_edges_tensor generation:  0.044059038162231445
mini_batch_src_global generation:  0.04009652137756348
r_  generation:  0.42569732666015625
local_output_nid generation:  0.02985072135925293
local_in_edges_tensor generation:  0.03228497505187988
mini_batch_src_global generation:  0.04993700981140137
r_  generation:  0.41939306259155273
local_output_nid generation:  0.030220985412597656
local_in_edges_tensor generation:  0.025873422622680664
mini_batch_src_global generation:  0.048572540283203125
r_  generation:  0.4310317039489746
local_output_nid generation:  0.030468463897705078
local_in_edges_tensor generation:  0.028357744216918945
mini_batch_src_global generation:  0.050183773040771484
r_  generation:  0.4284830093383789
local_output_nid generation:  0.030624866485595703
local_in_edges_tensor generation:  0.02846503257751465
mini_batch_src_global generation:  0.05013108253479004
r_  generation:  0.4363524913787842
local_output_nid generation:  0.03061532974243164
local_in_edges_tensor generation:  0.028752565383911133
mini_batch_src_global generation:  0.05327415466308594
r_  generation:  0.42914462089538574
local_output_nid generation:  0.02951955795288086
local_in_edges_tensor generation:  0.02863931655883789
mini_batch_src_global generation:  0.05057954788208008
r_  generation:  0.44124507904052734
local_output_nid generation:  0.02886652946472168
local_in_edges_tensor generation:  0.03049325942993164
mini_batch_src_global generation:  0.0509037971496582
r_  generation:  0.43267107009887695
local_output_nid generation:  0.029318809509277344
local_in_edges_tensor generation:  0.029119014739990234
mini_batch_src_global generation:  0.05083179473876953
r_  generation:  0.438244104385376
local_output_nid generation:  0.02927231788635254
local_in_edges_tensor generation:  0.027349233627319336
mini_batch_src_global generation:  0.05095267295837402
r_  generation:  0.43493199348449707
local_output_nid generation:  0.02897024154663086
local_in_edges_tensor generation:  0.028656721115112305
mini_batch_src_global generation:  0.050687313079833984
r_  generation:  0.4373481273651123
local_output_nid generation:  0.029231786727905273
local_in_edges_tensor generation:  0.02747631072998047
mini_batch_src_global generation:  0.05281639099121094
r_  generation:  0.43437790870666504
local_output_nid generation:  0.029129743576049805
local_in_edges_tensor generation:  0.030696868896484375
mini_batch_src_global generation:  0.049779653549194336
r_  generation:  0.4356191158294678
local_output_nid generation:  0.03052806854248047
local_in_edges_tensor generation:  0.026340723037719727
mini_batch_src_global generation:  0.051689863204956055
r_  generation:  0.429476261138916
local_output_nid generation:  0.028822898864746094
local_in_edges_tensor generation:  0.02614736557006836
mini_batch_src_global generation:  0.04974699020385742
r_  generation:  0.4329848289489746
local_output_nid generation:  0.02897024154663086
local_in_edges_tensor generation:  0.02745223045349121
mini_batch_src_global generation:  0.0509333610534668
r_  generation:  0.43067073822021484
local_output_nid generation:  0.029039859771728516
local_in_edges_tensor generation:  0.026569604873657227
mini_batch_src_global generation:  0.04961371421813965
r_  generation:  0.4326813220977783
local_output_nid generation:  0.029117584228515625
local_in_edges_tensor generation:  0.026592254638671875
mini_batch_src_global generation:  0.052870988845825195
r_  generation:  0.42850351333618164
local_output_nid generation:  0.029005050659179688
local_in_edges_tensor generation:  0.028616666793823242
mini_batch_src_global generation:  0.05009889602661133
r_  generation:  0.4363977909088135
local_output_nid generation:  0.029041051864624023
local_in_edges_tensor generation:  0.028584957122802734
mini_batch_src_global generation:  0.05097770690917969
r_  generation:  0.43093395233154297
local_output_nid generation:  0.02919292449951172
local_in_edges_tensor generation:  0.029536724090576172
mini_batch_src_global generation:  0.04976367950439453
r_  generation:  0.43530893325805664
local_output_nid generation:  0.02886199951171875
local_in_edges_tensor generation:  0.026826143264770508
mini_batch_src_global generation:  0.052935123443603516
r_  generation:  0.4286463260650635
local_output_nid generation:  0.0294344425201416
local_in_edges_tensor generation:  0.026934385299682617
mini_batch_src_global generation:  0.050405025482177734
r_  generation:  0.4386577606201172
local_output_nid generation:  0.029012441635131836
local_in_edges_tensor generation:  0.02834463119506836
mini_batch_src_global generation:  0.05120539665222168
r_  generation:  0.43072509765625
local_output_nid generation:  0.02908778190612793
local_in_edges_tensor generation:  0.027216672897338867
mini_batch_src_global generation:  0.05024528503417969
r_  generation:  0.44242310523986816
local_output_nid generation:  0.02914571762084961
local_in_edges_tensor generation:  0.031769514083862305
mini_batch_src_global generation:  0.05149245262145996
r_  generation:  0.43527936935424805
local_output_nid generation:  0.02957940101623535
local_in_edges_tensor generation:  0.027164936065673828
mini_batch_src_global generation:  0.04998421669006348
r_  generation:  0.440737247467041
local_output_nid generation:  0.029202699661254883
local_in_edges_tensor generation:  0.029041528701782227
mini_batch_src_global generation:  0.051236867904663086
r_  generation:  0.4340965747833252
local_output_nid generation:  0.029193401336669922
local_in_edges_tensor generation:  0.02724432945251465
mini_batch_src_global generation:  0.04996991157531738
r_  generation:  0.43773818016052246
local_output_nid generation:  0.029141902923583984
local_in_edges_tensor generation:  0.02650618553161621
mini_batch_src_global generation:  0.051108360290527344
r_  generation:  0.42963385581970215
local_output_nid generation:  0.0291745662689209
local_in_edges_tensor generation:  0.028543710708618164
mini_batch_src_global generation:  0.05210995674133301
r_  generation:  0.43475961685180664
local_output_nid generation:  0.02925896644592285
local_in_edges_tensor generation:  0.028478622436523438
mini_batch_src_global generation:  0.05095982551574707
r_  generation:  0.43680310249328613
----------------------check_connections_block total spend ----------------------------- 20.467533349990845
generate_one_block  0.5853755474090576
generate_one_block  0.57991623878479
generate_one_block  0.5729079246520996
generate_one_block  0.5900969505310059
generate_one_block  0.6627829074859619
generate_one_block  0.5780763626098633
generate_one_block  0.5899040699005127
generate_one_block  0.581951379776001
generate_one_block  0.582815408706665
generate_one_block  0.5877554416656494
generate_one_block  0.5764715671539307
generate_one_block  0.5867738723754883
generate_one_block  0.575756311416626
generate_one_block  0.5783848762512207
generate_one_block  0.578655481338501
generate_one_block  0.5860333442687988
generate_one_block  0.5740299224853516
generate_one_block  0.5934553146362305
generate_one_block  0.5841975212097168
generate_one_block  0.5770032405853271
generate_one_block  0.5844225883483887
generate_one_block  0.5795266628265381
generate_one_block  0.5887854099273682
generate_one_block  0.5823884010314941
generate_one_block  0.5928239822387695
generate_one_block  0.5892417430877686
generate_one_block  0.5863380432128906
generate_one_block  0.5891807079315186
generate_one_block  0.5841953754425049
generate_one_block  0.5797097682952881
generate_one_block  0.5776288509368896
generate_one_block  0.5801968574523926
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12655162811279297  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

connection checking time:  28.920301914215088
block generation total time  26.63216781616211
average batch blocks generation time:  0.8322552442550659
block dataloader generation time/epoch 59.75488397479057
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10676860809326172  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.34386396408081  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10669898986816406  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.07538890838623  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10620784759521484  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.577348709106445  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1068716049194336  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.148438930511475  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10647392272949219  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.782113552093506  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1065831184387207  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.603756427764893  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10713624954223633  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.401384830474854  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10671854019165039  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.176776885986328  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10685443878173828  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.125661373138428  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10696601867675781  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.376473426818848  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10632133483886719  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.642664909362793  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10684919357299805  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.283841609954834  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10671138763427734  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.7445969581604  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10636138916015625  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.853851318359375  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10647153854370117  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.698912620544434  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10649347305297852  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.74229907989502  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10618972778320312  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.785606384277344  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10652542114257812  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.98432493209839  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10657882690429688  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.895073413848877  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10664224624633789  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.954133987426758  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1065053939819336  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.078230381011963  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10625696182250977  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.88875150680542  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10665655136108398  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.982533931732178  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10615873336791992  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.415085792541504  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10644006729125977  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.811148643493652  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10675907135009766  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.045860767364502  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10685348510742188  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.922304153442383  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10674285888671875  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.233384609222412  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10643768310546875  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.526190757751465  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10650253295898438  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.694162845611572  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.106231689453125  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.786327838897705  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1065058708190918  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.78598642349243  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030614487826824188 |0.020590759813785553 |0.5533602833747864 |9.424984455108643e-05 |1.0609279200434685 |0.005975246429443359 |
----------------------------------------------------------pseudo_mini_loss sum 1.4343236684799194
Total (block generation + training)time/epoch 113.45950770378113
Training time/epoch 53.360528230667114
Training time without block to device /epoch 52.70162391662598
Training time without total dataloading part /epoch 51.66621375083923
load block tensor time/epoch 0.979663610458374
block to device time/epoch 0.6589043140411377
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  9112506
Number of first layer input nodes during this epoch:  4759989
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12633466720581055  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024495363235473633
range selection method range initialization spend 0.013499736785888672
time for parepare:  0.020042896270751953
local_output_nid generation:  0.0009412765502929688
local_in_edges_tensor generation:  0.006716251373291016
mini_batch_src_global generation:  0.0016701221466064453
r_  generation:  0.01080322265625
local_output_nid generation:  0.0009531974792480469
local_in_edges_tensor generation:  0.0006871223449707031
mini_batch_src_global generation:  0.0015590190887451172
r_  generation:  0.010661125183105469
local_output_nid generation:  0.0009312629699707031
local_in_edges_tensor generation:  0.0006406307220458984
mini_batch_src_global generation:  0.0012111663818359375
r_  generation:  0.010079383850097656
local_output_nid generation:  0.0009119510650634766
local_in_edges_tensor generation:  0.0005917549133300781
mini_batch_src_global generation:  0.0011217594146728516
r_  generation:  0.00968790054321289
local_output_nid generation:  0.0008575916290283203
local_in_edges_tensor generation:  0.0005967617034912109
mini_batch_src_global generation:  0.0010807514190673828
r_  generation:  0.00987386703491211
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.010242462158203125
local_output_nid generation:  0.0008728504180908203
local_in_edges_tensor generation:  0.0005793571472167969
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.010196924209594727
local_output_nid generation:  0.0008819103240966797
local_in_edges_tensor generation:  0.0005657672882080078
mini_batch_src_global generation:  0.0011818408966064453
r_  generation:  0.010287761688232422
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0005803108215332031
mini_batch_src_global generation:  0.0011169910430908203
r_  generation:  0.009751319885253906
local_output_nid generation:  0.0008435249328613281
local_in_edges_tensor generation:  0.0005671977996826172
mini_batch_src_global generation:  0.0011157989501953125
r_  generation:  0.01031351089477539
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0005643367767333984
mini_batch_src_global generation:  0.0011458396911621094
r_  generation:  0.009972810745239258
local_output_nid generation:  0.0008661746978759766
local_in_edges_tensor generation:  0.0005657672882080078
mini_batch_src_global generation:  0.001100778579711914
r_  generation:  0.010051965713500977
local_output_nid generation:  0.0008518695831298828
local_in_edges_tensor generation:  0.0005712509155273438
mini_batch_src_global generation:  0.0011968612670898438
r_  generation:  0.010265588760375977
local_output_nid generation:  0.0008492469787597656
local_in_edges_tensor generation:  0.0005609989166259766
mini_batch_src_global generation:  0.0010886192321777344
r_  generation:  0.009953022003173828
local_output_nid generation:  0.0008552074432373047
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0010929107666015625
r_  generation:  0.010259866714477539
local_output_nid generation:  0.0008637905120849609
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0012176036834716797
r_  generation:  0.010468482971191406
local_output_nid generation:  0.0008754730224609375
local_in_edges_tensor generation:  0.0005600452423095703
mini_batch_src_global generation:  0.0011146068572998047
r_  generation:  0.009834527969360352
local_output_nid generation:  0.0008478164672851562
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.0011703968048095703
r_  generation:  0.009893417358398438
local_output_nid generation:  0.0008533000946044922
local_in_edges_tensor generation:  0.0005686283111572266
mini_batch_src_global generation:  0.0011174678802490234
r_  generation:  0.01020050048828125
local_output_nid generation:  0.0008494853973388672
local_in_edges_tensor generation:  0.0005552768707275391
mini_batch_src_global generation:  0.001209259033203125
r_  generation:  0.010332584381103516
local_output_nid generation:  0.0008516311645507812
local_in_edges_tensor generation:  0.0005826950073242188
mini_batch_src_global generation:  0.0011868476867675781
r_  generation:  0.01067662239074707
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.001138925552368164
r_  generation:  0.01030588150024414
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0005648136138916016
mini_batch_src_global generation:  0.0011315345764160156
r_  generation:  0.01014852523803711
local_output_nid generation:  0.0008485317230224609
local_in_edges_tensor generation:  0.0005736351013183594
mini_batch_src_global generation:  0.0011723041534423828
r_  generation:  0.009914159774780273
local_output_nid generation:  0.0008473396301269531
local_in_edges_tensor generation:  0.0005590915679931641
mini_batch_src_global generation:  0.0011746883392333984
r_  generation:  0.01017618179321289
local_output_nid generation:  0.0008618831634521484
local_in_edges_tensor generation:  0.0005517005920410156
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.009673833847045898
local_output_nid generation:  0.0008559226989746094
local_in_edges_tensor generation:  0.0005631446838378906
mini_batch_src_global generation:  0.0012319087982177734
r_  generation:  0.010364532470703125
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0005562305450439453
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.010051965713500977
local_output_nid generation:  0.000850677490234375
local_in_edges_tensor generation:  0.0005567073822021484
mini_batch_src_global generation:  0.0011789798736572266
r_  generation:  0.010126590728759766
local_output_nid generation:  0.0008575916290283203
local_in_edges_tensor generation:  0.0005507469177246094
mini_batch_src_global generation:  0.0010986328125
r_  generation:  0.01140284538269043
local_output_nid generation:  0.0008447170257568359
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.0011866092681884766
r_  generation:  0.010868549346923828
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.0012063980102539062
r_  generation:  0.01065516471862793
----------------------check_connections_block total spend ----------------------------- 0.5178048610687256
generate_one_block  0.024265527725219727
generate_one_block  0.02056574821472168
generate_one_block  0.01953411102294922
generate_one_block  0.018009662628173828
generate_one_block  0.01853632926940918
generate_one_block  0.01866316795349121
generate_one_block  0.018435001373291016
generate_one_block  0.01848626136779785
generate_one_block  0.01772308349609375
generate_one_block  0.018427610397338867
generate_one_block  0.017862796783447266
generate_one_block  0.01827216148376465
generate_one_block  0.018502235412597656
generate_one_block  0.01792287826538086
generate_one_block  0.018421649932861328
generate_one_block  0.0186769962310791
generate_one_block  0.017583608627319336
generate_one_block  0.01795816421508789
generate_one_block  0.018387794494628906
generate_one_block  0.018504858016967773
generate_one_block  0.019151687622070312
generate_one_block  0.018358469009399414
generate_one_block  0.020270109176635742
generate_one_block  0.018094539642333984
generate_one_block  0.018174171447753906
generate_one_block  0.017378807067871094
generate_one_block  0.018540382385253906
generate_one_block  0.01788616180419922
generate_one_block  0.018169879913330078
generate_one_block  0.01778435707092285
generate_one_block  0.019407033920288086
generate_one_block  0.01903510093688965
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03820657730102539
gen group dst list time:  0.022684812545776367
time for parepare:  0.021848678588867188
local_output_nid generation:  0.0055179595947265625
local_in_edges_tensor generation:  0.01816272735595703
mini_batch_src_global generation:  0.018064260482788086
r_  generation:  0.15912985801696777
local_output_nid generation:  0.007719993591308594
local_in_edges_tensor generation:  0.0109100341796875
mini_batch_src_global generation:  0.022708415985107422
r_  generation:  0.1687929630279541
local_output_nid generation:  0.008176565170288086
local_in_edges_tensor generation:  0.03251338005065918
mini_batch_src_global generation:  0.02216339111328125
r_  generation:  0.1765763759613037
local_output_nid generation:  0.008161067962646484
local_in_edges_tensor generation:  0.008339405059814453
mini_batch_src_global generation:  0.021802663803100586
r_  generation:  0.17177295684814453
local_output_nid generation:  0.00839543342590332
local_in_edges_tensor generation:  0.011438846588134766
mini_batch_src_global generation:  0.023371458053588867
r_  generation:  0.1791093349456787
local_output_nid generation:  0.008887290954589844
local_in_edges_tensor generation:  0.008697986602783203
mini_batch_src_global generation:  0.024170398712158203
r_  generation:  0.18223190307617188
local_output_nid generation:  0.008840084075927734
local_in_edges_tensor generation:  0.009891033172607422
mini_batch_src_global generation:  0.023695707321166992
r_  generation:  0.1763908863067627
local_output_nid generation:  0.008607149124145508
local_in_edges_tensor generation:  0.0102691650390625
mini_batch_src_global generation:  0.023750782012939453
r_  generation:  0.18000030517578125
local_output_nid generation:  0.008310079574584961
local_in_edges_tensor generation:  0.008878231048583984
mini_batch_src_global generation:  0.022910594940185547
r_  generation:  0.17530345916748047
local_output_nid generation:  0.008794069290161133
local_in_edges_tensor generation:  0.009582996368408203
mini_batch_src_global generation:  0.023508071899414062
r_  generation:  0.17922353744506836
local_output_nid generation:  0.008643865585327148
local_in_edges_tensor generation:  0.009123086929321289
mini_batch_src_global generation:  0.022800683975219727
r_  generation:  0.18088865280151367
local_output_nid generation:  0.00889277458190918
local_in_edges_tensor generation:  0.009501218795776367
mini_batch_src_global generation:  0.024398326873779297
r_  generation:  0.1780996322631836
local_output_nid generation:  0.009219169616699219
local_in_edges_tensor generation:  0.009876251220703125
mini_batch_src_global generation:  0.02409505844116211
r_  generation:  0.18575835227966309
local_output_nid generation:  0.008997678756713867
local_in_edges_tensor generation:  0.00870656967163086
mini_batch_src_global generation:  0.023438692092895508
r_  generation:  0.17606854438781738
local_output_nid generation:  0.009158849716186523
local_in_edges_tensor generation:  0.009483575820922852
mini_batch_src_global generation:  0.024002552032470703
r_  generation:  0.18427157402038574
local_output_nid generation:  0.009528875350952148
local_in_edges_tensor generation:  0.010572433471679688
mini_batch_src_global generation:  0.025115966796875
r_  generation:  0.1859879493713379
local_output_nid generation:  0.00889277458190918
local_in_edges_tensor generation:  0.011404991149902344
mini_batch_src_global generation:  0.02336716651916504
r_  generation:  0.17510533332824707
local_output_nid generation:  0.009335517883300781
local_in_edges_tensor generation:  0.00860142707824707
mini_batch_src_global generation:  0.023467540740966797
r_  generation:  0.17973732948303223
local_output_nid generation:  0.00923466682434082
local_in_edges_tensor generation:  0.009056806564331055
mini_batch_src_global generation:  0.023874759674072266
r_  generation:  0.18304848670959473
local_output_nid generation:  0.009386062622070312
local_in_edges_tensor generation:  0.010506629943847656
mini_batch_src_global generation:  0.023770570755004883
r_  generation:  0.18302440643310547
local_output_nid generation:  0.009606122970581055
local_in_edges_tensor generation:  0.012259960174560547
mini_batch_src_global generation:  0.02540755271911621
r_  generation:  0.189957857131958
local_output_nid generation:  0.009355306625366211
local_in_edges_tensor generation:  0.008823394775390625
mini_batch_src_global generation:  0.02426004409790039
r_  generation:  0.1839604377746582
local_output_nid generation:  0.00911569595336914
local_in_edges_tensor generation:  0.009160280227661133
mini_batch_src_global generation:  0.023409128189086914
r_  generation:  0.17961931228637695
local_output_nid generation:  0.008960485458374023
local_in_edges_tensor generation:  0.00896143913269043
mini_batch_src_global generation:  0.022768735885620117
r_  generation:  0.17867398262023926
local_output_nid generation:  0.009250879287719727
local_in_edges_tensor generation:  0.008980512619018555
mini_batch_src_global generation:  0.0232696533203125
r_  generation:  0.18044757843017578
local_output_nid generation:  0.008894681930541992
local_in_edges_tensor generation:  0.008854389190673828
mini_batch_src_global generation:  0.02286076545715332
r_  generation:  0.1734142303466797
local_output_nid generation:  0.00952291488647461
local_in_edges_tensor generation:  0.00880885124206543
mini_batch_src_global generation:  0.023808956146240234
r_  generation:  0.18692445755004883
local_output_nid generation:  0.009149551391601562
local_in_edges_tensor generation:  0.008911848068237305
mini_batch_src_global generation:  0.023377656936645508
r_  generation:  0.17899107933044434
local_output_nid generation:  0.009259223937988281
local_in_edges_tensor generation:  0.008969306945800781
mini_batch_src_global generation:  0.02349400520324707
r_  generation:  0.18262720108032227
local_output_nid generation:  0.009109735488891602
local_in_edges_tensor generation:  0.0087127685546875
mini_batch_src_global generation:  0.02319025993347168
r_  generation:  0.18248963356018066
local_output_nid generation:  0.009968280792236328
local_in_edges_tensor generation:  0.01149296760559082
mini_batch_src_global generation:  0.026041746139526367
r_  generation:  0.1973862648010254
local_output_nid generation:  0.00962376594543457
local_in_edges_tensor generation:  0.009155035018920898
mini_batch_src_global generation:  0.0245969295501709
r_  generation:  0.18975424766540527
----------------------check_connections_block total spend ----------------------------- 8.480901002883911
generate_one_block  0.2419600486755371
generate_one_block  0.24382925033569336
generate_one_block  0.2509043216705322
generate_one_block  0.23802566528320312
generate_one_block  0.26612305641174316
generate_one_block  0.25298380851745605
generate_one_block  0.23895001411437988
generate_one_block  0.24591851234436035
generate_one_block  0.23584747314453125
generate_one_block  0.24262499809265137
generate_one_block  0.23926329612731934
generate_one_block  0.2468106746673584
generate_one_block  0.2514336109161377
generate_one_block  0.23716402053833008
generate_one_block  0.25039029121398926
generate_one_block  0.2551140785217285
generate_one_block  0.2331228256225586
generate_one_block  0.2423875331878662
generate_one_block  0.25144386291503906
generate_one_block  0.2555961608886719
generate_one_block  0.26070404052734375
generate_one_block  0.24948453903198242
generate_one_block  0.24344229698181152
generate_one_block  0.2375948429107666
generate_one_block  0.24376821517944336
generate_one_block  0.23708105087280273
generate_one_block  0.25629711151123047
generate_one_block  0.2390613555908203
generate_one_block  0.24457502365112305
generate_one_block  0.24039030075073242
generate_one_block  0.2651395797729492
generate_one_block  0.2566068172454834
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.14728856086730957
gen group dst list time:  0.10798406600952148
time for parepare:  0.017877817153930664
local_output_nid generation:  0.024383544921875
local_in_edges_tensor generation:  0.043554067611694336
mini_batch_src_global generation:  0.04264330863952637
r_  generation:  0.4253664016723633
local_output_nid generation:  0.030156850814819336
local_in_edges_tensor generation:  0.03187704086303711
mini_batch_src_global generation:  0.052895545959472656
r_  generation:  0.4219970703125
local_output_nid generation:  0.030669450759887695
local_in_edges_tensor generation:  0.029717683792114258
mini_batch_src_global generation:  0.05377936363220215
r_  generation:  0.43650293350219727
local_output_nid generation:  0.03044915199279785
local_in_edges_tensor generation:  0.026850223541259766
mini_batch_src_global generation:  0.05317234992980957
r_  generation:  0.42711448669433594
local_output_nid generation:  0.030542850494384766
local_in_edges_tensor generation:  0.026449203491210938
mini_batch_src_global generation:  0.05285453796386719
r_  generation:  0.4386718273162842
local_output_nid generation:  0.032080888748168945
local_in_edges_tensor generation:  0.028326749801635742
mini_batch_src_global generation:  0.05420970916748047
r_  generation:  0.44220471382141113
local_output_nid generation:  0.02918839454650879
local_in_edges_tensor generation:  0.028321266174316406
mini_batch_src_global generation:  0.05005764961242676
r_  generation:  0.4324657917022705
local_output_nid generation:  0.029161691665649414
local_in_edges_tensor generation:  0.029122591018676758
mini_batch_src_global generation:  0.05199742317199707
r_  generation:  0.4337887763977051
local_output_nid generation:  0.0289151668548584
local_in_edges_tensor generation:  0.026851654052734375
mini_batch_src_global generation:  0.05060410499572754
r_  generation:  0.43039584159851074
local_output_nid generation:  0.02908468246459961
local_in_edges_tensor generation:  0.028409957885742188
mini_batch_src_global generation:  0.052729129791259766
r_  generation:  0.4337284564971924
local_output_nid generation:  0.029129743576049805
local_in_edges_tensor generation:  0.027053117752075195
mini_batch_src_global generation:  0.05106043815612793
r_  generation:  0.43224215507507324
local_output_nid generation:  0.029067277908325195
local_in_edges_tensor generation:  0.028339624404907227
mini_batch_src_global generation:  0.05266904830932617
r_  generation:  0.4289271831512451
local_output_nid generation:  0.029288768768310547
local_in_edges_tensor generation:  0.03656458854675293
mini_batch_src_global generation:  0.050684213638305664
r_  generation:  0.4367702007293701
local_output_nid generation:  0.030194997787475586
local_in_edges_tensor generation:  0.029262781143188477
mini_batch_src_global generation:  0.05138111114501953
r_  generation:  0.42954587936401367
local_output_nid generation:  0.029575347900390625
local_in_edges_tensor generation:  0.028792619705200195
mini_batch_src_global generation:  0.05074167251586914
r_  generation:  0.43325161933898926
local_output_nid generation:  0.029203176498413086
local_in_edges_tensor generation:  0.02873086929321289
mini_batch_src_global generation:  0.05235719680786133
r_  generation:  0.4350159168243408
local_output_nid generation:  0.029388427734375
local_in_edges_tensor generation:  0.028654813766479492
mini_batch_src_global generation:  0.05097079277038574
r_  generation:  0.4324159622192383
local_output_nid generation:  0.02947998046875
local_in_edges_tensor generation:  0.028585195541381836
mini_batch_src_global generation:  0.0516507625579834
r_  generation:  0.4325094223022461
local_output_nid generation:  0.029221057891845703
local_in_edges_tensor generation:  0.030646562576293945
mini_batch_src_global generation:  0.05072188377380371
r_  generation:  0.4512972831726074
local_output_nid generation:  0.02933812141418457
local_in_edges_tensor generation:  0.02871537208557129
mini_batch_src_global generation:  0.05185890197753906
r_  generation:  0.4327981472015381
local_output_nid generation:  0.029697179794311523
local_in_edges_tensor generation:  0.028753995895385742
mini_batch_src_global generation:  0.05125737190246582
r_  generation:  0.4345738887786865
local_output_nid generation:  0.0312654972076416
local_in_edges_tensor generation:  0.030607223510742188
mini_batch_src_global generation:  0.051630258560180664
r_  generation:  0.4317951202392578
local_output_nid generation:  0.02927541732788086
local_in_edges_tensor generation:  0.03261709213256836
mini_batch_src_global generation:  0.051366567611694336
r_  generation:  0.4304327964782715
local_output_nid generation:  0.029428482055664062
local_in_edges_tensor generation:  0.03053140640258789
mini_batch_src_global generation:  0.0522608757019043
r_  generation:  0.44809436798095703
local_output_nid generation:  0.031050920486450195
local_in_edges_tensor generation:  0.027844667434692383
mini_batch_src_global generation:  0.05233478546142578
r_  generation:  0.43252015113830566
local_output_nid generation:  0.029681682586669922
local_in_edges_tensor generation:  0.030335187911987305
mini_batch_src_global generation:  0.05182647705078125
r_  generation:  0.43024420738220215
local_output_nid generation:  0.03023982048034668
local_in_edges_tensor generation:  0.028560161590576172
mini_batch_src_global generation:  0.05109286308288574
r_  generation:  0.4359736442565918
local_output_nid generation:  0.03105902671813965
local_in_edges_tensor generation:  0.028223514556884766
mini_batch_src_global generation:  0.05168557167053223
r_  generation:  0.43056750297546387
local_output_nid generation:  0.03012681007385254
local_in_edges_tensor generation:  0.026968717575073242
mini_batch_src_global generation:  0.0513615608215332
r_  generation:  0.43370676040649414
local_output_nid generation:  0.029969215393066406
local_in_edges_tensor generation:  0.029494762420654297
mini_batch_src_global generation:  0.05210399627685547
r_  generation:  0.42906975746154785
local_output_nid generation:  0.030233383178710938
local_in_edges_tensor generation:  0.03036332130432129
mini_batch_src_global generation:  0.053571462631225586
r_  generation:  0.43909788131713867
local_output_nid generation:  0.03021240234375
local_in_edges_tensor generation:  0.03019547462463379
mini_batch_src_global generation:  0.05225539207458496
r_  generation:  0.436842679977417
----------------------check_connections_block total spend ----------------------------- 20.59369659423828
generate_one_block  0.5972800254821777
generate_one_block  0.5747954845428467
generate_one_block  0.5950992107391357
generate_one_block  0.5778379440307617
generate_one_block  0.680560827255249
generate_one_block  0.582709550857544
generate_one_block  0.5775058269500732
generate_one_block  0.5822043418884277
generate_one_block  0.5723445415496826
generate_one_block  0.5818886756896973
generate_one_block  0.5816435813903809
generate_one_block  0.5778598785400391
generate_one_block  0.5886383056640625
generate_one_block  0.5757842063903809
generate_one_block  0.583885908126831
generate_one_block  0.5823657512664795
generate_one_block  0.5789916515350342
generate_one_block  0.5809183120727539
generate_one_block  0.5857384204864502
generate_one_block  0.5887479782104492
generate_one_block  0.5857775211334229
generate_one_block  0.5794281959533691
generate_one_block  0.5782351493835449
generate_one_block  0.5759656429290771
generate_one_block  0.5962471961975098
generate_one_block  0.5757453441619873
generate_one_block  0.5875401496887207
generate_one_block  0.5826661586761475
generate_one_block  0.5840029716491699
generate_one_block  0.5788512229919434
generate_one_block  0.5967826843261719
generate_one_block  0.5852029323577881
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.12633466720581055  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

connection checking time:  29.074597597122192
block generation total time  26.647284269332886
average batch blocks generation time:  0.8327276334166527
block dataloader generation time/epoch 59.67681905958388
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10698747634887695  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.749809741973877  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10653448104858398  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.91644048690796  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10703086853027344  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.28080129623413  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10624837875366211  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.6983642578125  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10658645629882812  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.07447385787964  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10689496994018555  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.22668743133545  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10627460479736328  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.72746753692627  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10657548904418945  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.045069217681885  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10625267028808594  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.57392168045044  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10694456100463867  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.93122100830078  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10642337799072266  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.619368076324463  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10622024536132812  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.68988609313965  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.106719970703125  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.20200824737549  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10643863677978516  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.578470706939697  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10650205612182617  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.09986114501953  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10677433013916016  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.26382064819336  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10630321502685547  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.4448299407959  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1067500114440918  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.873915195465088  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1066741943359375  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.03144645690918  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10685396194458008  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.047972679138184  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10723209381103516  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.49244785308838  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10685348510742188  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.127712726593018  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10626745223999023  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.74812602996826  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10633087158203125  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.607059955596924  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10657215118408203  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.84329652786255  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10597562789916992  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.347604274749756  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10695457458496094  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.16727638244629  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.1063547134399414  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.643439292907715  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10645484924316406  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.826441764831543  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10626935958862305  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 18.69189453125  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 0.10738325119018555  GigaBytes
Max Memory Allocated: 19.734424591064453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5018310546875 GB
    Memory Allocated: 19.714069366455078  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10672330856323242  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.2712459564209  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034154102206230164 |0.021305397152900696 |0.5556063428521156 |9.494274854660034e-05 |1.0637104660272598 |0.01008296012878418 |
----------------------------------------------------------pseudo_mini_loss sum 1.412164568901062
Total (block generation + training)time/epoch 113.37670840157404
Training time/epoch 53.66174530982971
Training time without block to device /epoch 52.97997260093689
Training time without total dataloading part /epoch 51.83125901222229
load block tensor time/epoch 1.0929312705993652
block to device time/epoch 0.6817727088928223
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  9115064
Number of first layer input nodes during this epoch:  4761829
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.12769079208374023  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029558420181274414
range selection method range initialization spend 0.015593290328979492
time for parepare:  0.02589869499206543
local_output_nid generation:  0.0012671947479248047
local_in_edges_tensor generation:  0.008765697479248047
mini_batch_src_global generation:  0.0022187232971191406
r_  generation:  0.01092386245727539
local_output_nid generation:  0.0010838508605957031
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0020329952239990234
r_  generation:  0.011902570724487305
local_output_nid generation:  0.0010058879852294922
local_in_edges_tensor generation:  0.0007011890411376953
mini_batch_src_global generation:  0.0015788078308105469
r_  generation:  0.010720014572143555
local_output_nid generation:  0.0010585784912109375
local_in_edges_tensor generation:  0.0006785392761230469
mini_batch_src_global generation:  0.0014865398406982422
r_  generation:  0.010482549667358398
local_output_nid generation:  0.0011057853698730469
local_in_edges_tensor generation:  0.0006923675537109375
mini_batch_src_global generation:  0.0014624595642089844
r_  generation:  0.010286569595336914
local_output_nid generation:  0.001074075698852539
local_in_edges_tensor generation:  0.0006911754608154297
mini_batch_src_global generation:  0.0014500617980957031
r_  generation:  0.010920286178588867
local_output_nid generation:  0.0010972023010253906
local_in_edges_tensor generation:  0.00069427490234375
mini_batch_src_global generation:  0.001451253890991211
r_  generation:  0.010920286178588867
local_output_nid generation:  0.0010914802551269531
local_in_edges_tensor generation:  0.0007386207580566406
mini_batch_src_global generation:  0.0015842914581298828
r_  generation:  0.011287212371826172
local_output_nid generation:  0.0010662078857421875
local_in_edges_tensor generation:  0.0006837844848632812
mini_batch_src_global generation:  0.0014197826385498047
r_  generation:  0.010615348815917969
local_output_nid generation:  0.0010271072387695312
local_in_edges_tensor generation:  0.0006501674652099609
mini_batch_src_global generation:  0.0015103816986083984
r_  generation:  0.011109113693237305
local_output_nid generation:  0.0010251998901367188
local_in_edges_tensor generation:  0.0006875991821289062
mini_batch_src_global generation:  0.0013575553894042969
r_  generation:  0.010443925857543945
local_output_nid generation:  0.0010035037994384766
local_in_edges_tensor generation:  0.0006356239318847656
mini_batch_src_global generation:  0.0013530254364013672
r_  generation:  0.011094093322753906
local_output_nid generation:  0.0010333061218261719
local_in_edges_tensor generation:  0.0006821155548095703
mini_batch_src_global generation:  0.0013904571533203125
r_  generation:  0.010878562927246094
local_output_nid generation:  0.0010225772857666016
local_in_edges_tensor generation:  0.0006730556488037109
mini_batch_src_global generation:  0.0015101432800292969
r_  generation:  0.010741233825683594
local_output_nid generation:  0.0010161399841308594
local_in_edges_tensor generation:  0.0006532669067382812
mini_batch_src_global generation:  0.0014374256134033203
r_  generation:  0.010979413986206055
local_output_nid generation:  0.0010492801666259766
local_in_edges_tensor generation:  0.0006964206695556641
mini_batch_src_global generation:  0.001451730728149414
r_  generation:  0.011190652847290039
local_output_nid generation:  0.0010123252868652344
local_in_edges_tensor generation:  0.0006809234619140625
mini_batch_src_global generation:  0.0014331340789794922
r_  generation:  0.010818243026733398
local_output_nid generation:  0.0010170936584472656
local_in_edges_tensor generation:  0.0006661415100097656
mini_batch_src_global generation:  0.0013289451599121094
r_  generation:  0.01055288314819336
local_output_nid generation:  0.0010302066802978516
local_in_edges_tensor generation:  0.0006966590881347656
mini_batch_src_global generation:  0.001363992691040039
r_  generation:  0.010252714157104492
local_output_nid generation:  0.0010411739349365234
local_in_edges_tensor generation:  0.0006775856018066406
mini_batch_src_global generation:  0.0013794898986816406
r_  generation:  0.01090693473815918
local_output_nid generation:  0.001058816909790039
local_in_edges_tensor generation:  0.0006546974182128906
mini_batch_src_global generation:  0.0013952255249023438
r_  generation:  0.010635137557983398
local_output_nid generation:  0.0010395050048828125
local_in_edges_tensor generation:  0.0006666183471679688
mini_batch_src_global generation:  0.0013499259948730469
r_  generation:  0.011054754257202148
local_output_nid generation:  0.0010225772857666016
local_in_edges_tensor generation:  0.0006399154663085938
mini_batch_src_global generation:  0.0014667510986328125
r_  generation:  0.010539770126342773
local_output_nid generation:  0.0010383129119873047
local_in_edges_tensor generation:  0.0007059574127197266
mini_batch_src_global generation:  0.0013823509216308594
r_  generation:  0.010920047760009766
local_output_nid generation:  0.0010089874267578125
local_in_edges_tensor generation:  0.0006611347198486328
mini_batch_src_global generation:  0.0013227462768554688
r_  generation:  0.010439634323120117
local_output_nid generation:  0.0010266304016113281
local_in_edges_tensor generation:  0.0006620883941650391
mini_batch_src_global generation:  0.0014851093292236328
r_  generation:  0.010801315307617188
local_output_nid generation:  0.0010242462158203125
local_in_edges_tensor generation:  0.0006530284881591797
mini_batch_src_global generation:  0.0013718605041503906
r_  generation:  0.010324716567993164
local_output_nid generation:  0.001008749008178711
local_in_edges_tensor generation:  0.0006718635559082031
mini_batch_src_global generation:  0.0014019012451171875
r_  generation:  0.010866880416870117
local_output_nid generation:  0.0010499954223632812
local_in_edges_tensor generation:  0.0006768703460693359
mini_batch_src_global generation:  0.0013620853424072266
r_  generation:  0.010266304016113281
local_output_nid generation:  0.0009970664978027344
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.001394033432006836
r_  generation:  0.010974407196044922
local_output_nid generation:  0.001018524169921875
local_in_edges_tensor generation:  0.0006666183471679688
mini_batch_src_global generation:  0.0014247894287109375
r_  generation:  0.014138460159301758
local_output_nid generation:  0.0010116100311279297
local_in_edges_tensor generation:  0.0006732940673828125
mini_batch_src_global generation:  0.0015189647674560547
r_  generation:  0.010868310928344727
----------------------check_connections_block total spend ----------------------------- 0.5717382431030273
generate_one_block  0.030922412872314453
generate_one_block  0.02338552474975586
generate_one_block  0.021633625030517578
generate_one_block  0.020225048065185547
generate_one_block  0.036620140075683594
generate_one_block  0.019664764404296875
generate_one_block  0.01926565170288086
generate_one_block  0.01967477798461914
generate_one_block  0.01886272430419922
generate_one_block  0.019074201583862305
generate_one_block  0.018146753311157227
generate_one_block  0.01923394203186035
generate_one_block  0.01878952980041504
generate_one_block  0.01840376853942871
generate_one_block  0.01900506019592285
generate_one_block  0.018960237503051758
generate_one_block  0.018723249435424805
generate_one_block  0.01799297332763672
generate_one_block  0.017876386642456055
generate_one_block  0.01870131492614746
generate_one_block  0.018327713012695312
generate_one_block  0.018904924392700195
generate_one_block  0.020987987518310547
generate_one_block  0.019159793853759766
generate_one_block  0.01806807518005371
generate_one_block  0.018473386764526367
generate_one_block  0.01778268814086914
generate_one_block  0.01878666877746582
generate_one_block  0.017764568328857422
generate_one_block  0.01871633529663086
generate_one_block  0.0186769962310791
generate_one_block  0.01822638511657715
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07836484909057617
gen group dst list time:  0.026310443878173828
time for parepare:  0.02213597297668457
local_output_nid generation:  0.005767345428466797
local_in_edges_tensor generation:  0.018794536590576172
mini_batch_src_global generation:  0.020830154418945312
r_  generation:  0.1700916290283203
local_output_nid generation:  0.007741689682006836
local_in_edges_tensor generation:  0.010923385620117188
mini_batch_src_global generation:  0.024188756942749023
r_  generation:  0.1741173267364502
local_output_nid generation:  0.008125543594360352
local_in_edges_tensor generation:  0.102203369140625
mini_batch_src_global generation:  0.02405261993408203
r_  generation:  0.1775496006011963
local_output_nid generation:  0.008251428604125977
local_in_edges_tensor generation:  0.008909225463867188
mini_batch_src_global generation:  0.026040077209472656
r_  generation:  0.18264555931091309
local_output_nid generation:  0.00942683219909668
local_in_edges_tensor generation:  0.009066104888916016
mini_batch_src_global generation:  0.024459362030029297
r_  generation:  0.18023085594177246
local_output_nid generation:  0.009264230728149414
local_in_edges_tensor generation:  0.009282588958740234
mini_batch_src_global generation:  0.02816319465637207
r_  generation:  0.1909029483795166
local_output_nid generation:  0.00943899154663086
local_in_edges_tensor generation:  0.009269475936889648
mini_batch_src_global generation:  0.025578975677490234
r_  generation:  0.18747925758361816
local_output_nid generation:  0.008950471878051758
local_in_edges_tensor generation:  0.01224660873413086
mini_batch_src_global generation:  0.027445316314697266
r_  generation:  0.19313621520996094
local_output_nid generation:  0.008705854415893555
local_in_edges_tensor generation:  0.01238870620727539
mini_batch_src_global generation:  0.026829004287719727
r_  generation:  0.19000482559204102
local_output_nid generation:  0.00919485092163086
local_in_edges_tensor generation:  0.008722066879272461
mini_batch_src_global generation:  0.02601337432861328
r_  generation:  0.19770169258117676
local_output_nid generation:  0.01110219955444336
local_in_edges_tensor generation:  0.011475086212158203
mini_batch_src_global generation:  0.030360937118530273
r_  generation:  0.17989683151245117
local_output_nid generation:  0.009548187255859375
local_in_edges_tensor generation:  0.008910179138183594
mini_batch_src_global generation:  0.025732994079589844
r_  generation:  0.18398809432983398
local_output_nid generation:  0.009428739547729492
local_in_edges_tensor generation:  0.010288715362548828
mini_batch_src_global generation:  0.02623462677001953
r_  generation:  0.18573594093322754
local_output_nid generation:  0.009304046630859375
local_in_edges_tensor generation:  0.00879812240600586
mini_batch_src_global generation:  0.02587580680847168
r_  generation:  0.18150925636291504
local_output_nid generation:  0.009654521942138672
local_in_edges_tensor generation:  0.009605646133422852
mini_batch_src_global generation:  0.024884462356567383
r_  generation:  0.18613719940185547
local_output_nid generation:  0.011543750762939453
local_in_edges_tensor generation:  0.010530710220336914
mini_batch_src_global generation:  0.023839473724365234
r_  generation:  0.18447184562683105
local_output_nid generation:  0.009542226791381836
local_in_edges_tensor generation:  0.009582996368408203
mini_batch_src_global generation:  0.036023616790771484
r_  generation:  0.23189973831176758
local_output_nid generation:  0.009966135025024414
local_in_edges_tensor generation:  0.010185003280639648
mini_batch_src_global generation:  0.025147199630737305
r_  generation:  0.18021750450134277
local_output_nid generation:  0.00947427749633789
local_in_edges_tensor generation:  0.009340047836303711
mini_batch_src_global generation:  0.022266864776611328
r_  generation:  0.17580175399780273
local_output_nid generation:  0.009575366973876953
local_in_edges_tensor generation:  0.008996009826660156
mini_batch_src_global generation:  0.024816513061523438
r_  generation:  0.18419265747070312
local_output_nid generation:  0.009609460830688477
local_in_edges_tensor generation:  0.008572101593017578
mini_batch_src_global generation:  0.022547245025634766
r_  generation:  0.1834700107574463
local_output_nid generation:  0.009618282318115234
local_in_edges_tensor generation:  0.012853384017944336
mini_batch_src_global generation:  0.0267181396484375
r_  generation:  0.18931174278259277
local_output_nid generation:  0.009463071823120117
local_in_edges_tensor generation:  0.00965261459350586
mini_batch_src_global generation:  0.02279376983642578
r_  generation:  0.18230032920837402
local_output_nid generation:  0.010459661483764648
local_in_edges_tensor generation:  0.010741949081420898
mini_batch_src_global generation:  0.027645349502563477
r_  generation:  0.18514037132263184
local_output_nid generation:  0.009341239929199219
local_in_edges_tensor generation:  0.008780717849731445
mini_batch_src_global generation:  0.02249741554260254
r_  generation:  0.17748451232910156
local_output_nid generation:  0.009463310241699219
local_in_edges_tensor generation:  0.008941888809204102
mini_batch_src_global generation:  0.03483223915100098
r_  generation:  0.20688605308532715
local_output_nid generation:  0.014063358306884766
local_in_edges_tensor generation:  0.012647390365600586
mini_batch_src_global generation:  0.0270998477935791
r_  generation:  0.19699358940124512
local_output_nid generation:  0.014119863510131836
local_in_edges_tensor generation:  0.011425018310546875
mini_batch_src_global generation:  0.02562856674194336
r_  generation:  0.1935718059539795
local_output_nid generation:  0.010186910629272461
local_in_edges_tensor generation:  0.01064610481262207
mini_batch_src_global generation:  0.024183988571166992
r_  generation:  0.1829378604888916
local_output_nid generation:  0.009953737258911133
local_in_edges_tensor generation:  0.012798070907592773
mini_batch_src_global generation:  0.02450084686279297
r_  generation:  0.18449759483337402
local_output_nid generation:  0.009804964065551758
local_in_edges_tensor generation:  0.011656522750854492
mini_batch_src_global generation:  0.023703575134277344
r_  generation:  0.1996593475341797
local_output_nid generation:  0.011918067932128906
local_in_edges_tensor generation:  0.010240316390991211
mini_batch_src_global generation:  0.023792743682861328
r_  generation:  0.1825547218322754
----------------------check_connections_block total spend ----------------------------- 8.939175605773926
generate_one_block  0.26909494400024414
generate_one_block  0.24709391593933105
generate_one_block  0.2619800567626953
generate_one_block  0.2471773624420166
generate_one_block  0.24489641189575195
generate_one_block  0.25124287605285645
generate_one_block  0.24853849411010742
generate_one_block  0.25875115394592285
generate_one_block  0.258223295211792
generate_one_block  0.26598334312438965
generate_one_block  0.2409207820892334
generate_one_block  0.25251150131225586
generate_one_block  0.2593848705291748
generate_one_block  0.2503228187561035
generate_one_block  0.2569704055786133
generate_one_block  0.2519705295562744
generate_one_block  0.2546074390411377
generate_one_block  0.24427413940429688
generate_one_block  0.24341416358947754
generate_one_block  0.25157594680786133
generate_one_block  0.2408161163330078
generate_one_block  0.25460314750671387
generate_one_block  0.24031543731689453
generate_one_block  0.25354790687561035
generate_one_block  0.23599863052368164
generate_one_block  0.24832749366760254
generate_one_block  0.2450251579284668
generate_one_block  0.25739431381225586
generate_one_block  0.24054932594299316
generate_one_block  0.2471003532409668
generate_one_block  0.25294017791748047
generate_one_block  0.24851703643798828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03402304649353027
gen group dst list time:  0.11620020866394043
time for parepare:  0.022655725479125977
local_output_nid generation:  0.027228593826293945
local_in_edges_tensor generation:  0.04857659339904785
mini_batch_src_global generation:  0.04032754898071289
r_  generation:  0.4276125431060791
local_output_nid generation:  0.03229498863220215
local_in_edges_tensor generation:  0.03241133689880371
mini_batch_src_global generation:  0.0504765510559082
r_  generation:  0.4237534999847412
local_output_nid generation:  0.03264474868774414
local_in_edges_tensor generation:  0.02822399139404297
mini_batch_src_global generation:  0.05117607116699219
r_  generation:  0.4425373077392578
local_output_nid generation:  0.03310704231262207
local_in_edges_tensor generation:  0.028369903564453125
mini_batch_src_global generation:  0.05043983459472656
r_  generation:  0.4344358444213867
local_output_nid generation:  0.03255105018615723
local_in_edges_tensor generation:  0.02840423583984375
mini_batch_src_global generation:  0.05033564567565918
r_  generation:  0.43555760383605957
local_output_nid generation:  0.033393144607543945
local_in_edges_tensor generation:  0.028580427169799805
mini_batch_src_global generation:  0.05133795738220215
r_  generation:  0.4364964962005615
local_output_nid generation:  0.03230023384094238
local_in_edges_tensor generation:  0.03297853469848633
mini_batch_src_global generation:  0.05191612243652344
r_  generation:  0.4379243850708008
local_output_nid generation:  0.03149604797363281
local_in_edges_tensor generation:  0.0332949161529541
mini_batch_src_global generation:  0.05375313758850098
r_  generation:  0.4438302516937256
local_output_nid generation:  0.03122401237487793
local_in_edges_tensor generation:  0.029180288314819336
mini_batch_src_global generation:  0.05120444297790527
r_  generation:  0.4401981830596924
local_output_nid generation:  0.031077861785888672
local_in_edges_tensor generation:  0.09885263442993164
mini_batch_src_global generation:  0.05129098892211914
r_  generation:  0.4410970211029053
local_output_nid generation:  0.030838966369628906
local_in_edges_tensor generation:  0.029554128646850586
mini_batch_src_global generation:  0.05068373680114746
r_  generation:  0.43650221824645996
local_output_nid generation:  0.031232833862304688
local_in_edges_tensor generation:  0.027101516723632812
mini_batch_src_global generation:  0.0523831844329834
r_  generation:  0.4393784999847412
local_output_nid generation:  0.03119516372680664
local_in_edges_tensor generation:  0.03525376319885254
mini_batch_src_global generation:  0.0523529052734375
r_  generation:  0.4378499984741211
local_output_nid generation:  0.03131222724914551
local_in_edges_tensor generation:  0.031037330627441406
mini_batch_src_global generation:  0.05238699913024902
r_  generation:  0.4375786781311035
local_output_nid generation:  0.03136253356933594
local_in_edges_tensor generation:  0.02775740623474121
mini_batch_src_global generation:  0.05274486541748047
r_  generation:  0.43846607208251953
local_output_nid generation:  0.031249523162841797
local_in_edges_tensor generation:  0.02692246437072754
mini_batch_src_global generation:  0.05195260047912598
r_  generation:  0.435443639755249
local_output_nid generation:  0.03098440170288086
local_in_edges_tensor generation:  0.027433156967163086
mini_batch_src_global generation:  0.05045056343078613
r_  generation:  0.43991994857788086
local_output_nid generation:  0.031043291091918945
local_in_edges_tensor generation:  0.03161001205444336
mini_batch_src_global generation:  0.052465200424194336
r_  generation:  0.45358753204345703
local_output_nid generation:  0.03373003005981445
local_in_edges_tensor generation:  0.027894258499145508
mini_batch_src_global generation:  0.05416727066040039
r_  generation:  0.43543219566345215
local_output_nid generation:  0.03007221221923828
local_in_edges_tensor generation:  0.028629779815673828
mini_batch_src_global generation:  0.05328726768493652
r_  generation:  0.4341461658477783
local_output_nid generation:  0.02977299690246582
local_in_edges_tensor generation:  0.02730703353881836
mini_batch_src_global generation:  0.05105257034301758
r_  generation:  0.4356405735015869
local_output_nid generation:  0.02983403205871582
local_in_edges_tensor generation:  0.02733922004699707
mini_batch_src_global generation:  0.05161404609680176
r_  generation:  0.43414759635925293
local_output_nid generation:  0.029796123504638672
local_in_edges_tensor generation:  0.030200958251953125
mini_batch_src_global generation:  0.050362586975097656
r_  generation:  0.4332387447357178
local_output_nid generation:  0.02998208999633789
local_in_edges_tensor generation:  0.0281522274017334
mini_batch_src_global generation:  0.05329728126525879
r_  generation:  0.4474008083343506
local_output_nid generation:  0.0298764705657959
local_in_edges_tensor generation:  0.027239322662353516
mini_batch_src_global generation:  0.05048513412475586
r_  generation:  0.43896985054016113
local_output_nid generation:  0.03027963638305664
local_in_edges_tensor generation:  0.02849745750427246
mini_batch_src_global generation:  0.05295252799987793
r_  generation:  0.43848347663879395
local_output_nid generation:  0.02965688705444336
local_in_edges_tensor generation:  0.02722644805908203
mini_batch_src_global generation:  0.05067920684814453
r_  generation:  0.43518567085266113
local_output_nid generation:  0.029991865158081055
local_in_edges_tensor generation:  0.03182411193847656
mini_batch_src_global generation:  0.05216050148010254
r_  generation:  0.4399118423461914
local_output_nid generation:  0.03064417839050293
local_in_edges_tensor generation:  0.026711463928222656
mini_batch_src_global generation:  0.052106380462646484
r_  generation:  0.4400663375854492
local_output_nid generation:  0.02986598014831543
local_in_edges_tensor generation:  0.026997804641723633
mini_batch_src_global generation:  0.05151677131652832
r_  generation:  0.4372859001159668
local_output_nid generation:  0.030108928680419922
local_in_edges_tensor generation:  0.030534029006958008
mini_batch_src_global generation:  0.05333399772644043
r_  generation:  0.44386720657348633
local_output_nid generation:  0.030200719833374023
local_in_edges_tensor generation:  0.027688264846801758
mini_batch_src_global generation:  0.052477359771728516
r_  generation:  0.43877649307250977
----------------------check_connections_block total spend ----------------------------- 20.861299991607666
generate_one_block  0.6059672832489014
generate_one_block  0.5853803157806396
generate_one_block  0.5918176174163818
generate_one_block  0.5873310565948486
generate_one_block  0.5811879634857178
generate_one_block  0.5835938453674316
generate_one_block  0.6227197647094727
generate_one_block  0.5981745719909668
generate_one_block  0.584984302520752
generate_one_block  0.5874459743499756
generate_one_block  0.5808072090148926
generate_one_block  0.5837736129760742
generate_one_block  0.5895006656646729
generate_one_block  0.5883080959320068
generate_one_block  0.5867624282836914
generate_one_block  0.5822336673736572
generate_one_block  0.5883724689483643
generate_one_block  0.5816168785095215
generate_one_block  0.5915927886962891
generate_one_block  0.585425853729248
generate_one_block  0.5817136764526367
generate_one_block  0.5829250812530518
generate_one_block  0.5817680358886719
generate_one_block  0.5888535976409912
generate_one_block  0.5802228450775146
generate_one_block  0.5923418998718262
generate_one_block  0.5858790874481201
generate_one_block  0.5903944969177246
generate_one_block  0.5861968994140625
generate_one_block  0.5873126983642578
generate_one_block  0.5972645282745361
generate_one_block  0.5957252979278564
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.12769079208374023  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

connection checking time:  29.800475597381592
block generation total time  26.861664056777954
average batch blocks generation time:  0.8394270017743111
block dataloader generation time/epoch 59.71935663223267
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10702896118164062  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.131491661071777  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10661458969116211  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.85297393798828  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.106842041015625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.001434326171875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10695457458496094  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.015517711639404  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1064443588256836  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.789538860321045  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10639333724975586  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.02080249786377  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10653257369995117  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.018420219421387  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1072087287902832  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.42091703414917  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10668277740478516  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.15742254257202  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1067667007446289  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.093246936798096  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10610818862915039  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.51150131225586  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1068105697631836  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.97695541381836  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1065826416015625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.03601360321045  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10654449462890625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.906572341918945  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10693836212158203  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.06187391281128  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1064157485961914  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.998852252960205  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10648298263549805  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.14779806137085  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10638713836669922  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.556535243988037  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10657024383544922  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.366745471954346  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10662412643432617  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.78278636932373  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10620975494384766  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.416837215423584  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10672569274902344  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.020296096801758  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10646486282348633  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.429746627807617  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10700845718383789  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.1277174949646  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10614395141601562  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.427759647369385  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1067056655883789  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.873672008514404  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10634422302246094  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.449896335601807  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10678386688232422  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.20755386352539  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10620355606079102  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.554585933685303  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10615777969360352  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.805668830871582  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10702371597290039  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.18424654006958  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1065220832824707  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.959452152252197  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035608820617198944 |0.019346371293067932 |0.5589988529682159 |9.403377771377563e-05 |1.0635242313146591 |0.00816655158996582 |
----------------------------------------------------------pseudo_mini_loss sum 1.3852108716964722
Total (block generation + training)time/epoch 113.42338724136353
Training time/epoch 53.74103379249573
Training time without block to device /epoch 53.121949911117554
Training time without total dataloading part /epoch 51.93191432952881
load block tensor time/epoch 1.1394822597503662
block to device time/epoch 0.6190838813781738
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  9113370
Number of first layer input nodes during this epoch:  4762586
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1265430450439453  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024260759353637695
range selection method range initialization spend 0.017206192016601562
time for parepare:  0.018011808395385742
local_output_nid generation:  0.0009844303131103516
local_in_edges_tensor generation:  0.007346153259277344
mini_batch_src_global generation:  0.0017507076263427734
r_  generation:  0.011677980422973633
local_output_nid generation:  0.0009806156158447266
local_in_edges_tensor generation:  0.0007147789001464844
mini_batch_src_global generation:  0.001489877700805664
r_  generation:  0.011051177978515625
local_output_nid generation:  0.0009241104125976562
local_in_edges_tensor generation:  0.0006363391876220703
mini_batch_src_global generation:  0.0011320114135742188
r_  generation:  0.009868860244750977
local_output_nid generation:  0.0008952617645263672
local_in_edges_tensor generation:  0.0006058216094970703
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.00998687744140625
local_output_nid generation:  0.0008876323699951172
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0010666847229003906
r_  generation:  0.009500503540039062
local_output_nid generation:  0.0009007453918457031
local_in_edges_tensor generation:  0.0005843639373779297
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.010124921798706055
local_output_nid generation:  0.0008995532989501953
local_in_edges_tensor generation:  0.0005779266357421875
mini_batch_src_global generation:  0.0011136531829833984
r_  generation:  0.01004648208618164
local_output_nid generation:  0.0009133815765380859
local_in_edges_tensor generation:  0.000583648681640625
mini_batch_src_global generation:  0.0011103153228759766
r_  generation:  0.009942770004272461
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0011632442474365234
r_  generation:  0.010436773300170898
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0005886554718017578
mini_batch_src_global generation:  0.0011777877807617188
r_  generation:  0.010671615600585938
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0005824565887451172
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.010366439819335938
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.000591278076171875
mini_batch_src_global generation:  0.0011532306671142578
r_  generation:  0.010593652725219727
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0006079673767089844
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.010429620742797852
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.0012199878692626953
r_  generation:  0.010343790054321289
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0011477470397949219
r_  generation:  0.01011800765991211
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0011188983917236328
r_  generation:  0.010274648666381836
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0005736351013183594
mini_batch_src_global generation:  0.0011935234069824219
r_  generation:  0.01007390022277832
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.009521007537841797
local_output_nid generation:  0.0008537769317626953
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.010076522827148438
local_output_nid generation:  0.0008568763732910156
local_in_edges_tensor generation:  0.0005946159362792969
mini_batch_src_global generation:  0.0011973381042480469
r_  generation:  0.01070857048034668
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.000576019287109375
mini_batch_src_global generation:  0.0012216567993164062
r_  generation:  0.010686874389648438
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0005657672882080078
mini_batch_src_global generation:  0.0012211799621582031
r_  generation:  0.010209321975708008
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005779266357421875
mini_batch_src_global generation:  0.0011126995086669922
r_  generation:  0.01013803482055664
local_output_nid generation:  0.0008542537689208984
local_in_edges_tensor generation:  0.0005528926849365234
mini_batch_src_global generation:  0.0011224746704101562
r_  generation:  0.01026606559753418
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.00055694580078125
mini_batch_src_global generation:  0.0011210441589355469
r_  generation:  0.010165929794311523
local_output_nid generation:  0.0008525848388671875
local_in_edges_tensor generation:  0.0005667209625244141
mini_batch_src_global generation:  0.0011601448059082031
r_  generation:  0.010453939437866211
local_output_nid generation:  0.0008537769317626953
local_in_edges_tensor generation:  0.0005919933319091797
mini_batch_src_global generation:  0.0011813640594482422
r_  generation:  0.01042795181274414
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.000553131103515625
mini_batch_src_global generation:  0.0011477470397949219
r_  generation:  0.010238885879516602
local_output_nid generation:  0.0008528232574462891
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.0012023448944091797
r_  generation:  0.010132074356079102
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0005497932434082031
mini_batch_src_global generation:  0.0011281967163085938
r_  generation:  0.010232925415039062
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.0011739730834960938
r_  generation:  0.010258913040161133
local_output_nid generation:  0.000843048095703125
local_in_edges_tensor generation:  0.0005810260772705078
mini_batch_src_global generation:  0.0011601448059082031
r_  generation:  0.010117292404174805
----------------------check_connections_block total spend ----------------------------- 0.5190773010253906
generate_one_block  0.020798921585083008
generate_one_block  0.021665096282958984
generate_one_block  0.019068479537963867
generate_one_block  0.018717288970947266
generate_one_block  0.017749547958374023
generate_one_block  0.018500566482543945
generate_one_block  0.01826000213623047
generate_one_block  0.01805567741394043
generate_one_block  0.019006967544555664
generate_one_block  0.019305944442749023
generate_one_block  0.018322229385375977
generate_one_block  0.020862340927124023
generate_one_block  0.019156217575073242
generate_one_block  0.018427610397338867
generate_one_block  0.018030405044555664
generate_one_block  0.018245458602905273
generate_one_block  0.01819443702697754
generate_one_block  0.01701211929321289
generate_one_block  0.01818370819091797
generate_one_block  0.01917266845703125
generate_one_block  0.018898725509643555
generate_one_block  0.018277645111083984
generate_one_block  0.018190860748291016
generate_one_block  0.01831531524658203
generate_one_block  0.018062591552734375
generate_one_block  0.018458127975463867
generate_one_block  0.018562793731689453
generate_one_block  0.01798868179321289
generate_one_block  0.017908334732055664
generate_one_block  0.01817798614501953
generate_one_block  0.018264293670654297
generate_one_block  0.018006563186645508
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039658308029174805
gen group dst list time:  0.022470474243164062
time for parepare:  0.020374536514282227
local_output_nid generation:  0.0055658817291259766
local_in_edges_tensor generation:  0.01875901222229004
mini_batch_src_global generation:  0.01786971092224121
r_  generation:  0.17374014854431152
local_output_nid generation:  0.009900808334350586
local_in_edges_tensor generation:  0.011394023895263672
mini_batch_src_global generation:  0.02353811264038086
r_  generation:  0.17596960067749023
local_output_nid generation:  0.008076190948486328
local_in_edges_tensor generation:  0.036444664001464844
mini_batch_src_global generation:  0.022194862365722656
r_  generation:  0.1760547161102295
local_output_nid generation:  0.008199453353881836
local_in_edges_tensor generation:  0.011447429656982422
mini_batch_src_global generation:  0.022420644760131836
r_  generation:  0.17830753326416016
local_output_nid generation:  0.008460044860839844
local_in_edges_tensor generation:  0.011028289794921875
mini_batch_src_global generation:  0.022361040115356445
r_  generation:  0.17325711250305176
local_output_nid generation:  0.008867979049682617
local_in_edges_tensor generation:  0.008873224258422852
mini_batch_src_global generation:  0.022649049758911133
r_  generation:  0.18015289306640625
local_output_nid generation:  0.008931398391723633
local_in_edges_tensor generation:  0.009346246719360352
mini_batch_src_global generation:  0.02276778221130371
r_  generation:  0.18352794647216797
local_output_nid generation:  0.008577108383178711
local_in_edges_tensor generation:  0.011774539947509766
mini_batch_src_global generation:  0.02339625358581543
r_  generation:  0.17819547653198242
local_output_nid generation:  0.008868217468261719
local_in_edges_tensor generation:  0.009136199951171875
mini_batch_src_global generation:  0.024865388870239258
r_  generation:  0.18724322319030762
local_output_nid generation:  0.009256124496459961
local_in_edges_tensor generation:  0.012490034103393555
mini_batch_src_global generation:  0.025518178939819336
r_  generation:  0.19009160995483398
local_output_nid generation:  0.00862884521484375
local_in_edges_tensor generation:  0.009763240814208984
mini_batch_src_global generation:  0.023779869079589844
r_  generation:  0.1806340217590332
local_output_nid generation:  0.009068727493286133
local_in_edges_tensor generation:  0.009146451950073242
mini_batch_src_global generation:  0.02408576011657715
r_  generation:  0.1873619556427002
local_output_nid generation:  0.009314537048339844
local_in_edges_tensor generation:  0.008893013000488281
mini_batch_src_global generation:  0.023993492126464844
r_  generation:  0.1833939552307129
local_output_nid generation:  0.009130239486694336
local_in_edges_tensor generation:  0.010418415069580078
mini_batch_src_global generation:  0.023825407028198242
r_  generation:  0.18705201148986816
local_output_nid generation:  0.009057998657226562
local_in_edges_tensor generation:  0.01134037971496582
mini_batch_src_global generation:  0.024222612380981445
r_  generation:  0.17964673042297363
local_output_nid generation:  0.009093523025512695
local_in_edges_tensor generation:  0.009038686752319336
mini_batch_src_global generation:  0.02346968650817871
r_  generation:  0.18200969696044922
local_output_nid generation:  0.009189128875732422
local_in_edges_tensor generation:  0.008942842483520508
mini_batch_src_global generation:  0.023357152938842773
r_  generation:  0.183394193649292
local_output_nid generation:  0.00866842269897461
local_in_edges_tensor generation:  0.010371923446655273
mini_batch_src_global generation:  0.022072553634643555
r_  generation:  0.16959166526794434
local_output_nid generation:  0.009207487106323242
local_in_edges_tensor generation:  0.010383367538452148
mini_batch_src_global generation:  0.02333354949951172
r_  generation:  0.18211746215820312
local_output_nid generation:  0.00952005386352539
local_in_edges_tensor generation:  0.009334564208984375
mini_batch_src_global generation:  0.0240938663482666
r_  generation:  0.18870019912719727
local_output_nid generation:  0.009539604187011719
local_in_edges_tensor generation:  0.011354923248291016
mini_batch_src_global generation:  0.025653839111328125
r_  generation:  0.18970036506652832
local_output_nid generation:  0.00929713249206543
local_in_edges_tensor generation:  0.010476827621459961
mini_batch_src_global generation:  0.023602008819580078
r_  generation:  0.1820056438446045
local_output_nid generation:  0.009212017059326172
local_in_edges_tensor generation:  0.00960230827331543
mini_batch_src_global generation:  0.02303147315979004
r_  generation:  0.18130970001220703
local_output_nid generation:  0.009217262268066406
local_in_edges_tensor generation:  0.008829832077026367
mini_batch_src_global generation:  0.02327275276184082
r_  generation:  0.18248486518859863
local_output_nid generation:  0.00914764404296875
local_in_edges_tensor generation:  0.008768081665039062
mini_batch_src_global generation:  0.023509502410888672
r_  generation:  0.1798262596130371
local_output_nid generation:  0.009468317031860352
local_in_edges_tensor generation:  0.00935983657836914
mini_batch_src_global generation:  0.026259899139404297
r_  generation:  0.18630170822143555
local_output_nid generation:  0.009475231170654297
local_in_edges_tensor generation:  0.010604143142700195
mini_batch_src_global generation:  0.02383708953857422
r_  generation:  0.18651056289672852
local_output_nid generation:  0.009139060974121094
local_in_edges_tensor generation:  0.008935689926147461
mini_batch_src_global generation:  0.023081541061401367
r_  generation:  0.17866253852844238
local_output_nid generation:  0.009116411209106445
local_in_edges_tensor generation:  0.008998870849609375
mini_batch_src_global generation:  0.023051023483276367
r_  generation:  0.18274927139282227
local_output_nid generation:  0.009363889694213867
local_in_edges_tensor generation:  0.008932113647460938
mini_batch_src_global generation:  0.023050308227539062
r_  generation:  0.1781778335571289
local_output_nid generation:  0.009342670440673828
local_in_edges_tensor generation:  0.008828401565551758
mini_batch_src_global generation:  0.02334880828857422
r_  generation:  0.18270635604858398
local_output_nid generation:  0.009272098541259766
local_in_edges_tensor generation:  0.008790254592895508
mini_batch_src_global generation:  0.023183822631835938
r_  generation:  0.18312406539916992
----------------------check_connections_block total spend ----------------------------- 8.550308227539062
generate_one_block  0.2537713050842285
generate_one_block  0.250105619430542
generate_one_block  0.2445673942565918
generate_one_block  0.2479724884033203
generate_one_block  0.24994349479675293
generate_one_block  0.24398350715637207
generate_one_block  0.24666237831115723
generate_one_block  0.24306488037109375
generate_one_block  0.2534470558166504
generate_one_block  0.2573716640472412
generate_one_block  0.2428452968597412
generate_one_block  0.2552320957183838
generate_one_block  0.2474994659423828
generate_one_block  0.25063204765319824
generate_one_block  0.23984575271606445
generate_one_block  0.24654436111450195
generate_one_block  0.24514985084533691
generate_one_block  0.2257826328277588
generate_one_block  0.24309897422790527
generate_one_block  0.2635073661804199
generate_one_block  0.2581040859222412
generate_one_block  0.2424328327178955
generate_one_block  0.23995041847229004
generate_one_block  0.24461865425109863
generate_one_block  0.23958659172058105
generate_one_block  0.25099754333496094
generate_one_block  0.2505307197570801
generate_one_block  0.24150872230529785
generate_one_block  0.24403095245361328
generate_one_block  0.2408285140991211
generate_one_block  0.24744105339050293
generate_one_block  0.24646472930908203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029230356216430664
gen group dst list time:  0.10437655448913574
time for parepare:  0.01808309555053711
local_output_nid generation:  0.023780345916748047
local_in_edges_tensor generation:  0.047023773193359375
mini_batch_src_global generation:  0.04067373275756836
r_  generation:  0.4195280075073242
local_output_nid generation:  0.03040289878845215
local_in_edges_tensor generation:  0.03435039520263672
mini_batch_src_global generation:  0.05082345008850098
r_  generation:  0.4241492748260498
local_output_nid generation:  0.030366897583007812
local_in_edges_tensor generation:  0.028143882751464844
mini_batch_src_global generation:  0.049095869064331055
r_  generation:  0.4323270320892334
local_output_nid generation:  0.030513286590576172
local_in_edges_tensor generation:  0.02802562713623047
mini_batch_src_global generation:  0.05026960372924805
r_  generation:  0.4262704849243164
local_output_nid generation:  0.030656814575195312
local_in_edges_tensor generation:  0.028588533401489258
mini_batch_src_global generation:  0.04969978332519531
r_  generation:  0.4310460090637207
local_output_nid generation:  0.03099346160888672
local_in_edges_tensor generation:  0.028728008270263672
mini_batch_src_global generation:  0.0506443977355957
r_  generation:  0.43177318572998047
local_output_nid generation:  0.029630184173583984
local_in_edges_tensor generation:  0.029219627380371094
mini_batch_src_global generation:  0.050789594650268555
r_  generation:  0.43599939346313477
local_output_nid generation:  0.029131174087524414
local_in_edges_tensor generation:  0.028658151626586914
mini_batch_src_global generation:  0.051032304763793945
r_  generation:  0.43248677253723145
local_output_nid generation:  0.02947545051574707
local_in_edges_tensor generation:  0.028591394424438477
mini_batch_src_global generation:  0.050932884216308594
r_  generation:  0.44045591354370117
local_output_nid generation:  0.029686450958251953
local_in_edges_tensor generation:  0.028569459915161133
mini_batch_src_global generation:  0.05164933204650879
r_  generation:  0.43495774269104004
local_output_nid generation:  0.029107332229614258
local_in_edges_tensor generation:  0.028355836868286133
mini_batch_src_global generation:  0.050516605377197266
r_  generation:  0.43576478958129883
local_output_nid generation:  0.0291292667388916
local_in_edges_tensor generation:  0.029137849807739258
mini_batch_src_global generation:  0.051392555236816406
r_  generation:  0.4366738796234131
local_output_nid generation:  0.02952861785888672
local_in_edges_tensor generation:  0.028936147689819336
mini_batch_src_global generation:  0.050275325775146484
r_  generation:  0.4393448829650879
local_output_nid generation:  0.02916693687438965
local_in_edges_tensor generation:  0.026395797729492188
mini_batch_src_global generation:  0.05148744583129883
r_  generation:  0.4320962429046631
local_output_nid generation:  0.029166221618652344
local_in_edges_tensor generation:  0.029425621032714844
mini_batch_src_global generation:  0.050459861755371094
r_  generation:  0.4369652271270752
local_output_nid generation:  0.029495716094970703
local_in_edges_tensor generation:  0.03094792366027832
mini_batch_src_global generation:  0.05155491828918457
r_  generation:  0.43435049057006836
local_output_nid generation:  0.029363155364990234
local_in_edges_tensor generation:  0.02728128433227539
mini_batch_src_global generation:  0.050043344497680664
r_  generation:  0.438396692276001
local_output_nid generation:  0.030188560485839844
local_in_edges_tensor generation:  0.02775859832763672
mini_batch_src_global generation:  0.051122188568115234
r_  generation:  0.42730164527893066
local_output_nid generation:  0.029239892959594727
local_in_edges_tensor generation:  0.027106046676635742
mini_batch_src_global generation:  0.0505223274230957
r_  generation:  0.4359569549560547
local_output_nid generation:  0.02972126007080078
local_in_edges_tensor generation:  0.03245806694030762
mini_batch_src_global generation:  0.05184483528137207
r_  generation:  0.44267797470092773
local_output_nid generation:  0.02970719337463379
local_in_edges_tensor generation:  0.02920818328857422
mini_batch_src_global generation:  0.05144476890563965
r_  generation:  0.4405043125152588
local_output_nid generation:  0.0293576717376709
local_in_edges_tensor generation:  0.028692007064819336
mini_batch_src_global generation:  0.05358409881591797
r_  generation:  0.4339902400970459
local_output_nid generation:  0.029649972915649414
local_in_edges_tensor generation:  0.029228925704956055
mini_batch_src_global generation:  0.050633907318115234
r_  generation:  0.4363877773284912
local_output_nid generation:  0.02929830551147461
local_in_edges_tensor generation:  0.029982805252075195
mini_batch_src_global generation:  0.05159258842468262
r_  generation:  0.4318063259124756
local_output_nid generation:  0.029370784759521484
local_in_edges_tensor generation:  0.027124404907226562
mini_batch_src_global generation:  0.05034351348876953
r_  generation:  0.43954968452453613
local_output_nid generation:  0.02979111671447754
local_in_edges_tensor generation:  0.032881975173950195
mini_batch_src_global generation:  0.05125689506530762
r_  generation:  0.43535661697387695
local_output_nid generation:  0.02930736541748047
local_in_edges_tensor generation:  0.03267240524291992
mini_batch_src_global generation:  0.05060863494873047
r_  generation:  0.4414830207824707
local_output_nid generation:  0.02916550636291504
local_in_edges_tensor generation:  0.02698349952697754
mini_batch_src_global generation:  0.051979780197143555
r_  generation:  0.4346890449523926
local_output_nid generation:  0.02949237823486328
local_in_edges_tensor generation:  0.026961088180541992
mini_batch_src_global generation:  0.05027174949645996
r_  generation:  0.4373927116394043
local_output_nid generation:  0.02973198890686035
local_in_edges_tensor generation:  0.027086496353149414
mini_batch_src_global generation:  0.05199432373046875
r_  generation:  0.4333987236022949
local_output_nid generation:  0.030001163482666016
local_in_edges_tensor generation:  0.028598308563232422
mini_batch_src_global generation:  0.05260896682739258
r_  generation:  0.43755626678466797
local_output_nid generation:  0.0292971134185791
local_in_edges_tensor generation:  0.027208328247070312
mini_batch_src_global generation:  0.05131340026855469
r_  generation:  0.4316868782043457
----------------------check_connections_block total spend ----------------------------- 20.57445740699768
generate_one_block  0.581702709197998
generate_one_block  0.5939421653747559
generate_one_block  0.5855114459991455
generate_one_block  0.583010196685791
generate_one_block  0.6700937747955322
generate_one_block  0.5793430805206299
generate_one_block  0.5943987369537354
generate_one_block  0.5852048397064209
generate_one_block  0.5844204425811768
generate_one_block  0.5891401767730713
generate_one_block  0.5831420421600342
generate_one_block  0.5861830711364746
generate_one_block  0.5965969562530518
generate_one_block  0.581554651260376
generate_one_block  0.5775227546691895
generate_one_block  0.5841209888458252
generate_one_block  0.5849239826202393
generate_one_block  0.5754351615905762
generate_one_block  0.5881004333496094
generate_one_block  0.5938019752502441
generate_one_block  0.5907564163208008
generate_one_block  0.5891320705413818
generate_one_block  0.5819084644317627
generate_one_block  0.5800421237945557
generate_one_block  0.6016674041748047
generate_one_block  0.588212251663208
generate_one_block  0.5861620903015137
generate_one_block  0.5796887874603271
generate_one_block  0.5840137004852295
generate_one_block  0.5855114459991455
generate_one_block  0.5889801979064941
generate_one_block  0.5805814266204834
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1265430450439453  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

connection checking time:  29.124765634536743
block generation total time  26.732328414916992
average batch blocks generation time:  0.835385262966156
block dataloader generation time/epoch 59.66432575746016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10653352737426758  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.931363582611084  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10682010650634766  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.262351989746094  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10649490356445312  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.98692560195923  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10661840438842773  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.028798580169678  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1061100959777832  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.509467601776123  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10671663284301758  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.930077075958252  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10683012008666992  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.971639156341553  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10638189315795898  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.738285064697266  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10668087005615234  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.273134231567383  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10687971115112305  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.4638409614563  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1063838005065918  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.86786127090454  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10675430297851562  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.353042602539062  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10692548751831055  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.087488651275635  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10626411437988281  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.998121738433838  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10626840591430664  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.640414714813232  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1063394546508789  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.880120754241943  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10670661926269531  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.908584117889404  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1057591438293457  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 17.967589855194092  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10644960403442383  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.832050800323486  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10735511779785156  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.37611961364746  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10694551467895508  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.406050205230713  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10687065124511719  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.848772525787354  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10668039321899414  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.705090522766113  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10617828369140625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.794722080230713  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10650825500488281  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.708240509033203  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10689306259155273  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.107827186584473  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10673666000366211  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.014026165008545  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10624551773071289  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.494772911071777  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10640430450439453  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.80372905731201  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10662412643432617  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.616016387939453  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10651159286499023  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.884401321411133  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1063547134399414  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.79518222808838  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03501348942518234 |0.019543498754501343 |0.5535572543740273 |9.35867428779602e-05 |1.0592524409294128 |0.003612041473388672 |
----------------------------------------------------------pseudo_mini_loss sum 1.3679306507110596
Total (block generation + training)time/epoch 113.34357270327482
Training time/epoch 53.43114423751831
Training time without block to device /epoch 52.80575227737427
Training time without total dataloading part /epoch 51.616517066955566
load block tensor time/epoch 1.120431661605835
block to device time/epoch 0.625391960144043
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  9110791
Number of first layer input nodes during this epoch:  4759732
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1261749267578125  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023842573165893555
range selection method range initialization spend 0.013502120971679688
time for parepare:  0.020003557205200195
local_output_nid generation:  0.000949859619140625
local_in_edges_tensor generation:  0.006261110305786133
mini_batch_src_global generation:  0.003145456314086914
r_  generation:  0.014241218566894531
local_output_nid generation:  0.0013165473937988281
local_in_edges_tensor generation:  0.0008187294006347656
mini_batch_src_global generation:  0.0018999576568603516
r_  generation:  0.011762142181396484
local_output_nid generation:  0.001226186752319336
local_in_edges_tensor generation:  0.0007147789001464844
mini_batch_src_global generation:  0.0012791156768798828
r_  generation:  0.010116815567016602
local_output_nid generation:  0.0011858940124511719
local_in_edges_tensor generation:  0.0007033348083496094
mini_batch_src_global generation:  0.001306295394897461
r_  generation:  0.010595321655273438
local_output_nid generation:  0.001146078109741211
local_in_edges_tensor generation:  0.0007083415985107422
mini_batch_src_global generation:  0.0013394355773925781
r_  generation:  0.010751724243164062
local_output_nid generation:  0.0011336803436279297
local_in_edges_tensor generation:  0.0007033348083496094
mini_batch_src_global generation:  0.0014507770538330078
r_  generation:  0.02126288414001465
local_output_nid generation:  0.0013120174407958984
local_in_edges_tensor generation:  0.0007703304290771484
mini_batch_src_global generation:  0.001474618911743164
r_  generation:  0.010624170303344727
local_output_nid generation:  0.0010843276977539062
local_in_edges_tensor generation:  0.0006389617919921875
mini_batch_src_global generation:  0.001214742660522461
r_  generation:  0.010008811950683594
local_output_nid generation:  0.0009768009185791016
local_in_edges_tensor generation:  0.0005905628204345703
mini_batch_src_global generation:  0.0012707710266113281
r_  generation:  0.010437726974487305
local_output_nid generation:  0.0009527206420898438
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.010241270065307617
local_output_nid generation:  0.0009014606475830078
local_in_edges_tensor generation:  0.0005829334259033203
mini_batch_src_global generation:  0.0011138916015625
r_  generation:  0.010165214538574219
local_output_nid generation:  0.0009007453918457031
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.001130819320678711
r_  generation:  0.01028895378112793
local_output_nid generation:  0.0008814334869384766
local_in_edges_tensor generation:  0.0005762577056884766
mini_batch_src_global generation:  0.0011320114135742188
r_  generation:  0.01042032241821289
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0005834102630615234
mini_batch_src_global generation:  0.0011029243469238281
r_  generation:  0.010102510452270508
local_output_nid generation:  0.0008778572082519531
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.010325908660888672
local_output_nid generation:  0.0008757114410400391
local_in_edges_tensor generation:  0.0005784034729003906
mini_batch_src_global generation:  0.0011053085327148438
r_  generation:  0.010387897491455078
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.0005619525909423828
mini_batch_src_global generation:  0.0011234283447265625
r_  generation:  0.010320425033569336
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.001207590103149414
r_  generation:  0.010535478591918945
local_output_nid generation:  0.0008718967437744141
local_in_edges_tensor generation:  0.0005419254302978516
mini_batch_src_global generation:  0.0013053417205810547
r_  generation:  0.014349222183227539
local_output_nid generation:  0.0009295940399169922
local_in_edges_tensor generation:  0.0006060600280761719
mini_batch_src_global generation:  0.001294851303100586
r_  generation:  0.010426759719848633
local_output_nid generation:  0.0008842945098876953
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0011892318725585938
r_  generation:  0.01050567626953125
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.0011639595031738281
r_  generation:  0.010197877883911133
local_output_nid generation:  0.0008575916290283203
local_in_edges_tensor generation:  0.0005543231964111328
mini_batch_src_global generation:  0.001157522201538086
r_  generation:  0.010433197021484375
local_output_nid generation:  0.0008547306060791016
local_in_edges_tensor generation:  0.0005714893341064453
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.010380268096923828
local_output_nid generation:  0.0008463859558105469
local_in_edges_tensor generation:  0.0005774497985839844
mini_batch_src_global generation:  0.001161813735961914
r_  generation:  0.010145425796508789
local_output_nid generation:  0.0008502006530761719
local_in_edges_tensor generation:  0.0005700588226318359
mini_batch_src_global generation:  0.0011627674102783203
r_  generation:  0.010275840759277344
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005576610565185547
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.010394096374511719
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0005517005920410156
mini_batch_src_global generation:  0.001157999038696289
r_  generation:  0.010258197784423828
local_output_nid generation:  0.0008535385131835938
local_in_edges_tensor generation:  0.0005638599395751953
mini_batch_src_global generation:  0.0012423992156982422
r_  generation:  0.010606765747070312
local_output_nid generation:  0.0008392333984375
local_in_edges_tensor generation:  0.0006368160247802734
mini_batch_src_global generation:  0.0012412071228027344
r_  generation:  0.010755538940429688
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.010204076766967773
local_output_nid generation:  0.0008435249328613281
local_in_edges_tensor generation:  0.0005667209625244141
mini_batch_src_global generation:  0.0011811256408691406
r_  generation:  0.010461568832397461
----------------------check_connections_block total spend ----------------------------- 0.5589056015014648
generate_one_block  0.024637222290039062
generate_one_block  0.02081608772277832
generate_one_block  0.018854379653930664
generate_one_block  0.01972174644470215
generate_one_block  0.019449949264526367
generate_one_block  0.018862247467041016
generate_one_block  0.018761634826660156
generate_one_block  0.018436908721923828
generate_one_block  0.01898479461669922
generate_one_block  0.018256664276123047
generate_one_block  0.018169164657592773
generate_one_block  0.020909786224365234
generate_one_block  0.01934361457824707
generate_one_block  0.01839280128479004
generate_one_block  0.018851757049560547
generate_one_block  0.01866912841796875
generate_one_block  0.01872420310974121
generate_one_block  0.018930673599243164
generate_one_block  0.019936323165893555
generate_one_block  0.02180194854736328
generate_one_block  0.019606828689575195
generate_one_block  0.018188953399658203
generate_one_block  0.019090652465820312
generate_one_block  0.0183107852935791
generate_one_block  0.01845073699951172
generate_one_block  0.01844167709350586
generate_one_block  0.018374204635620117
generate_one_block  0.018532991409301758
generate_one_block  0.01900029182434082
generate_one_block  0.019563913345336914
generate_one_block  0.018390655517578125
generate_one_block  0.01883101463317871
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04427695274353027
gen group dst list time:  0.03404712677001953
time for parepare:  0.023224830627441406
local_output_nid generation:  0.006281375885009766
local_in_edges_tensor generation:  0.01810002326965332
mini_batch_src_global generation:  0.017928123474121094
r_  generation:  0.1668567657470703
local_output_nid generation:  0.007910966873168945
local_in_edges_tensor generation:  0.014081001281738281
mini_batch_src_global generation:  0.02294158935546875
r_  generation:  0.17388105392456055
local_output_nid generation:  0.008553028106689453
local_in_edges_tensor generation:  0.03246879577636719
mini_batch_src_global generation:  0.0208742618560791
r_  generation:  0.17989397048950195
local_output_nid generation:  0.00849604606628418
local_in_edges_tensor generation:  0.013212203979492188
mini_batch_src_global generation:  0.023601531982421875
r_  generation:  0.18703269958496094
local_output_nid generation:  0.008965492248535156
local_in_edges_tensor generation:  0.012121200561523438
mini_batch_src_global generation:  0.02339315414428711
r_  generation:  0.18980193138122559
local_output_nid generation:  0.009988069534301758
local_in_edges_tensor generation:  0.011909723281860352
mini_batch_src_global generation:  0.023696184158325195
r_  generation:  0.18204140663146973
local_output_nid generation:  0.00908803939819336
local_in_edges_tensor generation:  0.008712053298950195
mini_batch_src_global generation:  0.023303985595703125
r_  generation:  0.18700194358825684
local_output_nid generation:  0.00883173942565918
local_in_edges_tensor generation:  0.008659124374389648
mini_batch_src_global generation:  0.022752761840820312
r_  generation:  0.17516851425170898
local_output_nid generation:  0.008828401565551758
local_in_edges_tensor generation:  0.010057210922241211
mini_batch_src_global generation:  0.02393651008605957
r_  generation:  0.18250823020935059
local_output_nid generation:  0.008977413177490234
local_in_edges_tensor generation:  0.00855875015258789
mini_batch_src_global generation:  0.023963451385498047
r_  generation:  0.17660045623779297
local_output_nid generation:  0.00901031494140625
local_in_edges_tensor generation:  0.010604619979858398
mini_batch_src_global generation:  0.022710084915161133
r_  generation:  0.17647051811218262
local_output_nid generation:  0.009508371353149414
local_in_edges_tensor generation:  0.009226083755493164
mini_batch_src_global generation:  0.023868083953857422
r_  generation:  0.18341565132141113
local_output_nid generation:  0.009344100952148438
local_in_edges_tensor generation:  0.008831501007080078
mini_batch_src_global generation:  0.024112701416015625
r_  generation:  0.1855924129486084
local_output_nid generation:  0.009312629699707031
local_in_edges_tensor generation:  0.009103536605834961
mini_batch_src_global generation:  0.023679494857788086
r_  generation:  0.18276500701904297
local_output_nid generation:  0.009481430053710938
local_in_edges_tensor generation:  0.010339736938476562
mini_batch_src_global generation:  0.023621082305908203
r_  generation:  0.18477225303649902
local_output_nid generation:  0.00931096076965332
local_in_edges_tensor generation:  0.009006500244140625
mini_batch_src_global generation:  0.023375749588012695
r_  generation:  0.18299221992492676
local_output_nid generation:  0.00930929183959961
local_in_edges_tensor generation:  0.009083271026611328
mini_batch_src_global generation:  0.02497410774230957
r_  generation:  0.1884324550628662
local_output_nid generation:  0.009560108184814453
local_in_edges_tensor generation:  0.009073495864868164
mini_batch_src_global generation:  0.024104595184326172
r_  generation:  0.1863081455230713
local_output_nid generation:  0.010032415390014648
local_in_edges_tensor generation:  0.01165151596069336
mini_batch_src_global generation:  0.026118755340576172
r_  generation:  0.19897985458374023
local_output_nid generation:  0.009131431579589844
local_in_edges_tensor generation:  0.009384870529174805
mini_batch_src_global generation:  0.024735212326049805
r_  generation:  0.1773395538330078
local_output_nid generation:  0.009554624557495117
local_in_edges_tensor generation:  0.009246349334716797
mini_batch_src_global generation:  0.024084806442260742
r_  generation:  0.1899089813232422
local_output_nid generation:  0.009327173233032227
local_in_edges_tensor generation:  0.008599281311035156
mini_batch_src_global generation:  0.02305746078491211
r_  generation:  0.17989444732666016
local_output_nid generation:  0.0098114013671875
local_in_edges_tensor generation:  0.012886762619018555
mini_batch_src_global generation:  0.023838520050048828
r_  generation:  0.18965482711791992
local_output_nid generation:  0.0095062255859375
local_in_edges_tensor generation:  0.012520313262939453
mini_batch_src_global generation:  0.02375197410583496
r_  generation:  0.18201398849487305
local_output_nid generation:  0.009551763534545898
local_in_edges_tensor generation:  0.009200096130371094
mini_batch_src_global generation:  0.022825241088867188
r_  generation:  0.18262124061584473
local_output_nid generation:  0.009497404098510742
local_in_edges_tensor generation:  0.009741783142089844
mini_batch_src_global generation:  0.024069786071777344
r_  generation:  0.1810290813446045
local_output_nid generation:  0.009409904479980469
local_in_edges_tensor generation:  0.01078343391418457
mini_batch_src_global generation:  0.0228118896484375
r_  generation:  0.18234491348266602
local_output_nid generation:  0.00944972038269043
local_in_edges_tensor generation:  0.009807109832763672
mini_batch_src_global generation:  0.023530960083007812
r_  generation:  0.18510150909423828
local_output_nid generation:  0.00973820686340332
local_in_edges_tensor generation:  0.009762287139892578
mini_batch_src_global generation:  0.024901151657104492
r_  generation:  0.18783044815063477
local_output_nid generation:  0.010112762451171875
local_in_edges_tensor generation:  0.00993657112121582
mini_batch_src_global generation:  0.025641679763793945
r_  generation:  0.19268369674682617
local_output_nid generation:  0.009322166442871094
local_in_edges_tensor generation:  0.009981155395507812
mini_batch_src_global generation:  0.02363109588623047
r_  generation:  0.18071889877319336
local_output_nid generation:  0.009674310684204102
local_in_edges_tensor generation:  0.008982419967651367
mini_batch_src_global generation:  0.023127079010009766
r_  generation:  0.18438315391540527
----------------------check_connections_block total spend ----------------------------- 8.64212155342102
generate_one_block  0.2587127685546875
generate_one_block  0.24567914009094238
generate_one_block  0.24483966827392578
generate_one_block  0.26247453689575195
generate_one_block  0.27751708030700684
generate_one_block  0.25644373893737793
generate_one_block  0.2540709972381592
generate_one_block  0.2440965175628662
generate_one_block  0.2511739730834961
generate_one_block  0.24316692352294922
generate_one_block  0.2427222728729248
generate_one_block  0.2558307647705078
generate_one_block  0.259859561920166
generate_one_block  0.24738597869873047
generate_one_block  0.2478163242340088
generate_one_block  0.24349117279052734
generate_one_block  0.24879217147827148
generate_one_block  0.25068116188049316
generate_one_block  0.2645125389099121
generate_one_block  0.24491620063781738
generate_one_block  0.2535405158996582
generate_one_block  0.2404787540435791
generate_one_block  0.25436925888061523
generate_one_block  0.2494983673095703
generate_one_block  0.24280786514282227
generate_one_block  0.2564725875854492
generate_one_block  0.24250459671020508
generate_one_block  0.2516133785247803
generate_one_block  0.2561373710632324
generate_one_block  0.2611668109893799
generate_one_block  0.2447066307067871
generate_one_block  0.2504866123199463
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03504157066345215
gen group dst list time:  0.11416029930114746
time for parepare:  0.019371747970581055
local_output_nid generation:  0.02552485466003418
local_in_edges_tensor generation:  0.04847264289855957
mini_batch_src_global generation:  0.03992009162902832
r_  generation:  0.4245762825012207
local_output_nid generation:  0.03060626983642578
local_in_edges_tensor generation:  0.037636518478393555
mini_batch_src_global generation:  0.05026435852050781
r_  generation:  0.4205904006958008
local_output_nid generation:  0.03096151351928711
local_in_edges_tensor generation:  0.02924323081970215
mini_batch_src_global generation:  0.04983711242675781
r_  generation:  0.4334406852722168
local_output_nid generation:  0.0320897102355957
local_in_edges_tensor generation:  0.02863335609436035
mini_batch_src_global generation:  0.05074143409729004
r_  generation:  0.4346933364868164
local_output_nid generation:  0.031256675720214844
local_in_edges_tensor generation:  0.03368330001831055
mini_batch_src_global generation:  0.050752878189086914
r_  generation:  0.4405817985534668
local_output_nid generation:  0.03133964538574219
local_in_edges_tensor generation:  0.02961111068725586
mini_batch_src_global generation:  0.05147838592529297
r_  generation:  0.44303154945373535
local_output_nid generation:  0.03127861022949219
local_in_edges_tensor generation:  0.03102874755859375
mini_batch_src_global generation:  0.053369998931884766
r_  generation:  0.44077110290527344
local_output_nid generation:  0.029605627059936523
local_in_edges_tensor generation:  0.03169822692871094
mini_batch_src_global generation:  0.05163002014160156
r_  generation:  0.4394657611846924
local_output_nid generation:  0.029667139053344727
local_in_edges_tensor generation:  0.02948737144470215
mini_batch_src_global generation:  0.051235198974609375
r_  generation:  0.44097471237182617
local_output_nid generation:  0.029237031936645508
local_in_edges_tensor generation:  0.027299165725708008
mini_batch_src_global generation:  0.05336904525756836
r_  generation:  0.44158196449279785
local_output_nid generation:  0.029614686965942383
local_in_edges_tensor generation:  0.02934718132019043
mini_batch_src_global generation:  0.05201911926269531
r_  generation:  0.451434850692749
local_output_nid generation:  0.03299236297607422
local_in_edges_tensor generation:  0.029853105545043945
mini_batch_src_global generation:  0.053964853286743164
r_  generation:  0.442058801651001
local_output_nid generation:  0.03052520751953125
local_in_edges_tensor generation:  0.027748823165893555
mini_batch_src_global generation:  0.05058741569519043
r_  generation:  0.43633246421813965
local_output_nid generation:  0.03049182891845703
local_in_edges_tensor generation:  0.028171777725219727
mini_batch_src_global generation:  0.052171945571899414
r_  generation:  0.43462681770324707
local_output_nid generation:  0.03045797348022461
local_in_edges_tensor generation:  0.02784419059753418
mini_batch_src_global generation:  0.05011439323425293
r_  generation:  0.44382643699645996
local_output_nid generation:  0.030786991119384766
local_in_edges_tensor generation:  0.0299685001373291
mini_batch_src_global generation:  0.0520169734954834
r_  generation:  0.4420187473297119
local_output_nid generation:  0.030260562896728516
local_in_edges_tensor generation:  0.028718233108520508
mini_batch_src_global generation:  0.05204582214355469
r_  generation:  0.4441955089569092
local_output_nid generation:  0.030601024627685547
local_in_edges_tensor generation:  0.02994227409362793
mini_batch_src_global generation:  0.06326508522033691
r_  generation:  0.4349055290222168
local_output_nid generation:  0.030938148498535156
local_in_edges_tensor generation:  0.030059814453125
mini_batch_src_global generation:  0.05155801773071289
r_  generation:  0.4451897144317627
local_output_nid generation:  0.03027486801147461
local_in_edges_tensor generation:  0.02747654914855957
mini_batch_src_global generation:  0.05101943016052246
r_  generation:  0.43566274642944336
local_output_nid generation:  0.030615806579589844
local_in_edges_tensor generation:  0.029053688049316406
mini_batch_src_global generation:  0.051027774810791016
r_  generation:  0.4422636032104492
local_output_nid generation:  0.030873775482177734
local_in_edges_tensor generation:  0.03237032890319824
mini_batch_src_global generation:  0.05190443992614746
r_  generation:  0.43544673919677734
local_output_nid generation:  0.030841350555419922
local_in_edges_tensor generation:  0.030144929885864258
mini_batch_src_global generation:  0.05235028266906738
r_  generation:  0.4420316219329834
local_output_nid generation:  0.031064748764038086
local_in_edges_tensor generation:  0.028448104858398438
mini_batch_src_global generation:  0.05274534225463867
r_  generation:  0.4423708915710449
local_output_nid generation:  0.030608177185058594
local_in_edges_tensor generation:  0.029520034790039062
mini_batch_src_global generation:  0.049901485443115234
r_  generation:  0.44332170486450195
local_output_nid generation:  0.03101325035095215
local_in_edges_tensor generation:  0.029669523239135742
mini_batch_src_global generation:  0.05177021026611328
r_  generation:  0.4383835792541504
local_output_nid generation:  0.031024932861328125
local_in_edges_tensor generation:  0.028337717056274414
mini_batch_src_global generation:  0.05274462699890137
r_  generation:  0.4378621578216553
local_output_nid generation:  0.030724048614501953
local_in_edges_tensor generation:  0.028363466262817383
mini_batch_src_global generation:  0.05103898048400879
r_  generation:  0.43790531158447266
local_output_nid generation:  0.03162527084350586
local_in_edges_tensor generation:  0.03072214126586914
mini_batch_src_global generation:  0.05116724967956543
r_  generation:  0.43970608711242676
local_output_nid generation:  0.031111478805541992
local_in_edges_tensor generation:  0.030204057693481445
mini_batch_src_global generation:  0.052781105041503906
r_  generation:  0.44626355171203613
local_output_nid generation:  0.03042745590209961
local_in_edges_tensor generation:  0.026950597763061523
mini_batch_src_global generation:  0.05099081993103027
r_  generation:  0.4412400722503662
local_output_nid generation:  0.030802249908447266
local_in_edges_tensor generation:  0.02653646469116211
mini_batch_src_global generation:  0.05189013481140137
r_  generation:  0.4352121353149414
----------------------check_connections_block total spend ----------------------------- 20.83142876625061
generate_one_block  0.603257417678833
generate_one_block  0.5814774036407471
generate_one_block  0.5868208408355713
generate_one_block  0.5994977951049805
generate_one_block  0.6952505111694336
generate_one_block  0.5891802310943604
generate_one_block  0.5929234027862549
generate_one_block  0.5843706130981445
generate_one_block  0.5901567935943604
generate_one_block  0.5842673778533936
generate_one_block  0.5926480293273926
generate_one_block  0.5984182357788086
generate_one_block  0.5905656814575195
generate_one_block  0.5835220813751221
generate_one_block  0.5856890678405762
generate_one_block  0.5809698104858398
generate_one_block  0.5898244380950928
generate_one_block  0.5948090553283691
generate_one_block  0.5984630584716797
generate_one_block  0.5833499431610107
generate_one_block  0.5870749950408936
generate_one_block  0.5908164978027344
generate_one_block  0.5997223854064941
generate_one_block  0.5913214683532715
generate_one_block  0.6119475364685059
generate_one_block  0.5903151035308838
generate_one_block  0.5875205993652344
generate_one_block  0.590437650680542
generate_one_block  0.5944790840148926
generate_one_block  0.6156179904937744
generate_one_block  0.5869245529174805
generate_one_block  0.5894393920898438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1261749267578125  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

connection checking time:  29.47355031967163
block generation total time  27.08904528617859
average batch blocks generation time:  0.8465326651930809
block dataloader generation time/epoch 59.6866272687912
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10623311996459961  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.478643894195557  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10650205612182617  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.75201416015625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10625410079956055  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.726884365081787  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1069183349609375  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.401456356048584  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10655784606933594  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.289620876312256  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10678720474243164  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.215359210968018  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10672998428344727  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.149844646453857  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10646724700927734  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.720301151275635  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10639190673828125  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.01245880126953  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10621118545532227  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.617684841156006  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10617733001708984  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.46782922744751  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10682201385498047  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.062207221984863  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10657596588134766  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.130056858062744  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10650205612182617  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.78521490097046  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10666561126708984  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.858238220214844  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10651302337646484  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.792503833770752  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10677242279052734  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.97903871536255  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10677433013916016  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.06992244720459  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10709953308105469  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.652207374572754  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10604524612426758  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.31728219985962  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10681295394897461  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.154083728790283  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10652923583984375  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.617486476898193  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10683107376098633  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.151166915893555  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10679769515991211  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.793588161468506  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10648536682128906  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.561129570007324  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10661649703979492  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.84892225265503  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10644674301147461  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.6339430809021  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10664510726928711  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.963093280792236  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10659933090209961  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.103521823883057  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10732078552246094  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.54089069366455  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10627508163452148  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.760066986083984  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10662698745727539  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.985241413116455  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02969987690448761 |0.019565455615520477 |0.5597193539142609 |9.547173976898193e-05 |1.0665233582258224 |0.005583763122558594 |
----------------------------------------------------------pseudo_mini_loss sum 1.349721908569336
Total (block generation + training)time/epoch 113.3667181134224
Training time/epoch 53.689082860946655
Training time without block to device /epoch 53.06298828125
Training time without total dataloading part /epoch 52.04840564727783
load block tensor time/epoch 0.9503960609436035
block to device time/epoch 0.6260945796966553
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  9114410
Number of first layer input nodes during this epoch:  4761052
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1266160011291504  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023496150970458984
range selection method range initialization spend 0.013672590255737305
time for parepare:  0.02025318145751953
local_output_nid generation:  0.0009837150573730469
local_in_edges_tensor generation:  0.00638270378112793
mini_batch_src_global generation:  0.0015590190887451172
r_  generation:  0.010624408721923828
local_output_nid generation:  0.0009922981262207031
local_in_edges_tensor generation:  0.0006868839263916016
mini_batch_src_global generation:  0.0015842914581298828
r_  generation:  0.010836362838745117
local_output_nid generation:  0.0009694099426269531
local_in_edges_tensor generation:  0.0006289482116699219
mini_batch_src_global generation:  0.0011532306671142578
r_  generation:  0.009813308715820312
local_output_nid generation:  0.0009069442749023438
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0010902881622314453
r_  generation:  0.00977635383605957
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0006859302520751953
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.010068655014038086
local_output_nid generation:  0.0008869171142578125
local_in_edges_tensor generation:  0.0005881786346435547
mini_batch_src_global generation:  0.0011403560638427734
r_  generation:  0.010270118713378906
local_output_nid generation:  0.0009012222290039062
local_in_edges_tensor generation:  0.0006086826324462891
mini_batch_src_global generation:  0.0011932849884033203
r_  generation:  0.010359764099121094
local_output_nid generation:  0.0009093284606933594
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0011012554168701172
r_  generation:  0.010163307189941406
local_output_nid generation:  0.0009136199951171875
local_in_edges_tensor generation:  0.00060272216796875
mini_batch_src_global generation:  0.0011138916015625
r_  generation:  0.010291576385498047
local_output_nid generation:  0.0008945465087890625
local_in_edges_tensor generation:  0.0005667209625244141
mini_batch_src_global generation:  0.0011930465698242188
r_  generation:  0.01035451889038086
local_output_nid generation:  0.0009267330169677734
local_in_edges_tensor generation:  0.0005714893341064453
mini_batch_src_global generation:  0.0011305809020996094
r_  generation:  0.010095357894897461
local_output_nid generation:  0.0008845329284667969
local_in_edges_tensor generation:  0.0005943775177001953
mini_batch_src_global generation:  0.0011882781982421875
r_  generation:  0.010654211044311523
local_output_nid generation:  0.0008962154388427734
local_in_edges_tensor generation:  0.0005822181701660156
mini_batch_src_global generation:  0.0012967586517333984
r_  generation:  0.01082921028137207
local_output_nid generation:  0.00087738037109375
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.001150369644165039
r_  generation:  0.01004648208618164
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.010426998138427734
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.010291099548339844
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005736351013183594
mini_batch_src_global generation:  0.0011513233184814453
r_  generation:  0.010137081146240234
local_output_nid generation:  0.0008876323699951172
local_in_edges_tensor generation:  0.0005578994750976562
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.010261058807373047
local_output_nid generation:  0.0008866786956787109
local_in_edges_tensor generation:  0.0005805492401123047
mini_batch_src_global generation:  0.0011973381042480469
r_  generation:  0.010735511779785156
local_output_nid generation:  0.0008802413940429688
local_in_edges_tensor generation:  0.0005567073822021484
mini_batch_src_global generation:  0.0011532306671142578
r_  generation:  0.009866476058959961
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0012137889862060547
r_  generation:  0.01025700569152832
local_output_nid generation:  0.0008780956268310547
local_in_edges_tensor generation:  0.0005662441253662109
mini_batch_src_global generation:  0.001161336898803711
r_  generation:  0.01021575927734375
local_output_nid generation:  0.0008873939514160156
local_in_edges_tensor generation:  0.0005931854248046875
mini_batch_src_global generation:  0.001157522201538086
r_  generation:  0.010106325149536133
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.001256704330444336
r_  generation:  0.010536670684814453
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.0012350082397460938
r_  generation:  0.010457515716552734
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0006089210510253906
mini_batch_src_global generation:  0.0012583732604980469
r_  generation:  0.010902881622314453
local_output_nid generation:  0.0008792877197265625
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0012764930725097656
r_  generation:  0.010546445846557617
local_output_nid generation:  0.0009069442749023438
local_in_edges_tensor generation:  0.0005950927734375
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.010364294052124023
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0005555152893066406
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.010533332824707031
local_output_nid generation:  0.0008935928344726562
local_in_edges_tensor generation:  0.0005466938018798828
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.01028895378112793
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0005552768707275391
mini_batch_src_global generation:  0.0011224746704101562
r_  generation:  0.010325193405151367
local_output_nid generation:  0.0008938312530517578
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.010361909866333008
----------------------check_connections_block total spend ----------------------------- 0.5240166187286377
generate_one_block  0.02520275115966797
generate_one_block  0.021280288696289062
generate_one_block  0.019759416580200195
generate_one_block  0.018620729446411133
generate_one_block  0.019199609756469727
generate_one_block  0.01917576789855957
generate_one_block  0.018982648849487305
generate_one_block  0.018569231033325195
generate_one_block  0.018886566162109375
generate_one_block  0.018871784210205078
generate_one_block  0.02037525177001953
generate_one_block  0.025106430053710938
generate_one_block  0.02019476890563965
generate_one_block  0.01813673973083496
generate_one_block  0.019141674041748047
generate_one_block  0.018718481063842773
generate_one_block  0.018443584442138672
generate_one_block  0.018506288528442383
generate_one_block  0.019372224807739258
generate_one_block  0.017713308334350586
generate_one_block  0.018691539764404297
generate_one_block  0.018503427505493164
generate_one_block  0.018355131149291992
generate_one_block  0.01902174949645996
generate_one_block  0.018848419189453125
generate_one_block  0.019341707229614258
generate_one_block  0.018838882446289062
generate_one_block  0.018337726593017578
generate_one_block  0.0188138484954834
generate_one_block  0.01821279525756836
generate_one_block  0.018481969833374023
generate_one_block  0.018535375595092773
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03867673873901367
gen group dst list time:  0.023074626922607422
time for parepare:  0.022334575653076172
local_output_nid generation:  0.005690813064575195
local_in_edges_tensor generation:  0.018693208694458008
mini_batch_src_global generation:  0.018828868865966797
r_  generation:  0.1669304370880127
local_output_nid generation:  0.007985353469848633
local_in_edges_tensor generation:  0.010971307754516602
mini_batch_src_global generation:  0.022669553756713867
r_  generation:  0.17012715339660645
local_output_nid generation:  0.00803232192993164
local_in_edges_tensor generation:  0.033902883529663086
mini_batch_src_global generation:  0.02397894859313965
r_  generation:  0.17612123489379883
local_output_nid generation:  0.008153676986694336
local_in_edges_tensor generation:  0.011227130889892578
mini_batch_src_global generation:  0.02378082275390625
r_  generation:  0.1730177402496338
local_output_nid generation:  0.008737802505493164
local_in_edges_tensor generation:  0.009491205215454102
mini_batch_src_global generation:  0.022360801696777344
r_  generation:  0.1824955940246582
local_output_nid generation:  0.008856773376464844
local_in_edges_tensor generation:  0.01100015640258789
mini_batch_src_global generation:  0.023267507553100586
r_  generation:  0.18071389198303223
local_output_nid generation:  0.008917093276977539
local_in_edges_tensor generation:  0.010335445404052734
mini_batch_src_global generation:  0.023287534713745117
r_  generation:  0.1817476749420166
local_output_nid generation:  0.008600950241088867
local_in_edges_tensor generation:  0.010794401168823242
mini_batch_src_global generation:  0.023136138916015625
r_  generation:  0.17624545097351074
local_output_nid generation:  0.008710384368896484
local_in_edges_tensor generation:  0.008910417556762695
mini_batch_src_global generation:  0.023171663284301758
r_  generation:  0.18163251876831055
local_output_nid generation:  0.008725166320800781
local_in_edges_tensor generation:  0.009283781051635742
mini_batch_src_global generation:  0.02364802360534668
r_  generation:  0.18406009674072266
local_output_nid generation:  0.008850812911987305
local_in_edges_tensor generation:  0.008877038955688477
mini_batch_src_global generation:  0.023250102996826172
r_  generation:  0.18066000938415527
local_output_nid generation:  0.009495258331298828
local_in_edges_tensor generation:  0.012085199356079102
mini_batch_src_global generation:  0.025135278701782227
r_  generation:  0.18823766708374023
local_output_nid generation:  0.0095367431640625
local_in_edges_tensor generation:  0.012474775314331055
mini_batch_src_global generation:  0.02568984031677246
r_  generation:  0.19253206253051758
local_output_nid generation:  0.00882267951965332
local_in_edges_tensor generation:  0.01107478141784668
mini_batch_src_global generation:  0.023324012756347656
r_  generation:  0.17255663871765137
local_output_nid generation:  0.009242057800292969
local_in_edges_tensor generation:  0.00940394401550293
mini_batch_src_global generation:  0.0235292911529541
r_  generation:  0.18469643592834473
local_output_nid generation:  0.009141921997070312
local_in_edges_tensor generation:  0.009415864944458008
mini_batch_src_global generation:  0.02456068992614746
r_  generation:  0.18296217918395996
local_output_nid generation:  0.009024381637573242
local_in_edges_tensor generation:  0.011059761047363281
mini_batch_src_global generation:  0.02358269691467285
r_  generation:  0.18451762199401855
local_output_nid generation:  0.009284019470214844
local_in_edges_tensor generation:  0.009039640426635742
mini_batch_src_global generation:  0.023284435272216797
r_  generation:  0.18188118934631348
local_output_nid generation:  0.00959920883178711
local_in_edges_tensor generation:  0.009356498718261719
mini_batch_src_global generation:  0.024002790451049805
r_  generation:  0.18686437606811523
local_output_nid generation:  0.008920431137084961
local_in_edges_tensor generation:  0.00936436653137207
mini_batch_src_global generation:  0.02228999137878418
r_  generation:  0.17320632934570312
local_output_nid generation:  0.009320735931396484
local_in_edges_tensor generation:  0.00922536849975586
mini_batch_src_global generation:  0.023195266723632812
r_  generation:  0.18244075775146484
local_output_nid generation:  0.009310483932495117
local_in_edges_tensor generation:  0.008917093276977539
mini_batch_src_global generation:  0.023310422897338867
r_  generation:  0.1804804801940918
local_output_nid generation:  0.009256839752197266
local_in_edges_tensor generation:  0.008939027786254883
mini_batch_src_global generation:  0.02331089973449707
r_  generation:  0.18307280540466309
local_output_nid generation:  0.009469985961914062
local_in_edges_tensor generation:  0.009463787078857422
mini_batch_src_global generation:  0.02458810806274414
r_  generation:  0.18706727027893066
local_output_nid generation:  0.010871410369873047
local_in_edges_tensor generation:  0.009814262390136719
mini_batch_src_global generation:  0.02337479591369629
r_  generation:  0.18589520454406738
local_output_nid generation:  0.009681224822998047
local_in_edges_tensor generation:  0.009081363677978516
mini_batch_src_global generation:  0.024395465850830078
r_  generation:  0.1888413429260254
local_output_nid generation:  0.009644031524658203
local_in_edges_tensor generation:  0.009243965148925781
mini_batch_src_global generation:  0.02365565299987793
r_  generation:  0.18766379356384277
local_output_nid generation:  0.009312629699707031
local_in_edges_tensor generation:  0.009242534637451172
mini_batch_src_global generation:  0.023488283157348633
r_  generation:  0.18237090110778809
local_output_nid generation:  0.009415388107299805
local_in_edges_tensor generation:  0.009401321411132812
mini_batch_src_global generation:  0.02359628677368164
r_  generation:  0.18711590766906738
local_output_nid generation:  0.009189128875732422
local_in_edges_tensor generation:  0.00927591323852539
mini_batch_src_global generation:  0.02341461181640625
r_  generation:  0.18229436874389648
local_output_nid generation:  0.009251832962036133
local_in_edges_tensor generation:  0.00885009765625
mini_batch_src_global generation:  0.023460865020751953
r_  generation:  0.18302655220031738
local_output_nid generation:  0.009403467178344727
local_in_edges_tensor generation:  0.009209156036376953
mini_batch_src_global generation:  0.023521900177001953
r_  generation:  0.18319964408874512
----------------------check_connections_block total spend ----------------------------- 8.553879261016846
generate_one_block  0.2477405071258545
generate_one_block  0.24235296249389648
generate_one_block  0.24428153038024902
generate_one_block  0.23984789848327637
generate_one_block  0.26563382148742676
generate_one_block  0.25255346298217773
generate_one_block  0.24930214881896973
generate_one_block  0.24033117294311523
generate_one_block  0.24402189254760742
generate_one_block  0.2501838207244873
generate_one_block  0.2421092987060547
generate_one_block  0.25597095489501953
generate_one_block  0.25697946548461914
generate_one_block  0.2322089672088623
generate_one_block  0.24769186973571777
generate_one_block  0.24632835388183594
generate_one_block  0.2450253963470459
generate_one_block  0.2420787811279297
generate_one_block  0.25011706352233887
generate_one_block  0.23530340194702148
generate_one_block  0.2419753074645996
generate_one_block  0.24521374702453613
generate_one_block  0.24352288246154785
generate_one_block  0.25238466262817383
generate_one_block  0.2489626407623291
generate_one_block  0.2550199031829834
generate_one_block  0.2506837844848633
generate_one_block  0.2430891990661621
generate_one_block  0.24934029579162598
generate_one_block  0.2426013946533203
generate_one_block  0.2434995174407959
generate_one_block  0.24805140495300293
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03461480140686035
gen group dst list time:  0.10715603828430176
time for parepare:  0.020896434783935547
local_output_nid generation:  0.024456024169921875
local_in_edges_tensor generation:  0.0402071475982666
mini_batch_src_global generation:  0.04009246826171875
r_  generation:  0.4247410297393799
local_output_nid generation:  0.0302889347076416
local_in_edges_tensor generation:  0.03522968292236328
mini_batch_src_global generation:  0.05023360252380371
r_  generation:  0.42035341262817383
local_output_nid generation:  0.03101205825805664
local_in_edges_tensor generation:  0.030323266983032227
mini_batch_src_global generation:  0.05101895332336426
r_  generation:  0.43820810317993164
local_output_nid generation:  0.030771493911743164
local_in_edges_tensor generation:  0.027927160263061523
mini_batch_src_global generation:  0.05005598068237305
r_  generation:  0.42790699005126953
local_output_nid generation:  0.030955076217651367
local_in_edges_tensor generation:  0.027597427368164062
mini_batch_src_global generation:  0.05218029022216797
r_  generation:  0.43666911125183105
local_output_nid generation:  0.031199216842651367
local_in_edges_tensor generation:  0.02928471565246582
mini_batch_src_global generation:  0.05130648612976074
r_  generation:  0.43775391578674316
local_output_nid generation:  0.029834508895874023
local_in_edges_tensor generation:  0.029273509979248047
mini_batch_src_global generation:  0.052437543869018555
r_  generation:  0.43657946586608887
local_output_nid generation:  0.029322385787963867
local_in_edges_tensor generation:  0.028292417526245117
mini_batch_src_global generation:  0.05090522766113281
r_  generation:  0.432619571685791
local_output_nid generation:  0.0315704345703125
local_in_edges_tensor generation:  0.027687788009643555
mini_batch_src_global generation:  0.05430459976196289
r_  generation:  0.43898677825927734
local_output_nid generation:  0.02927112579345703
local_in_edges_tensor generation:  0.027480363845825195
mini_batch_src_global generation:  0.051229000091552734
r_  generation:  0.43304967880249023
local_output_nid generation:  0.029285192489624023
local_in_edges_tensor generation:  0.029293060302734375
mini_batch_src_global generation:  0.05042624473571777
r_  generation:  0.4387245178222656
local_output_nid generation:  0.0295102596282959
local_in_edges_tensor generation:  0.029501914978027344
mini_batch_src_global generation:  0.0513153076171875
r_  generation:  0.4395790100097656
local_output_nid generation:  0.02982616424560547
local_in_edges_tensor generation:  0.03156685829162598
mini_batch_src_global generation:  0.050827741622924805
r_  generation:  0.44010281562805176
local_output_nid generation:  0.029300689697265625
local_in_edges_tensor generation:  0.029188871383666992
mini_batch_src_global generation:  0.051821231842041016
r_  generation:  0.4369947910308838
local_output_nid generation:  0.029254913330078125
local_in_edges_tensor generation:  0.03114151954650879
mini_batch_src_global generation:  0.04996919631958008
r_  generation:  0.4365074634552002
local_output_nid generation:  0.029536962509155273
local_in_edges_tensor generation:  0.03180050849914551
mini_batch_src_global generation:  0.05135035514831543
r_  generation:  0.4405250549316406
local_output_nid generation:  0.03161430358886719
local_in_edges_tensor generation:  0.030995845794677734
mini_batch_src_global generation:  0.05039691925048828
r_  generation:  0.43775081634521484
local_output_nid generation:  0.029784440994262695
local_in_edges_tensor generation:  0.027727365493774414
mini_batch_src_global generation:  0.05150771141052246
r_  generation:  0.4379901885986328
local_output_nid generation:  0.030074357986450195
local_in_edges_tensor generation:  0.031291961669921875
mini_batch_src_global generation:  0.052742719650268555
r_  generation:  0.4405486583709717
local_output_nid generation:  0.029333829879760742
local_in_edges_tensor generation:  0.03149914741516113
mini_batch_src_global generation:  0.051299333572387695
r_  generation:  0.440079927444458
local_output_nid generation:  0.029710054397583008
local_in_edges_tensor generation:  0.027626514434814453
mini_batch_src_global generation:  0.050054311752319336
r_  generation:  0.43933629989624023
local_output_nid generation:  0.02948284149169922
local_in_edges_tensor generation:  0.029197216033935547
mini_batch_src_global generation:  0.05131936073303223
r_  generation:  0.4376537799835205
local_output_nid generation:  0.029579639434814453
local_in_edges_tensor generation:  0.029928922653198242
mini_batch_src_global generation:  0.05031752586364746
r_  generation:  0.4409811496734619
local_output_nid generation:  0.029929637908935547
local_in_edges_tensor generation:  0.031635284423828125
mini_batch_src_global generation:  0.052060842514038086
r_  generation:  0.436276912689209
local_output_nid generation:  0.0326235294342041
local_in_edges_tensor generation:  0.028004169464111328
mini_batch_src_global generation:  0.05101966857910156
r_  generation:  0.44146203994750977
local_output_nid generation:  0.029806137084960938
local_in_edges_tensor generation:  0.02887701988220215
mini_batch_src_global generation:  0.05420041084289551
r_  generation:  0.441270112991333
local_output_nid generation:  0.030122756958007812
local_in_edges_tensor generation:  0.02941107749938965
mini_batch_src_global generation:  0.05161261558532715
r_  generation:  0.44387388229370117
local_output_nid generation:  0.029450416564941406
local_in_edges_tensor generation:  0.028569936752319336
mini_batch_src_global generation:  0.052580833435058594
r_  generation:  0.4325728416442871
local_output_nid generation:  0.029691457748413086
local_in_edges_tensor generation:  0.028380632400512695
mini_batch_src_global generation:  0.051105499267578125
r_  generation:  0.43693041801452637
local_output_nid generation:  0.02977466583251953
local_in_edges_tensor generation:  0.028811931610107422
mini_batch_src_global generation:  0.05157971382141113
r_  generation:  0.44008708000183105
local_output_nid generation:  0.029584407806396484
local_in_edges_tensor generation:  0.03221487998962402
mini_batch_src_global generation:  0.05148816108703613
r_  generation:  0.43547892570495605
local_output_nid generation:  0.029688358306884766
local_in_edges_tensor generation:  0.028472900390625
mini_batch_src_global generation:  0.051778554916381836
r_  generation:  0.44422030448913574
----------------------check_connections_block total spend ----------------------------- 20.707013607025146
generate_one_block  0.5916755199432373
generate_one_block  0.5781393051147461
generate_one_block  0.593036413192749
generate_one_block  0.5830214023590088
generate_one_block  0.6791930198669434
generate_one_block  0.5858347415924072
generate_one_block  0.5828607082366943
generate_one_block  0.5820398330688477
generate_one_block  0.5886631011962891
generate_one_block  0.5841212272644043
generate_one_block  0.579310417175293
generate_one_block  0.5896384716033936
generate_one_block  0.5903894901275635
generate_one_block  0.5779345035552979
generate_one_block  0.587059736251831
generate_one_block  0.5865657329559326
generate_one_block  0.5869920253753662
generate_one_block  0.5851895809173584
generate_one_block  0.5907707214355469
generate_one_block  0.5775892734527588
generate_one_block  0.5817346572875977
generate_one_block  0.5862302780151367
generate_one_block  0.5965490341186523
generate_one_block  0.5837404727935791
generate_one_block  0.5999546051025391
generate_one_block  0.5921437740325928
generate_one_block  0.5935454368591309
generate_one_block  0.5754625797271729
generate_one_block  0.5826351642608643
generate_one_block  0.586418628692627
generate_one_block  0.5784866809844971
generate_one_block  0.5815045833587646
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.1266160011291504  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

connection checking time:  29.260892868041992
block generation total time  26.73283863067627
average batch blocks generation time:  0.8354012072086334
block dataloader generation time/epoch 59.659097359730644
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10669708251953125  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.06550693511963  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10659933090209961  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.669459342956543  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10693168640136719  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.94004535675049  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10637426376342773  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.6735520362854  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10664129257202148  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.04966402053833  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10666131973266602  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.096384048461914  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10670948028564453  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.10288143157959  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10653066635131836  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.74113368988037  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10664129257202148  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.944080352783203  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10647392272949219  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.074586391448975  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10647249221801758  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 18.765862464904785  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10680341720581055  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 19.33794927597046  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6190185546875 GB
    Memory Allocated: 0.10691595077514648  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6209716796875 GB
    Memory Allocated: 19.466042041778564  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10615921020507812  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.32494020462036  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10633707046508789  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.006852626800537  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10661554336547852  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.923959255218506  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10663366317749023  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.888009071350098  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10645914077758789  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.791808605194092  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10679054260253906  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.14393424987793  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10613203048706055  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.236804962158203  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.1065220832824707  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.776739597320557  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10618162155151367  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.823957920074463  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10645484924316406  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.739027500152588  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10682344436645508  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.144099235534668  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10672950744628906  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.02093267440796  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10678958892822266  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.26008129119873  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10710906982421875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.110462188720703  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10638666152954102  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.70763874053955  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.1069173812866211  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.0103759765625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.1066904067993164  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.813466548919678  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10637998580932617  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.643749713897705  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10678386688232422  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.909104347229004  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030307650566101074 |0.01928650587797165 |0.556535579264164 |9.544193744659424e-05 |1.0615340620279312 |0.004991292953491211 |
----------------------------------------------------------pseudo_mini_loss sum 1.3241467475891113
Total (block generation + training)time/epoch 113.32064307652988
Training time/epoch 53.43877077102661
Training time without block to device /epoch 52.82160258293152
Training time without total dataloading part /epoch 51.78627395629883
load block tensor time/epoch 0.9698448181152344
block to device time/epoch 0.6171681880950928
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  9116003
Number of first layer input nodes during this epoch:  4762090
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.12679052352905273  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025616884231567383
range selection method range initialization spend 0.017043590545654297
time for parepare:  0.019765138626098633
local_output_nid generation:  0.0009775161743164062
local_in_edges_tensor generation:  0.007298946380615234
mini_batch_src_global generation:  0.0015158653259277344
r_  generation:  0.011211872100830078
local_output_nid generation:  0.0009942054748535156
local_in_edges_tensor generation:  0.0006940364837646484
mini_batch_src_global generation:  0.001451253890991211
r_  generation:  0.010920286178588867
local_output_nid generation:  0.0009469985961914062
local_in_edges_tensor generation:  0.0006413459777832031
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.009847879409790039
local_output_nid generation:  0.0009350776672363281
local_in_edges_tensor generation:  0.0006260871887207031
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.009938716888427734
local_output_nid generation:  0.0008993148803710938
local_in_edges_tensor generation:  0.0006005764007568359
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.01024627685546875
local_output_nid generation:  0.0009033679962158203
local_in_edges_tensor generation:  0.0005915164947509766
mini_batch_src_global generation:  0.0011172294616699219
r_  generation:  0.010163307189941406
local_output_nid generation:  0.0009121894836425781
local_in_edges_tensor generation:  0.0005955696105957031
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.010167121887207031
local_output_nid generation:  0.0009207725524902344
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.0012171268463134766
r_  generation:  0.010286808013916016
local_output_nid generation:  0.0008935928344726562
local_in_edges_tensor generation:  0.0005927085876464844
mini_batch_src_global generation:  0.0011777877807617188
r_  generation:  0.010949850082397461
local_output_nid generation:  0.0008957386016845703
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.01051783561706543
local_output_nid generation:  0.0008895397186279297
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0011241436004638672
r_  generation:  0.010176897048950195
local_output_nid generation:  0.0008862018585205078
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.0011143684387207031
r_  generation:  0.010070323944091797
local_output_nid generation:  0.0008738040924072266
local_in_edges_tensor generation:  0.0005733966827392578
mini_batch_src_global generation:  0.001203775405883789
r_  generation:  0.010331153869628906
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0005750656127929688
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010499238967895508
local_output_nid generation:  0.0008852481842041016
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.010453224182128906
local_output_nid generation:  0.0009016990661621094
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0012021064758300781
r_  generation:  0.010605812072753906
local_output_nid generation:  0.0008873939514160156
local_in_edges_tensor generation:  0.0005815029144287109
mini_batch_src_global generation:  0.0011966228485107422
r_  generation:  0.009933233261108398
local_output_nid generation:  0.0008785724639892578
local_in_edges_tensor generation:  0.0005619525909423828
mini_batch_src_global generation:  0.0011272430419921875
r_  generation:  0.010063409805297852
local_output_nid generation:  0.0008828639984130859
local_in_edges_tensor generation:  0.0005621910095214844
mini_batch_src_global generation:  0.0011093616485595703
r_  generation:  0.01003122329711914
local_output_nid generation:  0.0008592605590820312
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.0012955665588378906
r_  generation:  0.010382890701293945
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0005710124969482422
mini_batch_src_global generation:  0.0012309551239013672
r_  generation:  0.010330438613891602
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0012280941009521484
r_  generation:  0.010569572448730469
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.0011744499206542969
r_  generation:  0.010161399841308594
local_output_nid generation:  0.0008816719055175781
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.00116729736328125
r_  generation:  0.009963750839233398
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.0011267662048339844
r_  generation:  0.010344505310058594
local_output_nid generation:  0.0009036064147949219
local_in_edges_tensor generation:  0.0005719661712646484
mini_batch_src_global generation:  0.0011882781982421875
r_  generation:  0.010174751281738281
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0005900859832763672
mini_batch_src_global generation:  0.0011687278747558594
r_  generation:  0.010445833206176758
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0011708736419677734
r_  generation:  0.010395050048828125
local_output_nid generation:  0.0008547306060791016
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.010379552841186523
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0005984306335449219
mini_batch_src_global generation:  0.0012624263763427734
r_  generation:  0.010869026184082031
local_output_nid generation:  0.0008795261383056641
local_in_edges_tensor generation:  0.0005562305450439453
mini_batch_src_global generation:  0.0011439323425292969
r_  generation:  0.010313272476196289
local_output_nid generation:  0.0008804798126220703
local_in_edges_tensor generation:  0.0006017684936523438
mini_batch_src_global generation:  0.001260995864868164
r_  generation:  0.010522603988647461
----------------------check_connections_block total spend ----------------------------- 0.5245068073272705
generate_one_block  0.025536537170410156
generate_one_block  0.020706653594970703
generate_one_block  0.01906728744506836
generate_one_block  0.018712997436523438
generate_one_block  0.019290447235107422
generate_one_block  0.01869964599609375
generate_one_block  0.018451690673828125
generate_one_block  0.01876521110534668
generate_one_block  0.01942920684814453
generate_one_block  0.0189821720123291
generate_one_block  0.018157482147216797
generate_one_block  0.020409107208251953
generate_one_block  0.019305944442749023
generate_one_block  0.018766403198242188
generate_one_block  0.018585205078125
generate_one_block  0.019042253494262695
generate_one_block  0.0179445743560791
generate_one_block  0.018261194229125977
generate_one_block  0.017969846725463867
generate_one_block  0.018613338470458984
generate_one_block  0.01848602294921875
generate_one_block  0.0189054012298584
generate_one_block  0.01851654052734375
generate_one_block  0.01768040657043457
generate_one_block  0.01838827133178711
generate_one_block  0.018166065216064453
generate_one_block  0.018768787384033203
generate_one_block  0.018475770950317383
generate_one_block  0.01853156089782715
generate_one_block  0.019120454788208008
generate_one_block  0.01841568946838379
generate_one_block  0.01867389678955078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038288116455078125
gen group dst list time:  0.02061319351196289
time for parepare:  0.020456314086914062
local_output_nid generation:  0.005814790725708008
local_in_edges_tensor generation:  0.018037080764770508
mini_batch_src_global generation:  0.01783156394958496
r_  generation:  0.16751456260681152
local_output_nid generation:  0.0077288150787353516
local_in_edges_tensor generation:  0.011013269424438477
mini_batch_src_global generation:  0.02239847183227539
r_  generation:  0.17149734497070312
local_output_nid generation:  0.007909059524536133
local_in_edges_tensor generation:  0.032701969146728516
mini_batch_src_global generation:  0.021203041076660156
r_  generation:  0.17451047897338867
local_output_nid generation:  0.008174896240234375
local_in_edges_tensor generation:  0.008604288101196289
mini_batch_src_global generation:  0.022829771041870117
r_  generation:  0.17886853218078613
local_output_nid generation:  0.008814334869384766
local_in_edges_tensor generation:  0.010069608688354492
mini_batch_src_global generation:  0.0230100154876709
r_  generation:  0.18149757385253906
local_output_nid generation:  0.00874018669128418
local_in_edges_tensor generation:  0.008718729019165039
mini_batch_src_global generation:  0.022850751876831055
r_  generation:  0.18225765228271484
local_output_nid generation:  0.008372068405151367
local_in_edges_tensor generation:  0.008647441864013672
mini_batch_src_global generation:  0.02309250831604004
r_  generation:  0.1792583465576172
local_output_nid generation:  0.008645296096801758
local_in_edges_tensor generation:  0.00864720344543457
mini_batch_src_global generation:  0.023817777633666992
r_  generation:  0.1833970546722412
local_output_nid generation:  0.009054899215698242
local_in_edges_tensor generation:  0.011869668960571289
mini_batch_src_global generation:  0.02537989616394043
r_  generation:  0.18793416023254395
local_output_nid generation:  0.009009599685668945
local_in_edges_tensor generation:  0.00899648666381836
mini_batch_src_global generation:  0.02374863624572754
r_  generation:  0.1859877109527588
local_output_nid generation:  0.00879669189453125
local_in_edges_tensor generation:  0.011390209197998047
mini_batch_src_global generation:  0.02411818504333496
r_  generation:  0.17732787132263184
local_output_nid generation:  0.008840084075927734
local_in_edges_tensor generation:  0.010640144348144531
mini_batch_src_global generation:  0.022439241409301758
r_  generation:  0.1762545108795166
local_output_nid generation:  0.009021997451782227
local_in_edges_tensor generation:  0.008995532989501953
mini_batch_src_global generation:  0.0237576961517334
r_  generation:  0.18488597869873047
local_output_nid generation:  0.009055376052856445
local_in_edges_tensor generation:  0.008953571319580078
mini_batch_src_global generation:  0.02353644371032715
r_  generation:  0.18682241439819336
local_output_nid generation:  0.009006977081298828
local_in_edges_tensor generation:  0.008801698684692383
mini_batch_src_global generation:  0.024251699447631836
r_  generation:  0.18423795700073242
local_output_nid generation:  0.009134531021118164
local_in_edges_tensor generation:  0.00985097885131836
mini_batch_src_global generation:  0.025069236755371094
r_  generation:  0.18893051147460938
local_output_nid generation:  0.008831501007080078
local_in_edges_tensor generation:  0.008930444717407227
mini_batch_src_global generation:  0.02343273162841797
r_  generation:  0.17789888381958008
local_output_nid generation:  0.009112119674682617
local_in_edges_tensor generation:  0.00912332534790039
mini_batch_src_global generation:  0.0232696533203125
r_  generation:  0.1816387176513672
local_output_nid generation:  0.00885152816772461
local_in_edges_tensor generation:  0.009627342224121094
mini_batch_src_global generation:  0.022951126098632812
r_  generation:  0.17917275428771973
local_output_nid generation:  0.009273052215576172
local_in_edges_tensor generation:  0.008833885192871094
mini_batch_src_global generation:  0.023945093154907227
r_  generation:  0.18376755714416504
local_output_nid generation:  0.009193658828735352
local_in_edges_tensor generation:  0.01040196418762207
mini_batch_src_global generation:  0.02512836456298828
r_  generation:  0.18890810012817383
local_output_nid generation:  0.009356260299682617
local_in_edges_tensor generation:  0.009595870971679688
mini_batch_src_global generation:  0.023876428604125977
r_  generation:  0.18879985809326172
local_output_nid generation:  0.009316205978393555
local_in_edges_tensor generation:  0.009186983108520508
mini_batch_src_global generation:  0.023694992065429688
r_  generation:  0.18486714363098145
local_output_nid generation:  0.009053945541381836
local_in_edges_tensor generation:  0.008647918701171875
mini_batch_src_global generation:  0.02300882339477539
r_  generation:  0.17998504638671875
local_output_nid generation:  0.009303569793701172
local_in_edges_tensor generation:  0.00929117202758789
mini_batch_src_global generation:  0.023761272430419922
r_  generation:  0.18978357315063477
local_output_nid generation:  0.00919198989868164
local_in_edges_tensor generation:  0.009066343307495117
mini_batch_src_global generation:  0.02349686622619629
r_  generation:  0.18320894241333008
local_output_nid generation:  0.009366035461425781
local_in_edges_tensor generation:  0.00911712646484375
mini_batch_src_global generation:  0.024677753448486328
r_  generation:  0.1863234043121338
local_output_nid generation:  0.009171485900878906
local_in_edges_tensor generation:  0.010155677795410156
mini_batch_src_global generation:  0.023581981658935547
r_  generation:  0.184434175491333
local_output_nid generation:  0.0092926025390625
local_in_edges_tensor generation:  0.009573698043823242
mini_batch_src_global generation:  0.02503371238708496
r_  generation:  0.18573641777038574
local_output_nid generation:  0.009396791458129883
local_in_edges_tensor generation:  0.009824991226196289
mini_batch_src_global generation:  0.024502038955688477
r_  generation:  0.1908879280090332
local_output_nid generation:  0.009283304214477539
local_in_edges_tensor generation:  0.008948087692260742
mini_batch_src_global generation:  0.023626327514648438
r_  generation:  0.18301606178283691
local_output_nid generation:  0.01122736930847168
local_in_edges_tensor generation:  0.009074926376342773
mini_batch_src_global generation:  0.024562597274780273
r_  generation:  0.18825364112854004
----------------------check_connections_block total spend ----------------------------- 8.572508096694946
generate_one_block  0.24606823921203613
generate_one_block  0.24651813507080078
generate_one_block  0.24275708198547363
generate_one_block  0.24646925926208496
generate_one_block  0.263594388961792
generate_one_block  0.24892115592956543
generate_one_block  0.24428963661193848
generate_one_block  0.247300386428833
generate_one_block  0.2552626132965088
generate_one_block  0.2523212432861328
generate_one_block  0.2379310131072998
generate_one_block  0.23726272583007812
generate_one_block  0.2508704662322998
generate_one_block  0.249220609664917
generate_one_block  0.24576497077941895
generate_one_block  0.25490689277648926
generate_one_block  0.23917913436889648
generate_one_block  0.24268412590026855
generate_one_block  0.2425394058227539
generate_one_block  0.2529184818267822
generate_one_block  0.25357985496520996
generate_one_block  0.25170445442199707
generate_one_block  0.2473924160003662
generate_one_block  0.2375481128692627
generate_one_block  0.24796080589294434
generate_one_block  0.2469496726989746
generate_one_block  0.24967050552368164
generate_one_block  0.24680662155151367
generate_one_block  0.24938201904296875
generate_one_block  0.257918119430542
generate_one_block  0.24494004249572754
generate_one_block  0.25023794174194336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03664827346801758
gen group dst list time:  0.11172986030578613
time for parepare:  0.019449710845947266
local_output_nid generation:  0.024298667907714844
local_in_edges_tensor generation:  0.04908156394958496
mini_batch_src_global generation:  0.040763139724731445
r_  generation:  0.42511415481567383
local_output_nid generation:  0.030657052993774414
local_in_edges_tensor generation:  0.03374791145324707
mini_batch_src_global generation:  0.050605058670043945
r_  generation:  0.4236879348754883
local_output_nid generation:  0.030996322631835938
local_in_edges_tensor generation:  0.02823805809020996
mini_batch_src_global generation:  0.04863858222961426
r_  generation:  0.4366335868835449
local_output_nid generation:  0.031121253967285156
local_in_edges_tensor generation:  0.03481912612915039
mini_batch_src_global generation:  0.050156593322753906
r_  generation:  0.4307820796966553
local_output_nid generation:  0.031838417053222656
local_in_edges_tensor generation:  0.02852797508239746
mini_batch_src_global generation:  0.05027604103088379
r_  generation:  0.4362342357635498
local_output_nid generation:  0.03157186508178711
local_in_edges_tensor generation:  0.026654720306396484
mini_batch_src_global generation:  0.053090572357177734
r_  generation:  0.43634629249572754
local_output_nid generation:  0.030112266540527344
local_in_edges_tensor generation:  0.028531312942504883
mini_batch_src_global generation:  0.05179953575134277
r_  generation:  0.43850255012512207
local_output_nid generation:  0.03014349937438965
local_in_edges_tensor generation:  0.02809000015258789
mini_batch_src_global generation:  0.05162358283996582
r_  generation:  0.4461989402770996
local_output_nid generation:  0.030196666717529297
local_in_edges_tensor generation:  0.028853654861450195
mini_batch_src_global generation:  0.051569223403930664
r_  generation:  0.4413907527923584
local_output_nid generation:  0.029973983764648438
local_in_edges_tensor generation:  0.027063608169555664
mini_batch_src_global generation:  0.05202889442443848
r_  generation:  0.43486928939819336
local_output_nid generation:  0.029293298721313477
local_in_edges_tensor generation:  0.02668619155883789
mini_batch_src_global generation:  0.05067181587219238
r_  generation:  0.43799376487731934
local_output_nid generation:  0.029522180557250977
local_in_edges_tensor generation:  0.026865720748901367
mini_batch_src_global generation:  0.05083608627319336
r_  generation:  0.43456530570983887
local_output_nid generation:  0.030247211456298828
local_in_edges_tensor generation:  0.02672433853149414
mini_batch_src_global generation:  0.0527040958404541
r_  generation:  0.4403848648071289
local_output_nid generation:  0.030224323272705078
local_in_edges_tensor generation:  0.027245044708251953
mini_batch_src_global generation:  0.05307817459106445
r_  generation:  0.4380199909210205
local_output_nid generation:  0.029520750045776367
local_in_edges_tensor generation:  0.026564598083496094
mini_batch_src_global generation:  0.0500941276550293
r_  generation:  0.43786168098449707
local_output_nid generation:  0.02988433837890625
local_in_edges_tensor generation:  0.0274658203125
mini_batch_src_global generation:  0.05474448204040527
r_  generation:  0.43929076194763184
local_output_nid generation:  0.029540061950683594
local_in_edges_tensor generation:  0.02758002281188965
mini_batch_src_global generation:  0.05042457580566406
r_  generation:  0.4362788200378418
local_output_nid generation:  0.029665708541870117
local_in_edges_tensor generation:  0.02695941925048828
mini_batch_src_global generation:  0.050977468490600586
r_  generation:  0.4331526756286621
local_output_nid generation:  0.02968883514404297
local_in_edges_tensor generation:  0.026934385299682617
mini_batch_src_global generation:  0.04991340637207031
r_  generation:  0.4349968433380127
local_output_nid generation:  0.029970645904541016
local_in_edges_tensor generation:  0.029202699661254883
mini_batch_src_global generation:  0.051833152770996094
r_  generation:  0.44019293785095215
local_output_nid generation:  0.030222177505493164
local_in_edges_tensor generation:  0.028179168701171875
mini_batch_src_global generation:  0.05258917808532715
r_  generation:  0.43974804878234863
local_output_nid generation:  0.029769420623779297
local_in_edges_tensor generation:  0.027283906936645508
mini_batch_src_global generation:  0.051491737365722656
r_  generation:  0.4393742084503174
local_output_nid generation:  0.029958248138427734
local_in_edges_tensor generation:  0.027740001678466797
mini_batch_src_global generation:  0.05026578903198242
r_  generation:  0.44475507736206055
local_output_nid generation:  0.029563426971435547
local_in_edges_tensor generation:  0.02899336814880371
mini_batch_src_global generation:  0.05311179161071777
r_  generation:  0.43550610542297363
local_output_nid generation:  0.02992415428161621
local_in_edges_tensor generation:  0.027009248733520508
mini_batch_src_global generation:  0.05031156539916992
r_  generation:  0.4426612854003906
local_output_nid generation:  0.02996826171875
local_in_edges_tensor generation:  0.031028032302856445
mini_batch_src_global generation:  0.05159950256347656
r_  generation:  0.4444620609283447
local_output_nid generation:  0.03028726577758789
local_in_edges_tensor generation:  0.029093265533447266
mini_batch_src_global generation:  0.05371713638305664
r_  generation:  0.44298624992370605
local_output_nid generation:  0.029822111129760742
local_in_edges_tensor generation:  0.026925086975097656
mini_batch_src_global generation:  0.05196881294250488
r_  generation:  0.43628406524658203
local_output_nid generation:  0.030523300170898438
local_in_edges_tensor generation:  0.03011488914489746
mini_batch_src_global generation:  0.051748037338256836
r_  generation:  0.44283294677734375
local_output_nid generation:  0.03000950813293457
local_in_edges_tensor generation:  0.02853083610534668
mini_batch_src_global generation:  0.05363154411315918
r_  generation:  0.4399852752685547
local_output_nid generation:  0.030017614364624023
local_in_edges_tensor generation:  0.027942895889282227
mini_batch_src_global generation:  0.05107474327087402
r_  generation:  0.442030668258667
local_output_nid generation:  0.03005504608154297
local_in_edges_tensor generation:  0.027745723724365234
mini_batch_src_global generation:  0.05289936065673828
r_  generation:  0.4472634792327881
----------------------check_connections_block total spend ----------------------------- 20.712709188461304
generate_one_block  0.5894453525543213
generate_one_block  0.5805392265319824
generate_one_block  0.5812110900878906
generate_one_block  0.5858619213104248
generate_one_block  0.6740715503692627
generate_one_block  0.585273265838623
generate_one_block  0.579735279083252
generate_one_block  0.5874171257019043
generate_one_block  0.593597412109375
generate_one_block  0.586798906326294
generate_one_block  0.5826001167297363
generate_one_block  0.5833673477172852
generate_one_block  0.5891592502593994
generate_one_block  0.5894582271575928
generate_one_block  0.5830607414245605
generate_one_block  0.6005384922027588
generate_one_block  0.5865631103515625
generate_one_block  0.5789215564727783
generate_one_block  0.5769839286804199
generate_one_block  0.5950446128845215
generate_one_block  0.5861189365386963
generate_one_block  0.5905516147613525
generate_one_block  0.5806796550750732
generate_one_block  0.5827856063842773
generate_one_block  0.6157851219177246
generate_one_block  0.5824110507965088
generate_one_block  0.5912487506866455
generate_one_block  0.5885477066040039
generate_one_block  0.6037998199462891
generate_one_block  0.5964620113372803
generate_one_block  0.5858807563781738
generate_one_block  0.5994765758514404
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.12679052352905273  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

connection checking time:  29.28521728515625
block generation total time  26.844266653060913
average batch blocks generation time:  0.8388833329081535
block dataloader generation time/epoch 59.646729179791045
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10676097869873047  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.044546604156494  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10676193237304688  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.92319345474243  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10644721984863281  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.796802520751953  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10669231414794922  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.021929264068604  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10669136047363281  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.094882011413574  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10682964324951172  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.952648162841797  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10647773742675781  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.86094093322754  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10704278945922852  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.99627161026001  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10682535171508789  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.33420705795288  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10668706893920898  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.101865768432617  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10618448257446289  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.467618465423584  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10611915588378906  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.551543712615967  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10684442520141602  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.01415252685547  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10678529739379883  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.02035617828369  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10650491714477539  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.913523197174072  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10699653625488281  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.297626495361328  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10627365112304688  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.54749584197998  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10648202896118164  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.787631511688232  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10610771179199219  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.435248374938965  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10677909851074219  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.944315910339355  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10680389404296875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.134340286254883  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10692787170410156  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.155248641967773  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10668516159057617  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.824527740478516  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10639524459838867  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.534664630889893  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10704517364501953  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.999410152435303  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10676050186157227  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.81695032119751  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10669898986816406  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.050046920776367  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10643768310546875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.856760025024414  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10682344436645508  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.041362285614014  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10692358016967773  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.348759651184082  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10655069351196289  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.805384635925293  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10656547546386719  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.125735759735107  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0348493754863739 |0.02102246880531311 |0.557656392455101 |9.679794311523438e-05 |1.0633662715554237 |0.008972644805908203 |
----------------------------------------------------------pseudo_mini_loss sum 1.310175895690918
Total (block generation + training)time/epoch 113.31307235785893
Training time/epoch 53.72843956947327
Training time without block to device /epoch 53.05572056770325
Training time without total dataloading part /epoch 51.88479542732239
load block tensor time/epoch 1.1151800155639648
block to device time/epoch 0.6727190017700195
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  9120423
Number of first layer input nodes during this epoch:  4764535
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.12693405151367188  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027280569076538086
range selection method range initialization spend 0.014343976974487305
time for parepare:  0.025511741638183594
local_output_nid generation:  0.0011589527130126953
local_in_edges_tensor generation:  0.007240772247314453
mini_batch_src_global generation:  0.0017824172973632812
r_  generation:  0.010426759719848633
local_output_nid generation:  0.0009953975677490234
local_in_edges_tensor generation:  0.0007092952728271484
mini_batch_src_global generation:  0.0019135475158691406
r_  generation:  0.011139869689941406
local_output_nid generation:  0.0009620189666748047
local_in_edges_tensor generation:  0.0006320476531982422
mini_batch_src_global generation:  0.0012483596801757812
r_  generation:  0.009790420532226562
local_output_nid generation:  0.0009517669677734375
local_in_edges_tensor generation:  0.0006241798400878906
mini_batch_src_global generation:  0.0012333393096923828
r_  generation:  0.009649276733398438
local_output_nid generation:  0.0009558200836181641
local_in_edges_tensor generation:  0.0006339550018310547
mini_batch_src_global generation:  0.0013058185577392578
r_  generation:  0.00967550277709961
local_output_nid generation:  0.0009741783142089844
local_in_edges_tensor generation:  0.0006339550018310547
mini_batch_src_global generation:  0.0013031959533691406
r_  generation:  0.010150909423828125
local_output_nid generation:  0.0009915828704833984
local_in_edges_tensor generation:  0.0006229877471923828
mini_batch_src_global generation:  0.0012624263763427734
r_  generation:  0.01021432876586914
local_output_nid generation:  0.0010530948638916016
local_in_edges_tensor generation:  0.0006113052368164062
mini_batch_src_global generation:  0.0012297630310058594
r_  generation:  0.00990438461303711
local_output_nid generation:  0.0010175704956054688
local_in_edges_tensor generation:  0.0006330013275146484
mini_batch_src_global generation:  0.0012993812561035156
r_  generation:  0.010138750076293945
local_output_nid generation:  0.0009906291961669922
local_in_edges_tensor generation:  0.0006406307220458984
mini_batch_src_global generation:  0.0013475418090820312
r_  generation:  0.010694026947021484
local_output_nid generation:  0.0009946823120117188
local_in_edges_tensor generation:  0.0006134510040283203
mini_batch_src_global generation:  0.0012934207916259766
r_  generation:  0.010103940963745117
local_output_nid generation:  0.0010218620300292969
local_in_edges_tensor generation:  0.0006287097930908203
mini_batch_src_global generation:  0.0012784004211425781
r_  generation:  0.01040196418762207
local_output_nid generation:  0.001016855239868164
local_in_edges_tensor generation:  0.0006401538848876953
mini_batch_src_global generation:  0.001402139663696289
r_  generation:  0.010289669036865234
local_output_nid generation:  0.0010344982147216797
local_in_edges_tensor generation:  0.0006194114685058594
mini_batch_src_global generation:  0.001287698745727539
r_  generation:  0.010237693786621094
local_output_nid generation:  0.001018524169921875
local_in_edges_tensor generation:  0.0006098747253417969
mini_batch_src_global generation:  0.001384735107421875
r_  generation:  0.009970903396606445
local_output_nid generation:  0.0010378360748291016
local_in_edges_tensor generation:  0.0006227493286132812
mini_batch_src_global generation:  0.0012695789337158203
r_  generation:  0.010169744491577148
local_output_nid generation:  0.0010323524475097656
local_in_edges_tensor generation:  0.0006361007690429688
mini_batch_src_global generation:  0.0013117790222167969
r_  generation:  0.010517358779907227
local_output_nid generation:  0.0010230541229248047
local_in_edges_tensor generation:  0.0006134510040283203
mini_batch_src_global generation:  0.0012984275817871094
r_  generation:  0.010068893432617188
local_output_nid generation:  0.0010311603546142578
local_in_edges_tensor generation:  0.0006287097930908203
mini_batch_src_global generation:  0.0012965202331542969
r_  generation:  0.010264396667480469
local_output_nid generation:  0.0010590553283691406
local_in_edges_tensor generation:  0.0006358623504638672
mini_batch_src_global generation:  0.0013463497161865234
r_  generation:  0.010428190231323242
local_output_nid generation:  0.001024484634399414
local_in_edges_tensor generation:  0.0006160736083984375
mini_batch_src_global generation:  0.0012629032135009766
r_  generation:  0.010040521621704102
local_output_nid generation:  0.0010025501251220703
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.001111745834350586
r_  generation:  0.011199235916137695
local_output_nid generation:  0.0010216236114501953
local_in_edges_tensor generation:  0.0005905628204345703
mini_batch_src_global generation:  0.0012712478637695312
r_  generation:  0.01011800765991211
local_output_nid generation:  0.0010178089141845703
local_in_edges_tensor generation:  0.0006260871887207031
mini_batch_src_global generation:  0.0012805461883544922
r_  generation:  0.010222196578979492
local_output_nid generation:  0.0010001659393310547
local_in_edges_tensor generation:  0.0006074905395507812
mini_batch_src_global generation:  0.0013954639434814453
r_  generation:  0.009903907775878906
local_output_nid generation:  0.0010013580322265625
local_in_edges_tensor generation:  0.00063323974609375
mini_batch_src_global generation:  0.0012924671173095703
r_  generation:  0.010532855987548828
local_output_nid generation:  0.0010075569152832031
local_in_edges_tensor generation:  0.0006253719329833984
mini_batch_src_global generation:  0.0012178421020507812
r_  generation:  0.010265588760375977
local_output_nid generation:  0.0010063648223876953
local_in_edges_tensor generation:  0.0006127357482910156
mini_batch_src_global generation:  0.0012738704681396484
r_  generation:  0.010509729385375977
local_output_nid generation:  0.0010080337524414062
local_in_edges_tensor generation:  0.0006306171417236328
mini_batch_src_global generation:  0.0012784004211425781
r_  generation:  0.01069498062133789
local_output_nid generation:  0.001004934310913086
local_in_edges_tensor generation:  0.0006129741668701172
mini_batch_src_global generation:  0.0013124942779541016
r_  generation:  0.01055002212524414
local_output_nid generation:  0.001005411148071289
local_in_edges_tensor generation:  0.0006461143493652344
mini_batch_src_global generation:  0.0012733936309814453
r_  generation:  0.010321617126464844
local_output_nid generation:  0.0009922981262207031
local_in_edges_tensor generation:  0.0005977153778076172
mini_batch_src_global generation:  0.0012886524200439453
r_  generation:  0.01035451889038086
----------------------check_connections_block total spend ----------------------------- 0.537813663482666
generate_one_block  0.028383493423461914
generate_one_block  0.022493362426757812
generate_one_block  0.020057201385498047
generate_one_block  0.0187990665435791
generate_one_block  0.01873016357421875
generate_one_block  0.019278287887573242
generate_one_block  0.034624338150024414
generate_one_block  0.01876664161682129
generate_one_block  0.01877117156982422
generate_one_block  0.019443273544311523
generate_one_block  0.018183469772338867
generate_one_block  0.021537065505981445
generate_one_block  0.01909804344177246
generate_one_block  0.01852107048034668
generate_one_block  0.017942190170288086
generate_one_block  0.018195629119873047
generate_one_block  0.01889491081237793
generate_one_block  0.01792168617248535
generate_one_block  0.01838064193725586
generate_one_block  0.018741130828857422
generate_one_block  0.018056869506835938
generate_one_block  0.01961231231689453
generate_one_block  0.02140188217163086
generate_one_block  0.0183718204498291
generate_one_block  0.018260478973388672
generate_one_block  0.018741846084594727
generate_one_block  0.018288373947143555
generate_one_block  0.018752098083496094
generate_one_block  0.01876091957092285
generate_one_block  0.018501996994018555
generate_one_block  0.01833629608154297
generate_one_block  0.018679141998291016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03837156295776367
gen group dst list time:  0.02402973175048828
time for parepare:  0.02225661277770996
local_output_nid generation:  0.008218050003051758
local_in_edges_tensor generation:  0.0203704833984375
mini_batch_src_global generation:  0.018706560134887695
r_  generation:  0.1690831184387207
local_output_nid generation:  0.008452415466308594
local_in_edges_tensor generation:  0.011128902435302734
mini_batch_src_global generation:  0.022501230239868164
r_  generation:  0.17237520217895508
local_output_nid generation:  0.007926464080810547
local_in_edges_tensor generation:  0.03715348243713379
mini_batch_src_global generation:  0.02078843116760254
r_  generation:  0.1772747039794922
local_output_nid generation:  0.008087635040283203
local_in_edges_tensor generation:  0.011915445327758789
mini_batch_src_global generation:  0.02088022232055664
r_  generation:  0.1791677474975586
local_output_nid generation:  0.008819580078125
local_in_edges_tensor generation:  0.008846282958984375
mini_batch_src_global generation:  0.025764942169189453
r_  generation:  0.18524718284606934
local_output_nid generation:  0.008862733840942383
local_in_edges_tensor generation:  0.011083364486694336
mini_batch_src_global generation:  0.02379131317138672
r_  generation:  0.18432378768920898
local_output_nid generation:  0.009096860885620117
local_in_edges_tensor generation:  0.010154247283935547
mini_batch_src_global generation:  0.024482250213623047
r_  generation:  0.18281149864196777
local_output_nid generation:  0.008895397186279297
local_in_edges_tensor generation:  0.011598348617553711
mini_batch_src_global generation:  0.023240327835083008
r_  generation:  0.23596549034118652
local_output_nid generation:  0.011018514633178711
local_in_edges_tensor generation:  0.010861396789550781
mini_batch_src_global generation:  0.023680448532104492
r_  generation:  0.1859438419342041
local_output_nid generation:  0.00978851318359375
local_in_edges_tensor generation:  0.012671947479248047
mini_batch_src_global generation:  0.024899959564208984
r_  generation:  0.1899707317352295
local_output_nid generation:  0.0091705322265625
local_in_edges_tensor generation:  0.008985280990600586
mini_batch_src_global generation:  0.023463964462280273
r_  generation:  0.18030071258544922
local_output_nid generation:  0.00970149040222168
local_in_edges_tensor generation:  0.009177684783935547
mini_batch_src_global generation:  0.023641586303710938
r_  generation:  0.18390655517578125
local_output_nid generation:  0.009642362594604492
local_in_edges_tensor generation:  0.012612342834472656
mini_batch_src_global generation:  0.025278806686401367
r_  generation:  0.1875600814819336
local_output_nid generation:  0.009482622146606445
local_in_edges_tensor generation:  0.00928187370300293
mini_batch_src_global generation:  0.023734569549560547
r_  generation:  0.184190034866333
local_output_nid generation:  0.009141921997070312
local_in_edges_tensor generation:  0.009394407272338867
mini_batch_src_global generation:  0.022832870483398438
r_  generation:  0.17701196670532227
local_output_nid generation:  0.00925588607788086
local_in_edges_tensor generation:  0.008683204650878906
mini_batch_src_global generation:  0.02269601821899414
r_  generation:  0.179962158203125
local_output_nid generation:  0.009729862213134766
local_in_edges_tensor generation:  0.010602474212646484
mini_batch_src_global generation:  0.024141550064086914
r_  generation:  0.18764400482177734
local_output_nid generation:  0.009221315383911133
local_in_edges_tensor generation:  0.008780241012573242
mini_batch_src_global generation:  0.026434659957885742
r_  generation:  0.18207406997680664
local_output_nid generation:  0.009392976760864258
local_in_edges_tensor generation:  0.009096860885620117
mini_batch_src_global generation:  0.024306535720825195
r_  generation:  0.18463921546936035
local_output_nid generation:  0.00952005386352539
local_in_edges_tensor generation:  0.01036524772644043
mini_batch_src_global generation:  0.023215055465698242
r_  generation:  0.18347430229187012
local_output_nid generation:  0.009380340576171875
local_in_edges_tensor generation:  0.009033441543579102
mini_batch_src_global generation:  0.023055553436279297
r_  generation:  0.18072843551635742
local_output_nid generation:  0.010048866271972656
local_in_edges_tensor generation:  0.012135744094848633
mini_batch_src_global generation:  0.02548074722290039
r_  generation:  0.19718074798583984
local_output_nid generation:  0.009501934051513672
local_in_edges_tensor generation:  0.009141921997070312
mini_batch_src_global generation:  0.023311376571655273
r_  generation:  0.18089652061462402
local_output_nid generation:  0.00944375991821289
local_in_edges_tensor generation:  0.009664773941040039
mini_batch_src_global generation:  0.023411989212036133
r_  generation:  0.18654751777648926
local_output_nid generation:  0.009503602981567383
local_in_edges_tensor generation:  0.008857011795043945
mini_batch_src_global generation:  0.02298712730407715
r_  generation:  0.18320846557617188
local_output_nid generation:  0.00966954231262207
local_in_edges_tensor generation:  0.009436607360839844
mini_batch_src_global generation:  0.035265207290649414
r_  generation:  0.19054627418518066
local_output_nid generation:  0.009567737579345703
local_in_edges_tensor generation:  0.009077072143554688
mini_batch_src_global generation:  0.023493051528930664
r_  generation:  0.18735671043395996
local_output_nid generation:  0.009851455688476562
local_in_edges_tensor generation:  0.010221481323242188
mini_batch_src_global generation:  0.02411651611328125
r_  generation:  0.19347071647644043
local_output_nid generation:  0.009706497192382812
local_in_edges_tensor generation:  0.009390115737915039
mini_batch_src_global generation:  0.024267911911010742
r_  generation:  0.19159150123596191
local_output_nid generation:  0.009627819061279297
local_in_edges_tensor generation:  0.009388923645019531
mini_batch_src_global generation:  0.023882627487182617
r_  generation:  0.19085216522216797
local_output_nid generation:  0.009735822677612305
local_in_edges_tensor generation:  0.01219487190246582
mini_batch_src_global generation:  0.023474454879760742
r_  generation:  0.18701887130737305
local_output_nid generation:  0.010454177856445312
local_in_edges_tensor generation:  0.009966135025024414
mini_batch_src_global generation:  0.02284693717956543
r_  generation:  0.18745160102844238
----------------------check_connections_block total spend ----------------------------- 8.745361566543579
generate_one_block  0.26616811752319336
generate_one_block  0.24266552925109863
generate_one_block  0.2454075813293457
generate_one_block  0.2417464256286621
generate_one_block  0.25953078269958496
generate_one_block  0.2476201057434082
generate_one_block  0.24468612670898438
generate_one_block  0.24049043655395508
generate_one_block  0.25078320503234863
generate_one_block  0.2614176273345947
generate_one_block  0.24431777000427246
generate_one_block  0.25670862197875977
generate_one_block  0.26268601417541504
generate_one_block  0.2520875930786133
generate_one_block  0.24026846885681152
generate_one_block  0.23981881141662598
generate_one_block  0.2545511722564697
generate_one_block  0.2419290542602539
generate_one_block  0.2485496997833252
generate_one_block  0.25245189666748047
generate_one_block  0.24274992942810059
generate_one_block  0.2656099796295166
generate_one_block  0.23900580406188965
generate_one_block  0.2455730438232422
generate_one_block  0.24729537963867188
generate_one_block  0.2612571716308594
generate_one_block  0.25008344650268555
generate_one_block  0.2568693161010742
generate_one_block  0.251997709274292
generate_one_block  0.25453615188598633
generate_one_block  0.2490067481994629
generate_one_block  0.24437165260314941
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0411524772644043
gen group dst list time:  0.11565065383911133
time for parepare:  0.018996000289916992
local_output_nid generation:  0.026524782180786133
local_in_edges_tensor generation:  0.05030655860900879
mini_batch_src_global generation:  0.04053378105163574
r_  generation:  0.42554473876953125
local_output_nid generation:  0.03155851364135742
local_in_edges_tensor generation:  0.03519606590270996
mini_batch_src_global generation:  0.05077862739562988
r_  generation:  0.4323103427886963
local_output_nid generation:  0.03193855285644531
local_in_edges_tensor generation:  0.029129743576049805
mini_batch_src_global generation:  0.05005240440368652
r_  generation:  0.4375123977661133
local_output_nid generation:  0.03206300735473633
local_in_edges_tensor generation:  0.029410123825073242
mini_batch_src_global generation:  0.0509335994720459
r_  generation:  0.4332451820373535
local_output_nid generation:  0.03209424018859863
local_in_edges_tensor generation:  0.02943277359008789
mini_batch_src_global generation:  0.05060410499572754
r_  generation:  0.4378688335418701
local_output_nid generation:  0.03210806846618652
local_in_edges_tensor generation:  0.032723188400268555
mini_batch_src_global generation:  0.05329728126525879
r_  generation:  0.43726277351379395
local_output_nid generation:  0.03061199188232422
local_in_edges_tensor generation:  0.029596805572509766
mini_batch_src_global generation:  0.05101799964904785
r_  generation:  0.4403374195098877
local_output_nid generation:  0.03250694274902344
local_in_edges_tensor generation:  0.035921335220336914
mini_batch_src_global generation:  0.052031755447387695
r_  generation:  0.433760404586792
local_output_nid generation:  0.030971050262451172
local_in_edges_tensor generation:  0.03225898742675781
mini_batch_src_global generation:  0.0507962703704834
r_  generation:  0.44022488594055176
local_output_nid generation:  0.03127169609069824
local_in_edges_tensor generation:  0.030371665954589844
mini_batch_src_global generation:  0.05217552185058594
r_  generation:  0.4402143955230713
local_output_nid generation:  0.03162121772766113
local_in_edges_tensor generation:  0.03031158447265625
mini_batch_src_global generation:  0.052907705307006836
r_  generation:  0.44043612480163574
local_output_nid generation:  0.03107309341430664
local_in_edges_tensor generation:  0.029949426651000977
mini_batch_src_global generation:  0.052108049392700195
r_  generation:  0.4349093437194824
local_output_nid generation:  0.03309798240661621
local_in_edges_tensor generation:  0.029920578002929688
mini_batch_src_global generation:  0.05059385299682617
r_  generation:  0.4380342960357666
local_output_nid generation:  0.031661033630371094
local_in_edges_tensor generation:  0.03400468826293945
mini_batch_src_global generation:  0.052263736724853516
r_  generation:  0.43184781074523926
local_output_nid generation:  0.030942201614379883
local_in_edges_tensor generation:  0.0303652286529541
mini_batch_src_global generation:  0.05098128318786621
r_  generation:  0.43506598472595215
local_output_nid generation:  0.030987977981567383
local_in_edges_tensor generation:  0.02790522575378418
mini_batch_src_global generation:  0.06311559677124023
r_  generation:  0.43956780433654785
local_output_nid generation:  0.03259158134460449
local_in_edges_tensor generation:  0.03168296813964844
mini_batch_src_global generation:  0.050811767578125
r_  generation:  0.4397895336151123
local_output_nid generation:  0.030141592025756836
local_in_edges_tensor generation:  0.02815103530883789
mini_batch_src_global generation:  0.05207419395446777
r_  generation:  0.4339323043823242
local_output_nid generation:  0.030120134353637695
local_in_edges_tensor generation:  0.029648780822753906
mini_batch_src_global generation:  0.05265450477600098
r_  generation:  0.4385557174682617
local_output_nid generation:  0.03026270866394043
local_in_edges_tensor generation:  0.029343605041503906
mini_batch_src_global generation:  0.051650047302246094
r_  generation:  0.4351520538330078
local_output_nid generation:  0.030102014541625977
local_in_edges_tensor generation:  0.029872655868530273
mini_batch_src_global generation:  0.07861995697021484
r_  generation:  0.43862342834472656
local_output_nid generation:  0.030561447143554688
local_in_edges_tensor generation:  0.03007054328918457
mini_batch_src_global generation:  0.0520176887512207
r_  generation:  0.440136194229126
local_output_nid generation:  0.03048563003540039
local_in_edges_tensor generation:  0.02966928482055664
mini_batch_src_global generation:  0.05115056037902832
r_  generation:  0.4383049011230469
local_output_nid generation:  0.030544281005859375
local_in_edges_tensor generation:  0.030159950256347656
mini_batch_src_global generation:  0.05215263366699219
r_  generation:  0.4406130313873291
local_output_nid generation:  0.030350685119628906
local_in_edges_tensor generation:  0.028549671173095703
mini_batch_src_global generation:  0.05075192451477051
r_  generation:  0.4385828971862793
local_output_nid generation:  0.030493974685668945
local_in_edges_tensor generation:  0.032283782958984375
mini_batch_src_global generation:  0.05412626266479492
r_  generation:  0.43655943870544434
local_output_nid generation:  0.030402421951293945
local_in_edges_tensor generation:  0.02817058563232422
mini_batch_src_global generation:  0.05113363265991211
r_  generation:  0.44180965423583984
local_output_nid generation:  0.03080296516418457
local_in_edges_tensor generation:  0.03012704849243164
mini_batch_src_global generation:  0.054386138916015625
r_  generation:  0.4438338279724121
local_output_nid generation:  0.03088998794555664
local_in_edges_tensor generation:  0.03176689147949219
mini_batch_src_global generation:  0.05097532272338867
r_  generation:  0.44847559928894043
local_output_nid generation:  0.03051304817199707
local_in_edges_tensor generation:  0.03199315071105957
mini_batch_src_global generation:  0.05246472358703613
r_  generation:  0.44179391860961914
local_output_nid generation:  0.030523300170898438
local_in_edges_tensor generation:  0.029815673828125
mini_batch_src_global generation:  0.05158090591430664
r_  generation:  0.44110989570617676
local_output_nid generation:  0.03017902374267578
local_in_edges_tensor generation:  0.030344247817993164
mini_batch_src_global generation:  0.05327773094177246
r_  generation:  0.4304814338684082
----------------------check_connections_block total spend ----------------------------- 20.86984920501709
generate_one_block  0.6051902770996094
generate_one_block  0.5830206871032715
generate_one_block  0.5895922183990479
generate_one_block  0.5917794704437256
generate_one_block  0.6907432079315186
generate_one_block  0.5868937969207764
generate_one_block  0.5921895503997803
generate_one_block  0.5905699729919434
generate_one_block  0.5915794372558594
generate_one_block  0.5984671115875244
generate_one_block  0.5867085456848145
generate_one_block  0.5830216407775879
generate_one_block  0.5890257358551025
generate_one_block  0.5924110412597656
generate_one_block  0.5830562114715576
generate_one_block  0.5823092460632324
generate_one_block  0.5927212238311768
generate_one_block  0.5839982032775879
generate_one_block  0.5864760875701904
generate_one_block  0.5891342163085938
generate_one_block  0.6087217330932617
generate_one_block  0.5968701839447021
generate_one_block  0.5848453044891357
generate_one_block  0.5873663425445557
generate_one_block  0.5982668399810791
generate_one_block  0.5898215770721436
generate_one_block  0.5880980491638184
generate_one_block  0.6007497310638428
generate_one_block  0.5969438552856445
generate_one_block  0.5829298496246338
generate_one_block  0.588348388671875
generate_one_block  0.5781903266906738
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.12693405151367188  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

connection checking time:  29.61521077156067
block generation total time  26.992281436920166
average batch blocks generation time:  0.8435087949037552
block dataloader generation time/epoch 59.67224745750427
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10667991638183594  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.90601348876953  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10625314712524414  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.683019161224365  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.1068263053894043  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.85426139831543  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10681390762329102  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.759933948516846  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10640716552734375  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.715839862823486  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10675525665283203  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.894165515899658  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10648775100708008  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.808820247650146  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10646867752075195  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.68335723876953  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10639715194702148  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.900180339813232  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10700464248657227  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.451716899871826  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10675764083862305  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.672632217407227  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10650253295898438  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.99431800842285  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10664129257202148  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.16898250579834  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10655736923217773  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.979923248291016  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10634469985961914  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.305603504180908  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10615921020507812  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.50812005996704  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.1068415641784668  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.203836917877197  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10623884201049805  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.61996555328369  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10645627975463867  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.904067993164062  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.1066141128540039  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.869068145751953  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10659265518188477  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 18.73154878616333  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 0.10700035095214844  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4959716796875 GB
    Memory Allocated: 19.577728271484375  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10646343231201172  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.65768527984619  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10661172866821289  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.916563510894775  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10642242431640625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.71237850189209  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10678529739379883  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.082688331604004  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10671806335449219  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.849666595458984  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10698270797729492  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.35439968109131  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10690116882324219  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.17853355407715  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10650491714477539  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.089226722717285  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10656595230102539  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.869352340698242  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10626506805419922  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.73094654083252  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035521499812603 |0.019740350544452667 |0.5570346936583519 |9.436905384063721e-05 |1.0591517835855484 |0.007864952087402344 |
----------------------------------------------------------pseudo_mini_loss sum 1.3053741455078125
Total (block generation + training)time/epoch 113.33075636227926
Training time/epoch 53.54856324195862
Training time without block to device /epoch 52.91687202453613
Training time without total dataloading part /epoch 51.72885203361511
load block tensor time/epoch 1.136687994003296
block to device time/epoch 0.6316912174224854
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  9114062
Number of first layer input nodes during this epoch:  4761733
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1261897087097168  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025162696838378906
range selection method range initialization spend 0.013826847076416016
time for parepare:  0.018899917602539062
local_output_nid generation:  0.0009794235229492188
local_in_edges_tensor generation:  0.006544589996337891
mini_batch_src_global generation:  0.0014412403106689453
r_  generation:  0.011004924774169922
local_output_nid generation:  0.0010025501251220703
local_in_edges_tensor generation:  0.0006818771362304688
mini_batch_src_global generation:  0.0013594627380371094
r_  generation:  0.010477781295776367
local_output_nid generation:  0.000942230224609375
local_in_edges_tensor generation:  0.0006310939788818359
mini_batch_src_global generation:  0.0011265277862548828
r_  generation:  0.009476423263549805
local_output_nid generation:  0.0009398460388183594
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0011205673217773438
r_  generation:  0.009656667709350586
local_output_nid generation:  0.0009086132049560547
local_in_edges_tensor generation:  0.0006005764007568359
mini_batch_src_global generation:  0.0011456012725830078
r_  generation:  0.009972095489501953
local_output_nid generation:  0.0009012222290039062
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0010662078857421875
r_  generation:  0.009615421295166016
local_output_nid generation:  0.0009090900421142578
local_in_edges_tensor generation:  0.0005915164947509766
mini_batch_src_global generation:  0.0011146068572998047
r_  generation:  0.01015782356262207
local_output_nid generation:  0.0009279251098632812
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0010848045349121094
r_  generation:  0.009849786758422852
local_output_nid generation:  0.0009162425994873047
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0011725425720214844
r_  generation:  0.010267496109008789
local_output_nid generation:  0.0008883476257324219
local_in_edges_tensor generation:  0.0005774497985839844
mini_batch_src_global generation:  0.0011277198791503906
r_  generation:  0.010339498519897461
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.0011718273162841797
r_  generation:  0.010255575180053711
local_output_nid generation:  0.0008876323699951172
local_in_edges_tensor generation:  0.0005781650543212891
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.010094165802001953
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.0011887550354003906
r_  generation:  0.010185003280639648
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0006101131439208984
mini_batch_src_global generation:  0.0011911392211914062
r_  generation:  0.010779857635498047
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0005676746368408203
mini_batch_src_global generation:  0.0011627674102783203
r_  generation:  0.010511398315429688
local_output_nid generation:  0.0008928775787353516
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.0011782646179199219
r_  generation:  0.010640859603881836
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0005583763122558594
mini_batch_src_global generation:  0.001119852066040039
r_  generation:  0.010040760040283203
local_output_nid generation:  0.0008840560913085938
local_in_edges_tensor generation:  0.0005679130554199219
mini_batch_src_global generation:  0.0011899471282958984
r_  generation:  0.01016545295715332
local_output_nid generation:  0.0008873939514160156
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0012345314025878906
r_  generation:  0.010477304458618164
local_output_nid generation:  0.0008761882781982422
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0012183189392089844
r_  generation:  0.010068416595458984
local_output_nid generation:  0.0008687973022460938
local_in_edges_tensor generation:  0.0005660057067871094
mini_batch_src_global generation:  0.0012331008911132812
r_  generation:  0.010521888732910156
local_output_nid generation:  0.0008780956268310547
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.0012068748474121094
r_  generation:  0.010648250579833984
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.0012328624725341797
r_  generation:  0.010220527648925781
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.0011713504791259766
r_  generation:  0.010350227355957031
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.010340452194213867
local_output_nid generation:  0.0008556842803955078
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.010181188583374023
local_output_nid generation:  0.0008728504180908203
local_in_edges_tensor generation:  0.0005857944488525391
mini_batch_src_global generation:  0.0012462139129638672
r_  generation:  0.01053166389465332
local_output_nid generation:  0.0008687973022460938
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.010513544082641602
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.0005631446838378906
mini_batch_src_global generation:  0.0011188983917236328
r_  generation:  0.010049581527709961
local_output_nid generation:  0.0008590221405029297
local_in_edges_tensor generation:  0.0007243156433105469
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.010020017623901367
local_output_nid generation:  0.000865936279296875
local_in_edges_tensor generation:  0.0005600452423095703
mini_batch_src_global generation:  0.001157522201538086
r_  generation:  0.010303020477294922
local_output_nid generation:  0.0008497238159179688
local_in_edges_tensor generation:  0.0005729198455810547
mini_batch_src_global generation:  0.0011456012725830078
r_  generation:  0.010135650634765625
----------------------check_connections_block total spend ----------------------------- 0.5182044506072998
generate_one_block  0.021745920181274414
generate_one_block  0.020183086395263672
generate_one_block  0.01853632926940918
generate_one_block  0.0183713436126709
generate_one_block  0.018708229064941406
generate_one_block  0.01799750328063965
generate_one_block  0.018724918365478516
generate_one_block  0.018108367919921875
generate_one_block  0.018901586532592773
generate_one_block  0.018835067749023438
generate_one_block  0.020015239715576172
generate_one_block  0.020173311233520508
generate_one_block  0.01899576187133789
generate_one_block  0.019526243209838867
generate_one_block  0.018825531005859375
generate_one_block  0.019080638885498047
generate_one_block  0.018083810806274414
generate_one_block  0.018451213836669922
generate_one_block  0.018874406814575195
generate_one_block  0.018229961395263672
generate_one_block  0.018880367279052734
generate_one_block  0.01919865608215332
generate_one_block  0.01849055290222168
generate_one_block  0.018494606018066406
generate_one_block  0.01874089241027832
generate_one_block  0.018471956253051758
generate_one_block  0.018754243850708008
generate_one_block  0.018780946731567383
generate_one_block  0.017926931381225586
generate_one_block  0.01816868782043457
generate_one_block  0.01852107048034668
generate_one_block  0.018166542053222656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044996023178100586
gen group dst list time:  0.020681381225585938
time for parepare:  0.02031111717224121
local_output_nid generation:  0.005673646926879883
local_in_edges_tensor generation:  0.016521453857421875
mini_batch_src_global generation:  0.01788926124572754
r_  generation:  0.1711139678955078
local_output_nid generation:  0.007714271545410156
local_in_edges_tensor generation:  0.010846853256225586
mini_batch_src_global generation:  0.022956371307373047
r_  generation:  0.16681814193725586
local_output_nid generation:  0.007904052734375
local_in_edges_tensor generation:  0.03324246406555176
mini_batch_src_global generation:  0.020186424255371094
r_  generation:  0.17204880714416504
local_output_nid generation:  0.008409976959228516
local_in_edges_tensor generation:  0.009035110473632812
mini_batch_src_global generation:  0.022449731826782227
r_  generation:  0.17264199256896973
local_output_nid generation:  0.00865316390991211
local_in_edges_tensor generation:  0.009140729904174805
mini_batch_src_global generation:  0.02250528335571289
r_  generation:  0.18998122215270996
local_output_nid generation:  0.010582685470581055
local_in_edges_tensor generation:  0.011189699172973633
mini_batch_src_global generation:  0.022417306900024414
r_  generation:  0.17451024055480957
local_output_nid generation:  0.008660078048706055
local_in_edges_tensor generation:  0.010838508605957031
mini_batch_src_global generation:  0.023146390914916992
r_  generation:  0.18208670616149902
local_output_nid generation:  0.008592605590820312
local_in_edges_tensor generation:  0.009299993515014648
mini_batch_src_global generation:  0.022607088088989258
r_  generation:  0.17312407493591309
local_output_nid generation:  0.008968114852905273
local_in_edges_tensor generation:  0.010171651840209961
mini_batch_src_global generation:  0.02390265464782715
r_  generation:  0.1879420280456543
local_output_nid generation:  0.009245634078979492
local_in_edges_tensor generation:  0.009613513946533203
mini_batch_src_global generation:  0.024182558059692383
r_  generation:  0.18421077728271484
local_output_nid generation:  0.009307622909545898
local_in_edges_tensor generation:  0.008900880813598633
mini_batch_src_global generation:  0.023065805435180664
r_  generation:  0.18867802619934082
local_output_nid generation:  0.009315967559814453
local_in_edges_tensor generation:  0.008919954299926758
mini_batch_src_global generation:  0.023007631301879883
r_  generation:  0.1773843765258789
local_output_nid generation:  0.00932621955871582
local_in_edges_tensor generation:  0.008768081665039062
mini_batch_src_global generation:  0.023310422897338867
r_  generation:  0.18343901634216309
local_output_nid generation:  0.009681224822998047
local_in_edges_tensor generation:  0.012063026428222656
mini_batch_src_global generation:  0.025536775588989258
r_  generation:  0.18922781944274902
local_output_nid generation:  0.009472370147705078
local_in_edges_tensor generation:  0.009078502655029297
mini_batch_src_global generation:  0.023955583572387695
r_  generation:  0.186798095703125
local_output_nid generation:  0.009432554244995117
local_in_edges_tensor generation:  0.009109735488891602
mini_batch_src_global generation:  0.024778366088867188
r_  generation:  0.1875171661376953
local_output_nid generation:  0.00922536849975586
local_in_edges_tensor generation:  0.008941888809204102
mini_batch_src_global generation:  0.023107051849365234
r_  generation:  0.17868566513061523
local_output_nid generation:  0.009457826614379883
local_in_edges_tensor generation:  0.009267330169677734
mini_batch_src_global generation:  0.02385687828063965
r_  generation:  0.18201851844787598
local_output_nid generation:  0.009610891342163086
local_in_edges_tensor generation:  0.009285688400268555
mini_batch_src_global generation:  0.023706912994384766
r_  generation:  0.18804001808166504
local_output_nid generation:  0.009385108947753906
local_in_edges_tensor generation:  0.008919954299926758
mini_batch_src_global generation:  0.02389216423034668
r_  generation:  0.18094229698181152
local_output_nid generation:  0.009376049041748047
local_in_edges_tensor generation:  0.009072303771972656
mini_batch_src_global generation:  0.023638486862182617
r_  generation:  0.18851780891418457
local_output_nid generation:  0.009649515151977539
local_in_edges_tensor generation:  0.010338068008422852
mini_batch_src_global generation:  0.025497913360595703
r_  generation:  0.18947625160217285
local_output_nid generation:  0.009413480758666992
local_in_edges_tensor generation:  0.009169340133666992
mini_batch_src_global generation:  0.023454904556274414
r_  generation:  0.18449068069458008
local_output_nid generation:  0.00947880744934082
local_in_edges_tensor generation:  0.008933782577514648
mini_batch_src_global generation:  0.024264812469482422
r_  generation:  0.1828920841217041
local_output_nid generation:  0.009481430053710938
local_in_edges_tensor generation:  0.009236812591552734
mini_batch_src_global generation:  0.023083209991455078
r_  generation:  0.18256640434265137
local_output_nid generation:  0.009408712387084961
local_in_edges_tensor generation:  0.00863957405090332
mini_batch_src_global generation:  0.023172378540039062
r_  generation:  0.18245673179626465
local_output_nid generation:  0.009547233581542969
local_in_edges_tensor generation:  0.010408639907836914
mini_batch_src_global generation:  0.02346634864807129
r_  generation:  0.18746614456176758
local_output_nid generation:  0.009529829025268555
local_in_edges_tensor generation:  0.009721517562866211
mini_batch_src_global generation:  0.024132490158081055
r_  generation:  0.18665671348571777
local_output_nid generation:  0.009291887283325195
local_in_edges_tensor generation:  0.008814334869384766
mini_batch_src_global generation:  0.0231478214263916
r_  generation:  0.18046975135803223
local_output_nid generation:  0.009386301040649414
local_in_edges_tensor generation:  0.008645772933959961
mini_batch_src_global generation:  0.024465322494506836
r_  generation:  0.1817305088043213
local_output_nid generation:  0.009307146072387695
local_in_edges_tensor generation:  0.009463787078857422
mini_batch_src_global generation:  0.022980690002441406
r_  generation:  0.18282365798950195
local_output_nid generation:  0.00935983657836914
local_in_edges_tensor generation:  0.00881814956665039
mini_batch_src_global generation:  0.023321866989135742
r_  generation:  0.18135619163513184
----------------------check_connections_block total spend ----------------------------- 8.559760570526123
generate_one_block  0.2594449520111084
generate_one_block  0.24355769157409668
generate_one_block  0.2388150691986084
generate_one_block  0.24286842346191406
generate_one_block  0.26075029373168945
generate_one_block  0.23693275451660156
generate_one_block  0.24693799018859863
generate_one_block  0.23712158203125
generate_one_block  0.25470709800720215
generate_one_block  0.2532031536102295
generate_one_block  0.24814128875732422
generate_one_block  0.2399611473083496
generate_one_block  0.24894952774047852
generate_one_block  0.259014368057251
generate_one_block  0.24979090690612793
generate_one_block  0.2563152313232422
generate_one_block  0.24043011665344238
generate_one_block  0.2462177276611328
generate_one_block  0.25426411628723145
generate_one_block  0.25086045265197754
generate_one_block  0.25502896308898926
generate_one_block  0.25749921798706055
generate_one_block  0.24877619743347168
generate_one_block  0.24834990501403809
generate_one_block  0.24423837661743164
generate_one_block  0.24523067474365234
generate_one_block  0.2540466785430908
generate_one_block  0.25486302375793457
generate_one_block  0.24149203300476074
generate_one_block  0.24474430084228516
generate_one_block  0.24496960639953613
generate_one_block  0.2429065704345703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030056476593017578
gen group dst list time:  0.1065526008605957
time for parepare:  0.020735979080200195
local_output_nid generation:  0.025219202041625977
local_in_edges_tensor generation:  0.047385454177856445
mini_batch_src_global generation:  0.040201663970947266
r_  generation:  0.42711806297302246
local_output_nid generation:  0.03086233139038086
local_in_edges_tensor generation:  0.03545212745666504
mini_batch_src_global generation:  0.05021262168884277
r_  generation:  0.42540478706359863
local_output_nid generation:  0.030779123306274414
local_in_edges_tensor generation:  0.029307126998901367
mini_batch_src_global generation:  0.04938626289367676
r_  generation:  0.43390345573425293
local_output_nid generation:  0.030875444412231445
local_in_edges_tensor generation:  0.029286623001098633
mini_batch_src_global generation:  0.05199265480041504
r_  generation:  0.43239617347717285
local_output_nid generation:  0.030974149703979492
local_in_edges_tensor generation:  0.030777454376220703
mini_batch_src_global generation:  0.04976296424865723
r_  generation:  0.4389195442199707
local_output_nid generation:  0.030840158462524414
local_in_edges_tensor generation:  0.02707052230834961
mini_batch_src_global generation:  0.05054497718811035
r_  generation:  0.43473196029663086
local_output_nid generation:  0.030012845993041992
local_in_edges_tensor generation:  0.028890609741210938
mini_batch_src_global generation:  0.052280426025390625
r_  generation:  0.4390695095062256
local_output_nid generation:  0.02919912338256836
local_in_edges_tensor generation:  0.0292966365814209
mini_batch_src_global generation:  0.05104780197143555
r_  generation:  0.43337106704711914
local_output_nid generation:  0.029802322387695312
local_in_edges_tensor generation:  0.028472185134887695
mini_batch_src_global generation:  0.050354719161987305
r_  generation:  0.440082311630249
local_output_nid generation:  0.02954864501953125
local_in_edges_tensor generation:  0.029453277587890625
mini_batch_src_global generation:  0.05167412757873535
r_  generation:  0.43831324577331543
local_output_nid generation:  0.029494285583496094
local_in_edges_tensor generation:  0.029379844665527344
mini_batch_src_global generation:  0.05141139030456543
r_  generation:  0.44020700454711914
local_output_nid generation:  0.029568910598754883
local_in_edges_tensor generation:  0.03092050552368164
mini_batch_src_global generation:  0.05754423141479492
r_  generation:  0.438551664352417
local_output_nid generation:  0.02934122085571289
local_in_edges_tensor generation:  0.027924776077270508
mini_batch_src_global generation:  0.05156850814819336
r_  generation:  0.4367709159851074
local_output_nid generation:  0.029492855072021484
local_in_edges_tensor generation:  0.029687881469726562
mini_batch_src_global generation:  0.052689552307128906
r_  generation:  0.43648672103881836
local_output_nid generation:  0.029429912567138672
local_in_edges_tensor generation:  0.02969050407409668
mini_batch_src_global generation:  0.05151057243347168
r_  generation:  0.44210338592529297
local_output_nid generation:  0.02952718734741211
local_in_edges_tensor generation:  0.030110836029052734
mini_batch_src_global generation:  0.05246281623840332
r_  generation:  0.43912577629089355
local_output_nid generation:  0.02926492691040039
local_in_edges_tensor generation:  0.032378435134887695
mini_batch_src_global generation:  0.05159592628479004
r_  generation:  0.4400970935821533
local_output_nid generation:  0.03003668785095215
local_in_edges_tensor generation:  0.028594970703125
mini_batch_src_global generation:  0.05239391326904297
r_  generation:  0.4389169216156006
local_output_nid generation:  0.029634714126586914
local_in_edges_tensor generation:  0.031826019287109375
mini_batch_src_global generation:  0.051334381103515625
r_  generation:  0.44049596786499023
local_output_nid generation:  0.02951192855834961
local_in_edges_tensor generation:  0.027835369110107422
mini_batch_src_global generation:  0.05415749549865723
r_  generation:  0.440265417098999
local_output_nid generation:  0.029340744018554688
local_in_edges_tensor generation:  0.028711795806884766
mini_batch_src_global generation:  0.05153155326843262
r_  generation:  0.43790555000305176
local_output_nid generation:  0.029398441314697266
local_in_edges_tensor generation:  0.03292989730834961
mini_batch_src_global generation:  0.05384516716003418
r_  generation:  0.4351961612701416
local_output_nid generation:  0.029658794403076172
local_in_edges_tensor generation:  0.02921581268310547
mini_batch_src_global generation:  0.05366015434265137
r_  generation:  0.43996644020080566
local_output_nid generation:  0.029787063598632812
local_in_edges_tensor generation:  0.030698537826538086
mini_batch_src_global generation:  0.052246809005737305
r_  generation:  0.43786072731018066
local_output_nid generation:  0.02954554557800293
local_in_edges_tensor generation:  0.028478622436523438
mini_batch_src_global generation:  0.051334381103515625
r_  generation:  0.4428226947784424
local_output_nid generation:  0.029759645462036133
local_in_edges_tensor generation:  0.02787303924560547
mini_batch_src_global generation:  0.054404497146606445
r_  generation:  0.4374730587005615
local_output_nid generation:  0.029221773147583008
local_in_edges_tensor generation:  0.028225421905517578
mini_batch_src_global generation:  0.0509181022644043
r_  generation:  0.4391312599182129
local_output_nid generation:  0.029624462127685547
local_in_edges_tensor generation:  0.028085708618164062
mini_batch_src_global generation:  0.05186152458190918
r_  generation:  0.43840622901916504
local_output_nid generation:  0.02938103675842285
local_in_edges_tensor generation:  0.027919292449951172
mini_batch_src_global generation:  0.05126595497131348
r_  generation:  0.4370119571685791
local_output_nid generation:  0.029666423797607422
local_in_edges_tensor generation:  0.030030012130737305
mini_batch_src_global generation:  0.05271768569946289
r_  generation:  0.4388766288757324
local_output_nid generation:  0.030572891235351562
local_in_edges_tensor generation:  0.031617164611816406
mini_batch_src_global generation:  0.051010847091674805
r_  generation:  0.4432551860809326
local_output_nid generation:  0.029694795608520508
local_in_edges_tensor generation:  0.03038930892944336
mini_batch_src_global generation:  0.05268287658691406
r_  generation:  0.4372141361236572
----------------------check_connections_block total spend ----------------------------- 20.737190008163452
generate_one_block  0.5945615768432617
generate_one_block  0.5826582908630371
generate_one_block  0.5797975063323975
generate_one_block  0.5864043235778809
generate_one_block  0.6731762886047363
generate_one_block  0.5856871604919434
generate_one_block  0.583183765411377
generate_one_block  0.5792222023010254
generate_one_block  0.5959999561309814
generate_one_block  0.5919644832611084
generate_one_block  0.5801100730895996
generate_one_block  0.5887207984924316
generate_one_block  0.5884802341461182
generate_one_block  0.5881772041320801
generate_one_block  0.5946552753448486
generate_one_block  0.5916755199432373
generate_one_block  0.5805649757385254
generate_one_block  0.5942387580871582
generate_one_block  0.5981137752532959
generate_one_block  0.595954179763794
generate_one_block  0.5896694660186768
generate_one_block  0.6003661155700684
generate_one_block  0.5925726890563965
generate_one_block  0.5955536365509033
generate_one_block  0.6014599800109863
generate_one_block  0.5919773578643799
generate_one_block  0.5856928825378418
generate_one_block  0.5872182846069336
generate_one_block  0.5922892093658447
generate_one_block  0.590831995010376
generate_one_block  0.5953969955444336
generate_one_block  0.5841467380523682
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1261897087097168  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

connection checking time:  29.296950578689575
block generation total time  26.910951137542725
average batch blocks generation time:  0.8409672230482101
block dataloader generation time/epoch 59.66166082024574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10673952102661133  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.193137645721436  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10643196105957031  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.67535924911499  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10653495788574219  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.59081220626831  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1064157485961914  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.74151372909546  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10660552978515625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.712975025177002  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10634231567382812  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.404099464416504  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10636758804321289  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.889795780181885  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10642194747924805  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.451982975006104  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10708045959472656  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.299315452575684  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10661602020263672  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.09322500228882  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10659551620483398  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.965569496154785  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10667800903320312  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.69897222518921  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10666513442993164  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.845698356628418  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10680532455444336  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.38229274749756  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10694074630737305  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.124255657196045  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10696697235107422  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.344989776611328  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10626840591430664  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.38855266571045  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10666179656982422  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.94950771331787  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10682487487792969  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.15974235534668  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1064457893371582  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.750245094299316  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10655927658081055  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.15469455718994  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10684728622436523  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.290896892547607  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10693025588989258  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.926450729370117  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10697507858276367  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.030341148376465  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1066746711730957  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.785831451416016  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10665607452392578  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.82292366027832  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10653066635131836  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.080912590026855  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10660123825073242  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.107801914215088  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10637569427490234  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.62216567993164  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10647439956665039  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.78422212600708  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10683774948120117  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.90255880355835  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10634374618530273  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.688820838928223  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035579338669776917 |0.020502641797065735 |0.5560709983110428 |9.556114673614502e-05 |1.0610408931970596 |0.008086919784545898 |
----------------------------------------------------------pseudo_mini_loss sum 1.319388747215271
Total (block generation + training)time/epoch 113.31718896329403
Training time/epoch 53.61054229736328
Training time without block to device /epoch 52.95445775985718
Training time without total dataloading part /epoch 51.75872540473938
load block tensor time/epoch 1.1385388374328613
block to device time/epoch 0.6560845375061035
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  9114930
Number of first layer input nodes during this epoch:  4764042
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1259288787841797  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0270538330078125
range selection method range initialization spend 0.013630390167236328
time for parepare:  0.020345211029052734
local_output_nid generation:  0.0009579658508300781
local_in_edges_tensor generation:  0.004670381546020508
mini_batch_src_global generation:  0.001650094985961914
r_  generation:  0.010481834411621094
local_output_nid generation:  0.0009779930114746094
local_in_edges_tensor generation:  0.0006725788116455078
mini_batch_src_global generation:  0.0016510486602783203
r_  generation:  0.011020660400390625
local_output_nid generation:  0.0009510517120361328
local_in_edges_tensor generation:  0.0006175041198730469
mini_batch_src_global generation:  0.0011968612670898438
r_  generation:  0.009931802749633789
local_output_nid generation:  0.0009210109710693359
local_in_edges_tensor generation:  0.0005981922149658203
mini_batch_src_global generation:  0.0011992454528808594
r_  generation:  0.010483026504516602
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0005643367767333984
mini_batch_src_global generation:  0.001073598861694336
r_  generation:  0.00960230827331543
local_output_nid generation:  0.0008852481842041016
local_in_edges_tensor generation:  0.0005795955657958984
mini_batch_src_global generation:  0.0010898113250732422
r_  generation:  0.010113239288330078
local_output_nid generation:  0.0009207725524902344
local_in_edges_tensor generation:  0.0006046295166015625
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.010248899459838867
local_output_nid generation:  0.0008971691131591797
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.0011053085327148438
r_  generation:  0.010063409805297852
local_output_nid generation:  0.0008814334869384766
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0011034011840820312
r_  generation:  0.01027822494506836
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005891323089599609
mini_batch_src_global generation:  0.0011892318725585938
r_  generation:  0.01058197021484375
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.0011255741119384766
r_  generation:  0.01042628288269043
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.0013012886047363281
r_  generation:  0.010878562927246094
local_output_nid generation:  0.0008766651153564453
local_in_edges_tensor generation:  0.0005714893341064453
mini_batch_src_global generation:  0.00385284423828125
r_  generation:  0.010640621185302734
local_output_nid generation:  0.0009777545928955078
local_in_edges_tensor generation:  0.0006973743438720703
mini_batch_src_global generation:  0.0011703968048095703
r_  generation:  0.01001739501953125
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0007054805755615234
mini_batch_src_global generation:  0.001226186752319336
r_  generation:  0.01020503044128418
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0010943412780761719
r_  generation:  0.01015615463256836
local_output_nid generation:  0.0008685588836669922
local_in_edges_tensor generation:  0.0006246566772460938
mini_batch_src_global generation:  0.0011248588562011719
r_  generation:  0.01034688949584961
local_output_nid generation:  0.0008494853973388672
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.010196447372436523
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0006105899810791016
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.01021575927734375
local_output_nid generation:  0.003245830535888672
local_in_edges_tensor generation:  0.0007131099700927734
mini_batch_src_global generation:  0.001201629638671875
r_  generation:  0.01058197021484375
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.0006635189056396484
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.010314702987670898
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0006685256958007812
mini_batch_src_global generation:  0.001222372055053711
r_  generation:  0.010626554489135742
local_output_nid generation:  0.0008761882781982422
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.001150369644165039
r_  generation:  0.010331153869628906
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0005621910095214844
mini_batch_src_global generation:  0.0011467933654785156
r_  generation:  0.010410785675048828
local_output_nid generation:  0.0008587837219238281
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0011267662048339844
r_  generation:  0.010180234909057617
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.013045549392700195
local_output_nid generation:  0.0009937286376953125
local_in_edges_tensor generation:  0.0006101131439208984
mini_batch_src_global generation:  0.001239776611328125
r_  generation:  0.01110982894897461
local_output_nid generation:  0.0008842945098876953
local_in_edges_tensor generation:  0.00074005126953125
mini_batch_src_global generation:  0.0012161731719970703
r_  generation:  0.011143922805786133
local_output_nid generation:  0.0008795261383056641
local_in_edges_tensor generation:  0.0007066726684570312
mini_batch_src_global generation:  0.0013332366943359375
r_  generation:  0.010877370834350586
local_output_nid generation:  0.0008831024169921875
local_in_edges_tensor generation:  0.0006794929504394531
mini_batch_src_global generation:  0.0011577606201171875
r_  generation:  0.010154962539672852
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0006260871887207031
mini_batch_src_global generation:  0.0011734962463378906
r_  generation:  0.01022648811340332
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0005838871002197266
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.01025533676147461
----------------------check_connections_block total spend ----------------------------- 0.5351607799530029
generate_one_block  0.03301572799682617
generate_one_block  0.020947933197021484
generate_one_block  0.01935100555419922
generate_one_block  0.01990962028503418
generate_one_block  0.020433664321899414
generate_one_block  0.01862955093383789
generate_one_block  0.019112348556518555
generate_one_block  0.018212080001831055
generate_one_block  0.019003868103027344
generate_one_block  0.01927804946899414
generate_one_block  0.0215604305267334
generate_one_block  0.022015810012817383
generate_one_block  0.018934011459350586
generate_one_block  0.01790022850036621
generate_one_block  0.0186312198638916
generate_one_block  0.020537614822387695
generate_one_block  0.018841981887817383
generate_one_block  0.018315792083740234
generate_one_block  0.01836371421813965
generate_one_block  0.01847052574157715
generate_one_block  0.01857280731201172
generate_one_block  0.02174520492553711
generate_one_block  0.01838994026184082
generate_one_block  0.01848602294921875
generate_one_block  0.018182992935180664
generate_one_block  0.018399953842163086
generate_one_block  0.02054429054260254
generate_one_block  0.019908905029296875
generate_one_block  0.01898813247680664
generate_one_block  0.018064022064208984
generate_one_block  0.018165111541748047
generate_one_block  0.01820683479309082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05037975311279297
gen group dst list time:  0.02329277992248535
time for parepare:  0.0240323543548584
local_output_nid generation:  0.0058023929595947266
local_in_edges_tensor generation:  0.01731586456298828
mini_batch_src_global generation:  0.01893138885498047
r_  generation:  0.17414546012878418
local_output_nid generation:  0.00944375991821289
local_in_edges_tensor generation:  0.011098623275756836
mini_batch_src_global generation:  0.022480249404907227
r_  generation:  0.17095565795898438
local_output_nid generation:  0.008161544799804688
local_in_edges_tensor generation:  0.041957855224609375
mini_batch_src_global generation:  0.021930217742919922
r_  generation:  0.17699861526489258
local_output_nid generation:  0.008460760116577148
local_in_edges_tensor generation:  0.01190495491027832
mini_batch_src_global generation:  0.023799419403076172
r_  generation:  0.18466401100158691
local_output_nid generation:  0.008493661880493164
local_in_edges_tensor generation:  0.010874748229980469
mini_batch_src_global generation:  0.022855281829833984
r_  generation:  0.1739335060119629
local_output_nid generation:  0.008603096008300781
local_in_edges_tensor generation:  0.008727312088012695
mini_batch_src_global generation:  0.022452354431152344
r_  generation:  0.17670917510986328
local_output_nid generation:  0.009136438369750977
local_in_edges_tensor generation:  0.012015342712402344
mini_batch_src_global generation:  0.02372431755065918
r_  generation:  0.1882474422454834
local_output_nid generation:  0.008530139923095703
local_in_edges_tensor generation:  0.008534669876098633
mini_batch_src_global generation:  0.02318263053894043
r_  generation:  0.1786952018737793
local_output_nid generation:  0.008607625961303711
local_in_edges_tensor generation:  0.011898994445800781
mini_batch_src_global generation:  0.0240786075592041
r_  generation:  0.18547439575195312
local_output_nid generation:  0.009054899215698242
local_in_edges_tensor generation:  0.009207725524902344
mini_batch_src_global generation:  0.026311635971069336
r_  generation:  0.18831944465637207
local_output_nid generation:  0.008940696716308594
local_in_edges_tensor generation:  0.009013891220092773
mini_batch_src_global generation:  0.024471282958984375
r_  generation:  0.18661117553710938
local_output_nid generation:  0.009595394134521484
local_in_edges_tensor generation:  0.012439727783203125
mini_batch_src_global generation:  0.02571582794189453
r_  generation:  0.19402813911437988
local_output_nid generation:  0.009151935577392578
local_in_edges_tensor generation:  0.00946497917175293
mini_batch_src_global generation:  0.025623798370361328
r_  generation:  0.1836867332458496
local_output_nid generation:  0.008962631225585938
local_in_edges_tensor generation:  0.010231733322143555
mini_batch_src_global generation:  0.023308277130126953
r_  generation:  0.181610107421875
local_output_nid generation:  0.009166717529296875
local_in_edges_tensor generation:  0.011263370513916016
mini_batch_src_global generation:  0.024458885192871094
r_  generation:  0.1869204044342041
local_output_nid generation:  0.00918126106262207
local_in_edges_tensor generation:  0.009816646575927734
mini_batch_src_global generation:  0.02343463897705078
r_  generation:  0.17850685119628906
local_output_nid generation:  0.00924539566040039
local_in_edges_tensor generation:  0.009073495864868164
mini_batch_src_global generation:  0.02294445037841797
r_  generation:  0.18220138549804688
local_output_nid generation:  0.009257793426513672
local_in_edges_tensor generation:  0.010546445846557617
mini_batch_src_global generation:  0.023655176162719727
r_  generation:  0.18111157417297363
local_output_nid generation:  0.009293079376220703
local_in_edges_tensor generation:  0.009205818176269531
mini_batch_src_global generation:  0.022838592529296875
r_  generation:  0.18422913551330566
local_output_nid generation:  0.009211540222167969
local_in_edges_tensor generation:  0.012198209762573242
mini_batch_src_global generation:  0.024912357330322266
r_  generation:  0.18642139434814453
local_output_nid generation:  0.009383678436279297
local_in_edges_tensor generation:  0.00927424430847168
mini_batch_src_global generation:  0.023050785064697266
r_  generation:  0.1881556510925293
local_output_nid generation:  0.009660959243774414
local_in_edges_tensor generation:  0.011500835418701172
mini_batch_src_global generation:  0.026107072830200195
r_  generation:  0.19028139114379883
local_output_nid generation:  0.010083675384521484
local_in_edges_tensor generation:  0.009509563446044922
mini_batch_src_global generation:  0.024201154708862305
r_  generation:  0.18506479263305664
local_output_nid generation:  0.009222269058227539
local_in_edges_tensor generation:  0.00875234603881836
mini_batch_src_global generation:  0.023474454879760742
r_  generation:  0.18506789207458496
local_output_nid generation:  0.009321451187133789
local_in_edges_tensor generation:  0.010027647018432617
mini_batch_src_global generation:  0.023012638092041016
r_  generation:  0.18488788604736328
local_output_nid generation:  0.009966373443603516
local_in_edges_tensor generation:  0.010728836059570312
mini_batch_src_global generation:  0.02469468116760254
r_  generation:  0.18489646911621094
local_output_nid generation:  0.009691953659057617
local_in_edges_tensor generation:  0.01000666618347168
mini_batch_src_global generation:  0.024123668670654297
r_  generation:  0.1922297477722168
local_output_nid generation:  0.009904861450195312
local_in_edges_tensor generation:  0.01587224006652832
mini_batch_src_global generation:  0.02638840675354004
r_  generation:  0.19637322425842285
local_output_nid generation:  0.00968480110168457
local_in_edges_tensor generation:  0.010773420333862305
mini_batch_src_global generation:  0.024454355239868164
r_  generation:  0.1929473876953125
local_output_nid generation:  0.009102821350097656
local_in_edges_tensor generation:  0.008980751037597656
mini_batch_src_global generation:  0.02364206314086914
r_  generation:  0.1824789047241211
local_output_nid generation:  0.009331703186035156
local_in_edges_tensor generation:  0.010344743728637695
mini_batch_src_global generation:  0.023279190063476562
r_  generation:  0.18648290634155273
local_output_nid generation:  0.00941014289855957
local_in_edges_tensor generation:  0.008991479873657227
mini_batch_src_global generation:  0.023977279663085938
r_  generation:  0.1947040557861328
----------------------check_connections_block total spend ----------------------------- 8.705680847167969
generate_one_block  0.26105332374572754
generate_one_block  0.24103975296020508
generate_one_block  0.24358367919921875
generate_one_block  0.25772523880004883
generate_one_block  0.25363779067993164
generate_one_block  0.2390761375427246
generate_one_block  0.2526054382324219
generate_one_block  0.23859930038452148
generate_one_block  0.24826335906982422
generate_one_block  0.2562999725341797
generate_one_block  0.24599528312683105
generate_one_block  0.26231861114501953
generate_one_block  0.2444138526916504
generate_one_block  0.24384522438049316
generate_one_block  0.2493429183959961
generate_one_block  0.23932695388793945
generate_one_block  0.2486734390258789
generate_one_block  0.24581408500671387
generate_one_block  0.24241352081298828
generate_one_block  0.25412917137145996
generate_one_block  0.24664831161499023
generate_one_block  0.257159948348999
generate_one_block  0.24448060989379883
generate_one_block  0.24652719497680664
generate_one_block  0.2442467212677002
generate_one_block  0.2479417324066162
generate_one_block  0.2578599452972412
generate_one_block  0.26620006561279297
generate_one_block  0.26045918464660645
generate_one_block  0.24254941940307617
generate_one_block  0.24816179275512695
generate_one_block  0.24596810340881348
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.050276994705200195
gen group dst list time:  0.1136476993560791
time for parepare:  0.019214153289794922
local_output_nid generation:  0.025283098220825195
local_in_edges_tensor generation:  0.05341696739196777
mini_batch_src_global generation:  0.041083335876464844
r_  generation:  0.43202900886535645
local_output_nid generation:  0.030613183975219727
local_in_edges_tensor generation:  0.03867053985595703
mini_batch_src_global generation:  0.05106329917907715
r_  generation:  0.4276280403137207
local_output_nid generation:  0.03088998794555664
local_in_edges_tensor generation:  0.03102850914001465
mini_batch_src_global generation:  0.04994559288024902
r_  generation:  0.4387984275817871
local_output_nid generation:  0.03085637092590332
local_in_edges_tensor generation:  0.03204679489135742
mini_batch_src_global generation:  0.0504450798034668
r_  generation:  0.43457794189453125
local_output_nid generation:  0.03066396713256836
local_in_edges_tensor generation:  0.029444217681884766
mini_batch_src_global generation:  0.052724599838256836
r_  generation:  0.44391465187072754
local_output_nid generation:  0.030919790267944336
local_in_edges_tensor generation:  0.02953624725341797
mini_batch_src_global generation:  0.051363229751586914
r_  generation:  0.4389770030975342
local_output_nid generation:  0.03212785720825195
local_in_edges_tensor generation:  0.030393123626708984
mini_batch_src_global generation:  0.0546727180480957
r_  generation:  0.4453544616699219
local_output_nid generation:  0.029144763946533203
local_in_edges_tensor generation:  0.028395652770996094
mini_batch_src_global generation:  0.0520024299621582
r_  generation:  0.4361996650695801
local_output_nid generation:  0.0305783748626709
local_in_edges_tensor generation:  0.03308296203613281
mini_batch_src_global generation:  0.05125260353088379
r_  generation:  0.4432814121246338
local_output_nid generation:  0.02978038787841797
local_in_edges_tensor generation:  0.029980182647705078
mini_batch_src_global generation:  0.053888797760009766
r_  generation:  0.4386930465698242
local_output_nid generation:  0.0290982723236084
local_in_edges_tensor generation:  0.029595375061035156
mini_batch_src_global generation:  0.05104947090148926
r_  generation:  0.44095563888549805
local_output_nid generation:  0.036054134368896484
local_in_edges_tensor generation:  0.03443193435668945
mini_batch_src_global generation:  0.06317687034606934
r_  generation:  0.4444437026977539
local_output_nid generation:  0.03077840805053711
local_in_edges_tensor generation:  0.03156924247741699
mini_batch_src_global generation:  0.05140995979309082
r_  generation:  0.43830251693725586
local_output_nid generation:  0.03020620346069336
local_in_edges_tensor generation:  0.02809309959411621
mini_batch_src_global generation:  0.0520024299621582
r_  generation:  0.43291282653808594
local_output_nid generation:  0.030300378799438477
local_in_edges_tensor generation:  0.029989004135131836
mini_batch_src_global generation:  0.05093240737915039
r_  generation:  0.43833160400390625
local_output_nid generation:  0.03038334846496582
local_in_edges_tensor generation:  0.029807329177856445
mini_batch_src_global generation:  0.05136227607727051
r_  generation:  0.4335060119628906
local_output_nid generation:  0.030188798904418945
local_in_edges_tensor generation:  0.029740333557128906
mini_batch_src_global generation:  0.05073261260986328
r_  generation:  0.43552398681640625
local_output_nid generation:  0.030451059341430664
local_in_edges_tensor generation:  0.029995203018188477
mini_batch_src_global generation:  0.05134749412536621
r_  generation:  0.43476104736328125
local_output_nid generation:  0.030405282974243164
local_in_edges_tensor generation:  0.029671907424926758
mini_batch_src_global generation:  0.050750017166137695
r_  generation:  0.43906712532043457
local_output_nid generation:  0.03036189079284668
local_in_edges_tensor generation:  0.03011322021484375
mini_batch_src_global generation:  0.051921844482421875
r_  generation:  0.45714449882507324
local_output_nid generation:  0.030062198638916016
local_in_edges_tensor generation:  0.029588699340820312
mini_batch_src_global generation:  0.05028223991394043
r_  generation:  0.4413583278656006
local_output_nid generation:  0.030742406845092773
local_in_edges_tensor generation:  0.0295102596282959
mini_batch_src_global generation:  0.051677703857421875
r_  generation:  0.4384138584136963
local_output_nid generation:  0.030179500579833984
local_in_edges_tensor generation:  0.029372453689575195
mini_batch_src_global generation:  0.05043935775756836
r_  generation:  0.4383516311645508
local_output_nid generation:  0.030234813690185547
local_in_edges_tensor generation:  0.029114484786987305
mini_batch_src_global generation:  0.05163002014160156
r_  generation:  0.4382789134979248
local_output_nid generation:  0.030344247817993164
local_in_edges_tensor generation:  0.0341799259185791
mini_batch_src_global generation:  0.05088639259338379
r_  generation:  0.44063305854797363
local_output_nid generation:  0.03010416030883789
local_in_edges_tensor generation:  0.02949070930480957
mini_batch_src_global generation:  0.05064129829406738
r_  generation:  0.43839502334594727
local_output_nid generation:  0.030505895614624023
local_in_edges_tensor generation:  0.03924822807312012
mini_batch_src_global generation:  0.052863359451293945
r_  generation:  0.44114184379577637
local_output_nid generation:  0.03094196319580078
local_in_edges_tensor generation:  0.03092646598815918
mini_batch_src_global generation:  0.05419135093688965
r_  generation:  0.44411563873291016
local_output_nid generation:  0.03102874755859375
local_in_edges_tensor generation:  0.029047012329101562
mini_batch_src_global generation:  0.05130124092102051
r_  generation:  0.4454793930053711
local_output_nid generation:  0.030412673950195312
local_in_edges_tensor generation:  0.03017735481262207
mini_batch_src_global generation:  0.051557064056396484
r_  generation:  0.4386899471282959
local_output_nid generation:  0.030251502990722656
local_in_edges_tensor generation:  0.02826094627380371
mini_batch_src_global generation:  0.05308055877685547
r_  generation:  0.4403965473175049
local_output_nid generation:  0.03093719482421875
local_in_edges_tensor generation:  0.028194665908813477
mini_batch_src_global generation:  0.05206012725830078
r_  generation:  0.4402754306793213
----------------------check_connections_block total spend ----------------------------- 20.870156049728394
generate_one_block  0.6039297580718994
generate_one_block  0.5846045017242432
generate_one_block  0.5911908149719238
generate_one_block  0.5927891731262207
generate_one_block  0.6861298084259033
generate_one_block  0.5846757888793945
generate_one_block  0.5988085269927979
generate_one_block  0.5798635482788086
generate_one_block  0.5875577926635742
generate_one_block  0.5974068641662598
generate_one_block  0.5847759246826172
generate_one_block  0.5957415103912354
generate_one_block  0.5898809432983398
generate_one_block  0.583085298538208
generate_one_block  0.5904836654663086
generate_one_block  0.5883285999298096
generate_one_block  0.5848326683044434
generate_one_block  0.6017007827758789
generate_one_block  0.5858654975891113
generate_one_block  0.5892257690429688
generate_one_block  0.5836513042449951
generate_one_block  0.6011946201324463
generate_one_block  0.5859560966491699
generate_one_block  0.5825574398040771
generate_one_block  0.5977067947387695
generate_one_block  0.5785677433013916
generate_one_block  0.605154275894165
generate_one_block  0.6043531894683838
generate_one_block  0.5952601432800293
generate_one_block  0.5877506732940674
generate_one_block  0.5832180976867676
generate_one_block  0.5906245708465576
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1259288787841797  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

connection checking time:  29.575836896896362
block generation total time  26.97323226928711
average batch blocks generation time:  0.8429135084152222
block dataloader generation time/epoch 59.67965465433457
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10635709762573242  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.775184631347656  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1062312126159668  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.605732917785645  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1065053939819336  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.874692916870117  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10678529739379883  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.27105712890625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1063385009765625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.384882926940918  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10643386840820312  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.6336989402771  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1069040298461914  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.22231912612915  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10615825653076172  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.56252670288086  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.106903076171875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.033714294433594  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10683584213256836  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.201775550842285  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10647726058959961  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.87395715713501  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10723400115966797  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.54845905303955  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10661792755126953  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.863175868988037  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10625982284545898  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.73810577392578  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10668134689331055  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.00025749206543  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10668563842773438  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.614660263061523  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10647964477539062  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.780546188354492  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1065974235534668  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.833221435546875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10666322708129883  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.757461547851562  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10663366317749023  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.903289794921875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10657215118408203  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.803246021270752  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1068572998046875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.25520086288452  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10611534118652344  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.729802131652832  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10642576217651367  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.75940752029419  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10638713836669922  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.711366653442383  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10638284683227539  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.704821586608887  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10656261444091797  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.195297241210938  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10722541809082031  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.602445125579834  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10679340362548828  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.303909301757812  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10647869110107422  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.66978931427002  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10656070709228516  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.83488655090332  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1066274642944336  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.808672428131104  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03577408194541931 |0.0204731747508049 |0.5585709437727928 |9.58070158958435e-05 |1.064641296863556 |0.008859872817993164 |
----------------------------------------------------------pseudo_mini_loss sum 1.2834208011627197
Total (block generation + training)time/epoch 113.3441670922672
Training time/epoch 53.80796670913696
Training time without block to device /epoch 53.152825117111206
Training time without total dataloading part /epoch 51.95471739768982
load block tensor time/epoch 1.144770622253418
block to device time/epoch 0.6551415920257568
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  9109729
Number of first layer input nodes during this epoch:  4761277
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.12662601470947266  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024738550186157227
range selection method range initialization spend 0.013974189758300781
time for parepare:  0.01865863800048828
local_output_nid generation:  0.0009794235229492188
local_in_edges_tensor generation:  0.004072904586791992
mini_batch_src_global generation:  0.0016744136810302734
r_  generation:  0.010820150375366211
local_output_nid generation:  0.0010056495666503906
local_in_edges_tensor generation:  0.0006837844848632812
mini_batch_src_global generation:  0.0014977455139160156
r_  generation:  0.010863780975341797
local_output_nid generation:  0.0009467601776123047
local_in_edges_tensor generation:  0.0006315708160400391
mini_batch_src_global generation:  0.001194000244140625
r_  generation:  0.010378837585449219
local_output_nid generation:  0.0009341239929199219
local_in_edges_tensor generation:  0.0005950927734375
mini_batch_src_global generation:  0.0011205673217773438
r_  generation:  0.009959220886230469
local_output_nid generation:  0.0009038448333740234
local_in_edges_tensor generation:  0.000614166259765625
mini_batch_src_global generation:  0.001178741455078125
r_  generation:  0.01024174690246582
local_output_nid generation:  0.0008945465087890625
local_in_edges_tensor generation:  0.0005939006805419922
mini_batch_src_global generation:  0.0011799335479736328
r_  generation:  0.009903669357299805
local_output_nid generation:  0.0009107589721679688
local_in_edges_tensor generation:  0.0005831718444824219
mini_batch_src_global generation:  0.0010838508605957031
r_  generation:  0.00988149642944336
local_output_nid generation:  0.0009665489196777344
local_in_edges_tensor generation:  0.0006008148193359375
mini_batch_src_global generation:  0.001071929931640625
r_  generation:  0.009787797927856445
local_output_nid generation:  0.000926971435546875
local_in_edges_tensor generation:  0.0005826950073242188
mini_batch_src_global generation:  0.0011181831359863281
r_  generation:  0.00993967056274414
local_output_nid generation:  0.0008857250213623047
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.001096963882446289
r_  generation:  0.010171175003051758
local_output_nid generation:  0.0008852481842041016
local_in_edges_tensor generation:  0.0005908012390136719
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.010248899459838867
local_output_nid generation:  0.0009317398071289062
local_in_edges_tensor generation:  0.0005950927734375
mini_batch_src_global generation:  0.0011014938354492188
r_  generation:  0.009917974472045898
local_output_nid generation:  0.0008785724639892578
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.0011734962463378906
r_  generation:  0.01003408432006836
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0005905628204345703
mini_batch_src_global generation:  0.0012309551239013672
r_  generation:  0.01041722297668457
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.0005850791931152344
mini_batch_src_global generation:  0.0011665821075439453
r_  generation:  0.010479211807250977
local_output_nid generation:  0.0008845329284667969
local_in_edges_tensor generation:  0.0005853176116943359
mini_batch_src_global generation:  0.0011322498321533203
r_  generation:  0.01039743423461914
local_output_nid generation:  0.0008795261383056641
local_in_edges_tensor generation:  0.0005743503570556641
mini_batch_src_global generation:  0.001129150390625
r_  generation:  0.010202169418334961
local_output_nid generation:  0.0008854866027832031
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0011713504791259766
r_  generation:  0.010350704193115234
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.0011436939239501953
r_  generation:  0.010101318359375
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.010015249252319336
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.001138925552368164
r_  generation:  0.010138750076293945
local_output_nid generation:  0.0009319782257080078
local_in_edges_tensor generation:  0.0005788803100585938
mini_batch_src_global generation:  0.0012409687042236328
r_  generation:  0.010494232177734375
local_output_nid generation:  0.0008718967437744141
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0012111663818359375
r_  generation:  0.010455846786499023
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0011420249938964844
r_  generation:  0.01015925407409668
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005652904510498047
mini_batch_src_global generation:  0.0012388229370117188
r_  generation:  0.010443449020385742
local_output_nid generation:  0.0008563995361328125
local_in_edges_tensor generation:  0.0005929470062255859
mini_batch_src_global generation:  0.0012226104736328125
r_  generation:  0.010672569274902344
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0005769729614257812
mini_batch_src_global generation:  0.0012519359588623047
r_  generation:  0.010510683059692383
local_output_nid generation:  0.0008790493011474609
local_in_edges_tensor generation:  0.0005700588226318359
mini_batch_src_global generation:  0.0012617111206054688
r_  generation:  0.010594844818115234
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0005755424499511719
mini_batch_src_global generation:  0.0012013912200927734
r_  generation:  0.010409355163574219
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0005767345428466797
mini_batch_src_global generation:  0.0012242794036865234
r_  generation:  0.010260581970214844
local_output_nid generation:  0.0008783340454101562
local_in_edges_tensor generation:  0.0006282329559326172
mini_batch_src_global generation:  0.0012581348419189453
r_  generation:  0.010810136795043945
local_output_nid generation:  0.0008792877197265625
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0011577606201171875
r_  generation:  0.010066032409667969
----------------------check_connections_block total spend ----------------------------- 0.517937421798706
generate_one_block  0.024692296981811523
generate_one_block  0.021112442016601562
generate_one_block  0.019771814346313477
generate_one_block  0.01877737045288086
generate_one_block  0.019182205200195312
generate_one_block  0.018380165100097656
generate_one_block  0.01776266098022461
generate_one_block  0.01763439178466797
generate_one_block  0.018228769302368164
generate_one_block  0.018387556076049805
generate_one_block  0.0184786319732666
generate_one_block  0.020253419876098633
generate_one_block  0.019060134887695312
generate_one_block  0.01901984214782715
generate_one_block  0.019034862518310547
generate_one_block  0.018622875213623047
generate_one_block  0.018232345581054688
generate_one_block  0.018759489059448242
generate_one_block  0.018080472946166992
generate_one_block  0.018005847930908203
generate_one_block  0.0183413028717041
generate_one_block  0.01890850067138672
generate_one_block  0.01868915557861328
generate_one_block  0.018268823623657227
generate_one_block  0.01890873908996582
generate_one_block  0.019082307815551758
generate_one_block  0.018964052200317383
generate_one_block  0.018868446350097656
generate_one_block  0.018781185150146484
generate_one_block  0.01836371421813965
generate_one_block  0.019489526748657227
generate_one_block  0.01838850975036621
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03974294662475586
gen group dst list time:  0.02293992042541504
time for parepare:  0.022143840789794922
local_output_nid generation:  0.005553722381591797
local_in_edges_tensor generation:  0.015627384185791016
mini_batch_src_global generation:  0.018279552459716797
r_  generation:  0.16113519668579102
local_output_nid generation:  0.007838964462280273
local_in_edges_tensor generation:  0.011425971984863281
mini_batch_src_global generation:  0.022983074188232422
r_  generation:  0.17062878608703613
local_output_nid generation:  0.007941484451293945
local_in_edges_tensor generation:  0.03544282913208008
mini_batch_src_global generation:  0.025887250900268555
r_  generation:  0.18238329887390137
local_output_nid generation:  0.008088827133178711
local_in_edges_tensor generation:  0.010777473449707031
mini_batch_src_global generation:  0.022234201431274414
r_  generation:  0.1771540641784668
local_output_nid generation:  0.008800268173217773
local_in_edges_tensor generation:  0.010014772415161133
mini_batch_src_global generation:  0.023775815963745117
r_  generation:  0.18544340133666992
local_output_nid generation:  0.008746147155761719
local_in_edges_tensor generation:  0.008968591690063477
mini_batch_src_global generation:  0.022786378860473633
r_  generation:  0.17799663543701172
local_output_nid generation:  0.008641719818115234
local_in_edges_tensor generation:  0.008534431457519531
mini_batch_src_global generation:  0.023431062698364258
r_  generation:  0.1773207187652588
local_output_nid generation:  0.008407354354858398
local_in_edges_tensor generation:  0.011231184005737305
mini_batch_src_global generation:  0.022113800048828125
r_  generation:  0.17336320877075195
local_output_nid generation:  0.008350849151611328
local_in_edges_tensor generation:  0.008810281753540039
mini_batch_src_global generation:  0.023722410202026367
r_  generation:  0.18119168281555176
local_output_nid generation:  0.008880615234375
local_in_edges_tensor generation:  0.010331392288208008
mini_batch_src_global generation:  0.022876501083374023
r_  generation:  0.18118739128112793
local_output_nid generation:  0.008907556533813477
local_in_edges_tensor generation:  0.009704828262329102
mini_batch_src_global generation:  0.025869369506835938
r_  generation:  0.18474793434143066
local_output_nid generation:  0.008893966674804688
local_in_edges_tensor generation:  0.009046316146850586
mini_batch_src_global generation:  0.023439884185791016
r_  generation:  0.17948174476623535
local_output_nid generation:  0.009062767028808594
local_in_edges_tensor generation:  0.008915901184082031
mini_batch_src_global generation:  0.02336287498474121
r_  generation:  0.18167829513549805
local_output_nid generation:  0.00918126106262207
local_in_edges_tensor generation:  0.009253501892089844
mini_batch_src_global generation:  0.023740530014038086
r_  generation:  0.18591666221618652
local_output_nid generation:  0.00929570198059082
local_in_edges_tensor generation:  0.00923776626586914
mini_batch_src_global generation:  0.024245738983154297
r_  generation:  0.18960261344909668
local_output_nid generation:  0.009244203567504883
local_in_edges_tensor generation:  0.009322881698608398
mini_batch_src_global generation:  0.023960590362548828
r_  generation:  0.18527531623840332
local_output_nid generation:  0.009035587310791016
local_in_edges_tensor generation:  0.009432315826416016
mini_batch_src_global generation:  0.023479223251342773
r_  generation:  0.18246984481811523
local_output_nid generation:  0.009315252304077148
local_in_edges_tensor generation:  0.009460210800170898
mini_batch_src_global generation:  0.02369236946105957
r_  generation:  0.18628835678100586
local_output_nid generation:  0.009100198745727539
local_in_edges_tensor generation:  0.008930683135986328
mini_batch_src_global generation:  0.023143768310546875
r_  generation:  0.18152379989624023
local_output_nid generation:  0.00910186767578125
local_in_edges_tensor generation:  0.008846759796142578
mini_batch_src_global generation:  0.023042678833007812
r_  generation:  0.18100833892822266
local_output_nid generation:  0.009261608123779297
local_in_edges_tensor generation:  0.008993387222290039
mini_batch_src_global generation:  0.023101329803466797
r_  generation:  0.18091249465942383
local_output_nid generation:  0.009499073028564453
local_in_edges_tensor generation:  0.01162266731262207
mini_batch_src_global generation:  0.025412321090698242
r_  generation:  0.1903996467590332
local_output_nid generation:  0.009369850158691406
local_in_edges_tensor generation:  0.009451150894165039
mini_batch_src_global generation:  0.023967981338500977
r_  generation:  0.188859224319458
local_output_nid generation:  0.009198665618896484
local_in_edges_tensor generation:  0.00911092758178711
mini_batch_src_global generation:  0.023293733596801758
r_  generation:  0.1816415786743164
local_output_nid generation:  0.009502410888671875
local_in_edges_tensor generation:  0.009198904037475586
mini_batch_src_global generation:  0.02397775650024414
r_  generation:  0.18966031074523926
local_output_nid generation:  0.00954747200012207
local_in_edges_tensor generation:  0.00928497314453125
mini_batch_src_global generation:  0.023743867874145508
r_  generation:  0.18783354759216309
local_output_nid generation:  0.009430408477783203
local_in_edges_tensor generation:  0.01001286506652832
mini_batch_src_global generation:  0.02384495735168457
r_  generation:  0.188812255859375
local_output_nid generation:  0.009606361389160156
local_in_edges_tensor generation:  0.009848356246948242
mini_batch_src_global generation:  0.024130582809448242
r_  generation:  0.18816924095153809
local_output_nid generation:  0.009437322616577148
local_in_edges_tensor generation:  0.010223150253295898
mini_batch_src_global generation:  0.024260282516479492
r_  generation:  0.19286251068115234
local_output_nid generation:  0.009328842163085938
local_in_edges_tensor generation:  0.009755373001098633
mini_batch_src_global generation:  0.023400545120239258
r_  generation:  0.18165993690490723
local_output_nid generation:  0.009655237197875977
local_in_edges_tensor generation:  0.010375738143920898
mini_batch_src_global generation:  0.025290966033935547
r_  generation:  0.19329094886779785
local_output_nid generation:  0.00920248031616211
local_in_edges_tensor generation:  0.008980274200439453
mini_batch_src_global generation:  0.023357391357421875
r_  generation:  0.18175578117370605
----------------------check_connections_block total spend ----------------------------- 8.583820104598999
generate_one_block  0.2455592155456543
generate_one_block  0.2519688606262207
generate_one_block  0.25504040718078613
generate_one_block  0.24489855766296387
generate_one_block  0.2693488597869873
generate_one_block  0.24260282516479492
generate_one_block  0.24001216888427734
generate_one_block  0.2336902618408203
generate_one_block  0.24724411964416504
generate_one_block  0.24840211868286133
generate_one_block  0.2505984306335449
generate_one_block  0.24344992637634277
generate_one_block  0.24615263938903809
generate_one_block  0.2525215148925781
generate_one_block  0.25371718406677246
generate_one_block  0.24804401397705078
generate_one_block  0.24125885963439941
generate_one_block  0.249830961227417
generate_one_block  0.24141335487365723
generate_one_block  0.24582624435424805
generate_one_block  0.24447941780090332
generate_one_block  0.2601280212402344
generate_one_block  0.2517201900482178
generate_one_block  0.24252748489379883
generate_one_block  0.2542381286621094
generate_one_block  0.25379371643066406
generate_one_block  0.2525160312652588
generate_one_block  0.25399231910705566
generate_one_block  0.2573244571685791
generate_one_block  0.2446146011352539
generate_one_block  0.2628052234649658
generate_one_block  0.240736722946167
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03339695930480957
gen group dst list time:  0.10644769668579102
time for parepare:  0.019514083862304688
local_output_nid generation:  0.024821996688842773
local_in_edges_tensor generation:  0.0393824577331543
mini_batch_src_global generation:  0.03995347023010254
r_  generation:  0.41996002197265625
local_output_nid generation:  0.03022933006286621
local_in_edges_tensor generation:  0.034071922302246094
mini_batch_src_global generation:  0.05057859420776367
r_  generation:  0.42599964141845703
local_output_nid generation:  0.03027963638305664
local_in_edges_tensor generation:  0.029396533966064453
mini_batch_src_global generation:  0.04896712303161621
r_  generation:  0.4330437183380127
local_output_nid generation:  0.030560016632080078
local_in_edges_tensor generation:  0.027760982513427734
mini_batch_src_global generation:  0.05032706260681152
r_  generation:  0.42688798904418945
local_output_nid generation:  0.03340935707092285
local_in_edges_tensor generation:  0.031052112579345703
mini_batch_src_global generation:  0.0500483512878418
r_  generation:  0.4398841857910156
local_output_nid generation:  0.030513286590576172
local_in_edges_tensor generation:  0.028421640396118164
mini_batch_src_global generation:  0.05138754844665527
r_  generation:  0.43588852882385254
local_output_nid generation:  0.03007197380065918
local_in_edges_tensor generation:  0.026414155960083008
mini_batch_src_global generation:  0.050882577896118164
r_  generation:  0.441356897354126
local_output_nid generation:  0.0291440486907959
local_in_edges_tensor generation:  0.028737783432006836
mini_batch_src_global generation:  0.051149845123291016
r_  generation:  0.433732271194458
local_output_nid generation:  0.029050350189208984
local_in_edges_tensor generation:  0.030312061309814453
mini_batch_src_global generation:  0.04988694190979004
r_  generation:  0.4385244846343994
local_output_nid generation:  0.029178857803344727
local_in_edges_tensor generation:  0.02855086326599121
mini_batch_src_global generation:  0.05169868469238281
r_  generation:  0.43827033042907715
local_output_nid generation:  0.029628276824951172
local_in_edges_tensor generation:  0.028657913208007812
mini_batch_src_global generation:  0.05075359344482422
r_  generation:  0.44350743293762207
local_output_nid generation:  0.02920365333557129
local_in_edges_tensor generation:  0.033293962478637695
mini_batch_src_global generation:  0.051108360290527344
r_  generation:  0.43689942359924316
local_output_nid generation:  0.029409408569335938
local_in_edges_tensor generation:  0.026898860931396484
mini_batch_src_global generation:  0.04984903335571289
r_  generation:  0.4380629062652588
local_output_nid generation:  0.02910470962524414
local_in_edges_tensor generation:  0.030317306518554688
mini_batch_src_global generation:  0.051045894622802734
r_  generation:  0.4339025020599365
local_output_nid generation:  0.029187440872192383
local_in_edges_tensor generation:  0.027332782745361328
mini_batch_src_global generation:  0.050205230712890625
r_  generation:  0.4394681453704834
local_output_nid generation:  0.029683589935302734
local_in_edges_tensor generation:  0.032501935958862305
mini_batch_src_global generation:  0.051848411560058594
r_  generation:  0.4376704692840576
local_output_nid generation:  0.029024362564086914
local_in_edges_tensor generation:  0.028472185134887695
mini_batch_src_global generation:  0.0500791072845459
r_  generation:  0.4337339401245117
local_output_nid generation:  0.03186798095703125
local_in_edges_tensor generation:  0.027610301971435547
mini_batch_src_global generation:  0.053778648376464844
r_  generation:  0.44052982330322266
local_output_nid generation:  0.029512405395507812
local_in_edges_tensor generation:  0.027452945709228516
mini_batch_src_global generation:  0.05043768882751465
r_  generation:  0.43744707107543945
local_output_nid generation:  0.02941155433654785
local_in_edges_tensor generation:  0.02646040916442871
mini_batch_src_global generation:  0.05132412910461426
r_  generation:  0.4334225654602051
local_output_nid generation:  0.029722213745117188
local_in_edges_tensor generation:  0.02704167366027832
mini_batch_src_global generation:  0.052001237869262695
r_  generation:  0.4405083656311035
local_output_nid generation:  0.0296633243560791
local_in_edges_tensor generation:  0.02704763412475586
mini_batch_src_global generation:  0.05198168754577637
r_  generation:  0.43899989128112793
local_output_nid generation:  0.03009819984436035
local_in_edges_tensor generation:  0.02974987030029297
mini_batch_src_global generation:  0.05077242851257324
r_  generation:  0.44370412826538086
local_output_nid generation:  0.02996683120727539
local_in_edges_tensor generation:  0.02728128433227539
mini_batch_src_global generation:  0.051508426666259766
r_  generation:  0.4436049461364746
local_output_nid generation:  0.030066728591918945
local_in_edges_tensor generation:  0.0284121036529541
mini_batch_src_global generation:  0.05256223678588867
r_  generation:  0.445279598236084
local_output_nid generation:  0.029985666275024414
local_in_edges_tensor generation:  0.029302358627319336
mini_batch_src_global generation:  0.05222368240356445
r_  generation:  0.4416325092315674
local_output_nid generation:  0.02960491180419922
local_in_edges_tensor generation:  0.028591394424438477
mini_batch_src_global generation:  0.05253124237060547
r_  generation:  0.43987011909484863
local_output_nid generation:  0.029933452606201172
local_in_edges_tensor generation:  0.027536392211914062
mini_batch_src_global generation:  0.05166053771972656
r_  generation:  0.4423537254333496
local_output_nid generation:  0.029959917068481445
local_in_edges_tensor generation:  0.029799461364746094
mini_batch_src_global generation:  0.05040097236633301
r_  generation:  0.4404737949371338
local_output_nid generation:  0.0293729305267334
local_in_edges_tensor generation:  0.029750823974609375
mini_batch_src_global generation:  0.05156970024108887
r_  generation:  0.43958449363708496
local_output_nid generation:  0.03024578094482422
local_in_edges_tensor generation:  0.03003096580505371
mini_batch_src_global generation:  0.050478219985961914
r_  generation:  0.4421043395996094
local_output_nid generation:  0.029622316360473633
local_in_edges_tensor generation:  0.032354116439819336
mini_batch_src_global generation:  0.05151844024658203
r_  generation:  0.4368739128112793
----------------------check_connections_block total spend ----------------------------- 20.68391752243042
generate_one_block  0.5912935733795166
generate_one_block  0.5841560363769531
generate_one_block  0.5848450660705566
generate_one_block  0.5836715698242188
generate_one_block  0.683565616607666
generate_one_block  0.5880274772644043
generate_one_block  0.5871012210845947
generate_one_block  0.582146167755127
generate_one_block  0.5864760875701904
generate_one_block  0.5931823253631592
generate_one_block  0.5923113822937012
generate_one_block  0.5822443962097168
generate_one_block  0.5839583873748779
generate_one_block  0.5857710838317871
generate_one_block  0.5821728706359863
generate_one_block  0.5905559062957764
generate_one_block  0.5814659595489502
generate_one_block  0.5875082015991211
generate_one_block  0.585564136505127
generate_one_block  0.5758802890777588
generate_one_block  0.5997314453125
generate_one_block  0.5948781967163086
generate_one_block  0.5960283279418945
generate_one_block  0.5881986618041992
generate_one_block  0.6136350631713867
generate_one_block  0.5922970771789551
generate_one_block  0.5908753871917725
generate_one_block  0.5887753963470459
generate_one_block  0.5941562652587891
generate_one_block  0.5838534832000732
generate_one_block  0.5966489315032959
generate_one_block  0.5849752426147461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.12662601470947266  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

connection checking time:  29.26773762702942
block generation total time  26.906408071517944
average batch blocks generation time:  0.8408252522349358
block dataloader generation time/epoch 59.665732277764214
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10631799697875977  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.54698657989502  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1067647933959961  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.973639488220215  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10665035247802734  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.254006385803223  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10642862319946289  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.79439878463745  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10681962966918945  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.19020986557007  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10666656494140625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.757373332977295  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10630226135253906  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.597092151641846  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10614013671875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.33836793899536  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1066441535949707  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.82141351699829  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.1066584587097168  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.782865047454834  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10666036605834961  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.014137744903564  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10622453689575195  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.585392951965332  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10657691955566406  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.80802011489868  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10666275024414062  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.084219455718994  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10648536682128906  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.100172519683838  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10686397552490234  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.00287103652954  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10612154006958008  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.498417854309082  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10680389404296875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 19.06381320953369  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10667753219604492  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.632080554962158  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10646915435791016  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.514978408813477  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10663890838623047  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 18.73578119277954  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.10688638687133789  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1834716796875 GB
    Memory Allocated: 19.308830738067627  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10671806335449219  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.176356315612793  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10667181015014648  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.819950580596924  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10688066482543945  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.201189517974854  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10697221755981445  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.189109802246094  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.1068882942199707  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.088538646697998  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10687017440795898  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.166306018829346  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10701179504394531  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.257214069366455  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10643815994262695  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.577924251556396  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10709905624389648  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.479072093963623  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10672998428344727  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.74587106704712  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03489790856838226 |0.019410930573940277 |0.5574743375182152 |9.513646364212036e-05 |1.0616739764809608 |0.009596109390258789 |
----------------------------------------------------------pseudo_mini_loss sum 1.2715907096862793
Total (block generation + training)time/epoch 113.32784717612796
Training time/epoch 53.62111854553223
Training time without block to device /epoch 52.99996876716614
Training time without total dataloading part /epoch 51.82538652420044
load block tensor time/epoch 1.1167330741882324
block to device time/epoch 0.6211497783660889
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  9120703
Number of first layer input nodes during this epoch:  4764651
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.12667608261108398  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02720952033996582
range selection method range initialization spend 0.016950607299804688
time for parepare:  0.019492626190185547
local_output_nid generation:  0.0009658336639404297
local_in_edges_tensor generation:  0.007592678070068359
mini_batch_src_global generation:  0.001856088638305664
r_  generation:  0.01081991195678711
local_output_nid generation:  0.0009677410125732422
local_in_edges_tensor generation:  0.0006847381591796875
mini_batch_src_global generation:  0.0014843940734863281
r_  generation:  0.010833024978637695
local_output_nid generation:  0.0009183883666992188
local_in_edges_tensor generation:  0.0005979537963867188
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.009590387344360352
local_output_nid generation:  0.0009169578552246094
local_in_edges_tensor generation:  0.0005791187286376953
mini_batch_src_global generation:  0.0010883808135986328
r_  generation:  0.009497642517089844
local_output_nid generation:  0.0009403228759765625
local_in_edges_tensor generation:  0.0005810260772705078
mini_batch_src_global generation:  0.0010955333709716797
r_  generation:  0.009799957275390625
local_output_nid generation:  0.0009019374847412109
local_in_edges_tensor generation:  0.0005822181701660156
mini_batch_src_global generation:  0.0011136531829833984
r_  generation:  0.010208368301391602
local_output_nid generation:  0.0009012222290039062
local_in_edges_tensor generation:  0.0006132125854492188
mini_batch_src_global generation:  0.0010683536529541016
r_  generation:  0.010105371475219727
local_output_nid generation:  0.0009112358093261719
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0011539459228515625
r_  generation:  0.010047674179077148
local_output_nid generation:  0.0008916854858398438
local_in_edges_tensor generation:  0.0006260871887207031
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.010251045227050781
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0005779266357421875
mini_batch_src_global generation:  0.0011782646179199219
r_  generation:  0.01060175895690918
local_output_nid generation:  0.0009126663208007812
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0011599063873291016
r_  generation:  0.010261058807373047
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.001138448715209961
r_  generation:  0.010337591171264648
local_output_nid generation:  0.0009012222290039062
local_in_edges_tensor generation:  0.00058746337890625
mini_batch_src_global generation:  0.0012173652648925781
r_  generation:  0.01042628288269043
local_output_nid generation:  0.0008649826049804688
local_in_edges_tensor generation:  0.0005862712860107422
mini_batch_src_global generation:  0.0011439323425292969
r_  generation:  0.010559320449829102
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0005753040313720703
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.01029658317565918
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0005958080291748047
mini_batch_src_global generation:  0.0011246204376220703
r_  generation:  0.010274171829223633
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.010334253311157227
local_output_nid generation:  0.0008592605590820312
local_in_edges_tensor generation:  0.0005648136138916016
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.01024627685546875
local_output_nid generation:  0.0008544921875
local_in_edges_tensor generation:  0.0006384849548339844
mini_batch_src_global generation:  0.0013031959533691406
r_  generation:  0.010894060134887695
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0006105899810791016
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.010157346725463867
local_output_nid generation:  0.0008511543273925781
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.0011315345764160156
r_  generation:  0.009998559951782227
local_output_nid generation:  0.0008451938629150391
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.0011677742004394531
r_  generation:  0.010571479797363281
local_output_nid generation:  0.0008509159088134766
local_in_edges_tensor generation:  0.0006253719329833984
mini_batch_src_global generation:  0.0012197494506835938
r_  generation:  0.01069951057434082
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0006361007690429688
mini_batch_src_global generation:  0.0012333393096923828
r_  generation:  0.010741472244262695
local_output_nid generation:  0.0008604526519775391
local_in_edges_tensor generation:  0.0005779266357421875
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.010344266891479492
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005924701690673828
mini_batch_src_global generation:  0.001110076904296875
r_  generation:  0.010051488876342773
local_output_nid generation:  0.0008754730224609375
local_in_edges_tensor generation:  0.0005824565887451172
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.010184526443481445
local_output_nid generation:  0.0008580684661865234
local_in_edges_tensor generation:  0.0006246566772460938
mini_batch_src_global generation:  0.0011305809020996094
r_  generation:  0.010362863540649414
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0005679130554199219
mini_batch_src_global generation:  0.0012197494506835938
r_  generation:  0.010402441024780273
local_output_nid generation:  0.0009024143218994141
local_in_edges_tensor generation:  0.0005648136138916016
mini_batch_src_global generation:  0.0011000633239746094
r_  generation:  0.010180950164794922
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0005958080291748047
mini_batch_src_global generation:  0.0011415481567382812
r_  generation:  0.010498762130737305
local_output_nid generation:  0.0008859634399414062
local_in_edges_tensor generation:  0.0005595684051513672
mini_batch_src_global generation:  0.001127004623413086
r_  generation:  0.010142087936401367
----------------------check_connections_block total spend ----------------------------- 0.5221185684204102
generate_one_block  0.02127861976623535
generate_one_block  0.020963430404663086
generate_one_block  0.018450021743774414
generate_one_block  0.017846345901489258
generate_one_block  0.01832866668701172
generate_one_block  0.018663644790649414
generate_one_block  0.01824188232421875
generate_one_block  0.018425941467285156
generate_one_block  0.018725156784057617
generate_one_block  0.019206762313842773
generate_one_block  0.018426895141601562
generate_one_block  0.020773887634277344
generate_one_block  0.019392728805541992
generate_one_block  0.018954038619995117
generate_one_block  0.018403291702270508
generate_one_block  0.0216522216796875
generate_one_block  0.020426511764526367
generate_one_block  0.018659591674804688
generate_one_block  0.019477128982543945
generate_one_block  0.018146514892578125
generate_one_block  0.018216609954833984
generate_one_block  0.019961833953857422
generate_one_block  0.019281387329101562
generate_one_block  0.019495725631713867
generate_one_block  0.018656492233276367
generate_one_block  0.017865419387817383
generate_one_block  0.020751237869262695
generate_one_block  0.01862359046936035
generate_one_block  0.018708229064941406
generate_one_block  0.018245220184326172
generate_one_block  0.018724918365478516
generate_one_block  0.02031397819519043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03886127471923828
gen group dst list time:  0.02118682861328125
time for parepare:  0.022554636001586914
local_output_nid generation:  0.00583195686340332
local_in_edges_tensor generation:  0.02127242088317871
mini_batch_src_global generation:  0.017501115798950195
r_  generation:  0.16927576065063477
local_output_nid generation:  0.007826805114746094
local_in_edges_tensor generation:  0.01120448112487793
mini_batch_src_global generation:  0.02140974998474121
r_  generation:  0.17170119285583496
local_output_nid generation:  0.007834911346435547
local_in_edges_tensor generation:  0.0368194580078125
mini_batch_src_global generation:  0.029628992080688477
r_  generation:  0.17360639572143555
local_output_nid generation:  0.009041547775268555
local_in_edges_tensor generation:  0.011051654815673828
mini_batch_src_global generation:  0.019781112670898438
r_  generation:  0.1662120819091797
local_output_nid generation:  0.008641481399536133
local_in_edges_tensor generation:  0.008808612823486328
mini_batch_src_global generation:  0.02297234535217285
r_  generation:  0.17626333236694336
local_output_nid generation:  0.009039640426635742
local_in_edges_tensor generation:  0.008620500564575195
mini_batch_src_global generation:  0.022110462188720703
r_  generation:  0.17638587951660156
local_output_nid generation:  0.008818864822387695
local_in_edges_tensor generation:  0.010634183883666992
mini_batch_src_global generation:  0.02201700210571289
r_  generation:  0.17332172393798828
local_output_nid generation:  0.009002447128295898
local_in_edges_tensor generation:  0.00963735580444336
mini_batch_src_global generation:  0.023632526397705078
r_  generation:  0.1795644760131836
local_output_nid generation:  0.008804082870483398
local_in_edges_tensor generation:  0.011037349700927734
mini_batch_src_global generation:  0.024600744247436523
r_  generation:  0.18431591987609863
local_output_nid generation:  0.009328603744506836
local_in_edges_tensor generation:  0.010885953903198242
mini_batch_src_global generation:  0.023322105407714844
r_  generation:  0.18733644485473633
local_output_nid generation:  0.009164810180664062
local_in_edges_tensor generation:  0.00946950912475586
mini_batch_src_global generation:  0.02355051040649414
r_  generation:  0.18384552001953125
local_output_nid generation:  0.009154081344604492
local_in_edges_tensor generation:  0.008826971054077148
mini_batch_src_global generation:  0.023647546768188477
r_  generation:  0.18463802337646484
local_output_nid generation:  0.009434700012207031
local_in_edges_tensor generation:  0.010236978530883789
mini_batch_src_global generation:  0.02366328239440918
r_  generation:  0.18380522727966309
local_output_nid generation:  0.012135028839111328
local_in_edges_tensor generation:  0.009905338287353516
mini_batch_src_global generation:  0.023928165435791016
r_  generation:  0.1886303424835205
local_output_nid generation:  0.009327888488769531
local_in_edges_tensor generation:  0.009168148040771484
mini_batch_src_global generation:  0.0230562686920166
r_  generation:  0.18352055549621582
local_output_nid generation:  0.009367942810058594
local_in_edges_tensor generation:  0.008969545364379883
mini_batch_src_global generation:  0.02284073829650879
r_  generation:  0.18381476402282715
local_output_nid generation:  0.009377479553222656
local_in_edges_tensor generation:  0.01169133186340332
mini_batch_src_global generation:  0.02522420883178711
r_  generation:  0.18553543090820312
local_output_nid generation:  0.009381532669067383
local_in_edges_tensor generation:  0.008834600448608398
mini_batch_src_global generation:  0.022906780242919922
r_  generation:  0.18215370178222656
local_output_nid generation:  0.009940385818481445
local_in_edges_tensor generation:  0.012647867202758789
mini_batch_src_global generation:  0.02585458755493164
r_  generation:  0.1976475715637207
local_output_nid generation:  0.009238243103027344
local_in_edges_tensor generation:  0.009053945541381836
mini_batch_src_global generation:  0.026648759841918945
r_  generation:  0.18023347854614258
local_output_nid generation:  0.009352445602416992
local_in_edges_tensor generation:  0.008865118026733398
mini_batch_src_global generation:  0.022422313690185547
r_  generation:  0.17739462852478027
local_output_nid generation:  0.009492874145507812
local_in_edges_tensor generation:  0.009945869445800781
mini_batch_src_global generation:  0.02373504638671875
r_  generation:  0.18627548217773438
local_output_nid generation:  0.009820699691772461
local_in_edges_tensor generation:  0.010050773620605469
mini_batch_src_global generation:  0.024034500122070312
r_  generation:  0.18839383125305176
local_output_nid generation:  0.009797096252441406
local_in_edges_tensor generation:  0.00916910171508789
mini_batch_src_global generation:  0.0241851806640625
r_  generation:  0.1876819133758545
local_output_nid generation:  0.009661436080932617
local_in_edges_tensor generation:  0.009223461151123047
mini_batch_src_global generation:  0.02341294288635254
r_  generation:  0.18512630462646484
local_output_nid generation:  0.009229898452758789
local_in_edges_tensor generation:  0.008837461471557617
mini_batch_src_global generation:  0.022855281829833984
r_  generation:  0.18126225471496582
local_output_nid generation:  0.009383440017700195
local_in_edges_tensor generation:  0.009803056716918945
mini_batch_src_global generation:  0.023756027221679688
r_  generation:  0.18538832664489746
local_output_nid generation:  0.009492158889770508
local_in_edges_tensor generation:  0.012932300567626953
mini_batch_src_global generation:  0.023531436920166016
r_  generation:  0.1895589828491211
local_output_nid generation:  0.00962376594543457
local_in_edges_tensor generation:  0.009933233261108398
mini_batch_src_global generation:  0.027910470962524414
r_  generation:  0.19478487968444824
local_output_nid generation:  0.009458780288696289
local_in_edges_tensor generation:  0.009218692779541016
mini_batch_src_global generation:  0.02492976188659668
r_  generation:  0.18749403953552246
local_output_nid generation:  0.009635210037231445
local_in_edges_tensor generation:  0.009870290756225586
mini_batch_src_global generation:  0.02326798439025879
r_  generation:  0.18861818313598633
local_output_nid generation:  0.009457111358642578
local_in_edges_tensor generation:  0.010487794876098633
mini_batch_src_global generation:  0.025742769241333008
r_  generation:  0.18590259552001953
----------------------check_connections_block total spend ----------------------------- 8.616651058197021
generate_one_block  0.2651710510253906
generate_one_block  0.25051403045654297
generate_one_block  0.24252796173095703
generate_one_block  0.23456645011901855
generate_one_block  0.2674708366394043
generate_one_block  0.24161911010742188
generate_one_block  0.23755311965942383
generate_one_block  0.24916720390319824
generate_one_block  0.2545630931854248
generate_one_block  0.25121045112609863
generate_one_block  0.2495741844177246
generate_one_block  0.2529749870300293
generate_one_block  0.2542104721069336
generate_one_block  0.2553682327270508
generate_one_block  0.24993515014648438
generate_one_block  0.25272107124328613
generate_one_block  0.2460935115814209
generate_one_block  0.24449706077575684
generate_one_block  0.26448655128479004
generate_one_block  0.24819612503051758
generate_one_block  0.2396705150604248
generate_one_block  0.25423336029052734
generate_one_block  0.2586045265197754
generate_one_block  0.259354829788208
generate_one_block  0.2511613368988037
generate_one_block  0.24221110343933105
generate_one_block  0.26012396812438965
generate_one_block  0.25320863723754883
generate_one_block  0.26139140129089355
generate_one_block  0.2509739398956299
generate_one_block  0.2508993148803711
generate_one_block  0.2480754852294922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040242671966552734
gen group dst list time:  0.11469316482543945
time for parepare:  0.018920421600341797
local_output_nid generation:  0.026713848114013672
local_in_edges_tensor generation:  0.050211429595947266
mini_batch_src_global generation:  0.04385113716125488
r_  generation:  0.4313347339630127
local_output_nid generation:  0.031694650650024414
local_in_edges_tensor generation:  0.03401660919189453
mini_batch_src_global generation:  0.05158877372741699
r_  generation:  0.4307217597961426
local_output_nid generation:  0.033055782318115234
local_in_edges_tensor generation:  0.03393292427062988
mini_batch_src_global generation:  0.05359768867492676
r_  generation:  0.43537116050720215
local_output_nid generation:  0.031674861907958984
local_in_edges_tensor generation:  0.03154492378234863
mini_batch_src_global generation:  0.05045509338378906
r_  generation:  0.42777585983276367
local_output_nid generation:  0.033297061920166016
local_in_edges_tensor generation:  0.02943253517150879
mini_batch_src_global generation:  0.05252480506896973
r_  generation:  0.4412360191345215
local_output_nid generation:  0.03214859962463379
local_in_edges_tensor generation:  0.02733778953552246
mini_batch_src_global generation:  0.05216860771179199
r_  generation:  0.43889594078063965
local_output_nid generation:  0.03111577033996582
local_in_edges_tensor generation:  0.029729604721069336
mini_batch_src_global generation:  0.05101346969604492
r_  generation:  0.4353504180908203
local_output_nid generation:  0.030756235122680664
local_in_edges_tensor generation:  0.03039407730102539
mini_batch_src_global generation:  0.05286240577697754
r_  generation:  0.43505191802978516
local_output_nid generation:  0.030731916427612305
local_in_edges_tensor generation:  0.0347292423248291
mini_batch_src_global generation:  0.053171396255493164
r_  generation:  0.4429054260253906
local_output_nid generation:  0.032366275787353516
local_in_edges_tensor generation:  0.03149127960205078
mini_batch_src_global generation:  0.052839040756225586
r_  generation:  0.43561625480651855
local_output_nid generation:  0.030825376510620117
local_in_edges_tensor generation:  0.02879643440246582
mini_batch_src_global generation:  0.05159950256347656
r_  generation:  0.4558277130126953
local_output_nid generation:  0.033773183822631836
local_in_edges_tensor generation:  0.03006124496459961
mini_batch_src_global generation:  0.05569934844970703
r_  generation:  0.43781256675720215
local_output_nid generation:  0.032059669494628906
local_in_edges_tensor generation:  0.030884265899658203
mini_batch_src_global generation:  0.05169248580932617
r_  generation:  0.43898963928222656
local_output_nid generation:  0.03148198127746582
local_in_edges_tensor generation:  0.0278167724609375
mini_batch_src_global generation:  0.05277562141418457
r_  generation:  0.4364626407623291
local_output_nid generation:  0.031471967697143555
local_in_edges_tensor generation:  0.026145219802856445
mini_batch_src_global generation:  0.0531923770904541
r_  generation:  0.4400947093963623
local_output_nid generation:  0.03212547302246094
local_in_edges_tensor generation:  0.028675079345703125
mini_batch_src_global generation:  0.05209803581237793
r_  generation:  0.43917298316955566
local_output_nid generation:  0.03186631202697754
local_in_edges_tensor generation:  0.027492523193359375
mini_batch_src_global generation:  0.05113077163696289
r_  generation:  0.44071173667907715
local_output_nid generation:  0.03386569023132324
local_in_edges_tensor generation:  0.028985977172851562
mini_batch_src_global generation:  0.05400514602661133
r_  generation:  0.4350917339324951
local_output_nid generation:  0.03167986869812012
local_in_edges_tensor generation:  0.02845001220703125
mini_batch_src_global generation:  0.05126547813415527
r_  generation:  0.44094061851501465
local_output_nid generation:  0.031401634216308594
local_in_edges_tensor generation:  0.027564048767089844
mini_batch_src_global generation:  0.05268716812133789
r_  generation:  0.43471741676330566
local_output_nid generation:  0.031694650650024414
local_in_edges_tensor generation:  0.028017759323120117
mini_batch_src_global generation:  0.050795793533325195
r_  generation:  0.44016480445861816
local_output_nid generation:  0.031668663024902344
local_in_edges_tensor generation:  0.028710603713989258
mini_batch_src_global generation:  0.05205869674682617
r_  generation:  0.4378833770751953
local_output_nid generation:  0.03220486640930176
local_in_edges_tensor generation:  0.033452749252319336
mini_batch_src_global generation:  0.051666259765625
r_  generation:  0.4426383972167969
local_output_nid generation:  0.03203296661376953
local_in_edges_tensor generation:  0.030976057052612305
mini_batch_src_global generation:  0.052265167236328125
r_  generation:  0.44585084915161133
local_output_nid generation:  0.032154083251953125
local_in_edges_tensor generation:  0.03083324432373047
mini_batch_src_global generation:  0.05160713195800781
r_  generation:  0.44614696502685547
local_output_nid generation:  0.03169751167297363
local_in_edges_tensor generation:  0.028587818145751953
mini_batch_src_global generation:  0.0523686408996582
r_  generation:  0.44036149978637695
local_output_nid generation:  0.03191518783569336
local_in_edges_tensor generation:  0.029143095016479492
mini_batch_src_global generation:  0.05396723747253418
r_  generation:  0.43997812271118164
local_output_nid generation:  0.031998395919799805
local_in_edges_tensor generation:  0.028486967086791992
mini_batch_src_global generation:  0.052190542221069336
r_  generation:  0.4398458003997803
local_output_nid generation:  0.03186678886413574
local_in_edges_tensor generation:  0.0291750431060791
mini_batch_src_global generation:  0.05283641815185547
r_  generation:  0.4424738883972168
local_output_nid generation:  0.03180217742919922
local_in_edges_tensor generation:  0.028877735137939453
mini_batch_src_global generation:  0.05279541015625
r_  generation:  0.43788957595825195
local_output_nid generation:  0.03204774856567383
local_in_edges_tensor generation:  0.02648019790649414
mini_batch_src_global generation:  0.052004337310791016
r_  generation:  0.44499993324279785
local_output_nid generation:  0.031804800033569336
local_in_edges_tensor generation:  0.029068470001220703
mini_batch_src_global generation:  0.052759408950805664
r_  generation:  0.4412381649017334
----------------------check_connections_block total spend ----------------------------- 20.917152166366577
generate_one_block  0.6059126853942871
generate_one_block  0.5876622200012207
generate_one_block  0.584712028503418
generate_one_block  0.5843315124511719
generate_one_block  0.6931920051574707
generate_one_block  0.5818591117858887
generate_one_block  0.5851645469665527
generate_one_block  0.5892610549926758
generate_one_block  0.5929727554321289
generate_one_block  0.5970907211303711
generate_one_block  0.5911428928375244
generate_one_block  0.5861246585845947
generate_one_block  0.5934543609619141
generate_one_block  0.5872931480407715
generate_one_block  0.5932905673980713
generate_one_block  0.6064133644104004
generate_one_block  0.5843369960784912
generate_one_block  0.5865457057952881
generate_one_block  0.6107192039489746
generate_one_block  0.5815746784210205
generate_one_block  0.5834290981292725
generate_one_block  0.5953989028930664
generate_one_block  0.5967915058135986
generate_one_block  0.5936851501464844
generate_one_block  0.610356330871582
generate_one_block  0.5778388977050781
generate_one_block  0.5856029987335205
generate_one_block  0.590888500213623
generate_one_block  0.5893731117248535
generate_one_block  0.5802829265594482
generate_one_block  0.5898761749267578
generate_one_block  0.5854661464691162
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.12667608261108398  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

connection checking time:  29.5338032245636
block generation total time  27.044373035430908
average batch blocks generation time:  0.8451366573572159
block dataloader generation time/epoch 59.68337720318844
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10657405853271484  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.851431369781494  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10640668869018555  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.825368404388428  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.1061701774597168  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.358785152435303  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10592937469482422  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.21007776260376  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10631942749023438  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.85417413711548  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10658979415893555  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.680372714996338  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.1063079833984375  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.421620845794678  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10653018951416016  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.911916732788086  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.1069478988647461  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.170923709869385  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10685062408447266  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.17766237258911  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.1065683364868164  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.909937381744385  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.1064748764038086  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.042223930358887  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10687017440795898  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.104329586029053  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10630083084106445  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.160786151885986  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.106658935546875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.96068048477173  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.1067805290222168  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.958653926849365  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.1065816879272461  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.81912088394165  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10645008087158203  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 18.823935985565186  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 0.10708093643188477  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1854248046875 GB
    Memory Allocated: 19.6069598197937  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8807373046875 GB
    Memory Allocated: 0.10657024383544922  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0780029296875 GB
    Memory Allocated: 18.632242679595947  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0799560546875 GB
    Memory Allocated: 0.10658788681030273  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1912841796875 GB
    Memory Allocated: 18.537217617034912  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1932373046875 GB
    Memory Allocated: 0.1066293716430664  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1932373046875 GB
    Memory Allocated: 19.075650691986084  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1932373046875 GB
    Memory Allocated: 0.10708427429199219  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1990966796875 GB
    Memory Allocated: 19.393203258514404  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2030029296875 GB
    Memory Allocated: 0.10693502426147461  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2030029296875 GB
    Memory Allocated: 19.248794555664062  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2030029296875 GB
    Memory Allocated: 0.10668277740478516  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2030029296875 GB
    Memory Allocated: 18.967302799224854  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2030029296875 GB
    Memory Allocated: 0.10646724700927734  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2088623046875 GB
    Memory Allocated: 18.589333534240723  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2108154296875 GB
    Memory Allocated: 0.10666751861572266  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2108154296875 GB
    Memory Allocated: 18.822173595428467  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2108154296875 GB
    Memory Allocated: 0.10678577423095703  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2108154296875 GB
    Memory Allocated: 19.046950340270996  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2108154296875 GB
    Memory Allocated: 0.10694408416748047  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2811279296875 GB
    Memory Allocated: 19.248976707458496  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.10649442672729492  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 18.94645071029663  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.10666656494140625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 19.030756950378418  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2908935546875 GB
    Memory Allocated: 0.10664844512939453  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2908935546875 GB
    Memory Allocated: 18.84187650680542  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03436978906393051 |0.020457565784454346 |0.5602627322077751 |9.449571371078491e-05 |1.0670631229877472 |0.006082773208618164 |
----------------------------------------------------------pseudo_mini_loss sum 1.2559728622436523
Total (block generation + training)time/epoch 113.35822525777314
Training time/epoch 53.90377640724182
Training time without block to device /epoch 53.24913430213928
Training time without total dataloading part /epoch 52.08353400230408
load block tensor time/epoch 1.0998332500457764
block to device time/epoch 0.6546421051025391
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  9115291
Number of first layer input nodes during this epoch:  4762315
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.2908935546875 GB
    Memory Allocated: 0.12665081024169922  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02431178092956543
range selection method range initialization spend 0.013989686965942383
time for parepare:  0.020526885986328125
local_output_nid generation:  0.0009694099426269531
local_in_edges_tensor generation:  0.006455659866333008
mini_batch_src_global generation:  0.001695871353149414
r_  generation:  0.010970115661621094
local_output_nid generation:  0.0010211467742919922
local_in_edges_tensor generation:  0.0007252693176269531
mini_batch_src_global generation:  0.0016431808471679688
r_  generation:  0.010955333709716797
local_output_nid generation:  0.0009474754333496094
local_in_edges_tensor generation:  0.0006031990051269531
mini_batch_src_global generation:  0.0011398792266845703
r_  generation:  0.009958267211914062
local_output_nid generation:  0.0009257793426513672
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.0010900497436523438
r_  generation:  0.009700298309326172
local_output_nid generation:  0.0009145736694335938
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.009976387023925781
local_output_nid generation:  0.0009090900421142578
local_in_edges_tensor generation:  0.0005753040313720703
mini_batch_src_global generation:  0.0011093616485595703
r_  generation:  0.010161161422729492
local_output_nid generation:  0.0008983612060546875
local_in_edges_tensor generation:  0.0005803108215332031
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.010118722915649414
local_output_nid generation:  0.0008950233459472656
local_in_edges_tensor generation:  0.0006325244903564453
mini_batch_src_global generation:  0.0012183189392089844
r_  generation:  0.010532855987548828
local_output_nid generation:  0.0009121894836425781
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.0011720657348632812
r_  generation:  0.009896278381347656
local_output_nid generation:  0.0008983612060546875
local_in_edges_tensor generation:  0.0005891323089599609
mini_batch_src_global generation:  0.0011513233184814453
r_  generation:  0.010625839233398438
local_output_nid generation:  0.0008962154388427734
local_in_edges_tensor generation:  0.0005905628204345703
mini_batch_src_global generation:  0.001276254653930664
r_  generation:  0.010684490203857422
local_output_nid generation:  0.000881195068359375
local_in_edges_tensor generation:  0.0005934238433837891
mini_batch_src_global generation:  0.0012149810791015625
r_  generation:  0.01062774658203125
local_output_nid generation:  0.0008778572082519531
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.0010874271392822266
r_  generation:  0.009870290756225586
local_output_nid generation:  0.0008819103240966797
local_in_edges_tensor generation:  0.0005872249603271484
mini_batch_src_global generation:  0.0011749267578125
r_  generation:  0.010638713836669922
local_output_nid generation:  0.0008854866027832031
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.0011892318725585938
r_  generation:  0.010128021240234375
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0011906623840332031
r_  generation:  0.010222911834716797
local_output_nid generation:  0.000888824462890625
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.0012025833129882812
r_  generation:  0.010225057601928711
local_output_nid generation:  0.0008842945098876953
local_in_edges_tensor generation:  0.0006263256072998047
mini_batch_src_global generation:  0.0011849403381347656
r_  generation:  0.010592222213745117
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0005829334259033203
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.01038813591003418
local_output_nid generation:  0.0008842945098876953
local_in_edges_tensor generation:  0.0005733966827392578
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.010421514511108398
local_output_nid generation:  0.0008766651153564453
local_in_edges_tensor generation:  0.0005700588226318359
mini_batch_src_global generation:  0.0011639595031738281
r_  generation:  0.010149955749511719
local_output_nid generation:  0.0008802413940429688
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0012311935424804688
r_  generation:  0.010598182678222656
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.0005578994750976562
mini_batch_src_global generation:  0.0011911392211914062
r_  generation:  0.010027885437011719
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0005774497985839844
mini_batch_src_global generation:  0.0012552738189697266
r_  generation:  0.010746479034423828
local_output_nid generation:  0.000881195068359375
local_in_edges_tensor generation:  0.0005743503570556641
mini_batch_src_global generation:  0.0011875629425048828
r_  generation:  0.010393381118774414
local_output_nid generation:  0.0008864402770996094
local_in_edges_tensor generation:  0.0005712509155273438
mini_batch_src_global generation:  0.001132965087890625
r_  generation:  0.010309934616088867
local_output_nid generation:  0.0008914470672607422
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0011434555053710938
r_  generation:  0.01028132438659668
local_output_nid generation:  0.0008826255798339844
local_in_edges_tensor generation:  0.0005624294281005859
mini_batch_src_global generation:  0.0011072158813476562
r_  generation:  0.009801387786865234
local_output_nid generation:  0.0008866786956787109
local_in_edges_tensor generation:  0.0005600452423095703
mini_batch_src_global generation:  0.0011832714080810547
r_  generation:  0.010007381439208984
local_output_nid generation:  0.0008835792541503906
local_in_edges_tensor generation:  0.0005657672882080078
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.010300874710083008
local_output_nid generation:  0.0008826255798339844
local_in_edges_tensor generation:  0.0005714893341064453
mini_batch_src_global generation:  0.001172780990600586
r_  generation:  0.010309457778930664
local_output_nid generation:  0.0008854866027832031
local_in_edges_tensor generation:  0.0005958080291748047
mini_batch_src_global generation:  0.0012059211730957031
r_  generation:  0.010403871536254883
----------------------check_connections_block total spend ----------------------------- 0.5237476825714111
generate_one_block  0.02102804183959961
generate_one_block  0.021003246307373047
generate_one_block  0.018947362899780273
generate_one_block  0.018273591995239258
generate_one_block  0.0187227725982666
generate_one_block  0.01847052574157715
generate_one_block  0.01834583282470703
generate_one_block  0.019036531448364258
generate_one_block  0.018018484115600586
generate_one_block  0.01877593994140625
generate_one_block  0.018774747848510742
generate_one_block  0.02115774154663086
generate_one_block  0.01826190948486328
generate_one_block  0.019278287887573242
generate_one_block  0.018161773681640625
generate_one_block  0.018372058868408203
generate_one_block  0.018330812454223633
generate_one_block  0.019033432006835938
generate_one_block  0.018552780151367188
generate_one_block  0.018803119659423828
generate_one_block  0.01816105842590332
generate_one_block  0.018923521041870117
generate_one_block  0.017887115478515625
generate_one_block  0.01923847198486328
generate_one_block  0.021231651306152344
generate_one_block  0.01850271224975586
generate_one_block  0.0184628963470459
generate_one_block  0.017540693283081055
generate_one_block  0.017839431762695312
generate_one_block  0.018568992614746094
generate_one_block  0.018132448196411133
generate_one_block  0.01840376853942871
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03850197792053223
gen group dst list time:  0.023209333419799805
time for parepare:  0.022258520126342773
local_output_nid generation:  0.005632162094116211
local_in_edges_tensor generation:  0.018950939178466797
mini_batch_src_global generation:  0.0183258056640625
r_  generation:  0.16408252716064453
local_output_nid generation:  0.007880210876464844
local_in_edges_tensor generation:  0.011127233505249023
mini_batch_src_global generation:  0.02312302589416504
r_  generation:  0.2061300277709961
local_output_nid generation:  0.008035659790039062
local_in_edges_tensor generation:  0.034984588623046875
mini_batch_src_global generation:  0.021047353744506836
r_  generation:  0.17298054695129395
local_output_nid generation:  0.008207559585571289
local_in_edges_tensor generation:  0.009073972702026367
mini_batch_src_global generation:  0.022372961044311523
r_  generation:  0.17666172981262207
local_output_nid generation:  0.008641481399536133
local_in_edges_tensor generation:  0.011292219161987305
mini_batch_src_global generation:  0.02287459373474121
r_  generation:  0.18294548988342285
local_output_nid generation:  0.008784294128417969
local_in_edges_tensor generation:  0.009130239486694336
mini_batch_src_global generation:  0.022639751434326172
r_  generation:  0.17745590209960938
local_output_nid generation:  0.008797168731689453
local_in_edges_tensor generation:  0.008610725402832031
mini_batch_src_global generation:  0.024003028869628906
r_  generation:  0.17989897727966309
local_output_nid generation:  0.008704900741577148
local_in_edges_tensor generation:  0.009518146514892578
mini_batch_src_global generation:  0.02341294288635254
r_  generation:  0.18455219268798828
local_output_nid generation:  0.008410215377807617
local_in_edges_tensor generation:  0.009203672409057617
mini_batch_src_global generation:  0.022893667221069336
r_  generation:  0.17786264419555664
local_output_nid generation:  0.008787393569946289
local_in_edges_tensor generation:  0.008669853210449219
mini_batch_src_global generation:  0.023204565048217773
r_  generation:  0.1819746494293213
local_output_nid generation:  0.00912785530090332
local_in_edges_tensor generation:  0.008977174758911133
mini_batch_src_global generation:  0.02481365203857422
r_  generation:  0.18648099899291992
local_output_nid generation:  0.009401798248291016
local_in_edges_tensor generation:  0.011919975280761719
mini_batch_src_global generation:  0.023755550384521484
r_  generation:  0.18570446968078613
local_output_nid generation:  0.00879049301147461
local_in_edges_tensor generation:  0.010061264038085938
mini_batch_src_global generation:  0.022792339324951172
r_  generation:  0.18000102043151855
local_output_nid generation:  0.009458780288696289
local_in_edges_tensor generation:  0.012067556381225586
mini_batch_src_global generation:  0.025251150131225586
r_  generation:  0.1961064338684082
local_output_nid generation:  0.009105682373046875
local_in_edges_tensor generation:  0.008554697036743164
mini_batch_src_global generation:  0.022924423217773438
r_  generation:  0.17689037322998047
local_output_nid generation:  0.009254217147827148
local_in_edges_tensor generation:  0.008842229843139648
mini_batch_src_global generation:  0.023238658905029297
r_  generation:  0.184401273727417
local_output_nid generation:  0.009220600128173828
local_in_edges_tensor generation:  0.008794307708740234
mini_batch_src_global generation:  0.023372650146484375
r_  generation:  0.18650531768798828
local_output_nid generation:  0.009435415267944336
local_in_edges_tensor generation:  0.009894847869873047
mini_batch_src_global generation:  0.02382063865661621
r_  generation:  0.1896224021911621
local_output_nid generation:  0.009341239929199219
local_in_edges_tensor generation:  0.008952140808105469
mini_batch_src_global generation:  0.024033308029174805
r_  generation:  0.18640637397766113
local_output_nid generation:  0.009352922439575195
local_in_edges_tensor generation:  0.009075403213500977
mini_batch_src_global generation:  0.02469635009765625
r_  generation:  0.189316987991333
local_output_nid generation:  0.009002923965454102
local_in_edges_tensor generation:  0.008764028549194336
mini_batch_src_global generation:  0.02377629280090332
r_  generation:  0.18342328071594238
local_output_nid generation:  0.011022329330444336
local_in_edges_tensor generation:  0.009163379669189453
mini_batch_src_global generation:  0.024278879165649414
r_  generation:  0.19253134727478027
local_output_nid generation:  0.009051084518432617
local_in_edges_tensor generation:  0.008646726608276367
mini_batch_src_global generation:  0.023349285125732422
r_  generation:  0.18027329444885254
local_output_nid generation:  0.012094974517822266
local_in_edges_tensor generation:  0.009138822555541992
mini_batch_src_global generation:  0.024152040481567383
r_  generation:  0.19784808158874512
local_output_nid generation:  0.00940394401550293
local_in_edges_tensor generation:  0.010816335678100586
mini_batch_src_global generation:  0.02675008773803711
r_  generation:  0.19682526588439941
local_output_nid generation:  0.009320974349975586
local_in_edges_tensor generation:  0.009889364242553711
mini_batch_src_global generation:  0.023361921310424805
r_  generation:  0.1902766227722168
local_output_nid generation:  0.010291337966918945
local_in_edges_tensor generation:  0.01460886001586914
mini_batch_src_global generation:  0.025623559951782227
r_  generation:  0.19649815559387207
local_output_nid generation:  0.0091552734375
local_in_edges_tensor generation:  0.010699748992919922
mini_batch_src_global generation:  0.02414870262145996
r_  generation:  0.185197114944458
local_output_nid generation:  0.009261846542358398
local_in_edges_tensor generation:  0.011182546615600586
mini_batch_src_global generation:  0.022380590438842773
r_  generation:  0.18549585342407227
local_output_nid generation:  0.009273052215576172
local_in_edges_tensor generation:  0.009998083114624023
mini_batch_src_global generation:  0.023433685302734375
r_  generation:  0.1883857250213623
local_output_nid generation:  0.009467601776123047
local_in_edges_tensor generation:  0.012879610061645508
mini_batch_src_global generation:  0.023295879364013672
r_  generation:  0.1962108612060547
local_output_nid generation:  0.011933326721191406
local_in_edges_tensor generation:  0.009443998336791992
mini_batch_src_global generation:  0.025849580764770508
r_  generation:  0.18933963775634766
----------------------check_connections_block total spend ----------------------------- 8.712531805038452
generate_one_block  0.26168298721313477
generate_one_block  0.24706530570983887
generate_one_block  0.24652910232543945
generate_one_block  0.24603772163391113
generate_one_block  0.27123165130615234
generate_one_block  0.24396204948425293
generate_one_block  0.25310468673706055
generate_one_block  0.267409086227417
generate_one_block  0.24550580978393555
generate_one_block  0.2482011318206787
generate_one_block  0.2582435607910156
generate_one_block  0.2582852840423584
generate_one_block  0.24254631996154785
generate_one_block  0.2629215717315674
generate_one_block  0.24095940589904785
generate_one_block  0.25391530990600586
generate_one_block  0.2573387622833252
generate_one_block  0.2619669437408447
generate_one_block  0.25280141830444336
generate_one_block  0.2582588195800781
generate_one_block  0.24780702590942383
generate_one_block  0.25467872619628906
generate_one_block  0.23691511154174805
generate_one_block  0.26058340072631836
generate_one_block  0.25377988815307617
generate_one_block  0.24831247329711914
generate_one_block  0.2537574768066406
generate_one_block  0.23960542678833008
generate_one_block  0.23911237716674805
generate_one_block  0.25052356719970703
generate_one_block  0.2450566291809082
generate_one_block  0.2545754909515381
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0357213020324707
gen group dst list time:  0.11671876907348633
time for parepare:  0.019195556640625
local_output_nid generation:  0.025795459747314453
local_in_edges_tensor generation:  0.04581165313720703
mini_batch_src_global generation:  0.04148745536804199
r_  generation:  0.43430066108703613
local_output_nid generation:  0.030488252639770508
local_in_edges_tensor generation:  0.037758588790893555
mini_batch_src_global generation:  0.05112814903259277
r_  generation:  0.443373441696167
local_output_nid generation:  0.03499579429626465
local_in_edges_tensor generation:  0.031470537185668945
mini_batch_src_global generation:  0.05209231376647949
r_  generation:  0.4380331039428711
local_output_nid generation:  0.03145861625671387
local_in_edges_tensor generation:  0.028519630432128906
mini_batch_src_global generation:  0.05117654800415039
r_  generation:  0.42798399925231934
local_output_nid generation:  0.031603336334228516
local_in_edges_tensor generation:  0.03055858612060547
mini_batch_src_global generation:  0.05210566520690918
r_  generation:  0.4387357234954834
local_output_nid generation:  0.03174138069152832
local_in_edges_tensor generation:  0.02658867835998535
mini_batch_src_global generation:  0.05164074897766113
r_  generation:  0.43493175506591797
local_output_nid generation:  0.030706405639648438
local_in_edges_tensor generation:  0.02814793586730957
mini_batch_src_global generation:  0.050972938537597656
r_  generation:  0.43692588806152344
local_output_nid generation:  0.03006744384765625
local_in_edges_tensor generation:  0.0304720401763916
mini_batch_src_global generation:  0.052376747131347656
r_  generation:  0.4412226676940918
local_output_nid generation:  0.029880046844482422
local_in_edges_tensor generation:  0.02675795555114746
mini_batch_src_global generation:  0.0512547492980957
r_  generation:  0.4358329772949219
local_output_nid generation:  0.030273914337158203
local_in_edges_tensor generation:  0.029204607009887695
mini_batch_src_global generation:  0.05434918403625488
r_  generation:  0.4348418712615967
local_output_nid generation:  0.030558347702026367
local_in_edges_tensor generation:  0.02875804901123047
mini_batch_src_global generation:  0.050780534744262695
r_  generation:  0.4429481029510498
local_output_nid generation:  0.03040027618408203
local_in_edges_tensor generation:  0.029221296310424805
mini_batch_src_global generation:  0.05381035804748535
r_  generation:  0.4395713806152344
local_output_nid generation:  0.030268192291259766
local_in_edges_tensor generation:  0.026894807815551758
mini_batch_src_global generation:  0.050691843032836914
r_  generation:  0.44921374320983887
local_output_nid generation:  0.03054356575012207
local_in_edges_tensor generation:  0.027341842651367188
mini_batch_src_global generation:  0.05384111404418945
r_  generation:  0.4446296691894531
local_output_nid generation:  0.030093669891357422
local_in_edges_tensor generation:  0.02767777442932129
mini_batch_src_global generation:  0.05314135551452637
r_  generation:  0.4420433044433594
local_output_nid generation:  0.030458450317382812
local_in_edges_tensor generation:  0.029456377029418945
mini_batch_src_global generation:  0.05368304252624512
r_  generation:  0.4464552402496338
local_output_nid generation:  0.03262042999267578
local_in_edges_tensor generation:  0.030427217483520508
mini_batch_src_global generation:  0.05187106132507324
r_  generation:  0.44617676734924316
local_output_nid generation:  0.030736446380615234
local_in_edges_tensor generation:  0.031020402908325195
mini_batch_src_global generation:  0.05588960647583008
r_  generation:  0.4379584789276123
local_output_nid generation:  0.03052544593811035
local_in_edges_tensor generation:  0.026981353759765625
mini_batch_src_global generation:  0.0505976676940918
r_  generation:  0.44228529930114746
local_output_nid generation:  0.030470848083496094
local_in_edges_tensor generation:  0.031171083450317383
mini_batch_src_global generation:  0.05233311653137207
r_  generation:  0.4387848377227783
local_output_nid generation:  0.031369924545288086
local_in_edges_tensor generation:  0.027016401290893555
mini_batch_src_global generation:  0.0507502555847168
r_  generation:  0.4418599605560303
local_output_nid generation:  0.030483722686767578
local_in_edges_tensor generation:  0.029610395431518555
mini_batch_src_global generation:  0.05218195915222168
r_  generation:  0.4413180351257324
local_output_nid generation:  0.030362606048583984
local_in_edges_tensor generation:  0.0316622257232666
mini_batch_src_global generation:  0.05255722999572754
r_  generation:  0.44863080978393555
local_output_nid generation:  0.03058004379272461
local_in_edges_tensor generation:  0.027691125869750977
mini_batch_src_global generation:  0.05335545539855957
r_  generation:  0.4439661502838135
local_output_nid generation:  0.030565977096557617
local_in_edges_tensor generation:  0.035245656967163086
mini_batch_src_global generation:  0.05320000648498535
r_  generation:  0.4488534927368164
local_output_nid generation:  0.03035902976989746
local_in_edges_tensor generation:  0.030050039291381836
mini_batch_src_global generation:  0.05265641212463379
r_  generation:  0.4430220127105713
local_output_nid generation:  0.030809879302978516
local_in_edges_tensor generation:  0.03271675109863281
mini_batch_src_global generation:  0.05287456512451172
r_  generation:  0.4468262195587158
local_output_nid generation:  0.03054666519165039
local_in_edges_tensor generation:  0.032160282135009766
mini_batch_src_global generation:  0.05340409278869629
r_  generation:  0.4382328987121582
local_output_nid generation:  0.030454397201538086
local_in_edges_tensor generation:  0.030998706817626953
mini_batch_src_global generation:  0.05207228660583496
r_  generation:  0.45923542976379395
local_output_nid generation:  0.03283405303955078
local_in_edges_tensor generation:  0.02885270118713379
mini_batch_src_global generation:  0.05322146415710449
r_  generation:  0.43586087226867676
local_output_nid generation:  0.030560731887817383
local_in_edges_tensor generation:  0.028397321701049805
mini_batch_src_global generation:  0.052167654037475586
r_  generation:  0.44173336029052734
local_output_nid generation:  0.031116485595703125
local_in_edges_tensor generation:  0.02906012535095215
mini_batch_src_global generation:  0.0538480281829834
r_  generation:  0.43893003463745117
----------------------check_connections_block total spend ----------------------------- 20.92747926712036
generate_one_block  0.604931116104126
generate_one_block  0.5863656997680664
generate_one_block  0.5783119201660156
generate_one_block  0.5946617126464844
generate_one_block  0.7054510116577148
generate_one_block  0.583266019821167
generate_one_block  0.5786395072937012
generate_one_block  0.5967886447906494
generate_one_block  0.5841774940490723
generate_one_block  0.5854036808013916
generate_one_block  0.5916361808776855
generate_one_block  0.6024491786956787
generate_one_block  0.5865926742553711
generate_one_block  0.595794677734375
generate_one_block  0.5822701454162598
generate_one_block  0.5931580066680908
generate_one_block  0.5949680805206299
generate_one_block  0.5941305160522461
generate_one_block  0.5921332836151123
generate_one_block  0.5900709629058838
generate_one_block  0.5903158187866211
generate_one_block  0.5878055095672607
generate_one_block  0.5847978591918945
generate_one_block  0.6029372215270996
generate_one_block  0.6134853363037109
generate_one_block  0.5870823860168457
generate_one_block  0.5976285934448242
generate_one_block  0.5913345813751221
generate_one_block  0.591036319732666
generate_one_block  0.5887134075164795
generate_one_block  0.594191312789917
generate_one_block  0.607884407043457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.2908935546875 GB
    Memory Allocated: 0.12665081024169922  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

connection checking time:  29.640011072158813
block generation total time  27.121087789535522
average batch blocks generation time:  0.8475339934229851
block dataloader generation time/epoch 59.702407932281496
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2908935546875 GB
    Memory Allocated: 0.10657024383544922  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3162841796875 GB
    Memory Allocated: 18.745190620422363  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 0.106353759765625  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 18.778930187225342  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 0.10665321350097656  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 18.78601360321045  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 0.10648202896118164  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 18.807023525238037  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 0.10670280456542969  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 19.159438133239746  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 0.10645675659179688  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 18.798977851867676  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 0.10620403289794922  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 18.849441051483154  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 0.10698223114013672  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 19.166142463684082  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 0.10631847381591797  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 18.65304946899414  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 0.10650777816772461  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 18.806235313415527  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3182373046875 GB
    Memory Allocated: 0.10699224472045898  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3514404296875 GB
    Memory Allocated: 19.13312864303589  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 0.10686254501342773  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 19.181539058685303  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 0.1062469482421875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 18.465635776519775  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 0.10712575912475586  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 19.449622631072998  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 0.10624027252197266  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 18.330406665802002  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 0.10686922073364258  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 18.91297435760498  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 0.1067514419555664  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 18.959842205047607  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 0.10667181015014648  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 19.182899951934814  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3553466796875 GB
    Memory Allocated: 0.10657119750976562  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3846435546875 GB
    Memory Allocated: 19.01285982131958  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.10678958892822266  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 19.118231296539307  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.1064157485961914  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 18.88158130645752  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.10675334930419922  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 19.145224571228027  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.10643625259399414  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 18.473983764648438  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.1069178581237793  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 19.344687461853027  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.10685205459594727  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 19.11003828048706  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.10653305053710938  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 18.906951904296875  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.10684347152709961  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 19.136773109436035  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.10645437240600586  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 18.532950401306152  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.10633087158203125  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 18.475711822509766  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.10635995864868164  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 18.945510864257812  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.10666847229003906  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 18.791797637939453  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.10710430145263672  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 19.09211540222168  GigaBytes
Max Memory Allocated: 19.820268154144287  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03494839370250702 |0.019447103142738342 |0.5610949695110321 |9.313225746154785e-05 |1.070637971162796 |0.003830432891845703 |
----------------------------------------------------------pseudo_mini_loss sum 1.2414190769195557
Total (block generation + training)time/epoch 113.39447466135024
Training time/epoch 54.01897573471069
Training time without block to device /epoch 53.396668434143066
Training time without total dataloading part /epoch 52.222264766693115
load block tensor time/epoch 1.1183485984802246
block to device time/epoch 0.622307300567627
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  9115838
Number of first layer input nodes during this epoch:  4763446
