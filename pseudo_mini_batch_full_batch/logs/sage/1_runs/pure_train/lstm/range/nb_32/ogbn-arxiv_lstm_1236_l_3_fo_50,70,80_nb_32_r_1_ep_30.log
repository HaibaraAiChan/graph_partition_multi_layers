Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647806680.9975402
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028229951858520508
range selection method range initialization spend 0.013535022735595703
time for parepare:  0.01817488670349121
local_output_nid generation:  0.0007078647613525391
local_in_edges_tensor generation:  0.0041730403900146484
mini_batch_src_global generation:  0.0015156269073486328
r_  generation:  0.010581254959106445
local_output_nid generation:  0.0007557868957519531
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0015256404876708984
r_  generation:  0.009604454040527344
local_output_nid generation:  0.0007164478302001953
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.0009510517120361328
r_  generation:  0.009386301040649414
local_output_nid generation:  0.0007367134094238281
local_in_edges_tensor generation:  0.0005056858062744141
mini_batch_src_global generation:  0.0008614063262939453
r_  generation:  0.008818387985229492
local_output_nid generation:  0.0007386207580566406
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.0008647441864013672
r_  generation:  0.009257316589355469
local_output_nid generation:  0.0007441043853759766
local_in_edges_tensor generation:  0.0005004405975341797
mini_batch_src_global generation:  0.0009064674377441406
r_  generation:  0.009346246719360352
local_output_nid generation:  0.0007627010345458984
local_in_edges_tensor generation:  0.0004863739013671875
mini_batch_src_global generation:  0.0009262561798095703
r_  generation:  0.009461164474487305
local_output_nid generation:  0.000766754150390625
local_in_edges_tensor generation:  0.0004870891571044922
mini_batch_src_global generation:  0.0009310245513916016
r_  generation:  0.009903192520141602
local_output_nid generation:  0.0007455348968505859
local_in_edges_tensor generation:  0.000476837158203125
mini_batch_src_global generation:  0.0009317398071289062
r_  generation:  0.009536266326904297
local_output_nid generation:  0.0007424354553222656
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0009212493896484375
r_  generation:  0.00975799560546875
local_output_nid generation:  0.0007545948028564453
local_in_edges_tensor generation:  0.0004885196685791016
mini_batch_src_global generation:  0.0009706020355224609
r_  generation:  0.01012420654296875
local_output_nid generation:  0.0007653236389160156
local_in_edges_tensor generation:  0.0005023479461669922
mini_batch_src_global generation:  0.0010251998901367188
r_  generation:  0.009984493255615234
local_output_nid generation:  0.0007417201995849609
local_in_edges_tensor generation:  0.0004737377166748047
mini_batch_src_global generation:  0.0009763240814208984
r_  generation:  0.009989023208618164
local_output_nid generation:  0.0007510185241699219
local_in_edges_tensor generation:  0.0005064010620117188
mini_batch_src_global generation:  0.0010488033294677734
r_  generation:  0.010285615921020508
local_output_nid generation:  0.0007331371307373047
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  0.0010313987731933594
r_  generation:  0.010333061218261719
local_output_nid generation:  0.0007433891296386719
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.0010135173797607422
r_  generation:  0.009735584259033203
local_output_nid generation:  0.0007333755493164062
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0009629726409912109
r_  generation:  0.00978851318359375
local_output_nid generation:  0.0007457733154296875
local_in_edges_tensor generation:  0.0005092620849609375
mini_batch_src_global generation:  0.0010547637939453125
r_  generation:  0.010273933410644531
local_output_nid generation:  0.000743865966796875
local_in_edges_tensor generation:  0.00048470497131347656
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.009894847869873047
local_output_nid generation:  0.0007414817810058594
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0009884834289550781
r_  generation:  0.009806632995605469
local_output_nid generation:  0.0007565021514892578
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.0009889602661132812
r_  generation:  0.009882211685180664
local_output_nid generation:  0.0007290840148925781
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.0010023117065429688
r_  generation:  0.010275125503540039
local_output_nid generation:  0.0007519721984863281
local_in_edges_tensor generation:  0.0004794597625732422
mini_batch_src_global generation:  0.000982522964477539
r_  generation:  0.009776830673217773
local_output_nid generation:  0.0007476806640625
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0009438991546630859
r_  generation:  0.009557247161865234
local_output_nid generation:  0.0007443428039550781
local_in_edges_tensor generation:  0.00047016143798828125
mini_batch_src_global generation:  0.0009737014770507812
r_  generation:  0.010275840759277344
local_output_nid generation:  0.0007658004760742188
local_in_edges_tensor generation:  0.0004742145538330078
mini_batch_src_global generation:  0.0010111331939697266
r_  generation:  0.010032415390014648
local_output_nid generation:  0.0007464885711669922
local_in_edges_tensor generation:  0.00046753883361816406
mini_batch_src_global generation:  0.0009810924530029297
r_  generation:  0.009849786758422852
local_output_nid generation:  0.0007517337799072266
local_in_edges_tensor generation:  0.0004725456237792969
mini_batch_src_global generation:  0.0010318756103515625
r_  generation:  0.010066032409667969
local_output_nid generation:  0.0007464885711669922
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0011250972747802734
r_  generation:  0.010332345962524414
local_output_nid generation:  0.0007529258728027344
local_in_edges_tensor generation:  0.004333019256591797
mini_batch_src_global generation:  0.0012044906616210938
r_  generation:  0.009946823120117188
local_output_nid generation:  0.00079345703125
local_in_edges_tensor generation:  0.0005164146423339844
mini_batch_src_global generation:  0.0010607242584228516
r_  generation:  0.009740114212036133
local_output_nid generation:  0.0008094310760498047
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  0.0010478496551513672
r_  generation:  0.010195493698120117
----------------------check_connections_block total spend ----------------------------- 0.48744726181030273
generate_one_block  0.015895366668701172
generate_one_block  0.015194177627563477
generate_one_block  0.014928817749023438
generate_one_block  0.013975381851196289
generate_one_block  0.014757156372070312
generate_one_block  0.014563322067260742
generate_one_block  0.014708518981933594
generate_one_block  0.015309810638427734
generate_one_block  0.014641284942626953
generate_one_block  0.015161991119384766
generate_one_block  0.015081167221069336
generate_one_block  0.01542353630065918
generate_one_block  0.015043973922729492
generate_one_block  0.015392065048217773
generate_one_block  0.015542268753051758
generate_one_block  0.01466679573059082
generate_one_block  0.014449834823608398
generate_one_block  0.015631437301635742
generate_one_block  0.014644384384155273
generate_one_block  0.014681816101074219
generate_one_block  0.014828205108642578
generate_one_block  0.015110015869140625
generate_one_block  0.014510869979858398
generate_one_block  0.014234304428100586
generate_one_block  0.015098810195922852
generate_one_block  0.01500082015991211
generate_one_block  0.014618873596191406
generate_one_block  0.014879226684570312
generate_one_block  0.015123367309570312
generate_one_block  0.014497756958007812
generate_one_block  0.014647483825683594
generate_one_block  0.015185356140136719
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04446244239807129
gen group dst list time:  0.02384042739868164
time for parepare:  0.019763708114624023
local_output_nid generation:  0.0043566226959228516
local_in_edges_tensor generation:  0.013471603393554688
mini_batch_src_global generation:  0.01677703857421875
r_  generation:  0.16399574279785156
local_output_nid generation:  0.008203744888305664
local_in_edges_tensor generation:  0.014144182205200195
mini_batch_src_global generation:  0.020611047744750977
r_  generation:  0.16856980323791504
local_output_nid generation:  0.008035421371459961
local_in_edges_tensor generation:  0.011687517166137695
mini_batch_src_global generation:  0.01884603500366211
r_  generation:  0.17232465744018555
local_output_nid generation:  0.007767677307128906
local_in_edges_tensor generation:  0.010730504989624023
mini_batch_src_global generation:  0.01902914047241211
r_  generation:  0.16791200637817383
local_output_nid generation:  0.008301496505737305
local_in_edges_tensor generation:  0.01027226448059082
mini_batch_src_global generation:  0.024319171905517578
r_  generation:  0.1802682876586914
local_output_nid generation:  0.008351564407348633
local_in_edges_tensor generation:  0.011480093002319336
mini_batch_src_global generation:  0.02112269401550293
r_  generation:  0.18041300773620605
local_output_nid generation:  0.008452892303466797
local_in_edges_tensor generation:  0.010252714157104492
mini_batch_src_global generation:  0.021297454833984375
r_  generation:  0.1757979393005371
local_output_nid generation:  0.012603282928466797
local_in_edges_tensor generation:  0.011328935623168945
mini_batch_src_global generation:  0.024059534072875977
r_  generation:  0.20089960098266602
local_output_nid generation:  0.011482954025268555
local_in_edges_tensor generation:  0.024643421173095703
mini_batch_src_global generation:  0.028765201568603516
r_  generation:  0.17766952514648438
local_output_nid generation:  0.007806539535522461
local_in_edges_tensor generation:  0.010939836502075195
mini_batch_src_global generation:  0.024199247360229492
r_  generation:  0.1767115592956543
local_output_nid generation:  0.00798344612121582
local_in_edges_tensor generation:  0.010721921920776367
mini_batch_src_global generation:  0.024338483810424805
r_  generation:  0.1828455924987793
local_output_nid generation:  0.008081912994384766
local_in_edges_tensor generation:  0.01045989990234375
mini_batch_src_global generation:  0.023112773895263672
r_  generation:  0.1801300048828125
local_output_nid generation:  0.007925748825073242
local_in_edges_tensor generation:  0.010289192199707031
mini_batch_src_global generation:  0.022936344146728516
r_  generation:  0.1812424659729004
local_output_nid generation:  0.008022069931030273
local_in_edges_tensor generation:  0.01041722297668457
mini_batch_src_global generation:  0.02318120002746582
r_  generation:  0.1800994873046875
local_output_nid generation:  0.008235454559326172
local_in_edges_tensor generation:  0.012184858322143555
mini_batch_src_global generation:  0.023749589920043945
r_  generation:  0.18492794036865234
local_output_nid generation:  0.007699728012084961
local_in_edges_tensor generation:  0.011528253555297852
mini_batch_src_global generation:  0.02269434928894043
r_  generation:  0.17580819129943848
local_output_nid generation:  0.00771641731262207
local_in_edges_tensor generation:  0.010268449783325195
mini_batch_src_global generation:  0.021647214889526367
r_  generation:  0.1732792854309082
local_output_nid generation:  0.008225440979003906
local_in_edges_tensor generation:  0.009037971496582031
mini_batch_src_global generation:  0.02354884147644043
r_  generation:  0.18677234649658203
local_output_nid generation:  0.00797581672668457
local_in_edges_tensor generation:  0.01323556900024414
mini_batch_src_global generation:  0.022917985916137695
r_  generation:  0.17736077308654785
local_output_nid generation:  0.007853984832763672
local_in_edges_tensor generation:  0.008675813674926758
mini_batch_src_global generation:  0.02212214469909668
r_  generation:  0.1746840476989746
local_output_nid generation:  0.00799107551574707
local_in_edges_tensor generation:  0.010312080383300781
mini_batch_src_global generation:  0.025543212890625
r_  generation:  0.18623590469360352
local_output_nid generation:  0.008126258850097656
local_in_edges_tensor generation:  0.010354042053222656
mini_batch_src_global generation:  0.02455878257751465
r_  generation:  0.19520783424377441
local_output_nid generation:  0.007881879806518555
local_in_edges_tensor generation:  0.008873701095581055
mini_batch_src_global generation:  0.022240877151489258
r_  generation:  0.17667150497436523
local_output_nid generation:  0.007738828659057617
local_in_edges_tensor generation:  0.00960540771484375
mini_batch_src_global generation:  0.022068023681640625
r_  generation:  0.17067170143127441
local_output_nid generation:  0.008061885833740234
local_in_edges_tensor generation:  0.013678789138793945
mini_batch_src_global generation:  0.023413896560668945
r_  generation:  0.18905258178710938
local_output_nid generation:  0.007982254028320312
local_in_edges_tensor generation:  0.012055158615112305
mini_batch_src_global generation:  0.022882938385009766
r_  generation:  0.18022990226745605
local_output_nid generation:  0.007949113845825195
local_in_edges_tensor generation:  0.008640050888061523
mini_batch_src_global generation:  0.022140979766845703
r_  generation:  0.17723870277404785
local_output_nid generation:  0.008062124252319336
local_in_edges_tensor generation:  0.008683443069458008
mini_batch_src_global generation:  0.022778749465942383
r_  generation:  0.18094730377197266
local_output_nid generation:  0.008087396621704102
local_in_edges_tensor generation:  0.012889385223388672
mini_batch_src_global generation:  0.022805213928222656
r_  generation:  0.17984509468078613
local_output_nid generation:  0.00780940055847168
local_in_edges_tensor generation:  0.008710145950317383
mini_batch_src_global generation:  0.022350072860717773
r_  generation:  0.17535066604614258
local_output_nid generation:  0.00783681869506836
local_in_edges_tensor generation:  0.008656024932861328
mini_batch_src_global generation:  0.021900415420532227
r_  generation:  0.17494869232177734
local_output_nid generation:  0.008074760437011719
local_in_edges_tensor generation:  0.012211322784423828
mini_batch_src_global generation:  0.02429819107055664
r_  generation:  0.1822831630706787
----------------------check_connections_block total spend ----------------------------- 8.41481876373291
generate_one_block  0.2417466640472412
generate_one_block  0.23172926902770996
generate_one_block  0.2547314167022705
generate_one_block  0.23105168342590332
generate_one_block  0.2316427230834961
generate_one_block  0.2353522777557373
generate_one_block  0.22530078887939453
generate_one_block  0.260836124420166
generate_one_block  0.2411806583404541
generate_one_block  0.23043060302734375
generate_one_block  0.23674464225769043
generate_one_block  0.23868417739868164
generate_one_block  0.23124909400939941
generate_one_block  0.23363137245178223
generate_one_block  0.24011468887329102
generate_one_block  0.2760772705078125
generate_one_block  0.21581149101257324
generate_one_block  0.2494490146636963
generate_one_block  0.22403311729431152
generate_one_block  0.22297167778015137
generate_one_block  0.22970843315124512
generate_one_block  0.24078583717346191
generate_one_block  0.2266857624053955
generate_one_block  0.21698784828186035
generate_one_block  0.23195409774780273
generate_one_block  0.24346590042114258
generate_one_block  0.22025084495544434
generate_one_block  0.23018336296081543
generate_one_block  0.22542238235473633
generate_one_block  0.21927213668823242
generate_one_block  0.23937630653381348
generate_one_block  0.2435009479522705
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.1221764087677002
gen group dst list time:  0.12579107284545898
time for parepare:  0.021708011627197266
local_output_nid generation:  0.026525497436523438
local_in_edges_tensor generation:  0.05821418762207031
mini_batch_src_global generation:  0.0579991340637207
r_  generation:  0.47272562980651855
local_output_nid generation:  0.028766393661499023
local_in_edges_tensor generation:  0.04894828796386719
mini_batch_src_global generation:  0.06003737449645996
r_  generation:  0.4895908832550049
local_output_nid generation:  0.029331445693969727
local_in_edges_tensor generation:  0.044241905212402344
mini_batch_src_global generation:  0.058034658432006836
r_  generation:  0.49630117416381836
local_output_nid generation:  0.027502059936523438
local_in_edges_tensor generation:  0.030367374420166016
mini_batch_src_global generation:  0.057771921157836914
r_  generation:  0.4870169162750244
local_output_nid generation:  0.027623414993286133
local_in_edges_tensor generation:  0.032738685607910156
mini_batch_src_global generation:  0.05928373336791992
r_  generation:  0.5083234310150146
local_output_nid generation:  0.027779102325439453
local_in_edges_tensor generation:  0.03934288024902344
mini_batch_src_global generation:  0.08099889755249023
r_  generation:  0.5334568023681641
local_output_nid generation:  0.03135991096496582
local_in_edges_tensor generation:  0.05080366134643555
mini_batch_src_global generation:  0.06645369529724121
r_  generation:  0.5128674507141113
local_output_nid generation:  0.029028654098510742
local_in_edges_tensor generation:  0.04535984992980957
mini_batch_src_global generation:  0.07085537910461426
r_  generation:  0.5060694217681885
local_output_nid generation:  0.02883148193359375
local_in_edges_tensor generation:  0.047403812408447266
mini_batch_src_global generation:  0.06122303009033203
r_  generation:  0.5325160026550293
local_output_nid generation:  0.03270316123962402
local_in_edges_tensor generation:  0.04227876663208008
mini_batch_src_global generation:  0.0631103515625
r_  generation:  0.4946610927581787
local_output_nid generation:  0.028381824493408203
local_in_edges_tensor generation:  0.033814191818237305
mini_batch_src_global generation:  0.06030726432800293
r_  generation:  0.5103132724761963
local_output_nid generation:  0.028773784637451172
local_in_edges_tensor generation:  0.036809444427490234
mini_batch_src_global generation:  0.05907750129699707
r_  generation:  0.5012075901031494
local_output_nid generation:  0.02854633331298828
local_in_edges_tensor generation:  0.0337526798248291
mini_batch_src_global generation:  0.05920076370239258
r_  generation:  0.4999995231628418
local_output_nid generation:  0.029493331909179688
local_in_edges_tensor generation:  0.037149667739868164
mini_batch_src_global generation:  0.06667399406433105
r_  generation:  0.536287784576416
local_output_nid generation:  0.031157970428466797
local_in_edges_tensor generation:  0.04104804992675781
mini_batch_src_global generation:  0.06607246398925781
r_  generation:  0.5018694400787354
local_output_nid generation:  0.028516769409179688
local_in_edges_tensor generation:  0.034364938735961914
mini_batch_src_global generation:  0.05930328369140625
r_  generation:  0.49750566482543945
local_output_nid generation:  0.028687000274658203
local_in_edges_tensor generation:  0.03297114372253418
mini_batch_src_global generation:  0.059721946716308594
r_  generation:  0.49895405769348145
local_output_nid generation:  0.02886199951171875
local_in_edges_tensor generation:  0.03797030448913574
mini_batch_src_global generation:  0.06362295150756836
r_  generation:  0.5007336139678955
local_output_nid generation:  0.028568029403686523
local_in_edges_tensor generation:  0.0278778076171875
mini_batch_src_global generation:  0.05946683883666992
r_  generation:  0.516664981842041
local_output_nid generation:  0.028726577758789062
local_in_edges_tensor generation:  0.028217077255249023
mini_batch_src_global generation:  0.059781789779663086
r_  generation:  0.5000989437103271
local_output_nid generation:  0.032213687896728516
local_in_edges_tensor generation:  0.0489649772644043
mini_batch_src_global generation:  0.07104706764221191
r_  generation:  0.5198957920074463
local_output_nid generation:  0.031151294708251953
local_in_edges_tensor generation:  0.03821277618408203
mini_batch_src_global generation:  0.06331324577331543
r_  generation:  0.5017848014831543
local_output_nid generation:  0.028281450271606445
local_in_edges_tensor generation:  0.032758235931396484
mini_batch_src_global generation:  0.05823564529418945
r_  generation:  0.4921262264251709
local_output_nid generation:  0.02857065200805664
local_in_edges_tensor generation:  0.03230428695678711
mini_batch_src_global generation:  0.05926704406738281
r_  generation:  0.48879528045654297
local_output_nid generation:  0.028941631317138672
local_in_edges_tensor generation:  0.0324244499206543
mini_batch_src_global generation:  0.05863499641418457
r_  generation:  0.4986073970794678
local_output_nid generation:  0.028558015823364258
local_in_edges_tensor generation:  0.03719925880432129
mini_batch_src_global generation:  0.061046600341796875
r_  generation:  0.4933969974517822
local_output_nid generation:  0.028566837310791016
local_in_edges_tensor generation:  0.032301902770996094
mini_batch_src_global generation:  0.05836796760559082
r_  generation:  0.5021998882293701
local_output_nid generation:  0.028972864151000977
local_in_edges_tensor generation:  0.03733539581298828
mini_batch_src_global generation:  0.05940723419189453
r_  generation:  0.49773287773132324
local_output_nid generation:  0.02928304672241211
local_in_edges_tensor generation:  0.0424654483795166
mini_batch_src_global generation:  0.05858564376831055
r_  generation:  0.4983830451965332
local_output_nid generation:  0.028468847274780273
local_in_edges_tensor generation:  0.03003096580505371
mini_batch_src_global generation:  0.058869361877441406
r_  generation:  0.49326348304748535
local_output_nid generation:  0.029516220092773438
local_in_edges_tensor generation:  0.02850937843322754
mini_batch_src_global generation:  0.05842471122741699
r_  generation:  0.5171089172363281
local_output_nid generation:  0.031091690063476562
local_in_edges_tensor generation:  0.044175148010253906
mini_batch_src_global generation:  0.0635983943939209
r_  generation:  0.49619603157043457
----------------------check_connections_block total spend ----------------------------- 23.773157358169556
generate_one_block  0.752739667892456
generate_one_block  0.649479866027832
generate_one_block  0.6628901958465576
generate_one_block  0.6417398452758789
generate_one_block  0.6414146423339844
generate_one_block  0.6548893451690674
generate_one_block  0.6319081783294678
generate_one_block  0.6554908752441406
generate_one_block  0.634852409362793
generate_one_block  0.6374471187591553
generate_one_block  0.6468589305877686
generate_one_block  0.6492526531219482
generate_one_block  0.6395936012268066
generate_one_block  0.661992073059082
generate_one_block  0.653069019317627
generate_one_block  0.6291904449462891
generate_one_block  0.6365985870361328
generate_one_block  0.6674113273620605
generate_one_block  0.6396746635437012
generate_one_block  0.651517391204834
generate_one_block  0.658327579498291
generate_one_block  0.6555752754211426
generate_one_block  0.6321041584014893
generate_one_block  0.6337075233459473
generate_one_block  0.6431756019592285
generate_one_block  0.6386332511901855
generate_one_block  0.6409847736358643
generate_one_block  0.654857873916626
generate_one_block  0.6329612731933594
generate_one_block  0.6344552040100098
generate_one_block  0.6389155387878418
generate_one_block  0.6522660255432129
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  32.187976121902466
block generation total time  28.27433753013611
average batch blocks generation time:  0.8835730478167534
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09387063980102539  GigaBytes
Max Memory Allocated: 0.09387063980102539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0428466796875 GB
    Memory Allocated: 21.04502820968628  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.5252685546875 GB
    Memory Allocated: 0.09893035888671875  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5194091796875 GB
    Memory Allocated: 20.7336163520813  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5213623046875 GB
    Memory Allocated: 0.09937477111816406  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.729952335357666  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.09824657440185547  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.142905712127686  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.0993804931640625  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.760948657989502  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.09889984130859375  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.639748573303223  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.0992584228515625  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.558868408203125  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.09934520721435547  GigaBytes
Max Memory Allocated: 21.14385175704956  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9803466796875 GB
    Memory Allocated: 21.10764741897583  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4412841796875 GB
    Memory Allocated: 0.09858083724975586  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4666748046875 GB
    Memory Allocated: 20.697338581085205  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4705810546875 GB
    Memory Allocated: 0.09871721267700195  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6014404296875 GB
    Memory Allocated: 20.672234058380127  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6014404296875 GB
    Memory Allocated: 0.09882020950317383  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8084716796875 GB
    Memory Allocated: 21.073103427886963  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6815185546875 GB
    Memory Allocated: 0.0989847183227539  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8826904296875 GB
    Memory Allocated: 21.096689224243164  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8846435546875 GB
    Memory Allocated: 0.09868907928466797  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8846435546875 GB
    Memory Allocated: 20.8924880027771  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4100341796875 GB
    Memory Allocated: 0.09911727905273438  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4100341796875 GB
    Memory Allocated: 21.059391498565674  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4100341796875 GB
    Memory Allocated: 0.09913444519042969  GigaBytes
Max Memory Allocated: 21.198395252227783  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4100341796875 GB
    Memory Allocated: 21.255982398986816  GigaBytes
Max Memory Allocated: 21.351991653442383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3455810546875 GB
    Memory Allocated: 0.09874343872070312  GigaBytes
Max Memory Allocated: 21.351991653442383  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8651123046875 GB
    Memory Allocated: 20.718857765197754  GigaBytes
Max Memory Allocated: 21.351991653442383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3807373046875 GB
    Memory Allocated: 0.09883546829223633  GigaBytes
Max Memory Allocated: 21.351991653442383  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3807373046875 GB
    Memory Allocated: 20.411057949066162  GigaBytes
Max Memory Allocated: 21.351991653442383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3807373046875 GB
    Memory Allocated: 0.09922981262207031  GigaBytes
Max Memory Allocated: 21.351991653442383  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3807373046875 GB
    Memory Allocated: 21.362050533294678  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8416748046875 GB
    Memory Allocated: 0.09863853454589844  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 20.743746280670166  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1600341796875 GB
    Memory Allocated: 0.09877252578735352  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1600341796875 GB
    Memory Allocated: 20.582316875457764  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1600341796875 GB
    Memory Allocated: 0.09868812561035156  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2420654296875 GB
    Memory Allocated: 20.88951349258423  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 0.09904289245605469  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 21.16922378540039  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 0.09841156005859375  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 20.440805912017822  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 0.09825515747070312  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 20.217199325561523  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 0.09894132614135742  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3084716796875 GB
    Memory Allocated: 20.972060203552246  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.09861230850219727  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 20.768210411071777  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.09873247146606445  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 20.598393440246582  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.09900093078613281  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 20.889875888824463  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.09880447387695312  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 20.713735580444336  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.09842157363891602  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 20.425804138183594  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.09846115112304688  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 20.451826572418213  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.09880399703979492  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 20.95291805267334  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03658509999513626 |0.03527209162712097 |0.7291806638240814 |0.00010554492473602295 |1.2207503914833069 |0.017157793045043945 |
----------------------------------------------------------pseudo_mini_loss sum 5.384881973266602
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9161922
Number of first layer input nodes during this epoch:  4808838
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.13123846054077148  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02903270721435547
range selection method range initialization spend 0.01612377166748047
time for parepare:  0.01761651039123535
local_output_nid generation:  0.0009310245513916016
local_in_edges_tensor generation:  0.00850987434387207
mini_batch_src_global generation:  0.0021104812622070312
r_  generation:  0.011494636535644531
local_output_nid generation:  0.0010268688201904297
local_in_edges_tensor generation:  0.0007035732269287109
mini_batch_src_global generation:  0.0016055107116699219
r_  generation:  0.010257959365844727
local_output_nid generation:  0.0009477138519287109
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.001024484634399414
r_  generation:  0.009753942489624023
local_output_nid generation:  0.0009319782257080078
local_in_edges_tensor generation:  0.0005838871002197266
mini_batch_src_global generation:  0.0009915828704833984
r_  generation:  0.009553670883178711
local_output_nid generation:  0.000888824462890625
local_in_edges_tensor generation:  0.0005693435668945312
mini_batch_src_global generation:  0.0010344982147216797
r_  generation:  0.00937509536743164
local_output_nid generation:  0.0009067058563232422
local_in_edges_tensor generation:  0.0006318092346191406
mini_batch_src_global generation:  0.0010733604431152344
r_  generation:  0.01052403450012207
local_output_nid generation:  0.0008795261383056641
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0010471343994140625
r_  generation:  0.010070323944091797
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.0009975433349609375
r_  generation:  0.009711742401123047
local_output_nid generation:  0.0008866786956787109
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0010082721710205078
r_  generation:  0.009814262390136719
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0005536079406738281
mini_batch_src_global generation:  0.0012023448944091797
r_  generation:  0.01044154167175293
local_output_nid generation:  0.0008966922760009766
local_in_edges_tensor generation:  0.0005407333374023438
mini_batch_src_global generation:  0.0011014938354492188
r_  generation:  0.010503053665161133
local_output_nid generation:  0.0009009838104248047
local_in_edges_tensor generation:  0.0005328655242919922
mini_batch_src_global generation:  0.0010428428649902344
r_  generation:  0.010114669799804688
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005390644073486328
mini_batch_src_global generation:  0.001056671142578125
r_  generation:  0.010307073593139648
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005376338958740234
mini_batch_src_global generation:  0.0010492801666259766
r_  generation:  0.010180950164794922
local_output_nid generation:  0.0008511543273925781
local_in_edges_tensor generation:  0.0005586147308349609
mini_batch_src_global generation:  0.001085042953491211
r_  generation:  0.010039567947387695
local_output_nid generation:  0.0008563995361328125
local_in_edges_tensor generation:  0.0005443096160888672
mini_batch_src_global generation:  0.0010466575622558594
r_  generation:  0.010046958923339844
local_output_nid generation:  0.0008521080017089844
local_in_edges_tensor generation:  0.0005354881286621094
mini_batch_src_global generation:  0.0010614395141601562
r_  generation:  0.010178089141845703
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.0010352134704589844
r_  generation:  0.009825944900512695
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0005340576171875
mini_batch_src_global generation:  0.0010228157043457031
r_  generation:  0.010105371475219727
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0005238056182861328
mini_batch_src_global generation:  0.0010402202606201172
r_  generation:  0.009786844253540039
local_output_nid generation:  0.0008552074432373047
local_in_edges_tensor generation:  0.0005440711975097656
mini_batch_src_global generation:  0.0010421276092529297
r_  generation:  0.010111570358276367
local_output_nid generation:  0.0008411407470703125
local_in_edges_tensor generation:  0.0005288124084472656
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.009996175765991211
local_output_nid generation:  0.0008537769317626953
local_in_edges_tensor generation:  0.0005359649658203125
mini_batch_src_global generation:  0.0010340213775634766
r_  generation:  0.010319232940673828
local_output_nid generation:  0.0008895397186279297
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.001100778579711914
r_  generation:  0.010599136352539062
local_output_nid generation:  0.0008487701416015625
local_in_edges_tensor generation:  0.0006074905395507812
mini_batch_src_global generation:  0.0010952949523925781
r_  generation:  0.010167360305786133
local_output_nid generation:  0.0008466243743896484
local_in_edges_tensor generation:  0.0005509853363037109
mini_batch_src_global generation:  0.0010499954223632812
r_  generation:  0.010050296783447266
local_output_nid generation:  0.0008418560028076172
local_in_edges_tensor generation:  0.000606536865234375
mini_batch_src_global generation:  0.0010573863983154297
r_  generation:  0.010198831558227539
local_output_nid generation:  0.0008893013000488281
local_in_edges_tensor generation:  0.0005729198455810547
mini_batch_src_global generation:  0.0010671615600585938
r_  generation:  0.01005244255065918
local_output_nid generation:  0.0008487701416015625
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.00101470947265625
r_  generation:  0.010131597518920898
local_output_nid generation:  0.0008435249328613281
local_in_edges_tensor generation:  0.0005497932434082031
mini_batch_src_global generation:  0.0010819435119628906
r_  generation:  0.010023832321166992
local_output_nid generation:  0.0008370876312255859
local_in_edges_tensor generation:  0.0005991458892822266
mini_batch_src_global generation:  0.001110076904296875
r_  generation:  0.010204076766967773
local_output_nid generation:  0.0008523464202880859
local_in_edges_tensor generation:  0.0005576610565185547
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.010502338409423828
----------------------check_connections_block total spend ----------------------------- 0.5098495483398438
generate_one_block  0.02468132972717285
generate_one_block  0.02079486846923828
generate_one_block  0.01915454864501953
generate_one_block  0.018468856811523438
generate_one_block  0.018011093139648438
generate_one_block  0.019921541213989258
generate_one_block  0.018627643585205078
generate_one_block  0.018418312072753906
generate_one_block  0.018527746200561523
generate_one_block  0.01932072639465332
generate_one_block  0.019430160522460938
generate_one_block  0.01900506019592285
generate_one_block  0.0193026065826416
generate_one_block  0.018768787384033203
generate_one_block  0.018221616744995117
generate_one_block  0.018534421920776367
generate_one_block  0.01841282844543457
generate_one_block  0.018230676651000977
generate_one_block  0.018480300903320312
generate_one_block  0.018187284469604492
generate_one_block  0.018625974655151367
generate_one_block  0.018486976623535156
generate_one_block  0.019170522689819336
generate_one_block  0.019325733184814453
generate_one_block  0.01874399185180664
generate_one_block  0.018550395965576172
generate_one_block  0.018839597702026367
generate_one_block  0.018325328826904297
generate_one_block  0.018601417541503906
generate_one_block  0.018494367599487305
generate_one_block  0.023250579833984375
generate_one_block  0.0198056697845459
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04511308670043945
gen group dst list time:  0.025699377059936523
time for parepare:  0.02024364471435547
local_output_nid generation:  0.005375385284423828
local_in_edges_tensor generation:  0.01701807975769043
mini_batch_src_global generation:  0.018218278884887695
r_  generation:  0.15717220306396484
local_output_nid generation:  0.0075991153717041016
local_in_edges_tensor generation:  0.010889053344726562
mini_batch_src_global generation:  0.020721435546875
r_  generation:  0.16684532165527344
local_output_nid generation:  0.007710695266723633
local_in_edges_tensor generation:  0.029224634170532227
mini_batch_src_global generation:  0.01900506019592285
r_  generation:  0.16629290580749512
local_output_nid generation:  0.007926225662231445
local_in_edges_tensor generation:  0.011118650436401367
mini_batch_src_global generation:  0.01974344253540039
r_  generation:  0.1704261302947998
local_output_nid generation:  0.008196353912353516
local_in_edges_tensor generation:  0.008344411849975586
mini_batch_src_global generation:  0.020343542098999023
r_  generation:  0.17006826400756836
local_output_nid generation:  0.008855342864990234
local_in_edges_tensor generation:  0.009145975112915039
mini_batch_src_global generation:  0.023642778396606445
r_  generation:  0.18541836738586426
local_output_nid generation:  0.00835871696472168
local_in_edges_tensor generation:  0.00892019271850586
mini_batch_src_global generation:  0.02175164222717285
r_  generation:  0.1761317253112793
local_output_nid generation:  0.00821828842163086
local_in_edges_tensor generation:  0.010299921035766602
mini_batch_src_global generation:  0.021511316299438477
r_  generation:  0.17280817031860352
local_output_nid generation:  0.008597850799560547
local_in_edges_tensor generation:  0.011932134628295898
mini_batch_src_global generation:  0.0216066837310791
r_  generation:  0.18298983573913574
local_output_nid generation:  0.009074687957763672
local_in_edges_tensor generation:  0.010699748992919922
mini_batch_src_global generation:  0.024193286895751953
r_  generation:  0.18526029586791992
local_output_nid generation:  0.009385824203491211
local_in_edges_tensor generation:  0.01233363151550293
mini_batch_src_global generation:  0.024691104888916016
r_  generation:  0.18740558624267578
local_output_nid generation:  0.008977174758911133
local_in_edges_tensor generation:  0.00933074951171875
mini_batch_src_global generation:  0.023130178451538086
r_  generation:  0.1808919906616211
local_output_nid generation:  0.009205102920532227
local_in_edges_tensor generation:  0.009127378463745117
mini_batch_src_global generation:  0.023894786834716797
r_  generation:  0.18906617164611816
local_output_nid generation:  0.008956432342529297
local_in_edges_tensor generation:  0.009135246276855469
mini_batch_src_global generation:  0.022827863693237305
r_  generation:  0.17658615112304688
local_output_nid generation:  0.008899688720703125
local_in_edges_tensor generation:  0.009163379669189453
mini_batch_src_global generation:  0.022217988967895508
r_  generation:  0.1787703037261963
local_output_nid generation:  0.008974075317382812
local_in_edges_tensor generation:  0.012413501739501953
mini_batch_src_global generation:  0.023806095123291016
r_  generation:  0.18326091766357422
local_output_nid generation:  0.008913040161132812
local_in_edges_tensor generation:  0.010537862777709961
mini_batch_src_global generation:  0.022179841995239258
r_  generation:  0.1840052604675293
local_output_nid generation:  0.009904623031616211
local_in_edges_tensor generation:  0.014972925186157227
mini_batch_src_global generation:  0.025290489196777344
r_  generation:  0.17692041397094727
local_output_nid generation:  0.009064912796020508
local_in_edges_tensor generation:  0.010804891586303711
mini_batch_src_global generation:  0.02243804931640625
r_  generation:  0.18032431602478027
local_output_nid generation:  0.008695602416992188
local_in_edges_tensor generation:  0.00904703140258789
mini_batch_src_global generation:  0.02231454849243164
r_  generation:  0.17570996284484863
local_output_nid generation:  0.008662939071655273
local_in_edges_tensor generation:  0.009134054183959961
mini_batch_src_global generation:  0.022336483001708984
r_  generation:  0.17873096466064453
local_output_nid generation:  0.008646965026855469
local_in_edges_tensor generation:  0.013561487197875977
mini_batch_src_global generation:  0.022647380828857422
r_  generation:  0.18149638175964355
local_output_nid generation:  0.008825063705444336
local_in_edges_tensor generation:  0.00966024398803711
mini_batch_src_global generation:  0.02309727668762207
r_  generation:  0.18368768692016602
local_output_nid generation:  0.008912801742553711
local_in_edges_tensor generation:  0.012771844863891602
mini_batch_src_global generation:  0.023625850677490234
r_  generation:  0.18726515769958496
local_output_nid generation:  0.008711814880371094
local_in_edges_tensor generation:  0.009503841400146484
mini_batch_src_global generation:  0.023540735244750977
r_  generation:  0.18317246437072754
local_output_nid generation:  0.00871586799621582
local_in_edges_tensor generation:  0.010753393173217773
mini_batch_src_global generation:  0.022897720336914062
r_  generation:  0.18867254257202148
local_output_nid generation:  0.008810997009277344
local_in_edges_tensor generation:  0.012300729751586914
mini_batch_src_global generation:  0.024283885955810547
r_  generation:  0.18878936767578125
local_output_nid generation:  0.008504152297973633
local_in_edges_tensor generation:  0.00970911979675293
mini_batch_src_global generation:  0.022693157196044922
r_  generation:  0.17956089973449707
local_output_nid generation:  0.008748054504394531
local_in_edges_tensor generation:  0.009435892105102539
mini_batch_src_global generation:  0.02362203598022461
r_  generation:  0.18311715126037598
local_output_nid generation:  0.008668899536132812
local_in_edges_tensor generation:  0.009334802627563477
mini_batch_src_global generation:  0.022298336029052734
r_  generation:  0.181776762008667
local_output_nid generation:  0.00883340835571289
local_in_edges_tensor generation:  0.009663105010986328
mini_batch_src_global generation:  0.023196697235107422
r_  generation:  0.1825871467590332
local_output_nid generation:  0.008791685104370117
local_in_edges_tensor generation:  0.012365341186523438
mini_batch_src_global generation:  0.02421402931213379
r_  generation:  0.18473601341247559
----------------------check_connections_block total spend ----------------------------- 8.442214965820312
generate_one_block  0.24985814094543457
generate_one_block  0.24286198616027832
generate_one_block  0.24114036560058594
generate_one_block  0.24349713325500488
generate_one_block  0.26988887786865234
generate_one_block  0.2608962059020996
generate_one_block  0.24697566032409668
generate_one_block  0.2427353858947754
generate_one_block  0.24521279335021973
generate_one_block  0.2566184997558594
generate_one_block  0.25836777687072754
generate_one_block  0.2490382194519043
generate_one_block  0.25878477096557617
generate_one_block  0.24360179901123047
generate_one_block  0.2388899326324463
generate_one_block  0.2542564868927002
generate_one_block  0.24396181106567383
generate_one_block  0.24274063110351562
generate_one_block  0.24337983131408691
generate_one_block  0.24672627449035645
generate_one_block  0.24439215660095215
generate_one_block  0.2477889060974121
generate_one_block  0.254589319229126
generate_one_block  0.2638692855834961
generate_one_block  0.24843502044677734
generate_one_block  0.24530649185180664
generate_one_block  0.25400876998901367
generate_one_block  0.24205327033996582
generate_one_block  0.2468247413635254
generate_one_block  0.24602746963500977
generate_one_block  0.24789953231811523
generate_one_block  0.25235724449157715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06669807434082031
gen group dst list time:  0.10167169570922852
time for parepare:  0.01786184310913086
local_output_nid generation:  0.023796558380126953
local_in_edges_tensor generation:  0.05928516387939453
mini_batch_src_global generation:  0.049027204513549805
r_  generation:  0.4807243347167969
local_output_nid generation:  0.02945995330810547
local_in_edges_tensor generation:  0.04867982864379883
mini_batch_src_global generation:  0.057648658752441406
r_  generation:  0.4861633777618408
local_output_nid generation:  0.029708385467529297
local_in_edges_tensor generation:  0.035871267318725586
mini_batch_src_global generation:  0.057112693786621094
r_  generation:  0.49680280685424805
local_output_nid generation:  0.02786993980407715
local_in_edges_tensor generation:  0.03515338897705078
mini_batch_src_global generation:  0.057761192321777344
r_  generation:  0.48858165740966797
local_output_nid generation:  0.028140783309936523
local_in_edges_tensor generation:  0.03569817543029785
mini_batch_src_global generation:  0.061247825622558594
r_  generation:  0.4927189350128174
local_output_nid generation:  0.028519868850708008
local_in_edges_tensor generation:  0.03560209274291992
mini_batch_src_global generation:  0.062055110931396484
r_  generation:  0.49694013595581055
local_output_nid generation:  0.02828216552734375
local_in_edges_tensor generation:  0.030959129333496094
mini_batch_src_global generation:  0.058478593826293945
r_  generation:  0.49547910690307617
local_output_nid generation:  0.028618335723876953
local_in_edges_tensor generation:  0.03429222106933594
mini_batch_src_global generation:  0.059224605560302734
r_  generation:  0.4911348819732666
local_output_nid generation:  0.029130220413208008
local_in_edges_tensor generation:  0.045539140701293945
mini_batch_src_global generation:  0.05823874473571777
r_  generation:  0.498929500579834
local_output_nid generation:  0.028942584991455078
local_in_edges_tensor generation:  0.036408185958862305
mini_batch_src_global generation:  0.059942007064819336
r_  generation:  0.49454450607299805
local_output_nid generation:  0.0290529727935791
local_in_edges_tensor generation:  0.03623080253601074
mini_batch_src_global generation:  0.05868649482727051
r_  generation:  0.49970531463623047
local_output_nid generation:  0.02861928939819336
local_in_edges_tensor generation:  0.03178763389587402
mini_batch_src_global generation:  0.059148550033569336
r_  generation:  0.4921457767486572
local_output_nid generation:  0.028687238693237305
local_in_edges_tensor generation:  0.0317072868347168
mini_batch_src_global generation:  0.05785226821899414
r_  generation:  0.49648284912109375
local_output_nid generation:  0.028775930404663086
local_in_edges_tensor generation:  0.03153371810913086
mini_batch_src_global generation:  0.059617042541503906
r_  generation:  0.489438533782959
local_output_nid generation:  0.0284421443939209
local_in_edges_tensor generation:  0.034857988357543945
mini_batch_src_global generation:  0.057723045349121094
r_  generation:  0.49546003341674805
local_output_nid generation:  0.028644800186157227
local_in_edges_tensor generation:  0.04097270965576172
mini_batch_src_global generation:  0.061971426010131836
r_  generation:  0.4949347972869873
local_output_nid generation:  0.0288693904876709
local_in_edges_tensor generation:  0.040058135986328125
mini_batch_src_global generation:  0.05741453170776367
r_  generation:  0.5000228881835938
local_output_nid generation:  0.028670787811279297
local_in_edges_tensor generation:  0.03159213066101074
mini_batch_src_global generation:  0.06003165245056152
r_  generation:  0.49321722984313965
local_output_nid generation:  0.028715848922729492
local_in_edges_tensor generation:  0.03490400314331055
mini_batch_src_global generation:  0.057434797286987305
r_  generation:  0.4930605888366699
local_output_nid generation:  0.028861045837402344
local_in_edges_tensor generation:  0.03526496887207031
mini_batch_src_global generation:  0.05924797058105469
r_  generation:  0.4965784549713135
local_output_nid generation:  0.02866220474243164
local_in_edges_tensor generation:  0.040100812911987305
mini_batch_src_global generation:  0.05782628059387207
r_  generation:  0.49480462074279785
local_output_nid generation:  0.028828144073486328
local_in_edges_tensor generation:  0.04023551940917969
mini_batch_src_global generation:  0.058649539947509766
r_  generation:  0.4993622303009033
local_output_nid generation:  0.029250383377075195
local_in_edges_tensor generation:  0.04455399513244629
mini_batch_src_global generation:  0.05851435661315918
r_  generation:  0.500114917755127
local_output_nid generation:  0.029123783111572266
local_in_edges_tensor generation:  0.0352022647857666
mini_batch_src_global generation:  0.05919337272644043
r_  generation:  0.502007246017456
local_output_nid generation:  0.029486656188964844
local_in_edges_tensor generation:  0.03616213798522949
mini_batch_src_global generation:  0.06181693077087402
r_  generation:  0.49985814094543457
local_output_nid generation:  0.030722379684448242
local_in_edges_tensor generation:  0.03138327598571777
mini_batch_src_global generation:  0.05909848213195801
r_  generation:  0.493302583694458
local_output_nid generation:  0.028828144073486328
local_in_edges_tensor generation:  0.03215813636779785
mini_batch_src_global generation:  0.05816149711608887
r_  generation:  0.5025582313537598
local_output_nid generation:  0.028980016708374023
local_in_edges_tensor generation:  0.03533291816711426
mini_batch_src_global generation:  0.05887889862060547
r_  generation:  0.49544835090637207
local_output_nid generation:  0.028754472732543945
local_in_edges_tensor generation:  0.03584718704223633
mini_batch_src_global generation:  0.05787372589111328
r_  generation:  0.49737071990966797
local_output_nid generation:  0.029000282287597656
local_in_edges_tensor generation:  0.03210592269897461
mini_batch_src_global generation:  0.059113264083862305
r_  generation:  0.49852919578552246
local_output_nid generation:  0.0288393497467041
local_in_edges_tensor generation:  0.03593754768371582
mini_batch_src_global generation:  0.0582730770111084
r_  generation:  0.49764442443847656
local_output_nid generation:  0.02883458137512207
local_in_edges_tensor generation:  0.03577113151550293
mini_batch_src_global generation:  0.059613704681396484
r_  generation:  0.4977288246154785
----------------------check_connections_block total spend ----------------------------- 23.270326614379883
generate_one_block  0.6839704513549805
generate_one_block  0.6950738430023193
generate_one_block  0.661787748336792
generate_one_block  0.671506404876709
generate_one_block  0.7627475261688232
generate_one_block  0.6802747249603271
generate_one_block  0.670562744140625
generate_one_block  0.682265043258667
generate_one_block  0.6800875663757324
generate_one_block  0.6869039535522461
generate_one_block  0.6845779418945312
generate_one_block  0.6635501384735107
generate_one_block  0.666633129119873
generate_one_block  0.6693160533905029
generate_one_block  0.6698925495147705
generate_one_block  0.6808595657348633
generate_one_block  0.6865394115447998
generate_one_block  0.6628074645996094
generate_one_block  0.6728401184082031
generate_one_block  0.6841821670532227
generate_one_block  0.672184944152832
generate_one_block  0.6940491199493408
generate_one_block  0.6900246143341064
generate_one_block  0.669978141784668
generate_one_block  0.7011804580688477
generate_one_block  0.6667778491973877
generate_one_block  0.6669073104858398
generate_one_block  0.6786339282989502
generate_one_block  0.6762294769287109
generate_one_block  0.675450325012207
generate_one_block  0.6804237365722656
generate_one_block  0.6701595783233643
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.13123846054077148  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

connection checking time:  31.712541580200195
block generation total time  29.73136281967163
average batch blocks generation time:  0.9291050881147385
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.10931873321533203  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 20.636112689971924  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.1091313362121582  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 20.72721767425537  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.10929632186889648  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 20.545201301574707  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.1083984375  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 20.501778602600098  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.10900402069091797  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 20.404800415039062  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3104248046875 GB
    Memory Allocated: 0.10944843292236328  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3201904296875 GB
    Memory Allocated: 21.278910160064697  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.10898303985595703  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 20.590635299682617  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10924148559570312  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 20.53830099105835  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1131591796875 GB
    Memory Allocated: 0.10962390899658203  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2088623046875 GB
    Memory Allocated: 20.733357429504395  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10949373245239258  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2576904296875 GB
    Memory Allocated: 21.127535820007324  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2596435546875 GB
    Memory Allocated: 0.10959339141845703  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 21.187030792236328  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1090841293334961  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.776241779327393  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10928583145141602  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.231966495513916  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1090693473815918  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.53096294403076  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1088399887084961  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.473556518554688  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10942411422729492  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.815724849700928  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10923242568969727  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.625000476837158  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10894536972045898  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.547468185424805  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10901927947998047  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.588635444641113  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1092066764831543  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.577287673950195  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10919427871704102  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.619327545166016  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10952186584472656  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.794901371002197  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10952377319335938  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.000280380249023  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10937643051147461  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.240164279937744  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1095118522644043  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.94043207168579  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10912656784057617  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.802088260650635  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10932445526123047  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.04880666732788  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10929632186889648  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.69524574279785  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10913753509521484  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.754322052001953  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10944271087646484  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.71697998046875  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10918140411376953  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.80257272720337  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10910367965698242  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.895366668701172  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028550267219543457 |0.02350424975156784 |0.6348337903618813 |9.766966104507446e-05 |1.2007776200771332 |0.004212856292724609 |
----------------------------------------------------------pseudo_mini_loss sum 3.943340539932251
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9163334
Number of first layer input nodes during this epoch:  4808798
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.13176918029785156  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025830507278442383
range selection method range initialization spend 0.01419830322265625
time for parepare:  0.019680023193359375
local_output_nid generation:  0.0009522438049316406
local_in_edges_tensor generation:  0.00833892822265625
mini_batch_src_global generation:  0.0014374256134033203
r_  generation:  0.010347604751586914
local_output_nid generation:  0.0009930133819580078
local_in_edges_tensor generation:  0.0006723403930664062
mini_batch_src_global generation:  0.0015194416046142578
r_  generation:  0.010059118270874023
local_output_nid generation:  0.0009438991546630859
local_in_edges_tensor generation:  0.0006282329559326172
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.009657859802246094
local_output_nid generation:  0.0009136199951171875
local_in_edges_tensor generation:  0.0005831718444824219
mini_batch_src_global generation:  0.0010721683502197266
r_  generation:  0.010005712509155273
local_output_nid generation:  0.0008840560913085938
local_in_edges_tensor generation:  0.0005719661712646484
mini_batch_src_global generation:  0.0010557174682617188
r_  generation:  0.0096893310546875
local_output_nid generation:  0.0009009838104248047
local_in_edges_tensor generation:  0.00055694580078125
mini_batch_src_global generation:  0.0010325908660888672
r_  generation:  0.009781837463378906
local_output_nid generation:  0.0008757114410400391
local_in_edges_tensor generation:  0.0005795955657958984
mini_batch_src_global generation:  0.0010747909545898438
r_  generation:  0.010088920593261719
local_output_nid generation:  0.0008792877197265625
local_in_edges_tensor generation:  0.000545501708984375
mini_batch_src_global generation:  0.0010764598846435547
r_  generation:  0.009862661361694336
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.001157522201538086
r_  generation:  0.010535240173339844
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.010099172592163086
local_output_nid generation:  0.0008838176727294922
local_in_edges_tensor generation:  0.0005614757537841797
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.01032400131225586
local_output_nid generation:  0.0009195804595947266
local_in_edges_tensor generation:  0.0005495548248291016
mini_batch_src_global generation:  0.001065969467163086
r_  generation:  0.009862422943115234
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.000579833984375
mini_batch_src_global generation:  0.0012042522430419922
r_  generation:  0.010327816009521484
local_output_nid generation:  0.0008833408355712891
local_in_edges_tensor generation:  0.0005652904510498047
mini_batch_src_global generation:  0.0011470317840576172
r_  generation:  0.010417699813842773
local_output_nid generation:  0.0008614063262939453
local_in_edges_tensor generation:  0.0005593299865722656
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.010372638702392578
local_output_nid generation:  0.0008790493011474609
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.00116729736328125
r_  generation:  0.01015472412109375
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0005991458892822266
mini_batch_src_global generation:  0.001119852066040039
r_  generation:  0.009966373443603516
local_output_nid generation:  0.0008614063262939453
local_in_edges_tensor generation:  0.0005736351013183594
mini_batch_src_global generation:  0.0011026859283447266
r_  generation:  0.010059118270874023
local_output_nid generation:  0.0008606910705566406
local_in_edges_tensor generation:  0.0005619525909423828
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.010441303253173828
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0011124610900878906
r_  generation:  0.009956598281860352
local_output_nid generation:  0.0008563995361328125
local_in_edges_tensor generation:  0.0005371570587158203
mini_batch_src_global generation:  0.0010561943054199219
r_  generation:  0.009847402572631836
local_output_nid generation:  0.0008485317230224609
local_in_edges_tensor generation:  0.0005505084991455078
mini_batch_src_global generation:  0.0010590553283691406
r_  generation:  0.009969949722290039
local_output_nid generation:  0.0008413791656494141
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.010299444198608398
local_output_nid generation:  0.0008473396301269531
local_in_edges_tensor generation:  0.0005609989166259766
mini_batch_src_global generation:  0.0011985301971435547
r_  generation:  0.010079622268676758
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0005612373352050781
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.010025262832641602
local_output_nid generation:  0.0008513927459716797
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.01056671142578125
local_output_nid generation:  0.0008494853973388672
local_in_edges_tensor generation:  0.0005831718444824219
mini_batch_src_global generation:  0.0011970996856689453
r_  generation:  0.010650873184204102
local_output_nid generation:  0.0008528232574462891
local_in_edges_tensor generation:  0.0005829334259033203
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.010350227355957031
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005583763122558594
mini_batch_src_global generation:  0.0010845661163330078
r_  generation:  0.009899616241455078
local_output_nid generation:  0.0008695125579833984
local_in_edges_tensor generation:  0.0005595684051513672
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.009790182113647461
local_output_nid generation:  0.0008580684661865234
local_in_edges_tensor generation:  0.0005476474761962891
mini_batch_src_global generation:  0.001108407974243164
r_  generation:  0.010208606719970703
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.010212898254394531
----------------------check_connections_block total spend ----------------------------- 0.5128114223480225
generate_one_block  0.0247037410736084
generate_one_block  0.02045154571533203
generate_one_block  0.01913928985595703
generate_one_block  0.019425153732299805
generate_one_block  0.01852250099182129
generate_one_block  0.018483877182006836
generate_one_block  0.01876544952392578
generate_one_block  0.018262863159179688
generate_one_block  0.01962423324584961
generate_one_block  0.018591642379760742
generate_one_block  0.01907181739807129
generate_one_block  0.018018245697021484
generate_one_block  0.01926445960998535
generate_one_block  0.018973588943481445
generate_one_block  0.01872396469116211
generate_one_block  0.01849055290222168
generate_one_block  0.018363475799560547
generate_one_block  0.018263816833496094
generate_one_block  0.019102811813354492
generate_one_block  0.018006563186645508
generate_one_block  0.01814436912536621
generate_one_block  0.017998695373535156
generate_one_block  0.018770217895507812
generate_one_block  0.018534183502197266
generate_one_block  0.018280982971191406
generate_one_block  0.01909661293029785
generate_one_block  0.019253969192504883
generate_one_block  0.01875138282775879
generate_one_block  0.01813530921936035
generate_one_block  0.01795506477355957
generate_one_block  0.018537282943725586
generate_one_block  0.018820762634277344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03841352462768555
gen group dst list time:  0.022429704666137695
time for parepare:  0.019685745239257812
local_output_nid generation:  0.005311250686645508
local_in_edges_tensor generation:  0.017963171005249023
mini_batch_src_global generation:  0.017030954360961914
r_  generation:  0.15343928337097168
local_output_nid generation:  0.007597208023071289
local_in_edges_tensor generation:  0.015006780624389648
mini_batch_src_global generation:  0.024077653884887695
r_  generation:  0.1647641658782959
local_output_nid generation:  0.007895469665527344
local_in_edges_tensor generation:  0.02914261817932129
mini_batch_src_global generation:  0.021696805953979492
r_  generation:  0.16903066635131836
local_output_nid generation:  0.00847625732421875
local_in_edges_tensor generation:  0.011873006820678711
mini_batch_src_global generation:  0.023077964782714844
r_  generation:  0.17776846885681152
local_output_nid generation:  0.008492708206176758
local_in_edges_tensor generation:  0.008554458618164062
mini_batch_src_global generation:  0.021311283111572266
r_  generation:  0.17347264289855957
local_output_nid generation:  0.008515596389770508
local_in_edges_tensor generation:  0.008478641510009766
mini_batch_src_global generation:  0.021666526794433594
r_  generation:  0.17488741874694824
local_output_nid generation:  0.008681058883666992
local_in_edges_tensor generation:  0.008417367935180664
mini_batch_src_global generation:  0.02233433723449707
r_  generation:  0.18023276329040527
local_output_nid generation:  0.008432865142822266
local_in_edges_tensor generation:  0.008461713790893555
mini_batch_src_global generation:  0.022284507751464844
r_  generation:  0.17709827423095703
local_output_nid generation:  0.009264230728149414
local_in_edges_tensor generation:  0.008771181106567383
mini_batch_src_global generation:  0.023074626922607422
r_  generation:  0.18687796592712402
local_output_nid generation:  0.008888721466064453
local_in_edges_tensor generation:  0.009186029434204102
mini_batch_src_global generation:  0.02273249626159668
r_  generation:  0.1782853603363037
local_output_nid generation:  0.008980751037597656
local_in_edges_tensor generation:  0.008922576904296875
mini_batch_src_global generation:  0.02386331558227539
r_  generation:  0.18466901779174805
local_output_nid generation:  0.008610725402832031
local_in_edges_tensor generation:  0.009581565856933594
mini_batch_src_global generation:  0.02213883399963379
r_  generation:  0.17235302925109863
local_output_nid generation:  0.00923919677734375
local_in_edges_tensor generation:  0.008852958679199219
mini_batch_src_global generation:  0.03278088569641113
r_  generation:  0.18885231018066406
local_output_nid generation:  0.010362625122070312
local_in_edges_tensor generation:  0.008893013000488281
mini_batch_src_global generation:  0.022954702377319336
r_  generation:  0.18274664878845215
local_output_nid generation:  0.00941777229309082
local_in_edges_tensor generation:  0.010296344757080078
mini_batch_src_global generation:  0.022843599319458008
r_  generation:  0.18143916130065918
local_output_nid generation:  0.009178638458251953
local_in_edges_tensor generation:  0.008858680725097656
mini_batch_src_global generation:  0.02271246910095215
r_  generation:  0.1786191463470459
local_output_nid generation:  0.009250879287719727
local_in_edges_tensor generation:  0.008682727813720703
mini_batch_src_global generation:  0.022034406661987305
r_  generation:  0.17775416374206543
local_output_nid generation:  0.009174823760986328
local_in_edges_tensor generation:  0.008594036102294922
mini_batch_src_global generation:  0.0225980281829834
r_  generation:  0.17779827117919922
local_output_nid generation:  0.009688615798950195
local_in_edges_tensor generation:  0.008899688720703125
mini_batch_src_global generation:  0.024061918258666992
r_  generation:  0.1869959831237793
local_output_nid generation:  0.009083747863769531
local_in_edges_tensor generation:  0.00963735580444336
mini_batch_src_global generation:  0.030767202377319336
r_  generation:  0.17725896835327148
local_output_nid generation:  0.009017467498779297
local_in_edges_tensor generation:  0.008899211883544922
mini_batch_src_global generation:  0.022247314453125
r_  generation:  0.17850470542907715
local_output_nid generation:  0.009067058563232422
local_in_edges_tensor generation:  0.008682012557983398
mini_batch_src_global generation:  0.021808862686157227
r_  generation:  0.17512869834899902
local_output_nid generation:  0.009435176849365234
local_in_edges_tensor generation:  0.010141611099243164
mini_batch_src_global generation:  0.02256631851196289
r_  generation:  0.1818842887878418
local_output_nid generation:  0.00937652587890625
local_in_edges_tensor generation:  0.010469675064086914
mini_batch_src_global generation:  0.022481203079223633
r_  generation:  0.1773362159729004
local_output_nid generation:  0.009305715560913086
local_in_edges_tensor generation:  0.008556842803955078
mini_batch_src_global generation:  0.022467374801635742
r_  generation:  0.180511474609375
local_output_nid generation:  0.009611368179321289
local_in_edges_tensor generation:  0.010466814041137695
mini_batch_src_global generation:  0.023548603057861328
r_  generation:  0.1869649887084961
local_output_nid generation:  0.009711980819702148
local_in_edges_tensor generation:  0.009984016418457031
mini_batch_src_global generation:  0.024616718292236328
r_  generation:  0.18957924842834473
local_output_nid generation:  0.009217262268066406
local_in_edges_tensor generation:  0.008898258209228516
mini_batch_src_global generation:  0.023583412170410156
r_  generation:  0.18722820281982422
local_output_nid generation:  0.008703470230102539
local_in_edges_tensor generation:  0.008798599243164062
mini_batch_src_global generation:  0.022322416305541992
r_  generation:  0.1779782772064209
local_output_nid generation:  0.008873224258422852
local_in_edges_tensor generation:  0.008675575256347656
mini_batch_src_global generation:  0.024888992309570312
r_  generation:  0.17802667617797852
local_output_nid generation:  0.008906841278076172
local_in_edges_tensor generation:  0.009563684463500977
mini_batch_src_global generation:  0.022416114807128906
r_  generation:  0.18164300918579102
local_output_nid generation:  0.009024381637573242
local_in_edges_tensor generation:  0.009562015533447266
mini_batch_src_global generation:  0.022706985473632812
r_  generation:  0.1835193634033203
----------------------check_connections_block total spend ----------------------------- 8.397815942764282
generate_one_block  0.24008584022521973
generate_one_block  0.23746871948242188
generate_one_block  0.24030423164367676
generate_one_block  0.24800682067871094
generate_one_block  0.26738500595092773
generate_one_block  0.24492502212524414
generate_one_block  0.24721479415893555
generate_one_block  0.24187040328979492
generate_one_block  0.25013256072998047
generate_one_block  0.24489188194274902
generate_one_block  0.2488563060760498
generate_one_block  0.23593378067016602
generate_one_block  0.25073719024658203
generate_one_block  0.24930047988891602
generate_one_block  0.2433774471282959
generate_one_block  0.24079060554504395
generate_one_block  0.23600220680236816
generate_one_block  0.2378697395324707
generate_one_block  0.25162458419799805
generate_one_block  0.23943781852722168
generate_one_block  0.24047589302062988
generate_one_block  0.23491549491882324
generate_one_block  0.24510407447814941
generate_one_block  0.2404022216796875
generate_one_block  0.2418520450592041
generate_one_block  0.25325798988342285
generate_one_block  0.2537529468536377
generate_one_block  0.2510104179382324
generate_one_block  0.23734760284423828
generate_one_block  0.23750066757202148
generate_one_block  0.23968052864074707
generate_one_block  0.24460315704345703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04587435722351074
gen group dst list time:  0.10422134399414062
time for parepare:  0.01874375343322754
local_output_nid generation:  0.02373337745666504
local_in_edges_tensor generation:  0.043424129486083984
mini_batch_src_global generation:  0.044313907623291016
r_  generation:  0.4868454933166504
local_output_nid generation:  0.029911279678344727
local_in_edges_tensor generation:  0.04055619239807129
mini_batch_src_global generation:  0.05936694145202637
r_  generation:  0.48756837844848633
local_output_nid generation:  0.028657197952270508
local_in_edges_tensor generation:  0.03402304649353027
mini_batch_src_global generation:  0.057306766510009766
r_  generation:  0.49787282943725586
local_output_nid generation:  0.02960062026977539
local_in_edges_tensor generation:  0.03313946723937988
mini_batch_src_global generation:  0.0588221549987793
r_  generation:  0.4924447536468506
local_output_nid generation:  0.029215335845947266
local_in_edges_tensor generation:  0.031336307525634766
mini_batch_src_global generation:  0.058144330978393555
r_  generation:  0.49927306175231934
local_output_nid generation:  0.02886223793029785
local_in_edges_tensor generation:  0.027779102325439453
mini_batch_src_global generation:  0.0623173713684082
r_  generation:  0.49350643157958984
local_output_nid generation:  0.02895498275756836
local_in_edges_tensor generation:  0.03515958786010742
mini_batch_src_global generation:  0.059218406677246094
r_  generation:  0.5014750957489014
local_output_nid generation:  0.028833627700805664
local_in_edges_tensor generation:  0.028791189193725586
mini_batch_src_global generation:  0.05982327461242676
r_  generation:  0.4959678649902344
local_output_nid generation:  0.028837203979492188
local_in_edges_tensor generation:  0.03061985969543457
mini_batch_src_global generation:  0.06210064888000488
r_  generation:  0.500786304473877
local_output_nid generation:  0.0287477970123291
local_in_edges_tensor generation:  0.030976295471191406
mini_batch_src_global generation:  0.06023454666137695
r_  generation:  0.49846982955932617
local_output_nid generation:  0.029544591903686523
local_in_edges_tensor generation:  0.032097816467285156
mini_batch_src_global generation:  0.05997824668884277
r_  generation:  0.503741979598999
local_output_nid generation:  0.029195547103881836
local_in_edges_tensor generation:  0.03366208076477051
mini_batch_src_global generation:  0.05987691879272461
r_  generation:  0.4894893169403076
local_output_nid generation:  0.029160737991333008
local_in_edges_tensor generation:  0.034633636474609375
mini_batch_src_global generation:  0.06095623970031738
r_  generation:  0.4976532459259033
local_output_nid generation:  0.029149770736694336
local_in_edges_tensor generation:  0.02867889404296875
mini_batch_src_global generation:  0.06034088134765625
r_  generation:  0.4909665584564209
local_output_nid generation:  0.029060840606689453
local_in_edges_tensor generation:  0.029682397842407227
mini_batch_src_global generation:  0.05888819694519043
r_  generation:  0.49941349029541016
local_output_nid generation:  0.029244422912597656
local_in_edges_tensor generation:  0.031056642532348633
mini_batch_src_global generation:  0.060355424880981445
r_  generation:  0.494351863861084
local_output_nid generation:  0.02923893928527832
local_in_edges_tensor generation:  0.028096675872802734
mini_batch_src_global generation:  0.05911064147949219
r_  generation:  0.49721598625183105
local_output_nid generation:  0.02942943572998047
local_in_edges_tensor generation:  0.030876874923706055
mini_batch_src_global generation:  0.06218314170837402
r_  generation:  0.49251842498779297
local_output_nid generation:  0.029500722885131836
local_in_edges_tensor generation:  0.032591819763183594
mini_batch_src_global generation:  0.05930590629577637
r_  generation:  0.5009288787841797
local_output_nid generation:  0.029070377349853516
local_in_edges_tensor generation:  0.03501272201538086
mini_batch_src_global generation:  0.05980539321899414
r_  generation:  0.4878866672515869
local_output_nid generation:  0.02922368049621582
local_in_edges_tensor generation:  0.029173612594604492
mini_batch_src_global generation:  0.05890178680419922
r_  generation:  0.49613213539123535
local_output_nid generation:  0.028715848922729492
local_in_edges_tensor generation:  0.03184366226196289
mini_batch_src_global generation:  0.05999898910522461
r_  generation:  0.4938490390777588
local_output_nid generation:  0.02860546112060547
local_in_edges_tensor generation:  0.02848196029663086
mini_batch_src_global generation:  0.05881190299987793
r_  generation:  0.4932732582092285
local_output_nid generation:  0.02879929542541504
local_in_edges_tensor generation:  0.030439376831054688
mini_batch_src_global generation:  0.05992436408996582
r_  generation:  0.4982733726501465
local_output_nid generation:  0.028954744338989258
local_in_edges_tensor generation:  0.02964496612548828
mini_batch_src_global generation:  0.05910181999206543
r_  generation:  0.4960954189300537
local_output_nid generation:  0.02917623519897461
local_in_edges_tensor generation:  0.03423142433166504
mini_batch_src_global generation:  0.05993032455444336
r_  generation:  0.5074772834777832
local_output_nid generation:  0.030694961547851562
local_in_edges_tensor generation:  0.03228044509887695
mini_batch_src_global generation:  0.06086111068725586
r_  generation:  0.5019819736480713
local_output_nid generation:  0.0294649600982666
local_in_edges_tensor generation:  0.03278970718383789
mini_batch_src_global generation:  0.06209373474121094
r_  generation:  0.49465298652648926
local_output_nid generation:  0.029126405715942383
local_in_edges_tensor generation:  0.029590129852294922
mini_batch_src_global generation:  0.05871391296386719
r_  generation:  0.500873327255249
local_output_nid generation:  0.029348373413085938
local_in_edges_tensor generation:  0.03155684471130371
mini_batch_src_global generation:  0.059740543365478516
r_  generation:  0.49529147148132324
local_output_nid generation:  0.029278278350830078
local_in_edges_tensor generation:  0.031147003173828125
mini_batch_src_global generation:  0.058834075927734375
r_  generation:  0.5030133724212646
local_output_nid generation:  0.029506444931030273
local_in_edges_tensor generation:  0.02860236167907715
mini_batch_src_global generation:  0.06054282188415527
r_  generation:  0.49411535263061523
----------------------check_connections_block total spend ----------------------------- 23.22363591194153
generate_one_block  0.6894528865814209
generate_one_block  0.669529914855957
generate_one_block  0.6692891120910645
generate_one_block  0.685523271560669
generate_one_block  0.7558586597442627
generate_one_block  0.6709411144256592
generate_one_block  0.6826357841491699
generate_one_block  0.6848561763763428
generate_one_block  0.6858925819396973
generate_one_block  0.6745946407318115
generate_one_block  0.6790421009063721
generate_one_block  0.6786646842956543
generate_one_block  0.6709463596343994
generate_one_block  0.6783597469329834
generate_one_block  0.6786105632781982
generate_one_block  0.6726474761962891
generate_one_block  0.6784701347351074
generate_one_block  0.6740105152130127
generate_one_block  0.6788187026977539
generate_one_block  0.6643562316894531
generate_one_block  0.6694216728210449
generate_one_block  0.6601324081420898
generate_one_block  0.6676459312438965
generate_one_block  0.6723659038543701
generate_one_block  0.7125809192657471
generate_one_block  0.6966791152954102
generate_one_block  0.6783502101898193
generate_one_block  0.699603796005249
generate_one_block  0.6664721965789795
generate_one_block  0.6915910243988037
generate_one_block  0.6746726036071777
generate_one_block  0.6819667816162109
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.13176918029785156  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

connection checking time:  31.62145185470581
block generation total time  29.6101016998291
average batch blocks generation time:  0.9253156781196594
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10897684097290039  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.44146966934204  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1092672348022461  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.63730478286743  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.109039306640625  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.705888748168945  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1095438003540039  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.086009979248047  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10944366455078125  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.75881338119507  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10917139053344727  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.722649097442627  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10948514938354492  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.017351627349854  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10904550552368164  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.764764308929443  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10961103439331055  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.216213703155518  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10924339294433594  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.771080017089844  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10956764221191406  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.095581531524658  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1089639663696289  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.40597629547119  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10927963256835938  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.196335315704346  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10935831069946289  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.012142181396484  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10929346084594727  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.8466215133667  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1091771125793457  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.694831371307373  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1091609001159668  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.530724048614502  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10896825790405273  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.55968189239502  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10927486419677734  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.118855953216553  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10893869400024414  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.447596073150635  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10923051834106445  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.64010524749756  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10865640640258789  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.318235874176025  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10907697677612305  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.74156141281128  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10896062850952148  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.565780639648438  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10932636260986328  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.676312923431396  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10924196243286133  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.15311336517334  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.1094517707824707  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.18924903869629  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10951042175292969  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.094804763793945  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10906219482421875  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.514615535736084  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10908031463623047  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.607675552368164  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10898828506469727  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.62531614303589  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10927200317382812  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.867850303649902  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029087774455547333 |0.024616561830043793 |0.6306932121515274 |9.6149742603302e-05 |1.196544237434864 |0.004842281341552734 |
----------------------------------------------------------pseudo_mini_loss sum 3.486438512802124
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  9159427
Number of first layer input nodes during this epoch:  4807343
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.13153600692749023  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02596306800842285
range selection method range initialization spend 0.016809463500976562
time for parepare:  0.02094864845275879
local_output_nid generation:  0.0009489059448242188
local_in_edges_tensor generation:  0.004799604415893555
mini_batch_src_global generation:  0.003022909164428711
r_  generation:  0.016870737075805664
local_output_nid generation:  0.0014204978942871094
local_in_edges_tensor generation:  0.0007946491241455078
mini_batch_src_global generation:  0.002019166946411133
r_  generation:  0.011099815368652344
local_output_nid generation:  0.0012257099151611328
local_in_edges_tensor generation:  0.0007283687591552734
mini_batch_src_global generation:  0.0014879703521728516
r_  generation:  0.010272741317749023
local_output_nid generation:  0.0012421607971191406
local_in_edges_tensor generation:  0.0006806850433349609
mini_batch_src_global generation:  0.0014786720275878906
r_  generation:  0.009833574295043945
local_output_nid generation:  0.0011663436889648438
local_in_edges_tensor generation:  0.0007050037384033203
mini_batch_src_global generation:  0.0014278888702392578
r_  generation:  0.010432243347167969
local_output_nid generation:  0.0011279582977294922
local_in_edges_tensor generation:  0.0006842613220214844
mini_batch_src_global generation:  0.001512765884399414
r_  generation:  0.010596513748168945
local_output_nid generation:  0.0011780261993408203
local_in_edges_tensor generation:  0.0006594657897949219
mini_batch_src_global generation:  0.0013475418090820312
r_  generation:  0.010305166244506836
local_output_nid generation:  0.0011637210845947266
local_in_edges_tensor generation:  0.0006701946258544922
mini_batch_src_global generation:  0.0013451576232910156
r_  generation:  0.010587692260742188
local_output_nid generation:  0.0011112689971923828
local_in_edges_tensor generation:  0.0006413459777832031
mini_batch_src_global generation:  0.001291036605834961
r_  generation:  0.010198116302490234
local_output_nid generation:  0.0010993480682373047
local_in_edges_tensor generation:  0.0006573200225830078
mini_batch_src_global generation:  0.0013306140899658203
r_  generation:  0.01034402847290039
local_output_nid generation:  0.0011205673217773438
local_in_edges_tensor generation:  0.0006844997406005859
mini_batch_src_global generation:  0.0013804435729980469
r_  generation:  0.011199712753295898
local_output_nid generation:  0.0011203289031982422
local_in_edges_tensor generation:  0.0006361007690429688
mini_batch_src_global generation:  0.0012805461883544922
r_  generation:  0.010317802429199219
local_output_nid generation:  0.0011076927185058594
local_in_edges_tensor generation:  0.0006575584411621094
mini_batch_src_global generation:  0.001329183578491211
r_  generation:  0.010681390762329102
local_output_nid generation:  0.0010857582092285156
local_in_edges_tensor generation:  0.00064849853515625
mini_batch_src_global generation:  0.0013148784637451172
r_  generation:  0.0106048583984375
local_output_nid generation:  0.0010924339294433594
local_in_edges_tensor generation:  0.0006234645843505859
mini_batch_src_global generation:  0.0014767646789550781
r_  generation:  0.010493993759155273
local_output_nid generation:  0.0010790824890136719
local_in_edges_tensor generation:  0.0006384849548339844
mini_batch_src_global generation:  0.0013988018035888672
r_  generation:  0.010080575942993164
local_output_nid generation:  0.0010898113250732422
local_in_edges_tensor generation:  0.00066375732421875
mini_batch_src_global generation:  0.0012729167938232422
r_  generation:  0.010458946228027344
local_output_nid generation:  0.0010988712310791016
local_in_edges_tensor generation:  0.0006570816040039062
mini_batch_src_global generation:  0.0014238357543945312
r_  generation:  0.010158061981201172
local_output_nid generation:  0.001081705093383789
local_in_edges_tensor generation:  0.0006563663482666016
mini_batch_src_global generation:  0.0013222694396972656
r_  generation:  0.010115861892700195
local_output_nid generation:  0.0010640621185302734
local_in_edges_tensor generation:  0.0006678104400634766
mini_batch_src_global generation:  0.0013592243194580078
r_  generation:  0.010988473892211914
local_output_nid generation:  0.0010881423950195312
local_in_edges_tensor generation:  0.0006420612335205078
mini_batch_src_global generation:  0.0013117790222167969
r_  generation:  0.010486364364624023
local_output_nid generation:  0.0010917186737060547
local_in_edges_tensor generation:  0.0006585121154785156
mini_batch_src_global generation:  0.0013282299041748047
r_  generation:  0.010279417037963867
local_output_nid generation:  0.0011010169982910156
local_in_edges_tensor generation:  0.0006287097930908203
mini_batch_src_global generation:  0.0013949871063232422
r_  generation:  0.010371923446655273
local_output_nid generation:  0.0010921955108642578
local_in_edges_tensor generation:  0.0006611347198486328
mini_batch_src_global generation:  0.001346588134765625
r_  generation:  0.010621070861816406
local_output_nid generation:  0.0010790824890136719
local_in_edges_tensor generation:  0.0006282329559326172
mini_batch_src_global generation:  0.0014128684997558594
r_  generation:  0.010446786880493164
local_output_nid generation:  0.0010669231414794922
local_in_edges_tensor generation:  0.0006432533264160156
mini_batch_src_global generation:  0.0013132095336914062
r_  generation:  0.010805606842041016
local_output_nid generation:  0.0010399818420410156
local_in_edges_tensor generation:  0.0006685256958007812
mini_batch_src_global generation:  0.0015397071838378906
r_  generation:  0.010943174362182617
local_output_nid generation:  0.0010707378387451172
local_in_edges_tensor generation:  0.0006382465362548828
mini_batch_src_global generation:  0.0013804435729980469
r_  generation:  0.01041865348815918
local_output_nid generation:  0.0010595321655273438
local_in_edges_tensor generation:  0.0006361007690429688
mini_batch_src_global generation:  0.0013539791107177734
r_  generation:  0.010410785675048828
local_output_nid generation:  0.0010542869567871094
local_in_edges_tensor generation:  0.0006301403045654297
mini_batch_src_global generation:  0.0013384819030761719
r_  generation:  0.010464191436767578
local_output_nid generation:  0.0010449886322021484
local_in_edges_tensor generation:  0.0006103515625
mini_batch_src_global generation:  0.0013163089752197266
r_  generation:  0.01057744026184082
local_output_nid generation:  0.0010311603546142578
local_in_edges_tensor generation:  0.0006399154663085938
mini_batch_src_global generation:  0.0013015270233154297
r_  generation:  0.010402917861938477
----------------------check_connections_block total spend ----------------------------- 0.5609347820281982
generate_one_block  0.030209064483642578
generate_one_block  0.020395278930664062
generate_one_block  0.01993417739868164
generate_one_block  0.018465280532836914
generate_one_block  0.01950693130493164
generate_one_block  0.01947617530822754
generate_one_block  0.0186464786529541
generate_one_block  0.01905679702758789
generate_one_block  0.019780635833740234
generate_one_block  0.01869821548461914
generate_one_block  0.02005290985107422
generate_one_block  0.01860809326171875
generate_one_block  0.01928114891052246
generate_one_block  0.02009129524230957
generate_one_block  0.01912689208984375
generate_one_block  0.018162012100219727
generate_one_block  0.018708467483520508
generate_one_block  0.01816082000732422
generate_one_block  0.01836109161376953
generate_one_block  0.021973609924316406
generate_one_block  0.018700599670410156
generate_one_block  0.018666744232177734
generate_one_block  0.01869797706604004
generate_one_block  0.018986225128173828
generate_one_block  0.021181821823120117
generate_one_block  0.0191953182220459
generate_one_block  0.01940178871154785
generate_one_block  0.018748998641967773
generate_one_block  0.01869511604309082
generate_one_block  0.018764972686767578
generate_one_block  0.019214630126953125
generate_one_block  0.018641233444213867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07019782066345215
gen group dst list time:  0.025340557098388672
time for parepare:  0.02196478843688965
local_output_nid generation:  0.005575656890869141
local_in_edges_tensor generation:  0.015593290328979492
mini_batch_src_global generation:  0.019119739532470703
r_  generation:  0.16571497917175293
local_output_nid generation:  0.007389545440673828
local_in_edges_tensor generation:  0.012374162673950195
mini_batch_src_global generation:  0.0335545539855957
r_  generation:  0.1663224697113037
local_output_nid generation:  0.008025646209716797
local_in_edges_tensor generation:  0.03229856491088867
mini_batch_src_global generation:  0.03316950798034668
r_  generation:  0.18932008743286133
local_output_nid generation:  0.008254528045654297
local_in_edges_tensor generation:  0.008152961730957031
mini_batch_src_global generation:  0.02383589744567871
r_  generation:  0.18175554275512695
local_output_nid generation:  0.009065866470336914
local_in_edges_tensor generation:  0.00874948501586914
mini_batch_src_global generation:  0.028154611587524414
r_  generation:  0.19471478462219238
local_output_nid generation:  0.00904393196105957
local_in_edges_tensor generation:  0.012049436569213867
mini_batch_src_global generation:  0.026368141174316406
r_  generation:  0.1940152645111084
local_output_nid generation:  0.008823394775390625
local_in_edges_tensor generation:  0.01455378532409668
mini_batch_src_global generation:  0.02488565444946289
r_  generation:  0.1799635887145996
local_output_nid generation:  0.008738517761230469
local_in_edges_tensor generation:  0.011403799057006836
mini_batch_src_global generation:  0.025974273681640625
r_  generation:  0.1896352767944336
local_output_nid generation:  0.008509397506713867
local_in_edges_tensor generation:  0.008471965789794922
mini_batch_src_global generation:  0.025270462036132812
r_  generation:  0.18546700477600098
local_output_nid generation:  0.00853276252746582
local_in_edges_tensor generation:  0.008667230606079102
mini_batch_src_global generation:  0.036012887954711914
r_  generation:  0.19310903549194336
local_output_nid generation:  0.013204097747802734
local_in_edges_tensor generation:  0.012025833129882812
mini_batch_src_global generation:  0.031523704528808594
r_  generation:  0.19889473915100098
local_output_nid generation:  0.008945226669311523
local_in_edges_tensor generation:  0.008658409118652344
mini_batch_src_global generation:  0.02367401123046875
r_  generation:  0.18296122550964355
local_output_nid generation:  0.009381532669067383
local_in_edges_tensor generation:  0.00869441032409668
mini_batch_src_global generation:  0.023906707763671875
r_  generation:  0.19008541107177734
local_output_nid generation:  0.00919032096862793
local_in_edges_tensor generation:  0.010231256484985352
mini_batch_src_global generation:  0.024492740631103516
r_  generation:  0.19765830039978027
local_output_nid generation:  0.011729717254638672
local_in_edges_tensor generation:  0.014196395874023438
mini_batch_src_global generation:  0.024435997009277344
r_  generation:  0.19458603858947754
local_output_nid generation:  0.009138107299804688
local_in_edges_tensor generation:  0.00890350341796875
mini_batch_src_global generation:  0.02340102195739746
r_  generation:  0.18121004104614258
local_output_nid generation:  0.009275674819946289
local_in_edges_tensor generation:  0.008740901947021484
mini_batch_src_global generation:  0.023673295974731445
r_  generation:  0.18679141998291016
local_output_nid generation:  0.009118795394897461
local_in_edges_tensor generation:  0.009106874465942383
mini_batch_src_global generation:  0.023860692977905273
r_  generation:  0.18061351776123047
local_output_nid generation:  0.009279966354370117
local_in_edges_tensor generation:  0.00883793830871582
mini_batch_src_global generation:  0.023961782455444336
r_  generation:  0.18865752220153809
local_output_nid generation:  0.009704113006591797
local_in_edges_tensor generation:  0.011482000350952148
mini_batch_src_global generation:  0.0260007381439209
r_  generation:  0.19564366340637207
local_output_nid generation:  0.00921940803527832
local_in_edges_tensor generation:  0.008708000183105469
mini_batch_src_global generation:  0.03492879867553711
r_  generation:  0.2035980224609375
local_output_nid generation:  0.014380216598510742
local_in_edges_tensor generation:  0.011933326721191406
mini_batch_src_global generation:  0.02620220184326172
r_  generation:  0.1977863311767578
local_output_nid generation:  0.014796972274780273
local_in_edges_tensor generation:  0.019023418426513672
mini_batch_src_global generation:  0.025522232055664062
r_  generation:  0.22127771377563477
local_output_nid generation:  0.012542963027954102
local_in_edges_tensor generation:  0.011776447296142578
mini_batch_src_global generation:  0.03917527198791504
r_  generation:  0.20655059814453125
local_output_nid generation:  0.014507055282592773
local_in_edges_tensor generation:  0.011463642120361328
mini_batch_src_global generation:  0.025032758712768555
r_  generation:  0.20302486419677734
local_output_nid generation:  0.016546964645385742
local_in_edges_tensor generation:  0.015057086944580078
mini_batch_src_global generation:  0.04526567459106445
r_  generation:  0.19727349281311035
local_output_nid generation:  0.011850833892822266
local_in_edges_tensor generation:  0.010063648223876953
mini_batch_src_global generation:  0.02778911590576172
r_  generation:  0.2032158374786377
local_output_nid generation:  0.010108470916748047
local_in_edges_tensor generation:  0.010991334915161133
mini_batch_src_global generation:  0.027437448501586914
r_  generation:  0.23015522956848145
local_output_nid generation:  0.009813547134399414
local_in_edges_tensor generation:  0.010864734649658203
mini_batch_src_global generation:  0.04271554946899414
r_  generation:  0.22693419456481934
local_output_nid generation:  0.010392427444458008
local_in_edges_tensor generation:  0.010461091995239258
mini_batch_src_global generation:  0.027058124542236328
r_  generation:  0.19235610961914062
local_output_nid generation:  0.009571552276611328
local_in_edges_tensor generation:  0.010243892669677734
mini_batch_src_global generation:  0.027509450912475586
r_  generation:  0.19784140586853027
local_output_nid generation:  0.009346485137939453
local_in_edges_tensor generation:  0.009681940078735352
mini_batch_src_global generation:  0.027733325958251953
r_  generation:  0.19049286842346191
----------------------check_connections_block total spend ----------------------------- 9.2658531665802
generate_one_block  0.2610208988189697
generate_one_block  0.231856107711792
generate_one_block  0.24962496757507324
generate_one_block  0.2416524887084961
generate_one_block  0.2896382808685303
generate_one_block  0.25879716873168945
generate_one_block  0.248335599899292
generate_one_block  0.25272560119628906
generate_one_block  0.24218368530273438
generate_one_block  0.24572467803955078
generate_one_block  0.2660939693450928
generate_one_block  0.2409067153930664
generate_one_block  0.24981093406677246
generate_one_block  0.2505948543548584
generate_one_block  0.25327253341674805
generate_one_block  0.24045419692993164
generate_one_block  0.2488558292388916
generate_one_block  0.23679518699645996
generate_one_block  0.24310660362243652
generate_one_block  0.26355648040771484
generate_one_block  0.2410597801208496
generate_one_block  0.24345111846923828
generate_one_block  0.2519834041595459
generate_one_block  0.2749207019805908
generate_one_block  0.2502150535583496
generate_one_block  0.2541990280151367
generate_one_block  0.2647519111633301
generate_one_block  0.2463665008544922
generate_one_block  0.2539207935333252
generate_one_block  0.24717211723327637
generate_one_block  0.25765132904052734
generate_one_block  0.2439727783203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045285701751708984
gen group dst list time:  0.13214516639709473
time for parepare:  0.02321481704711914
local_output_nid generation:  0.03522324562072754
local_in_edges_tensor generation:  0.058756351470947266
mini_batch_src_global generation:  0.0535120964050293
r_  generation:  0.5262489318847656
local_output_nid generation:  0.033502817153930664
local_in_edges_tensor generation:  0.03907942771911621
mini_batch_src_global generation:  0.06609582901000977
r_  generation:  0.49430036544799805
local_output_nid generation:  0.030545711517333984
local_in_edges_tensor generation:  0.039751529693603516
mini_batch_src_global generation:  0.06127572059631348
r_  generation:  0.5266668796539307
local_output_nid generation:  0.03226828575134277
local_in_edges_tensor generation:  0.03854727745056152
mini_batch_src_global generation:  0.06587505340576172
r_  generation:  0.5310220718383789
local_output_nid generation:  0.035366058349609375
local_in_edges_tensor generation:  0.03520345687866211
mini_batch_src_global generation:  0.06482887268066406
r_  generation:  0.5063726902008057
local_output_nid generation:  0.03310060501098633
local_in_edges_tensor generation:  0.033057451248168945
mini_batch_src_global generation:  0.059813499450683594
r_  generation:  0.4969215393066406
local_output_nid generation:  0.03325963020324707
local_in_edges_tensor generation:  0.028342008590698242
mini_batch_src_global generation:  0.05904841423034668
r_  generation:  0.5081603527069092
local_output_nid generation:  0.033066749572753906
local_in_edges_tensor generation:  0.030749797821044922
mini_batch_src_global generation:  0.06003236770629883
r_  generation:  0.5007481575012207
local_output_nid generation:  0.032674312591552734
local_in_edges_tensor generation:  0.03191947937011719
mini_batch_src_global generation:  0.05896878242492676
r_  generation:  0.505730152130127
local_output_nid generation:  0.03379034996032715
local_in_edges_tensor generation:  0.03299760818481445
mini_batch_src_global generation:  0.06078147888183594
r_  generation:  0.49619412422180176
local_output_nid generation:  0.033428192138671875
local_in_edges_tensor generation:  0.03852033615112305
mini_batch_src_global generation:  0.05971717834472656
r_  generation:  0.508392333984375
local_output_nid generation:  0.03311634063720703
local_in_edges_tensor generation:  0.028528213500976562
mini_batch_src_global generation:  0.05975079536437988
r_  generation:  0.4931936264038086
local_output_nid generation:  0.03341984748840332
local_in_edges_tensor generation:  0.028543472290039062
mini_batch_src_global generation:  0.059598684310913086
r_  generation:  0.504554271697998
local_output_nid generation:  0.03309011459350586
local_in_edges_tensor generation:  0.037413597106933594
mini_batch_src_global generation:  0.059850454330444336
r_  generation:  0.5029211044311523
local_output_nid generation:  0.033441781997680664
local_in_edges_tensor generation:  0.035477399826049805
mini_batch_src_global generation:  0.059763431549072266
r_  generation:  0.5115571022033691
local_output_nid generation:  0.03435921669006348
local_in_edges_tensor generation:  0.028962135314941406
mini_batch_src_global generation:  0.06033658981323242
r_  generation:  0.5017955303192139
local_output_nid generation:  0.033278703689575195
local_in_edges_tensor generation:  0.030689716339111328
mini_batch_src_global generation:  0.06154894828796387
r_  generation:  0.5106489658355713
local_output_nid generation:  0.03278493881225586
local_in_edges_tensor generation:  0.040364742279052734
mini_batch_src_global generation:  0.06477761268615723
r_  generation:  0.5060129165649414
local_output_nid generation:  0.03780817985534668
local_in_edges_tensor generation:  0.0356137752532959
mini_batch_src_global generation:  0.07402276992797852
r_  generation:  0.5024716854095459
local_output_nid generation:  0.03377842903137207
local_in_edges_tensor generation:  0.037570953369140625
mini_batch_src_global generation:  0.06044769287109375
r_  generation:  0.4978311061859131
local_output_nid generation:  0.033350467681884766
local_in_edges_tensor generation:  0.028496503829956055
mini_batch_src_global generation:  0.05878472328186035
r_  generation:  0.5029637813568115
local_output_nid generation:  0.03325247764587402
local_in_edges_tensor generation:  0.02878594398498535
mini_batch_src_global generation:  0.06023287773132324
r_  generation:  0.4990198612213135
local_output_nid generation:  0.03326725959777832
local_in_edges_tensor generation:  0.028641700744628906
mini_batch_src_global generation:  0.06930947303771973
r_  generation:  0.5050878524780273
local_output_nid generation:  0.03362274169921875
local_in_edges_tensor generation:  0.0325016975402832
mini_batch_src_global generation:  0.05948162078857422
r_  generation:  0.5014050006866455
local_output_nid generation:  0.03359031677246094
local_in_edges_tensor generation:  0.028758525848388672
mini_batch_src_global generation:  0.05865788459777832
r_  generation:  0.5055315494537354
local_output_nid generation:  0.033972978591918945
local_in_edges_tensor generation:  0.03154945373535156
mini_batch_src_global generation:  0.06029105186462402
r_  generation:  0.4999098777770996
local_output_nid generation:  0.03323841094970703
local_in_edges_tensor generation:  0.030668258666992188
mini_batch_src_global generation:  0.060729265213012695
r_  generation:  0.5064847469329834
local_output_nid generation:  0.033203840255737305
local_in_edges_tensor generation:  0.032883644104003906
mini_batch_src_global generation:  0.05961489677429199
r_  generation:  0.49982142448425293
local_output_nid generation:  0.03330111503601074
local_in_edges_tensor generation:  0.030803203582763672
mini_batch_src_global generation:  0.060652732849121094
r_  generation:  0.5071980953216553
local_output_nid generation:  0.03374934196472168
local_in_edges_tensor generation:  0.0344085693359375
mini_batch_src_global generation:  0.0598599910736084
r_  generation:  0.5061180591583252
local_output_nid generation:  0.03306412696838379
local_in_edges_tensor generation:  0.03083515167236328
mini_batch_src_global generation:  0.058690786361694336
r_  generation:  0.5075390338897705
local_output_nid generation:  0.03328204154968262
local_in_edges_tensor generation:  0.02956414222717285
mini_batch_src_global generation:  0.05955314636230469
r_  generation:  0.4991745948791504
----------------------check_connections_block total spend ----------------------------- 23.848045349121094
generate_one_block  0.7178974151611328
generate_one_block  0.6807305812835693
generate_one_block  0.69927978515625
generate_one_block  0.6790258884429932
generate_one_block  0.7971839904785156
generate_one_block  0.6842441558837891
generate_one_block  0.6738426685333252
generate_one_block  0.6812398433685303
generate_one_block  0.6749839782714844
generate_one_block  0.6843783855438232
generate_one_block  0.6848273277282715
generate_one_block  0.6696128845214844
generate_one_block  0.6782433986663818
generate_one_block  0.6793477535247803
generate_one_block  0.6862032413482666
generate_one_block  0.6698527336120605
generate_one_block  0.6749453544616699
generate_one_block  0.6694355010986328
generate_one_block  0.6883785724639893
generate_one_block  0.6839098930358887
generate_one_block  0.6767005920410156
generate_one_block  0.6746275424957275
generate_one_block  0.6853828430175781
generate_one_block  0.6802577972412109
generate_one_block  0.6989192962646484
generate_one_block  0.681166410446167
generate_one_block  0.6875529289245605
generate_one_block  0.6765882968902588
generate_one_block  0.6916322708129883
generate_one_block  0.6906938552856445
generate_one_block  0.6925027370452881
generate_one_block  0.683974027633667
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.13153600692749023  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

connection checking time:  33.113898515701294
block generation total time  30.022233247756958
average batch blocks generation time:  0.9381947889924049
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10938453674316406  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.674872875213623  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10848331451416016  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 19.956852436065674  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10943603515625  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.948150634765625  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10904693603515625  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.41348123550415  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10950899124145508  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.116283416748047  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10936641693115234  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.921935558319092  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10944128036499023  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.476879119873047  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10926008224487305  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.865479469299316  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10893917083740234  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.422557830810547  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10915374755859375  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.601149559020996  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 0.10950469970703125  GigaBytes
Max Memory Allocated: 21.46684980392456  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 21.398340702056885  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8983154296875 GB
    Memory Allocated: 0.10888147354125977  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1053466796875 GB
    Memory Allocated: 20.5657320022583  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1072998046875 GB
    Memory Allocated: 0.10941743850708008  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1072998046875 GB
    Memory Allocated: 20.911132335662842  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1072998046875 GB
    Memory Allocated: 0.10929584503173828  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2303466796875 GB
    Memory Allocated: 20.838419914245605  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10950326919555664  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.066879749298096  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10887527465820312  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.348732471466064  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10918188095092773  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.746928215026855  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10883951187133789  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.368688583374023  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10940790176391602  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.77156114578247  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.1095433235168457  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.267239570617676  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10926103591918945  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.61022710800171  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10917282104492188  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.65898084640503  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10952949523925781  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.89809560775757  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10957574844360352  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.053176403045654  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10935497283935547  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.7969012260437  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10918092727661133  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.936123847961426  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10948038101196289  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 21.328617095947266  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10905075073242188  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.72855567932129  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10953330993652344  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.920058250427246  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10920524597167969  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 20.719173431396484  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2322998046875 GB
    Memory Allocated: 0.10912370681762695  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3123779296875 GB
    Memory Allocated: 21.014031887054443  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10911893844604492  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.572606086730957  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034028828144073486 |0.02399030327796936 |0.6368183866143227 |9.799003601074219e-05 |1.1985819712281227 |0.005170106887817383 |
----------------------------------------------------------pseudo_mini_loss sum 2.778196334838867
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  9162153
Number of first layer input nodes during this epoch:  4810287
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.13100337982177734  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029803991317749023
range selection method range initialization spend 0.02003335952758789
time for parepare:  0.020034074783325195
local_output_nid generation:  0.001070261001586914
local_in_edges_tensor generation:  0.006879329681396484
mini_batch_src_global generation:  0.002012491226196289
r_  generation:  0.012187480926513672
local_output_nid generation:  0.0010154247283935547
local_in_edges_tensor generation:  0.0008356571197509766
mini_batch_src_global generation:  0.001565694808959961
r_  generation:  0.01071786880493164
local_output_nid generation:  0.0009176731109619141
local_in_edges_tensor generation:  0.0007269382476806641
mini_batch_src_global generation:  0.0010647773742675781
r_  generation:  0.009457111358642578
local_output_nid generation:  0.0009095668792724609
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.001032114028930664
r_  generation:  0.009786844253540039
local_output_nid generation:  0.0008971691131591797
local_in_edges_tensor generation:  0.0007627010345458984
mini_batch_src_global generation:  0.0010154247283935547
r_  generation:  0.009634733200073242
local_output_nid generation:  0.0009036064147949219
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.0010707378387451172
r_  generation:  0.009898900985717773
local_output_nid generation:  0.00089263916015625
local_in_edges_tensor generation:  0.0007381439208984375
mini_batch_src_global generation:  0.0011663436889648438
r_  generation:  0.010566949844360352
local_output_nid generation:  0.0009045600891113281
local_in_edges_tensor generation:  0.0005662441253662109
mini_batch_src_global generation:  0.0010485649108886719
r_  generation:  0.010304927825927734
local_output_nid generation:  0.0008981227874755859
local_in_edges_tensor generation:  0.0007162094116210938
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.010331869125366211
local_output_nid generation:  0.0008931159973144531
local_in_edges_tensor generation:  0.0005884170532226562
mini_batch_src_global generation:  0.001065969467163086
r_  generation:  0.010064125061035156
local_output_nid generation:  0.0008676052093505859
local_in_edges_tensor generation:  0.0007295608520507812
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.010525226593017578
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0006337165832519531
mini_batch_src_global generation:  0.0012202262878417969
r_  generation:  0.010088682174682617
local_output_nid generation:  0.0008831024169921875
local_in_edges_tensor generation:  0.0006623268127441406
mini_batch_src_global generation:  0.0011022090911865234
r_  generation:  0.009902000427246094
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0005629062652587891
mini_batch_src_global generation:  0.0010743141174316406
r_  generation:  0.010270833969116211
local_output_nid generation:  0.0008974075317382812
local_in_edges_tensor generation:  0.0006470680236816406
mini_batch_src_global generation:  0.0011167526245117188
r_  generation:  0.01038217544555664
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0010938644409179688
r_  generation:  0.010129451751708984
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0005643367767333984
mini_batch_src_global generation:  0.0012416839599609375
r_  generation:  0.010566234588623047
local_output_nid generation:  0.0008902549743652344
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.001079559326171875
r_  generation:  0.010152578353881836
local_output_nid generation:  0.0008764266967773438
local_in_edges_tensor generation:  0.0005676746368408203
mini_batch_src_global generation:  0.0011403560638427734
r_  generation:  0.010094881057739258
local_output_nid generation:  0.0008764266967773438
local_in_edges_tensor generation:  0.000576019287109375
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.010225772857666016
local_output_nid generation:  0.0008780956268310547
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.010640859603881836
local_output_nid generation:  0.0008795261383056641
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.0011248588562011719
r_  generation:  0.010555267333984375
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.010481834411621094
local_output_nid generation:  0.0008940696716308594
local_in_edges_tensor generation:  0.0005631446838378906
mini_batch_src_global generation:  0.0011043548583984375
r_  generation:  0.010473489761352539
local_output_nid generation:  0.0009298324584960938
local_in_edges_tensor generation:  0.00077056884765625
mini_batch_src_global generation:  0.0012106895446777344
r_  generation:  0.010941028594970703
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0005710124969482422
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.010578155517578125
local_output_nid generation:  0.0008790493011474609
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0011026859283447266
r_  generation:  0.010257244110107422
local_output_nid generation:  0.0008814334869384766
local_in_edges_tensor generation:  0.0005950927734375
mini_batch_src_global generation:  0.0011208057403564453
r_  generation:  0.010382413864135742
local_output_nid generation:  0.0008938312530517578
local_in_edges_tensor generation:  0.0005660057067871094
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.010233402252197266
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.010184764862060547
local_output_nid generation:  0.0008590221405029297
local_in_edges_tensor generation:  0.0006449222564697266
mini_batch_src_global generation:  0.0011742115020751953
r_  generation:  0.010596990585327148
local_output_nid generation:  0.0008840560913085938
local_in_edges_tensor generation:  0.0005562305450439453
mini_batch_src_global generation:  0.0011355876922607422
r_  generation:  0.010514974594116211
----------------------check_connections_block total spend ----------------------------- 0.5242712497711182
generate_one_block  0.028281211853027344
generate_one_block  0.020835161209106445
generate_one_block  0.018851280212402344
generate_one_block  0.018656492233276367
generate_one_block  0.018631696701049805
generate_one_block  0.0186464786529541
generate_one_block  0.019420385360717773
generate_one_block  0.01880812644958496
generate_one_block  0.018930912017822266
generate_one_block  0.018426179885864258
generate_one_block  0.019099950790405273
generate_one_block  0.01881861686706543
generate_one_block  0.018208980560302734
generate_one_block  0.018909454345703125
generate_one_block  0.019786357879638672
generate_one_block  0.01898050308227539
generate_one_block  0.01897120475769043
generate_one_block  0.018436193466186523
generate_one_block  0.01836109161376953
generate_one_block  0.018878936767578125
generate_one_block  0.019303083419799805
generate_one_block  0.01896810531616211
generate_one_block  0.019078493118286133
generate_one_block  0.01906585693359375
generate_one_block  0.019559383392333984
generate_one_block  0.01922130584716797
generate_one_block  0.018766403198242188
generate_one_block  0.018830537796020508
generate_one_block  0.018533945083618164
generate_one_block  0.018605947494506836
generate_one_block  0.019114971160888672
generate_one_block  0.019208908081054688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042728424072265625
gen group dst list time:  0.025843381881713867
time for parepare:  0.021350860595703125
local_output_nid generation:  0.006066083908081055
local_in_edges_tensor generation:  0.019373178482055664
mini_batch_src_global generation:  0.018228769302368164
r_  generation:  0.16220974922180176
local_output_nid generation:  0.007979869842529297
local_in_edges_tensor generation:  0.011030197143554688
mini_batch_src_global generation:  0.02114272117614746
r_  generation:  0.16556167602539062
local_output_nid generation:  0.007954835891723633
local_in_edges_tensor generation:  0.03338479995727539
mini_batch_src_global generation:  0.019819259643554688
r_  generation:  0.1694166660308838
local_output_nid generation:  0.008237600326538086
local_in_edges_tensor generation:  0.008499383926391602
mini_batch_src_global generation:  0.026638507843017578
r_  generation:  0.17152833938598633
local_output_nid generation:  0.008421182632446289
local_in_edges_tensor generation:  0.008333444595336914
mini_batch_src_global generation:  0.020565032958984375
r_  generation:  0.17239689826965332
local_output_nid generation:  0.008981704711914062
local_in_edges_tensor generation:  0.008815765380859375
mini_batch_src_global generation:  0.02234172821044922
r_  generation:  0.17738676071166992
local_output_nid generation:  0.009145259857177734
local_in_edges_tensor generation:  0.010030984878540039
mini_batch_src_global generation:  0.02344822883605957
r_  generation:  0.1837780475616455
local_output_nid generation:  0.008810758590698242
local_in_edges_tensor generation:  0.011790275573730469
mini_batch_src_global generation:  0.022377967834472656
r_  generation:  0.18251919746398926
local_output_nid generation:  0.008695125579833984
local_in_edges_tensor generation:  0.009617328643798828
mini_batch_src_global generation:  0.023095369338989258
r_  generation:  0.1830449104309082
local_output_nid generation:  0.008777379989624023
local_in_edges_tensor generation:  0.008756160736083984
mini_batch_src_global generation:  0.02227640151977539
r_  generation:  0.17963361740112305
local_output_nid generation:  0.009251594543457031
local_in_edges_tensor generation:  0.008949518203735352
mini_batch_src_global generation:  0.022977113723754883
r_  generation:  0.18529415130615234
local_output_nid generation:  0.009079694747924805
local_in_edges_tensor generation:  0.008640527725219727
mini_batch_src_global generation:  0.02225661277770996
r_  generation:  0.17835187911987305
local_output_nid generation:  0.009853601455688477
local_in_edges_tensor generation:  0.008328676223754883
mini_batch_src_global generation:  0.021458148956298828
r_  generation:  0.17308640480041504
local_output_nid generation:  0.009217262268066406
local_in_edges_tensor generation:  0.008806705474853516
mini_batch_src_global generation:  0.022076845169067383
r_  generation:  0.17964959144592285
local_output_nid generation:  0.009371757507324219
local_in_edges_tensor generation:  0.012149572372436523
mini_batch_src_global generation:  0.024133682250976562
r_  generation:  0.18676519393920898
local_output_nid generation:  0.009230852127075195
local_in_edges_tensor generation:  0.008947610855102539
mini_batch_src_global generation:  0.026477813720703125
r_  generation:  0.17802834510803223
local_output_nid generation:  0.009473800659179688
local_in_edges_tensor generation:  0.012132644653320312
mini_batch_src_global generation:  0.024052143096923828
r_  generation:  0.18634819984436035
local_output_nid generation:  0.009191036224365234
local_in_edges_tensor generation:  0.009096145629882812
mini_batch_src_global generation:  0.02283310890197754
r_  generation:  0.18001008033752441
local_output_nid generation:  0.00901341438293457
local_in_edges_tensor generation:  0.009386539459228516
mini_batch_src_global generation:  0.02279973030090332
r_  generation:  0.17786288261413574
local_output_nid generation:  0.009159088134765625
local_in_edges_tensor generation:  0.009494304656982422
mini_batch_src_global generation:  0.022385358810424805
r_  generation:  0.17848873138427734
local_output_nid generation:  0.00950479507446289
local_in_edges_tensor generation:  0.009474992752075195
mini_batch_src_global generation:  0.02287149429321289
r_  generation:  0.1842479705810547
local_output_nid generation:  0.009426593780517578
local_in_edges_tensor generation:  0.008677959442138672
mini_batch_src_global generation:  0.022718429565429688
r_  generation:  0.179548978805542
local_output_nid generation:  0.009363889694213867
local_in_edges_tensor generation:  0.008891582489013672
mini_batch_src_global generation:  0.022942304611206055
r_  generation:  0.18456172943115234
local_output_nid generation:  0.009426116943359375
local_in_edges_tensor generation:  0.00907444953918457
mini_batch_src_global generation:  0.023235082626342773
r_  generation:  0.18668055534362793
local_output_nid generation:  0.009534597396850586
local_in_edges_tensor generation:  0.009234189987182617
mini_batch_src_global generation:  0.023855924606323242
r_  generation:  0.18619585037231445
local_output_nid generation:  0.009525537490844727
local_in_edges_tensor generation:  0.009931802749633789
mini_batch_src_global generation:  0.0235140323638916
r_  generation:  0.18414306640625
local_output_nid generation:  0.009258508682250977
local_in_edges_tensor generation:  0.008899211883544922
mini_batch_src_global generation:  0.022904634475708008
r_  generation:  0.18403005599975586
local_output_nid generation:  0.009388446807861328
local_in_edges_tensor generation:  0.00896906852722168
mini_batch_src_global generation:  0.0228884220123291
r_  generation:  0.18126177787780762
local_output_nid generation:  0.009151220321655273
local_in_edges_tensor generation:  0.008655548095703125
mini_batch_src_global generation:  0.022431612014770508
r_  generation:  0.17862510681152344
local_output_nid generation:  0.009348154067993164
local_in_edges_tensor generation:  0.009457826614379883
mini_batch_src_global generation:  0.02734994888305664
r_  generation:  0.18151044845581055
local_output_nid generation:  0.009732246398925781
local_in_edges_tensor generation:  0.009838342666625977
mini_batch_src_global generation:  0.023306846618652344
r_  generation:  0.18861675262451172
local_output_nid generation:  0.009436845779418945
local_in_edges_tensor generation:  0.008929252624511719
mini_batch_src_global generation:  0.023391008377075195
r_  generation:  0.1849517822265625
----------------------check_connections_block total spend ----------------------------- 8.446932077407837
generate_one_block  0.24469733238220215
generate_one_block  0.23605084419250488
generate_one_block  0.23761439323425293
generate_one_block  0.24022817611694336
generate_one_block  0.2650141716003418
generate_one_block  0.24432682991027832
generate_one_block  0.2540268898010254
generate_one_block  0.24679303169250488
generate_one_block  0.24883174896240234
generate_one_block  0.24242854118347168
generate_one_block  0.26177263259887695
generate_one_block  0.23911166191101074
generate_one_block  0.23197054862976074
generate_one_block  0.23925399780273438
generate_one_block  0.2546727657318115
generate_one_block  0.24154901504516602
generate_one_block  0.25293517112731934
generate_one_block  0.2450573444366455
generate_one_block  0.2430896759033203
generate_one_block  0.24807500839233398
generate_one_block  0.24837660789489746
generate_one_block  0.24368667602539062
generate_one_block  0.24764347076416016
generate_one_block  0.25202083587646484
generate_one_block  0.25678539276123047
generate_one_block  0.2537565231323242
generate_one_block  0.2497119903564453
generate_one_block  0.2458796501159668
generate_one_block  0.24043583869934082
generate_one_block  0.25681400299072266
generate_one_block  0.25786876678466797
generate_one_block  0.25273609161376953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0374758243560791
gen group dst list time:  0.10828924179077148
time for parepare:  0.01910853385925293
local_output_nid generation:  0.02405714988708496
local_in_edges_tensor generation:  0.05045461654663086
mini_batch_src_global generation:  0.04684281349182129
r_  generation:  0.48385071754455566
local_output_nid generation:  0.029891252517700195
local_in_edges_tensor generation:  0.036566972732543945
mini_batch_src_global generation:  0.058867692947387695
r_  generation:  0.4837453365325928
local_output_nid generation:  0.0304563045501709
local_in_edges_tensor generation:  0.03061056137084961
mini_batch_src_global generation:  0.05712723731994629
r_  generation:  0.49370336532592773
local_output_nid generation:  0.029593229293823242
local_in_edges_tensor generation:  0.03052353858947754
mini_batch_src_global generation:  0.05815696716308594
r_  generation:  0.48787879943847656
local_output_nid generation:  0.028645992279052734
local_in_edges_tensor generation:  0.03038763999938965
mini_batch_src_global generation:  0.057665109634399414
r_  generation:  0.4952728748321533
local_output_nid generation:  0.02866387367248535
local_in_edges_tensor generation:  0.030339717864990234
mini_batch_src_global generation:  0.05897212028503418
r_  generation:  0.4933931827545166
local_output_nid generation:  0.028914690017700195
local_in_edges_tensor generation:  0.030617713928222656
mini_batch_src_global generation:  0.05879497528076172
r_  generation:  0.49684929847717285
local_output_nid generation:  0.029010534286499023
local_in_edges_tensor generation:  0.02999114990234375
mini_batch_src_global generation:  0.05931663513183594
r_  generation:  0.4986400604248047
local_output_nid generation:  0.02915668487548828
local_in_edges_tensor generation:  0.03084111213684082
mini_batch_src_global generation:  0.058467864990234375
r_  generation:  0.5020582675933838
local_output_nid generation:  0.02905416488647461
local_in_edges_tensor generation:  0.03067636489868164
mini_batch_src_global generation:  0.0598301887512207
r_  generation:  0.4935462474822998
local_output_nid generation:  0.02913522720336914
local_in_edges_tensor generation:  0.030239105224609375
mini_batch_src_global generation:  0.05965995788574219
r_  generation:  0.5033752918243408
local_output_nid generation:  0.029148101806640625
local_in_edges_tensor generation:  0.030617713928222656
mini_batch_src_global generation:  0.05968737602233887
r_  generation:  0.49881458282470703
local_output_nid generation:  0.029103755950927734
local_in_edges_tensor generation:  0.028761863708496094
mini_batch_src_global generation:  0.05754446983337402
r_  generation:  0.49924325942993164
local_output_nid generation:  0.029119491577148438
local_in_edges_tensor generation:  0.030728816986083984
mini_batch_src_global generation:  0.061920881271362305
r_  generation:  0.4969484806060791
local_output_nid generation:  0.02926182746887207
local_in_edges_tensor generation:  0.029044628143310547
mini_batch_src_global generation:  0.058057308197021484
r_  generation:  0.5039095878601074
local_output_nid generation:  0.029111862182617188
local_in_edges_tensor generation:  0.030930042266845703
mini_batch_src_global generation:  0.06005978584289551
r_  generation:  0.49700403213500977
local_output_nid generation:  0.0293118953704834
local_in_edges_tensor generation:  0.030892610549926758
mini_batch_src_global generation:  0.05823945999145508
r_  generation:  0.5037946701049805
local_output_nid generation:  0.028755903244018555
local_in_edges_tensor generation:  0.029741287231445312
mini_batch_src_global generation:  0.060003042221069336
r_  generation:  0.49474334716796875
local_output_nid generation:  0.029021024703979492
local_in_edges_tensor generation:  0.03126049041748047
mini_batch_src_global generation:  0.06035566329956055
r_  generation:  0.49986934661865234
local_output_nid generation:  0.029070377349853516
local_in_edges_tensor generation:  0.03087925910949707
mini_batch_src_global generation:  0.06227445602416992
r_  generation:  0.5004596710205078
local_output_nid generation:  0.029756546020507812
local_in_edges_tensor generation:  0.03357267379760742
mini_batch_src_global generation:  0.05875277519226074
r_  generation:  0.5030865669250488
local_output_nid generation:  0.02926945686340332
local_in_edges_tensor generation:  0.030638456344604492
mini_batch_src_global generation:  0.05969047546386719
r_  generation:  0.4985771179199219
local_output_nid generation:  0.029186725616455078
local_in_edges_tensor generation:  0.03138017654418945
mini_batch_src_global generation:  0.058022260665893555
r_  generation:  0.5024092197418213
local_output_nid generation:  0.02926945686340332
local_in_edges_tensor generation:  0.030382871627807617
mini_batch_src_global generation:  0.05943417549133301
r_  generation:  0.5022003650665283
local_output_nid generation:  0.02911233901977539
local_in_edges_tensor generation:  0.030571699142456055
mini_batch_src_global generation:  0.06021761894226074
r_  generation:  0.5118093490600586
local_output_nid generation:  0.029430389404296875
local_in_edges_tensor generation:  0.03310728073120117
mini_batch_src_global generation:  0.05972623825073242
r_  generation:  0.5086495876312256
local_output_nid generation:  0.029546737670898438
local_in_edges_tensor generation:  0.031446218490600586
mini_batch_src_global generation:  0.061041831970214844
r_  generation:  0.5018198490142822
local_output_nid generation:  0.029622316360473633
local_in_edges_tensor generation:  0.03302621841430664
mini_batch_src_global generation:  0.060133934020996094
r_  generation:  0.4997739791870117
local_output_nid generation:  0.03144574165344238
local_in_edges_tensor generation:  0.03060770034790039
mini_batch_src_global generation:  0.0614476203918457
r_  generation:  0.501760721206665
local_output_nid generation:  0.02899336814880371
local_in_edges_tensor generation:  0.03061199188232422
mini_batch_src_global generation:  0.05921053886413574
r_  generation:  0.49548888206481934
local_output_nid generation:  0.029282093048095703
local_in_edges_tensor generation:  0.028713226318359375
mini_batch_src_global generation:  0.05948162078857422
r_  generation:  0.506678581237793
local_output_nid generation:  0.029447078704833984
local_in_edges_tensor generation:  0.03440523147583008
mini_batch_src_global generation:  0.060526371002197266
r_  generation:  0.49864768981933594
----------------------check_connections_block total spend ----------------------------- 23.287105798721313
generate_one_block  0.6747093200683594
generate_one_block  0.6679534912109375
generate_one_block  0.6705446243286133
generate_one_block  0.6743888854980469
generate_one_block  0.7653617858886719
generate_one_block  0.6769862174987793
generate_one_block  0.6766541004180908
generate_one_block  0.6833364963531494
generate_one_block  0.6814372539520264
generate_one_block  0.6746094226837158
generate_one_block  0.6824207305908203
generate_one_block  0.6783053874969482
generate_one_block  0.6747677326202393
generate_one_block  0.6708023548126221
generate_one_block  0.6861047744750977
generate_one_block  0.6813704967498779
generate_one_block  0.6724605560302734
generate_one_block  0.6689925193786621
generate_one_block  0.6724452972412109
generate_one_block  0.6800320148468018
generate_one_block  0.6871621608734131
generate_one_block  0.6916244029998779
generate_one_block  0.6789336204528809
generate_one_block  0.6844456195831299
generate_one_block  0.7005422115325928
generate_one_block  0.6824488639831543
generate_one_block  0.6799271106719971
generate_one_block  0.6810901165008545
generate_one_block  0.6778464317321777
generate_one_block  0.6776397228240967
generate_one_block  0.6852593421936035
generate_one_block  0.7020347118377686
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.13100337982177734  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

connection checking time:  31.73403787612915
block generation total time  29.76585340499878
average batch blocks generation time:  0.9301829189062119
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10914087295532227  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.726534843444824  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10911798477172852  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.429504871368408  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10905933380126953  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.55363416671753  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10895490646362305  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.523283004760742  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10918951034545898  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.496407508850098  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10928487777709961  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.71474313735962  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.1094965934753418  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.082244396209717  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10932207107543945  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.87273120880127  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10968685150146484  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.05970525741577  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10909557342529297  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.720006465911865  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10940837860107422  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.061580181121826  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10912179946899414  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.55965232849121  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10887432098388672  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.23991632461548  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10913562774658203  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.601703643798828  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10927772521972656  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.099634647369385  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10935068130493164  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.63902235031128  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10941553115844727  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.03634548187256  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10913658142089844  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.664535522460938  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10884618759155273  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.61502695083618  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10907459259033203  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.625261783599854  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10960102081298828  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.921401977539062  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10935640335083008  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.754158973693848  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10904407501220703  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.815624237060547  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10931062698364258  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.98227024078369  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10919427871704102  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.10181760787964  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10932064056396484  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.109484672546387  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10935592651367188  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.856772899627686  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10925006866455078  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.784651279449463  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10931587219238281  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.59407329559326  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.1091160774230957  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.70043134689331  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10936546325683594  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.102399826049805  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.1094508171081543  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.0462384223938  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027454383671283722 |0.020787060260772705 |0.6333902105689049 |9.881705045700073e-05 |1.1959289014339447 |0.005405902862548828 |
----------------------------------------------------------pseudo_mini_loss sum 2.399482011795044
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  9163116
Number of first layer input nodes during this epoch:  4809077
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.13187551498413086  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026932716369628906
range selection method range initialization spend 0.013780593872070312
time for parepare:  0.020404338836669922
local_output_nid generation:  0.0009567737579345703
local_in_edges_tensor generation:  0.03256416320800781
mini_batch_src_global generation:  0.0021212100982666016
r_  generation:  0.012354135513305664
local_output_nid generation:  0.0009620189666748047
local_in_edges_tensor generation:  0.0006628036499023438
mini_batch_src_global generation:  0.0015511512756347656
r_  generation:  0.010589122772216797
local_output_nid generation:  0.0009315013885498047
local_in_edges_tensor generation:  0.0006017684936523438
mini_batch_src_global generation:  0.0010478496551513672
r_  generation:  0.010076522827148438
local_output_nid generation:  0.0009009838104248047
local_in_edges_tensor generation:  0.0006146430969238281
mini_batch_src_global generation:  0.0010828971862792969
r_  generation:  0.010316610336303711
local_output_nid generation:  0.0008912086486816406
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.0010495185852050781
r_  generation:  0.009806156158447266
local_output_nid generation:  0.0008931159973144531
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.001035928726196289
r_  generation:  0.009711265563964844
local_output_nid generation:  0.0008831024169921875
local_in_edges_tensor generation:  0.0005915164947509766
mini_batch_src_global generation:  0.0010895729064941406
r_  generation:  0.01056528091430664
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0005512237548828125
mini_batch_src_global generation:  0.0010671615600585938
r_  generation:  0.009931325912475586
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0005609989166259766
mini_batch_src_global generation:  0.0010614395141601562
r_  generation:  0.010532855987548828
local_output_nid generation:  0.0008575916290283203
local_in_edges_tensor generation:  0.0005593299865722656
mini_batch_src_global generation:  0.0010836124420166016
r_  generation:  0.01063394546508789
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0005528926849365234
mini_batch_src_global generation:  0.0010991096496582031
r_  generation:  0.010779619216918945
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0005571842193603516
mini_batch_src_global generation:  0.0010712146759033203
r_  generation:  0.010123491287231445
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0005478858947753906
mini_batch_src_global generation:  0.0010499954223632812
r_  generation:  0.009844541549682617
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.0011420249938964844
r_  generation:  0.010478973388671875
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0005733966827392578
mini_batch_src_global generation:  0.0010488033294677734
r_  generation:  0.009895563125610352
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.0011186599731445312
r_  generation:  0.01024484634399414
local_output_nid generation:  0.0008518695831298828
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.0011866092681884766
r_  generation:  0.010533332824707031
local_output_nid generation:  0.0008563995361328125
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0011091232299804688
r_  generation:  0.01024317741394043
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0005583763122558594
mini_batch_src_global generation:  0.0010609626770019531
r_  generation:  0.010257244110107422
local_output_nid generation:  0.0008563995361328125
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0010519027709960938
r_  generation:  0.009951353073120117
local_output_nid generation:  0.0008554458618164062
local_in_edges_tensor generation:  0.0005652904510498047
mini_batch_src_global generation:  0.0011415481567382812
r_  generation:  0.01001739501953125
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.0005533695220947266
mini_batch_src_global generation:  0.0010313987731933594
r_  generation:  0.009987592697143555
local_output_nid generation:  0.0008478164672851562
local_in_edges_tensor generation:  0.00055694580078125
mini_batch_src_global generation:  0.0011584758758544922
r_  generation:  0.010730981826782227
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0005409717559814453
mini_batch_src_global generation:  0.0011708736419677734
r_  generation:  0.01076507568359375
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0005588531494140625
mini_batch_src_global generation:  0.0011706352233886719
r_  generation:  0.010782957077026367
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0005545616149902344
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.010255813598632812
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.000591278076171875
mini_batch_src_global generation:  0.0011434555053710938
r_  generation:  0.010496377944946289
local_output_nid generation:  0.0008587837219238281
local_in_edges_tensor generation:  0.0005393028259277344
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.0124053955078125
local_output_nid generation:  0.0008797645568847656
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.0010950565338134766
r_  generation:  0.010235786437988281
local_output_nid generation:  0.0009081363677978516
local_in_edges_tensor generation:  0.0005891323089599609
mini_batch_src_global generation:  0.0010650157928466797
r_  generation:  0.01017618179321289
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.0005536079406738281
mini_batch_src_global generation:  0.0011639595031738281
r_  generation:  0.01054239273071289
local_output_nid generation:  0.0008966922760009766
local_in_edges_tensor generation:  0.0005993843078613281
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.010663986206054688
----------------------check_connections_block total spend ----------------------------- 0.5491235256195068
generate_one_block  0.026270151138305664
generate_one_block  0.02073049545288086
generate_one_block  0.019571542739868164
generate_one_block  0.0195772647857666
generate_one_block  0.01856255531311035
generate_one_block  0.01802515983581543
generate_one_block  0.019399642944335938
generate_one_block  0.01821613311767578
generate_one_block  0.019501924514770508
generate_one_block  0.019451379776000977
generate_one_block  0.01952505111694336
generate_one_block  0.01857137680053711
generate_one_block  0.01788020133972168
generate_one_block  0.019239187240600586
generate_one_block  0.017889022827148438
generate_one_block  0.01868295669555664
generate_one_block  0.018915414810180664
generate_one_block  0.01875925064086914
generate_one_block  0.018634557723999023
generate_one_block  0.018151283264160156
generate_one_block  0.018309354782104492
generate_one_block  0.01799798011779785
generate_one_block  0.01950359344482422
generate_one_block  0.018838167190551758
generate_one_block  0.019337892532348633
generate_one_block  0.018696069717407227
generate_one_block  0.019271135330200195
generate_one_block  0.018583059310913086
generate_one_block  0.018313884735107422
generate_one_block  0.018212556838989258
generate_one_block  0.019184589385986328
generate_one_block  0.019385337829589844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04242658615112305
gen group dst list time:  0.025366783142089844
time for parepare:  0.021522998809814453
local_output_nid generation:  0.0058193206787109375
local_in_edges_tensor generation:  0.020669221878051758
mini_batch_src_global generation:  0.018033504486083984
r_  generation:  0.16434431076049805
local_output_nid generation:  0.007944107055664062
local_in_edges_tensor generation:  0.010964393615722656
mini_batch_src_global generation:  0.02111983299255371
r_  generation:  0.16428661346435547
local_output_nid generation:  0.008163928985595703
local_in_edges_tensor generation:  0.03074955940246582
mini_batch_src_global generation:  0.020182132720947266
r_  generation:  0.17277002334594727
local_output_nid generation:  0.008540153503417969
local_in_edges_tensor generation:  0.010190725326538086
mini_batch_src_global generation:  0.02165532112121582
r_  generation:  0.18050813674926758
local_output_nid generation:  0.00868988037109375
local_in_edges_tensor generation:  0.008377552032470703
mini_batch_src_global generation:  0.021302223205566406
r_  generation:  0.17453479766845703
local_output_nid generation:  0.008664608001708984
local_in_edges_tensor generation:  0.008203983306884766
mini_batch_src_global generation:  0.020631074905395508
r_  generation:  0.16983890533447266
local_output_nid generation:  0.009236574172973633
local_in_edges_tensor generation:  0.012752771377563477
mini_batch_src_global generation:  0.023586273193359375
r_  generation:  0.18694043159484863
local_output_nid generation:  0.00847005844116211
local_in_edges_tensor generation:  0.008611202239990234
mini_batch_src_global generation:  0.02176189422607422
r_  generation:  0.17478060722351074
local_output_nid generation:  0.008924245834350586
local_in_edges_tensor generation:  0.008764505386352539
mini_batch_src_global generation:  0.024537086486816406
r_  generation:  0.18885493278503418
local_output_nid generation:  0.009180545806884766
local_in_edges_tensor generation:  0.008681297302246094
mini_batch_src_global generation:  0.02302718162536621
r_  generation:  0.1860790252685547
local_output_nid generation:  0.009525060653686523
local_in_edges_tensor generation:  0.0100250244140625
mini_batch_src_global generation:  0.0238800048828125
r_  generation:  0.19115233421325684
local_output_nid generation:  0.008949995040893555
local_in_edges_tensor generation:  0.008640050888061523
mini_batch_src_global generation:  0.02298116683959961
r_  generation:  0.17834758758544922
local_output_nid generation:  0.008862495422363281
local_in_edges_tensor generation:  0.008766889572143555
mini_batch_src_global generation:  0.02459120750427246
r_  generation:  0.17387604713439941
local_output_nid generation:  0.010218620300292969
local_in_edges_tensor generation:  0.00901484489440918
mini_batch_src_global generation:  0.029181718826293945
r_  generation:  0.18853497505187988
local_output_nid generation:  0.010204792022705078
local_in_edges_tensor generation:  0.008600950241088867
mini_batch_src_global generation:  0.022592782974243164
r_  generation:  0.1761302947998047
local_output_nid generation:  0.009433984756469727
local_in_edges_tensor generation:  0.00971674919128418
mini_batch_src_global generation:  0.02395009994506836
r_  generation:  0.18396282196044922
local_output_nid generation:  0.009663820266723633
local_in_edges_tensor generation:  0.01036524772644043
mini_batch_src_global generation:  0.023838281631469727
r_  generation:  0.18655657768249512
local_output_nid generation:  0.009507894515991211
local_in_edges_tensor generation:  0.008843421936035156
mini_batch_src_global generation:  0.023465394973754883
r_  generation:  0.1863417625427246
local_output_nid generation:  0.009448766708374023
local_in_edges_tensor generation:  0.009469747543334961
mini_batch_src_global generation:  0.023083925247192383
r_  generation:  0.18477773666381836
local_output_nid generation:  0.00934147834777832
local_in_edges_tensor generation:  0.008737802505493164
mini_batch_src_global generation:  0.022502422332763672
r_  generation:  0.17785286903381348
local_output_nid generation:  0.00936436653137207
local_in_edges_tensor generation:  0.008738040924072266
mini_batch_src_global generation:  0.02235555648803711
r_  generation:  0.18058466911315918
local_output_nid generation:  0.009183883666992188
local_in_edges_tensor generation:  0.009263038635253906
mini_batch_src_global generation:  0.02325606346130371
r_  generation:  0.17839717864990234
local_output_nid generation:  0.00979924201965332
local_in_edges_tensor generation:  0.009752035140991211
mini_batch_src_global generation:  0.024230480194091797
r_  generation:  0.19124674797058105
local_output_nid generation:  0.00947260856628418
local_in_edges_tensor generation:  0.009559869766235352
mini_batch_src_global generation:  0.023193359375
r_  generation:  0.18376970291137695
local_output_nid generation:  0.009830713272094727
local_in_edges_tensor generation:  0.009838104248046875
mini_batch_src_global generation:  0.02428579330444336
r_  generation:  0.18840670585632324
local_output_nid generation:  0.009496927261352539
local_in_edges_tensor generation:  0.008896589279174805
mini_batch_src_global generation:  0.02317190170288086
r_  generation:  0.18172550201416016
local_output_nid generation:  0.009810209274291992
local_in_edges_tensor generation:  0.009070396423339844
mini_batch_src_global generation:  0.0238039493560791
r_  generation:  0.1910688877105713
local_output_nid generation:  0.009575843811035156
local_in_edges_tensor generation:  0.009582042694091797
mini_batch_src_global generation:  0.022790908813476562
r_  generation:  0.181837797164917
local_output_nid generation:  0.009423494338989258
local_in_edges_tensor generation:  0.008778572082519531
mini_batch_src_global generation:  0.02338385581970215
r_  generation:  0.18177294731140137
local_output_nid generation:  0.009392261505126953
local_in_edges_tensor generation:  0.009881019592285156
mini_batch_src_global generation:  0.02245616912841797
r_  generation:  0.1781630516052246
local_output_nid generation:  0.009636640548706055
local_in_edges_tensor generation:  0.009078264236450195
mini_batch_src_global generation:  0.023003816604614258
r_  generation:  0.18521642684936523
local_output_nid generation:  0.009686708450317383
local_in_edges_tensor generation:  0.011079549789428711
mini_batch_src_global generation:  0.022810935974121094
r_  generation:  0.1846909523010254
----------------------check_connections_block total spend ----------------------------- 8.487612247467041
generate_one_block  0.2517993450164795
generate_one_block  0.23798656463623047
generate_one_block  0.243927001953125
generate_one_block  0.25338149070739746
generate_one_block  0.2704181671142578
generate_one_block  0.23282265663146973
generate_one_block  0.25594544410705566
generate_one_block  0.2382802963256836
generate_one_block  0.25408053398132324
generate_one_block  0.25461721420288086
generate_one_block  0.25839924812316895
generate_one_block  0.23901033401489258
generate_one_block  0.234222412109375
generate_one_block  0.25310254096984863
generate_one_block  0.2355952262878418
generate_one_block  0.2473127841949463
generate_one_block  0.24789118766784668
generate_one_block  0.2511453628540039
generate_one_block  0.24716973304748535
generate_one_block  0.2442493438720703
generate_one_block  0.23863506317138672
generate_one_block  0.23952841758728027
generate_one_block  0.2570488452911377
generate_one_block  0.24808645248413086
generate_one_block  0.2521531581878662
generate_one_block  0.2445223331451416
generate_one_block  0.2574751377105713
generate_one_block  0.24295282363891602
generate_one_block  0.24497294425964355
generate_one_block  0.23923254013061523
generate_one_block  0.25038623809814453
generate_one_block  0.2500879764556885
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03620147705078125
gen group dst list time:  0.10529971122741699
time for parepare:  0.0199739933013916
local_output_nid generation:  0.025156736373901367
local_in_edges_tensor generation:  0.057822465896606445
mini_batch_src_global generation:  0.04724478721618652
r_  generation:  0.4906620979309082
local_output_nid generation:  0.03066873550415039
local_in_edges_tensor generation:  0.03694915771484375
mini_batch_src_global generation:  0.06084895133972168
r_  generation:  0.4811270236968994
local_output_nid generation:  0.031109094619750977
local_in_edges_tensor generation:  0.03202176094055176
mini_batch_src_global generation:  0.05734443664550781
r_  generation:  0.49713945388793945
local_output_nid generation:  0.031217098236083984
local_in_edges_tensor generation:  0.03490638732910156
mini_batch_src_global generation:  0.05885672569274902
r_  generation:  0.4943552017211914
local_output_nid generation:  0.029748201370239258
local_in_edges_tensor generation:  0.03194260597229004
mini_batch_src_global generation:  0.059204816818237305
r_  generation:  0.49989748001098633
local_output_nid generation:  0.029541492462158203
local_in_edges_tensor generation:  0.033041954040527344
mini_batch_src_global generation:  0.059239864349365234
r_  generation:  0.4914093017578125
local_output_nid generation:  0.029578685760498047
local_in_edges_tensor generation:  0.03578901290893555
mini_batch_src_global generation:  0.060579776763916016
r_  generation:  0.5050666332244873
local_output_nid generation:  0.02976369857788086
local_in_edges_tensor generation:  0.03467416763305664
mini_batch_src_global generation:  0.06163954734802246
r_  generation:  0.4945669174194336
local_output_nid generation:  0.029733896255493164
local_in_edges_tensor generation:  0.032439470291137695
mini_batch_src_global generation:  0.059146881103515625
r_  generation:  0.5026423931121826
local_output_nid generation:  0.030280351638793945
local_in_edges_tensor generation:  0.03285574913024902
mini_batch_src_global generation:  0.061818599700927734
r_  generation:  0.49787354469299316
local_output_nid generation:  0.03012681007385254
local_in_edges_tensor generation:  0.03210616111755371
mini_batch_src_global generation:  0.059044599533081055
r_  generation:  0.5036911964416504
local_output_nid generation:  0.029812335968017578
local_in_edges_tensor generation:  0.031630516052246094
mini_batch_src_global generation:  0.05937647819519043
r_  generation:  0.49318933486938477
local_output_nid generation:  0.029729604721069336
local_in_edges_tensor generation:  0.03373360633850098
mini_batch_src_global generation:  0.058255910873413086
r_  generation:  0.4973158836364746
local_output_nid generation:  0.029608726501464844
local_in_edges_tensor generation:  0.03397727012634277
mini_batch_src_global generation:  0.06292438507080078
r_  generation:  0.49652767181396484
local_output_nid generation:  0.0295560359954834
local_in_edges_tensor generation:  0.031693220138549805
mini_batch_src_global generation:  0.0576174259185791
r_  generation:  0.49395108222961426
local_output_nid generation:  0.030132770538330078
local_in_edges_tensor generation:  0.033889055252075195
mini_batch_src_global generation:  0.06241321563720703
r_  generation:  0.503148078918457
local_output_nid generation:  0.02978992462158203
local_in_edges_tensor generation:  0.03247809410095215
mini_batch_src_global generation:  0.05937552452087402
r_  generation:  0.5023751258850098
local_output_nid generation:  0.02985835075378418
local_in_edges_tensor generation:  0.03411412239074707
mini_batch_src_global generation:  0.06031537055969238
r_  generation:  0.5066070556640625
local_output_nid generation:  0.03002333641052246
local_in_edges_tensor generation:  0.03378701210021973
mini_batch_src_global generation:  0.06038355827331543
r_  generation:  0.5057597160339355
local_output_nid generation:  0.029717445373535156
local_in_edges_tensor generation:  0.03222489356994629
mini_batch_src_global generation:  0.05959010124206543
r_  generation:  0.497774600982666
local_output_nid generation:  0.029604434967041016
local_in_edges_tensor generation:  0.034032583236694336
mini_batch_src_global generation:  0.05835747718811035
r_  generation:  0.49900317192077637
local_output_nid generation:  0.02969527244567871
local_in_edges_tensor generation:  0.03364133834838867
mini_batch_src_global generation:  0.0620882511138916
r_  generation:  0.499894380569458
local_output_nid generation:  0.029779434204101562
local_in_edges_tensor generation:  0.03421163558959961
mini_batch_src_global generation:  0.05840778350830078
r_  generation:  0.5038037300109863
local_output_nid generation:  0.029893159866333008
local_in_edges_tensor generation:  0.03177380561828613
mini_batch_src_global generation:  0.05962085723876953
r_  generation:  0.5031533241271973
local_output_nid generation:  0.030201435089111328
local_in_edges_tensor generation:  0.03373146057128906
mini_batch_src_global generation:  0.0586543083190918
r_  generation:  0.5065479278564453
local_output_nid generation:  0.030384302139282227
local_in_edges_tensor generation:  0.037201642990112305
mini_batch_src_global generation:  0.0596766471862793
r_  generation:  0.5060825347900391
local_output_nid generation:  0.03015279769897461
local_in_edges_tensor generation:  0.03702282905578613
mini_batch_src_global generation:  0.05897355079650879
r_  generation:  0.5057899951934814
local_output_nid generation:  0.029964923858642578
local_in_edges_tensor generation:  0.033565521240234375
mini_batch_src_global generation:  0.059935569763183594
r_  generation:  0.5027778148651123
local_output_nid generation:  0.030019760131835938
local_in_edges_tensor generation:  0.031746864318847656
mini_batch_src_global generation:  0.05855393409729004
r_  generation:  0.5000431537628174
local_output_nid generation:  0.030266523361206055
local_in_edges_tensor generation:  0.033334970474243164
mini_batch_src_global generation:  0.06172633171081543
r_  generation:  0.497774600982666
local_output_nid generation:  0.030254364013671875
local_in_edges_tensor generation:  0.03435826301574707
mini_batch_src_global generation:  0.060768842697143555
r_  generation:  0.5087485313415527
local_output_nid generation:  0.030317068099975586
local_in_edges_tensor generation:  0.03410148620605469
mini_batch_src_global generation:  0.05974435806274414
r_  generation:  0.507021427154541
----------------------check_connections_block total spend ----------------------------- 23.482052087783813
generate_one_block  0.6889593601226807
generate_one_block  0.675344705581665
generate_one_block  0.6778159141540527
generate_one_block  0.6813509464263916
generate_one_block  0.7601802349090576
generate_one_block  0.6722123622894287
generate_one_block  0.6843867301940918
generate_one_block  0.6831653118133545
generate_one_block  0.6818082332611084
generate_one_block  0.6840295791625977
generate_one_block  0.6830430030822754
generate_one_block  0.6739740371704102
generate_one_block  0.674236536026001
generate_one_block  0.6847963333129883
generate_one_block  0.6728651523590088
generate_one_block  0.6865642070770264
generate_one_block  0.6852586269378662
generate_one_block  0.6773178577423096
generate_one_block  0.6862750053405762
generate_one_block  0.6767463684082031
generate_one_block  0.6701076030731201
generate_one_block  0.6743123531341553
generate_one_block  0.6836855411529541
generate_one_block  0.6944997310638428
generate_one_block  0.6927335262298584
generate_one_block  0.6815841197967529
generate_one_block  0.6858475208282471
generate_one_block  0.6817190647125244
generate_one_block  0.6744077205657959
generate_one_block  0.6759128570556641
generate_one_block  0.6878323554992676
generate_one_block  0.690504789352417
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.13187551498413086  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

connection checking time:  31.969664335250854
block generation total time  29.7999165058136
average batch blocks generation time:  0.931247390806675
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.1094508171081543  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.88898801803589  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10872888565063477  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.351583003997803  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10933923721313477  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.75984811782837  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10941123962402344  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.076152324676514  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10883522033691406  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.594903469085693  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10870933532714844  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.170921802520752  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10943031311035156  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.20992374420166  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10903596878051758  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 20.471004962921143  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.1096353530883789  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.169480800628662  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.10958337783813477  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 21.142306804656982  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3162841796875 GB
    Memory Allocated: 0.1095418930053711  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 21.39068078994751  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10883569717407227  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.466774463653564  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10900497436523438  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.267252445220947  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10930967330932617  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.997403621673584  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10875320434570312  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.299091815948486  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10919952392578125  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.825706005096436  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10953569412231445  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.91166114807129  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10929012298583984  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.978092670440674  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10923433303833008  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.92274522781372  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10918092727661133  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.400912284851074  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10902595520019531  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.40326499938965  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10875749588012695  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.490318298339844  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.1096954345703125  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 21.228838443756104  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10910844802856445  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.866652965545654  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10933828353881836  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 21.00535821914673  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10935497283935547  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.733474254608154  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10939931869506836  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 21.2234206199646  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10922574996948242  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.65106964111328  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10889530181884766  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.64255666732788  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10910511016845703  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.46946620941162  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10937643051147461  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.882148265838623  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.1093587875366211  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.852949142456055  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03600864112377167 |0.022429421544075012 |0.6320924386382103 |9.716302156448364e-05 |1.1920095533132553 |0.0050275325775146484 |
----------------------------------------------------------pseudo_mini_loss sum 2.1794075965881348
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  9159618
Number of first layer input nodes during this epoch:  4807541
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.13174009323120117  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027033329010009766
range selection method range initialization spend 0.014218330383300781
time for parepare:  0.01924419403076172
local_output_nid generation:  0.0010232925415039062
local_in_edges_tensor generation:  0.0062427520751953125
mini_batch_src_global generation:  0.0013918876647949219
r_  generation:  0.011476278305053711
local_output_nid generation:  0.0009660720825195312
local_in_edges_tensor generation:  0.0006961822509765625
mini_batch_src_global generation:  0.0014986991882324219
r_  generation:  0.011453866958618164
local_output_nid generation:  0.000926971435546875
local_in_edges_tensor generation:  0.0006234645843505859
mini_batch_src_global generation:  0.0011992454528808594
r_  generation:  0.010496139526367188
local_output_nid generation:  0.0008981227874755859
local_in_edges_tensor generation:  0.0005960464477539062
mini_batch_src_global generation:  0.001112222671508789
r_  generation:  0.010023832321166992
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0005841255187988281
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.009810209274291992
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.0005979537963867188
mini_batch_src_global generation:  0.0011212825775146484
r_  generation:  0.010118961334228516
local_output_nid generation:  0.0008885860443115234
local_in_edges_tensor generation:  0.0005767345428466797
mini_batch_src_global generation:  0.0010919570922851562
r_  generation:  0.01041102409362793
local_output_nid generation:  0.0008835792541503906
local_in_edges_tensor generation:  0.0005459785461425781
mini_batch_src_global generation:  0.0010848045349121094
r_  generation:  0.009990692138671875
local_output_nid generation:  0.0008852481842041016
local_in_edges_tensor generation:  0.0005753040313720703
mini_batch_src_global generation:  0.0011205673217773438
r_  generation:  0.010351181030273438
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0011630058288574219
r_  generation:  0.00999903678894043
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005609989166259766
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.010614633560180664
local_output_nid generation:  0.0008604526519775391
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0011591911315917969
r_  generation:  0.010411500930786133
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.000583648681640625
mini_batch_src_global generation:  0.0012021064758300781
r_  generation:  0.010747432708740234
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.010309457778930664
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.010538578033447266
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0005586147308349609
mini_batch_src_global generation:  0.0011744499206542969
r_  generation:  0.010635852813720703
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0006301403045654297
mini_batch_src_global generation:  0.0011782646179199219
r_  generation:  0.010846614837646484
local_output_nid generation:  0.0008685588836669922
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.0011594295501708984
r_  generation:  0.01029825210571289
local_output_nid generation:  0.0009012222290039062
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.010644674301147461
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.0011548995971679688
r_  generation:  0.010194063186645508
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0005660057067871094
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.010642528533935547
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0005755424499511719
mini_batch_src_global generation:  0.0011522769927978516
r_  generation:  0.010448932647705078
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0005490779876708984
mini_batch_src_global generation:  0.00116729736328125
r_  generation:  0.010427713394165039
local_output_nid generation:  0.0008790493011474609
local_in_edges_tensor generation:  0.0005533695220947266
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.010014772415161133
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0012617111206054688
r_  generation:  0.010990142822265625
local_output_nid generation:  0.0008542537689208984
local_in_edges_tensor generation:  0.0005660057067871094
mini_batch_src_global generation:  0.0011684894561767578
r_  generation:  0.010460138320922852
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005545616149902344
mini_batch_src_global generation:  0.0011548995971679688
r_  generation:  0.010888099670410156
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005767345428466797
mini_batch_src_global generation:  0.0012233257293701172
r_  generation:  0.010228157043457031
local_output_nid generation:  0.0008578300476074219
local_in_edges_tensor generation:  0.0005657672882080078
mini_batch_src_global generation:  0.0011305809020996094
r_  generation:  0.010731697082519531
local_output_nid generation:  0.0008685588836669922
local_in_edges_tensor generation:  0.0005595684051513672
mini_batch_src_global generation:  0.001184225082397461
r_  generation:  0.0105743408203125
local_output_nid generation:  0.0008685588836669922
local_in_edges_tensor generation:  0.0005619525909423828
mini_batch_src_global generation:  0.0011348724365234375
r_  generation:  0.010490655899047852
local_output_nid generation:  0.0008625984191894531
local_in_edges_tensor generation:  0.0005974769592285156
mini_batch_src_global generation:  0.0011823177337646484
r_  generation:  0.010173559188842773
----------------------check_connections_block total spend ----------------------------- 0.5238394737243652
generate_one_block  0.026101350784301758
generate_one_block  0.022259950637817383
generate_one_block  0.019788026809692383
generate_one_block  0.01922917366027832
generate_one_block  0.018285751342773438
generate_one_block  0.018998384475708008
generate_one_block  0.018740415573120117
generate_one_block  0.018195390701293945
generate_one_block  0.01893019676208496
generate_one_block  0.018466472625732422
generate_one_block  0.018999814987182617
generate_one_block  0.019194841384887695
generate_one_block  0.018623828887939453
generate_one_block  0.018834352493286133
generate_one_block  0.01868915557861328
generate_one_block  0.019173860549926758
generate_one_block  0.019340991973876953
generate_one_block  0.01887655258178711
generate_one_block  0.01861119270324707
generate_one_block  0.01864004135131836
generate_one_block  0.0189208984375
generate_one_block  0.01902461051940918
generate_one_block  0.018596172332763672
generate_one_block  0.018130064010620117
generate_one_block  0.020015954971313477
generate_one_block  0.018823623657226562
generate_one_block  0.0191805362701416
generate_one_block  0.01856088638305664
generate_one_block  0.01898980140686035
generate_one_block  0.01909780502319336
generate_one_block  0.018858671188354492
generate_one_block  0.018608570098876953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04041004180908203
gen group dst list time:  0.020105361938476562
time for parepare:  0.020200490951538086
local_output_nid generation:  0.005950450897216797
local_in_edges_tensor generation:  0.016632080078125
mini_batch_src_global generation:  0.018578529357910156
r_  generation:  0.1631028652191162
local_output_nid generation:  0.008217096328735352
local_in_edges_tensor generation:  0.01145029067993164
mini_batch_src_global generation:  0.02277517318725586
r_  generation:  0.17907285690307617
local_output_nid generation:  0.008249282836914062
local_in_edges_tensor generation:  0.032961368560791016
mini_batch_src_global generation:  0.020605087280273438
r_  generation:  0.17819857597351074
local_output_nid generation:  0.010208845138549805
local_in_edges_tensor generation:  0.009202241897583008
mini_batch_src_global generation:  0.020476341247558594
r_  generation:  0.1779918670654297
local_output_nid generation:  0.008619308471679688
local_in_edges_tensor generation:  0.011060476303100586
mini_batch_src_global generation:  0.02815079689025879
r_  generation:  0.16843581199645996
local_output_nid generation:  0.009131669998168945
local_in_edges_tensor generation:  0.009553909301757812
mini_batch_src_global generation:  0.021776437759399414
r_  generation:  0.17788100242614746
local_output_nid generation:  0.009131908416748047
local_in_edges_tensor generation:  0.01175236701965332
mini_batch_src_global generation:  0.023176908493041992
r_  generation:  0.17680931091308594
local_output_nid generation:  0.008727550506591797
local_in_edges_tensor generation:  0.008452177047729492
mini_batch_src_global generation:  0.0225830078125
r_  generation:  0.17180752754211426
local_output_nid generation:  0.008881807327270508
local_in_edges_tensor generation:  0.008751630783081055
mini_batch_src_global generation:  0.022739171981811523
r_  generation:  0.17865729331970215
local_output_nid generation:  0.008964300155639648
local_in_edges_tensor generation:  0.008346319198608398
mini_batch_src_global generation:  0.022301435470581055
r_  generation:  0.17775893211364746
local_output_nid generation:  0.009378194808959961
local_in_edges_tensor generation:  0.008803367614746094
mini_batch_src_global generation:  0.024046897888183594
r_  generation:  0.1830589771270752
local_output_nid generation:  0.009328365325927734
local_in_edges_tensor generation:  0.01012563705444336
mini_batch_src_global generation:  0.024091720581054688
r_  generation:  0.1840381622314453
local_output_nid generation:  0.009194612503051758
local_in_edges_tensor generation:  0.009150505065917969
mini_batch_src_global generation:  0.023389101028442383
r_  generation:  0.17798972129821777
local_output_nid generation:  0.009537935256958008
local_in_edges_tensor generation:  0.008844852447509766
mini_batch_src_global generation:  0.023006677627563477
r_  generation:  0.18307900428771973
local_output_nid generation:  0.009386301040649414
local_in_edges_tensor generation:  0.010519742965698242
mini_batch_src_global generation:  0.023060083389282227
r_  generation:  0.1790928840637207
local_output_nid generation:  0.009642601013183594
local_in_edges_tensor generation:  0.008979320526123047
mini_batch_src_global generation:  0.023252248764038086
r_  generation:  0.18676376342773438
local_output_nid generation:  0.009608983993530273
local_in_edges_tensor generation:  0.01018214225769043
mini_batch_src_global generation:  0.023469924926757812
r_  generation:  0.18511152267456055
local_output_nid generation:  0.009572505950927734
local_in_edges_tensor generation:  0.00943446159362793
mini_batch_src_global generation:  0.023063182830810547
r_  generation:  0.18272781372070312
local_output_nid generation:  0.009435892105102539
local_in_edges_tensor generation:  0.00865626335144043
mini_batch_src_global generation:  0.022638559341430664
r_  generation:  0.17787742614746094
local_output_nid generation:  0.009523391723632812
local_in_edges_tensor generation:  0.008670330047607422
mini_batch_src_global generation:  0.02486276626586914
r_  generation:  0.17919063568115234
local_output_nid generation:  0.009606361389160156
local_in_edges_tensor generation:  0.00849771499633789
mini_batch_src_global generation:  0.022818326950073242
r_  generation:  0.18386316299438477
local_output_nid generation:  0.00952601432800293
local_in_edges_tensor generation:  0.00941610336303711
mini_batch_src_global generation:  0.024231672286987305
r_  generation:  0.1860363483428955
local_output_nid generation:  0.009468555450439453
local_in_edges_tensor generation:  0.008774757385253906
mini_batch_src_global generation:  0.022400617599487305
r_  generation:  0.18175983428955078
local_output_nid generation:  0.009335756301879883
local_in_edges_tensor generation:  0.00855255126953125
mini_batch_src_global generation:  0.02186274528503418
r_  generation:  0.1783459186553955
local_output_nid generation:  0.009923458099365234
local_in_edges_tensor generation:  0.009611129760742188
mini_batch_src_global generation:  0.02460193634033203
r_  generation:  0.19109296798706055
local_output_nid generation:  0.00932621955871582
local_in_edges_tensor generation:  0.009296655654907227
mini_batch_src_global generation:  0.022668123245239258
r_  generation:  0.18565058708190918
local_output_nid generation:  0.009641408920288086
local_in_edges_tensor generation:  0.009745597839355469
mini_batch_src_global generation:  0.023281574249267578
r_  generation:  0.18770670890808105
local_output_nid generation:  0.009552001953125
local_in_edges_tensor generation:  0.008739709854125977
mini_batch_src_global generation:  0.023016929626464844
r_  generation:  0.18150854110717773
local_output_nid generation:  0.00949549674987793
local_in_edges_tensor generation:  0.008718729019165039
mini_batch_src_global generation:  0.023254871368408203
r_  generation:  0.18507647514343262
local_output_nid generation:  0.009667396545410156
local_in_edges_tensor generation:  0.010343313217163086
mini_batch_src_global generation:  0.022589683532714844
r_  generation:  0.18389534950256348
local_output_nid generation:  0.009632587432861328
local_in_edges_tensor generation:  0.008824825286865234
mini_batch_src_global generation:  0.02269601821899414
r_  generation:  0.18164587020874023
local_output_nid generation:  0.009452342987060547
local_in_edges_tensor generation:  0.009156227111816406
mini_batch_src_global generation:  0.0225064754486084
r_  generation:  0.1793527603149414
----------------------check_connections_block total spend ----------------------------- 8.46969485282898
generate_one_block  0.25588250160217285
generate_one_block  0.2577321529388428
generate_one_block  0.24882960319519043
generate_one_block  0.24776268005371094
generate_one_block  0.2631103992462158
generate_one_block  0.24585580825805664
generate_one_block  0.243180513381958
generate_one_block  0.23635077476501465
generate_one_block  0.24585676193237305
generate_one_block  0.24382424354553223
generate_one_block  0.25038838386535645
generate_one_block  0.2539944648742676
generate_one_block  0.24156928062438965
generate_one_block  0.25026464462280273
generate_one_block  0.24177837371826172
generate_one_block  0.2524559497833252
generate_one_block  0.25379419326782227
generate_one_block  0.24567127227783203
generate_one_block  0.23886561393737793
generate_one_block  0.2462146282196045
generate_one_block  0.24809598922729492
generate_one_block  0.25002074241638184
generate_one_block  0.24251079559326172
generate_one_block  0.24074244499206543
generate_one_block  0.2615692615509033
generate_one_block  0.24696087837219238
generate_one_block  0.25332212448120117
generate_one_block  0.2412583827972412
generate_one_block  0.24939250946044922
generate_one_block  0.2471776008605957
generate_one_block  0.2452857494354248
generate_one_block  0.24065423011779785
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039923667907714844
gen group dst list time:  0.10458922386169434
time for parepare:  0.019449234008789062
local_output_nid generation:  0.024574756622314453
local_in_edges_tensor generation:  0.050978660583496094
mini_batch_src_global generation:  0.04870462417602539
r_  generation:  0.4894685745239258
local_output_nid generation:  0.030520200729370117
local_in_edges_tensor generation:  0.03806018829345703
mini_batch_src_global generation:  0.06382179260253906
r_  generation:  0.48861217498779297
local_output_nid generation:  0.03050374984741211
local_in_edges_tensor generation:  0.03844571113586426
mini_batch_src_global generation:  0.05793309211730957
r_  generation:  0.4981977939605713
local_output_nid generation:  0.03084397315979004
local_in_edges_tensor generation:  0.029616594314575195
mini_batch_src_global generation:  0.060883522033691406
r_  generation:  0.4910392761230469
local_output_nid generation:  0.030605792999267578
local_in_edges_tensor generation:  0.03842663764953613
mini_batch_src_global generation:  0.06097006797790527
r_  generation:  0.4974205493927002
local_output_nid generation:  0.029312610626220703
local_in_edges_tensor generation:  0.029400110244750977
mini_batch_src_global generation:  0.05960273742675781
r_  generation:  0.495593786239624
local_output_nid generation:  0.02870488166809082
local_in_edges_tensor generation:  0.031255483627319336
mini_batch_src_global generation:  0.06097984313964844
r_  generation:  0.5037729740142822
local_output_nid generation:  0.02861642837524414
local_in_edges_tensor generation:  0.03380393981933594
mini_batch_src_global generation:  0.059755563735961914
r_  generation:  0.49135422706604004
local_output_nid generation:  0.029187917709350586
local_in_edges_tensor generation:  0.02970290184020996
mini_batch_src_global generation:  0.05893754959106445
r_  generation:  0.5011379718780518
local_output_nid generation:  0.02920842170715332
local_in_edges_tensor generation:  0.029216766357421875
mini_batch_src_global generation:  0.059754133224487305
r_  generation:  0.4989311695098877
local_output_nid generation:  0.029534101486206055
local_in_edges_tensor generation:  0.02897024154663086
mini_batch_src_global generation:  0.06110334396362305
r_  generation:  0.5175156593322754
local_output_nid generation:  0.029450416564941406
local_in_edges_tensor generation:  0.03343629837036133
mini_batch_src_global generation:  0.06004190444946289
r_  generation:  0.5004599094390869
local_output_nid generation:  0.029181957244873047
local_in_edges_tensor generation:  0.030600547790527344
mini_batch_src_global generation:  0.058873653411865234
r_  generation:  0.5015716552734375
local_output_nid generation:  0.03145885467529297
local_in_edges_tensor generation:  0.029947757720947266
mini_batch_src_global generation:  0.060064077377319336
r_  generation:  0.4958376884460449
local_output_nid generation:  0.0291595458984375
local_in_edges_tensor generation:  0.03017711639404297
mini_batch_src_global generation:  0.05886030197143555
r_  generation:  0.49715518951416016
local_output_nid generation:  0.029126405715942383
local_in_edges_tensor generation:  0.029093265533447266
mini_batch_src_global generation:  0.06009411811828613
r_  generation:  0.49680233001708984
local_output_nid generation:  0.029043912887573242
local_in_edges_tensor generation:  0.033359527587890625
mini_batch_src_global generation:  0.05836081504821777
r_  generation:  0.4998664855957031
local_output_nid generation:  0.029239892959594727
local_in_edges_tensor generation:  0.03188633918762207
mini_batch_src_global generation:  0.05974888801574707
r_  generation:  0.502577543258667
local_output_nid generation:  0.029158592224121094
local_in_edges_tensor generation:  0.02991199493408203
mini_batch_src_global generation:  0.05860257148742676
r_  generation:  0.49799251556396484
local_output_nid generation:  0.02945876121520996
local_in_edges_tensor generation:  0.03155708312988281
mini_batch_src_global generation:  0.06170344352722168
r_  generation:  0.501558780670166
local_output_nid generation:  0.02936697006225586
local_in_edges_tensor generation:  0.030708789825439453
mini_batch_src_global generation:  0.05879616737365723
r_  generation:  0.500718355178833
local_output_nid generation:  0.02951526641845703
local_in_edges_tensor generation:  0.03124403953552246
mini_batch_src_global generation:  0.060637712478637695
r_  generation:  0.5015387535095215
local_output_nid generation:  0.030211448669433594
local_in_edges_tensor generation:  0.030855894088745117
mini_batch_src_global generation:  0.05878877639770508
r_  generation:  0.5085926055908203
local_output_nid generation:  0.02959132194519043
local_in_edges_tensor generation:  0.03133392333984375
mini_batch_src_global generation:  0.06017017364501953
r_  generation:  0.5013916492462158
local_output_nid generation:  0.029839277267456055
local_in_edges_tensor generation:  0.034453630447387695
mini_batch_src_global generation:  0.059218406677246094
r_  generation:  0.5105843544006348
local_output_nid generation:  0.029442787170410156
local_in_edges_tensor generation:  0.029963970184326172
mini_batch_src_global generation:  0.0601346492767334
r_  generation:  0.509735107421875
local_output_nid generation:  0.02910923957824707
local_in_edges_tensor generation:  0.03213143348693848
mini_batch_src_global generation:  0.05889248847961426
r_  generation:  0.5099132061004639
local_output_nid generation:  0.029382944107055664
local_in_edges_tensor generation:  0.03136849403381348
mini_batch_src_global generation:  0.061219215393066406
r_  generation:  0.49736452102661133
local_output_nid generation:  0.02924370765686035
local_in_edges_tensor generation:  0.029459714889526367
mini_batch_src_global generation:  0.058850765228271484
r_  generation:  0.510732889175415
local_output_nid generation:  0.029529809951782227
local_in_edges_tensor generation:  0.034317731857299805
mini_batch_src_global generation:  0.06238150596618652
r_  generation:  0.5074863433837891
local_output_nid generation:  0.029779434204101562
local_in_edges_tensor generation:  0.02964305877685547
mini_batch_src_global generation:  0.05916953086853027
r_  generation:  0.5108349323272705
local_output_nid generation:  0.029551982879638672
local_in_edges_tensor generation:  0.03258800506591797
mini_batch_src_global generation:  0.06029772758483887
r_  generation:  0.5033564567565918
----------------------check_connections_block total spend ----------------------------- 23.443607807159424
generate_one_block  0.695906400680542
generate_one_block  0.6851100921630859
generate_one_block  0.6807353496551514
generate_one_block  0.6767604351043701
generate_one_block  0.7654688358306885
generate_one_block  0.679253101348877
generate_one_block  0.6758925914764404
generate_one_block  0.6692497730255127
generate_one_block  0.6697309017181396
generate_one_block  0.6855840682983398
generate_one_block  0.6769592761993408
generate_one_block  0.6863033771514893
generate_one_block  0.6707019805908203
generate_one_block  0.6746006011962891
generate_one_block  0.6689345836639404
generate_one_block  0.6785528659820557
generate_one_block  0.6854019165039062
generate_one_block  0.6777276992797852
generate_one_block  0.6737103462219238
generate_one_block  0.677626371383667
generate_one_block  0.6819310188293457
generate_one_block  0.6888911724090576
generate_one_block  0.6774680614471436
generate_one_block  0.684600830078125
generate_one_block  0.7105860710144043
generate_one_block  0.6824734210968018
generate_one_block  0.6812865734100342
generate_one_block  0.6774446964263916
generate_one_block  0.6796414852142334
generate_one_block  0.6713933944702148
generate_one_block  0.6748325824737549
generate_one_block  0.6791191101074219
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.13174009323120117  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

connection checking time:  31.913302659988403
block generation total time  29.77425193786621
average batch blocks generation time:  0.9304453730583191
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10944032669067383  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.95004177093506  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 0.10948467254638672  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2069091796875 GB
    Memory Allocated: 21.298110008239746  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7088623046875 GB
    Memory Allocated: 0.10930490493774414  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6776123046875 GB
    Memory Allocated: 20.896498680114746  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6795654296875 GB
    Memory Allocated: 0.10941791534423828  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8084716796875 GB
    Memory Allocated: 20.888261318206787  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8084716796875 GB
    Memory Allocated: 0.1088876724243164  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8084716796875 GB
    Memory Allocated: 20.269766807556152  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8084716796875 GB
    Memory Allocated: 0.10911798477172852  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8084716796875 GB
    Memory Allocated: 20.79197406768799  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8084716796875 GB
    Memory Allocated: 0.10910987854003906  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8240966796875 GB
    Memory Allocated: 20.603780269622803  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8280029296875 GB
    Memory Allocated: 0.10900497436523438  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8280029296875 GB
    Memory Allocated: 20.252418041229248  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8280029296875 GB
    Memory Allocated: 0.10904932022094727  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8280029296875 GB
    Memory Allocated: 20.71735954284668  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8280029296875 GB
    Memory Allocated: 0.109039306640625  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8280029296875 GB
    Memory Allocated: 20.636423110961914  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8280029296875 GB
    Memory Allocated: 0.10924816131591797  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8358154296875 GB
    Memory Allocated: 20.95665454864502  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8377685546875 GB
    Memory Allocated: 0.1092977523803711  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 21.09018564224243  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.1087946891784668  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 20.55165958404541  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.10931873321533203  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 20.885043144226074  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.1088418960571289  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 20.518035888671875  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.10927820205688477  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 21.021028518676758  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.10927104949951172  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 21.015592575073242  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.1092376708984375  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 20.78816509246826  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.10931825637817383  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 20.455323219299316  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.10918140411376953  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 20.564589023590088  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.10932350158691406  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 20.744600772857666  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.1091923713684082  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 20.811043739318848  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.10912561416625977  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 20.498274326324463  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.10919857025146484  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 20.508212089538574  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9744873046875 GB
    Memory Allocated: 0.1095433235168457  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1092529296875 GB
    Memory Allocated: 21.262492656707764  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5272216796875 GB
    Memory Allocated: 0.10907983779907227  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8983154296875 GB
    Memory Allocated: 20.74963092803955  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9002685546875 GB
    Memory Allocated: 0.10947561264038086  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9002685546875 GB
    Memory Allocated: 21.04268217086792  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9002685546875 GB
    Memory Allocated: 0.10925054550170898  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9002685546875 GB
    Memory Allocated: 20.63419246673584  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9002685546875 GB
    Memory Allocated: 0.10924005508422852  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9002685546875 GB
    Memory Allocated: 20.881305694580078  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9002685546875 GB
    Memory Allocated: 0.10928916931152344  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9002685546875 GB
    Memory Allocated: 20.74040174484253  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9002685546875 GB
    Memory Allocated: 0.10918283462524414  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9666748046875 GB
    Memory Allocated: 20.677783966064453  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.10910749435424805  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 20.551655292510986  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027379639446735382 |0.02354288101196289 |0.6805318892002106 |9.676814079284668e-05 |1.1955469623208046 |0.004033088684082031 |
----------------------------------------------------------pseudo_mini_loss sum 2.0425338745117188
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  9158456
Number of first layer input nodes during this epoch:  4808139
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.1309823989868164  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029103755950927734
range selection method range initialization spend 0.014019012451171875
time for parepare:  0.019857406616210938
local_output_nid generation:  0.0010402202606201172
local_in_edges_tensor generation:  0.006147146224975586
mini_batch_src_global generation:  0.0017178058624267578
r_  generation:  0.010944366455078125
local_output_nid generation:  0.0009639263153076172
local_in_edges_tensor generation:  0.0007278919219970703
mini_batch_src_global generation:  0.0015912055969238281
r_  generation:  0.010686635971069336
local_output_nid generation:  0.0008993148803710938
local_in_edges_tensor generation:  0.0006279945373535156
mini_batch_src_global generation:  0.0010957717895507812
r_  generation:  0.009615898132324219
local_output_nid generation:  0.0008969306945800781
local_in_edges_tensor generation:  0.0006070137023925781
mini_batch_src_global generation:  0.0010759830474853516
r_  generation:  0.009902000427246094
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0006015300750732422
mini_batch_src_global generation:  0.0010769367218017578
r_  generation:  0.010005474090576172
local_output_nid generation:  0.0008671283721923828
local_in_edges_tensor generation:  0.0006086826324462891
mini_batch_src_global generation:  0.0011916160583496094
r_  generation:  0.01043701171875
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005984306335449219
mini_batch_src_global generation:  0.0011112689971923828
r_  generation:  0.010148286819458008
local_output_nid generation:  0.0008873939514160156
local_in_edges_tensor generation:  0.00058746337890625
mini_batch_src_global generation:  0.0010848045349121094
r_  generation:  0.010149240493774414
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0010781288146972656
r_  generation:  0.0099945068359375
local_output_nid generation:  0.0009226799011230469
local_in_edges_tensor generation:  0.0005955696105957031
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.01038980484008789
local_output_nid generation:  0.0008609294891357422
local_in_edges_tensor generation:  0.0005857944488525391
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.010175228118896484
local_output_nid generation:  0.0008537769317626953
local_in_edges_tensor generation:  0.0006136894226074219
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.010532140731811523
local_output_nid generation:  0.0008547306060791016
local_in_edges_tensor generation:  0.0005846023559570312
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.009751558303833008
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0006570816040039062
mini_batch_src_global generation:  0.0011827945709228516
r_  generation:  0.010530233383178711
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.0011277198791503906
r_  generation:  0.010223150253295898
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0005788803100585938
mini_batch_src_global generation:  0.0011868476867675781
r_  generation:  0.010236263275146484
local_output_nid generation:  0.0008661746978759766
local_in_edges_tensor generation:  0.0006024837493896484
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.010666608810424805
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0005981922149658203
mini_batch_src_global generation:  0.0011181831359863281
r_  generation:  0.010154962539672852
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.00109100341796875
r_  generation:  0.010013580322265625
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0006165504455566406
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.010370731353759766
local_output_nid generation:  0.0008521080017089844
local_in_edges_tensor generation:  0.0005741119384765625
mini_batch_src_global generation:  0.0011544227600097656
r_  generation:  0.010270833969116211
local_output_nid generation:  0.0008840560913085938
local_in_edges_tensor generation:  0.0005841255187988281
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.01055288314819336
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.0011210441589355469
r_  generation:  0.010380744934082031
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.0011119842529296875
r_  generation:  0.01026010513305664
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005767345428466797
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.010179996490478516
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0005705356597900391
mini_batch_src_global generation:  0.001110076904296875
r_  generation:  0.010410308837890625
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.000579833984375
mini_batch_src_global generation:  0.0012123584747314453
r_  generation:  0.010432004928588867
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.001165628433227539
r_  generation:  0.010174036026000977
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0005841255187988281
mini_batch_src_global generation:  0.0011072158813476562
r_  generation:  0.010111570358276367
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0011298656463623047
r_  generation:  0.010436058044433594
local_output_nid generation:  0.0008618831634521484
local_in_edges_tensor generation:  0.0005941390991210938
mini_batch_src_global generation:  0.001138925552368164
r_  generation:  0.010293722152709961
local_output_nid generation:  0.0008771419525146484
local_in_edges_tensor generation:  0.0005824565887451172
mini_batch_src_global generation:  0.0012199878692626953
r_  generation:  0.010511398315429688
----------------------check_connections_block total spend ----------------------------- 0.520106315612793
generate_one_block  0.025754928588867188
generate_one_block  0.02218770980834961
generate_one_block  0.019297122955322266
generate_one_block  0.0195314884185791
generate_one_block  0.019540071487426758
generate_one_block  0.019879817962646484
generate_one_block  0.019347190856933594
generate_one_block  0.019166231155395508
generate_one_block  0.018959999084472656
generate_one_block  0.01955437660217285
generate_one_block  0.019177913665771484
generate_one_block  0.019840717315673828
generate_one_block  0.01824188232421875
generate_one_block  0.021400928497314453
generate_one_block  0.01894378662109375
generate_one_block  0.01911449432373047
generate_one_block  0.019539356231689453
generate_one_block  0.018888473510742188
generate_one_block  0.018659114837646484
generate_one_block  0.019440650939941406
generate_one_block  0.019049882888793945
generate_one_block  0.019616127014160156
generate_one_block  0.019312620162963867
generate_one_block  0.018822908401489258
generate_one_block  0.018752574920654297
generate_one_block  0.0191800594329834
generate_one_block  0.019353151321411133
generate_one_block  0.018901348114013672
generate_one_block  0.018633127212524414
generate_one_block  0.019254446029663086
generate_one_block  0.0188901424407959
generate_one_block  0.01939249038696289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0374150276184082
gen group dst list time:  0.02341151237487793
time for parepare:  0.022001266479492188
local_output_nid generation:  0.0058460235595703125
local_in_edges_tensor generation:  0.017571449279785156
mini_batch_src_global generation:  0.017986774444580078
r_  generation:  0.16184210777282715
local_output_nid generation:  0.00819849967956543
local_in_edges_tensor generation:  0.009864330291748047
mini_batch_src_global generation:  0.022762060165405273
r_  generation:  0.17255258560180664
local_output_nid generation:  0.00810384750366211
local_in_edges_tensor generation:  0.03236889839172363
mini_batch_src_global generation:  0.019897937774658203
r_  generation:  0.16769814491271973
local_output_nid generation:  0.008498907089233398
local_in_edges_tensor generation:  0.011547565460205078
mini_batch_src_global generation:  0.021322250366210938
r_  generation:  0.17499923706054688
local_output_nid generation:  0.008724451065063477
local_in_edges_tensor generation:  0.00875401496887207
mini_batch_src_global generation:  0.022829771041870117
r_  generation:  0.17937684059143066
local_output_nid generation:  0.009224414825439453
local_in_edges_tensor generation:  0.010737419128417969
mini_batch_src_global generation:  0.023421287536621094
r_  generation:  0.18178701400756836
local_output_nid generation:  0.00902557373046875
local_in_edges_tensor generation:  0.008665323257446289
mini_batch_src_global generation:  0.022863149642944336
r_  generation:  0.1810617446899414
local_output_nid generation:  0.008624792098999023
local_in_edges_tensor generation:  0.008591890335083008
mini_batch_src_global generation:  0.022735595703125
r_  generation:  0.17766237258911133
local_output_nid generation:  0.008706808090209961
local_in_edges_tensor generation:  0.008757591247558594
mini_batch_src_global generation:  0.022311687469482422
r_  generation:  0.1778697967529297
local_output_nid generation:  0.009002447128295898
local_in_edges_tensor generation:  0.008730888366699219
mini_batch_src_global generation:  0.02278614044189453
r_  generation:  0.1818387508392334
local_output_nid generation:  0.009268045425415039
local_in_edges_tensor generation:  0.009045600891113281
mini_batch_src_global generation:  0.022861003875732422
r_  generation:  0.18015050888061523
local_output_nid generation:  0.009335041046142578
local_in_edges_tensor generation:  0.008676290512084961
mini_batch_src_global generation:  0.023087263107299805
r_  generation:  0.18325424194335938
local_output_nid generation:  0.008796453475952148
local_in_edges_tensor generation:  0.01129460334777832
mini_batch_src_global generation:  0.022542953491210938
r_  generation:  0.1734931468963623
local_output_nid generation:  0.009452581405639648
local_in_edges_tensor generation:  0.008991003036499023
mini_batch_src_global generation:  0.023351669311523438
r_  generation:  0.18668699264526367
local_output_nid generation:  0.009129762649536133
local_in_edges_tensor generation:  0.008556365966796875
mini_batch_src_global generation:  0.02254939079284668
r_  generation:  0.17688632011413574
local_output_nid generation:  0.009309768676757812
local_in_edges_tensor generation:  0.00924992561340332
mini_batch_src_global generation:  0.02286243438720703
r_  generation:  0.18186378479003906
local_output_nid generation:  0.009564399719238281
local_in_edges_tensor generation:  0.01172637939453125
mini_batch_src_global generation:  0.024564266204833984
r_  generation:  0.18754291534423828
local_output_nid generation:  0.009176492691040039
local_in_edges_tensor generation:  0.00884556770324707
mini_batch_src_global generation:  0.022777080535888672
r_  generation:  0.1773843765258789
local_output_nid generation:  0.009200334548950195
local_in_edges_tensor generation:  0.008565187454223633
mini_batch_src_global generation:  0.02187514305114746
r_  generation:  0.17824673652648926
local_output_nid generation:  0.00947117805480957
local_in_edges_tensor generation:  0.008869647979736328
mini_batch_src_global generation:  0.024364948272705078
r_  generation:  0.1857771873474121
local_output_nid generation:  0.009347200393676758
local_in_edges_tensor generation:  0.009414911270141602
mini_batch_src_global generation:  0.022867918014526367
r_  generation:  0.18220210075378418
local_output_nid generation:  0.009694337844848633
local_in_edges_tensor generation:  0.008968830108642578
mini_batch_src_global generation:  0.023287296295166016
r_  generation:  0.18849420547485352
local_output_nid generation:  0.009551763534545898
local_in_edges_tensor generation:  0.009691238403320312
mini_batch_src_global generation:  0.023082494735717773
r_  generation:  0.18681621551513672
local_output_nid generation:  0.009328126907348633
local_in_edges_tensor generation:  0.00876760482788086
mini_batch_src_global generation:  0.022478103637695312
r_  generation:  0.18147826194763184
local_output_nid generation:  0.009392499923706055
local_in_edges_tensor generation:  0.008691072463989258
mini_batch_src_global generation:  0.02283930778503418
r_  generation:  0.18128085136413574
local_output_nid generation:  0.009348154067993164
local_in_edges_tensor generation:  0.009000539779663086
mini_batch_src_global generation:  0.02310657501220703
r_  generation:  0.18182134628295898
local_output_nid generation:  0.00946354866027832
local_in_edges_tensor generation:  0.00915980339050293
mini_batch_src_global generation:  0.023154258728027344
r_  generation:  0.18859219551086426
local_output_nid generation:  0.009460926055908203
local_in_edges_tensor generation:  0.009150266647338867
mini_batch_src_global generation:  0.023273944854736328
r_  generation:  0.184051513671875
local_output_nid generation:  0.00928640365600586
local_in_edges_tensor generation:  0.008685827255249023
mini_batch_src_global generation:  0.022305011749267578
r_  generation:  0.18279647827148438
local_output_nid generation:  0.009525775909423828
local_in_edges_tensor generation:  0.009002447128295898
mini_batch_src_global generation:  0.02322673797607422
r_  generation:  0.18939685821533203
local_output_nid generation:  0.00941324234008789
local_in_edges_tensor generation:  0.008671283721923828
mini_batch_src_global generation:  0.023071765899658203
r_  generation:  0.18315982818603516
local_output_nid generation:  0.009664297103881836
local_in_edges_tensor generation:  0.008801460266113281
mini_batch_src_global generation:  0.022961139678955078
r_  generation:  0.18396997451782227
----------------------check_connections_block total spend ----------------------------- 8.456084251403809
generate_one_block  0.24318909645080566
generate_one_block  0.2530341148376465
generate_one_block  0.24252080917358398
generate_one_block  0.250246524810791
generate_one_block  0.27803540229797363
generate_one_block  0.2539403438568115
generate_one_block  0.2534198760986328
generate_one_block  0.2458348274230957
generate_one_block  0.24785113334655762
generate_one_block  0.25136899948120117
generate_one_block  0.24238181114196777
generate_one_block  0.2509305477142334
generate_one_block  0.23763704299926758
generate_one_block  0.25545239448547363
generate_one_block  0.24002361297607422
generate_one_block  0.2503635883331299
generate_one_block  0.25478339195251465
generate_one_block  0.2393636703491211
generate_one_block  0.23949813842773438
generate_one_block  0.2607614994049072
generate_one_block  0.24631166458129883
generate_one_block  0.2606949806213379
generate_one_block  0.24835872650146484
generate_one_block  0.24647307395935059
generate_one_block  0.24616432189941406
generate_one_block  0.24686431884765625
generate_one_block  0.25101566314697266
generate_one_block  0.24739503860473633
generate_one_block  0.24206972122192383
generate_one_block  0.25658488273620605
generate_one_block  0.24909639358520508
generate_one_block  0.2508730888366699
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032488107681274414
gen group dst list time:  0.10729813575744629
time for parepare:  0.019890785217285156
local_output_nid generation:  0.024700641632080078
local_in_edges_tensor generation:  0.04383349418640137
mini_batch_src_global generation:  0.04811215400695801
r_  generation:  0.49718165397644043
local_output_nid generation:  0.030942916870117188
local_in_edges_tensor generation:  0.040996551513671875
mini_batch_src_global generation:  0.059095144271850586
r_  generation:  0.4952855110168457
local_output_nid generation:  0.03055596351623535
local_in_edges_tensor generation:  0.028227806091308594
mini_batch_src_global generation:  0.057489871978759766
r_  generation:  0.5034880638122559
local_output_nid generation:  0.031003236770629883
local_in_edges_tensor generation:  0.032210350036621094
mini_batch_src_global generation:  0.05805039405822754
r_  generation:  0.49904561042785645
local_output_nid generation:  0.031504154205322266
local_in_edges_tensor generation:  0.03282642364501953
mini_batch_src_global generation:  0.0576326847076416
r_  generation:  0.5100514888763428
local_output_nid generation:  0.030689239501953125
local_in_edges_tensor generation:  0.0310361385345459
mini_batch_src_global generation:  0.059825897216796875
r_  generation:  0.5015265941619873
local_output_nid generation:  0.029204845428466797
local_in_edges_tensor generation:  0.028540372848510742
mini_batch_src_global generation:  0.057976484298706055
r_  generation:  0.5129446983337402
local_output_nid generation:  0.029250621795654297
local_in_edges_tensor generation:  0.030603885650634766
mini_batch_src_global generation:  0.05949592590332031
r_  generation:  0.49637675285339355
local_output_nid generation:  0.029171228408813477
local_in_edges_tensor generation:  0.028874635696411133
mini_batch_src_global generation:  0.05826973915100098
r_  generation:  0.5020813941955566
local_output_nid generation:  0.02948904037475586
local_in_edges_tensor generation:  0.03638052940368652
mini_batch_src_global generation:  0.059554338455200195
r_  generation:  0.5006086826324463
local_output_nid generation:  0.02937793731689453
local_in_edges_tensor generation:  0.02868509292602539
mini_batch_src_global generation:  0.05819296836853027
r_  generation:  0.49941325187683105
local_output_nid generation:  0.029440641403198242
local_in_edges_tensor generation:  0.030684232711791992
mini_batch_src_global generation:  0.06112480163574219
r_  generation:  0.4970078468322754
local_output_nid generation:  0.02899646759033203
local_in_edges_tensor generation:  0.028184175491333008
mini_batch_src_global generation:  0.05749988555908203
r_  generation:  0.49152565002441406
local_output_nid generation:  0.029480457305908203
local_in_edges_tensor generation:  0.02893829345703125
mini_batch_src_global generation:  0.06119275093078613
r_  generation:  0.5010449886322021
local_output_nid generation:  0.029495954513549805
local_in_edges_tensor generation:  0.03302788734436035
mini_batch_src_global generation:  0.05802655220031738
r_  generation:  0.500687837600708
local_output_nid generation:  0.029530048370361328
local_in_edges_tensor generation:  0.030460119247436523
mini_batch_src_global generation:  0.0593717098236084
r_  generation:  0.5004539489746094
local_output_nid generation:  0.02985692024230957
local_in_edges_tensor generation:  0.03344845771789551
mini_batch_src_global generation:  0.058447837829589844
r_  generation:  0.5065922737121582
local_output_nid generation:  0.029783964157104492
local_in_edges_tensor generation:  0.02894735336303711
mini_batch_src_global generation:  0.05945634841918945
r_  generation:  0.498795747756958
local_output_nid generation:  0.02975606918334961
local_in_edges_tensor generation:  0.03106999397277832
mini_batch_src_global generation:  0.0600590705871582
r_  generation:  0.5021946430206299
local_output_nid generation:  0.029792070388793945
local_in_edges_tensor generation:  0.03323817253112793
mini_batch_src_global generation:  0.06201481819152832
r_  generation:  0.5019330978393555
local_output_nid generation:  0.029589176177978516
local_in_edges_tensor generation:  0.03082561492919922
mini_batch_src_global generation:  0.057689666748046875
r_  generation:  0.5007905960083008
local_output_nid generation:  0.030071735382080078
local_in_edges_tensor generation:  0.02972865104675293
mini_batch_src_global generation:  0.05985116958618164
r_  generation:  0.49852561950683594
local_output_nid generation:  0.029782772064208984
local_in_edges_tensor generation:  0.035309553146362305
mini_batch_src_global generation:  0.06051492691040039
r_  generation:  0.49878787994384766
local_output_nid generation:  0.02948474884033203
local_in_edges_tensor generation:  0.028621435165405273
mini_batch_src_global generation:  0.058869123458862305
r_  generation:  0.4933614730834961
local_output_nid generation:  0.02955317497253418
local_in_edges_tensor generation:  0.03109908103942871
mini_batch_src_global generation:  0.05989384651184082
r_  generation:  0.5016922950744629
local_output_nid generation:  0.029671430587768555
local_in_edges_tensor generation:  0.02850651741027832
mini_batch_src_global generation:  0.05952000617980957
r_  generation:  0.49384522438049316
local_output_nid generation:  0.029407501220703125
local_in_edges_tensor generation:  0.030341625213623047
mini_batch_src_global generation:  0.06120920181274414
r_  generation:  0.5074660778045654
local_output_nid generation:  0.029802560806274414
local_in_edges_tensor generation:  0.03136849403381348
mini_batch_src_global generation:  0.060153961181640625
r_  generation:  0.5031318664550781
local_output_nid generation:  0.02954721450805664
local_in_edges_tensor generation:  0.03159523010253906
mini_batch_src_global generation:  0.05806922912597656
r_  generation:  0.5036628246307373
local_output_nid generation:  0.029582977294921875
local_in_edges_tensor generation:  0.034647226333618164
mini_batch_src_global generation:  0.0595853328704834
r_  generation:  0.5034852027893066
local_output_nid generation:  0.02973484992980957
local_in_edges_tensor generation:  0.02841043472290039
mini_batch_src_global generation:  0.057706356048583984
r_  generation:  0.503187894821167
local_output_nid generation:  0.03009796142578125
local_in_edges_tensor generation:  0.030480146408081055
mini_batch_src_global generation:  0.06109762191772461
r_  generation:  0.4973728656768799
----------------------check_connections_block total spend ----------------------------- 23.36542558670044
generate_one_block  0.684910774230957
generate_one_block  0.6815183162689209
generate_one_block  0.6733295917510986
generate_one_block  0.6825950145721436
generate_one_block  0.7735679149627686
generate_one_block  0.6761295795440674
generate_one_block  0.6752092838287354
generate_one_block  0.6771416664123535
generate_one_block  0.6762504577636719
generate_one_block  0.6845424175262451
generate_one_block  0.672278642654419
generate_one_block  0.6784837245941162
generate_one_block  0.6711645126342773
generate_one_block  0.6922731399536133
generate_one_block  0.674292802810669
generate_one_block  0.6843297481536865
generate_one_block  0.7003283500671387
generate_one_block  0.6720614433288574
generate_one_block  0.6760365962982178
generate_one_block  0.6897430419921875
generate_one_block  0.67299485206604
generate_one_block  0.6940336227416992
generate_one_block  0.6709074974060059
generate_one_block  0.6791138648986816
generate_one_block  0.7025265693664551
generate_one_block  0.681398868560791
generate_one_block  0.6896696090698242
generate_one_block  0.6750771999359131
generate_one_block  0.6736950874328613
generate_one_block  0.6821410655975342
generate_one_block  0.6776316165924072
generate_one_block  0.6756031513214111
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.1309823989868164  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

connection checking time:  31.821509838104248
block generation total time  29.85351872444153
average batch blocks generation time:  0.9329224601387978
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.10942602157592773  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 20.639941692352295  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.10962581634521484  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 21.019586086273193  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.10884952545166016  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 20.437153816223145  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.1092386245727539  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 20.823226928710938  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.1092233657836914  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 20.86312961578369  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.1092219352722168  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 21.034037113189697  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.10914850234985352  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 20.96704864501953  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.10912275314331055  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 20.732778072357178  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.10928773880004883  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 20.64759111404419  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.10935640335083008  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 20.88226890563965  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.10910654067993164  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 20.59788465499878  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.10935783386230469  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 20.94133472442627  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.10830545425415039  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 20.195777893066406  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9705810546875 GB
    Memory Allocated: 0.1094508171081543  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1033935546875 GB
    Memory Allocated: 21.07333755493164  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1033935546875 GB
    Memory Allocated: 0.10891008377075195  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1033935546875 GB
    Memory Allocated: 20.42325782775879  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1033935546875 GB
    Memory Allocated: 0.10930871963500977  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1033935546875 GB
    Memory Allocated: 20.87833547592163  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1033935546875 GB
    Memory Allocated: 0.10936403274536133  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 21.02937936782837  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10919332504272461  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.441148281097412  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10908746719360352  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.48863458633423  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10945463180541992  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 21.04228639602661  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10914897918701172  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.747475624084473  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10958099365234375  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 21.149208545684814  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10919427871704102  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.80738401412964  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10900688171386719  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.733466625213623  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10911750793457031  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.67629098892212  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10923099517822266  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.702938556671143  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.109222412109375  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.89892816543579  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10927200317382812  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.630935192108154  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10904598236083984  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.450578689575195  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10906839370727539  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.95698833465576  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.10906457901000977  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.666285514831543  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.1092824935913086  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 20.762707233428955  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02820657193660736 |0.022676147520542145 |0.630865678191185 |9.80570912361145e-05 |1.194152608513832 |0.004879474639892578 |
----------------------------------------------------------pseudo_mini_loss sum 1.9329643249511719
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  9156270
Number of first layer input nodes during this epoch:  4807309
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.13139772415161133  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026476621627807617
range selection method range initialization spend 0.014355182647705078
time for parepare:  0.020145177841186523
local_output_nid generation:  0.0010612010955810547
local_in_edges_tensor generation:  0.0058689117431640625
mini_batch_src_global generation:  0.0016927719116210938
r_  generation:  0.011514425277709961
local_output_nid generation:  0.0010046958923339844
local_in_edges_tensor generation:  0.0007290840148925781
mini_batch_src_global generation:  0.0016832351684570312
r_  generation:  0.010957956314086914
local_output_nid generation:  0.0009355545043945312
local_in_edges_tensor generation:  0.0006239414215087891
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.010228157043457031
local_output_nid generation:  0.0009233951568603516
local_in_edges_tensor generation:  0.0006051063537597656
mini_batch_src_global generation:  0.0011026859283447266
r_  generation:  0.009767532348632812
local_output_nid generation:  0.0009016990661621094
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.0011053085327148438
r_  generation:  0.009901762008666992
local_output_nid generation:  0.000919342041015625
local_in_edges_tensor generation:  0.0006263256072998047
mini_batch_src_global generation:  0.0011794567108154297
r_  generation:  0.010497093200683594
local_output_nid generation:  0.0009028911590576172
local_in_edges_tensor generation:  0.0005805492401123047
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.01030588150024414
local_output_nid generation:  0.0009453296661376953
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.001085519790649414
r_  generation:  0.01008462905883789
local_output_nid generation:  0.0008907318115234375
local_in_edges_tensor generation:  0.0005803108215332031
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.010413885116577148
local_output_nid generation:  0.0009186267852783203
local_in_edges_tensor generation:  0.0005621910095214844
mini_batch_src_global generation:  0.0011267662048339844
r_  generation:  0.010148286819458008
local_output_nid generation:  0.0008938312530517578
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0010840892791748047
r_  generation:  0.010457038879394531
local_output_nid generation:  0.0009260177612304688
local_in_edges_tensor generation:  0.0005857944488525391
mini_batch_src_global generation:  0.0011413097381591797
r_  generation:  0.010571002960205078
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0005769729614257812
mini_batch_src_global generation:  0.0011057853698730469
r_  generation:  0.010389089584350586
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.0005705356597900391
mini_batch_src_global generation:  0.0011017322540283203
r_  generation:  0.01072549819946289
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.0010597705841064453
r_  generation:  0.010291099548339844
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.0010995864868164062
r_  generation:  0.010528087615966797
local_output_nid generation:  0.0008838176727294922
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0011165142059326172
r_  generation:  0.010689735412597656
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0005679130554199219
mini_batch_src_global generation:  0.0011470317840576172
r_  generation:  0.009925127029418945
local_output_nid generation:  0.0008854866027832031
local_in_edges_tensor generation:  0.0005931854248046875
mini_batch_src_global generation:  0.0012066364288330078
r_  generation:  0.010419368743896484
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0005767345428466797
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.010218381881713867
local_output_nid generation:  0.0008864402770996094
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.0011069774627685547
r_  generation:  0.010073184967041016
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0005593299865722656
mini_batch_src_global generation:  0.001077890396118164
r_  generation:  0.010179996490478516
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.0005712509155273438
mini_batch_src_global generation:  0.0011239051818847656
r_  generation:  0.010223388671875
local_output_nid generation:  0.0008897781372070312
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.0011539459228515625
r_  generation:  0.010628461837768555
local_output_nid generation:  0.0008816719055175781
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.010173320770263672
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.0005557537078857422
mini_batch_src_global generation:  0.001184701919555664
r_  generation:  0.010390281677246094
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.010367393493652344
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.0011756420135498047
r_  generation:  0.010932445526123047
local_output_nid generation:  0.0008893013000488281
local_in_edges_tensor generation:  0.0005834102630615234
mini_batch_src_global generation:  0.0011036396026611328
r_  generation:  0.010394096374511719
local_output_nid generation:  0.0008990764617919922
local_in_edges_tensor generation:  0.000579833984375
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.010850906372070312
local_output_nid generation:  0.0009000301361083984
local_in_edges_tensor generation:  0.00054931640625
mini_batch_src_global generation:  0.0011267662048339844
r_  generation:  0.010292291641235352
local_output_nid generation:  0.0008797645568847656
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.010399818420410156
----------------------check_connections_block total spend ----------------------------- 0.5241832733154297
generate_one_block  0.026642560958862305
generate_one_block  0.0218658447265625
generate_one_block  0.020121097564697266
generate_one_block  0.018877506256103516
generate_one_block  0.019145488739013672
generate_one_block  0.01979207992553711
generate_one_block  0.01899433135986328
generate_one_block  0.018708229064941406
generate_one_block  0.019531726837158203
generate_one_block  0.01867818832397461
generate_one_block  0.019207239151000977
generate_one_block  0.019667387008666992
generate_one_block  0.01882624626159668
generate_one_block  0.019446134567260742
generate_one_block  0.01872420310974121
generate_one_block  0.019298553466796875
generate_one_block  0.01951003074645996
generate_one_block  0.018121004104614258
generate_one_block  0.01900625228881836
generate_one_block  0.018838167190551758
generate_one_block  0.018342018127441406
generate_one_block  0.018768787384033203
generate_one_block  0.0189359188079834
generate_one_block  0.019350528717041016
generate_one_block  0.01869368553161621
generate_one_block  0.019031286239624023
generate_one_block  0.01885700225830078
generate_one_block  0.019809961318969727
generate_one_block  0.018644094467163086
generate_one_block  0.019524574279785156
generate_one_block  0.018530845642089844
generate_one_block  0.01884150505065918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04057025909423828
gen group dst list time:  0.024656057357788086
time for parepare:  0.022380590438842773
local_output_nid generation:  0.006216764450073242
local_in_edges_tensor generation:  0.019253253936767578
mini_batch_src_global generation:  0.01887822151184082
r_  generation:  0.1730635166168213
local_output_nid generation:  0.008089780807495117
local_in_edges_tensor generation:  0.011378765106201172
mini_batch_src_global generation:  0.022365093231201172
r_  generation:  0.1816699504852295
local_output_nid generation:  0.008211135864257812
local_in_edges_tensor generation:  0.03337264060974121
mini_batch_src_global generation:  0.022592782974243164
r_  generation:  0.17786908149719238
local_output_nid generation:  0.008358001708984375
local_in_edges_tensor generation:  0.011203765869140625
mini_batch_src_global generation:  0.021403074264526367
r_  generation:  0.17213106155395508
local_output_nid generation:  0.008876562118530273
local_in_edges_tensor generation:  0.011887311935424805
mini_batch_src_global generation:  0.02097773551940918
r_  generation:  0.17676520347595215
local_output_nid generation:  0.009236812591552734
local_in_edges_tensor generation:  0.01017451286315918
mini_batch_src_global generation:  0.023485898971557617
r_  generation:  0.18502211570739746
local_output_nid generation:  0.009154081344604492
local_in_edges_tensor generation:  0.008676767349243164
mini_batch_src_global generation:  0.022652626037597656
r_  generation:  0.18095159530639648
local_output_nid generation:  0.008760452270507812
local_in_edges_tensor generation:  0.010353803634643555
mini_batch_src_global generation:  0.02288985252380371
r_  generation:  0.176131010055542
local_output_nid generation:  0.008913755416870117
local_in_edges_tensor generation:  0.008938789367675781
mini_batch_src_global generation:  0.02321171760559082
r_  generation:  0.18561339378356934
local_output_nid generation:  0.008758306503295898
local_in_edges_tensor generation:  0.010499954223632812
mini_batch_src_global generation:  0.02233409881591797
r_  generation:  0.17636537551879883
local_output_nid generation:  0.009121894836425781
local_in_edges_tensor generation:  0.009151220321655273
mini_batch_src_global generation:  0.023052453994750977
r_  generation:  0.18568801879882812
local_output_nid generation:  0.009490251541137695
local_in_edges_tensor generation:  0.00977182388305664
mini_batch_src_global generation:  0.023387908935546875
r_  generation:  0.18600940704345703
local_output_nid generation:  0.009249210357666016
local_in_edges_tensor generation:  0.008996009826660156
mini_batch_src_global generation:  0.0227508544921875
r_  generation:  0.18099451065063477
local_output_nid generation:  0.009593725204467773
local_in_edges_tensor generation:  0.008982181549072266
mini_batch_src_global generation:  0.02334904670715332
r_  generation:  0.18395471572875977
local_output_nid generation:  0.009328842163085938
local_in_edges_tensor generation:  0.009516239166259766
mini_batch_src_global generation:  0.022957801818847656
r_  generation:  0.18353819847106934
local_output_nid generation:  0.00944972038269043
local_in_edges_tensor generation:  0.008877992630004883
mini_batch_src_global generation:  0.023263931274414062
r_  generation:  0.18542790412902832
local_output_nid generation:  0.009454488754272461
local_in_edges_tensor generation:  0.00972294807434082
mini_batch_src_global generation:  0.023130416870117188
r_  generation:  0.18499493598937988
local_output_nid generation:  0.00900721549987793
local_in_edges_tensor generation:  0.010526180267333984
mini_batch_src_global generation:  0.022588253021240234
r_  generation:  0.17201757431030273
local_output_nid generation:  0.00941610336303711
local_in_edges_tensor generation:  0.009227275848388672
mini_batch_src_global generation:  0.02218914031982422
r_  generation:  0.1787891387939453
local_output_nid generation:  0.009274005889892578
local_in_edges_tensor generation:  0.009115457534790039
mini_batch_src_global generation:  0.022665023803710938
r_  generation:  0.17719697952270508
local_output_nid generation:  0.009183406829833984
local_in_edges_tensor generation:  0.008484363555908203
mini_batch_src_global generation:  0.02204442024230957
r_  generation:  0.1783618927001953
local_output_nid generation:  0.009310245513916016
local_in_edges_tensor generation:  0.008842706680297852
mini_batch_src_global generation:  0.02251458168029785
r_  generation:  0.18010616302490234
local_output_nid generation:  0.009382009506225586
local_in_edges_tensor generation:  0.008928298950195312
mini_batch_src_global generation:  0.02265620231628418
r_  generation:  0.18137836456298828
local_output_nid generation:  0.009491443634033203
local_in_edges_tensor generation:  0.009171009063720703
mini_batch_src_global generation:  0.02290964126586914
r_  generation:  0.19012093544006348
local_output_nid generation:  0.009419441223144531
local_in_edges_tensor generation:  0.009164571762084961
mini_batch_src_global generation:  0.022747278213500977
r_  generation:  0.18112945556640625
local_output_nid generation:  0.009485960006713867
local_in_edges_tensor generation:  0.009233236312866211
mini_batch_src_global generation:  0.02294301986694336
r_  generation:  0.18534088134765625
local_output_nid generation:  0.009336471557617188
local_in_edges_tensor generation:  0.008957386016845703
mini_batch_src_global generation:  0.02225804328918457
r_  generation:  0.18137049674987793
local_output_nid generation:  0.00957345962524414
local_in_edges_tensor generation:  0.009187459945678711
mini_batch_src_global generation:  0.02400660514831543
r_  generation:  0.19450020790100098
local_output_nid generation:  0.009191274642944336
local_in_edges_tensor generation:  0.008984804153442383
mini_batch_src_global generation:  0.022554636001586914
r_  generation:  0.18186402320861816
local_output_nid generation:  0.009822368621826172
local_in_edges_tensor generation:  0.00927734375
mini_batch_src_global generation:  0.02369093894958496
r_  generation:  0.19114232063293457
local_output_nid generation:  0.009356975555419922
local_in_edges_tensor generation:  0.009257793426513672
mini_batch_src_global generation:  0.02263498306274414
r_  generation:  0.17933416366577148
local_output_nid generation:  0.009462594985961914
local_in_edges_tensor generation:  0.009051084518432617
mini_batch_src_global generation:  0.023508548736572266
r_  generation:  0.18253755569458008
----------------------check_connections_block total spend ----------------------------- 8.501763820648193
generate_one_block  0.2617368698120117
generate_one_block  0.25073814392089844
generate_one_block  0.25
generate_one_block  0.24744582176208496
generate_one_block  0.27461862564086914
generate_one_block  0.2555065155029297
generate_one_block  0.24702835083007812
generate_one_block  0.2436201572418213
generate_one_block  0.25307798385620117
generate_one_block  0.24370980262756348
generate_one_block  0.25492000579833984
generate_one_block  0.2553119659423828
generate_one_block  0.24715018272399902
generate_one_block  0.25525593757629395
generate_one_block  0.25031113624572754
generate_one_block  0.2568974494934082
generate_one_block  0.25499796867370605
generate_one_block  0.23335647583007812
generate_one_block  0.24213504791259766
generate_one_block  0.3371458053588867
generate_one_block  0.23961663246154785
generate_one_block  0.24623775482177734
generate_one_block  0.2494494915008545
generate_one_block  0.25386714935302734
generate_one_block  0.24470806121826172
generate_one_block  0.25240135192871094
generate_one_block  0.24205613136291504
generate_one_block  0.26677799224853516
generate_one_block  0.2510659694671631
generate_one_block  0.2577707767486572
generate_one_block  0.24152278900146484
generate_one_block  0.24733781814575195
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034558773040771484
gen group dst list time:  0.10608625411987305
time for parepare:  0.018360137939453125
local_output_nid generation:  0.024927377700805664
local_in_edges_tensor generation:  0.04325413703918457
mini_batch_src_global generation:  0.047344207763671875
r_  generation:  0.49616527557373047
local_output_nid generation:  0.030447959899902344
local_in_edges_tensor generation:  0.03921198844909668
mini_batch_src_global generation:  0.06198620796203613
r_  generation:  0.4845871925354004
local_output_nid generation:  0.030955076217651367
local_in_edges_tensor generation:  0.03759312629699707
mini_batch_src_global generation:  0.057491302490234375
r_  generation:  0.5031826496124268
local_output_nid generation:  0.031062602996826172
local_in_edges_tensor generation:  0.03218674659729004
mini_batch_src_global generation:  0.060221195220947266
r_  generation:  0.4931447505950928
local_output_nid generation:  0.03127264976501465
local_in_edges_tensor generation:  0.030528783798217773
mini_batch_src_global generation:  0.05738973617553711
r_  generation:  0.4998302459716797
local_output_nid generation:  0.03011798858642578
local_in_edges_tensor generation:  0.030274152755737305
mini_batch_src_global generation:  0.06132364273071289
r_  generation:  0.4976036548614502
local_output_nid generation:  0.029093503952026367
local_in_edges_tensor generation:  0.029631853103637695
mini_batch_src_global generation:  0.05848526954650879
r_  generation:  0.5029644966125488
local_output_nid generation:  0.029459238052368164
local_in_edges_tensor generation:  0.029157161712646484
mini_batch_src_global generation:  0.05956602096557617
r_  generation:  0.4946615695953369
local_output_nid generation:  0.029734134674072266
local_in_edges_tensor generation:  0.0329744815826416
mini_batch_src_global generation:  0.05887150764465332
r_  generation:  0.5047352313995361
local_output_nid generation:  0.02962779998779297
local_in_edges_tensor generation:  0.028705358505249023
mini_batch_src_global generation:  0.06019735336303711
r_  generation:  0.4987068176269531
local_output_nid generation:  0.029465675354003906
local_in_edges_tensor generation:  0.028615713119506836
mini_batch_src_global generation:  0.06073164939880371
r_  generation:  0.5014917850494385
local_output_nid generation:  0.029729604721069336
local_in_edges_tensor generation:  0.030310392379760742
mini_batch_src_global generation:  0.0600733757019043
r_  generation:  0.497424840927124
local_output_nid generation:  0.029528141021728516
local_in_edges_tensor generation:  0.02859020233154297
mini_batch_src_global generation:  0.05842757225036621
r_  generation:  0.4974088668823242
local_output_nid generation:  0.02956247329711914
local_in_edges_tensor generation:  0.03033614158630371
mini_batch_src_global generation:  0.061750173568725586
r_  generation:  0.4996168613433838
local_output_nid generation:  0.029844284057617188
local_in_edges_tensor generation:  0.030120134353637695
mini_batch_src_global generation:  0.05824995040893555
r_  generation:  0.5036928653717041
local_output_nid generation:  0.02986598014831543
local_in_edges_tensor generation:  0.03131842613220215
mini_batch_src_global generation:  0.06022000312805176
r_  generation:  0.5006787776947021
local_output_nid generation:  0.031426191329956055
local_in_edges_tensor generation:  0.031218290328979492
mini_batch_src_global generation:  0.05869174003601074
r_  generation:  0.5023746490478516
local_output_nid generation:  0.029680252075195312
local_in_edges_tensor generation:  0.029329299926757812
mini_batch_src_global generation:  0.05974268913269043
r_  generation:  0.4921121597290039
local_output_nid generation:  0.02984619140625
local_in_edges_tensor generation:  0.030071496963500977
mini_batch_src_global generation:  0.05834221839904785
r_  generation:  0.5001132488250732
local_output_nid generation:  0.02992987632751465
local_in_edges_tensor generation:  0.03083014488220215
mini_batch_src_global generation:  0.06032156944274902
r_  generation:  0.493776798248291
local_output_nid generation:  0.029600143432617188
local_in_edges_tensor generation:  0.0307009220123291
mini_batch_src_global generation:  0.05877041816711426
r_  generation:  0.5086760520935059
local_output_nid generation:  0.02969837188720703
local_in_edges_tensor generation:  0.030399084091186523
mini_batch_src_global generation:  0.060389041900634766
r_  generation:  0.498760461807251
local_output_nid generation:  0.029799699783325195
local_in_edges_tensor generation:  0.03073716163635254
mini_batch_src_global generation:  0.058869361877441406
r_  generation:  0.5069119930267334
local_output_nid generation:  0.02973341941833496
local_in_edges_tensor generation:  0.030641555786132812
mini_batch_src_global generation:  0.05977272987365723
r_  generation:  0.5011024475097656
local_output_nid generation:  0.030104637145996094
local_in_edges_tensor generation:  0.031177282333374023
mini_batch_src_global generation:  0.058887481689453125
r_  generation:  0.5090827941894531
local_output_nid generation:  0.030152559280395508
local_in_edges_tensor generation:  0.0337214469909668
mini_batch_src_global generation:  0.060500144958496094
r_  generation:  0.5058979988098145
local_output_nid generation:  0.030125856399536133
local_in_edges_tensor generation:  0.02816176414489746
mini_batch_src_global generation:  0.05859661102294922
r_  generation:  0.5042765140533447
local_output_nid generation:  0.030507564544677734
local_in_edges_tensor generation:  0.03105449676513672
mini_batch_src_global generation:  0.06312084197998047
r_  generation:  0.5026335716247559
local_output_nid generation:  0.03000187873840332
local_in_edges_tensor generation:  0.03130626678466797
mini_batch_src_global generation:  0.0585322380065918
r_  generation:  0.5008034706115723
local_output_nid generation:  0.03380107879638672
local_in_edges_tensor generation:  0.030732154846191406
mini_batch_src_global generation:  0.0626213550567627
r_  generation:  0.5022203922271729
local_output_nid generation:  0.030087947845458984
local_in_edges_tensor generation:  0.03374004364013672
mini_batch_src_global generation:  0.059279441833496094
r_  generation:  0.5001792907714844
local_output_nid generation:  0.030094385147094727
local_in_edges_tensor generation:  0.0286104679107666
mini_batch_src_global generation:  0.06576967239379883
r_  generation:  0.49871230125427246
----------------------check_connections_block total spend ----------------------------- 23.393065452575684
generate_one_block  0.7873878479003906
generate_one_block  0.6798253059387207
generate_one_block  0.6822621822357178
generate_one_block  0.6834511756896973
generate_one_block  0.6754453182220459
generate_one_block  0.6866044998168945
generate_one_block  0.6726272106170654
generate_one_block  0.6727781295776367
generate_one_block  0.6893970966339111
generate_one_block  0.674365758895874
generate_one_block  0.7104284763336182
generate_one_block  0.6814703941345215
generate_one_block  0.6739776134490967
generate_one_block  0.6786270141601562
generate_one_block  0.6876852512359619
generate_one_block  0.683051347732544
generate_one_block  0.6831674575805664
generate_one_block  0.6742186546325684
generate_one_block  0.6774661540985107
generate_one_block  0.6774473190307617
generate_one_block  0.6827225685119629
generate_one_block  0.684091329574585
generate_one_block  0.6858983039855957
generate_one_block  0.6758425235748291
generate_one_block  0.6816480159759521
generate_one_block  0.6893374919891357
generate_one_block  0.6827471256256104
generate_one_block  0.6899290084838867
generate_one_block  0.6738531589508057
generate_one_block  0.6825332641601562
generate_one_block  0.6764819622039795
generate_one_block  0.7066497802734375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.13139772415161133  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

connection checking time:  31.894829273223877
block generation total time  30.05119490623474
average batch blocks generation time:  0.9390998408198357
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.1098179817199707  GigaBytes
Max Memory Allocated: 21.501508712768555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5311279296875 GB
    Memory Allocated: 21.46107053756714  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.10925579071044922  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6190185546875 GB
    Memory Allocated: 20.90155601501465  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.10945892333984375  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7010498046875 GB
    Memory Allocated: 20.937283039093018  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.10922384262084961  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 20.66630792617798  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1089029312133789  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 20.665430068969727  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1094660758972168  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 21.126930713653564  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 0.10890722274780273  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 20.722848415374756  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 0.10888910293579102  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 20.617552280426025  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 0.10947656631469727  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 21.013300895690918  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 0.1090235710144043  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 20.561991214752197  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 0.10936164855957031  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 20.96888303756714  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 0.10917854309082031  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 21.058448791503906  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 0.1088719367980957  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 20.618516445159912  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 0.10927963256835938  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 20.971395015716553  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 0.10909843444824219  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 20.82129192352295  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 0.10920953750610352  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 21.01709222793579  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.10947895050048828  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 20.994834899902344  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.10893487930297852  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 20.118369102478027  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.10913276672363281  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 20.495872974395752  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.10892057418823242  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 20.42137861251831  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.10886240005493164  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 20.327491283416748  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.10924482345581055  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 20.59852933883667  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.10926151275634766  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 20.609144687652588  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.10895013809204102  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 20.901724338531494  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.10922670364379883  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 20.615413665771484  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.10927057266235352  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 20.935487747192383  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.10917854309082031  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 20.54380750656128  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.10963582992553711  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 21.39035177230835  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10908079147338867  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.508865356445312  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.1096491813659668  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 21.250128746032715  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10914325714111328  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.427660942077637  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.1091313362121582  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.7773494720459  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03287394344806671 |0.024654075503349304 |0.6771988272666931 |9.553879499435425e-05 |1.1906974166631699 |0.004248380661010742 |
----------------------------------------------------------pseudo_mini_loss sum 1.8461722135543823
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  9160675
Number of first layer input nodes during this epoch:  4806721
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.13125228881835938  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030652523040771484
range selection method range initialization spend 0.014483451843261719
time for parepare:  0.024730682373046875
local_output_nid generation:  0.0012230873107910156
local_in_edges_tensor generation:  0.008167743682861328
mini_batch_src_global generation:  0.0046923160552978516
r_  generation:  0.010476827621459961
local_output_nid generation:  0.0010311603546142578
local_in_edges_tensor generation:  0.0007464885711669922
mini_batch_src_global generation:  0.0019145011901855469
r_  generation:  0.01100301742553711
local_output_nid generation:  0.0010457038879394531
local_in_edges_tensor generation:  0.0007164478302001953
mini_batch_src_global generation:  0.0014424324035644531
r_  generation:  0.010233640670776367
local_output_nid generation:  0.001039743423461914
local_in_edges_tensor generation:  0.0007171630859375
mini_batch_src_global generation:  0.0013985633850097656
r_  generation:  0.010135173797607422
local_output_nid generation:  0.0010328292846679688
local_in_edges_tensor generation:  0.0007116794586181641
mini_batch_src_global generation:  0.0013499259948730469
r_  generation:  0.010228633880615234
local_output_nid generation:  0.001024484634399414
local_in_edges_tensor generation:  0.0006928443908691406
mini_batch_src_global generation:  0.001447916030883789
r_  generation:  0.010256528854370117
local_output_nid generation:  0.0010368824005126953
local_in_edges_tensor generation:  0.0007092952728271484
mini_batch_src_global generation:  0.0015413761138916016
r_  generation:  0.011006593704223633
local_output_nid generation:  0.0010395050048828125
local_in_edges_tensor generation:  0.0006835460662841797
mini_batch_src_global generation:  0.0013074874877929688
r_  generation:  0.009929180145263672
local_output_nid generation:  0.0010395050048828125
local_in_edges_tensor generation:  0.0006780624389648438
mini_batch_src_global generation:  0.001300811767578125
r_  generation:  0.009989261627197266
local_output_nid generation:  0.0010304450988769531
local_in_edges_tensor generation:  0.0006771087646484375
mini_batch_src_global generation:  0.0014274120330810547
r_  generation:  0.01046133041381836
local_output_nid generation:  0.0010499954223632812
local_in_edges_tensor generation:  0.0007009506225585938
mini_batch_src_global generation:  0.0013828277587890625
r_  generation:  0.010498523712158203
local_output_nid generation:  0.0010423660278320312
local_in_edges_tensor generation:  0.0006880760192871094
mini_batch_src_global generation:  0.0013151168823242188
r_  generation:  0.010351181030273438
local_output_nid generation:  0.0010340213775634766
local_in_edges_tensor generation:  0.0006737709045410156
mini_batch_src_global generation:  0.001308441162109375
r_  generation:  0.010553121566772461
local_output_nid generation:  0.0009920597076416016
local_in_edges_tensor generation:  0.0006616115570068359
mini_batch_src_global generation:  0.0013530254364013672
r_  generation:  0.01045680046081543
local_output_nid generation:  0.0009777545928955078
local_in_edges_tensor generation:  0.0006766319274902344
mini_batch_src_global generation:  0.0013477802276611328
r_  generation:  0.010572195053100586
local_output_nid generation:  0.0010037422180175781
local_in_edges_tensor generation:  0.0006902217864990234
mini_batch_src_global generation:  0.001337289810180664
r_  generation:  0.010691165924072266
local_output_nid generation:  0.0010442733764648438
local_in_edges_tensor generation:  0.0006606578826904297
mini_batch_src_global generation:  0.0013275146484375
r_  generation:  0.01069188117980957
local_output_nid generation:  0.0010750293731689453
local_in_edges_tensor generation:  0.0006985664367675781
mini_batch_src_global generation:  0.0014493465423583984
r_  generation:  0.010419845581054688
local_output_nid generation:  0.0010459423065185547
local_in_edges_tensor generation:  0.0006520748138427734
mini_batch_src_global generation:  0.001397848129272461
r_  generation:  0.010347127914428711
local_output_nid generation:  0.0010390281677246094
local_in_edges_tensor generation:  0.000682830810546875
mini_batch_src_global generation:  0.0013670921325683594
r_  generation:  0.010711908340454102
local_output_nid generation:  0.0010449886322021484
local_in_edges_tensor generation:  0.0006897449493408203
mini_batch_src_global generation:  0.001436471939086914
r_  generation:  0.010864973068237305
local_output_nid generation:  0.0010423660278320312
local_in_edges_tensor generation:  0.0006988048553466797
mini_batch_src_global generation:  0.0014362335205078125
r_  generation:  0.011020421981811523
local_output_nid generation:  0.0010488033294677734
local_in_edges_tensor generation:  0.0006654262542724609
mini_batch_src_global generation:  0.0013921260833740234
r_  generation:  0.010716676712036133
local_output_nid generation:  0.0010581016540527344
local_in_edges_tensor generation:  0.0006787776947021484
mini_batch_src_global generation:  0.0015027523040771484
r_  generation:  0.0104522705078125
local_output_nid generation:  0.0010738372802734375
local_in_edges_tensor generation:  0.0006835460662841797
mini_batch_src_global generation:  0.0014145374298095703
r_  generation:  0.010660171508789062
local_output_nid generation:  0.0010724067687988281
local_in_edges_tensor generation:  0.0006871223449707031
mini_batch_src_global generation:  0.001379251480102539
r_  generation:  0.01100778579711914
local_output_nid generation:  0.001066446304321289
local_in_edges_tensor generation:  0.0006835460662841797
mini_batch_src_global generation:  0.0015096664428710938
r_  generation:  0.010607242584228516
local_output_nid generation:  0.0010707378387451172
local_in_edges_tensor generation:  0.0006701946258544922
mini_batch_src_global generation:  0.0013980865478515625
r_  generation:  0.010828495025634766
local_output_nid generation:  0.0010685920715332031
local_in_edges_tensor generation:  0.0006935596466064453
mini_batch_src_global generation:  0.0013856887817382812
r_  generation:  0.01095128059387207
local_output_nid generation:  0.0010721683502197266
local_in_edges_tensor generation:  0.0006895065307617188
mini_batch_src_global generation:  0.0013766288757324219
r_  generation:  0.010589838027954102
local_output_nid generation:  0.0010650157928466797
local_in_edges_tensor generation:  0.000667572021484375
mini_batch_src_global generation:  0.0013687610626220703
r_  generation:  0.01048421859741211
local_output_nid generation:  0.0010445117950439453
local_in_edges_tensor generation:  0.0006575584411621094
mini_batch_src_global generation:  0.0013244152069091797
r_  generation:  0.01009058952331543
----------------------check_connections_block total spend ----------------------------- 0.5600831508636475
generate_one_block  0.030336380004882812
generate_one_block  0.023912668228149414
generate_one_block  0.02196788787841797
generate_one_block  0.020658493041992188
generate_one_block  0.021183490753173828
generate_one_block  0.020510435104370117
generate_one_block  0.021679162979125977
generate_one_block  0.019598007202148438
generate_one_block  0.019703388214111328
generate_one_block  0.020325899124145508
generate_one_block  0.02037334442138672
generate_one_block  0.020096302032470703
generate_one_block  0.02019667625427246
generate_one_block  0.02031874656677246
generate_one_block  0.020181655883789062
generate_one_block  0.020693063735961914
generate_one_block  0.020404338836669922
generate_one_block  0.0198671817779541
generate_one_block  0.019822359085083008
generate_one_block  0.02076268196105957
generate_one_block  0.020990371704101562
generate_one_block  0.021219730377197266
generate_one_block  0.024499893188476562
generate_one_block  0.020642995834350586
generate_one_block  0.021052122116088867
generate_one_block  0.021232128143310547
generate_one_block  0.020876169204711914
generate_one_block  0.020942211151123047
generate_one_block  0.020869731903076172
generate_one_block  0.020247459411621094
generate_one_block  0.0199434757232666
generate_one_block  0.01941990852355957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04274415969848633
gen group dst list time:  0.02835845947265625
time for parepare:  0.03645730018615723
local_output_nid generation:  0.012801647186279297
local_in_edges_tensor generation:  0.02706456184387207
mini_batch_src_global generation:  0.019490480422973633
r_  generation:  0.16529297828674316
local_output_nid generation:  0.00973367691040039
local_in_edges_tensor generation:  0.010854005813598633
mini_batch_src_global generation:  0.022889137268066406
r_  generation:  0.168853759765625
local_output_nid generation:  0.00848388671875
local_in_edges_tensor generation:  0.03202700614929199
mini_batch_src_global generation:  0.023310422897338867
r_  generation:  0.21122097969055176
local_output_nid generation:  0.013996362686157227
local_in_edges_tensor generation:  0.01250314712524414
mini_batch_src_global generation:  0.022646188735961914
r_  generation:  0.19739127159118652
local_output_nid generation:  0.013901710510253906
local_in_edges_tensor generation:  0.012519359588623047
mini_batch_src_global generation:  0.02592921257019043
r_  generation:  0.18901920318603516
local_output_nid generation:  0.009541988372802734
local_in_edges_tensor generation:  0.013696908950805664
mini_batch_src_global generation:  0.023792505264282227
r_  generation:  0.2087082862854004
local_output_nid generation:  0.014494657516479492
local_in_edges_tensor generation:  0.019533395767211914
mini_batch_src_global generation:  0.028481006622314453
r_  generation:  0.2309119701385498
local_output_nid generation:  0.011013507843017578
local_in_edges_tensor generation:  0.0106964111328125
mini_batch_src_global generation:  0.03384518623352051
r_  generation:  0.17597603797912598
local_output_nid generation:  0.010083675384521484
local_in_edges_tensor generation:  0.009703397750854492
mini_batch_src_global generation:  0.025004863739013672
r_  generation:  0.1797962188720703
local_output_nid generation:  0.009370565414428711
local_in_edges_tensor generation:  0.0108184814453125
mini_batch_src_global generation:  0.024685382843017578
r_  generation:  0.18384623527526855
local_output_nid generation:  0.011089801788330078
local_in_edges_tensor generation:  0.010487794876098633
mini_batch_src_global generation:  0.024815797805786133
r_  generation:  0.18312788009643555
local_output_nid generation:  0.009427309036254883
local_in_edges_tensor generation:  0.009577274322509766
mini_batch_src_global generation:  0.021990537643432617
r_  generation:  0.1806352138519287
local_output_nid generation:  0.012522459030151367
local_in_edges_tensor generation:  0.009748220443725586
mini_batch_src_global generation:  0.025611400604248047
r_  generation:  0.17653226852416992
local_output_nid generation:  0.009438514709472656
local_in_edges_tensor generation:  0.008940935134887695
mini_batch_src_global generation:  0.02264237403869629
r_  generation:  0.18021774291992188
local_output_nid generation:  0.009532451629638672
local_in_edges_tensor generation:  0.008929252624511719
mini_batch_src_global generation:  0.022665739059448242
r_  generation:  0.18001008033752441
local_output_nid generation:  0.009652853012084961
local_in_edges_tensor generation:  0.010196924209594727
mini_batch_src_global generation:  0.0369415283203125
r_  generation:  0.22458815574645996
local_output_nid generation:  0.010371923446655273
local_in_edges_tensor generation:  0.009344100952148438
mini_batch_src_global generation:  0.026397705078125
r_  generation:  0.2142949104309082
local_output_nid generation:  0.009646415710449219
local_in_edges_tensor generation:  0.009823083877563477
mini_batch_src_global generation:  0.02489614486694336
r_  generation:  0.21197843551635742
local_output_nid generation:  0.015060663223266602
local_in_edges_tensor generation:  0.013091325759887695
mini_batch_src_global generation:  0.026796579360961914
r_  generation:  0.1967017650604248
local_output_nid generation:  0.01352071762084961
local_in_edges_tensor generation:  0.011456966400146484
mini_batch_src_global generation:  0.03950190544128418
r_  generation:  0.18782329559326172
local_output_nid generation:  0.010879039764404297
local_in_edges_tensor generation:  0.010666847229003906
mini_batch_src_global generation:  0.026151418685913086
r_  generation:  0.21908068656921387
local_output_nid generation:  0.01618170738220215
local_in_edges_tensor generation:  0.013263702392578125
mini_batch_src_global generation:  0.028668880462646484
r_  generation:  0.21530628204345703
local_output_nid generation:  0.015902280807495117
local_in_edges_tensor generation:  0.013130903244018555
mini_batch_src_global generation:  0.026972532272338867
r_  generation:  0.21057915687561035
local_output_nid generation:  0.013920783996582031
local_in_edges_tensor generation:  0.01144862174987793
mini_batch_src_global generation:  0.02351975440979004
r_  generation:  0.1957075595855713
local_output_nid generation:  0.011702537536621094
local_in_edges_tensor generation:  0.010525226593017578
mini_batch_src_global generation:  0.023693561553955078
r_  generation:  0.19384002685546875
local_output_nid generation:  0.010605335235595703
local_in_edges_tensor generation:  0.011539936065673828
mini_batch_src_global generation:  0.023952245712280273
r_  generation:  0.19234323501586914
local_output_nid generation:  0.010588407516479492
local_in_edges_tensor generation:  0.014322996139526367
mini_batch_src_global generation:  0.03961491584777832
r_  generation:  0.23145771026611328
local_output_nid generation:  0.011525392532348633
local_in_edges_tensor generation:  0.013394594192504883
mini_batch_src_global generation:  0.0272214412689209
r_  generation:  0.19965386390686035
local_output_nid generation:  0.010419130325317383
local_in_edges_tensor generation:  0.01036524772644043
mini_batch_src_global generation:  0.02408003807067871
r_  generation:  0.1948833465576172
local_output_nid generation:  0.010868310928344727
local_in_edges_tensor generation:  0.010595321655273438
mini_batch_src_global generation:  0.03640627861022949
r_  generation:  0.20972442626953125
local_output_nid generation:  0.014850378036499023
local_in_edges_tensor generation:  0.01206064224243164
mini_batch_src_global generation:  0.026582002639770508
r_  generation:  0.19746160507202148
local_output_nid generation:  0.012123823165893555
local_in_edges_tensor generation:  0.011521100997924805
mini_batch_src_global generation:  0.02549123764038086
r_  generation:  0.1988668441772461
----------------------check_connections_block total spend ----------------------------- 9.444518804550171
generate_one_block  0.270566463470459
generate_one_block  0.2445993423461914
generate_one_block  0.25257015228271484
generate_one_block  0.2457590103149414
generate_one_block  0.27129197120666504
generate_one_block  0.23950529098510742
generate_one_block  0.26673054695129395
generate_one_block  0.23906707763671875
generate_one_block  0.24466800689697266
generate_one_block  0.267305850982666
generate_one_block  0.2543041706085205
generate_one_block  0.24218010902404785
generate_one_block  0.27193212509155273
generate_one_block  0.26073741912841797
generate_one_block  0.25301170349121094
generate_one_block  0.2594726085662842
generate_one_block  0.25833725929260254
generate_one_block  0.2509305477142334
generate_one_block  0.2518181800842285
generate_one_block  0.26291847229003906
generate_one_block  0.2680802345275879
generate_one_block  0.2656130790710449
generate_one_block  0.2523069381713867
generate_one_block  0.2439742088317871
generate_one_block  0.25771260261535645
generate_one_block  0.25582146644592285
generate_one_block  0.2587909698486328
generate_one_block  0.2594187259674072
generate_one_block  0.2623155117034912
generate_one_block  0.26096582412719727
generate_one_block  0.24553489685058594
generate_one_block  0.24286818504333496
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04086613655090332
gen group dst list time:  0.11472201347351074
time for parepare:  0.021497011184692383
local_output_nid generation:  0.0282285213470459
local_in_edges_tensor generation:  0.0533294677734375
mini_batch_src_global generation:  0.04762864112854004
r_  generation:  0.49681758880615234
local_output_nid generation:  0.03133130073547363
local_in_edges_tensor generation:  0.037299156188964844
mini_batch_src_global generation:  0.060990095138549805
r_  generation:  0.5011200904846191
local_output_nid generation:  0.03492021560668945
local_in_edges_tensor generation:  0.031061172485351562
mini_batch_src_global generation:  0.060704946517944336
r_  generation:  0.5090053081512451
local_output_nid generation:  0.03228116035461426
local_in_edges_tensor generation:  0.03175806999206543
mini_batch_src_global generation:  0.06045341491699219
r_  generation:  0.5037157535552979
local_output_nid generation:  0.03240776062011719
local_in_edges_tensor generation:  0.03345751762390137
mini_batch_src_global generation:  0.06335830688476562
r_  generation:  0.5101838111877441
local_output_nid generation:  0.03209662437438965
local_in_edges_tensor generation:  0.0328984260559082
mini_batch_src_global generation:  0.06196403503417969
r_  generation:  0.5150370597839355
local_output_nid generation:  0.03107929229736328
local_in_edges_tensor generation:  0.03068375587463379
mini_batch_src_global generation:  0.06137657165527344
r_  generation:  0.5112841129302979
local_output_nid generation:  0.03051590919494629
local_in_edges_tensor generation:  0.030567646026611328
mini_batch_src_global generation:  0.0597538948059082
r_  generation:  0.5026881694793701
local_output_nid generation:  0.03295731544494629
local_in_edges_tensor generation:  0.028473615646362305
mini_batch_src_global generation:  0.06589484214782715
r_  generation:  0.5002429485321045
local_output_nid generation:  0.030068397521972656
local_in_edges_tensor generation:  0.033019065856933594
mini_batch_src_global generation:  0.06220197677612305
r_  generation:  0.4981565475463867
local_output_nid generation:  0.03006601333618164
local_in_edges_tensor generation:  0.03103947639465332
mini_batch_src_global generation:  0.058542728424072266
r_  generation:  0.5054023265838623
local_output_nid generation:  0.029617786407470703
local_in_edges_tensor generation:  0.039504289627075195
mini_batch_src_global generation:  0.05945730209350586
r_  generation:  0.5025968551635742
local_output_nid generation:  0.029860734939575195
local_in_edges_tensor generation:  0.028542518615722656
mini_batch_src_global generation:  0.058207035064697266
r_  generation:  0.5075979232788086
local_output_nid generation:  0.030477046966552734
local_in_edges_tensor generation:  0.03330230712890625
mini_batch_src_global generation:  0.061672210693359375
r_  generation:  0.5065667629241943
local_output_nid generation:  0.030358314514160156
local_in_edges_tensor generation:  0.03383922576904297
mini_batch_src_global generation:  0.06082415580749512
r_  generation:  0.5088849067687988
local_output_nid generation:  0.03075718879699707
local_in_edges_tensor generation:  0.03155159950256348
mini_batch_src_global generation:  0.05985689163208008
r_  generation:  0.5092010498046875
local_output_nid generation:  0.03246474266052246
local_in_edges_tensor generation:  0.033370256423950195
mini_batch_src_global generation:  0.0585789680480957
r_  generation:  0.5104057788848877
local_output_nid generation:  0.030176639556884766
local_in_edges_tensor generation:  0.030383825302124023
mini_batch_src_global generation:  0.06108498573303223
r_  generation:  0.5077552795410156
local_output_nid generation:  0.030249834060668945
local_in_edges_tensor generation:  0.030542373657226562
mini_batch_src_global generation:  0.058081865310668945
r_  generation:  0.5081379413604736
local_output_nid generation:  0.03069329261779785
local_in_edges_tensor generation:  0.03355264663696289
mini_batch_src_global generation:  0.06046247482299805
r_  generation:  0.5128722190856934
local_output_nid generation:  0.030455589294433594
local_in_edges_tensor generation:  0.03566098213195801
mini_batch_src_global generation:  0.05888199806213379
r_  generation:  0.507826566696167
local_output_nid generation:  0.03273749351501465
local_in_edges_tensor generation:  0.03124380111694336
mini_batch_src_global generation:  0.06116223335266113
r_  generation:  0.5082619190216064
local_output_nid generation:  0.030429363250732422
local_in_edges_tensor generation:  0.03577733039855957
mini_batch_src_global generation:  0.05923008918762207
r_  generation:  0.5063643455505371
local_output_nid generation:  0.030430078506469727
local_in_edges_tensor generation:  0.03484916687011719
mini_batch_src_global generation:  0.059858083724975586
r_  generation:  0.5131521224975586
local_output_nid generation:  0.030496835708618164
local_in_edges_tensor generation:  0.03074026107788086
mini_batch_src_global generation:  0.0620875358581543
r_  generation:  0.5148923397064209
local_output_nid generation:  0.03165936470031738
local_in_edges_tensor generation:  0.029621124267578125
mini_batch_src_global generation:  0.06029915809631348
r_  generation:  0.5007524490356445
local_output_nid generation:  0.030543804168701172
local_in_edges_tensor generation:  0.030338525772094727
mini_batch_src_global generation:  0.060321807861328125
r_  generation:  0.5037953853607178
local_output_nid generation:  0.030336618423461914
local_in_edges_tensor generation:  0.0314633846282959
mini_batch_src_global generation:  0.06056475639343262
r_  generation:  0.5050647258758545
local_output_nid generation:  0.030643701553344727
local_in_edges_tensor generation:  0.028585195541381836
mini_batch_src_global generation:  0.05858802795410156
r_  generation:  0.5040791034698486
local_output_nid generation:  0.030756711959838867
local_in_edges_tensor generation:  0.028305530548095703
mini_batch_src_global generation:  0.05970048904418945
r_  generation:  0.5038931369781494
local_output_nid generation:  0.030365705490112305
local_in_edges_tensor generation:  0.03185009956359863
mini_batch_src_global generation:  0.05849504470825195
r_  generation:  0.4995110034942627
local_output_nid generation:  0.03033733367919922
local_in_edges_tensor generation:  0.028760194778442383
mini_batch_src_global generation:  0.05976581573486328
r_  generation:  0.4992942810058594
----------------------check_connections_block total spend ----------------------------- 23.67156147956848
generate_one_block  0.6980400085449219
generate_one_block  0.6901297569274902
generate_one_block  0.6788430213928223
generate_one_block  0.6771640777587891
generate_one_block  0.7934548854827881
generate_one_block  0.6748619079589844
generate_one_block  0.6860160827636719
generate_one_block  0.6746118068695068
generate_one_block  0.6815507411956787
generate_one_block  0.6891710758209229
generate_one_block  0.6782796382904053
generate_one_block  0.6756672859191895
generate_one_block  0.6762161254882812
generate_one_block  0.6803426742553711
generate_one_block  0.6802210807800293
generate_one_block  0.6965887546539307
generate_one_block  0.679985523223877
generate_one_block  0.6786208152770996
generate_one_block  0.6837284564971924
generate_one_block  0.689439058303833
generate_one_block  0.683971643447876
generate_one_block  0.700648307800293
generate_one_block  0.6843116283416748
generate_one_block  0.6871397495269775
generate_one_block  0.709728479385376
generate_one_block  0.6809415817260742
generate_one_block  0.6838505268096924
generate_one_block  0.684856653213501
generate_one_block  0.6819498538970947
generate_one_block  0.6829390525817871
generate_one_block  0.6765446662902832
generate_one_block  0.6751806735992432
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.13125228881835938  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

connection checking time:  33.11608028411865
block generation total time  30.17610454559326
average batch blocks generation time:  0.9430032670497894
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10918283462524414  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.7210693359375  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10904788970947266  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.41199016571045  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10926294326782227  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.844285011291504  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10907173156738281  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.54671335220337  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10956001281738281  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.987532138824463  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10865259170532227  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 20.302210807800293  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1541748046875 GB
    Memory Allocated: 0.10954666137695312  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2362060546875 GB
    Memory Allocated: 21.422181606292725  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4803466796875 GB
    Memory Allocated: 0.10882711410522461  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6268310546875 GB
    Memory Allocated: 20.176003456115723  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1170654296875 GB
    Memory Allocated: 0.10888147354125977  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 20.404876708984375  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1834716796875 GB
    Memory Allocated: 0.10929059982299805  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3377685546875 GB
    Memory Allocated: 20.720779418945312  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10877418518066406  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.61979579925537  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10877656936645508  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.37713861465454  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10898494720458984  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.52397060394287  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10924196243286133  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.760912895202637  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10933589935302734  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.697866916656494  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.1094827651977539  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 21.042317867279053  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10932540893554688  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.633947372436523  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10901212692260742  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.47251558303833  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10913658142089844  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.538933277130127  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10940217971801758  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.993030071258545  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10917234420776367  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 21.02205181121826  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10961484909057617  GigaBytes
Max Memory Allocated: 21.558195114135742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4334716796875 GB
    Memory Allocated: 21.445412635803223  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7791748046875 GB
    Memory Allocated: 0.1092061996459961  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0428466796875 GB
    Memory Allocated: 20.889081478118896  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 0.10923004150390625  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 20.56201934814453  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 0.10946512222290039  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 21.16749858856201  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 0.10935497283935547  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0662841796875 GB
    Memory Allocated: 21.00770902633667  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10955429077148438  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 21.16796636581421  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10950994491577148  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 21.103912353515625  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10929107666015625  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 21.07925796508789  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10941505432128906  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.762336254119873  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10890579223632812  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.45568037033081  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10878801345825195  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.235377311706543  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02691212296485901 |0.02296239137649536 |0.6316679492592812 |9.749084711074829e-05 |1.1802207604050636 |0.007556915283203125 |
----------------------------------------------------------pseudo_mini_loss sum 1.7860918045043945
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  9157763
Number of first layer input nodes during this epoch:  4807232
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.13041210174560547  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028363466262817383
range selection method range initialization spend 0.014640092849731445
time for parepare:  0.023685932159423828
local_output_nid generation:  0.0013153553009033203
local_in_edges_tensor generation:  0.004928112030029297
mini_batch_src_global generation:  0.0017325878143310547
r_  generation:  0.010230779647827148
local_output_nid generation:  0.0010504722595214844
local_in_edges_tensor generation:  0.000751495361328125
mini_batch_src_global generation:  0.0017728805541992188
r_  generation:  0.011265039443969727
local_output_nid generation:  0.0010161399841308594
local_in_edges_tensor generation:  0.0007367134094238281
mini_batch_src_global generation:  0.0013663768768310547
r_  generation:  0.010413408279418945
local_output_nid generation:  0.0010433197021484375
local_in_edges_tensor generation:  0.0006909370422363281
mini_batch_src_global generation:  0.0013420581817626953
r_  generation:  0.009990930557250977
local_output_nid generation:  0.001031637191772461
local_in_edges_tensor generation:  0.0007023811340332031
mini_batch_src_global generation:  0.001363515853881836
r_  generation:  0.010144472122192383
local_output_nid generation:  0.0010573863983154297
local_in_edges_tensor generation:  0.0007343292236328125
mini_batch_src_global generation:  0.0013833045959472656
r_  generation:  0.010167598724365234
local_output_nid generation:  0.0011093616485595703
local_in_edges_tensor generation:  0.0006966590881347656
mini_batch_src_global generation:  0.00131988525390625
r_  generation:  0.010411500930786133
local_output_nid generation:  0.0011246204376220703
local_in_edges_tensor generation:  0.0006818771362304688
mini_batch_src_global generation:  0.0013344287872314453
r_  generation:  0.010607719421386719
local_output_nid generation:  0.001073598861694336
local_in_edges_tensor generation:  0.0006706714630126953
mini_batch_src_global generation:  0.0012810230255126953
r_  generation:  0.010217428207397461
local_output_nid generation:  0.00106048583984375
local_in_edges_tensor generation:  0.0006871223449707031
mini_batch_src_global generation:  0.0014095306396484375
r_  generation:  0.010425329208374023
local_output_nid generation:  0.001035451889038086
local_in_edges_tensor generation:  0.0006470680236816406
mini_batch_src_global generation:  0.0013239383697509766
r_  generation:  0.010637521743774414
local_output_nid generation:  0.0010478496551513672
local_in_edges_tensor generation:  0.000682830810546875
mini_batch_src_global generation:  0.0013401508331298828
r_  generation:  0.010303974151611328
local_output_nid generation:  0.0010445117950439453
local_in_edges_tensor generation:  0.0006740093231201172
mini_batch_src_global generation:  0.0014450550079345703
r_  generation:  0.010365486145019531
local_output_nid generation:  0.0010485649108886719
local_in_edges_tensor generation:  0.0006721019744873047
mini_batch_src_global generation:  0.0013515949249267578
r_  generation:  0.010491132736206055
local_output_nid generation:  0.001049041748046875
local_in_edges_tensor generation:  0.0006692409515380859
mini_batch_src_global generation:  0.0013031959533691406
r_  generation:  0.010593414306640625
local_output_nid generation:  0.0010476112365722656
local_in_edges_tensor generation:  0.0006601810455322266
mini_batch_src_global generation:  0.001302480697631836
r_  generation:  0.010372161865234375
local_output_nid generation:  0.0010480880737304688
local_in_edges_tensor generation:  0.0006825923919677734
mini_batch_src_global generation:  0.0013234615325927734
r_  generation:  0.010499238967895508
local_output_nid generation:  0.0010619163513183594
local_in_edges_tensor generation:  0.0016067028045654297
mini_batch_src_global generation:  0.004699230194091797
r_  generation:  0.01819300651550293
local_output_nid generation:  0.0013575553894042969
local_in_edges_tensor generation:  0.0006725788116455078
mini_batch_src_global generation:  0.0014581680297851562
r_  generation:  0.010822772979736328
local_output_nid generation:  0.0010509490966796875
local_in_edges_tensor generation:  0.0005955696105957031
mini_batch_src_global generation:  0.0013146400451660156
r_  generation:  0.010540246963500977
local_output_nid generation:  0.0009808540344238281
local_in_edges_tensor generation:  0.0006256103515625
mini_batch_src_global generation:  0.0012116432189941406
r_  generation:  0.010294198989868164
local_output_nid generation:  0.0009613037109375
local_in_edges_tensor generation:  0.0006327629089355469
mini_batch_src_global generation:  0.0012049674987792969
r_  generation:  0.01045680046081543
local_output_nid generation:  0.0009069442749023438
local_in_edges_tensor generation:  0.0006232261657714844
mini_batch_src_global generation:  0.0012271404266357422
r_  generation:  0.010211944580078125
local_output_nid generation:  0.0009262561798095703
local_in_edges_tensor generation:  0.0006422996520996094
mini_batch_src_global generation:  0.0012121200561523438
r_  generation:  0.010211706161499023
local_output_nid generation:  0.0008950233459472656
local_in_edges_tensor generation:  0.0005867481231689453
mini_batch_src_global generation:  0.0011832714080810547
r_  generation:  0.010230302810668945
local_output_nid generation:  0.0009279251098632812
local_in_edges_tensor generation:  0.0006251335144042969
mini_batch_src_global generation:  0.0011782646179199219
r_  generation:  0.010596275329589844
local_output_nid generation:  0.0008754730224609375
local_in_edges_tensor generation:  0.0005743503570556641
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.010326623916625977
local_output_nid generation:  0.0008993148803710938
local_in_edges_tensor generation:  0.0006299018859863281
mini_batch_src_global generation:  0.0012259483337402344
r_  generation:  0.010422945022583008
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0011928081512451172
r_  generation:  0.010370254516601562
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.0005891323089599609
mini_batch_src_global generation:  0.0011584758758544922
r_  generation:  0.01000833511352539
local_output_nid generation:  0.0008845329284667969
local_in_edges_tensor generation:  0.0006012916564941406
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.010363340377807617
local_output_nid generation:  0.0008587837219238281
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0011074542999267578
r_  generation:  0.010062456130981445
----------------------check_connections_block total spend ----------------------------- 0.5538580417633057
generate_one_block  0.0261080265045166
generate_one_block  0.021988868713378906
generate_one_block  0.020066261291503906
generate_one_block  0.0189974308013916
generate_one_block  0.01900458335876465
generate_one_block  0.01904296875
generate_one_block  0.018931865692138672
generate_one_block  0.019205808639526367
generate_one_block  0.018918275833129883
generate_one_block  0.01885390281677246
generate_one_block  0.01910567283630371
generate_one_block  0.018682479858398438
generate_one_block  0.018518447875976562
generate_one_block  0.018993854522705078
generate_one_block  0.020957231521606445
generate_one_block  0.018605470657348633
generate_one_block  0.018739938735961914
generate_one_block  0.019458532333374023
generate_one_block  0.019366025924682617
generate_one_block  0.019300460815429688
generate_one_block  0.019356727600097656
generate_one_block  0.01890420913696289
generate_one_block  0.021189212799072266
generate_one_block  0.01885533332824707
generate_one_block  0.01884150505065918
generate_one_block  0.0212862491607666
generate_one_block  0.019014358520507812
generate_one_block  0.018956661224365234
generate_one_block  0.018922090530395508
generate_one_block  0.018421411514282227
generate_one_block  0.02042698860168457
generate_one_block  0.018407821655273438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0984640121459961
gen group dst list time:  0.02301788330078125
time for parepare:  0.01988959312438965
local_output_nid generation:  0.005631446838378906
local_in_edges_tensor generation:  0.017296552658081055
mini_batch_src_global generation:  0.018954038619995117
r_  generation:  0.18784761428833008
local_output_nid generation:  0.007839202880859375
local_in_edges_tensor generation:  0.01006174087524414
mini_batch_src_global generation:  0.02444744110107422
r_  generation:  0.19448447227478027
local_output_nid generation:  0.012389659881591797
local_in_edges_tensor generation:  0.049678802490234375
mini_batch_src_global generation:  0.04402780532836914
r_  generation:  0.19101166725158691
local_output_nid generation:  0.013842105865478516
local_in_edges_tensor generation:  0.014244318008422852
mini_batch_src_global generation:  0.03309321403503418
r_  generation:  0.18274736404418945
local_output_nid generation:  0.01235342025756836
local_in_edges_tensor generation:  0.011116504669189453
mini_batch_src_global generation:  0.0250699520111084
r_  generation:  0.17782115936279297
local_output_nid generation:  0.010511636734008789
local_in_edges_tensor generation:  0.012141942977905273
mini_batch_src_global generation:  0.022089004516601562
r_  generation:  0.1909351348876953
local_output_nid generation:  0.01183176040649414
local_in_edges_tensor generation:  0.010223388671875
mini_batch_src_global generation:  0.022216320037841797
r_  generation:  0.178056001663208
local_output_nid generation:  0.009233236312866211
local_in_edges_tensor generation:  0.009308099746704102
mini_batch_src_global generation:  0.03531956672668457
r_  generation:  0.1847391128540039
local_output_nid generation:  0.009142637252807617
local_in_edges_tensor generation:  0.008736133575439453
mini_batch_src_global generation:  0.022984027862548828
r_  generation:  0.1797475814819336
local_output_nid generation:  0.009645938873291016
local_in_edges_tensor generation:  0.009196758270263672
mini_batch_src_global generation:  0.022434711456298828
r_  generation:  0.1777327060699463
local_output_nid generation:  0.009783267974853516
local_in_edges_tensor generation:  0.009613275527954102
mini_batch_src_global generation:  0.023264408111572266
r_  generation:  0.183457612991333
local_output_nid generation:  0.009387493133544922
local_in_edges_tensor generation:  0.008434057235717773
mini_batch_src_global generation:  0.023062467575073242
r_  generation:  0.17908239364624023
local_output_nid generation:  0.009508371353149414
local_in_edges_tensor generation:  0.008611202239990234
mini_batch_src_global generation:  0.0224606990814209
r_  generation:  0.18016695976257324
local_output_nid generation:  0.012349128723144531
local_in_edges_tensor generation:  0.008987903594970703
mini_batch_src_global generation:  0.02337932586669922
r_  generation:  0.18952059745788574
local_output_nid generation:  0.009659051895141602
local_in_edges_tensor generation:  0.00851130485534668
mini_batch_src_global generation:  0.023117542266845703
r_  generation:  0.18318796157836914
local_output_nid generation:  0.00966787338256836
local_in_edges_tensor generation:  0.008597135543823242
mini_batch_src_global generation:  0.02275228500366211
r_  generation:  0.1803889274597168
local_output_nid generation:  0.009680509567260742
local_in_edges_tensor generation:  0.008678674697875977
mini_batch_src_global generation:  0.02387714385986328
r_  generation:  0.18002939224243164
local_output_nid generation:  0.009929418563842773
local_in_edges_tensor generation:  0.00966191291809082
mini_batch_src_global generation:  0.02490687370300293
r_  generation:  0.1902151107788086
local_output_nid generation:  0.010149002075195312
local_in_edges_tensor generation:  0.010476827621459961
mini_batch_src_global generation:  0.02391362190246582
r_  generation:  0.18961191177368164
local_output_nid generation:  0.010142803192138672
local_in_edges_tensor generation:  0.01043391227722168
mini_batch_src_global generation:  0.02798748016357422
r_  generation:  0.1935131549835205
local_output_nid generation:  0.009938478469848633
local_in_edges_tensor generation:  0.008988142013549805
mini_batch_src_global generation:  0.0236358642578125
r_  generation:  0.18542170524597168
local_output_nid generation:  0.010085582733154297
local_in_edges_tensor generation:  0.00891423225402832
mini_batch_src_global generation:  0.024002552032470703
r_  generation:  0.18750810623168945
local_output_nid generation:  0.009813547134399414
local_in_edges_tensor generation:  0.008832931518554688
mini_batch_src_global generation:  0.023272037506103516
r_  generation:  0.22980952262878418
local_output_nid generation:  0.010223627090454102
local_in_edges_tensor generation:  0.008458137512207031
mini_batch_src_global generation:  0.023844003677368164
r_  generation:  0.17981910705566406
local_output_nid generation:  0.009943485260009766
local_in_edges_tensor generation:  0.008851289749145508
mini_batch_src_global generation:  0.02428126335144043
r_  generation:  0.1863996982574463
local_output_nid generation:  0.01008296012878418
local_in_edges_tensor generation:  0.009593009948730469
mini_batch_src_global generation:  0.025130271911621094
r_  generation:  0.1912097930908203
local_output_nid generation:  0.012019634246826172
local_in_edges_tensor generation:  0.009504556655883789
mini_batch_src_global generation:  0.02364063262939453
r_  generation:  0.19044876098632812
local_output_nid generation:  0.009936094284057617
local_in_edges_tensor generation:  0.010512828826904297
mini_batch_src_global generation:  0.023773193359375
r_  generation:  0.2405257225036621
local_output_nid generation:  0.009917736053466797
local_in_edges_tensor generation:  0.009479045867919922
mini_batch_src_global generation:  0.02373194694519043
r_  generation:  0.1875443458557129
local_output_nid generation:  0.010010719299316406
local_in_edges_tensor generation:  0.010236501693725586
mini_batch_src_global generation:  0.02341604232788086
r_  generation:  0.17821526527404785
local_output_nid generation:  0.009900093078613281
local_in_edges_tensor generation:  0.008840799331665039
mini_batch_src_global generation:  0.024370670318603516
r_  generation:  0.23393726348876953
local_output_nid generation:  0.009330034255981445
local_in_edges_tensor generation:  0.009303808212280273
mini_batch_src_global generation:  0.023951292037963867
r_  generation:  0.1787877082824707
----------------------check_connections_block total spend ----------------------------- 8.911524772644043
generate_one_block  0.25069761276245117
generate_one_block  0.250410795211792
generate_one_block  0.25206542015075684
generate_one_block  0.25972461700439453
generate_one_block  0.2740306854248047
generate_one_block  0.24965763092041016
generate_one_block  0.2482767105102539
generate_one_block  0.25693511962890625
generate_one_block  0.2531883716583252
generate_one_block  0.2425689697265625
generate_one_block  0.25164079666137695
generate_one_block  0.24545693397521973
generate_one_block  0.24392366409301758
generate_one_block  0.251373291015625
generate_one_block  0.24458980560302734
generate_one_block  0.2419295310974121
generate_one_block  0.24333596229553223
generate_one_block  0.2597033977508545
generate_one_block  0.2756519317626953
generate_one_block  0.2672450542449951
generate_one_block  0.2533402442932129
generate_one_block  0.2556452751159668
generate_one_block  0.25408244132995605
generate_one_block  0.243574857711792
generate_one_block  0.2519187927246094
generate_one_block  0.2586934566497803
generate_one_block  0.2546577453613281
generate_one_block  0.2573673725128174
generate_one_block  0.25607800483703613
generate_one_block  0.24464154243469238
generate_one_block  0.25519728660583496
generate_one_block  0.24579501152038574
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03894639015197754
gen group dst list time:  0.11613011360168457
time for parepare:  0.022356033325195312
local_output_nid generation:  0.02578878402709961
local_in_edges_tensor generation:  0.04592490196228027
mini_batch_src_global generation:  0.04657387733459473
r_  generation:  0.4909250736236572
local_output_nid generation:  0.030780553817749023
local_in_edges_tensor generation:  0.03713202476501465
mini_batch_src_global generation:  0.06222844123840332
r_  generation:  0.5018959045410156
local_output_nid generation:  0.03387117385864258
local_in_edges_tensor generation:  0.03726673126220703
mini_batch_src_global generation:  0.06015372276306152
r_  generation:  0.5007896423339844
local_output_nid generation:  0.03168082237243652
local_in_edges_tensor generation:  0.03018927574157715
mini_batch_src_global generation:  0.05869245529174805
r_  generation:  0.492816686630249
local_output_nid generation:  0.03181099891662598
local_in_edges_tensor generation:  0.028307199478149414
mini_batch_src_global generation:  0.05811190605163574
r_  generation:  0.5044257640838623
local_output_nid generation:  0.032129526138305664
local_in_edges_tensor generation:  0.028898239135742188
mini_batch_src_global generation:  0.060045480728149414
r_  generation:  0.5125267505645752
local_output_nid generation:  0.030824899673461914
local_in_edges_tensor generation:  0.03211522102355957
mini_batch_src_global generation:  0.05887150764465332
r_  generation:  0.508246898651123
local_output_nid generation:  0.03112936019897461
local_in_edges_tensor generation:  0.030721664428710938
mini_batch_src_global generation:  0.05959057807922363
r_  generation:  0.5019972324371338
local_output_nid generation:  0.03242754936218262
local_in_edges_tensor generation:  0.03350377082824707
mini_batch_src_global generation:  0.0588221549987793
r_  generation:  0.5040998458862305
local_output_nid generation:  0.03135275840759277
local_in_edges_tensor generation:  0.03130507469177246
mini_batch_src_global generation:  0.062049150466918945
r_  generation:  0.5088858604431152
local_output_nid generation:  0.03111433982849121
local_in_edges_tensor generation:  0.028654098510742188
mini_batch_src_global generation:  0.06007051467895508
r_  generation:  0.5097751617431641
local_output_nid generation:  0.030388832092285156
local_in_edges_tensor generation:  0.03140711784362793
mini_batch_src_global generation:  0.05954933166503906
r_  generation:  0.5066967010498047
local_output_nid generation:  0.03156614303588867
local_in_edges_tensor generation:  0.03057575225830078
mini_batch_src_global generation:  0.060242652893066406
r_  generation:  0.50852370262146
local_output_nid generation:  0.03276705741882324
local_in_edges_tensor generation:  0.032421112060546875
mini_batch_src_global generation:  0.05980324745178223
r_  generation:  0.5060293674468994
local_output_nid generation:  0.03076767921447754
local_in_edges_tensor generation:  0.032863616943359375
mini_batch_src_global generation:  0.060068607330322266
r_  generation:  0.5075948238372803
local_output_nid generation:  0.03040480613708496
local_in_edges_tensor generation:  0.031556129455566406
mini_batch_src_global generation:  0.0595555305480957
r_  generation:  0.5052957534790039
local_output_nid generation:  0.030633211135864258
local_in_edges_tensor generation:  0.030400991439819336
mini_batch_src_global generation:  0.060759544372558594
r_  generation:  0.5073342323303223
local_output_nid generation:  0.030658483505249023
local_in_edges_tensor generation:  0.03325057029724121
mini_batch_src_global generation:  0.059873104095458984
r_  generation:  0.5059688091278076
local_output_nid generation:  0.031052350997924805
local_in_edges_tensor generation:  0.033548831939697266
mini_batch_src_global generation:  0.0595853328704834
r_  generation:  0.519634485244751
local_output_nid generation:  0.030666351318359375
local_in_edges_tensor generation:  0.03458809852600098
mini_batch_src_global generation:  0.07024192810058594
r_  generation:  0.5089619159698486
local_output_nid generation:  0.03163003921508789
local_in_edges_tensor generation:  0.03089284896850586
mini_batch_src_global generation:  0.05917620658874512
r_  generation:  0.5089216232299805
local_output_nid generation:  0.030765533447265625
local_in_edges_tensor generation:  0.030617475509643555
mini_batch_src_global generation:  0.05957293510437012
r_  generation:  0.5019321441650391
local_output_nid generation:  0.03061509132385254
local_in_edges_tensor generation:  0.030882596969604492
mini_batch_src_global generation:  0.058563947677612305
r_  generation:  0.5102810859680176
local_output_nid generation:  0.03049778938293457
local_in_edges_tensor generation:  0.02897477149963379
mini_batch_src_global generation:  0.05946159362792969
r_  generation:  0.5119593143463135
local_output_nid generation:  0.03061962127685547
local_in_edges_tensor generation:  0.02866673469543457
mini_batch_src_global generation:  0.06115436553955078
r_  generation:  0.5068867206573486
local_output_nid generation:  0.030846595764160156
local_in_edges_tensor generation:  0.035677194595336914
mini_batch_src_global generation:  0.05985069274902344
r_  generation:  0.5072832107543945
local_output_nid generation:  0.0308229923248291
local_in_edges_tensor generation:  0.030490875244140625
mini_batch_src_global generation:  0.06035256385803223
r_  generation:  0.5054941177368164
local_output_nid generation:  0.030630111694335938
local_in_edges_tensor generation:  0.03050851821899414
mini_batch_src_global generation:  0.05949759483337402
r_  generation:  0.5032908916473389
local_output_nid generation:  0.030509233474731445
local_in_edges_tensor generation:  0.0343472957611084
mini_batch_src_global generation:  0.058493614196777344
r_  generation:  0.5028305053710938
local_output_nid generation:  0.030544042587280273
local_in_edges_tensor generation:  0.02898573875427246
mini_batch_src_global generation:  0.05961441993713379
r_  generation:  0.5004119873046875
local_output_nid generation:  0.03093886375427246
local_in_edges_tensor generation:  0.030128955841064453
mini_batch_src_global generation:  0.059381961822509766
r_  generation:  0.50602126121521
local_output_nid generation:  0.03043651580810547
local_in_edges_tensor generation:  0.03130292892456055
mini_batch_src_global generation:  0.05917048454284668
r_  generation:  0.4992799758911133
----------------------check_connections_block total spend ----------------------------- 23.624082326889038
generate_one_block  0.6947786808013916
generate_one_block  0.6794629096984863
generate_one_block  0.6784918308258057
generate_one_block  0.6823270320892334
generate_one_block  0.7841644287109375
generate_one_block  0.6842916011810303
generate_one_block  0.6847388744354248
generate_one_block  0.6784102916717529
generate_one_block  0.6719503402709961
generate_one_block  0.6801693439483643
generate_one_block  0.6956346035003662
generate_one_block  0.6772100925445557
generate_one_block  0.6842827796936035
generate_one_block  0.6882102489471436
generate_one_block  0.6795206069946289
generate_one_block  0.6755893230438232
generate_one_block  0.6809787750244141
generate_one_block  0.6874322891235352
generate_one_block  0.6899356842041016
generate_one_block  0.6777777671813965
generate_one_block  0.6775662899017334
generate_one_block  0.6765167713165283
generate_one_block  0.6845183372497559
generate_one_block  0.6760530471801758
generate_one_block  0.709904670715332
generate_one_block  0.6862990856170654
generate_one_block  0.6867506504058838
generate_one_block  0.6755123138427734
generate_one_block  0.6754825115203857
generate_one_block  0.6768703460693359
generate_one_block  0.6955254077911377
generate_one_block  0.6817920207977295
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.13041210174560547  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

connection checking time:  32.53560709953308
block generation total time  30.051547288894653
average batch blocks generation time:  0.9391108527779579
block dataloader generation time/epoch 66.35095167160034
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10890960693359375  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.458112716674805  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10914802551269531  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.91951322555542  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10924768447875977  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.917701721191406  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.1092519760131836  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.932735919952393  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.1088709831237793  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.64389944076538  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10959863662719727  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.788984298706055  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10941267013549805  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.671199321746826  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.1092071533203125  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 21.049240112304688  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.1093134880065918  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.718822479248047  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10905742645263672  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.520262718200684  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.1094350814819336  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.97419786453247  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10884332656860352  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.536715507507324  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10908699035644531  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.61848783493042  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10924339294433594  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.90901517868042  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10893774032592773  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.6036319732666  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10916280746459961  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.529797077178955  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10915851593017578  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 20.564051151275635  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10941028594970703  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 21.093449115753174  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 0.10962772369384766  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 21.229775428771973  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10937786102294922  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 21.254340171813965  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10927915573120117  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 20.835214614868164  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10924577713012695  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 20.97509241104126  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10913991928100586  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 20.803420543670654  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10918235778808594  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 20.537137031555176  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10929632186889648  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 20.91185235977173  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10930156707763672  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 21.105270862579346  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10919427871704102  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 20.911526679992676  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.1093301773071289  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 20.95805311203003  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10903072357177734  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 20.823278427124023  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10899782180786133  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 20.450401782989502  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2030029296875 GB
    Memory Allocated: 0.10924863815307617  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2108154296875 GB
    Memory Allocated: 20.912503719329834  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1088094711303711  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 20.411927223205566  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028259091079235077 |0.021914198994636536 |0.6306293979287148 |9.69618558883667e-05 |1.1939869076013565 |0.0053446292877197266 |
----------------------------------------------------------pseudo_mini_loss sum 1.7108185291290283
Total (block generation + training)time/epoch 126.42008256912231
Training time/epoch 60.06887435913086
Training time without block to device /epoch 59.36761999130249
Training time without total dataloading part /epoch 58.39616918563843
load block tensor time/epoch 0.9042909145355225
block to device time/epoch 0.7012543678283691
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  9158905
Number of first layer input nodes during this epoch:  4805860
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13074588775634766  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024616479873657227
range selection method range initialization spend 0.016834735870361328
time for parepare:  0.019730806350708008
local_output_nid generation:  0.0009639263153076172
local_in_edges_tensor generation:  0.00673365592956543
mini_batch_src_global generation:  0.0015175342559814453
r_  generation:  0.010866641998291016
local_output_nid generation:  0.0009906291961669922
local_in_edges_tensor generation:  0.0006949901580810547
mini_batch_src_global generation:  0.001383066177368164
r_  generation:  0.011029481887817383
local_output_nid generation:  0.0009603500366210938
local_in_edges_tensor generation:  0.0006263256072998047
mini_batch_src_global generation:  0.0011916160583496094
r_  generation:  0.009882926940917969
local_output_nid generation:  0.0009279251098632812
local_in_edges_tensor generation:  0.0006022453308105469
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.010235071182250977
local_output_nid generation:  0.0008957386016845703
local_in_edges_tensor generation:  0.0006265640258789062
mini_batch_src_global generation:  0.0011525154113769531
r_  generation:  0.01009678840637207
local_output_nid generation:  0.0008945465087890625
local_in_edges_tensor generation:  0.0006203651428222656
mini_batch_src_global generation:  0.001184225082397461
r_  generation:  0.010354995727539062
local_output_nid generation:  0.0009162425994873047
local_in_edges_tensor generation:  0.0006010532379150391
mini_batch_src_global generation:  0.001260995864868164
r_  generation:  0.010675907135009766
local_output_nid generation:  0.0009329319000244141
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.010556936264038086
local_output_nid generation:  0.0009136199951171875
local_in_edges_tensor generation:  0.0005960464477539062
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.010323047637939453
local_output_nid generation:  0.000865936279296875
local_in_edges_tensor generation:  0.0005867481231689453
mini_batch_src_global generation:  0.0011441707611083984
r_  generation:  0.010187149047851562
local_output_nid generation:  0.0009016990661621094
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.0011932849884033203
r_  generation:  0.010518550872802734
local_output_nid generation:  0.0008878707885742188
local_in_edges_tensor generation:  0.0005841255187988281
mini_batch_src_global generation:  0.0011606216430664062
r_  generation:  0.010256528854370117
local_output_nid generation:  0.0009381771087646484
local_in_edges_tensor generation:  0.0005881786346435547
mini_batch_src_global generation:  0.0011203289031982422
r_  generation:  0.010437726974487305
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.0005815029144287109
mini_batch_src_global generation:  0.0011119842529296875
r_  generation:  0.010381698608398438
local_output_nid generation:  0.0009114742279052734
local_in_edges_tensor generation:  0.0005729198455810547
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.010019063949584961
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0005784034729003906
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.010256052017211914
local_output_nid generation:  0.0009016990661621094
local_in_edges_tensor generation:  0.0005908012390136719
mini_batch_src_global generation:  0.0012183189392089844
r_  generation:  0.010565042495727539
local_output_nid generation:  0.0008802413940429688
local_in_edges_tensor generation:  0.0005862712860107422
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.01062321662902832
local_output_nid generation:  0.0008833408355712891
local_in_edges_tensor generation:  0.0005867481231689453
mini_batch_src_global generation:  0.0011913776397705078
r_  generation:  0.010145902633666992
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0005815029144287109
mini_batch_src_global generation:  0.001094818115234375
r_  generation:  0.010235786437988281
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0005986690521240234
mini_batch_src_global generation:  0.0012347698211669922
r_  generation:  0.010684013366699219
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005903244018554688
mini_batch_src_global generation:  0.0011816024780273438
r_  generation:  0.01038980484008789
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.0012636184692382812
r_  generation:  0.010281801223754883
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.0006144046783447266
mini_batch_src_global generation:  0.00128173828125
r_  generation:  0.010577201843261719
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0005769729614257812
mini_batch_src_global generation:  0.0011718273162841797
r_  generation:  0.009959697723388672
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.0006265640258789062
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.010548591613769531
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.01058053970336914
local_output_nid generation:  0.0009133815765380859
local_in_edges_tensor generation:  0.0006105899810791016
mini_batch_src_global generation:  0.0012121200561523438
r_  generation:  0.010620594024658203
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.0011327266693115234
r_  generation:  0.010592937469482422
local_output_nid generation:  0.0008907318115234375
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.001134634017944336
r_  generation:  0.010371923446655273
local_output_nid generation:  0.0008952617645263672
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.012499094009399414
local_output_nid generation:  0.0009100437164306641
local_in_edges_tensor generation:  0.0005650520324707031
mini_batch_src_global generation:  0.0011715888977050781
r_  generation:  0.010098457336425781
----------------------check_connections_block total spend ----------------------------- 0.5286722183227539
generate_one_block  0.0217742919921875
generate_one_block  0.021325111389160156
generate_one_block  0.019544363021850586
generate_one_block  0.019642114639282227
generate_one_block  0.019306182861328125
generate_one_block  0.019440650939941406
generate_one_block  0.019808292388916016
generate_one_block  0.01963353157043457
generate_one_block  0.019345998764038086
generate_one_block  0.018942832946777344
generate_one_block  0.019022464752197266
generate_one_block  0.01897430419921875
generate_one_block  0.019194364547729492
generate_one_block  0.019016265869140625
generate_one_block  0.01837944984436035
generate_one_block  0.018874645233154297
generate_one_block  0.019405126571655273
generate_one_block  0.019272327423095703
generate_one_block  0.018570423126220703
generate_one_block  0.018616676330566406
generate_one_block  0.01965165138244629
generate_one_block  0.018964290618896484
generate_one_block  0.021252870559692383
generate_one_block  0.019606828689575195
generate_one_block  0.018392324447631836
generate_one_block  0.019352436065673828
generate_one_block  0.019258499145507812
generate_one_block  0.01932811737060547
generate_one_block  0.019189119338989258
generate_one_block  0.018865585327148438
generate_one_block  0.01857733726501465
generate_one_block  0.01836538314819336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0380396842956543
gen group dst list time:  0.020465612411499023
time for parepare:  0.01976752281188965
local_output_nid generation:  0.0056247711181640625
local_in_edges_tensor generation:  0.017629623413085938
mini_batch_src_global generation:  0.017253637313842773
r_  generation:  0.16407227516174316
local_output_nid generation:  0.007787942886352539
local_in_edges_tensor generation:  0.010923147201538086
mini_batch_src_global generation:  0.021318912506103516
r_  generation:  0.16713404655456543
local_output_nid generation:  0.008016347885131836
local_in_edges_tensor generation:  0.032344818115234375
mini_batch_src_global generation:  0.020038127899169922
r_  generation:  0.17214226722717285
local_output_nid generation:  0.008583784103393555
local_in_edges_tensor generation:  0.01157069206237793
mini_batch_src_global generation:  0.020802974700927734
r_  generation:  0.21323060989379883
local_output_nid generation:  0.013993501663208008
local_in_edges_tensor generation:  0.013230323791503906
mini_batch_src_global generation:  0.02556586265563965
r_  generation:  0.19272947311401367
local_output_nid generation:  0.01248621940612793
local_in_edges_tensor generation:  0.00992441177368164
mini_batch_src_global generation:  0.025441646575927734
r_  generation:  0.18249821662902832
local_output_nid generation:  0.010206460952758789
local_in_edges_tensor generation:  0.009884119033813477
mini_batch_src_global generation:  0.02629876136779785
r_  generation:  0.18720340728759766
local_output_nid generation:  0.009314537048339844
local_in_edges_tensor generation:  0.00905156135559082
mini_batch_src_global generation:  0.03581833839416504
r_  generation:  0.20084714889526367
local_output_nid generation:  0.013633489608764648
local_in_edges_tensor generation:  0.011906623840332031
mini_batch_src_global generation:  0.025541067123413086
r_  generation:  0.20641613006591797
local_output_nid generation:  0.014211177825927734
local_in_edges_tensor generation:  0.01283121109008789
mini_batch_src_global generation:  0.025683164596557617
r_  generation:  0.20544672012329102
local_output_nid generation:  0.014518976211547852
local_in_edges_tensor generation:  0.013543128967285156
mini_batch_src_global generation:  0.026118040084838867
r_  generation:  0.19660615921020508
local_output_nid generation:  0.015902042388916016
local_in_edges_tensor generation:  0.014100790023803711
mini_batch_src_global generation:  0.022597074508666992
r_  generation:  0.18470478057861328
local_output_nid generation:  0.015057802200317383
local_in_edges_tensor generation:  0.014201164245605469
mini_batch_src_global generation:  0.024097204208374023
r_  generation:  0.189284086227417
local_output_nid generation:  0.015004158020019531
local_in_edges_tensor generation:  0.01236271858215332
mini_batch_src_global generation:  0.023012638092041016
r_  generation:  0.18583226203918457
local_output_nid generation:  0.014712333679199219
local_in_edges_tensor generation:  0.012809514999389648
mini_batch_src_global generation:  0.0222165584564209
r_  generation:  0.18169832229614258
local_output_nid generation:  0.014887094497680664
local_in_edges_tensor generation:  0.012395858764648438
mini_batch_src_global generation:  0.022670269012451172
r_  generation:  0.18537235260009766
local_output_nid generation:  0.01587986946105957
local_in_edges_tensor generation:  0.012127399444580078
mini_batch_src_global generation:  0.04027438163757324
r_  generation:  0.21927952766418457
local_output_nid generation:  0.011563539505004883
local_in_edges_tensor generation:  0.010278463363647461
mini_batch_src_global generation:  0.037825822830200195
r_  generation:  0.20646286010742188
local_output_nid generation:  0.010152578353881836
local_in_edges_tensor generation:  0.009308815002441406
mini_batch_src_global generation:  0.02893662452697754
r_  generation:  0.20453500747680664
local_output_nid generation:  0.01308298110961914
local_in_edges_tensor generation:  0.009662628173828125
mini_batch_src_global generation:  0.0404665470123291
r_  generation:  0.20334434509277344
local_output_nid generation:  0.010030746459960938
local_in_edges_tensor generation:  0.010922670364379883
mini_batch_src_global generation:  0.029892683029174805
r_  generation:  0.21020102500915527
local_output_nid generation:  0.009540796279907227
local_in_edges_tensor generation:  0.008785724639892578
mini_batch_src_global generation:  0.029538393020629883
r_  generation:  0.21619582176208496
local_output_nid generation:  0.009392976760864258
local_in_edges_tensor generation:  0.00966191291809082
mini_batch_src_global generation:  0.02966928482055664
r_  generation:  0.19853425025939941
local_output_nid generation:  0.0096282958984375
local_in_edges_tensor generation:  0.008891820907592773
mini_batch_src_global generation:  0.03310823440551758
r_  generation:  0.21174144744873047
local_output_nid generation:  0.009244441986083984
local_in_edges_tensor generation:  0.008760929107666016
mini_batch_src_global generation:  0.029184818267822266
r_  generation:  0.19613027572631836
local_output_nid generation:  0.009562015533447266
local_in_edges_tensor generation:  0.009105443954467773
mini_batch_src_global generation:  0.030365467071533203
r_  generation:  0.21186375617980957
local_output_nid generation:  0.009505748748779297
local_in_edges_tensor generation:  0.01035451889038086
mini_batch_src_global generation:  0.040963172912597656
r_  generation:  0.2053511142730713
local_output_nid generation:  0.009554624557495117
local_in_edges_tensor generation:  0.008837699890136719
mini_batch_src_global generation:  0.03736758232116699
r_  generation:  0.22294139862060547
local_output_nid generation:  0.010871171951293945
local_in_edges_tensor generation:  0.009238004684448242
mini_batch_src_global generation:  0.05178356170654297
r_  generation:  0.22963929176330566
local_output_nid generation:  0.00972604751586914
local_in_edges_tensor generation:  0.008859872817993164
mini_batch_src_global generation:  0.032224178314208984
r_  generation:  0.2016451358795166
local_output_nid generation:  0.009430646896362305
local_in_edges_tensor generation:  0.008692264556884766
mini_batch_src_global generation:  0.029350757598876953
r_  generation:  0.19985198974609375
local_output_nid generation:  0.009359121322631836
local_in_edges_tensor generation:  0.00853276252746582
mini_batch_src_global generation:  0.028246164321899414
r_  generation:  0.19835591316223145
----------------------check_connections_block total spend ----------------------------- 9.536336183547974
generate_one_block  0.2561349868774414
generate_one_block  0.2444934844970703
generate_one_block  0.24515295028686523
generate_one_block  0.28057360649108887
generate_one_block  0.30355405807495117
generate_one_block  0.28275442123413086
generate_one_block  0.2791316509246826
generate_one_block  0.2615656852722168
generate_one_block  0.2608010768890381
generate_one_block  0.27091312408447266
generate_one_block  0.26744723320007324
generate_one_block  0.25288891792297363
generate_one_block  0.25745558738708496
generate_one_block  0.2540273666381836
generate_one_block  0.2536776065826416
generate_one_block  0.2529571056365967
generate_one_block  0.25600767135620117
generate_one_block  0.2554903030395508
generate_one_block  0.24970030784606934
generate_one_block  0.2566990852355957
generate_one_block  0.2611966133117676
generate_one_block  0.2492048740386963
generate_one_block  0.251741886138916
generate_one_block  0.2825040817260742
generate_one_block  0.2493422031402588
generate_one_block  0.26366686820983887
generate_one_block  0.26453328132629395
generate_one_block  0.261462926864624
generate_one_block  0.25752902030944824
generate_one_block  0.2541818618774414
generate_one_block  0.2496349811553955
generate_one_block  0.2445087432861328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03675723075866699
gen group dst list time:  0.11753082275390625
time for parepare:  0.0213315486907959
local_output_nid generation:  0.027098417282104492
local_in_edges_tensor generation:  0.048569679260253906
mini_batch_src_global generation:  0.061631202697753906
r_  generation:  0.5567793846130371
local_output_nid generation:  0.03153681755065918
local_in_edges_tensor generation:  0.03859543800354004
mini_batch_src_global generation:  0.0627138614654541
r_  generation:  0.4981870651245117
local_output_nid generation:  0.030796289443969727
local_in_edges_tensor generation:  0.03170657157897949
mini_batch_src_global generation:  0.05814099311828613
r_  generation:  0.5047476291656494
local_output_nid generation:  0.031185388565063477
local_in_edges_tensor generation:  0.03012847900390625
mini_batch_src_global generation:  0.05995297431945801
r_  generation:  0.5082664489746094
local_output_nid generation:  0.03280782699584961
local_in_edges_tensor generation:  0.03471803665161133
mini_batch_src_global generation:  0.07493233680725098
r_  generation:  0.5177240371704102
local_output_nid generation:  0.03320574760437012
local_in_edges_tensor generation:  0.03062915802001953
mini_batch_src_global generation:  0.05994772911071777
r_  generation:  0.5031721591949463
local_output_nid generation:  0.03063058853149414
local_in_edges_tensor generation:  0.03244447708129883
mini_batch_src_global generation:  0.05821418762207031
r_  generation:  0.5063374042510986
local_output_nid generation:  0.03058934211730957
local_in_edges_tensor generation:  0.030131101608276367
mini_batch_src_global generation:  0.060365915298461914
r_  generation:  0.5019881725311279
local_output_nid generation:  0.03039073944091797
local_in_edges_tensor generation:  0.030467748641967773
mini_batch_src_global generation:  0.05918002128601074
r_  generation:  0.5067148208618164
local_output_nid generation:  0.029927968978881836
local_in_edges_tensor generation:  0.027986764907836914
mini_batch_src_global generation:  0.05989861488342285
r_  generation:  0.5142567157745361
local_output_nid generation:  0.02982163429260254
local_in_edges_tensor generation:  0.028003931045532227
mini_batch_src_global generation:  0.05835771560668945
r_  generation:  0.5005819797515869
local_output_nid generation:  0.03019547462463379
local_in_edges_tensor generation:  0.029249906539916992
mini_batch_src_global generation:  0.05967521667480469
r_  generation:  0.4981348514556885
local_output_nid generation:  0.030337810516357422
local_in_edges_tensor generation:  0.030045747756958008
mini_batch_src_global generation:  0.058834075927734375
r_  generation:  0.5091142654418945
local_output_nid generation:  0.030216693878173828
local_in_edges_tensor generation:  0.03011798858642578
mini_batch_src_global generation:  0.06381082534790039
r_  generation:  0.502483606338501
local_output_nid generation:  0.030092477798461914
local_in_edges_tensor generation:  0.03621530532836914
mini_batch_src_global generation:  0.0602567195892334
r_  generation:  0.504514217376709
local_output_nid generation:  0.03037118911743164
local_in_edges_tensor generation:  0.031882286071777344
mini_batch_src_global generation:  0.06267571449279785
r_  generation:  0.5113816261291504
local_output_nid generation:  0.030512571334838867
local_in_edges_tensor generation:  0.0324249267578125
mini_batch_src_global generation:  0.05880594253540039
r_  generation:  0.5115435123443604
local_output_nid generation:  0.030595064163208008
local_in_edges_tensor generation:  0.033574819564819336
mini_batch_src_global generation:  0.061927080154418945
r_  generation:  0.507495641708374
local_output_nid generation:  0.03146982192993164
local_in_edges_tensor generation:  0.03503060340881348
mini_batch_src_global generation:  0.05976128578186035
r_  generation:  0.5226609706878662
local_output_nid generation:  0.03249192237854004
local_in_edges_tensor generation:  0.028641939163208008
mini_batch_src_global generation:  0.07057523727416992
r_  generation:  0.504194974899292
local_output_nid generation:  0.03037285804748535
local_in_edges_tensor generation:  0.030616283416748047
mini_batch_src_global generation:  0.06166195869445801
r_  generation:  0.5110030174255371
local_output_nid generation:  0.030312776565551758
local_in_edges_tensor generation:  0.028013229370117188
mini_batch_src_global generation:  0.05991244316101074
r_  generation:  0.5079987049102783
local_output_nid generation:  0.030215740203857422
local_in_edges_tensor generation:  0.03338265419006348
mini_batch_src_global generation:  0.05831193923950195
r_  generation:  0.5157253742218018
local_output_nid generation:  0.030225276947021484
local_in_edges_tensor generation:  0.030385255813598633
mini_batch_src_global generation:  0.06356549263000488
r_  generation:  0.5083794593811035
local_output_nid generation:  0.030010461807250977
local_in_edges_tensor generation:  0.028117895126342773
mini_batch_src_global generation:  0.058342695236206055
r_  generation:  0.5064120292663574
local_output_nid generation:  0.030631065368652344
local_in_edges_tensor generation:  0.03330516815185547
mini_batch_src_global generation:  0.06240534782409668
r_  generation:  0.5061640739440918
local_output_nid generation:  0.030550241470336914
local_in_edges_tensor generation:  0.0344080924987793
mini_batch_src_global generation:  0.05877947807312012
r_  generation:  0.5127520561218262
local_output_nid generation:  0.03074789047241211
local_in_edges_tensor generation:  0.03404712677001953
mini_batch_src_global generation:  0.06001687049865723
r_  generation:  0.507002592086792
local_output_nid generation:  0.030356407165527344
local_in_edges_tensor generation:  0.032146453857421875
mini_batch_src_global generation:  0.059067726135253906
r_  generation:  0.5124313831329346
local_output_nid generation:  0.030077219009399414
local_in_edges_tensor generation:  0.033144235610961914
mini_batch_src_global generation:  0.06119251251220703
r_  generation:  0.5055489540100098
local_output_nid generation:  0.030323028564453125
local_in_edges_tensor generation:  0.028474807739257812
mini_batch_src_global generation:  0.059046030044555664
r_  generation:  0.5066637992858887
local_output_nid generation:  0.030028104782104492
local_in_edges_tensor generation:  0.03036665916442871
mini_batch_src_global generation:  0.06125760078430176
r_  generation:  0.5087614059448242
----------------------check_connections_block total spend ----------------------------- 23.812400817871094
generate_one_block  0.6977622509002686
generate_one_block  0.6795065402984619
generate_one_block  0.6809966564178467
generate_one_block  0.6907908916473389
generate_one_block  0.7966749668121338
generate_one_block  0.6750133037567139
generate_one_block  0.6769366264343262
generate_one_block  0.6822659969329834
generate_one_block  0.6836881637573242
generate_one_block  0.6708016395568848
generate_one_block  0.6812229156494141
generate_one_block  0.6765391826629639
generate_one_block  0.6787731647491455
generate_one_block  0.6774649620056152
generate_one_block  0.6788177490234375
generate_one_block  0.6870803833007812
generate_one_block  0.6933045387268066
generate_one_block  0.6781692504882812
generate_one_block  0.6793539524078369
generate_one_block  0.6756551265716553
generate_one_block  0.6776926517486572
generate_one_block  0.6719894409179688
generate_one_block  0.6707627773284912
generate_one_block  0.6885547637939453
generate_one_block  0.6914072036743164
generate_one_block  0.6854088306427002
generate_one_block  0.6867256164550781
generate_one_block  0.6828131675720215
generate_one_block  0.6819326877593994
generate_one_block  0.6751477718353271
generate_one_block  0.6767215728759766
generate_one_block  0.6771938800811768
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13074588775634766  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

connection checking time:  33.34873700141907
block generation total time  30.238102197647095
average batch blocks generation time:  0.9449406936764717
block dataloader generation time/epoch 66.77819049358368
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10900354385375977  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 20.742955207824707  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10911178588867188  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 20.501193046569824  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10910463333129883  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 20.616562843322754  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10922765731811523  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 21.032951831817627  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10925483703613281  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 20.953962326049805  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10937261581420898  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 20.844258308410645  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10963964462280273  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 21.099038124084473  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10939836502075195  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 21.00589895248413  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10947036743164062  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 20.970022678375244  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10918760299682617  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.90135955810547  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.1092081069946289  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.538551807403564  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10911321640014648  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.670188903808594  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10936641693115234  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.912755012512207  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10939693450927734  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.673413276672363  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10894393920898438  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.292795658111572  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.1095576286315918  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.726693630218506  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10927772521972656  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.94538688659668  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10934305191040039  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.88167667388916  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10945367813110352  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.71791696548462  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10913753509521484  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.76297426223755  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10947608947753906  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 21.11408281326294  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10902738571166992  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.65806770324707  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10879707336425781  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.517845153808594  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10935688018798828  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 21.027299404144287  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10881757736206055  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 20.429447174072266  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2147216796875 GB
    Memory Allocated: 0.10954666137695312  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 21.078277111053467  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10932207107543945  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.953153133392334  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10928153991699219  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 21.061659812927246  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10931873321533203  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.8883695602417  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10878181457519531  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.656786918640137  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10889816284179688  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.434093475341797  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10891103744506836  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.306533336639404  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03295072913169861 |0.023556731641292572 |0.6269651725888252 |9.686499834060669e-05 |1.1895287409424782 |0.0051805973052978516 |
----------------------------------------------------------pseudo_mini_loss sum 1.6575031280517578
Total (block generation + training)time/epoch 126.81510496139526
Training time/epoch 60.00441789627075
Training time without block to device /epoch 59.25060248374939
Training time without total dataloading part /epoch 58.136085510253906
load block tensor time/epoch 1.0544233322143555
block to device time/epoch 0.7538154125213623
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  9161026
Number of first layer input nodes during this epoch:  4808146
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.1310410499572754  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024170875549316406
range selection method range initialization spend 0.014227628707885742
time for parepare:  0.020679712295532227
local_output_nid generation:  0.0009710788726806641
local_in_edges_tensor generation:  0.005697488784790039
mini_batch_src_global generation:  0.0018115043640136719
r_  generation:  0.011190176010131836
local_output_nid generation:  0.0009930133819580078
local_in_edges_tensor generation:  0.0007011890411376953
mini_batch_src_global generation:  0.0016291141510009766
r_  generation:  0.011293649673461914
local_output_nid generation:  0.0009567737579345703
local_in_edges_tensor generation:  0.0006480216979980469
mini_batch_src_global generation:  0.0012021064758300781
r_  generation:  0.010443449020385742
local_output_nid generation:  0.0009150505065917969
local_in_edges_tensor generation:  0.0006182193756103516
mini_batch_src_global generation:  0.0011701583862304688
r_  generation:  0.010276556015014648
local_output_nid generation:  0.0008933544158935547
local_in_edges_tensor generation:  0.0005860328674316406
mini_batch_src_global generation:  0.0011110305786132812
r_  generation:  0.009715557098388672
local_output_nid generation:  0.0008864402770996094
local_in_edges_tensor generation:  0.0005929470062255859
mini_batch_src_global generation:  0.0011925697326660156
r_  generation:  0.010079622268676758
local_output_nid generation:  0.0009126663208007812
local_in_edges_tensor generation:  0.0005939006805419922
mini_batch_src_global generation:  0.0011348724365234375
r_  generation:  0.010058879852294922
local_output_nid generation:  0.0009067058563232422
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.010216474533081055
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.0005853176116943359
mini_batch_src_global generation:  0.0011394023895263672
r_  generation:  0.010277271270751953
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0005934238433837891
mini_batch_src_global generation:  0.0011816024780273438
r_  generation:  0.010486602783203125
local_output_nid generation:  0.0008900165557861328
local_in_edges_tensor generation:  0.0005815029144287109
mini_batch_src_global generation:  0.0011639595031738281
r_  generation:  0.010316848754882812
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005800724029541016
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.009968757629394531
local_output_nid generation:  0.00087738037109375
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.0011663436889648438
r_  generation:  0.010442018508911133
local_output_nid generation:  0.0008828639984130859
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.0011849403381347656
r_  generation:  0.010418176651000977
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0005831718444824219
mini_batch_src_global generation:  0.0011868476867675781
r_  generation:  0.010344982147216797
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0005769729614257812
mini_batch_src_global generation:  0.0011668205261230469
r_  generation:  0.010079622268676758
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.010407686233520508
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0005903244018554688
mini_batch_src_global generation:  0.0012154579162597656
r_  generation:  0.010140657424926758
local_output_nid generation:  0.0008687973022460938
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.010225534439086914
local_output_nid generation:  0.0008840560913085938
local_in_edges_tensor generation:  0.0005824565887451172
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.010379791259765625
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0005819797515869141
mini_batch_src_global generation:  0.0012416839599609375
r_  generation:  0.010506868362426758
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.0011167526245117188
r_  generation:  0.010038375854492188
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0005788803100585938
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.010263204574584961
local_output_nid generation:  0.0008754730224609375
local_in_edges_tensor generation:  0.0005931854248046875
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010689973831176758
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0005795955657958984
mini_batch_src_global generation:  0.0011262893676757812
r_  generation:  0.010055780410766602
local_output_nid generation:  0.0008502006530761719
local_in_edges_tensor generation:  0.0006196498870849609
mini_batch_src_global generation:  0.001249551773071289
r_  generation:  0.010795831680297852
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.0012006759643554688
r_  generation:  0.010318279266357422
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0006115436553955078
mini_batch_src_global generation:  0.0012302398681640625
r_  generation:  0.010550975799560547
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.00058746337890625
mini_batch_src_global generation:  0.0012557506561279297
r_  generation:  0.010432004928588867
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0012323856353759766
r_  generation:  0.010137081146240234
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.00058746337890625
mini_batch_src_global generation:  0.0012505054473876953
r_  generation:  0.010565996170043945
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0005788803100585938
mini_batch_src_global generation:  0.0011806488037109375
r_  generation:  0.010171651840209961
----------------------check_connections_block total spend ----------------------------- 0.5251688957214355
generate_one_block  0.02587580680847168
generate_one_block  0.021689176559448242
generate_one_block  0.01994013786315918
generate_one_block  0.019397974014282227
generate_one_block  0.018472671508789062
generate_one_block  0.018809795379638672
generate_one_block  0.018513917922973633
generate_one_block  0.018905162811279297
generate_one_block  0.01862931251525879
generate_one_block  0.018911361694335938
generate_one_block  0.01876235008239746
generate_one_block  0.018456697463989258
generate_one_block  0.019115686416625977
generate_one_block  0.01889514923095703
generate_one_block  0.018599748611450195
generate_one_block  0.018277406692504883
generate_one_block  0.01891183853149414
generate_one_block  0.018290281295776367
generate_one_block  0.018521785736083984
generate_one_block  0.018815040588378906
generate_one_block  0.01896381378173828
generate_one_block  0.018233537673950195
generate_one_block  0.021158933639526367
generate_one_block  0.01970672607421875
generate_one_block  0.018024682998657227
generate_one_block  0.01980113983154297
generate_one_block  0.018390655517578125
generate_one_block  0.019095420837402344
generate_one_block  0.018776416778564453
generate_one_block  0.018521547317504883
generate_one_block  0.018799304962158203
generate_one_block  0.01840043067932129
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03823685646057129
gen group dst list time:  0.022951602935791016
time for parepare:  0.021659135818481445
local_output_nid generation:  0.005911350250244141
local_in_edges_tensor generation:  0.015891313552856445
mini_batch_src_global generation:  0.018800735473632812
r_  generation:  0.16783499717712402
local_output_nid generation:  0.00790715217590332
local_in_edges_tensor generation:  0.011100292205810547
mini_batch_src_global generation:  0.02228713035583496
r_  generation:  0.17356443405151367
local_output_nid generation:  0.008263111114501953
local_in_edges_tensor generation:  0.032073259353637695
mini_batch_src_global generation:  0.022105932235717773
r_  generation:  0.17864084243774414
local_output_nid generation:  0.008632659912109375
local_in_edges_tensor generation:  0.009901046752929688
mini_batch_src_global generation:  0.03339862823486328
r_  generation:  0.19364571571350098
local_output_nid generation:  0.013076543807983398
local_in_edges_tensor generation:  0.013834238052368164
mini_batch_src_global generation:  0.02485799789428711
r_  generation:  0.20114660263061523
local_output_nid generation:  0.012122154235839844
local_in_edges_tensor generation:  0.010857343673706055
mini_batch_src_global generation:  0.025035381317138672
r_  generation:  0.17994451522827148
local_output_nid generation:  0.0093231201171875
local_in_edges_tensor generation:  0.009861946105957031
mini_batch_src_global generation:  0.021772384643554688
r_  generation:  0.17473149299621582
local_output_nid generation:  0.008920907974243164
local_in_edges_tensor generation:  0.0111236572265625
mini_batch_src_global generation:  0.023204326629638672
r_  generation:  0.1900022029876709
local_output_nid generation:  0.009696722030639648
local_in_edges_tensor generation:  0.011632680892944336
mini_batch_src_global generation:  0.02312493324279785
r_  generation:  0.18823003768920898
local_output_nid generation:  0.00902247428894043
local_in_edges_tensor generation:  0.011486053466796875
mini_batch_src_global generation:  0.025819063186645508
r_  generation:  0.19008922576904297
local_output_nid generation:  0.009062528610229492
local_in_edges_tensor generation:  0.00885462760925293
mini_batch_src_global generation:  0.02291584014892578
r_  generation:  0.18739819526672363
local_output_nid generation:  0.00886845588684082
local_in_edges_tensor generation:  0.009520292282104492
mini_batch_src_global generation:  0.0251004695892334
r_  generation:  0.17943859100341797
local_output_nid generation:  0.00994563102722168
local_in_edges_tensor generation:  0.015405654907226562
mini_batch_src_global generation:  0.023246288299560547
r_  generation:  0.19666576385498047
local_output_nid generation:  0.011144876480102539
local_in_edges_tensor generation:  0.011560201644897461
mini_batch_src_global generation:  0.024600982666015625
r_  generation:  0.18596839904785156
local_output_nid generation:  0.009345769882202148
local_in_edges_tensor generation:  0.010521173477172852
mini_batch_src_global generation:  0.022983789443969727
r_  generation:  0.18403387069702148
local_output_nid generation:  0.009250640869140625
local_in_edges_tensor generation:  0.011596202850341797
mini_batch_src_global generation:  0.02375960350036621
r_  generation:  0.18141412734985352
local_output_nid generation:  0.009411811828613281
local_in_edges_tensor generation:  0.009084463119506836
mini_batch_src_global generation:  0.02326226234436035
r_  generation:  0.18553972244262695
local_output_nid generation:  0.009278297424316406
local_in_edges_tensor generation:  0.010346651077270508
mini_batch_src_global generation:  0.02363419532775879
r_  generation:  0.1826615333557129
local_output_nid generation:  0.009282350540161133
local_in_edges_tensor generation:  0.008958578109741211
mini_batch_src_global generation:  0.023226261138916016
r_  generation:  0.18534612655639648
local_output_nid generation:  0.009446382522583008
local_in_edges_tensor generation:  0.011278867721557617
mini_batch_src_global generation:  0.023194313049316406
r_  generation:  0.18586421012878418
local_output_nid generation:  0.009695053100585938
local_in_edges_tensor generation:  0.009601593017578125
mini_batch_src_global generation:  0.024894237518310547
r_  generation:  0.18568706512451172
local_output_nid generation:  0.009313344955444336
local_in_edges_tensor generation:  0.009561538696289062
mini_batch_src_global generation:  0.022542238235473633
r_  generation:  0.17719030380249023
local_output_nid generation:  0.009382486343383789
local_in_edges_tensor generation:  0.008884906768798828
mini_batch_src_global generation:  0.023226261138916016
r_  generation:  0.1840682029724121
local_output_nid generation:  0.009802579879760742
local_in_edges_tensor generation:  0.009098529815673828
mini_batch_src_global generation:  0.02416396141052246
r_  generation:  0.18942952156066895
local_output_nid generation:  0.009122133255004883
local_in_edges_tensor generation:  0.009418964385986328
mini_batch_src_global generation:  0.022088289260864258
r_  generation:  0.17467808723449707
local_output_nid generation:  0.010042428970336914
local_in_edges_tensor generation:  0.009439706802368164
mini_batch_src_global generation:  0.02504897117614746
r_  generation:  0.1925182342529297
local_output_nid generation:  0.009273529052734375
local_in_edges_tensor generation:  0.00881814956665039
mini_batch_src_global generation:  0.022719144821166992
r_  generation:  0.18135547637939453
local_output_nid generation:  0.009497404098510742
local_in_edges_tensor generation:  0.009207010269165039
mini_batch_src_global generation:  0.02329540252685547
r_  generation:  0.18793940544128418
local_output_nid generation:  0.00958561897277832
local_in_edges_tensor generation:  0.011189460754394531
mini_batch_src_global generation:  0.022994518280029297
r_  generation:  0.1860034465789795
local_output_nid generation:  0.00922703742980957
local_in_edges_tensor generation:  0.00890660285949707
mini_batch_src_global generation:  0.023393869400024414
r_  generation:  0.18271350860595703
local_output_nid generation:  0.01100468635559082
local_in_edges_tensor generation:  0.009047269821166992
mini_batch_src_global generation:  0.023164987564086914
r_  generation:  0.1864924430847168
local_output_nid generation:  0.009438037872314453
local_in_edges_tensor generation:  0.008893489837646484
mini_batch_src_global generation:  0.023185014724731445
r_  generation:  0.18223905563354492
----------------------check_connections_block total spend ----------------------------- 8.68022108078003
generate_one_block  0.2684659957885742
generate_one_block  0.24811267852783203
generate_one_block  0.254671573638916
generate_one_block  0.24476408958435059
generate_one_block  0.251955509185791
generate_one_block  0.24637532234191895
generate_one_block  0.23656392097473145
generate_one_block  0.2537546157836914
generate_one_block  0.24613595008850098
generate_one_block  0.25435733795166016
generate_one_block  0.2508695125579834
generate_one_block  0.24039530754089355
generate_one_block  0.25226330757141113
generate_one_block  0.2560594081878662
generate_one_block  0.24786972999572754
generate_one_block  0.2398068904876709
generate_one_block  0.2528209686279297
generate_one_block  0.25330567359924316
generate_one_block  0.25856781005859375
generate_one_block  0.2594325542449951
generate_one_block  0.2511162757873535
generate_one_block  0.23996734619140625
generate_one_block  0.24926137924194336
generate_one_block  0.2599754333496094
generate_one_block  0.2368450164794922
generate_one_block  0.2633545398712158
generate_one_block  0.2503023147583008
generate_one_block  0.2548716068267822
generate_one_block  0.2520427703857422
generate_one_block  0.24783539772033691
generate_one_block  0.2513103485107422
generate_one_block  0.2417619228363037
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03851795196533203
gen group dst list time:  0.1137087345123291
time for parepare:  0.020665645599365234
local_output_nid generation:  0.02635025978088379
local_in_edges_tensor generation:  0.05349898338317871
mini_batch_src_global generation:  0.04722476005554199
r_  generation:  0.4943370819091797
local_output_nid generation:  0.030578136444091797
local_in_edges_tensor generation:  0.037045955657958984
mini_batch_src_global generation:  0.06155896186828613
r_  generation:  0.49654340744018555
local_output_nid generation:  0.031106233596801758
local_in_edges_tensor generation:  0.02986931800842285
mini_batch_src_global generation:  0.05953359603881836
r_  generation:  0.5045673847198486
local_output_nid generation:  0.03112316131591797
local_in_edges_tensor generation:  0.03513836860656738
mini_batch_src_global generation:  0.05860447883605957
r_  generation:  0.4905967712402344
local_output_nid generation:  0.030758142471313477
local_in_edges_tensor generation:  0.03708958625793457
mini_batch_src_global generation:  0.0617833137512207
r_  generation:  0.5015196800231934
local_output_nid generation:  0.03093123435974121
local_in_edges_tensor generation:  0.03120565414428711
mini_batch_src_global generation:  0.0595552921295166
r_  generation:  0.4959084987640381
local_output_nid generation:  0.029300212860107422
local_in_edges_tensor generation:  0.039446115493774414
mini_batch_src_global generation:  0.058638572692871094
r_  generation:  0.5036921501159668
local_output_nid generation:  0.030200958251953125
local_in_edges_tensor generation:  0.03322601318359375
mini_batch_src_global generation:  0.060647010803222656
r_  generation:  0.4956247806549072
local_output_nid generation:  0.031941890716552734
local_in_edges_tensor generation:  0.029331684112548828
mini_batch_src_global generation:  0.05893731117248535
r_  generation:  0.5057103633880615
local_output_nid generation:  0.02949047088623047
local_in_edges_tensor generation:  0.03168845176696777
mini_batch_src_global generation:  0.06371903419494629
r_  generation:  0.5001511573791504
local_output_nid generation:  0.02991032600402832
local_in_edges_tensor generation:  0.03073859214782715
mini_batch_src_global generation:  0.0608975887298584
r_  generation:  0.5066888332366943
local_output_nid generation:  0.029876232147216797
local_in_edges_tensor generation:  0.031792402267456055
mini_batch_src_global generation:  0.059870004653930664
r_  generation:  0.4931366443634033
local_output_nid generation:  0.029686927795410156
local_in_edges_tensor generation:  0.028882741928100586
mini_batch_src_global generation:  0.0584559440612793
r_  generation:  0.5023519992828369
local_output_nid generation:  0.029639244079589844
local_in_edges_tensor generation:  0.03448176383972168
mini_batch_src_global generation:  0.06002402305603027
r_  generation:  0.5006768703460693
local_output_nid generation:  0.029596567153930664
local_in_edges_tensor generation:  0.0310213565826416
mini_batch_src_global generation:  0.05923318862915039
r_  generation:  0.5028643608093262
local_output_nid generation:  0.02972865104675293
local_in_edges_tensor generation:  0.029484272003173828
mini_batch_src_global generation:  0.05974721908569336
r_  generation:  0.4955101013183594
local_output_nid generation:  0.029736995697021484
local_in_edges_tensor generation:  0.037381649017333984
mini_batch_src_global generation:  0.06093645095825195
r_  generation:  0.5267956256866455
local_output_nid generation:  0.03295755386352539
local_in_edges_tensor generation:  0.03563833236694336
mini_batch_src_global generation:  0.06232166290283203
r_  generation:  0.5042819976806641
local_output_nid generation:  0.030321359634399414
local_in_edges_tensor generation:  0.03472757339477539
mini_batch_src_global generation:  0.05857586860656738
r_  generation:  0.49843645095825195
local_output_nid generation:  0.0307159423828125
local_in_edges_tensor generation:  0.02923727035522461
mini_batch_src_global generation:  0.05994367599487305
r_  generation:  0.4972853660583496
local_output_nid generation:  0.030562162399291992
local_in_edges_tensor generation:  0.032642364501953125
mini_batch_src_global generation:  0.0578761100769043
r_  generation:  0.5011663436889648
local_output_nid generation:  0.030426025390625
local_in_edges_tensor generation:  0.02992868423461914
mini_batch_src_global generation:  0.05912017822265625
r_  generation:  0.490337610244751
local_output_nid generation:  0.030094146728515625
local_in_edges_tensor generation:  0.030658483505249023
mini_batch_src_global generation:  0.059859275817871094
r_  generation:  0.501079797744751
local_output_nid generation:  0.030588150024414062
local_in_edges_tensor generation:  0.030892133712768555
mini_batch_src_global generation:  0.05962347984313965
r_  generation:  0.5031700134277344
local_output_nid generation:  0.04191017150878906
local_in_edges_tensor generation:  0.029432058334350586
mini_batch_src_global generation:  0.0585017204284668
r_  generation:  0.5024256706237793
local_output_nid generation:  0.03085947036743164
local_in_edges_tensor generation:  0.03141975402832031
mini_batch_src_global generation:  0.06518411636352539
r_  generation:  0.5029141902923584
local_output_nid generation:  0.030335426330566406
local_in_edges_tensor generation:  0.02932572364807129
mini_batch_src_global generation:  0.05812549591064453
r_  generation:  0.5024240016937256
local_output_nid generation:  0.030501842498779297
local_in_edges_tensor generation:  0.02881765365600586
mini_batch_src_global generation:  0.06186556816101074
r_  generation:  0.5007786750793457
local_output_nid generation:  0.030671358108520508
local_in_edges_tensor generation:  0.03238344192504883
mini_batch_src_global generation:  0.05842757225036621
r_  generation:  0.506739616394043
local_output_nid generation:  0.03052067756652832
local_in_edges_tensor generation:  0.0312957763671875
mini_batch_src_global generation:  0.06011509895324707
r_  generation:  0.49974560737609863
local_output_nid generation:  0.03060317039489746
local_in_edges_tensor generation:  0.03596949577331543
mini_batch_src_global generation:  0.05903434753417969
r_  generation:  0.5117506980895996
local_output_nid generation:  0.030605792999267578
local_in_edges_tensor generation:  0.03311729431152344
mini_batch_src_global generation:  0.06065177917480469
r_  generation:  0.5015313625335693
----------------------check_connections_block total spend ----------------------------- 23.509661197662354
generate_one_block  0.7055807113647461
generate_one_block  0.688270092010498
generate_one_block  0.6866717338562012
generate_one_block  0.6869926452636719
generate_one_block  0.7851543426513672
generate_one_block  0.6807348728179932
generate_one_block  0.6753475666046143
generate_one_block  0.6924233436584473
generate_one_block  0.6783747673034668
generate_one_block  0.6819376945495605
generate_one_block  0.6839399337768555
generate_one_block  0.671628475189209
generate_one_block  0.6793527603149414
generate_one_block  0.6850390434265137
generate_one_block  0.6754522323608398
generate_one_block  0.6771373748779297
generate_one_block  0.6803512573242188
generate_one_block  0.682081937789917
generate_one_block  0.6790549755096436
generate_one_block  0.6816794872283936
generate_one_block  0.6836628913879395
generate_one_block  0.6718485355377197
generate_one_block  0.6815581321716309
generate_one_block  0.6956958770751953
generate_one_block  0.6929702758789062
generate_one_block  0.6877415180206299
generate_one_block  0.6740872859954834
generate_one_block  0.6767396926879883
generate_one_block  0.6912269592285156
generate_one_block  0.6892285346984863
generate_one_block  0.6879804134368896
generate_one_block  0.6765885353088379
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.1310410499572754  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

connection checking time:  32.18988227844238
block generation total time  29.98172640800476
average batch blocks generation time:  0.9369289502501488
block dataloader generation time/epoch 66.43673459688823
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10957622528076172  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 21.092703819274902  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10937833786010742  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.808846950531006  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10944652557373047  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 21.152284622192383  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10929632186889648  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.786790370941162  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10886716842651367  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.38416051864624  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.1090846061706543  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.805500030517578  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10912656784057617  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 20.387653350830078  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2655029296875 GB
    Memory Allocated: 0.10899972915649414  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3397216796875 GB
    Memory Allocated: 20.975114822387695  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10903263092041016  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.682555675506592  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10903596878051758  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.847277641296387  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10962343215942383  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.945332527160645  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10904502868652344  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.36911916732788  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10939931869506836  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.89700937271118  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10931634902954102  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.922589778900146  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10903644561767578  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.68904209136963  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10900449752807617  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.456161499023438  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10934925079345703  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.885272979736328  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10918712615966797  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.67981195449829  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10886716842651367  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.79130983352661  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10919904708862305  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.93660259246826  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10929155349731445  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.805540084838867  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10912275314331055  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.330049991607666  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10910701751708984  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.7325701713562  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10964059829711914  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 21.15244150161743  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10885477066040039  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.192358016967773  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 0.10954761505126953  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.33627462387085  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10890865325927734  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.429402351379395  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10921621322631836  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.84464693069458  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1092681884765625  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.828680992126465  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10895156860351562  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.705909252166748  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10934305191040039  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.8645076751709  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10911130905151367  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.54451608657837  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028163939714431763 |0.024058006703853607 |0.6303358674049377 |9.713321924209595e-05 |1.1944331899285316 |0.009073257446289062 |
----------------------------------------------------------pseudo_mini_loss sum 1.6018645763397217
Total (block generation + training)time/epoch 126.50792129834493
Training time/epoch 60.13943958282471
Training time without block to device /epoch 59.36958336830139
Training time without total dataloading part /epoch 58.40479135513306
load block tensor time/epoch 0.9012460708618164
block to device time/epoch 0.7698562145233154
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  9157325
Number of first layer input nodes during this epoch:  4807016
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.13086271286010742  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02423381805419922
range selection method range initialization spend 0.01691579818725586
time for parepare:  0.0208740234375
local_output_nid generation:  0.0009577274322509766
local_in_edges_tensor generation:  0.0044972896575927734
mini_batch_src_global generation:  0.0020678043365478516
r_  generation:  0.012027502059936523
local_output_nid generation:  0.000989675521850586
local_in_edges_tensor generation:  0.0007386207580566406
mini_batch_src_global generation:  0.0016093254089355469
r_  generation:  0.010883808135986328
local_output_nid generation:  0.0009531974792480469
local_in_edges_tensor generation:  0.0006227493286132812
mini_batch_src_global generation:  0.001138448715209961
r_  generation:  0.010096311569213867
local_output_nid generation:  0.00091552734375
local_in_edges_tensor generation:  0.0006008148193359375
mini_batch_src_global generation:  0.0011909008026123047
r_  generation:  0.010201692581176758
local_output_nid generation:  0.0008921623229980469
local_in_edges_tensor generation:  0.0005929470062255859
mini_batch_src_global generation:  0.0010886192321777344
r_  generation:  0.009950399398803711
local_output_nid generation:  0.0008895397186279297
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.009844303131103516
local_output_nid generation:  0.0008995532989501953
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.010401725769042969
local_output_nid generation:  0.0009186267852783203
local_in_edges_tensor generation:  0.0005955696105957031
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.010595560073852539
local_output_nid generation:  0.0009016990661621094
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0011267662048339844
r_  generation:  0.010332584381103516
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0005774497985839844
mini_batch_src_global generation:  0.0011169910430908203
r_  generation:  0.010422229766845703
local_output_nid generation:  0.0008761882781982422
local_in_edges_tensor generation:  0.0005750656127929688
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.010478496551513672
local_output_nid generation:  0.0008754730224609375
local_in_edges_tensor generation:  0.0005862712860107422
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.010356664657592773
local_output_nid generation:  0.0008637905120849609
local_in_edges_tensor generation:  0.0005948543548583984
mini_batch_src_global generation:  0.0012667179107666016
r_  generation:  0.010645389556884766
local_output_nid generation:  0.0008931159973144531
local_in_edges_tensor generation:  0.0005872249603271484
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.010401248931884766
local_output_nid generation:  0.0008685588836669922
local_in_edges_tensor generation:  0.0006401538848876953
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.010748147964477539
local_output_nid generation:  0.000881195068359375
local_in_edges_tensor generation:  0.0005996227264404297
mini_batch_src_global generation:  0.0012807846069335938
r_  generation:  0.011030435562133789
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0005898475646972656
mini_batch_src_global generation:  0.0011420249938964844
r_  generation:  0.010421037673950195
local_output_nid generation:  0.0008831024169921875
local_in_edges_tensor generation:  0.0005657672882080078
mini_batch_src_global generation:  0.0011315345764160156
r_  generation:  0.010036706924438477
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.0011415481567382812
r_  generation:  0.010669231414794922
local_output_nid generation:  0.0008485317230224609
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0011959075927734375
r_  generation:  0.010231256484985352
local_output_nid generation:  0.0008614063262939453
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0011606216430664062
r_  generation:  0.00993967056274414
local_output_nid generation:  0.0008556842803955078
local_in_edges_tensor generation:  0.0006008148193359375
mini_batch_src_global generation:  0.0012464523315429688
r_  generation:  0.010682344436645508
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.0005822181701660156
mini_batch_src_global generation:  0.0011734962463378906
r_  generation:  0.010170459747314453
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0005900859832763672
mini_batch_src_global generation:  0.0012276172637939453
r_  generation:  0.010690927505493164
local_output_nid generation:  0.0008563995361328125
local_in_edges_tensor generation:  0.0005791187286376953
mini_batch_src_global generation:  0.001186370849609375
r_  generation:  0.01063990592956543
local_output_nid generation:  0.0008604526519775391
local_in_edges_tensor generation:  0.0005934238433837891
mini_batch_src_global generation:  0.001222372055053711
r_  generation:  0.010692119598388672
local_output_nid generation:  0.0008535385131835938
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.001169443130493164
r_  generation:  0.010291099548339844
local_output_nid generation:  0.0009052753448486328
local_in_edges_tensor generation:  0.0006225109100341797
mini_batch_src_global generation:  0.001154184341430664
r_  generation:  0.01014399528503418
local_output_nid generation:  0.0008807182312011719
local_in_edges_tensor generation:  0.0005931854248046875
mini_batch_src_global generation:  0.0011985301971435547
r_  generation:  0.010840415954589844
local_output_nid generation:  0.0008993148803710938
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.0012497901916503906
r_  generation:  0.010626554489135742
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0005884170532226562
mini_batch_src_global generation:  0.0012488365173339844
r_  generation:  0.010764837265014648
local_output_nid generation:  0.0008552074432373047
local_in_edges_tensor generation:  0.0005719661712646484
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.009899616241455078
----------------------check_connections_block total spend ----------------------------- 0.5286617279052734
generate_one_block  0.021796226501464844
generate_one_block  0.02132582664489746
generate_one_block  0.019929170608520508
generate_one_block  0.019608736038208008
generate_one_block  0.019089698791503906
generate_one_block  0.018557071685791016
generate_one_block  0.019359588623046875
generate_one_block  0.019599437713623047
generate_one_block  0.019106626510620117
generate_one_block  0.019298553466796875
generate_one_block  0.01914834976196289
generate_one_block  0.019158601760864258
generate_one_block  0.019507646560668945
generate_one_block  0.019054412841796875
generate_one_block  0.019412994384765625
generate_one_block  0.02003002166748047
generate_one_block  0.01864457130432129
generate_one_block  0.018199920654296875
generate_one_block  0.019402503967285156
generate_one_block  0.018755435943603516
generate_one_block  0.01804065704345703
generate_one_block  0.019620180130004883
generate_one_block  0.020811080932617188
generate_one_block  0.01992177963256836
generate_one_block  0.019286632537841797
generate_one_block  0.01959514617919922
generate_one_block  0.018708229064941406
generate_one_block  0.018514394760131836
generate_one_block  0.019680023193359375
generate_one_block  0.01928997039794922
generate_one_block  0.019342899322509766
generate_one_block  0.017980575561523438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04018115997314453
gen group dst list time:  0.025980234146118164
time for parepare:  0.022308349609375
local_output_nid generation:  0.00566554069519043
local_in_edges_tensor generation:  0.017205238342285156
mini_batch_src_global generation:  0.022863388061523438
r_  generation:  0.1612868309020996
local_output_nid generation:  0.007878780364990234
local_in_edges_tensor generation:  0.010775089263916016
mini_batch_src_global generation:  0.02178478240966797
r_  generation:  0.2066354751586914
local_output_nid generation:  0.008198738098144531
local_in_edges_tensor generation:  0.0332643985748291
mini_batch_src_global generation:  0.020910263061523438
r_  generation:  0.1739647388458252
local_output_nid generation:  0.008479595184326172
local_in_edges_tensor generation:  0.010142087936401367
mini_batch_src_global generation:  0.022013425827026367
r_  generation:  0.1787106990814209
local_output_nid generation:  0.008824825286865234
local_in_edges_tensor generation:  0.008401632308959961
mini_batch_src_global generation:  0.03338122367858887
r_  generation:  0.20213627815246582
local_output_nid generation:  0.009896039962768555
local_in_edges_tensor generation:  0.011048078536987305
mini_batch_src_global generation:  0.022990703582763672
r_  generation:  0.16991925239562988
local_output_nid generation:  0.009337186813354492
local_in_edges_tensor generation:  0.009048223495483398
mini_batch_src_global generation:  0.026700496673583984
r_  generation:  0.18281078338623047
local_output_nid generation:  0.009139537811279297
local_in_edges_tensor generation:  0.009777069091796875
mini_batch_src_global generation:  0.02283477783203125
r_  generation:  0.18114876747131348
local_output_nid generation:  0.00872802734375
local_in_edges_tensor generation:  0.008634090423583984
mini_batch_src_global generation:  0.02309870719909668
r_  generation:  0.18109512329101562
local_output_nid generation:  0.009120702743530273
local_in_edges_tensor generation:  0.008954763412475586
mini_batch_src_global generation:  0.024348735809326172
r_  generation:  0.18190717697143555
local_output_nid generation:  0.009045839309692383
local_in_edges_tensor generation:  0.008697509765625
mini_batch_src_global generation:  0.023184776306152344
r_  generation:  0.18182015419006348
local_output_nid generation:  0.009292840957641602
local_in_edges_tensor generation:  0.008608102798461914
mini_batch_src_global generation:  0.023020505905151367
r_  generation:  0.18080425262451172
local_output_nid generation:  0.009376049041748047
local_in_edges_tensor generation:  0.011168479919433594
mini_batch_src_global generation:  0.0232999324798584
r_  generation:  0.18964052200317383
local_output_nid generation:  0.009321928024291992
local_in_edges_tensor generation:  0.008865594863891602
mini_batch_src_global generation:  0.02498912811279297
r_  generation:  0.1847984790802002
local_output_nid generation:  0.009392023086547852
local_in_edges_tensor generation:  0.008941411972045898
mini_batch_src_global generation:  0.024344921112060547
r_  generation:  0.1896190643310547
local_output_nid generation:  0.009730815887451172
local_in_edges_tensor generation:  0.010768890380859375
mini_batch_src_global generation:  0.027142047882080078
r_  generation:  0.19175457954406738
local_output_nid generation:  0.009122371673583984
local_in_edges_tensor generation:  0.008571624755859375
mini_batch_src_global generation:  0.022787809371948242
r_  generation:  0.17860794067382812
local_output_nid generation:  0.00899505615234375
local_in_edges_tensor generation:  0.008469820022583008
mini_batch_src_global generation:  0.02252936363220215
r_  generation:  0.22280216217041016
local_output_nid generation:  0.010012626647949219
local_in_edges_tensor generation:  0.008803367614746094
mini_batch_src_global generation:  0.024092912673950195
r_  generation:  0.18553519248962402
local_output_nid generation:  0.0091552734375
local_in_edges_tensor generation:  0.00919651985168457
mini_batch_src_global generation:  0.02317357063293457
r_  generation:  0.17990446090698242
local_output_nid generation:  0.008891820907592773
local_in_edges_tensor generation:  0.008392095565795898
mini_batch_src_global generation:  0.022032499313354492
r_  generation:  0.17423200607299805
local_output_nid generation:  0.01108407974243164
local_in_edges_tensor generation:  0.008902788162231445
mini_batch_src_global generation:  0.023967981338500977
r_  generation:  0.19173789024353027
local_output_nid generation:  0.00909423828125
local_in_edges_tensor generation:  0.00843191146850586
mini_batch_src_global generation:  0.02247762680053711
r_  generation:  0.22586798667907715
local_output_nid generation:  0.009373188018798828
local_in_edges_tensor generation:  0.009284019470214844
mini_batch_src_global generation:  0.025017261505126953
r_  generation:  0.1903836727142334
local_output_nid generation:  0.010222911834716797
local_in_edges_tensor generation:  0.015935659408569336
mini_batch_src_global generation:  0.02325129508972168
r_  generation:  0.18578124046325684
local_output_nid generation:  0.00968313217163086
local_in_edges_tensor generation:  0.009733438491821289
mini_batch_src_global generation:  0.02385425567626953
r_  generation:  0.1872081756591797
local_output_nid generation:  0.00921630859375
local_in_edges_tensor generation:  0.008583784103393555
mini_batch_src_global generation:  0.022564172744750977
r_  generation:  0.1812727451324463
local_output_nid generation:  0.009154796600341797
local_in_edges_tensor generation:  0.009293556213378906
mini_batch_src_global generation:  0.024091243743896484
r_  generation:  0.18051648139953613
local_output_nid generation:  0.009651422500610352
local_in_edges_tensor generation:  0.010395288467407227
mini_batch_src_global generation:  0.02362656593322754
r_  generation:  0.18925094604492188
local_output_nid generation:  0.009368658065795898
local_in_edges_tensor generation:  0.009602546691894531
mini_batch_src_global generation:  0.02360391616821289
r_  generation:  0.18430209159851074
local_output_nid generation:  0.00936126708984375
local_in_edges_tensor generation:  0.008901834487915039
mini_batch_src_global generation:  0.023172855377197266
r_  generation:  0.19322848320007324
local_output_nid generation:  0.009079217910766602
local_in_edges_tensor generation:  0.009490489959716797
mini_batch_src_global generation:  0.025069475173950195
r_  generation:  0.18020248413085938
----------------------check_connections_block total spend ----------------------------- 8.719552755355835
generate_one_block  0.26215505599975586
generate_one_block  0.2495272159576416
generate_one_block  0.2528717517852783
generate_one_block  0.2602555751800537
generate_one_block  0.26542043685913086
generate_one_block  0.2361743450164795
generate_one_block  0.25008249282836914
generate_one_block  0.25142621994018555
generate_one_block  0.24793124198913574
generate_one_block  0.25003600120544434
generate_one_block  0.2464449405670166
generate_one_block  0.24968528747558594
generate_one_block  0.25890278816223145
generate_one_block  0.26752471923828125
generate_one_block  0.2561793327331543
generate_one_block  0.2682523727416992
generate_one_block  0.2455427646636963
generate_one_block  0.24550485610961914
generate_one_block  0.25495266914367676
generate_one_block  0.2543458938598633
generate_one_block  0.23817157745361328
generate_one_block  0.2601187229156494
generate_one_block  0.24618029594421387
generate_one_block  0.25923585891723633
generate_one_block  0.2526435852050781
generate_one_block  0.25450849533081055
generate_one_block  0.24169683456420898
generate_one_block  0.24424290657043457
generate_one_block  0.25724244117736816
generate_one_block  0.2514231204986572
generate_one_block  0.25198864936828613
generate_one_block  0.23712658882141113
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03893256187438965
gen group dst list time:  0.11665058135986328
time for parepare:  0.019375324249267578
local_output_nid generation:  0.026058673858642578
local_in_edges_tensor generation:  0.04901766777038574
mini_batch_src_global generation:  0.047742605209350586
r_  generation:  0.4875373840332031
local_output_nid generation:  0.030608415603637695
local_in_edges_tensor generation:  0.039086341857910156
mini_batch_src_global generation:  0.058771371841430664
r_  generation:  0.5093626976013184
local_output_nid generation:  0.03497314453125
local_in_edges_tensor generation:  0.0354156494140625
mini_batch_src_global generation:  0.06471633911132812
r_  generation:  0.4961977005004883
local_output_nid generation:  0.0318446159362793
local_in_edges_tensor generation:  0.03060007095336914
mini_batch_src_global generation:  0.05855059623718262
r_  generation:  0.49021053314208984
local_output_nid generation:  0.03194451332092285
local_in_edges_tensor generation:  0.030336618423461914
mini_batch_src_global generation:  0.05859375
r_  generation:  0.5002405643463135
local_output_nid generation:  0.032089948654174805
local_in_edges_tensor generation:  0.030974149703979492
mini_batch_src_global generation:  0.05927157402038574
r_  generation:  0.5035076141357422
local_output_nid generation:  0.03053903579711914
local_in_edges_tensor generation:  0.034400224685668945
mini_batch_src_global generation:  0.05879664421081543
r_  generation:  0.5030455589294434
local_output_nid generation:  0.03025031089782715
local_in_edges_tensor generation:  0.03312087059020996
mini_batch_src_global generation:  0.05911087989807129
r_  generation:  0.4947662353515625
local_output_nid generation:  0.03023672103881836
local_in_edges_tensor generation:  0.03040480613708496
mini_batch_src_global generation:  0.05859494209289551
r_  generation:  0.4990274906158447
local_output_nid generation:  0.03055572509765625
local_in_edges_tensor generation:  0.029018163681030273
mini_batch_src_global generation:  0.06014442443847656
r_  generation:  0.5019927024841309
local_output_nid generation:  0.03062915802001953
local_in_edges_tensor generation:  0.02974677085876465
mini_batch_src_global generation:  0.05817723274230957
r_  generation:  0.5093512535095215
local_output_nid generation:  0.030599117279052734
local_in_edges_tensor generation:  0.035770416259765625
mini_batch_src_global generation:  0.05985665321350098
r_  generation:  0.49640989303588867
local_output_nid generation:  0.030933141708374023
local_in_edges_tensor generation:  0.029082536697387695
mini_batch_src_global generation:  0.05836915969848633
r_  generation:  0.4998495578765869
local_output_nid generation:  0.030557632446289062
local_in_edges_tensor generation:  0.03155994415283203
mini_batch_src_global generation:  0.05985736846923828
r_  generation:  0.49449777603149414
local_output_nid generation:  0.030714035034179688
local_in_edges_tensor generation:  0.031362295150756836
mini_batch_src_global generation:  0.05892205238342285
r_  generation:  0.5023269653320312
local_output_nid generation:  0.030953645706176758
local_in_edges_tensor generation:  0.031101703643798828
mini_batch_src_global generation:  0.06260132789611816
r_  generation:  0.5016803741455078
local_output_nid generation:  0.03055095672607422
local_in_edges_tensor generation:  0.029448270797729492
mini_batch_src_global generation:  0.05834484100341797
r_  generation:  0.4988212585449219
local_output_nid generation:  0.03034830093383789
local_in_edges_tensor generation:  0.0354151725769043
mini_batch_src_global generation:  0.06401944160461426
r_  generation:  0.4934675693511963
local_output_nid generation:  0.03095698356628418
local_in_edges_tensor generation:  0.03531026840209961
mini_batch_src_global generation:  0.06099128723144531
r_  generation:  0.5020406246185303
local_output_nid generation:  0.03042125701904297
local_in_edges_tensor generation:  0.03255510330200195
mini_batch_src_global generation:  0.05895519256591797
r_  generation:  0.4964778423309326
local_output_nid generation:  0.030380725860595703
local_in_edges_tensor generation:  0.03107738494873047
mini_batch_src_global generation:  0.05800342559814453
r_  generation:  0.5077128410339355
local_output_nid generation:  0.034184932708740234
local_in_edges_tensor generation:  0.028632402420043945
mini_batch_src_global generation:  0.07197093963623047
r_  generation:  0.500476598739624
local_output_nid generation:  0.03039407730102539
local_in_edges_tensor generation:  0.03265690803527832
mini_batch_src_global generation:  0.05900168418884277
r_  generation:  0.4995596408843994
local_output_nid generation:  0.030533552169799805
local_in_edges_tensor generation:  0.029303550720214844
mini_batch_src_global generation:  0.06033682823181152
r_  generation:  0.5000791549682617
local_output_nid generation:  0.03081035614013672
local_in_edges_tensor generation:  0.030590534210205078
mini_batch_src_global generation:  0.058550119400024414
r_  generation:  0.5030348300933838
local_output_nid generation:  0.03113579750061035
local_in_edges_tensor generation:  0.03103184700012207
mini_batch_src_global generation:  0.060228586196899414
r_  generation:  0.5026683807373047
local_output_nid generation:  0.030605554580688477
local_in_edges_tensor generation:  0.03514552116394043
mini_batch_src_global generation:  0.05891752243041992
r_  generation:  0.5000958442687988
local_output_nid generation:  0.03045058250427246
local_in_edges_tensor generation:  0.0396723747253418
mini_batch_src_global generation:  0.059911251068115234
r_  generation:  0.5017218589782715
local_output_nid generation:  0.03065800666809082
local_in_edges_tensor generation:  0.03076028823852539
mini_batch_src_global generation:  0.06140303611755371
r_  generation:  0.5072042942047119
local_output_nid generation:  0.031037330627441406
local_in_edges_tensor generation:  0.03258991241455078
mini_batch_src_global generation:  0.05986475944519043
r_  generation:  0.5005953311920166
local_output_nid generation:  0.030609607696533203
local_in_edges_tensor generation:  0.030631065368652344
mini_batch_src_global generation:  0.05831599235534668
r_  generation:  0.5088956356048584
local_output_nid generation:  0.030609846115112305
local_in_edges_tensor generation:  0.03191781044006348
mini_batch_src_global generation:  0.06016874313354492
r_  generation:  0.49849581718444824
----------------------check_connections_block total spend ----------------------------- 23.46323275566101
generate_one_block  0.6917781829833984
generate_one_block  0.6715140342712402
generate_one_block  0.6826279163360596
generate_one_block  0.6747837066650391
generate_one_block  0.7870287895202637
generate_one_block  0.6707358360290527
generate_one_block  0.6843991279602051
generate_one_block  0.6829936504364014
generate_one_block  0.6739981174468994
generate_one_block  0.6810545921325684
generate_one_block  0.6865503787994385
generate_one_block  0.6789650917053223
generate_one_block  0.6799612045288086
generate_one_block  0.6873211860656738
generate_one_block  0.675034761428833
generate_one_block  0.688382625579834
generate_one_block  0.6729946136474609
generate_one_block  0.6733932495117188
generate_one_block  0.6889252662658691
generate_one_block  0.672698974609375
generate_one_block  0.6694447994232178
generate_one_block  0.6879396438598633
generate_one_block  0.6889164447784424
generate_one_block  0.6838328838348389
generate_one_block  0.6923997402191162
generate_one_block  0.6897056102752686
generate_one_block  0.6706843376159668
generate_one_block  0.6769640445709229
generate_one_block  0.692122220993042
generate_one_block  0.6801693439483643
generate_one_block  0.6759462356567383
generate_one_block  0.6769185066223145
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.13086271286010742  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

connection checking time:  32.182785511016846
block generation total time  29.957980155944824
average batch blocks generation time:  0.9361868798732758
block dataloader generation time/epoch 66.27509689331055
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10886430740356445  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.47262477874756  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10873222351074219  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.583521842956543  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10927772521972656  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.785725593566895  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10929012298583984  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.98969602584839  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10904455184936523  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.630884647369385  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1090693473815918  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.246797561645508  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10921287536621094  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.88344383239746  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10911226272583008  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.928260326385498  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1089925765991211  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.751551628112793  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10932683944702148  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.892545223236084  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10918140411376953  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.768925666809082  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10931682586669922  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.802899837493896  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10928106307983398  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.020087242126465  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1092982292175293  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.87054681777954  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10947418212890625  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.027061939239502  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10989570617675781  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.41967487335205  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1090235710144043  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.46458339691162  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10893821716308594  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.388097763061523  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1095418930053711  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.99308490753174  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10885190963745117  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.705234050750732  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1088409423828125  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.126450061798096  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10931396484375  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.109534740447998  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10896062850952148  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.4296932220459  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1092829704284668  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.997626304626465  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10914468765258789  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.67798948287964  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10956382751464844  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.041794776916504  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10887813568115234  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.510006427764893  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10901880264282227  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.650224208831787  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10946846008300781  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.15330982208252  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10965728759765625  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.902362823486328  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10931158065795898  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.87480640411377  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10890436172485352  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.17272663116455  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035334326326847076 |0.022292181849479675 |0.6280960291624069 |9.619444608688354e-05 |1.1912533640861511 |0.005280494689941406 |
----------------------------------------------------------pseudo_mini_loss sum 1.5665730237960815
Total (block generation + training)time/epoch 126.36128664016724
Training time/epoch 60.13091850280762
Training time without block to device /epoch 59.41756868362427
Training time without total dataloading part /epoch 58.22753930091858
load block tensor time/epoch 1.1306984424591064
block to device time/epoch 0.7133498191833496
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  9156113
Number of first layer input nodes during this epoch:  4806469
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1311492919921875  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025678157806396484
range selection method range initialization spend 0.016910314559936523
time for parepare:  0.01793074607849121
local_output_nid generation:  0.0009796619415283203
local_in_edges_tensor generation:  0.007705211639404297
mini_batch_src_global generation:  0.0020101070404052734
r_  generation:  0.012029647827148438
local_output_nid generation:  0.0010104179382324219
local_in_edges_tensor generation:  0.0006685256958007812
mini_batch_src_global generation:  0.0014081001281738281
r_  generation:  0.010668754577636719
local_output_nid generation:  0.0009582042694091797
local_in_edges_tensor generation:  0.0006167888641357422
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.010034322738647461
local_output_nid generation:  0.0009183883666992188
local_in_edges_tensor generation:  0.0006504058837890625
mini_batch_src_global generation:  0.0011737346649169922
r_  generation:  0.010134220123291016
local_output_nid generation:  0.0008814334869384766
local_in_edges_tensor generation:  0.0005929470062255859
mini_batch_src_global generation:  0.0010824203491210938
r_  generation:  0.009682416915893555
local_output_nid generation:  0.0008959770202636719
local_in_edges_tensor generation:  0.0005981922149658203
mini_batch_src_global generation:  0.0011043548583984375
r_  generation:  0.010171890258789062
local_output_nid generation:  0.0009019374847412109
local_in_edges_tensor generation:  0.0006079673767089844
mini_batch_src_global generation:  0.0012738704681396484
r_  generation:  0.010095596313476562
local_output_nid generation:  0.0009088516235351562
local_in_edges_tensor generation:  0.0005996227264404297
mini_batch_src_global generation:  0.0010848045349121094
r_  generation:  0.009927749633789062
local_output_nid generation:  0.0009233951568603516
local_in_edges_tensor generation:  0.0006120204925537109
mini_batch_src_global generation:  0.0011072158813476562
r_  generation:  0.010004281997680664
local_output_nid generation:  0.0008995532989501953
local_in_edges_tensor generation:  0.0005905628204345703
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.010424137115478516
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.0006101131439208984
mini_batch_src_global generation:  0.0010700225830078125
r_  generation:  0.009718656539916992
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0005791187286376953
mini_batch_src_global generation:  0.0010898113250732422
r_  generation:  0.009940147399902344
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0005927085876464844
mini_batch_src_global generation:  0.0010771751403808594
r_  generation:  0.010117530822753906
local_output_nid generation:  0.0008933544158935547
local_in_edges_tensor generation:  0.0006055831909179688
mini_batch_src_global generation:  0.001129150390625
r_  generation:  0.01034688949584961
local_output_nid generation:  0.0008909702301025391
local_in_edges_tensor generation:  0.0006234645843505859
mini_batch_src_global generation:  0.0012385845184326172
r_  generation:  0.010832071304321289
local_output_nid generation:  0.0008900165557861328
local_in_edges_tensor generation:  0.0005924701690673828
mini_batch_src_global generation:  0.0011603832244873047
r_  generation:  0.010384559631347656
local_output_nid generation:  0.0009081363677978516
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.010314702987670898
local_output_nid generation:  0.0008614063262939453
local_in_edges_tensor generation:  0.00060272216796875
mini_batch_src_global generation:  0.0011534690856933594
r_  generation:  0.010179281234741211
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.001094818115234375
r_  generation:  0.009600400924682617
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0005869865417480469
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.010251998901367188
local_output_nid generation:  0.0008592605590820312
local_in_edges_tensor generation:  0.0005843639373779297
mini_batch_src_global generation:  0.0011126995086669922
r_  generation:  0.009804487228393555
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0005834102630615234
mini_batch_src_global generation:  0.0010836124420166016
r_  generation:  0.010096549987792969
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0005898475646972656
mini_batch_src_global generation:  0.0011591911315917969
r_  generation:  0.010349273681640625
local_output_nid generation:  0.0008587837219238281
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0010988712310791016
r_  generation:  0.010246992111206055
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.001140594482421875
r_  generation:  0.010294675827026367
local_output_nid generation:  0.0008587837219238281
local_in_edges_tensor generation:  0.0005803108215332031
mini_batch_src_global generation:  0.001161336898803711
r_  generation:  0.010026931762695312
local_output_nid generation:  0.0008804798126220703
local_in_edges_tensor generation:  0.0005729198455810547
mini_batch_src_global generation:  0.001085042953491211
r_  generation:  0.010141372680664062
local_output_nid generation:  0.0008609294891357422
local_in_edges_tensor generation:  0.0006177425384521484
mini_batch_src_global generation:  0.0011463165283203125
r_  generation:  0.010561704635620117
local_output_nid generation:  0.0008649826049804688
local_in_edges_tensor generation:  0.0005939006805419922
mini_batch_src_global generation:  0.0011622905731201172
r_  generation:  0.010670185089111328
local_output_nid generation:  0.0008685588836669922
local_in_edges_tensor generation:  0.0005900859832763672
mini_batch_src_global generation:  0.0011849403381347656
r_  generation:  0.010316133499145508
local_output_nid generation:  0.0008785724639892578
local_in_edges_tensor generation:  0.0006060600280761719
mini_batch_src_global generation:  0.0012097358703613281
r_  generation:  0.010128259658813477
local_output_nid generation:  0.0008552074432373047
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.0011799335479736328
r_  generation:  0.010494709014892578
----------------------check_connections_block total spend ----------------------------- 0.5208611488342285
generate_one_block  0.02261519432067871
generate_one_block  0.0214080810546875
generate_one_block  0.01986384391784668
generate_one_block  0.019495725631713867
generate_one_block  0.018628597259521484
generate_one_block  0.019299983978271484
generate_one_block  0.01900935173034668
generate_one_block  0.018613100051879883
generate_one_block  0.01850152015686035
generate_one_block  0.019410371780395508
generate_one_block  0.01783013343811035
generate_one_block  0.018564939498901367
generate_one_block  0.01857304573059082
generate_one_block  0.01882767677307129
generate_one_block  0.01984119415283203
generate_one_block  0.019161701202392578
generate_one_block  0.018857479095458984
generate_one_block  0.018740415573120117
generate_one_block  0.01777338981628418
generate_one_block  0.018639087677001953
generate_one_block  0.018146991729736328
generate_one_block  0.018537044525146484
generate_one_block  0.021458148956298828
generate_one_block  0.018892288208007812
generate_one_block  0.01881885528564453
generate_one_block  0.018387794494628906
generate_one_block  0.01867532730102539
generate_one_block  0.01930689811706543
generate_one_block  0.019230127334594727
generate_one_block  0.018642663955688477
generate_one_block  0.01840949058532715
generate_one_block  0.01920628547668457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04079031944274902
gen group dst list time:  0.020176410675048828
time for parepare:  0.020087003707885742
local_output_nid generation:  0.005705595016479492
local_in_edges_tensor generation:  0.017978668212890625
mini_batch_src_global generation:  0.018009185791015625
r_  generation:  0.1677086353302002
local_output_nid generation:  0.007901906967163086
local_in_edges_tensor generation:  0.010589599609375
mini_batch_src_global generation:  0.022829771041870117
r_  generation:  0.17064905166625977
local_output_nid generation:  0.008208751678466797
local_in_edges_tensor generation:  0.03229403495788574
mini_batch_src_global generation:  0.022290706634521484
r_  generation:  0.17762994766235352
local_output_nid generation:  0.008572578430175781
local_in_edges_tensor generation:  0.011658668518066406
mini_batch_src_global generation:  0.02222585678100586
r_  generation:  0.17937994003295898
local_output_nid generation:  0.008626937866210938
local_in_edges_tensor generation:  0.011470317840576172
mini_batch_src_global generation:  0.022774696350097656
r_  generation:  0.1746079921722412
local_output_nid generation:  0.0088958740234375
local_in_edges_tensor generation:  0.010804891586303711
mini_batch_src_global generation:  0.02298736572265625
r_  generation:  0.18159127235412598
local_output_nid generation:  0.009026050567626953
local_in_edges_tensor generation:  0.008891105651855469
mini_batch_src_global generation:  0.023034334182739258
r_  generation:  0.18009281158447266
local_output_nid generation:  0.008653402328491211
local_in_edges_tensor generation:  0.008700370788574219
mini_batch_src_global generation:  0.02243828773498535
r_  generation:  0.179182767868042
local_output_nid generation:  0.008458852767944336
local_in_edges_tensor generation:  0.009569644927978516
mini_batch_src_global generation:  0.022733449935913086
r_  generation:  0.1799173355102539
local_output_nid generation:  0.009033918380737305
local_in_edges_tensor generation:  0.011548042297363281
mini_batch_src_global generation:  0.023395299911499023
r_  generation:  0.18703246116638184
local_output_nid generation:  0.008827924728393555
local_in_edges_tensor generation:  0.01131582260131836
mini_batch_src_global generation:  0.022701025009155273
r_  generation:  0.17245745658874512
local_output_nid generation:  0.009042978286743164
local_in_edges_tensor generation:  0.008897781372070312
mini_batch_src_global generation:  0.022273778915405273
r_  generation:  0.17845749855041504
local_output_nid generation:  0.009078264236450195
local_in_edges_tensor generation:  0.00893092155456543
mini_batch_src_global generation:  0.02244257926940918
r_  generation:  0.17979145050048828
local_output_nid generation:  0.009185075759887695
local_in_edges_tensor generation:  0.00894927978515625
mini_batch_src_global generation:  0.022690534591674805
r_  generation:  0.18269920349121094
local_output_nid generation:  0.009649515151977539
local_in_edges_tensor generation:  0.009424209594726562
mini_batch_src_global generation:  0.024914264678955078
r_  generation:  0.1905984878540039
local_output_nid generation:  0.009397029876708984
local_in_edges_tensor generation:  0.009174823760986328
mini_batch_src_global generation:  0.023746013641357422
r_  generation:  0.18508601188659668
local_output_nid generation:  0.009196281433105469
local_in_edges_tensor generation:  0.009810686111450195
mini_batch_src_global generation:  0.027078866958618164
r_  generation:  0.1887824535369873
local_output_nid generation:  0.009195327758789062
local_in_edges_tensor generation:  0.009334564208984375
mini_batch_src_global generation:  0.02346658706665039
r_  generation:  0.18455910682678223
local_output_nid generation:  0.008842229843139648
local_in_edges_tensor generation:  0.01084136962890625
mini_batch_src_global generation:  0.023590803146362305
r_  generation:  0.17514395713806152
local_output_nid generation:  0.009307622909545898
local_in_edges_tensor generation:  0.009206533432006836
mini_batch_src_global generation:  0.02270817756652832
r_  generation:  0.18090009689331055
local_output_nid generation:  0.009085655212402344
local_in_edges_tensor generation:  0.008952140808105469
mini_batch_src_global generation:  0.022348642349243164
r_  generation:  0.17632532119750977
local_output_nid generation:  0.009340047836303711
local_in_edges_tensor generation:  0.009503364562988281
mini_batch_src_global generation:  0.023189783096313477
r_  generation:  0.18214941024780273
local_output_nid generation:  0.009486198425292969
local_in_edges_tensor generation:  0.009169340133666992
mini_batch_src_global generation:  0.02360701560974121
r_  generation:  0.18564844131469727
local_output_nid generation:  0.009183883666992188
local_in_edges_tensor generation:  0.008837461471557617
mini_batch_src_global generation:  0.022783994674682617
r_  generation:  0.18069911003112793
local_output_nid generation:  0.009378910064697266
local_in_edges_tensor generation:  0.008724451065063477
mini_batch_src_global generation:  0.02301788330078125
r_  generation:  0.18281006813049316
local_output_nid generation:  0.00924539566040039
local_in_edges_tensor generation:  0.00999140739440918
mini_batch_src_global generation:  0.02245807647705078
r_  generation:  0.17763042449951172
local_output_nid generation:  0.009383201599121094
local_in_edges_tensor generation:  0.009190559387207031
mini_batch_src_global generation:  0.022898435592651367
r_  generation:  0.18289709091186523
local_output_nid generation:  0.009567975997924805
local_in_edges_tensor generation:  0.01048898696899414
mini_batch_src_global generation:  0.024359941482543945
r_  generation:  0.18681669235229492
local_output_nid generation:  0.009545564651489258
local_in_edges_tensor generation:  0.009168624877929688
mini_batch_src_global generation:  0.023413658142089844
r_  generation:  0.18510079383850098
local_output_nid generation:  0.009272336959838867
local_in_edges_tensor generation:  0.010312080383300781
mini_batch_src_global generation:  0.02275705337524414
r_  generation:  0.18120956420898438
local_output_nid generation:  0.009160995483398438
local_in_edges_tensor generation:  0.00938558578491211
mini_batch_src_global generation:  0.022625446319580078
r_  generation:  0.17941761016845703
local_output_nid generation:  0.009343147277832031
local_in_edges_tensor generation:  0.00895547866821289
mini_batch_src_global generation:  0.024034976959228516
r_  generation:  0.18595194816589355
----------------------check_connections_block total spend ----------------------------- 8.481685876846313
generate_one_block  0.24910235404968262
generate_one_block  0.24706387519836426
generate_one_block  0.2554948329925537
generate_one_block  0.25213074684143066
generate_one_block  0.2586536407470703
generate_one_block  0.24798321723937988
generate_one_block  0.24802470207214355
generate_one_block  0.24651384353637695
generate_one_block  0.24027156829833984
generate_one_block  0.25795674324035645
generate_one_block  0.23624205589294434
generate_one_block  0.2438797950744629
generate_one_block  0.24541926383972168
generate_one_block  0.24547052383422852
generate_one_block  0.2583620548248291
generate_one_block  0.25354909896850586
generate_one_block  0.2538149356842041
generate_one_block  0.25120997428894043
generate_one_block  0.24033164978027344
generate_one_block  0.24991822242736816
generate_one_block  0.23686432838439941
generate_one_block  0.24753975868225098
generate_one_block  0.25221800804138184
generate_one_block  0.24397778511047363
generate_one_block  0.24829864501953125
generate_one_block  0.24582481384277344
generate_one_block  0.2482762336730957
generate_one_block  0.25539398193359375
generate_one_block  0.24853277206420898
generate_one_block  0.24855470657348633
generate_one_block  0.24394965171813965
generate_one_block  0.253070592880249
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040130615234375
gen group dst list time:  0.10905003547668457
time for parepare:  0.018980979919433594
local_output_nid generation:  0.024156808853149414
local_in_edges_tensor generation:  0.049745798110961914
mini_batch_src_global generation:  0.046022891998291016
r_  generation:  0.4872128963470459
local_output_nid generation:  0.030750274658203125
local_in_edges_tensor generation:  0.03645825386047363
mini_batch_src_global generation:  0.05811882019042969
r_  generation:  0.4843108654022217
local_output_nid generation:  0.030679702758789062
local_in_edges_tensor generation:  0.030635595321655273
mini_batch_src_global generation:  0.05689406394958496
r_  generation:  0.49309587478637695
local_output_nid generation:  0.030724763870239258
local_in_edges_tensor generation:  0.030598163604736328
mini_batch_src_global generation:  0.05851936340332031
r_  generation:  0.4899106025695801
local_output_nid generation:  0.030833959579467773
local_in_edges_tensor generation:  0.0366215705871582
mini_batch_src_global generation:  0.06002998352050781
r_  generation:  0.494107723236084
local_output_nid generation:  0.031188488006591797
local_in_edges_tensor generation:  0.029349565505981445
mini_batch_src_global generation:  0.05980873107910156
r_  generation:  0.49304723739624023
local_output_nid generation:  0.029644489288330078
local_in_edges_tensor generation:  0.032758235931396484
mini_batch_src_global generation:  0.05841255187988281
r_  generation:  0.4947531223297119
local_output_nid generation:  0.029144763946533203
local_in_edges_tensor generation:  0.028663158416748047
mini_batch_src_global generation:  0.06064772605895996
r_  generation:  0.48975348472595215
local_output_nid generation:  0.02907729148864746
local_in_edges_tensor generation:  0.035108327865600586
mini_batch_src_global generation:  0.05840349197387695
r_  generation:  0.4929790496826172
local_output_nid generation:  0.02924036979675293
local_in_edges_tensor generation:  0.028654813766479492
mini_batch_src_global generation:  0.06000804901123047
r_  generation:  0.495833158493042
local_output_nid generation:  0.029122591018676758
local_in_edges_tensor generation:  0.03126239776611328
mini_batch_src_global generation:  0.058379173278808594
r_  generation:  0.4944431781768799
local_output_nid generation:  0.029383182525634766
local_in_edges_tensor generation:  0.029915571212768555
mini_batch_src_global generation:  0.061933279037475586
r_  generation:  0.49601316452026367
local_output_nid generation:  0.02917647361755371
local_in_edges_tensor generation:  0.028481721878051758
mini_batch_src_global generation:  0.058818817138671875
r_  generation:  0.49111413955688477
local_output_nid generation:  0.02953195571899414
local_in_edges_tensor generation:  0.02993464469909668
mini_batch_src_global generation:  0.06209754943847656
r_  generation:  0.49683046340942383
local_output_nid generation:  0.02982306480407715
local_in_edges_tensor generation:  0.037499427795410156
mini_batch_src_global generation:  0.058353424072265625
r_  generation:  0.5010659694671631
local_output_nid generation:  0.02955007553100586
local_in_edges_tensor generation:  0.030555009841918945
mini_batch_src_global generation:  0.06060028076171875
r_  generation:  0.49834370613098145
local_output_nid generation:  0.029376506805419922
local_in_edges_tensor generation:  0.031128406524658203
mini_batch_src_global generation:  0.05906534194946289
r_  generation:  0.49814867973327637
local_output_nid generation:  0.029973745346069336
local_in_edges_tensor generation:  0.03068685531616211
mini_batch_src_global generation:  0.059803009033203125
r_  generation:  0.49851369857788086
local_output_nid generation:  0.02927112579345703
local_in_edges_tensor generation:  0.030767440795898438
mini_batch_src_global generation:  0.05883145332336426
r_  generation:  0.4930393695831299
local_output_nid generation:  0.02938103675842285
local_in_edges_tensor generation:  0.029463529586791992
mini_batch_src_global generation:  0.0598907470703125
r_  generation:  0.4939894676208496
local_output_nid generation:  0.02945876121520996
local_in_edges_tensor generation:  0.03014993667602539
mini_batch_src_global generation:  0.05866694450378418
r_  generation:  0.49368977546691895
local_output_nid generation:  0.029371261596679688
local_in_edges_tensor generation:  0.030649900436401367
mini_batch_src_global generation:  0.059632062911987305
r_  generation:  0.49513673782348633
local_output_nid generation:  0.02934575080871582
local_in_edges_tensor generation:  0.031485795974731445
mini_batch_src_global generation:  0.05864262580871582
r_  generation:  0.5094823837280273
local_output_nid generation:  0.029280662536621094
local_in_edges_tensor generation:  0.030183792114257812
mini_batch_src_global generation:  0.06054568290710449
r_  generation:  0.4972264766693115
local_output_nid generation:  0.029485464096069336
local_in_edges_tensor generation:  0.028830528259277344
mini_batch_src_global generation:  0.05858659744262695
r_  generation:  0.5055134296417236
local_output_nid generation:  0.029409170150756836
local_in_edges_tensor generation:  0.03073740005493164
mini_batch_src_global generation:  0.059957265853881836
r_  generation:  0.49869704246520996
local_output_nid generation:  0.02969050407409668
local_in_edges_tensor generation:  0.030179500579833984
mini_batch_src_global generation:  0.06072282791137695
r_  generation:  0.5084652900695801
local_output_nid generation:  0.03032088279724121
local_in_edges_tensor generation:  0.0304715633392334
mini_batch_src_global generation:  0.060601234436035156
r_  generation:  0.5020647048950195
local_output_nid generation:  0.02995133399963379
local_in_edges_tensor generation:  0.030384302139282227
mini_batch_src_global generation:  0.05841565132141113
r_  generation:  0.5033473968505859
local_output_nid generation:  0.02990436553955078
local_in_edges_tensor generation:  0.03365063667297363
mini_batch_src_global generation:  0.06005740165710449
r_  generation:  0.4986839294433594
local_output_nid generation:  0.029575586318969727
local_in_edges_tensor generation:  0.028697490692138672
mini_batch_src_global generation:  0.05824708938598633
r_  generation:  0.4993765354156494
local_output_nid generation:  0.029752731323242188
local_in_edges_tensor generation:  0.0288848876953125
mini_batch_src_global generation:  0.0626983642578125
r_  generation:  0.5001039505004883
----------------------check_connections_block total spend ----------------------------- 23.229841232299805
generate_one_block  0.6712803840637207
generate_one_block  0.6788532733917236
generate_one_block  0.6745834350585938
generate_one_block  0.6788568496704102
generate_one_block  0.7702541351318359
generate_one_block  0.6769022941589355
generate_one_block  0.6742146015167236
generate_one_block  0.6685724258422852
generate_one_block  0.6709249019622803
generate_one_block  0.6769437789916992
generate_one_block  0.6700451374053955
generate_one_block  0.6821038722991943
generate_one_block  0.6688077449798584
generate_one_block  0.6832952499389648
generate_one_block  0.6840801239013672
generate_one_block  0.6866934299468994
generate_one_block  0.6709005832672119
generate_one_block  0.6791455745697021
generate_one_block  0.666750431060791
generate_one_block  0.6841223239898682
generate_one_block  0.6751151084899902
generate_one_block  0.6774783134460449
generate_one_block  0.6826694011688232
generate_one_block  0.66811203956604
generate_one_block  0.6951348781585693
generate_one_block  0.6685097217559814
generate_one_block  0.6823620796203613
generate_one_block  0.6862273216247559
generate_one_block  0.67539381980896
generate_one_block  0.6766974925994873
generate_one_block  0.6764013767242432
generate_one_block  0.6832585334777832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1311492919921875  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

connection checking time:  31.711527109146118
block generation total time  29.71858501434326
average batch blocks generation time:  0.9287057816982269
block dataloader generation time/epoch 66.04096307754517
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10939264297485352  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.979923725128174  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10908746719360352  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.820375442504883  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1092076301574707  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.074668884277344  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10958337783813477  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.133297443389893  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10904359817504883  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.54098415374756  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10952138900756836  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.926254749298096  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10921812057495117  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.824289798736572  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10903167724609375  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.82622194290161  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10883045196533203  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.495325565338135  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1092081069946289  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.13568878173828  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10873699188232422  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.174225330352783  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10932111740112305  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.65140390396118  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10884380340576172  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.58602476119995  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10938501358032227  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.7820987701416  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10959815979003906  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.29486846923828  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10945892333984375  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.973987102508545  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10918998718261719  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.057739734649658  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1092677116394043  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.96375799179077  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10894441604614258  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.36071252822876  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10912179946899414  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.673433303833008  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10915660858154297  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.34352159500122  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1091914176940918  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.749032497406006  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10941123962402344  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.89009666442871  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10867166519165039  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.493661880493164  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10936117172241211  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.7325758934021  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10910654067993164  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.442577362060547  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10944223403930664  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.765235900878906  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10956907272338867  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.131794929504395  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10948419570922852  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.83698844909668  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10921144485473633  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.763473987579346  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10897588729858398  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.51157283782959  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10945463180541992  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.96495246887207  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03074757754802704 |0.022363536059856415 |0.6281927898526192 |9.731203317642212e-05 |1.1908150911331177 |0.003928422927856445 |
----------------------------------------------------------pseudo_mini_loss sum 1.5254204273223877
Total (block generation + training)time/epoch 126.10480189323425
Training time/epoch 59.97414517402649
Training time without block to device /epoch 59.258512020111084
Training time without total dataloading part /epoch 58.21529459953308
load block tensor time/epoch 0.9839224815368652
block to device time/epoch 0.7156331539154053
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  9159139
Number of first layer input nodes during this epoch:  4807999
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.13144779205322266  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.043367862701416016
range selection method range initialization spend 0.014919281005859375
time for parepare:  0.02556467056274414
local_output_nid generation:  0.0012888908386230469
local_in_edges_tensor generation:  0.005066633224487305
mini_batch_src_global generation:  0.0019183158874511719
r_  generation:  0.010486841201782227
local_output_nid generation:  0.0010521411895751953
local_in_edges_tensor generation:  0.0007309913635253906
mini_batch_src_global generation:  0.0020208358764648438
r_  generation:  0.01178288459777832
local_output_nid generation:  0.0010585784912109375
local_in_edges_tensor generation:  0.0007824897766113281
mini_batch_src_global generation:  0.0013976097106933594
r_  generation:  0.010234594345092773
local_output_nid generation:  0.0010499954223632812
local_in_edges_tensor generation:  0.0007181167602539062
mini_batch_src_global generation:  0.0013611316680908203
r_  generation:  0.00993490219116211
local_output_nid generation:  0.0010416507720947266
local_in_edges_tensor generation:  0.0007255077362060547
mini_batch_src_global generation:  0.001348257064819336
r_  generation:  0.014893054962158203
local_output_nid generation:  0.002335786819458008
local_in_edges_tensor generation:  0.0013813972473144531
mini_batch_src_global generation:  0.0026841163635253906
r_  generation:  0.014177560806274414
local_output_nid generation:  0.0011491775512695312
local_in_edges_tensor generation:  0.0006642341613769531
mini_batch_src_global generation:  0.001386880874633789
r_  generation:  0.012535572052001953
local_output_nid generation:  0.0010380744934082031
local_in_edges_tensor generation:  0.000675201416015625
mini_batch_src_global generation:  0.0013210773468017578
r_  generation:  0.010666370391845703
local_output_nid generation:  0.0009627342224121094
local_in_edges_tensor generation:  0.0006320476531982422
mini_batch_src_global generation:  0.0011947154998779297
r_  generation:  0.010302066802978516
local_output_nid generation:  0.0009489059448242188
local_in_edges_tensor generation:  0.000701904296875
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.010155677795410156
local_output_nid generation:  0.0009238719940185547
local_in_edges_tensor generation:  0.0006356239318847656
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.010336637496948242
local_output_nid generation:  0.0009534358978271484
local_in_edges_tensor generation:  0.0006117820739746094
mini_batch_src_global generation:  0.001146078109741211
r_  generation:  0.01059579849243164
local_output_nid generation:  0.0008950233459472656
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0011472702026367188
r_  generation:  0.010467052459716797
local_output_nid generation:  0.0009071826934814453
local_in_edges_tensor generation:  0.0006372928619384766
mini_batch_src_global generation:  0.0011985301971435547
r_  generation:  0.012479305267333984
local_output_nid generation:  0.0009179115295410156
local_in_edges_tensor generation:  0.0006241798400878906
mini_batch_src_global generation:  0.0012056827545166016
r_  generation:  0.010590076446533203
local_output_nid generation:  0.0009188652038574219
local_in_edges_tensor generation:  0.0006780624389648438
mini_batch_src_global generation:  0.0011878013610839844
r_  generation:  0.010411500930786133
local_output_nid generation:  0.0009176731109619141
local_in_edges_tensor generation:  0.0006997585296630859
mini_batch_src_global generation:  0.0011796951293945312
r_  generation:  0.010652780532836914
local_output_nid generation:  0.0008842945098876953
local_in_edges_tensor generation:  0.0006747245788574219
mini_batch_src_global generation:  0.0011749267578125
r_  generation:  0.010551929473876953
local_output_nid generation:  0.0008971691131591797
local_in_edges_tensor generation:  0.0006964206695556641
mini_batch_src_global generation:  0.0012514591217041016
r_  generation:  0.010974407196044922
local_output_nid generation:  0.0008978843688964844
local_in_edges_tensor generation:  0.0006952285766601562
mini_batch_src_global generation:  0.0012221336364746094
r_  generation:  0.010776281356811523
local_output_nid generation:  0.0008997917175292969
local_in_edges_tensor generation:  0.0006225109100341797
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.012143611907958984
local_output_nid generation:  0.0009553432464599609
local_in_edges_tensor generation:  0.0006513595581054688
mini_batch_src_global generation:  0.0012402534484863281
r_  generation:  0.010689258575439453
local_output_nid generation:  0.0009143352508544922
local_in_edges_tensor generation:  0.0006513595581054688
mini_batch_src_global generation:  0.001184225082397461
r_  generation:  0.010397672653198242
local_output_nid generation:  0.000919342041015625
local_in_edges_tensor generation:  0.0006270408630371094
mini_batch_src_global generation:  0.0014269351959228516
r_  generation:  0.010271549224853516
local_output_nid generation:  0.0009496212005615234
local_in_edges_tensor generation:  0.0006921291351318359
mini_batch_src_global generation:  0.0011987686157226562
r_  generation:  0.010600090026855469
local_output_nid generation:  0.0009319782257080078
local_in_edges_tensor generation:  0.0006856918334960938
mini_batch_src_global generation:  0.0011818408966064453
r_  generation:  0.010388374328613281
local_output_nid generation:  0.00092315673828125
local_in_edges_tensor generation:  0.0006341934204101562
mini_batch_src_global generation:  0.0011875629425048828
r_  generation:  0.010317564010620117
local_output_nid generation:  0.002451181411743164
local_in_edges_tensor generation:  0.0007166862487792969
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.010202646255493164
local_output_nid generation:  0.0009624958038330078
local_in_edges_tensor generation:  0.0006816387176513672
mini_batch_src_global generation:  0.0011773109436035156
r_  generation:  0.010362386703491211
local_output_nid generation:  0.0009281635284423828
local_in_edges_tensor generation:  0.0006341934204101562
mini_batch_src_global generation:  0.0012035369873046875
r_  generation:  0.010507583618164062
local_output_nid generation:  0.0009326934814453125
local_in_edges_tensor generation:  0.0006320476531982422
mini_batch_src_global generation:  0.0012285709381103516
r_  generation:  0.01032400131225586
local_output_nid generation:  0.0009200572967529297
local_in_edges_tensor generation:  0.0006492137908935547
mini_batch_src_global generation:  0.0011603832244873047
r_  generation:  0.010236501693725586
----------------------check_connections_block total spend ----------------------------- 0.5651376247406006
generate_one_block  0.028604745864868164
generate_one_block  0.022244691848754883
generate_one_block  0.019904136657714844
generate_one_block  0.018881797790527344
generate_one_block  0.019905805587768555
generate_one_block  0.01911783218383789
generate_one_block  0.020558595657348633
generate_one_block  0.019892454147338867
generate_one_block  0.019284725189208984
generate_one_block  0.018589496612548828
generate_one_block  0.019018888473510742
generate_one_block  0.02129507064819336
generate_one_block  0.0193026065826416
generate_one_block  0.019326448440551758
generate_one_block  0.018977880477905273
generate_one_block  0.019123077392578125
generate_one_block  0.02215886116027832
generate_one_block  0.019276142120361328
generate_one_block  0.02016592025756836
generate_one_block  0.01970672607421875
generate_one_block  0.018670320510864258
generate_one_block  0.020844221115112305
generate_one_block  0.022527217864990234
generate_one_block  0.018985271453857422
generate_one_block  0.019551753997802734
generate_one_block  0.019045114517211914
generate_one_block  0.018796920776367188
generate_one_block  0.021296024322509766
generate_one_block  0.01895618438720703
generate_one_block  0.01900196075439453
generate_one_block  0.018874168395996094
generate_one_block  0.018731117248535156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.055085182189941406
gen group dst list time:  0.03502535820007324
time for parepare:  0.02924323081970215
local_output_nid generation:  0.007978439331054688
local_in_edges_tensor generation:  0.02659916877746582
mini_batch_src_global generation:  0.02815079689025879
r_  generation:  0.16837263107299805
local_output_nid generation:  0.012401580810546875
local_in_edges_tensor generation:  0.014642000198364258
mini_batch_src_global generation:  0.032002925872802734
r_  generation:  0.17741847038269043
local_output_nid generation:  0.012683391571044922
local_in_edges_tensor generation:  0.042272090911865234
mini_batch_src_global generation:  0.02116560935974121
r_  generation:  0.1760883331298828
local_output_nid generation:  0.014240741729736328
local_in_edges_tensor generation:  0.012027502059936523
mini_batch_src_global generation:  0.0389859676361084
r_  generation:  0.18726229667663574
local_output_nid generation:  0.01109457015991211
local_in_edges_tensor generation:  0.01122140884399414
mini_batch_src_global generation:  0.02624654769897461
r_  generation:  0.19603347778320312
local_output_nid generation:  0.01042795181274414
local_in_edges_tensor generation:  0.009010076522827148
mini_batch_src_global generation:  0.02517104148864746
r_  generation:  0.19474267959594727
local_output_nid generation:  0.01036834716796875
local_in_edges_tensor generation:  0.011410713195800781
mini_batch_src_global generation:  0.026015520095825195
r_  generation:  0.19350123405456543
local_output_nid generation:  0.009989738464355469
local_in_edges_tensor generation:  0.011354446411132812
mini_batch_src_global generation:  0.02749466896057129
r_  generation:  0.20350170135498047
local_output_nid generation:  0.009506702423095703
local_in_edges_tensor generation:  0.008806228637695312
mini_batch_src_global generation:  0.0267641544342041
r_  generation:  0.19691014289855957
local_output_nid generation:  0.009792327880859375
local_in_edges_tensor generation:  0.008800506591796875
mini_batch_src_global generation:  0.02585124969482422
r_  generation:  0.20804214477539062
local_output_nid generation:  0.013018369674682617
local_in_edges_tensor generation:  0.009716272354125977
mini_batch_src_global generation:  0.0282900333404541
r_  generation:  0.1960585117340088
local_output_nid generation:  0.010283231735229492
local_in_edges_tensor generation:  0.008868932723999023
mini_batch_src_global generation:  0.026468276977539062
r_  generation:  0.2036120891571045
local_output_nid generation:  0.010125160217285156
local_in_edges_tensor generation:  0.008755683898925781
mini_batch_src_global generation:  0.026792049407958984
r_  generation:  0.20105409622192383
local_output_nid generation:  0.010312318801879883
local_in_edges_tensor generation:  0.008982419967651367
mini_batch_src_global generation:  0.028299808502197266
r_  generation:  0.21962308883666992
local_output_nid generation:  0.014084577560424805
local_in_edges_tensor generation:  0.012946844100952148
mini_batch_src_global generation:  0.04571199417114258
r_  generation:  0.20844388008117676
local_output_nid generation:  0.012448549270629883
local_in_edges_tensor generation:  0.010099649429321289
mini_batch_src_global generation:  0.029567956924438477
r_  generation:  0.2100987434387207
local_output_nid generation:  0.010993242263793945
local_in_edges_tensor generation:  0.011782646179199219
mini_batch_src_global generation:  0.029750823974609375
r_  generation:  0.23351359367370605
local_output_nid generation:  0.011488199234008789
local_in_edges_tensor generation:  0.013660907745361328
mini_batch_src_global generation:  0.03281140327453613
r_  generation:  0.21147894859313965
local_output_nid generation:  0.011374473571777344
local_in_edges_tensor generation:  0.01225137710571289
mini_batch_src_global generation:  0.029726266860961914
r_  generation:  0.21746301651000977
local_output_nid generation:  0.011685609817504883
local_in_edges_tensor generation:  0.00972437858581543
mini_batch_src_global generation:  0.03075098991394043
r_  generation:  0.21466970443725586
local_output_nid generation:  0.010249614715576172
local_in_edges_tensor generation:  0.011765003204345703
mini_batch_src_global generation:  0.029633760452270508
r_  generation:  0.1979372501373291
local_output_nid generation:  0.010813236236572266
local_in_edges_tensor generation:  0.012023687362670898
mini_batch_src_global generation:  0.029508590698242188
r_  generation:  0.21047735214233398
local_output_nid generation:  0.010425567626953125
local_in_edges_tensor generation:  0.00960230827331543
mini_batch_src_global generation:  0.03822183609008789
r_  generation:  0.2262420654296875
local_output_nid generation:  0.013890504837036133
local_in_edges_tensor generation:  0.010225772857666016
mini_batch_src_global generation:  0.044309377670288086
r_  generation:  0.1987159252166748
local_output_nid generation:  0.01109457015991211
local_in_edges_tensor generation:  0.010009765625
mini_batch_src_global generation:  0.030601024627685547
r_  generation:  0.21009516716003418
local_output_nid generation:  0.010821104049682617
local_in_edges_tensor generation:  0.009279727935791016
mini_batch_src_global generation:  0.04250025749206543
r_  generation:  0.20293903350830078
local_output_nid generation:  0.010514497756958008
local_in_edges_tensor generation:  0.00925302505493164
mini_batch_src_global generation:  0.029806852340698242
r_  generation:  0.1999509334564209
local_output_nid generation:  0.010626077651977539
local_in_edges_tensor generation:  0.00876307487487793
mini_batch_src_global generation:  0.028572797775268555
r_  generation:  0.19685888290405273
local_output_nid generation:  0.010687112808227539
local_in_edges_tensor generation:  0.00852513313293457
mini_batch_src_global generation:  0.029732465744018555
r_  generation:  0.20034193992614746
local_output_nid generation:  0.01072239875793457
local_in_edges_tensor generation:  0.010181903839111328
mini_batch_src_global generation:  0.028721332550048828
r_  generation:  0.20335173606872559
local_output_nid generation:  0.010532617568969727
local_in_edges_tensor generation:  0.009966611862182617
mini_batch_src_global generation:  0.02669548988342285
r_  generation:  0.22539138793945312
local_output_nid generation:  0.014548301696777344
local_in_edges_tensor generation:  0.012989997863769531
mini_batch_src_global generation:  0.02394700050354004
r_  generation:  0.20743083953857422
----------------------check_connections_block total spend ----------------------------- 9.786314010620117
generate_one_block  0.2733643054962158
generate_one_block  0.26456594467163086
generate_one_block  0.2540771961212158
generate_one_block  0.258192777633667
generate_one_block  0.28499794006347656
generate_one_block  0.25911545753479004
generate_one_block  0.2556746006011963
generate_one_block  0.27509379386901855
generate_one_block  0.2566087245941162
generate_one_block  0.24398541450500488
generate_one_block  0.24613571166992188
generate_one_block  0.25544285774230957
generate_one_block  0.2749056816101074
generate_one_block  0.26045870780944824
generate_one_block  0.24937033653259277
generate_one_block  0.2554662227630615
generate_one_block  0.2564682960510254
generate_one_block  0.25565648078918457
generate_one_block  0.2621932029724121
generate_one_block  0.2694571018218994
generate_one_block  0.24483680725097656
generate_one_block  0.2772655487060547
generate_one_block  0.2564997673034668
generate_one_block  0.2490243911743164
generate_one_block  0.28885388374328613
generate_one_block  0.25255703926086426
generate_one_block  0.25132012367248535
generate_one_block  0.23929333686828613
generate_one_block  0.2471635341644287
generate_one_block  0.2516763210296631
generate_one_block  0.24771523475646973
generate_one_block  0.2482738494873047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038704633712768555
gen group dst list time:  0.11954808235168457
time for parepare:  0.020213603973388672
local_output_nid generation:  0.0279998779296875
local_in_edges_tensor generation:  0.049098968505859375
mini_batch_src_global generation:  0.06085538864135742
r_  generation:  0.5074925422668457
local_output_nid generation:  0.033562660217285156
local_in_edges_tensor generation:  0.038018226623535156
mini_batch_src_global generation:  0.06142473220825195
r_  generation:  0.49858736991882324
local_output_nid generation:  0.03380942344665527
local_in_edges_tensor generation:  0.03209352493286133
mini_batch_src_global generation:  0.05835151672363281
r_  generation:  0.5251829624176025
local_output_nid generation:  0.03558659553527832
local_in_edges_tensor generation:  0.03348994255065918
mini_batch_src_global generation:  0.059050559997558594
r_  generation:  0.51051926612854
local_output_nid generation:  0.03689861297607422
local_in_edges_tensor generation:  0.03646731376647949
mini_batch_src_global generation:  0.05929970741271973
r_  generation:  0.5215466022491455
local_output_nid generation:  0.03583335876464844
local_in_edges_tensor generation:  0.03759956359863281
mini_batch_src_global generation:  0.06421613693237305
r_  generation:  0.5270285606384277
local_output_nid generation:  0.03487563133239746
local_in_edges_tensor generation:  0.03927969932556152
mini_batch_src_global generation:  0.06624102592468262
r_  generation:  0.5013494491577148
local_output_nid generation:  0.030368328094482422
local_in_edges_tensor generation:  0.030240774154663086
mini_batch_src_global generation:  0.062326908111572266
r_  generation:  0.4959604740142822
local_output_nid generation:  0.030237913131713867
local_in_edges_tensor generation:  0.030570507049560547
mini_batch_src_global generation:  0.06070756912231445
r_  generation:  0.501007080078125
local_output_nid generation:  0.030284404754638672
local_in_edges_tensor generation:  0.03283262252807617
mini_batch_src_global generation:  0.05962324142456055
r_  generation:  0.49092626571655273
local_output_nid generation:  0.030516624450683594
local_in_edges_tensor generation:  0.02870488166809082
mini_batch_src_global generation:  0.058587074279785156
r_  generation:  0.515127420425415
local_output_nid generation:  0.03043818473815918
local_in_edges_tensor generation:  0.029111385345458984
mini_batch_src_global generation:  0.05984830856323242
r_  generation:  0.5021252632141113
local_output_nid generation:  0.030457019805908203
local_in_edges_tensor generation:  0.031816959381103516
mini_batch_src_global generation:  0.05835866928100586
r_  generation:  0.5153372287750244
local_output_nid generation:  0.03184914588928223
local_in_edges_tensor generation:  0.03396201133728027
mini_batch_src_global generation:  0.0606992244720459
r_  generation:  0.5060052871704102
local_output_nid generation:  0.032857418060302734
local_in_edges_tensor generation:  0.03321576118469238
mini_batch_src_global generation:  0.058739662170410156
r_  generation:  0.5104684829711914
local_output_nid generation:  0.030580520629882812
local_in_edges_tensor generation:  0.031432390213012695
mini_batch_src_global generation:  0.0720679759979248
r_  generation:  0.5057737827301025
local_output_nid generation:  0.03113579750061035
local_in_edges_tensor generation:  0.03898739814758301
mini_batch_src_global generation:  0.06077170372009277
r_  generation:  0.5104987621307373
local_output_nid generation:  0.030701637268066406
local_in_edges_tensor generation:  0.03399777412414551
mini_batch_src_global generation:  0.06197047233581543
r_  generation:  0.5111594200134277
local_output_nid generation:  0.03305554389953613
local_in_edges_tensor generation:  0.03464627265930176
mini_batch_src_global generation:  0.06163930892944336
r_  generation:  0.5084083080291748
local_output_nid generation:  0.030650615692138672
local_in_edges_tensor generation:  0.034214019775390625
mini_batch_src_global generation:  0.06700539588928223
r_  generation:  0.4980294704437256
local_output_nid generation:  0.030371427536010742
local_in_edges_tensor generation:  0.033356428146362305
mini_batch_src_global generation:  0.05870676040649414
r_  generation:  0.4974236488342285
local_output_nid generation:  0.030680179595947266
local_in_edges_tensor generation:  0.028591394424438477
mini_batch_src_global generation:  0.06037616729736328
r_  generation:  0.5086491107940674
local_output_nid generation:  0.030466556549072266
local_in_edges_tensor generation:  0.028260231018066406
mini_batch_src_global generation:  0.0592808723449707
r_  generation:  0.5037961006164551
local_output_nid generation:  0.03023982048034668
local_in_edges_tensor generation:  0.028012514114379883
mini_batch_src_global generation:  0.06011700630187988
r_  generation:  0.5015430450439453
local_output_nid generation:  0.030583858489990234
local_in_edges_tensor generation:  0.03275012969970703
mini_batch_src_global generation:  0.058249711990356445
r_  generation:  0.5079362392425537
local_output_nid generation:  0.030506372451782227
local_in_edges_tensor generation:  0.035529136657714844
mini_batch_src_global generation:  0.061074018478393555
r_  generation:  0.501394510269165
local_output_nid generation:  0.03145599365234375
local_in_edges_tensor generation:  0.03033900260925293
mini_batch_src_global generation:  0.058472394943237305
r_  generation:  0.5069243907928467
local_output_nid generation:  0.0305783748626709
local_in_edges_tensor generation:  0.030811071395874023
mini_batch_src_global generation:  0.05974316596984863
r_  generation:  0.5052821636199951
local_output_nid generation:  0.030505657196044922
local_in_edges_tensor generation:  0.0286557674407959
mini_batch_src_global generation:  0.05891108512878418
r_  generation:  0.5082101821899414
local_output_nid generation:  0.03203296661376953
local_in_edges_tensor generation:  0.030627727508544922
mini_batch_src_global generation:  0.062087059020996094
r_  generation:  0.508904218673706
local_output_nid generation:  0.030736923217773438
local_in_edges_tensor generation:  0.03682589530944824
mini_batch_src_global generation:  0.058862924575805664
r_  generation:  0.5091166496276855
local_output_nid generation:  0.030727624893188477
local_in_edges_tensor generation:  0.03045964241027832
mini_batch_src_global generation:  0.06193232536315918
r_  generation:  0.5047829151153564
----------------------check_connections_block total spend ----------------------------- 23.846405267715454
generate_one_block  0.7026712894439697
generate_one_block  0.6820456981658936
generate_one_block  0.6799283027648926
generate_one_block  0.6784613132476807
generate_one_block  0.7937426567077637
generate_one_block  0.6722497940063477
generate_one_block  0.6793880462646484
generate_one_block  0.6824758052825928
generate_one_block  0.6904971599578857
generate_one_block  0.6907551288604736
generate_one_block  0.6782205104827881
generate_one_block  0.6853015422821045
generate_one_block  0.6865651607513428
generate_one_block  0.6885256767272949
generate_one_block  0.6812281608581543
generate_one_block  0.6810975074768066
generate_one_block  0.6858420372009277
generate_one_block  0.6756024360656738
generate_one_block  0.6963858604431152
generate_one_block  0.6864190101623535
generate_one_block  0.6746325492858887
generate_one_block  0.6743872165679932
generate_one_block  0.6871500015258789
generate_one_block  0.6810874938964844
generate_one_block  0.7092576026916504
generate_one_block  0.6869556903839111
generate_one_block  0.6877551078796387
generate_one_block  0.6752071380615234
generate_one_block  0.6752376556396484
generate_one_block  0.6867096424102783
generate_one_block  0.6891677379608154
generate_one_block  0.6989538669586182
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.13144779205322266  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

connection checking time:  33.63271927833557
block generation total time  30.289615392684937
average batch blocks generation time:  0.9465504810214043
block dataloader generation time/epoch 66.31569584210713
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10890054702758789  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.574591636657715  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1094660758972168  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.88564443588257  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10896587371826172  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.617188930511475  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10905218124389648  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.522006511688232  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10914945602416992  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.912768840789795  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10925674438476562  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.677331924438477  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10919427871704102  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.736177921295166  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10958051681518555  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.157744884490967  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1092824935913086  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.890891075134277  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1090707778930664  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.467929363250732  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10899782180786133  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.66966962814331  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10926675796508789  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.810919761657715  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10924291610717773  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.73994541168213  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10943126678466797  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.059268474578857  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10898828506469727  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.719680786132812  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10949182510375977  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.96022605895996  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1094965934753418  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.995022296905518  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10913276672363281  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.973910808563232  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10954570770263672  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.20333433151245  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10967540740966797  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.158426761627197  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10856246948242188  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.277742385864258  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1094508171081543  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.06344223022461  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10912561416625977  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.538809299468994  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10904979705810547  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.45305061340332  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1094813346862793  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.19625186920166  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10905313491821289  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.679489612579346  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10914421081542969  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.504947185516357  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10900545120239258  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.275606632232666  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10898447036743164  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.58049249649048  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10942554473876953  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.760784149169922  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10915613174438477  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.64951992034912  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10932731628417969  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.701370239257812  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031678445637226105 |0.02459799498319626 |0.6283009350299835 |9.692460298538208e-05 |1.1880897283554077 |0.004733562469482422 |
----------------------------------------------------------pseudo_mini_loss sum 1.4992730617523193
Total (block generation + training)time/epoch 126.36928311983745
Training time/epoch 60.00208592414856
Training time without block to device /epoch 59.21495008468628
Training time without total dataloading part /epoch 58.132336378097534
load block tensor time/epoch 1.0137102603912354
block to device time/epoch 0.7871358394622803
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  9159708
Number of first layer input nodes during this epoch:  4808290
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.13127374649047852  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02462005615234375
range selection method range initialization spend 0.014465808868408203
time for parepare:  0.022129535675048828
local_output_nid generation:  0.0010154247283935547
local_in_edges_tensor generation:  0.008023262023925781
mini_batch_src_global generation:  0.0030639171600341797
r_  generation:  0.02094864845275879
local_output_nid generation:  0.0019218921661376953
local_in_edges_tensor generation:  0.001646280288696289
mini_batch_src_global generation:  0.0024261474609375
r_  generation:  0.013396501541137695
local_output_nid generation:  0.0009748935699462891
local_in_edges_tensor generation:  0.0006725788116455078
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010101079940795898
local_output_nid generation:  0.0009284019470214844
local_in_edges_tensor generation:  0.0007014274597167969
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.010068893432617188
local_output_nid generation:  0.0009367465972900391
local_in_edges_tensor generation:  0.0006058216094970703
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.013561248779296875
local_output_nid generation:  0.0009779930114746094
local_in_edges_tensor generation:  0.0006868839263916016
mini_batch_src_global generation:  0.0012216567993164062
r_  generation:  0.010104179382324219
local_output_nid generation:  0.0009295940399169922
local_in_edges_tensor generation:  0.0006051063537597656
mini_batch_src_global generation:  0.001218557357788086
r_  generation:  0.010212182998657227
local_output_nid generation:  0.0009620189666748047
local_in_edges_tensor generation:  0.0006825923919677734
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.010303258895874023
local_output_nid generation:  0.0009109973907470703
local_in_edges_tensor generation:  0.0006573200225830078
mini_batch_src_global generation:  0.0010571479797363281
r_  generation:  0.009740591049194336
local_output_nid generation:  0.0009763240814208984
local_in_edges_tensor generation:  0.000698089599609375
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.009981632232666016
local_output_nid generation:  0.0009121894836425781
local_in_edges_tensor generation:  0.0005908012390136719
mini_batch_src_global generation:  0.0011641979217529297
r_  generation:  0.01026010513305664
local_output_nid generation:  0.0009570121765136719
local_in_edges_tensor generation:  0.00060272216796875
mini_batch_src_global generation:  0.0010859966278076172
r_  generation:  0.011270761489868164
local_output_nid generation:  0.0009472370147705078
local_in_edges_tensor generation:  0.0006906986236572266
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.010101795196533203
local_output_nid generation:  0.0009245872497558594
local_in_edges_tensor generation:  0.0006012916564941406
mini_batch_src_global generation:  0.0011093616485595703
r_  generation:  0.010401487350463867
local_output_nid generation:  0.0009613037109375
local_in_edges_tensor generation:  0.0006651878356933594
mini_batch_src_global generation:  0.001157522201538086
r_  generation:  0.009933233261108398
local_output_nid generation:  0.0009303092956542969
local_in_edges_tensor generation:  0.0007014274597167969
mini_batch_src_global generation:  0.0012199878692626953
r_  generation:  0.010517358779907227
local_output_nid generation:  0.00095367431640625
local_in_edges_tensor generation:  0.0006823539733886719
mini_batch_src_global generation:  0.0012269020080566406
r_  generation:  0.010213375091552734
local_output_nid generation:  0.0009524822235107422
local_in_edges_tensor generation:  0.0007212162017822266
mini_batch_src_global generation:  0.001276254653930664
r_  generation:  0.010738134384155273
local_output_nid generation:  0.0009403228759765625
local_in_edges_tensor generation:  0.0006089210510253906
mini_batch_src_global generation:  0.0012178421020507812
r_  generation:  0.010573863983154297
local_output_nid generation:  0.0009396076202392578
local_in_edges_tensor generation:  0.0008325576782226562
mini_batch_src_global generation:  0.0011920928955078125
r_  generation:  0.01071476936340332
local_output_nid generation:  0.0009338855743408203
local_in_edges_tensor generation:  0.0006225109100341797
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.01000833511352539
local_output_nid generation:  0.0009274482727050781
local_in_edges_tensor generation:  0.0006749629974365234
mini_batch_src_global generation:  0.0011582374572753906
r_  generation:  0.010332345962524414
local_output_nid generation:  0.0009336471557617188
local_in_edges_tensor generation:  0.0006785392761230469
mini_batch_src_global generation:  0.0011539459228515625
r_  generation:  0.010563135147094727
local_output_nid generation:  0.0009236335754394531
local_in_edges_tensor generation:  0.0006518363952636719
mini_batch_src_global generation:  0.0012066364288330078
r_  generation:  0.010442495346069336
local_output_nid generation:  0.0009379386901855469
local_in_edges_tensor generation:  0.0005815029144287109
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.010514259338378906
local_output_nid generation:  0.0009517669677734375
local_in_edges_tensor generation:  0.0006928443908691406
mini_batch_src_global generation:  0.0011723041534423828
r_  generation:  0.010601043701171875
local_output_nid generation:  0.0009183883666992188
local_in_edges_tensor generation:  0.0005862712860107422
mini_batch_src_global generation:  0.0011937618255615234
r_  generation:  0.01048588752746582
local_output_nid generation:  0.0009400844573974609
local_in_edges_tensor generation:  0.0006265640258789062
mini_batch_src_global generation:  0.0011589527130126953
r_  generation:  0.010053157806396484
local_output_nid generation:  0.0009453296661376953
local_in_edges_tensor generation:  0.000579833984375
mini_batch_src_global generation:  0.0012514591217041016
r_  generation:  0.010475635528564453
local_output_nid generation:  0.0009336471557617188
local_in_edges_tensor generation:  0.0006561279296875
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.010217666625976562
local_output_nid generation:  0.0009481906890869141
local_in_edges_tensor generation:  0.0005850791931152344
mini_batch_src_global generation:  0.0012710094451904297
r_  generation:  0.01046442985534668
local_output_nid generation:  0.0009126663208007812
local_in_edges_tensor generation:  0.0006597042083740234
mini_batch_src_global generation:  0.0011210441589355469
r_  generation:  0.009886980056762695
----------------------check_connections_block total spend ----------------------------- 0.561424970626831
generate_one_block  0.027451276779174805
generate_one_block  0.021581172943115234
generate_one_block  0.019699573516845703
generate_one_block  0.019448280334472656
generate_one_block  0.019542455673217773
generate_one_block  0.01908111572265625
generate_one_block  0.019232988357543945
generate_one_block  0.019388675689697266
generate_one_block  0.018121004104614258
generate_one_block  0.018633604049682617
generate_one_block  0.01890254020690918
generate_one_block  0.01946234703063965
generate_one_block  0.01897430419921875
generate_one_block  0.0191805362701416
generate_one_block  0.018453359603881836
generate_one_block  0.019646167755126953
generate_one_block  0.018973588943481445
generate_one_block  0.019518375396728516
generate_one_block  0.01914691925048828
generate_one_block  0.01979994773864746
generate_one_block  0.01838850975036621
generate_one_block  0.019113540649414062
generate_one_block  0.021607160568237305
generate_one_block  0.01964569091796875
generate_one_block  0.019510984420776367
generate_one_block  0.01945638656616211
generate_one_block  0.019361257553100586
generate_one_block  0.018421649932861328
generate_one_block  0.019210100173950195
generate_one_block  0.018314123153686523
generate_one_block  0.01924753189086914
generate_one_block  0.01804947853088379
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03777766227722168
gen group dst list time:  0.023079872131347656
time for parepare:  0.02201676368713379
local_output_nid generation:  0.006040334701538086
local_in_edges_tensor generation:  0.0191342830657959
mini_batch_src_global generation:  0.018698692321777344
r_  generation:  0.1679823398590088
local_output_nid generation:  0.0077478885650634766
local_in_edges_tensor generation:  0.010907173156738281
mini_batch_src_global generation:  0.022027969360351562
r_  generation:  0.20190763473510742
local_output_nid generation:  0.008134603500366211
local_in_edges_tensor generation:  0.034525394439697266
mini_batch_src_global generation:  0.0212554931640625
r_  generation:  0.17383718490600586
local_output_nid generation:  0.008574962615966797
local_in_edges_tensor generation:  0.011783123016357422
mini_batch_src_global generation:  0.021658658981323242
r_  generation:  0.17630934715270996
local_output_nid generation:  0.008836030960083008
local_in_edges_tensor generation:  0.01006174087524414
mini_batch_src_global generation:  0.023610591888427734
r_  generation:  0.18319320678710938
local_output_nid generation:  0.00889277458190918
local_in_edges_tensor generation:  0.00845193862915039
mini_batch_src_global generation:  0.022329092025756836
r_  generation:  0.1832561492919922
local_output_nid generation:  0.009066104888916016
local_in_edges_tensor generation:  0.009026527404785156
mini_batch_src_global generation:  0.023169994354248047
r_  generation:  0.18334507942199707
local_output_nid generation:  0.00867009162902832
local_in_edges_tensor generation:  0.011068582534790039
mini_batch_src_global generation:  0.022793292999267578
r_  generation:  0.18268465995788574
local_output_nid generation:  0.008355140686035156
local_in_edges_tensor generation:  0.01132822036743164
mini_batch_src_global generation:  0.02307724952697754
r_  generation:  0.17377018928527832
local_output_nid generation:  0.008925199508666992
local_in_edges_tensor generation:  0.009682893753051758
mini_batch_src_global generation:  0.0224456787109375
r_  generation:  0.17824006080627441
local_output_nid generation:  0.008902549743652344
local_in_edges_tensor generation:  0.008625030517578125
mini_batch_src_global generation:  0.02208995819091797
r_  generation:  0.1785438060760498
local_output_nid generation:  0.009070158004760742
local_in_edges_tensor generation:  0.00881505012512207
mini_batch_src_global generation:  0.02312016487121582
r_  generation:  0.1854724884033203
local_output_nid generation:  0.009147405624389648
local_in_edges_tensor generation:  0.008703470230102539
mini_batch_src_global generation:  0.023421049118041992
r_  generation:  0.22926998138427734
local_output_nid generation:  0.01154327392578125
local_in_edges_tensor generation:  0.00897526741027832
mini_batch_src_global generation:  0.024081945419311523
r_  generation:  0.18573236465454102
local_output_nid generation:  0.008825540542602539
local_in_edges_tensor generation:  0.00864267349243164
mini_batch_src_global generation:  0.02313685417175293
r_  generation:  0.17626357078552246
local_output_nid generation:  0.00949406623840332
local_in_edges_tensor generation:  0.010488510131835938
mini_batch_src_global generation:  0.0235440731048584
r_  generation:  0.19012880325317383
local_output_nid generation:  0.009254693984985352
local_in_edges_tensor generation:  0.01035761833190918
mini_batch_src_global generation:  0.023339033126831055
r_  generation:  0.18647408485412598
local_output_nid generation:  0.011795520782470703
local_in_edges_tensor generation:  0.010837793350219727
mini_batch_src_global generation:  0.024435997009277344
r_  generation:  0.19399523735046387
local_output_nid generation:  0.009339332580566406
local_in_edges_tensor generation:  0.010603904724121094
mini_batch_src_global generation:  0.02384805679321289
r_  generation:  0.1867976188659668
local_output_nid generation:  0.009811878204345703
local_in_edges_tensor generation:  0.013579607009887695
mini_batch_src_global generation:  0.023447513580322266
r_  generation:  0.19013190269470215
local_output_nid generation:  0.009109973907470703
local_in_edges_tensor generation:  0.010233640670776367
mini_batch_src_global generation:  0.024842500686645508
r_  generation:  0.1856555938720703
local_output_nid generation:  0.010039091110229492
local_in_edges_tensor generation:  0.009558677673339844
mini_batch_src_global generation:  0.023303985595703125
r_  generation:  0.1876235008239746
local_output_nid generation:  0.009447097778320312
local_in_edges_tensor generation:  0.014105558395385742
mini_batch_src_global generation:  0.024573087692260742
r_  generation:  0.18631315231323242
local_output_nid generation:  0.010369539260864258
local_in_edges_tensor generation:  0.009934425354003906
mini_batch_src_global generation:  0.024567842483520508
r_  generation:  0.18716955184936523
local_output_nid generation:  0.00976109504699707
local_in_edges_tensor generation:  0.01069331169128418
mini_batch_src_global generation:  0.023496627807617188
r_  generation:  0.196730375289917
local_output_nid generation:  0.011627197265625
local_in_edges_tensor generation:  0.009926319122314453
mini_batch_src_global generation:  0.024475812911987305
r_  generation:  0.1867356300354004
local_output_nid generation:  0.009838581085205078
local_in_edges_tensor generation:  0.010011434555053711
mini_batch_src_global generation:  0.02340412139892578
r_  generation:  0.1863234043121338
local_output_nid generation:  0.009533166885375977
local_in_edges_tensor generation:  0.011139154434204102
mini_batch_src_global generation:  0.023517608642578125
r_  generation:  0.18094110488891602
local_output_nid generation:  0.009770631790161133
local_in_edges_tensor generation:  0.009372234344482422
mini_batch_src_global generation:  0.02362537384033203
r_  generation:  0.18980765342712402
local_output_nid generation:  0.00934743881225586
local_in_edges_tensor generation:  0.011497020721435547
mini_batch_src_global generation:  0.023112773895263672
r_  generation:  0.175123929977417
local_output_nid generation:  0.009838581085205078
local_in_edges_tensor generation:  0.00933980941772461
mini_batch_src_global generation:  0.022954225540161133
r_  generation:  0.1868593692779541
local_output_nid generation:  0.009286642074584961
local_in_edges_tensor generation:  0.008958578109741211
mini_batch_src_global generation:  0.022455930709838867
r_  generation:  0.1765727996826172
----------------------check_connections_block total spend ----------------------------- 8.689697504043579
generate_one_block  0.2695741653442383
generate_one_block  0.2426469326019287
generate_one_block  0.2437293529510498
generate_one_block  0.24744582176208496
generate_one_block  0.27350306510925293
generate_one_block  0.24666810035705566
generate_one_block  0.2547109127044678
generate_one_block  0.2556583881378174
generate_one_block  0.25696301460266113
generate_one_block  0.24935197830200195
generate_one_block  0.24476146697998047
generate_one_block  0.2585604190826416
generate_one_block  0.2527964115142822
generate_one_block  0.2539043426513672
generate_one_block  0.24297046661376953
generate_one_block  0.2582569122314453
generate_one_block  0.25278639793395996
generate_one_block  0.2596890926361084
generate_one_block  0.2542843818664551
generate_one_block  0.2659940719604492
generate_one_block  0.2456064224243164
generate_one_block  0.2523951530456543
generate_one_block  0.25377631187438965
generate_one_block  0.25791382789611816
generate_one_block  0.25647401809692383
generate_one_block  0.2564363479614258
generate_one_block  0.2543656826019287
generate_one_block  0.24973416328430176
generate_one_block  0.25849032402038574
generate_one_block  0.2353355884552002
generate_one_block  0.254497766494751
generate_one_block  0.2390303611755371
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03951907157897949
gen group dst list time:  0.11566615104675293
time for parepare:  0.018844127655029297
local_output_nid generation:  0.025877714157104492
local_in_edges_tensor generation:  0.047844886779785156
mini_batch_src_global generation:  0.04736328125
r_  generation:  0.49045419692993164
local_output_nid generation:  0.03040623664855957
local_in_edges_tensor generation:  0.03703784942626953
mini_batch_src_global generation:  0.060858726501464844
r_  generation:  0.48729491233825684
local_output_nid generation:  0.030648231506347656
local_in_edges_tensor generation:  0.028973102569580078
mini_batch_src_global generation:  0.05945444107055664
r_  generation:  0.5131292343139648
local_output_nid generation:  0.031082868576049805
local_in_edges_tensor generation:  0.034552812576293945
mini_batch_src_global generation:  0.05877280235290527
r_  generation:  0.49440789222717285
local_output_nid generation:  0.031275033950805664
local_in_edges_tensor generation:  0.02927231788635254
mini_batch_src_global generation:  0.05860614776611328
r_  generation:  0.5046062469482422
local_output_nid generation:  0.0313568115234375
local_in_edges_tensor generation:  0.03474760055541992
mini_batch_src_global generation:  0.06058216094970703
r_  generation:  0.49777936935424805
local_output_nid generation:  0.03006720542907715
local_in_edges_tensor generation:  0.034383535385131836
mini_batch_src_global generation:  0.059058427810668945
r_  generation:  0.5073146820068359
local_output_nid generation:  0.029269933700561523
local_in_edges_tensor generation:  0.031247615814208984
mini_batch_src_global generation:  0.0596621036529541
r_  generation:  0.4975869655609131
local_output_nid generation:  0.029343128204345703
local_in_edges_tensor generation:  0.029530763626098633
mini_batch_src_global generation:  0.05890083312988281
r_  generation:  0.500720739364624
local_output_nid generation:  0.03128695487976074
local_in_edges_tensor generation:  0.02890944480895996
mini_batch_src_global generation:  0.062122344970703125
r_  generation:  0.4975111484527588
local_output_nid generation:  0.029331684112548828
local_in_edges_tensor generation:  0.03315901756286621
mini_batch_src_global generation:  0.06069636344909668
r_  generation:  0.5034651756286621
local_output_nid generation:  0.029674053192138672
local_in_edges_tensor generation:  0.03033614158630371
mini_batch_src_global generation:  0.060434818267822266
r_  generation:  0.4979987144470215
local_output_nid generation:  0.030657291412353516
local_in_edges_tensor generation:  0.031319618225097656
mini_batch_src_global generation:  0.05878591537475586
r_  generation:  0.5040841102600098
local_output_nid generation:  0.029795169830322266
local_in_edges_tensor generation:  0.037294864654541016
mini_batch_src_global generation:  0.06057333946228027
r_  generation:  0.4961690902709961
local_output_nid generation:  0.030507564544677734
local_in_edges_tensor generation:  0.03494858741760254
mini_batch_src_global generation:  0.058897972106933594
r_  generation:  0.5008053779602051
local_output_nid generation:  0.030147314071655273
local_in_edges_tensor generation:  0.03520369529724121
mini_batch_src_global generation:  0.06512069702148438
r_  generation:  0.5111124515533447
local_output_nid generation:  0.03227591514587402
local_in_edges_tensor generation:  0.03497123718261719
mini_batch_src_global generation:  0.0600285530090332
r_  generation:  0.5023283958435059
local_output_nid generation:  0.030568361282348633
local_in_edges_tensor generation:  0.030922889709472656
mini_batch_src_global generation:  0.0603182315826416
r_  generation:  0.49645280838012695
local_output_nid generation:  0.0302884578704834
local_in_edges_tensor generation:  0.031350135803222656
mini_batch_src_global generation:  0.058585166931152344
r_  generation:  0.5043673515319824
local_output_nid generation:  0.030556678771972656
local_in_edges_tensor generation:  0.03064727783203125
mini_batch_src_global generation:  0.059755802154541016
r_  generation:  0.5015115737915039
local_output_nid generation:  0.03054499626159668
local_in_edges_tensor generation:  0.031293392181396484
mini_batch_src_global generation:  0.058943986892700195
r_  generation:  0.4992818832397461
local_output_nid generation:  0.03024005889892578
local_in_edges_tensor generation:  0.030935049057006836
mini_batch_src_global generation:  0.06024575233459473
r_  generation:  0.5073316097259521
local_output_nid generation:  0.030553340911865234
local_in_edges_tensor generation:  0.029763221740722656
mini_batch_src_global generation:  0.05923104286193848
r_  generation:  0.5055997371673584
local_output_nid generation:  0.03067612648010254
local_in_edges_tensor generation:  0.029013872146606445
mini_batch_src_global generation:  0.06230902671813965
r_  generation:  0.5119285583496094
local_output_nid generation:  0.030786752700805664
local_in_edges_tensor generation:  0.032624244689941406
mini_batch_src_global generation:  0.05869722366333008
r_  generation:  0.5113680362701416
local_output_nid generation:  0.030486345291137695
local_in_edges_tensor generation:  0.03091740608215332
mini_batch_src_global generation:  0.060298919677734375
r_  generation:  0.5001118183135986
local_output_nid generation:  0.030858278274536133
local_in_edges_tensor generation:  0.031006336212158203
mini_batch_src_global generation:  0.05904340744018555
r_  generation:  0.5021159648895264
local_output_nid generation:  0.03035759925842285
local_in_edges_tensor generation:  0.03133654594421387
mini_batch_src_global generation:  0.06058692932128906
r_  generation:  0.5007431507110596
local_output_nid generation:  0.030423641204833984
local_in_edges_tensor generation:  0.03067302703857422
mini_batch_src_global generation:  0.05870366096496582
r_  generation:  0.5042448043823242
local_output_nid generation:  0.030504226684570312
local_in_edges_tensor generation:  0.02962183952331543
mini_batch_src_global generation:  0.06011652946472168
r_  generation:  0.5036485195159912
local_output_nid generation:  0.030747413635253906
local_in_edges_tensor generation:  0.029027462005615234
mini_batch_src_global generation:  0.06102252006530762
r_  generation:  0.5087323188781738
local_output_nid generation:  0.030585289001464844
local_in_edges_tensor generation:  0.03432750701904297
mini_batch_src_global generation:  0.06452035903930664
r_  generation:  0.4993457794189453
----------------------check_connections_block total spend ----------------------------- 23.504295825958252
generate_one_block  0.69862961769104
generate_one_block  0.6755752563476562
generate_one_block  0.6812844276428223
generate_one_block  0.6728363037109375
generate_one_block  0.7821311950683594
generate_one_block  0.6820197105407715
generate_one_block  0.6895749568939209
generate_one_block  0.6734483242034912
generate_one_block  0.6755282878875732
generate_one_block  0.6725220680236816
generate_one_block  0.6828174591064453
generate_one_block  0.6881270408630371
generate_one_block  0.6823849678039551
generate_one_block  0.6846849918365479
generate_one_block  0.6771504878997803
generate_one_block  0.6840338706970215
generate_one_block  0.6719827651977539
generate_one_block  0.675957441329956
generate_one_block  0.6772286891937256
generate_one_block  0.6972918510437012
generate_one_block  0.6821706295013428
generate_one_block  0.6904716491699219
generate_one_block  0.6765346527099609
generate_one_block  0.6832304000854492
generate_one_block  0.7062160968780518
generate_one_block  0.6776602268218994
generate_one_block  0.6844735145568848
generate_one_block  0.6747231483459473
generate_one_block  0.6864242553710938
generate_one_block  0.6787517070770264
generate_one_block  0.6797587871551514
generate_one_block  0.6938652992248535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.13127374649047852  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

connection checking time:  32.19399333000183
block generation total time  30.03780174255371
average batch blocks generation time:  0.9386813044548035
block dataloader generation time/epoch 66.26754883357457
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10961627960205078  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.050371170043945  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10907888412475586  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.56531572341919  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10927248001098633  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.716140270233154  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10910415649414062  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.73190402984619  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10913276672363281  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.049586296081543  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10903310775756836  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.786134243011475  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10945940017700195  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.027104377746582  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10918617248535156  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.903762817382812  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1089177131652832  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.314395904541016  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10930824279785156  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.53523874282837  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10906505584716797  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.57229995727539  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1091303825378418  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.927937507629395  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10913991928100586  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.71401357650757  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10916852951049805  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.873619079589844  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10878705978393555  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.244524478912354  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10938262939453125  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.058677673339844  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10937643051147461  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.8026442527771  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10914421081542969  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.01501989364624  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1091756820678711  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.77684259414673  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10937929153442383  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.98735284805298  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1090087890625  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.398383140563965  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10930538177490234  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.875388622283936  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10904502868652344  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.760445594787598  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10925960540771484  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.955230712890625  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1093292236328125  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.94619655609131  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10924339294433594  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.912925243377686  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10938739776611328  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.939876556396484  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10905694961547852  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.532262325286865  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10920524597167969  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.078094005584717  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10916566848754883  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.220577716827393  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10930156707763672  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.961203575134277  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1089167594909668  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.346832752227783  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02845233678817749 |0.022616028785705566 |0.6306982114911079 |9.640306234359741e-05 |1.1950908154249191 |0.008569717407226562 |
----------------------------------------------------------pseudo_mini_loss sum 1.4686733484268188
Total (block generation + training)time/epoch 126.3327704157148
Training time/epoch 60.13474702835083
Training time without block to device /epoch 59.41103410720825
Training time without total dataloading part /epoch 58.43690347671509
load block tensor time/epoch 0.9104747772216797
block to device time/epoch 0.7237129211425781
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  9158014
Number of first layer input nodes during this epoch:  4806231
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.13053131103515625  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02768230438232422
range selection method range initialization spend 0.016842365264892578
time for parepare:  0.02060723304748535
local_output_nid generation:  0.0010399818420410156
local_in_edges_tensor generation:  0.009129047393798828
mini_batch_src_global generation:  0.0021517276763916016
r_  generation:  0.012492895126342773
local_output_nid generation:  0.0009889602661132812
local_in_edges_tensor generation:  0.0007071495056152344
mini_batch_src_global generation:  0.0015511512756347656
r_  generation:  0.010792016983032227
local_output_nid generation:  0.0009119510650634766
local_in_edges_tensor generation:  0.0006098747253417969
mini_batch_src_global generation:  0.0010800361633300781
r_  generation:  0.009675741195678711
local_output_nid generation:  0.0009043216705322266
local_in_edges_tensor generation:  0.0006291866302490234
mini_batch_src_global generation:  0.0010764598846435547
r_  generation:  0.010104179382324219
local_output_nid generation:  0.0008890628814697266
local_in_edges_tensor generation:  0.0005919933319091797
mini_batch_src_global generation:  0.0010602474212646484
r_  generation:  0.009715795516967773
local_output_nid generation:  0.0008878707885742188
local_in_edges_tensor generation:  0.0005850791931152344
mini_batch_src_global generation:  0.0011219978332519531
r_  generation:  0.009800195693969727
local_output_nid generation:  0.0009043216705322266
local_in_edges_tensor generation:  0.0006227493286132812
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.010529518127441406
local_output_nid generation:  0.0009326934814453125
local_in_edges_tensor generation:  0.0006327629089355469
mini_batch_src_global generation:  0.001214742660522461
r_  generation:  0.010372400283813477
local_output_nid generation:  0.0008935928344726562
local_in_edges_tensor generation:  0.0006308555603027344
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.010209798812866211
local_output_nid generation:  0.0008947849273681641
local_in_edges_tensor generation:  0.0006103515625
mini_batch_src_global generation:  0.0011944770812988281
r_  generation:  0.010568857192993164
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.0005998611450195312
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.010233163833618164
local_output_nid generation:  0.0008757114410400391
local_in_edges_tensor generation:  0.0006229877471923828
mini_batch_src_global generation:  0.0011827945709228516
r_  generation:  0.010747432708740234
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0006098747253417969
mini_batch_src_global generation:  0.0012049674987792969
r_  generation:  0.010396242141723633
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0006361007690429688
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.010227203369140625
local_output_nid generation:  0.0008854866027832031
local_in_edges_tensor generation:  0.0005803108215332031
mini_batch_src_global generation:  0.0011208057403564453
r_  generation:  0.010131597518920898
local_output_nid generation:  0.0008900165557861328
local_in_edges_tensor generation:  0.0005612373352050781
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.010240793228149414
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0006363391876220703
mini_batch_src_global generation:  0.0011801719665527344
r_  generation:  0.010268211364746094
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.010319948196411133
local_output_nid generation:  0.0009036064147949219
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.0011985301971435547
r_  generation:  0.010264158248901367
local_output_nid generation:  0.0008969306945800781
local_in_edges_tensor generation:  0.0006134510040283203
mini_batch_src_global generation:  0.0011441707611083984
r_  generation:  0.010413646697998047
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0005905628204345703
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.010333061218261719
local_output_nid generation:  0.000881195068359375
local_in_edges_tensor generation:  0.0005998611450195312
mini_batch_src_global generation:  0.0011687278747558594
r_  generation:  0.010541677474975586
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.000583648681640625
mini_batch_src_global generation:  0.001224517822265625
r_  generation:  0.010486841201782227
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0006067752838134766
mini_batch_src_global generation:  0.0011255741119384766
r_  generation:  0.01003408432006836
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0005810260772705078
mini_batch_src_global generation:  0.0011775493621826172
r_  generation:  0.010170221328735352
local_output_nid generation:  0.0008738040924072266
local_in_edges_tensor generation:  0.0005927085876464844
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.01034998893737793
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0005886554718017578
mini_batch_src_global generation:  0.0011696815490722656
r_  generation:  0.010626792907714844
local_output_nid generation:  0.0008831024169921875
local_in_edges_tensor generation:  0.0005884170532226562
mini_batch_src_global generation:  0.0012052059173583984
r_  generation:  0.010712862014770508
local_output_nid generation:  0.0009219646453857422
local_in_edges_tensor generation:  0.0006086826324462891
mini_batch_src_global generation:  0.0011632442474365234
r_  generation:  0.01030278205871582
local_output_nid generation:  0.0009164810180664062
local_in_edges_tensor generation:  0.0006232261657714844
mini_batch_src_global generation:  0.0012083053588867188
r_  generation:  0.01038217544555664
local_output_nid generation:  0.0008790493011474609
local_in_edges_tensor generation:  0.0005829334259033203
mini_batch_src_global generation:  0.0011360645294189453
r_  generation:  0.010344982147216797
local_output_nid generation:  0.0008802413940429688
local_in_edges_tensor generation:  0.0005705356597900391
mini_batch_src_global generation:  0.0011489391326904297
r_  generation:  0.010170459747314453
----------------------check_connections_block total spend ----------------------------- 0.530125617980957
generate_one_block  0.023033857345581055
generate_one_block  0.02148747444152832
generate_one_block  0.019152402877807617
generate_one_block  0.01950860023498535
generate_one_block  0.01865673065185547
generate_one_block  0.01839613914489746
generate_one_block  0.01984858512878418
generate_one_block  0.019289255142211914
generate_one_block  0.019179821014404297
generate_one_block  0.019594430923461914
generate_one_block  0.018775463104248047
generate_one_block  0.020329952239990234
generate_one_block  0.019055843353271484
generate_one_block  0.018912076950073242
generate_one_block  0.018711328506469727
generate_one_block  0.0190889835357666
generate_one_block  0.019143104553222656
generate_one_block  0.01888275146484375
generate_one_block  0.018754005432128906
generate_one_block  0.019166946411132812
generate_one_block  0.018855810165405273
generate_one_block  0.01933431625366211
generate_one_block  0.02134871482849121
generate_one_block  0.018544435501098633
generate_one_block  0.018813610076904297
generate_one_block  0.019149065017700195
generate_one_block  0.01936197280883789
generate_one_block  0.01946711540222168
generate_one_block  0.018497943878173828
generate_one_block  0.018863439559936523
generate_one_block  0.018630266189575195
generate_one_block  0.01869034767150879
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04252982139587402
gen group dst list time:  0.02487945556640625
time for parepare:  0.02147507667541504
local_output_nid generation:  0.005968809127807617
local_in_edges_tensor generation:  0.020801782608032227
mini_batch_src_global generation:  0.019037961959838867
r_  generation:  0.1738874912261963
local_output_nid generation:  0.008440256118774414
local_in_edges_tensor generation:  0.00974416732788086
mini_batch_src_global generation:  0.022186279296875
r_  generation:  0.17441344261169434
local_output_nid generation:  0.007996320724487305
local_in_edges_tensor generation:  0.03593611717224121
mini_batch_src_global generation:  0.021060466766357422
r_  generation:  0.16929841041564941
local_output_nid generation:  0.00853872299194336
local_in_edges_tensor generation:  0.008840799331665039
mini_batch_src_global generation:  0.021950483322143555
r_  generation:  0.17828607559204102
local_output_nid generation:  0.00868082046508789
local_in_edges_tensor generation:  0.011319637298583984
mini_batch_src_global generation:  0.02286219596862793
r_  generation:  0.17560243606567383
local_output_nid generation:  0.008724451065063477
local_in_edges_tensor generation:  0.008484840393066406
mini_batch_src_global generation:  0.022458314895629883
r_  generation:  0.1754295825958252
local_output_nid generation:  0.009397745132446289
local_in_edges_tensor generation:  0.009131193161010742
mini_batch_src_global generation:  0.02459406852722168
r_  generation:  0.18668079376220703
local_output_nid generation:  0.008700370788574219
local_in_edges_tensor generation:  0.009648799896240234
mini_batch_src_global generation:  0.023158550262451172
r_  generation:  0.18150758743286133
local_output_nid generation:  0.008758306503295898
local_in_edges_tensor generation:  0.009808063507080078
mini_batch_src_global generation:  0.024298429489135742
r_  generation:  0.1837606430053711
local_output_nid generation:  0.009226799011230469
local_in_edges_tensor generation:  0.009534597396850586
mini_batch_src_global generation:  0.02345132827758789
r_  generation:  0.1902327537536621
local_output_nid generation:  0.008956670761108398
local_in_edges_tensor generation:  0.00990605354309082
mini_batch_src_global generation:  0.023258686065673828
r_  generation:  0.17852330207824707
local_output_nid generation:  0.009542703628540039
local_in_edges_tensor generation:  0.009430170059204102
mini_batch_src_global generation:  0.023405075073242188
r_  generation:  0.18621373176574707
local_output_nid generation:  0.009227991104125977
local_in_edges_tensor generation:  0.012037992477416992
mini_batch_src_global generation:  0.023988723754882812
r_  generation:  0.18103981018066406
local_output_nid generation:  0.009226560592651367
local_in_edges_tensor generation:  0.012134552001953125
mini_batch_src_global generation:  0.02367424964904785
r_  generation:  0.18239474296569824
local_output_nid generation:  0.009048938751220703
local_in_edges_tensor generation:  0.008986234664916992
mini_batch_src_global generation:  0.0227053165435791
r_  generation:  0.17893099784851074
local_output_nid generation:  0.009060144424438477
local_in_edges_tensor generation:  0.008905172348022461
mini_batch_src_global generation:  0.022660255432128906
r_  generation:  0.18048501014709473
local_output_nid generation:  0.009184598922729492
local_in_edges_tensor generation:  0.009177923202514648
mini_batch_src_global generation:  0.023023605346679688
r_  generation:  0.18289732933044434
local_output_nid generation:  0.009397029876708984
local_in_edges_tensor generation:  0.00925588607788086
mini_batch_src_global generation:  0.02344036102294922
r_  generation:  0.18431901931762695
local_output_nid generation:  0.009373188018798828
local_in_edges_tensor generation:  0.009508132934570312
mini_batch_src_global generation:  0.02303290367126465
r_  generation:  0.18551397323608398
local_output_nid generation:  0.009454011917114258
local_in_edges_tensor generation:  0.009225130081176758
mini_batch_src_global generation:  0.02317953109741211
r_  generation:  0.1852712631225586
local_output_nid generation:  0.009336471557617188
local_in_edges_tensor generation:  0.008820533752441406
mini_batch_src_global generation:  0.023396968841552734
r_  generation:  0.1897902488708496
local_output_nid generation:  0.009299039840698242
local_in_edges_tensor generation:  0.00902867317199707
mini_batch_src_global generation:  0.023319721221923828
r_  generation:  0.1848127841949463
local_output_nid generation:  0.00936436653137207
local_in_edges_tensor generation:  0.009237527847290039
mini_batch_src_global generation:  0.022639036178588867
r_  generation:  0.1844770908355713
local_output_nid generation:  0.00912022590637207
local_in_edges_tensor generation:  0.011141300201416016
mini_batch_src_global generation:  0.022269248962402344
r_  generation:  0.1759500503540039
local_output_nid generation:  0.009307146072387695
local_in_edges_tensor generation:  0.009054899215698242
mini_batch_src_global generation:  0.022705078125
r_  generation:  0.18515443801879883
local_output_nid generation:  0.009446144104003906
local_in_edges_tensor generation:  0.009055852890014648
mini_batch_src_global generation:  0.024149179458618164
r_  generation:  0.18764686584472656
local_output_nid generation:  0.009523630142211914
local_in_edges_tensor generation:  0.009563207626342773
mini_batch_src_global generation:  0.02299022674560547
r_  generation:  0.18627214431762695
local_output_nid generation:  0.009519815444946289
local_in_edges_tensor generation:  0.009210348129272461
mini_batch_src_global generation:  0.023507118225097656
r_  generation:  0.18912148475646973
local_output_nid generation:  0.009262323379516602
local_in_edges_tensor generation:  0.00890660285949707
mini_batch_src_global generation:  0.022428035736083984
r_  generation:  0.18046164512634277
local_output_nid generation:  0.009418964385986328
local_in_edges_tensor generation:  0.009215354919433594
mini_batch_src_global generation:  0.02286672592163086
r_  generation:  0.1815195083618164
local_output_nid generation:  0.009081840515136719
local_in_edges_tensor generation:  0.00899195671081543
mini_batch_src_global generation:  0.022446393966674805
r_  generation:  0.18418240547180176
local_output_nid generation:  0.009114980697631836
local_in_edges_tensor generation:  0.008711099624633789
mini_batch_src_global generation:  0.023026466369628906
r_  generation:  0.1827712059020996
----------------------check_connections_block total spend ----------------------------- 8.529563903808594
generate_one_block  0.26256537437438965
generate_one_block  0.25124359130859375
generate_one_block  0.23973417282104492
generate_one_block  0.24915266036987305
generate_one_block  0.25838303565979004
generate_one_block  0.23779559135437012
generate_one_block  0.2594008445739746
generate_one_block  0.2526841163635254
generate_one_block  0.2525453567504883
generate_one_block  0.25625157356262207
generate_one_block  0.2434399127960205
generate_one_block  0.25375986099243164
generate_one_block  0.24529528617858887
generate_one_block  0.24753499031066895
generate_one_block  0.24204492568969727
generate_one_block  0.244490385055542
generate_one_block  0.2478318214416504
generate_one_block  0.2492828369140625
generate_one_block  0.24866199493408203
generate_one_block  0.2560715675354004
generate_one_block  0.25215744972229004
generate_one_block  0.24931836128234863
generate_one_block  0.24878764152526855
generate_one_block  0.23779606819152832
generate_one_block  0.24592232704162598
generate_one_block  0.25334596633911133
generate_one_block  0.24969863891601562
generate_one_block  0.2554192543029785
generate_one_block  0.24004530906677246
generate_one_block  0.2455754280090332
generate_one_block  0.24635529518127441
generate_one_block  0.2471933364868164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0581364631652832
gen group dst list time:  0.10468435287475586
time for parepare:  0.01908397674560547
local_output_nid generation:  0.02443981170654297
local_in_edges_tensor generation:  0.04465746879577637
mini_batch_src_global generation:  0.047345638275146484
r_  generation:  0.4873318672180176
local_output_nid generation:  0.031010866165161133
local_in_edges_tensor generation:  0.03626561164855957
mini_batch_src_global generation:  0.058983802795410156
r_  generation:  0.48429393768310547
local_output_nid generation:  0.031113147735595703
local_in_edges_tensor generation:  0.030382156372070312
mini_batch_src_global generation:  0.05705142021179199
r_  generation:  0.4942758083343506
local_output_nid generation:  0.031235933303833008
local_in_edges_tensor generation:  0.030300378799438477
mini_batch_src_global generation:  0.06082963943481445
r_  generation:  0.49208641052246094
local_output_nid generation:  0.031476736068725586
local_in_edges_tensor generation:  0.028818607330322266
mini_batch_src_global generation:  0.0582125186920166
r_  generation:  0.49721431732177734
local_output_nid generation:  0.03139543533325195
local_in_edges_tensor generation:  0.028446197509765625
mini_batch_src_global generation:  0.0593719482421875
r_  generation:  0.4944939613342285
local_output_nid generation:  0.030385971069335938
local_in_edges_tensor generation:  0.029021501541137695
mini_batch_src_global generation:  0.058890342712402344
r_  generation:  0.5032327175140381
local_output_nid generation:  0.030071735382080078
local_in_edges_tensor generation:  0.0326998233795166
mini_batch_src_global generation:  0.059862375259399414
r_  generation:  0.49579358100891113
local_output_nid generation:  0.030908823013305664
local_in_edges_tensor generation:  0.03080582618713379
mini_batch_src_global generation:  0.06075692176818848
r_  generation:  0.5003430843353271
local_output_nid generation:  0.03009486198425293
local_in_edges_tensor generation:  0.02930593490600586
mini_batch_src_global generation:  0.06015729904174805
r_  generation:  0.5005621910095215
local_output_nid generation:  0.029826879501342773
local_in_edges_tensor generation:  0.028465747833251953
mini_batch_src_global generation:  0.058448076248168945
r_  generation:  0.5021264553070068
local_output_nid generation:  0.030402183532714844
local_in_edges_tensor generation:  0.029213666915893555
mini_batch_src_global generation:  0.059884071350097656
r_  generation:  0.5001637935638428
local_output_nid generation:  0.030126094818115234
local_in_edges_tensor generation:  0.03127121925354004
mini_batch_src_global generation:  0.060689449310302734
r_  generation:  0.49829602241516113
local_output_nid generation:  0.029808521270751953
local_in_edges_tensor generation:  0.031751155853271484
mini_batch_src_global generation:  0.0597226619720459
r_  generation:  0.4930553436279297
local_output_nid generation:  0.029674291610717773
local_in_edges_tensor generation:  0.030061006546020508
mini_batch_src_global generation:  0.058286428451538086
r_  generation:  0.5003061294555664
local_output_nid generation:  0.029784440994262695
local_in_edges_tensor generation:  0.038439035415649414
mini_batch_src_global generation:  0.06128382682800293
r_  generation:  0.4935152530670166
local_output_nid generation:  0.0295870304107666
local_in_edges_tensor generation:  0.033535003662109375
mini_batch_src_global generation:  0.05797624588012695
r_  generation:  0.49869275093078613
local_output_nid generation:  0.030005931854248047
local_in_edges_tensor generation:  0.02901911735534668
mini_batch_src_global generation:  0.05963635444641113
r_  generation:  0.5054833889007568
local_output_nid generation:  0.02997279167175293
local_in_edges_tensor generation:  0.030649900436401367
mini_batch_src_global generation:  0.05853676795959473
r_  generation:  0.5007076263427734
local_output_nid generation:  0.03016209602355957
local_in_edges_tensor generation:  0.03213357925415039
mini_batch_src_global generation:  0.06055951118469238
r_  generation:  0.4916987419128418
local_output_nid generation:  0.02984452247619629
local_in_edges_tensor generation:  0.028461933135986328
mini_batch_src_global generation:  0.059064388275146484
r_  generation:  0.5053653717041016
local_output_nid generation:  0.029837846755981445
local_in_edges_tensor generation:  0.029046297073364258
mini_batch_src_global generation:  0.05991649627685547
r_  generation:  0.4955921173095703
local_output_nid generation:  0.030231237411499023
local_in_edges_tensor generation:  0.031659841537475586
mini_batch_src_global generation:  0.06098461151123047
r_  generation:  0.5057802200317383
local_output_nid generation:  0.029781579971313477
local_in_edges_tensor generation:  0.030664443969726562
mini_batch_src_global generation:  0.059865474700927734
r_  generation:  0.494642972946167
local_output_nid generation:  0.029930591583251953
local_in_edges_tensor generation:  0.030173301696777344
mini_batch_src_global generation:  0.06042361259460449
r_  generation:  0.5076186656951904
local_output_nid generation:  0.03009200096130371
local_in_edges_tensor generation:  0.03299403190612793
mini_batch_src_global generation:  0.06190657615661621
r_  generation:  0.5026185512542725
local_output_nid generation:  0.03068852424621582
local_in_edges_tensor generation:  0.028567790985107422
mini_batch_src_global generation:  0.058405399322509766
r_  generation:  0.5044746398925781
local_output_nid generation:  0.030352354049682617
local_in_edges_tensor generation:  0.032887935638427734
mini_batch_src_global generation:  0.06185483932495117
r_  generation:  0.5064728260040283
local_output_nid generation:  0.029929161071777344
local_in_edges_tensor generation:  0.030536651611328125
mini_batch_src_global generation:  0.05867457389831543
r_  generation:  0.5061872005462646
local_output_nid generation:  0.030034780502319336
local_in_edges_tensor generation:  0.029022216796875
mini_batch_src_global generation:  0.059413909912109375
r_  generation:  0.506403923034668
local_output_nid generation:  0.03016972541809082
local_in_edges_tensor generation:  0.028440237045288086
mini_batch_src_global generation:  0.05874896049499512
r_  generation:  0.5013813972473145
local_output_nid generation:  0.030115842819213867
local_in_edges_tensor generation:  0.029128551483154297
mini_batch_src_global generation:  0.05998706817626953
r_  generation:  0.5000975131988525
----------------------check_connections_block total spend ----------------------------- 23.327390909194946
generate_one_block  0.6864686012268066
generate_one_block  0.6790566444396973
generate_one_block  0.6696438789367676
generate_one_block  0.6760482788085938
generate_one_block  0.7692022323608398
generate_one_block  0.6735856533050537
generate_one_block  0.6954123973846436
generate_one_block  0.6796801090240479
generate_one_block  0.683189868927002
generate_one_block  0.6835505962371826
generate_one_block  0.6774115562438965
generate_one_block  0.679832935333252
generate_one_block  0.6732602119445801
generate_one_block  0.6810734272003174
generate_one_block  0.6699020862579346
generate_one_block  0.68045973777771
generate_one_block  0.6748385429382324
generate_one_block  0.6884720325469971
generate_one_block  0.6848459243774414
generate_one_block  0.6692249774932861
generate_one_block  0.6822407245635986
generate_one_block  0.6666126251220703
generate_one_block  0.6998536586761475
generate_one_block  0.6666049957275391
generate_one_block  0.6949644088745117
generate_one_block  0.6878974437713623
generate_one_block  0.685985803604126
generate_one_block  0.6871881484985352
generate_one_block  0.6708905696868896
generate_one_block  0.6781558990478516
generate_one_block  0.6729552745819092
generate_one_block  0.6735329627990723
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.13053131103515625  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

connection checking time:  31.85695481300354
block generation total time  29.811827182769775
average batch blocks generation time:  0.9316195994615555
block dataloader generation time/epoch 66.14268293976784
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10935354232788086  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.19398832321167  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10935258865356445  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.952657222747803  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10895729064941406  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.45996332168579  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10952138900756836  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.00739336013794  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10914802551269531  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.639809131622314  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10916376113891602  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.475158214569092  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10980224609375  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.338480472564697  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10932636260986328  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.97705841064453  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10949134826660156  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.017212390899658  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1095876693725586  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.264856815338135  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1090097427368164  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.562201976776123  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1094980239868164  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.163463592529297  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10930013656616211  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.67303466796875  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10907173156738281  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.779632091522217  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10912084579467773  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.510873794555664  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10918569564819336  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.69592571258545  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10882997512817383  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.68350839614868  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10925054550170898  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.86958885192871  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10924720764160156  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.738581657409668  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10927534103393555  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.826273918151855  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10918188095092773  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.91675567626953  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10895347595214844  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.796874523162842  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10929250717163086  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.82921028137207  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10883188247680664  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.2786922454834  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1091756820678711  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.69951868057251  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10935735702514648  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.933082580566406  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10945367813110352  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.849453449249268  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10943269729614258  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.09873628616333  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10911703109741211  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.483381748199463  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10914850234985352  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.62434673309326  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10889148712158203  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.633134841918945  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1091775894165039  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.683146476745605  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02771882712841034 |0.020761974155902863 |0.6293956115841866 |9.728223085403442e-05 |1.1910183057188988 |0.0054128170013427734 |
----------------------------------------------------------pseudo_mini_loss sum 1.4390345811843872
Total (block generation + training)time/epoch 126.18331012129784
Training time/epoch 59.86820840835571
Training time without block to device /epoch 59.20382523536682
Training time without total dataloading part /epoch 58.2617712020874
load block tensor time/epoch 0.8870024681091309
block to device time/epoch 0.6643831729888916
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  9163624
Number of first layer input nodes during this epoch:  4808382
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.13115310668945312  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026546001434326172
range selection method range initialization spend 0.014232873916625977
time for parepare:  0.019626140594482422
local_output_nid generation:  0.0009610652923583984
local_in_edges_tensor generation:  0.006233692169189453
mini_batch_src_global generation:  0.001379251480102539
r_  generation:  0.010618209838867188
local_output_nid generation:  0.0010471343994140625
local_in_edges_tensor generation:  0.0007107257843017578
mini_batch_src_global generation:  0.0013935565948486328
r_  generation:  0.010750770568847656
local_output_nid generation:  0.0009603500366210938
local_in_edges_tensor generation:  0.0006630420684814453
mini_batch_src_global generation:  0.0011997222900390625
r_  generation:  0.010071277618408203
local_output_nid generation:  0.0009686946868896484
local_in_edges_tensor generation:  0.0006089210510253906
mini_batch_src_global generation:  0.0010824203491210938
r_  generation:  0.00975489616394043
local_output_nid generation:  0.00092315673828125
local_in_edges_tensor generation:  0.0005977153778076172
mini_batch_src_global generation:  0.0012614727020263672
r_  generation:  0.010057687759399414
local_output_nid generation:  0.0009043216705322266
local_in_edges_tensor generation:  0.0006041526794433594
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.010448694229125977
local_output_nid generation:  0.000904083251953125
local_in_edges_tensor generation:  0.0006225109100341797
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.010337114334106445
local_output_nid generation:  0.0009300708770751953
local_in_edges_tensor generation:  0.0005943775177001953
mini_batch_src_global generation:  0.001104593276977539
r_  generation:  0.010383129119873047
local_output_nid generation:  0.0009100437164306641
local_in_edges_tensor generation:  0.0006167888641357422
mini_batch_src_global generation:  0.0011591911315917969
r_  generation:  0.009873390197753906
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0005960464477539062
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.010410070419311523
local_output_nid generation:  0.0008778572082519531
local_in_edges_tensor generation:  0.00063323974609375
mini_batch_src_global generation:  0.001142263412475586
r_  generation:  0.010095357894897461
local_output_nid generation:  0.0008876323699951172
local_in_edges_tensor generation:  0.0005853176116943359
mini_batch_src_global generation:  0.0011749267578125
r_  generation:  0.010189533233642578
local_output_nid generation:  0.0008804798126220703
local_in_edges_tensor generation:  0.0006148815155029297
mini_batch_src_global generation:  0.0011603832244873047
r_  generation:  0.010428905487060547
local_output_nid generation:  0.0008816719055175781
local_in_edges_tensor generation:  0.0005671977996826172
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.010182619094848633
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.0006093978881835938
mini_batch_src_global generation:  0.0011425018310546875
r_  generation:  0.010392427444458008
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.0011720657348632812
r_  generation:  0.010646343231201172
local_output_nid generation:  0.0009093284606933594
local_in_edges_tensor generation:  0.0005733966827392578
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.009990930557250977
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0005900859832763672
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.01008462905883789
local_output_nid generation:  0.00090789794921875
local_in_edges_tensor generation:  0.000614166259765625
mini_batch_src_global generation:  0.0011730194091796875
r_  generation:  0.010360240936279297
local_output_nid generation:  0.0008816719055175781
local_in_edges_tensor generation:  0.0005891323089599609
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.010540962219238281
local_output_nid generation:  0.0008883476257324219
local_in_edges_tensor generation:  0.0006005764007568359
mini_batch_src_global generation:  0.0012624263763427734
r_  generation:  0.010847330093383789
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0005736351013183594
mini_batch_src_global generation:  0.001196146011352539
r_  generation:  0.010384321212768555
local_output_nid generation:  0.0008695125579833984
local_in_edges_tensor generation:  0.0005862712860107422
mini_batch_src_global generation:  0.0011935234069824219
r_  generation:  0.010276556015014648
local_output_nid generation:  0.0008909702301025391
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.001146078109741211
r_  generation:  0.010132789611816406
local_output_nid generation:  0.0008952617645263672
local_in_edges_tensor generation:  0.0005793571472167969
mini_batch_src_global generation:  0.0011398792266845703
r_  generation:  0.010321855545043945
local_output_nid generation:  0.0008869171142578125
local_in_edges_tensor generation:  0.000579833984375
mini_batch_src_global generation:  0.001104593276977539
r_  generation:  0.009941816329956055
local_output_nid generation:  0.0008919239044189453
local_in_edges_tensor generation:  0.000579833984375
mini_batch_src_global generation:  0.0011734962463378906
r_  generation:  0.01068568229675293
local_output_nid generation:  0.0009105205535888672
local_in_edges_tensor generation:  0.0006012916564941406
mini_batch_src_global generation:  0.001211404800415039
r_  generation:  0.010221004486083984
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.010338306427001953
local_output_nid generation:  0.0008981227874755859
local_in_edges_tensor generation:  0.0005824565887451172
mini_batch_src_global generation:  0.001127004623413086
r_  generation:  0.010079383850097656
local_output_nid generation:  0.0008907318115234375
local_in_edges_tensor generation:  0.0005981922149658203
mini_batch_src_global generation:  0.0012629032135009766
r_  generation:  0.011021852493286133
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.000614166259765625
mini_batch_src_global generation:  0.0012316703796386719
r_  generation:  0.010896444320678711
----------------------check_connections_block total spend ----------------------------- 0.5257871150970459
generate_one_block  0.02215099334716797
generate_one_block  0.021549701690673828
generate_one_block  0.020433902740478516
generate_one_block  0.01882028579711914
generate_one_block  0.019445180892944336
generate_one_block  0.019567489624023438
generate_one_block  0.01927781105041504
generate_one_block  0.019368410110473633
generate_one_block  0.018427371978759766
generate_one_block  0.019195556640625
generate_one_block  0.01860499382019043
generate_one_block  0.019081830978393555
generate_one_block  0.019335508346557617
generate_one_block  0.01863861083984375
generate_one_block  0.019252538681030273
generate_one_block  0.019533634185791016
generate_one_block  0.018351078033447266
generate_one_block  0.018809080123901367
generate_one_block  0.019099712371826172
generate_one_block  0.01939678192138672
generate_one_block  0.020044565200805664
generate_one_block  0.01926398277282715
generate_one_block  0.0212709903717041
generate_one_block  0.018983125686645508
generate_one_block  0.01898789405822754
generate_one_block  0.0182497501373291
generate_one_block  0.019446849822998047
generate_one_block  0.018768310546875
generate_one_block  0.01892852783203125
generate_one_block  0.01862478256225586
generate_one_block  0.020200490951538086
generate_one_block  0.019815444946289062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04123520851135254
gen group dst list time:  0.020462989807128906
time for parepare:  0.019862651824951172
local_output_nid generation:  0.0057544708251953125
local_in_edges_tensor generation:  0.01738762855529785
mini_batch_src_global generation:  0.016819477081298828
r_  generation:  0.16352510452270508
local_output_nid generation:  0.007969141006469727
local_in_edges_tensor generation:  0.010890007019042969
mini_batch_src_global generation:  0.02259683609008789
r_  generation:  0.17246103286743164
local_output_nid generation:  0.008359670639038086
local_in_edges_tensor generation:  0.03338217735290527
mini_batch_src_global generation:  0.022235631942749023
r_  generation:  0.18138647079467773
local_output_nid generation:  0.008191823959350586
local_in_edges_tensor generation:  0.008323192596435547
mini_batch_src_global generation:  0.021718263626098633
r_  generation:  0.17319035530090332
local_output_nid generation:  0.008902549743652344
local_in_edges_tensor generation:  0.011690616607666016
mini_batch_src_global generation:  0.023104429244995117
r_  generation:  0.1803302764892578
local_output_nid generation:  0.009080648422241211
local_in_edges_tensor generation:  0.009152889251708984
mini_batch_src_global generation:  0.02402329444885254
r_  generation:  0.18348002433776855
local_output_nid generation:  0.009050846099853516
local_in_edges_tensor generation:  0.00986337661743164
mini_batch_src_global generation:  0.023447751998901367
r_  generation:  0.1773843765258789
local_output_nid generation:  0.008903741836547852
local_in_edges_tensor generation:  0.009059906005859375
mini_batch_src_global generation:  0.023740530014038086
r_  generation:  0.18233346939086914
local_output_nid generation:  0.008472204208374023
local_in_edges_tensor generation:  0.008942127227783203
mini_batch_src_global generation:  0.02270197868347168
r_  generation:  0.175825834274292
local_output_nid generation:  0.009127378463745117
local_in_edges_tensor generation:  0.010132312774658203
mini_batch_src_global generation:  0.02382493019104004
r_  generation:  0.1807878017425537
local_output_nid generation:  0.008768796920776367
local_in_edges_tensor generation:  0.009407997131347656
mini_batch_src_global generation:  0.02283000946044922
r_  generation:  0.17835402488708496
local_output_nid generation:  0.00912332534790039
local_in_edges_tensor generation:  0.009882450103759766
mini_batch_src_global generation:  0.023239850997924805
r_  generation:  0.1792583465576172
local_output_nid generation:  0.009290695190429688
local_in_edges_tensor generation:  0.010388374328613281
mini_batch_src_global generation:  0.02383589744567871
r_  generation:  0.1855483055114746
local_output_nid generation:  0.00905752182006836
local_in_edges_tensor generation:  0.009667634963989258
mini_batch_src_global generation:  0.022774219512939453
r_  generation:  0.17711257934570312
local_output_nid generation:  0.009298324584960938
local_in_edges_tensor generation:  0.009110212326049805
mini_batch_src_global generation:  0.023450851440429688
r_  generation:  0.1849210262298584
local_output_nid generation:  0.009668111801147461
local_in_edges_tensor generation:  0.013946771621704102
mini_batch_src_global generation:  0.028886795043945312
r_  generation:  0.18905210494995117
local_output_nid generation:  0.010000228881835938
local_in_edges_tensor generation:  0.011078357696533203
mini_batch_src_global generation:  0.02256298065185547
r_  generation:  0.17551159858703613
local_output_nid generation:  0.009541511535644531
local_in_edges_tensor generation:  0.00900888442993164
mini_batch_src_global generation:  0.023030519485473633
r_  generation:  0.1816117763519287
local_output_nid generation:  0.009616374969482422
local_in_edges_tensor generation:  0.00916433334350586
mini_batch_src_global generation:  0.023481130599975586
r_  generation:  0.18385052680969238
local_output_nid generation:  0.00960993766784668
local_in_edges_tensor generation:  0.008894920349121094
mini_batch_src_global generation:  0.023827552795410156
r_  generation:  0.18450546264648438
local_output_nid generation:  0.00993204116821289
local_in_edges_tensor generation:  0.01071310043334961
mini_batch_src_global generation:  0.025118112564086914
r_  generation:  0.19455718994140625
local_output_nid generation:  0.010101556777954102
local_in_edges_tensor generation:  0.009130239486694336
mini_batch_src_global generation:  0.024320602416992188
r_  generation:  0.18658447265625
local_output_nid generation:  0.009524822235107422
local_in_edges_tensor generation:  0.009015560150146484
mini_batch_src_global generation:  0.023100852966308594
r_  generation:  0.18104028701782227
local_output_nid generation:  0.009371757507324219
local_in_edges_tensor generation:  0.008908987045288086
mini_batch_src_global generation:  0.02275252342224121
r_  generation:  0.17941737174987793
local_output_nid generation:  0.009491920471191406
local_in_edges_tensor generation:  0.009142637252807617
mini_batch_src_global generation:  0.022809505462646484
r_  generation:  0.18173813819885254
local_output_nid generation:  0.009187459945678711
local_in_edges_tensor generation:  0.009045839309692383
mini_batch_src_global generation:  0.02240276336669922
r_  generation:  0.17634153366088867
local_output_nid generation:  0.009740591049194336
local_in_edges_tensor generation:  0.009245872497558594
mini_batch_src_global generation:  0.023873567581176758
r_  generation:  0.19075751304626465
local_output_nid generation:  0.009461641311645508
local_in_edges_tensor generation:  0.00918269157409668
mini_batch_src_global generation:  0.023093461990356445
r_  generation:  0.1802361011505127
local_output_nid generation:  0.009480953216552734
local_in_edges_tensor generation:  0.009025096893310547
mini_batch_src_global generation:  0.023366928100585938
r_  generation:  0.18318533897399902
local_output_nid generation:  0.009487152099609375
local_in_edges_tensor generation:  0.009029150009155273
mini_batch_src_global generation:  0.023213624954223633
r_  generation:  0.1817481517791748
local_output_nid generation:  0.010043859481811523
local_in_edges_tensor generation:  0.010344743728637695
mini_batch_src_global generation:  0.02580428123474121
r_  generation:  0.19749832153320312
local_output_nid generation:  0.009969234466552734
local_in_edges_tensor generation:  0.010074615478515625
mini_batch_src_global generation:  0.024327993392944336
r_  generation:  0.19236278533935547
----------------------check_connections_block total spend ----------------------------- 8.540726661682129
generate_one_block  0.2436676025390625
generate_one_block  0.24665236473083496
generate_one_block  0.25812363624572754
generate_one_block  0.2425377368927002
generate_one_block  0.26888275146484375
generate_one_block  0.25679588317871094
generate_one_block  0.2435309886932373
generate_one_block  0.24969077110290527
generate_one_block  0.24187254905700684
generate_one_block  0.24719929695129395
generate_one_block  0.2475144863128662
generate_one_block  0.2453291416168213
generate_one_block  0.25215673446655273
generate_one_block  0.2392280101776123
generate_one_block  0.2526357173919678
generate_one_block  0.25681352615356445
generate_one_block  0.23507022857666016
generate_one_block  0.24783086776733398
generate_one_block  0.2496800422668457
generate_one_block  0.2560579776763916
generate_one_block  0.26277613639831543
generate_one_block  0.2531397342681885
generate_one_block  0.24328398704528809
generate_one_block  0.24128341674804688
generate_one_block  0.24233222007751465
generate_one_block  0.23543190956115723
generate_one_block  0.25537562370300293
generate_one_block  0.24138569831848145
generate_one_block  0.24706721305847168
generate_one_block  0.2442166805267334
generate_one_block  0.2679448127746582
generate_one_block  0.25847625732421875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034448862075805664
gen group dst list time:  0.1085805892944336
time for parepare:  0.017996549606323242
local_output_nid generation:  0.024686813354492188
local_in_edges_tensor generation:  0.05179476737976074
mini_batch_src_global generation:  0.047141075134277344
r_  generation:  0.4888124465942383
local_output_nid generation:  0.03050827980041504
local_in_edges_tensor generation:  0.03813958168029785
mini_batch_src_global generation:  0.05907583236694336
r_  generation:  0.4898684024810791
local_output_nid generation:  0.030922412872314453
local_in_edges_tensor generation:  0.03660249710083008
mini_batch_src_global generation:  0.05811667442321777
r_  generation:  0.500950813293457
local_output_nid generation:  0.030920743942260742
local_in_edges_tensor generation:  0.038207054138183594
mini_batch_src_global generation:  0.060398101806640625
r_  generation:  0.4939141273498535
local_output_nid generation:  0.031145811080932617
local_in_edges_tensor generation:  0.03218865394592285
mini_batch_src_global generation:  0.05863356590270996
r_  generation:  0.5044021606445312
local_output_nid generation:  0.03135848045349121
local_in_edges_tensor generation:  0.030073165893554688
mini_batch_src_global generation:  0.05942058563232422
r_  generation:  0.49935150146484375
local_output_nid generation:  0.029880762100219727
local_in_edges_tensor generation:  0.03499865531921387
mini_batch_src_global generation:  0.05829501152038574
r_  generation:  0.4989757537841797
local_output_nid generation:  0.029394865036010742
local_in_edges_tensor generation:  0.03102898597717285
mini_batch_src_global generation:  0.05975675582885742
r_  generation:  0.4979228973388672
local_output_nid generation:  0.02930593490600586
local_in_edges_tensor generation:  0.030885934829711914
mini_batch_src_global generation:  0.05845022201538086
r_  generation:  0.5001554489135742
local_output_nid generation:  0.029756784439086914
local_in_edges_tensor generation:  0.0316929817199707
mini_batch_src_global generation:  0.059403181076049805
r_  generation:  0.4998657703399658
local_output_nid generation:  0.02945542335510254
local_in_edges_tensor generation:  0.030915021896362305
mini_batch_src_global generation:  0.06034111976623535
r_  generation:  0.49883008003234863
local_output_nid generation:  0.029239892959594727
local_in_edges_tensor generation:  0.03056502342224121
mini_batch_src_global generation:  0.059525251388549805
r_  generation:  0.49135637283325195
local_output_nid generation:  0.029643535614013672
local_in_edges_tensor generation:  0.03701448440551758
mini_batch_src_global generation:  0.058794498443603516
r_  generation:  0.5030574798583984
local_output_nid generation:  0.029316425323486328
local_in_edges_tensor generation:  0.030649185180664062
mini_batch_src_global generation:  0.05924034118652344
r_  generation:  0.49073076248168945
local_output_nid generation:  0.029328346252441406
local_in_edges_tensor generation:  0.031073331832885742
mini_batch_src_global generation:  0.05828428268432617
r_  generation:  0.5001375675201416
local_output_nid generation:  0.029774188995361328
local_in_edges_tensor generation:  0.033804893493652344
mini_batch_src_global generation:  0.05945301055908203
r_  generation:  0.4968390464782715
local_output_nid generation:  0.02956533432006836
local_in_edges_tensor generation:  0.030865192413330078
mini_batch_src_global generation:  0.05830860137939453
r_  generation:  0.49608492851257324
local_output_nid generation:  0.029578685760498047
local_in_edges_tensor generation:  0.03149700164794922
mini_batch_src_global generation:  0.06380271911621094
r_  generation:  0.4961578845977783
local_output_nid generation:  0.029802322387695312
local_in_edges_tensor generation:  0.0336458683013916
mini_batch_src_global generation:  0.05890655517578125
r_  generation:  0.5025181770324707
local_output_nid generation:  0.029989242553710938
local_in_edges_tensor generation:  0.03247666358947754
mini_batch_src_global generation:  0.059937238693237305
r_  generation:  0.5008468627929688
local_output_nid generation:  0.029956340789794922
local_in_edges_tensor generation:  0.035860538482666016
mini_batch_src_global generation:  0.05866408348083496
r_  generation:  0.5039305686950684
local_output_nid generation:  0.030301809310913086
local_in_edges_tensor generation:  0.03238320350646973
mini_batch_src_global generation:  0.059682607650756836
r_  generation:  0.5033149719238281
local_output_nid generation:  0.029642105102539062
local_in_edges_tensor generation:  0.034462928771972656
mini_batch_src_global generation:  0.05930900573730469
r_  generation:  0.503065824508667
local_output_nid generation:  0.029552221298217773
local_in_edges_tensor generation:  0.029875516891479492
mini_batch_src_global generation:  0.061481475830078125
r_  generation:  0.4989817142486572
local_output_nid generation:  0.03075885772705078
local_in_edges_tensor generation:  0.03157401084899902
mini_batch_src_global generation:  0.058141469955444336
r_  generation:  0.5017185211181641
local_output_nid generation:  0.029428958892822266
local_in_edges_tensor generation:  0.030449390411376953
mini_batch_src_global generation:  0.059255361557006836
r_  generation:  0.4989047050476074
local_output_nid generation:  0.029683589935302734
local_in_edges_tensor generation:  0.032543182373046875
mini_batch_src_global generation:  0.060831546783447266
r_  generation:  0.5032050609588623
local_output_nid generation:  0.029373884201049805
local_in_edges_tensor generation:  0.031759023666381836
mini_batch_src_global generation:  0.059233665466308594
r_  generation:  0.49953246116638184
local_output_nid generation:  0.03152942657470703
local_in_edges_tensor generation:  0.030145883560180664
mini_batch_src_global generation:  0.05839681625366211
r_  generation:  0.4999668598175049
local_output_nid generation:  0.02983236312866211
local_in_edges_tensor generation:  0.0324704647064209
mini_batch_src_global generation:  0.059499502182006836
r_  generation:  0.5004458427429199
local_output_nid generation:  0.029737472534179688
local_in_edges_tensor generation:  0.032201528549194336
mini_batch_src_global generation:  0.06112074851989746
r_  generation:  0.5081510543823242
local_output_nid generation:  0.029912233352661133
local_in_edges_tensor generation:  0.03429889678955078
mini_batch_src_global generation:  0.06040048599243164
r_  generation:  0.5068526268005371
----------------------check_connections_block total spend ----------------------------- 23.374038219451904
generate_one_block  0.683283805847168
generate_one_block  0.6848840713500977
generate_one_block  0.6797647476196289
generate_one_block  0.6796784400939941
generate_one_block  0.7693948745727539
generate_one_block  0.6949512958526611
generate_one_block  0.6962835788726807
generate_one_block  0.6845836639404297
generate_one_block  0.6688847541809082
generate_one_block  0.6829054355621338
generate_one_block  0.6726093292236328
generate_one_block  0.6710882186889648
generate_one_block  0.6890702247619629
generate_one_block  0.6760103702545166
generate_one_block  0.6781234741210938
generate_one_block  0.6843125820159912
generate_one_block  0.6780762672424316
generate_one_block  0.682227373123169
generate_one_block  0.6879594326019287
generate_one_block  0.6749863624572754
generate_one_block  0.681920051574707
generate_one_block  0.686276912689209
generate_one_block  0.6722478866577148
generate_one_block  0.6793477535247803
generate_one_block  0.7036569118499756
generate_one_block  0.6797196865081787
generate_one_block  0.6772100925445557
generate_one_block  0.676396369934082
generate_one_block  0.6786715984344482
generate_one_block  0.678713321685791
generate_one_block  0.6964030265808105
generate_one_block  0.6925363540649414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.13115310668945312  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

connection checking time:  31.914764881134033
block generation total time  29.896162271499634
average batch blocks generation time:  0.9342550709843636
block dataloader generation time/epoch 66.06761757532756
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10963869094848633  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.634775161743164  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10909414291381836  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.741061687469482  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10960817337036133  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.112360954284668  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10886907577514648  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.540807247161865  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10923194885253906  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.865000247955322  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10945272445678711  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.10264301300049  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10896921157836914  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.588682651519775  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.109222412109375  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.91269874572754  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10886240005493164  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.451523303985596  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1095423698425293  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.79656744003296  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10906839370727539  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.514505863189697  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10888195037841797  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.6072359085083  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10927057266235352  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.00994300842285  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10907363891601562  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.381492614746094  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.1091165542602539  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.96262216567993  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10938549041748047  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.12398052215576  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10894918441772461  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.27641010284424  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10939407348632812  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.763031005859375  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10933256149291992  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.91666841506958  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10943269729614258  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.88023042678833  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10974359512329102  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.338936805725098  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10946512222290039  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.958569049835205  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10890865325927734  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.585389614105225  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10896015167236328  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.521718502044678  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10910654067993164  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.63602066040039  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10868453979492188  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.245746612548828  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10957050323486328  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.06471586227417  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10901880264282227  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.511841297149658  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10909175872802734  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.65572214126587  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10891532897949219  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 20.53834581375122  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 0.10990428924560547  GigaBytes
Max Memory Allocated: 21.560779094696045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4744873046875 GB
    Memory Allocated: 21.564777851104736  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4471435546875 GB
    Memory Allocated: 0.1093134880065918  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9256591796875 GB
    Memory Allocated: 21.147254467010498  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02684832364320755 |0.02052558958530426 |0.6324532851576805 |9.885430335998535e-05 |1.1961903348565102 |0.0029516220092773438 |
----------------------------------------------------------pseudo_mini_loss sum 1.4179807901382446
Total (block generation + training)time/epoch 126.11540998352899
Training time/epoch 60.10484194755554
Training time without block to device /epoch 59.448023080825806
Training time without total dataloading part /epoch 58.5227108001709
load block tensor time/epoch 0.8591463565826416
block to device time/epoch 0.6568188667297363
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  9164548
Number of first layer input nodes during this epoch:  4807860
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 0.13242864608764648  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025835514068603516
range selection method range initialization spend 0.014604806900024414
time for parepare:  0.021318912506103516
local_output_nid generation:  0.0011382102966308594
local_in_edges_tensor generation:  0.006803750991821289
mini_batch_src_global generation:  0.0018992424011230469
r_  generation:  0.011307716369628906
local_output_nid generation:  0.0009970664978027344
local_in_edges_tensor generation:  0.0007793903350830078
mini_batch_src_global generation:  0.0016341209411621094
r_  generation:  0.011001348495483398
local_output_nid generation:  0.0009329319000244141
local_in_edges_tensor generation:  0.0007035732269287109
mini_batch_src_global generation:  0.0011959075927734375
r_  generation:  0.010349273681640625
local_output_nid generation:  0.0009236335754394531
local_in_edges_tensor generation:  0.0006361007690429688
mini_batch_src_global generation:  0.0011250972747802734
r_  generation:  0.009860038757324219
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0007016658782958984
mini_batch_src_global generation:  0.0011069774627685547
r_  generation:  0.009954452514648438
local_output_nid generation:  0.0008974075317382812
local_in_edges_tensor generation:  0.0006694793701171875
mini_batch_src_global generation:  0.0011496543884277344
r_  generation:  0.010360002517700195
local_output_nid generation:  0.0008807182312011719
local_in_edges_tensor generation:  0.0006678104400634766
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.010509252548217773
local_output_nid generation:  0.0009071826934814453
local_in_edges_tensor generation:  0.0006210803985595703
mini_batch_src_global generation:  0.0012097358703613281
r_  generation:  0.010731220245361328
local_output_nid generation:  0.0008895397186279297
local_in_edges_tensor generation:  0.0007073879241943359
mini_batch_src_global generation:  0.0012357234954833984
r_  generation:  0.01027679443359375
local_output_nid generation:  0.000888824462890625
local_in_edges_tensor generation:  0.0006122589111328125
mini_batch_src_global generation:  0.0011661052703857422
r_  generation:  0.010568380355834961
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0006587505340576172
mini_batch_src_global generation:  0.0011849403381347656
r_  generation:  0.010076045989990234
local_output_nid generation:  0.0008823871612548828
local_in_edges_tensor generation:  0.0005886554718017578
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.010497331619262695
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0006575584411621094
mini_batch_src_global generation:  0.001176595687866211
r_  generation:  0.010509014129638672
local_output_nid generation:  0.0008890628814697266
local_in_edges_tensor generation:  0.0006022453308105469
mini_batch_src_global generation:  0.001178741455078125
r_  generation:  0.010207891464233398
local_output_nid generation:  0.0008802413940429688
local_in_edges_tensor generation:  0.00060272216796875
mini_batch_src_global generation:  0.0011773109436035156
r_  generation:  0.010559797286987305
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0006203651428222656
mini_batch_src_global generation:  0.0012066364288330078
r_  generation:  0.010535478591918945
local_output_nid generation:  0.0008845329284667969
local_in_edges_tensor generation:  0.0006146430969238281
mini_batch_src_global generation:  0.001154184341430664
r_  generation:  0.010441780090332031
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0005953311920166016
mini_batch_src_global generation:  0.0011775493621826172
r_  generation:  0.00993657112121582
local_output_nid generation:  0.0008969306945800781
local_in_edges_tensor generation:  0.0006306171417236328
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.00985264778137207
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0006396770477294922
mini_batch_src_global generation:  0.0011641979217529297
r_  generation:  0.010304927825927734
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0006029605865478516
mini_batch_src_global generation:  0.0011823177337646484
r_  generation:  0.010208845138549805
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0006132125854492188
mini_batch_src_global generation:  0.0011904239654541016
r_  generation:  0.010543584823608398
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.00064849853515625
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.010126352310180664
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0006361007690429688
mini_batch_src_global generation:  0.0011725425720214844
r_  generation:  0.010341405868530273
local_output_nid generation:  0.0008819103240966797
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0011966228485107422
r_  generation:  0.010013580322265625
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.000644683837890625
mini_batch_src_global generation:  0.0012149810791015625
r_  generation:  0.010262250900268555
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.0011899471282958984
r_  generation:  0.009895086288452148
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005893707275390625
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.010298013687133789
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0005869865417480469
mini_batch_src_global generation:  0.0011203289031982422
r_  generation:  0.009967565536499023
local_output_nid generation:  0.0008578300476074219
local_in_edges_tensor generation:  0.0005967617034912109
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.010312080383300781
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0006237030029296875
mini_batch_src_global generation:  0.0012583732604980469
r_  generation:  0.010526895523071289
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0006060600280761719
mini_batch_src_global generation:  0.0011746883392333984
r_  generation:  0.010088920593261719
----------------------check_connections_block total spend ----------------------------- 0.5279467105865479
generate_one_block  0.02823185920715332
generate_one_block  0.021368980407714844
generate_one_block  0.019995450973510742
generate_one_block  0.019070148468017578
generate_one_block  0.01895880699157715
generate_one_block  0.01938319206237793
generate_one_block  0.01927971839904785
generate_one_block  0.01982569694519043
generate_one_block  0.019093751907348633
generate_one_block  0.022588491439819336
generate_one_block  0.019845008850097656
generate_one_block  0.019721508026123047
generate_one_block  0.01913762092590332
generate_one_block  0.018768787384033203
generate_one_block  0.019531726837158203
generate_one_block  0.01942586898803711
generate_one_block  0.019003629684448242
generate_one_block  0.018406152725219727
generate_one_block  0.01822638511657715
generate_one_block  0.018893718719482422
generate_one_block  0.018641948699951172
generate_one_block  0.019263505935668945
generate_one_block  0.02085590362548828
generate_one_block  0.019534587860107422
generate_one_block  0.01843404769897461
generate_one_block  0.01892685890197754
generate_one_block  0.01815009117126465
generate_one_block  0.01921534538269043
generate_one_block  0.018193483352661133
generate_one_block  0.019113540649414062
generate_one_block  0.01914525032043457
generate_one_block  0.01877737045288086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03955984115600586
gen group dst list time:  0.024111270904541016
time for parepare:  0.022235393524169922
local_output_nid generation:  0.006160736083984375
local_in_edges_tensor generation:  0.017469167709350586
mini_batch_src_global generation:  0.018438339233398438
r_  generation:  0.17134785652160645
local_output_nid generation:  0.00791621208190918
local_in_edges_tensor generation:  0.011019468307495117
mini_batch_src_global generation:  0.022907018661499023
r_  generation:  0.1746666431427002
local_output_nid generation:  0.008299827575683594
local_in_edges_tensor generation:  0.10321974754333496
mini_batch_src_global generation:  0.0213320255279541
r_  generation:  0.17483901977539062
local_output_nid generation:  0.008307218551635742
local_in_edges_tensor generation:  0.008427858352661133
mini_batch_src_global generation:  0.022192955017089844
r_  generation:  0.17830228805541992
local_output_nid generation:  0.008728981018066406
local_in_edges_tensor generation:  0.010590076446533203
mini_batch_src_global generation:  0.022051095962524414
r_  generation:  0.17710041999816895
local_output_nid generation:  0.008898258209228516
local_in_edges_tensor generation:  0.009241819381713867
mini_batch_src_global generation:  0.023189306259155273
r_  generation:  0.18131589889526367
local_output_nid generation:  0.008881807327270508
local_in_edges_tensor generation:  0.009608745574951172
mini_batch_src_global generation:  0.023096561431884766
r_  generation:  0.1823136806488037
local_output_nid generation:  0.008958816528320312
local_in_edges_tensor generation:  0.012063026428222656
mini_batch_src_global generation:  0.024813413619995117
r_  generation:  0.18757033348083496
local_output_nid generation:  0.008859872817993164
local_in_edges_tensor generation:  0.008776664733886719
mini_batch_src_global generation:  0.023989200592041016
r_  generation:  0.18524456024169922
local_output_nid generation:  0.00924825668334961
local_in_edges_tensor generation:  0.00882267951965332
mini_batch_src_global generation:  0.02359318733215332
r_  generation:  0.1879720687866211
local_output_nid generation:  0.008925437927246094
local_in_edges_tensor generation:  0.011361360549926758
mini_batch_src_global generation:  0.023288488388061523
r_  generation:  0.17561817169189453
local_output_nid generation:  0.009396791458129883
local_in_edges_tensor generation:  0.009129047393798828
mini_batch_src_global generation:  0.02350616455078125
r_  generation:  0.1815342903137207
local_output_nid generation:  0.009172916412353516
local_in_edges_tensor generation:  0.009262561798095703
mini_batch_src_global generation:  0.02363443374633789
r_  generation:  0.18498611450195312
local_output_nid generation:  0.009142160415649414
local_in_edges_tensor generation:  0.009047985076904297
mini_batch_src_global generation:  0.023754358291625977
r_  generation:  0.18111109733581543
local_output_nid generation:  0.009395599365234375
local_in_edges_tensor generation:  0.00904989242553711
mini_batch_src_global generation:  0.02374577522277832
r_  generation:  0.18851971626281738
local_output_nid generation:  0.009231090545654297
local_in_edges_tensor generation:  0.009506940841674805
mini_batch_src_global generation:  0.023470640182495117
r_  generation:  0.18737244606018066
local_output_nid generation:  0.00931239128112793
local_in_edges_tensor generation:  0.009759664535522461
mini_batch_src_global generation:  0.024287700653076172
r_  generation:  0.18900060653686523
local_output_nid generation:  0.009065628051757812
local_in_edges_tensor generation:  0.010097503662109375
mini_batch_src_global generation:  0.023862123489379883
r_  generation:  0.17892050743103027
local_output_nid generation:  0.009044408798217773
local_in_edges_tensor generation:  0.010043144226074219
mini_batch_src_global generation:  0.02211785316467285
r_  generation:  0.17695355415344238
local_output_nid generation:  0.009350299835205078
local_in_edges_tensor generation:  0.009832143783569336
mini_batch_src_global generation:  0.023036479949951172
r_  generation:  0.18361139297485352
local_output_nid generation:  0.009327411651611328
local_in_edges_tensor generation:  0.008936882019042969
mini_batch_src_global generation:  0.022565364837646484
r_  generation:  0.1794726848602295
local_output_nid generation:  0.009433984756469727
local_in_edges_tensor generation:  0.009186029434204102
mini_batch_src_global generation:  0.023838043212890625
r_  generation:  0.19086265563964844
local_output_nid generation:  0.009208440780639648
local_in_edges_tensor generation:  0.009783506393432617
mini_batch_src_global generation:  0.022518396377563477
r_  generation:  0.18013739585876465
local_output_nid generation:  0.009421586990356445
local_in_edges_tensor generation:  0.009327411651611328
mini_batch_src_global generation:  0.023553133010864258
r_  generation:  0.18618273735046387
local_output_nid generation:  0.009164571762084961
local_in_edges_tensor generation:  0.008766651153564453
mini_batch_src_global generation:  0.023096799850463867
r_  generation:  0.17825961112976074
local_output_nid generation:  0.009351968765258789
local_in_edges_tensor generation:  0.009849309921264648
mini_batch_src_global generation:  0.023116588592529297
r_  generation:  0.18465447425842285
local_output_nid generation:  0.00899505615234375
local_in_edges_tensor generation:  0.008912324905395508
mini_batch_src_global generation:  0.0235595703125
r_  generation:  0.1780991554260254
local_output_nid generation:  0.009527206420898438
local_in_edges_tensor generation:  0.009106636047363281
mini_batch_src_global generation:  0.024410009384155273
r_  generation:  0.192002534866333
local_output_nid generation:  0.009003400802612305
local_in_edges_tensor generation:  0.009494304656982422
mini_batch_src_global generation:  0.023034095764160156
r_  generation:  0.17958641052246094
local_output_nid generation:  0.009443044662475586
local_in_edges_tensor generation:  0.009311199188232422
mini_batch_src_global generation:  0.023174524307250977
r_  generation:  0.18376779556274414
local_output_nid generation:  0.009358644485473633
local_in_edges_tensor generation:  0.011422872543334961
mini_batch_src_global generation:  0.024136066436767578
r_  generation:  0.18703675270080566
local_output_nid generation:  0.009214639663696289
local_in_edges_tensor generation:  0.009338617324829102
mini_batch_src_global generation:  0.023311138153076172
r_  generation:  0.18543481826782227
----------------------check_connections_block total spend ----------------------------- 8.619752407073975
generate_one_block  0.25290775299072266
generate_one_block  0.250058650970459
generate_one_block  0.2621304988861084
generate_one_block  0.24698758125305176
generate_one_block  0.2457408905029297
generate_one_block  0.25354909896850586
generate_one_block  0.2482459545135498
generate_one_block  0.25989866256713867
generate_one_block  0.2556633949279785
generate_one_block  0.25086212158203125
generate_one_block  0.23953819274902344
generate_one_block  0.24748778343200684
generate_one_block  0.2593200206756592
generate_one_block  0.24844098091125488
generate_one_block  0.25337719917297363
generate_one_block  0.25099873542785645
generate_one_block  0.25289273262023926
generate_one_block  0.2429180145263672
generate_one_block  0.23572015762329102
generate_one_block  0.24516534805297852
generate_one_block  0.24131155014038086
generate_one_block  0.2543797492980957
generate_one_block  0.23947954177856445
generate_one_block  0.2517714500427246
generate_one_block  0.23756957054138184
generate_one_block  0.25046753883361816
generate_one_block  0.24604392051696777
generate_one_block  0.2581214904785156
generate_one_block  0.24198555946350098
generate_one_block  0.24895548820495605
generate_one_block  0.2541923522949219
generate_one_block  0.25174570083618164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03606462478637695
gen group dst list time:  0.10893797874450684
time for parepare:  0.018193960189819336
local_output_nid generation:  0.025455713272094727
local_in_edges_tensor generation:  0.05132031440734863
mini_batch_src_global generation:  0.051168203353881836
r_  generation:  0.49223899841308594
local_output_nid generation:  0.03181338310241699
local_in_edges_tensor generation:  0.037163496017456055
mini_batch_src_global generation:  0.05938243865966797
r_  generation:  0.4829418659210205
local_output_nid generation:  0.03129172325134277
local_in_edges_tensor generation:  0.03191852569580078
mini_batch_src_global generation:  0.05985260009765625
r_  generation:  0.5015833377838135
local_output_nid generation:  0.031156539916992188
local_in_edges_tensor generation:  0.031580448150634766
mini_batch_src_global generation:  0.059313058853149414
r_  generation:  0.4919776916503906
local_output_nid generation:  0.030711650848388672
local_in_edges_tensor generation:  0.02957463264465332
mini_batch_src_global generation:  0.05882072448730469
r_  generation:  0.4978475570678711
local_output_nid generation:  0.031193971633911133
local_in_edges_tensor generation:  0.030253887176513672
mini_batch_src_global generation:  0.05972027778625488
r_  generation:  0.4916667938232422
local_output_nid generation:  0.03045511245727539
local_in_edges_tensor generation:  0.03103160858154297
mini_batch_src_global generation:  0.061380624771118164
r_  generation:  0.5007889270782471
local_output_nid generation:  0.030219316482543945
local_in_edges_tensor generation:  0.0332794189453125
mini_batch_src_global generation:  0.060660600662231445
r_  generation:  0.49724578857421875
local_output_nid generation:  0.02987980842590332
local_in_edges_tensor generation:  0.03138613700866699
mini_batch_src_global generation:  0.05948638916015625
r_  generation:  0.4997260570526123
local_output_nid generation:  0.02992725372314453
local_in_edges_tensor generation:  0.10895252227783203
mini_batch_src_global generation:  0.05983614921569824
r_  generation:  0.4952235221862793
local_output_nid generation:  0.029068470001220703
local_in_edges_tensor generation:  0.03027033805847168
mini_batch_src_global generation:  0.05894780158996582
r_  generation:  0.49965906143188477
local_output_nid generation:  0.029648303985595703
local_in_edges_tensor generation:  0.02939891815185547
mini_batch_src_global generation:  0.0604090690612793
r_  generation:  0.4960925579071045
local_output_nid generation:  0.029383420944213867
local_in_edges_tensor generation:  0.031087398529052734
mini_batch_src_global generation:  0.06121397018432617
r_  generation:  0.5009012222290039
local_output_nid generation:  0.029543638229370117
local_in_edges_tensor generation:  0.028856754302978516
mini_batch_src_global generation:  0.06216168403625488
r_  generation:  0.49707841873168945
local_output_nid generation:  0.029803991317749023
local_in_edges_tensor generation:  0.03238630294799805
mini_batch_src_global generation:  0.05937361717224121
r_  generation:  0.5018150806427002
local_output_nid generation:  0.02949357032775879
local_in_edges_tensor generation:  0.03043675422668457
mini_batch_src_global generation:  0.060941219329833984
r_  generation:  0.4913320541381836
local_output_nid generation:  0.02933526039123535
local_in_edges_tensor generation:  0.028957366943359375
mini_batch_src_global generation:  0.061238765716552734
r_  generation:  0.501819372177124
local_output_nid generation:  0.02967691421508789
local_in_edges_tensor generation:  0.029343605041503906
mini_batch_src_global generation:  0.06110405921936035
r_  generation:  0.5020313262939453
local_output_nid generation:  0.02969837188720703
local_in_edges_tensor generation:  0.0300750732421875
mini_batch_src_global generation:  0.05893754959106445
r_  generation:  0.49657177925109863
local_output_nid generation:  0.029436588287353516
local_in_edges_tensor generation:  0.028455018997192383
mini_batch_src_global generation:  0.06121039390563965
r_  generation:  0.49188852310180664
local_output_nid generation:  0.029181957244873047
local_in_edges_tensor generation:  0.02948784828186035
mini_batch_src_global generation:  0.058632850646972656
r_  generation:  0.4962158203125
local_output_nid generation:  0.029465198516845703
local_in_edges_tensor generation:  0.030931711196899414
mini_batch_src_global generation:  0.0597078800201416
r_  generation:  0.4949624538421631
local_output_nid generation:  0.02940845489501953
local_in_edges_tensor generation:  0.031561851501464844
mini_batch_src_global generation:  0.05836749076843262
r_  generation:  0.49703359603881836
local_output_nid generation:  0.02991485595703125
local_in_edges_tensor generation:  0.03310799598693848
mini_batch_src_global generation:  0.060500144958496094
r_  generation:  0.5008533000946045
local_output_nid generation:  0.029231786727905273
local_in_edges_tensor generation:  0.028896331787109375
mini_batch_src_global generation:  0.05932807922363281
r_  generation:  0.5021321773529053
local_output_nid generation:  0.029438257217407227
local_in_edges_tensor generation:  0.030860185623168945
mini_batch_src_global generation:  0.06014752388000488
r_  generation:  0.4987053871154785
local_output_nid generation:  0.02930736541748047
local_in_edges_tensor generation:  0.03120589256286621
mini_batch_src_global generation:  0.058837175369262695
r_  generation:  0.5014262199401855
local_output_nid generation:  0.02952098846435547
local_in_edges_tensor generation:  0.03138160705566406
mini_batch_src_global generation:  0.06062746047973633
r_  generation:  0.5061416625976562
local_output_nid generation:  0.02936387062072754
local_in_edges_tensor generation:  0.03104996681213379
mini_batch_src_global generation:  0.05833101272583008
r_  generation:  0.5016348361968994
local_output_nid generation:  0.029308557510375977
local_in_edges_tensor generation:  0.030612468719482422
mini_batch_src_global generation:  0.05967283248901367
r_  generation:  0.4969160556793213
local_output_nid generation:  0.029731035232543945
local_in_edges_tensor generation:  0.03156614303588867
mini_batch_src_global generation:  0.06129813194274902
r_  generation:  0.5044167041778564
local_output_nid generation:  0.029760122299194336
local_in_edges_tensor generation:  0.030906200408935547
mini_batch_src_global generation:  0.06076812744140625
r_  generation:  0.49957776069641113
----------------------check_connections_block total spend ----------------------------- 23.401174068450928
generate_one_block  0.680046796798706
generate_one_block  0.6709747314453125
generate_one_block  0.6776361465454102
generate_one_block  0.6759004592895508
generate_one_block  0.6694042682647705
generate_one_block  0.6734724044799805
generate_one_block  0.7203092575073242
generate_one_block  0.6821455955505371
generate_one_block  0.681551456451416
generate_one_block  0.6783702373504639
generate_one_block  0.6869368553161621
generate_one_block  0.676206111907959
generate_one_block  0.678952693939209
generate_one_block  0.6803691387176514
generate_one_block  0.6796817779541016
generate_one_block  0.6734569072723389
generate_one_block  0.6774582862854004
generate_one_block  0.6712403297424316
generate_one_block  0.6703121662139893
generate_one_block  0.6764092445373535
generate_one_block  0.6771564483642578
generate_one_block  0.6793320178985596
generate_one_block  0.6755504608154297
generate_one_block  0.6892564296722412
generate_one_block  0.6724720001220703
generate_one_block  0.6782455444335938
generate_one_block  0.6740720272064209
generate_one_block  0.6909263134002686
generate_one_block  0.6754913330078125
generate_one_block  0.6798727512359619
generate_one_block  0.6867222785949707
generate_one_block  0.6994044780731201
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 0.13242864608764648  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

connection checking time:  32.0209264755249
block generation total time  29.73726463317871
average batch blocks generation time:  0.9292895197868347
block dataloader generation time/epoch 65.9988131761551
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 0.10960006713867188  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 21.012919902801514  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 0.10928964614868164  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 20.768224716186523  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 0.1093602180480957  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 20.820518970489502  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 0.10955667495727539  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 20.81205654144287  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 0.10907888412475586  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 20.641668796539307  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9295654296875 GB
    Memory Allocated: 0.10901832580566406  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9530029296875 GB
    Memory Allocated: 20.902679920196533  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9549560546875 GB
    Memory Allocated: 0.10914468765258789  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9549560546875 GB
    Memory Allocated: 20.854361057281494  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9549560546875 GB
    Memory Allocated: 0.10975456237792969  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 21.26645803451538  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 0.10934066772460938  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 21.017693042755127  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 0.10938215255737305  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 20.998584747314453  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 0.10877561569213867  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 20.398637294769287  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 0.10947704315185547  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 20.8281831741333  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 0.10926055908203125  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 20.937138557434082  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 0.10919857025146484  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 20.761415481567383  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 0.10950660705566406  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 20.962655067443848  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 0.10900497436523438  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0916748046875 GB
    Memory Allocated: 20.85073471069336  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.1090402603149414  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.965828895568848  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.1090703010559082  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.47877788543701  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10912322998046875  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.261674404144287  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10927867889404297  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.683157920837402  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10882711410522461  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.35904359817505  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10937786102294922  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.92783498764038  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10906744003295898  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.341418743133545  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10956907272338867  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.996134281158447  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10882139205932617  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.294548511505127  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.1093587875366211  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.757740020751953  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10899877548217773  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.38380002975464  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10947227478027344  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 21.113131046295166  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10886764526367188  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.453251838684082  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10877227783203125  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.747018337249756  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10968303680419922  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 21.082152843475342  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10921430587768555  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 20.814059734344482  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035713471472263336 |0.02367846667766571 |0.629676565527916 |9.591132402420044e-05 |1.1927432045340538 |0.009173393249511719 |
----------------------------------------------------------pseudo_mini_loss sum 1.3853249549865723
Total (block generation + training)time/epoch 126.07078247070312
Training time/epoch 60.289278507232666
Training time without block to device /epoch 59.53156757354736
Training time without total dataloading part /epoch 58.32967519760132
load block tensor time/epoch 1.1428310871124268
block to device time/epoch 0.7577109336853027
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  9161774
Number of first layer input nodes during this epoch:  4809121
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.13143539428710938  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026901960372924805
range selection method range initialization spend 0.014931440353393555
time for parepare:  0.018976926803588867
local_output_nid generation:  0.0010001659393310547
local_in_edges_tensor generation:  0.004676342010498047
mini_batch_src_global generation:  0.0016934871673583984
r_  generation:  0.010828256607055664
local_output_nid generation:  0.000997781753540039
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.0016565322875976562
r_  generation:  0.011324405670166016
local_output_nid generation:  0.0009362697601318359
local_in_edges_tensor generation:  0.0006582736968994141
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.01000356674194336
local_output_nid generation:  0.0009257793426513672
local_in_edges_tensor generation:  0.0006282329559326172
mini_batch_src_global generation:  0.0011096000671386719
r_  generation:  0.010104656219482422
local_output_nid generation:  0.0008785724639892578
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0011658668518066406
r_  generation:  0.009639501571655273
local_output_nid generation:  0.0009181499481201172
local_in_edges_tensor generation:  0.0006144046783447266
mini_batch_src_global generation:  0.0011060237884521484
r_  generation:  0.010275840759277344
local_output_nid generation:  0.0008797645568847656
local_in_edges_tensor generation:  0.0005867481231689453
mini_batch_src_global generation:  0.001176595687866211
r_  generation:  0.010223388671875
local_output_nid generation:  0.0009305477142333984
local_in_edges_tensor generation:  0.0006208419799804688
mini_batch_src_global generation:  0.0011115074157714844
r_  generation:  0.010126590728759766
local_output_nid generation:  0.0008718967437744141
local_in_edges_tensor generation:  0.0006206035614013672
mini_batch_src_global generation:  0.00121307373046875
r_  generation:  0.010591745376586914
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.0006299018859863281
mini_batch_src_global generation:  0.0012042522430419922
r_  generation:  0.01085972785949707
local_output_nid generation:  0.0009217262268066406
local_in_edges_tensor generation:  0.0006611347198486328
mini_batch_src_global generation:  0.0011949539184570312
r_  generation:  0.010551929473876953
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.0012269020080566406
r_  generation:  0.010690689086914062
local_output_nid generation:  0.0009064674377441406
local_in_edges_tensor generation:  0.0005850791931152344
mini_batch_src_global generation:  0.0012085437774658203
r_  generation:  0.010599136352539062
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.0005838871002197266
mini_batch_src_global generation:  0.0011262893676757812
r_  generation:  0.010505437850952148
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0006265640258789062
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.010237455368041992
local_output_nid generation:  0.0008795261383056641
local_in_edges_tensor generation:  0.0005898475646972656
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.010251998901367188
local_output_nid generation:  0.0008885860443115234
local_in_edges_tensor generation:  0.0005939006805419922
mini_batch_src_global generation:  0.0011775493621826172
r_  generation:  0.010155916213989258
local_output_nid generation:  0.0008459091186523438
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.009567975997924805
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.010175466537475586
local_output_nid generation:  0.0008425712585449219
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.0012025833129882812
r_  generation:  0.01071786880493164
local_output_nid generation:  0.0008614063262939453
local_in_edges_tensor generation:  0.0006084442138671875
mini_batch_src_global generation:  0.001214742660522461
r_  generation:  0.010680437088012695
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005729198455810547
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.010236740112304688
local_output_nid generation:  0.0008525848388671875
local_in_edges_tensor generation:  0.0006132125854492188
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.010132551193237305
local_output_nid generation:  0.0008535385131835938
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0011768341064453125
r_  generation:  0.010369300842285156
local_output_nid generation:  0.0008609294891357422
local_in_edges_tensor generation:  0.0005638599395751953
mini_batch_src_global generation:  0.0011456012725830078
r_  generation:  0.010135412216186523
local_output_nid generation:  0.0008492469787597656
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.0012593269348144531
r_  generation:  0.010552406311035156
local_output_nid generation:  0.0008590221405029297
local_in_edges_tensor generation:  0.0006134510040283203
mini_batch_src_global generation:  0.0012218952178955078
r_  generation:  0.010538339614868164
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0006206035614013672
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.010429620742797852
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0011441707611083984
r_  generation:  0.010063409805297852
local_output_nid generation:  0.0008568763732910156
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.0012052059173583984
r_  generation:  0.010236263275146484
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.01040792465209961
local_output_nid generation:  0.0008840560913085938
local_in_edges_tensor generation:  0.0006089210510253906
mini_batch_src_global generation:  0.0011126995086669922
r_  generation:  0.010127544403076172
----------------------check_connections_block total spend ----------------------------- 0.5220482349395752
generate_one_block  0.025055646896362305
generate_one_block  0.02188587188720703
generate_one_block  0.019399404525756836
generate_one_block  0.01939249038696289
generate_one_block  0.01825857162475586
generate_one_block  0.018943071365356445
generate_one_block  0.018736600875854492
generate_one_block  0.018468856811523438
generate_one_block  0.019494295120239258
generate_one_block  0.01965618133544922
generate_one_block  0.01880788803100586
generate_one_block  0.0211789608001709
generate_one_block  0.019646883010864258
generate_one_block  0.0189056396484375
generate_one_block  0.01840949058532715
generate_one_block  0.018689393997192383
generate_one_block  0.01859426498413086
generate_one_block  0.017417192459106445
generate_one_block  0.018594741821289062
generate_one_block  0.019666194915771484
generate_one_block  0.019411325454711914
generate_one_block  0.01877617835998535
generate_one_block  0.018689632415771484
generate_one_block  0.018803834915161133
generate_one_block  0.018514394760131836
generate_one_block  0.018991708755493164
generate_one_block  0.019046545028686523
generate_one_block  0.018480300903320312
generate_one_block  0.02071857452392578
generate_one_block  0.019115924835205078
generate_one_block  0.01874542236328125
generate_one_block  0.018541812896728516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0382084846496582
gen group dst list time:  0.0232393741607666
time for parepare:  0.022029638290405273
local_output_nid generation:  0.005723714828491211
local_in_edges_tensor generation:  0.01633143424987793
mini_batch_src_global generation:  0.018399953842163086
r_  generation:  0.16517257690429688
local_output_nid generation:  0.008258819580078125
local_in_edges_tensor generation:  0.009971857070922852
mini_batch_src_global generation:  0.023390769958496094
r_  generation:  0.17379522323608398
local_output_nid generation:  0.008039474487304688
local_in_edges_tensor generation:  0.03266310691833496
mini_batch_src_global generation:  0.02182173728942871
r_  generation:  0.17379546165466309
local_output_nid generation:  0.008533239364624023
local_in_edges_tensor generation:  0.010281085968017578
mini_batch_src_global generation:  0.021569490432739258
r_  generation:  0.17615556716918945
local_output_nid generation:  0.00859832763671875
local_in_edges_tensor generation:  0.010961055755615234
mini_batch_src_global generation:  0.022395610809326172
r_  generation:  0.17261695861816406
local_output_nid generation:  0.009057283401489258
local_in_edges_tensor generation:  0.009409904479980469
mini_batch_src_global generation:  0.022509336471557617
r_  generation:  0.18021678924560547
local_output_nid generation:  0.009758472442626953
local_in_edges_tensor generation:  0.00876617431640625
mini_batch_src_global generation:  0.02298736572265625
r_  generation:  0.17924261093139648
local_output_nid generation:  0.008716106414794922
local_in_edges_tensor generation:  0.012062311172485352
mini_batch_src_global generation:  0.023319721221923828
r_  generation:  0.1770927906036377
local_output_nid generation:  0.008964776992797852
local_in_edges_tensor generation:  0.01004934310913086
mini_batch_src_global generation:  0.024454832077026367
r_  generation:  0.1893754005432129
local_output_nid generation:  0.009329795837402344
local_in_edges_tensor generation:  0.012165069580078125
mini_batch_src_global generation:  0.025038957595825195
r_  generation:  0.18804025650024414
local_output_nid generation:  0.008905410766601562
local_in_edges_tensor generation:  0.008904457092285156
mini_batch_src_global generation:  0.023462295532226562
r_  generation:  0.18198013305664062
local_output_nid generation:  0.00930166244506836
local_in_edges_tensor generation:  0.01136326789855957
mini_batch_src_global generation:  0.02427363395690918
r_  generation:  0.19188427925109863
local_output_nid generation:  0.00952458381652832
local_in_edges_tensor generation:  0.011647462844848633
mini_batch_src_global generation:  0.023914098739624023
r_  generation:  0.18442320823669434
local_output_nid generation:  0.009282350540161133
local_in_edges_tensor generation:  0.00916743278503418
mini_batch_src_global generation:  0.023649215698242188
r_  generation:  0.183182954788208
local_output_nid generation:  0.00906515121459961
local_in_edges_tensor generation:  0.011533260345458984
mini_batch_src_global generation:  0.023107051849365234
r_  generation:  0.18123435974121094
local_output_nid generation:  0.009270668029785156
local_in_edges_tensor generation:  0.012021780014038086
mini_batch_src_global generation:  0.023317575454711914
r_  generation:  0.18210625648498535
local_output_nid generation:  0.009379148483276367
local_in_edges_tensor generation:  0.008973360061645508
mini_batch_src_global generation:  0.023832082748413086
r_  generation:  0.18398284912109375
local_output_nid generation:  0.008925199508666992
local_in_edges_tensor generation:  0.009654045104980469
mini_batch_src_global generation:  0.021433353424072266
r_  generation:  0.17148089408874512
local_output_nid generation:  0.009429216384887695
local_in_edges_tensor generation:  0.010040283203125
mini_batch_src_global generation:  0.023167848587036133
r_  generation:  0.18251276016235352
local_output_nid generation:  0.009690523147583008
local_in_edges_tensor generation:  0.010761737823486328
mini_batch_src_global generation:  0.024792194366455078
r_  generation:  0.18974065780639648
local_output_nid generation:  0.009786844253540039
local_in_edges_tensor generation:  0.00956106185913086
mini_batch_src_global generation:  0.024715662002563477
r_  generation:  0.1900312900543213
local_output_nid generation:  0.009318351745605469
local_in_edges_tensor generation:  0.008993148803710938
mini_batch_src_global generation:  0.023341655731201172
r_  generation:  0.1817018985748291
local_output_nid generation:  0.009476900100708008
local_in_edges_tensor generation:  0.009957075119018555
mini_batch_src_global generation:  0.022848129272460938
r_  generation:  0.17936229705810547
local_output_nid generation:  0.009549617767333984
local_in_edges_tensor generation:  0.008755683898925781
mini_batch_src_global generation:  0.023189783096313477
r_  generation:  0.18490147590637207
local_output_nid generation:  0.009369134902954102
local_in_edges_tensor generation:  0.009081840515136719
mini_batch_src_global generation:  0.022730350494384766
r_  generation:  0.17928194999694824
local_output_nid generation:  0.009661436080932617
local_in_edges_tensor generation:  0.009218454360961914
mini_batch_src_global generation:  0.02324199676513672
r_  generation:  0.1860802173614502
local_output_nid generation:  0.009676933288574219
local_in_edges_tensor generation:  0.00913095474243164
mini_batch_src_global generation:  0.023476362228393555
r_  generation:  0.18541884422302246
local_output_nid generation:  0.009348392486572266
local_in_edges_tensor generation:  0.010390281677246094
mini_batch_src_global generation:  0.02295708656311035
r_  generation:  0.17897868156433105
local_output_nid generation:  0.009341955184936523
local_in_edges_tensor generation:  0.009102582931518555
mini_batch_src_global generation:  0.023071765899658203
r_  generation:  0.18300557136535645
local_output_nid generation:  0.009502649307250977
local_in_edges_tensor generation:  0.008981704711914062
mini_batch_src_global generation:  0.02308511734008789
r_  generation:  0.18578672409057617
local_output_nid generation:  0.009244918823242188
local_in_edges_tensor generation:  0.008983612060546875
mini_batch_src_global generation:  0.023221731185913086
r_  generation:  0.1836409568786621
local_output_nid generation:  0.009514808654785156
local_in_edges_tensor generation:  0.008915901184082031
mini_batch_src_global generation:  0.022606849670410156
r_  generation:  0.1845078468322754
----------------------check_connections_block total spend ----------------------------- 8.53620958328247
generate_one_block  0.24794435501098633
generate_one_block  0.25122833251953125
generate_one_block  0.249603271484375
generate_one_block  0.25331783294677734
generate_one_block  0.2564201354980469
generate_one_block  0.24591350555419922
generate_one_block  0.249830961227417
generate_one_block  0.24269652366638184
generate_one_block  0.2547459602355957
generate_one_block  0.263369083404541
generate_one_block  0.2478649616241455
generate_one_block  0.25881457328796387
generate_one_block  0.24829387664794922
generate_one_block  0.25038743019104004
generate_one_block  0.24116206169128418
generate_one_block  0.2486875057220459
generate_one_block  0.24606704711914062
generate_one_block  0.22609949111938477
generate_one_block  0.24443984031677246
generate_one_block  0.26136112213134766
generate_one_block  0.2571561336517334
generate_one_block  0.28499674797058105
generate_one_block  0.2522256374359131
generate_one_block  0.2522454261779785
generate_one_block  0.2463836669921875
generate_one_block  0.26567625999450684
generate_one_block  0.2571139335632324
generate_one_block  0.24353313446044922
generate_one_block  0.2468562126159668
generate_one_block  0.24594807624816895
generate_one_block  0.25166749954223633
generate_one_block  0.2486867904663086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04064822196960449
gen group dst list time:  0.11699318885803223
time for parepare:  0.01972174644470215
local_output_nid generation:  0.025955677032470703
local_in_edges_tensor generation:  0.0535886287689209
mini_batch_src_global generation:  0.046884775161743164
r_  generation:  0.48390746116638184
local_output_nid generation:  0.030575275421142578
local_in_edges_tensor generation:  0.03661012649536133
mini_batch_src_global generation:  0.06129336357116699
r_  generation:  0.4845004081726074
local_output_nid generation:  0.030602455139160156
local_in_edges_tensor generation:  0.03230881690979004
mini_batch_src_global generation:  0.05801272392272949
r_  generation:  0.4968440532684326
local_output_nid generation:  0.03098750114440918
local_in_edges_tensor generation:  0.030836820602416992
mini_batch_src_global generation:  0.058470726013183594
r_  generation:  0.4925730228424072
local_output_nid generation:  0.03072357177734375
local_in_edges_tensor generation:  0.0370485782623291
mini_batch_src_global generation:  0.059805870056152344
r_  generation:  0.5029985904693604
local_output_nid generation:  0.03091597557067871
local_in_edges_tensor generation:  0.02981281280517578
mini_batch_src_global generation:  0.05960845947265625
r_  generation:  0.5023887157440186
local_output_nid generation:  0.030033588409423828
local_in_edges_tensor generation:  0.034326791763305664
mini_batch_src_global generation:  0.05837845802307129
r_  generation:  0.512209415435791
local_output_nid generation:  0.029290437698364258
local_in_edges_tensor generation:  0.030826568603515625
mini_batch_src_global generation:  0.05960726737976074
r_  generation:  0.5047154426574707
local_output_nid generation:  0.03155779838562012
local_in_edges_tensor generation:  0.03430771827697754
mini_batch_src_global generation:  0.05865049362182617
r_  generation:  0.5089678764343262
local_output_nid generation:  0.03005671501159668
local_in_edges_tensor generation:  0.031070947647094727
mini_batch_src_global generation:  0.06229877471923828
r_  generation:  0.508657693862915
local_output_nid generation:  0.030826568603515625
local_in_edges_tensor generation:  0.035279273986816406
mini_batch_src_global generation:  0.06110692024230957
r_  generation:  0.5151433944702148
local_output_nid generation:  0.029642581939697266
local_in_edges_tensor generation:  0.03118276596069336
mini_batch_src_global generation:  0.06100344657897949
r_  generation:  0.5102243423461914
local_output_nid generation:  0.030828237533569336
local_in_edges_tensor generation:  0.03282952308654785
mini_batch_src_global generation:  0.060106754302978516
r_  generation:  0.5097827911376953
local_output_nid generation:  0.029515981674194336
local_in_edges_tensor generation:  0.04221653938293457
mini_batch_src_global generation:  0.06208300590515137
r_  generation:  0.520317792892456
local_output_nid generation:  0.03249216079711914
local_in_edges_tensor generation:  0.03394627571105957
mini_batch_src_global generation:  0.060515403747558594
r_  generation:  0.5041332244873047
local_output_nid generation:  0.0304257869720459
local_in_edges_tensor generation:  0.03293037414550781
mini_batch_src_global generation:  0.059815406799316406
r_  generation:  0.5028822422027588
local_output_nid generation:  0.03053116798400879
local_in_edges_tensor generation:  0.03341197967529297
mini_batch_src_global generation:  0.06088113784790039
r_  generation:  0.5033292770385742
local_output_nid generation:  0.030052661895751953
local_in_edges_tensor generation:  0.03146696090698242
mini_batch_src_global generation:  0.05981111526489258
r_  generation:  0.48976659774780273
local_output_nid generation:  0.0303194522857666
local_in_edges_tensor generation:  0.028913497924804688
mini_batch_src_global generation:  0.05837440490722656
r_  generation:  0.4971048831939697
local_output_nid generation:  0.030948400497436523
local_in_edges_tensor generation:  0.029238462448120117
mini_batch_src_global generation:  0.06167936325073242
r_  generation:  0.5034446716308594
local_output_nid generation:  0.03076338768005371
local_in_edges_tensor generation:  0.030419349670410156
mini_batch_src_global generation:  0.05839896202087402
r_  generation:  0.5061445236206055
local_output_nid generation:  0.030371427536010742
local_in_edges_tensor generation:  0.03079080581665039
mini_batch_src_global generation:  0.059212684631347656
r_  generation:  0.4964871406555176
local_output_nid generation:  0.030469417572021484
local_in_edges_tensor generation:  0.030762434005737305
mini_batch_src_global generation:  0.05818605422973633
r_  generation:  0.49878644943237305
local_output_nid generation:  0.0303192138671875
local_in_edges_tensor generation:  0.02880573272705078
mini_batch_src_global generation:  0.0592341423034668
r_  generation:  0.4976165294647217
local_output_nid generation:  0.03047657012939453
local_in_edges_tensor generation:  0.030292987823486328
mini_batch_src_global generation:  0.05729222297668457
r_  generation:  0.5002555847167969
local_output_nid generation:  0.031197309494018555
local_in_edges_tensor generation:  0.035622358322143555
mini_batch_src_global generation:  0.05990123748779297
r_  generation:  0.5015785694122314
local_output_nid generation:  0.030376672744750977
local_in_edges_tensor generation:  0.032997846603393555
mini_batch_src_global generation:  0.059064626693725586
r_  generation:  0.5005500316619873
local_output_nid generation:  0.03038334846496582
local_in_edges_tensor generation:  0.031754493713378906
mini_batch_src_global generation:  0.059349775314331055
r_  generation:  0.49814915657043457
local_output_nid generation:  0.030363082885742188
local_in_edges_tensor generation:  0.03050827980041504
mini_batch_src_global generation:  0.057505130767822266
r_  generation:  0.5017433166503906
local_output_nid generation:  0.030764102935791016
local_in_edges_tensor generation:  0.03404068946838379
mini_batch_src_global generation:  0.059319257736206055
r_  generation:  0.502835750579834
local_output_nid generation:  0.030596256256103516
local_in_edges_tensor generation:  0.035196542739868164
mini_batch_src_global generation:  0.05904221534729004
r_  generation:  0.5110528469085693
local_output_nid generation:  0.030384063720703125
local_in_edges_tensor generation:  0.03094172477722168
mini_batch_src_global generation:  0.05922555923461914
r_  generation:  0.5039918422698975
----------------------check_connections_block total spend ----------------------------- 23.536770582199097
generate_one_block  0.6967782974243164
generate_one_block  0.688727855682373
generate_one_block  0.6891148090362549
generate_one_block  0.681351900100708
generate_one_block  0.7791321277618408
generate_one_block  0.6972775459289551
generate_one_block  0.6908769607543945
generate_one_block  0.6785116195678711
generate_one_block  0.6776001453399658
generate_one_block  0.6823124885559082
generate_one_block  0.6724915504455566
generate_one_block  0.6844539642333984
generate_one_block  0.7026546001434326
generate_one_block  0.681088924407959
generate_one_block  0.6749191284179688
generate_one_block  0.6782197952270508
generate_one_block  0.6848843097686768
generate_one_block  0.6751234531402588
generate_one_block  0.6840126514434814
generate_one_block  0.6972618103027344
generate_one_block  0.6925158500671387
generate_one_block  0.6786596775054932
generate_one_block  0.6837348937988281
generate_one_block  0.679440975189209
generate_one_block  0.6927664279937744
generate_one_block  0.6873781681060791
generate_one_block  0.683577299118042
generate_one_block  0.6808912754058838
generate_one_block  0.6837785243988037
generate_one_block  0.6877079010009766
generate_one_block  0.6896152496337891
generate_one_block  0.680659294128418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.13143539428710938  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

connection checking time:  32.07298016548157
block generation total time  30.05825686454773
average batch blocks generation time:  0.9393205270171165
block dataloader generation time/epoch 65.97117374160074
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0955810546875 GB
    Memory Allocated: 0.10918283462524414  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 20.80812644958496  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.10938549041748047  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 21.055321216583252  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.10919189453125  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 20.89180850982666  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.10921764373779297  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 20.887309074401855  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.10881233215332031  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 20.369043350219727  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.10932588577270508  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 20.773229598999023  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.1094365119934082  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 20.84889793395996  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.10904407501220703  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 20.641085624694824  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.10925149917602539  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 21.07862424850464  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.10951089859008789  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 21.29400873184204  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.10904884338378906  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 20.74432945251465  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.10941886901855469  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 21.17015552520752  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.109527587890625  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 20.95588970184326  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1112060546875 GB
    Memory Allocated: 0.1089315414428711  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1444091796875 GB
    Memory Allocated: 20.855353832244873  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 0.10884475708007812  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 20.540935039520264  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 0.10892105102539062  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 20.686354637145996  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 0.10928773880004883  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 20.7731614112854  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 0.10863780975341797  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 19.88811492919922  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 0.109100341796875  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 20.690900802612305  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 0.10994148254394531  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1502685546875 GB
    Memory Allocated: 21.21598243713379  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10956096649169922  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 21.26018476486206  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10944700241088867  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.699236392974854  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.1092677116394043  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.571532726287842  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10885429382324219  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.69841432571411  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10911226272583008  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.51339340209961  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.1095118522644043  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.971055030822754  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10936641693115234  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.85167646408081  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.1089010238647461  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.44404697418213  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.1090397834777832  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.681955337524414  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10927057266235352  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.603909015655518  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10912942886352539  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.73021936416626  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10899639129638672  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.653374671936035  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02888740599155426 |0.023320578038692474 |0.6288977786898613 |9.970366954803467e-05 |1.1882166638970375 |0.008553743362426758 |
----------------------------------------------------------pseudo_mini_loss sum 1.3695985078811646
Total (block generation + training)time/epoch 126.02663781426169
Training time/epoch 59.89015483856201
Training time without block to device /epoch 59.14389634132385
Training time without total dataloading part /epoch 58.159406423568726
load block tensor time/epoch 0.9243969917297363
block to device time/epoch 0.7462584972381592
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  9158261
Number of first layer input nodes during this epoch:  4806669
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.1308307647705078  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026297330856323242
range selection method range initialization spend 0.01378631591796875
time for parepare:  0.02083873748779297
local_output_nid generation:  0.0009579658508300781
local_in_edges_tensor generation:  0.006930351257324219
mini_batch_src_global generation:  0.0016872882843017578
r_  generation:  0.010760068893432617
local_output_nid generation:  0.0009708404541015625
local_in_edges_tensor generation:  0.0007097721099853516
mini_batch_src_global generation:  0.0015208721160888672
r_  generation:  0.010869979858398438
local_output_nid generation:  0.0009183883666992188
local_in_edges_tensor generation:  0.0006418228149414062
mini_batch_src_global generation:  0.0011188983917236328
r_  generation:  0.009813785552978516
local_output_nid generation:  0.000896453857421875
local_in_edges_tensor generation:  0.0006849765777587891
mini_batch_src_global generation:  0.0011682510375976562
r_  generation:  0.010407209396362305
local_output_nid generation:  0.0008835792541503906
local_in_edges_tensor generation:  0.0006132125854492188
mini_batch_src_global generation:  0.001112222671508789
r_  generation:  0.010532379150390625
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0006022453308105469
mini_batch_src_global generation:  0.0011668205261230469
r_  generation:  0.01035761833190918
local_output_nid generation:  0.000904083251953125
local_in_edges_tensor generation:  0.0005908012390136719
mini_batch_src_global generation:  0.001131296157836914
r_  generation:  0.010363101959228516
local_output_nid generation:  0.0008978843688964844
local_in_edges_tensor generation:  0.0006072521209716797
mini_batch_src_global generation:  0.0012404918670654297
r_  generation:  0.010150909423828125
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0005993843078613281
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.01050877571105957
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.0006451606750488281
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.010144710540771484
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0005950927734375
mini_batch_src_global generation:  0.0011000633239746094
r_  generation:  0.010044097900390625
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0006222724914550781
mini_batch_src_global generation:  0.001165628433227539
r_  generation:  0.010429143905639648
local_output_nid generation:  0.0008738040924072266
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0011420249938964844
r_  generation:  0.010488748550415039
local_output_nid generation:  0.0008985996246337891
local_in_edges_tensor generation:  0.0006239414215087891
mini_batch_src_global generation:  0.0011801719665527344
r_  generation:  0.010248184204101562
local_output_nid generation:  0.0008499622344970703
local_in_edges_tensor generation:  0.0006010532379150391
mini_batch_src_global generation:  0.0010972023010253906
r_  generation:  0.010356903076171875
local_output_nid generation:  0.0008878707885742188
local_in_edges_tensor generation:  0.0006220340728759766
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.010374784469604492
local_output_nid generation:  0.0008573532104492188
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.0011208057403564453
r_  generation:  0.010442495346069336
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0006148815155029297
mini_batch_src_global generation:  0.0011851787567138672
r_  generation:  0.010709762573242188
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0005578994750976562
mini_batch_src_global generation:  0.0011980533599853516
r_  generation:  0.012171030044555664
local_output_nid generation:  0.0009293556213378906
local_in_edges_tensor generation:  0.0006444454193115234
mini_batch_src_global generation:  0.0012662410736083984
r_  generation:  0.010675191879272461
local_output_nid generation:  0.0008997917175292969
local_in_edges_tensor generation:  0.0006010532379150391
mini_batch_src_global generation:  0.0011796951293945312
r_  generation:  0.010501861572265625
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005819797515869141
mini_batch_src_global generation:  0.001154184341430664
r_  generation:  0.010258913040161133
local_output_nid generation:  0.0008835792541503906
local_in_edges_tensor generation:  0.0006108283996582031
mini_batch_src_global generation:  0.0011925697326660156
r_  generation:  0.010556221008300781
local_output_nid generation:  0.0008618831634521484
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.0012025833129882812
r_  generation:  0.010396957397460938
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0005743503570556641
mini_batch_src_global generation:  0.0011467933654785156
r_  generation:  0.010331153869628906
local_output_nid generation:  0.0008556842803955078
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.010485649108886719
local_output_nid generation:  0.0008573532104492188
local_in_edges_tensor generation:  0.0005850791931152344
mini_batch_src_global generation:  0.0011262893676757812
r_  generation:  0.010472536087036133
local_output_nid generation:  0.0008559226989746094
local_in_edges_tensor generation:  0.0006041526794433594
mini_batch_src_global generation:  0.0011441707611083984
r_  generation:  0.010432004928588867
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0005924701690673828
mini_batch_src_global generation:  0.0012443065643310547
r_  generation:  0.010579109191894531
local_output_nid generation:  0.0008935928344726562
local_in_edges_tensor generation:  0.000621795654296875
mini_batch_src_global generation:  0.0013315677642822266
r_  generation:  0.010886907577514648
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005805492401123047
mini_batch_src_global generation:  0.0011625289916992188
r_  generation:  0.010202169418334961
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.000644683837890625
mini_batch_src_global generation:  0.0011811256408691406
r_  generation:  0.010679483413696289
----------------------check_connections_block total spend ----------------------------- 0.531559944152832
generate_one_block  0.02512359619140625
generate_one_block  0.0212404727935791
generate_one_block  0.019403457641601562
generate_one_block  0.020135164260864258
generate_one_block  0.01992487907409668
generate_one_block  0.019617080688476562
generate_one_block  0.019411802291870117
generate_one_block  0.01900482177734375
generate_one_block  0.019374370574951172
generate_one_block  0.018715620040893555
generate_one_block  0.01855921745300293
generate_one_block  0.021287918090820312
generate_one_block  0.01975870132446289
generate_one_block  0.018825054168701172
generate_one_block  0.019342660903930664
generate_one_block  0.019100666046142578
generate_one_block  0.022399425506591797
generate_one_block  0.019620418548583984
generate_one_block  0.02021026611328125
generate_one_block  0.019908666610717773
generate_one_block  0.019742727279663086
generate_one_block  0.021488428115844727
generate_one_block  0.019526958465576172
generate_one_block  0.018767833709716797
generate_one_block  0.018932342529296875
generate_one_block  0.01900768280029297
generate_one_block  0.02153491973876953
generate_one_block  0.01958632469177246
generate_one_block  0.019478321075439453
generate_one_block  0.01982259750366211
generate_one_block  0.018651723861694336
generate_one_block  0.020941495895385742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04457521438598633
gen group dst list time:  0.024181127548217773
time for parepare:  0.023964643478393555
local_output_nid generation:  0.005864858627319336
local_in_edges_tensor generation:  0.018604516983032227
mini_batch_src_global generation:  0.01782083511352539
r_  generation:  0.1688070297241211
local_output_nid generation:  0.00825357437133789
local_in_edges_tensor generation:  0.011194229125976562
mini_batch_src_global generation:  0.0222933292388916
r_  generation:  0.17745518684387207
local_output_nid generation:  0.00798344612121582
local_in_edges_tensor generation:  0.03702425956726074
mini_batch_src_global generation:  0.0206301212310791
r_  generation:  0.17784380912780762
local_output_nid generation:  0.008736848831176758
local_in_edges_tensor generation:  0.014233827590942383
mini_batch_src_global generation:  0.022721529006958008
r_  generation:  0.18501996994018555
local_output_nid generation:  0.009036779403686523
local_in_edges_tensor generation:  0.012000322341918945
mini_batch_src_global generation:  0.0261688232421875
r_  generation:  0.18467164039611816
local_output_nid generation:  0.009132146835327148
local_in_edges_tensor generation:  0.010514259338378906
mini_batch_src_global generation:  0.02349543571472168
r_  generation:  0.18436241149902344
local_output_nid generation:  0.009168148040771484
local_in_edges_tensor generation:  0.011839628219604492
mini_batch_src_global generation:  0.02394390106201172
r_  generation:  0.1839148998260498
local_output_nid generation:  0.00884246826171875
local_in_edges_tensor generation:  0.01112508773803711
mini_batch_src_global generation:  0.02338695526123047
r_  generation:  0.17962384223937988
local_output_nid generation:  0.008785724639892578
local_in_edges_tensor generation:  0.009207010269165039
mini_batch_src_global generation:  0.02388143539428711
r_  generation:  0.18490886688232422
local_output_nid generation:  0.00901651382446289
local_in_edges_tensor generation:  0.008716821670532227
mini_batch_src_global generation:  0.0227353572845459
r_  generation:  0.17876434326171875
local_output_nid generation:  0.009094476699829102
local_in_edges_tensor generation:  0.009578227996826172
mini_batch_src_global generation:  0.02368307113647461
r_  generation:  0.18285799026489258
local_output_nid generation:  0.010444879531860352
local_in_edges_tensor generation:  0.012171506881713867
mini_batch_src_global generation:  0.024348974227905273
r_  generation:  0.19376325607299805
local_output_nid generation:  0.010808467864990234
local_in_edges_tensor generation:  0.010471105575561523
mini_batch_src_global generation:  0.02438044548034668
r_  generation:  0.18737101554870605
local_output_nid generation:  0.009501218795776367
local_in_edges_tensor generation:  0.009796142578125
mini_batch_src_global generation:  0.023131370544433594
r_  generation:  0.18167686462402344
local_output_nid generation:  0.009597301483154297
local_in_edges_tensor generation:  0.012095212936401367
mini_batch_src_global generation:  0.02267003059387207
r_  generation:  0.18322968482971191
local_output_nid generation:  0.009639263153076172
local_in_edges_tensor generation:  0.00974726676940918
mini_batch_src_global generation:  0.023110151290893555
r_  generation:  0.18215012550354004
local_output_nid generation:  0.009639501571655273
local_in_edges_tensor generation:  0.00927591323852539
mini_batch_src_global generation:  0.023146390914916992
r_  generation:  0.18544554710388184
local_output_nid generation:  0.009975194931030273
local_in_edges_tensor generation:  0.009397745132446289
mini_batch_src_global generation:  0.0238955020904541
r_  generation:  0.18662667274475098
local_output_nid generation:  0.010267496109008789
local_in_edges_tensor generation:  0.010695695877075195
mini_batch_src_global generation:  0.024803876876831055
r_  generation:  0.19518518447875977
local_output_nid generation:  0.009499073028564453
local_in_edges_tensor generation:  0.011160612106323242
mini_batch_src_global generation:  0.02292633056640625
r_  generation:  0.17861366271972656
local_output_nid generation:  0.00987863540649414
local_in_edges_tensor generation:  0.009392261505126953
mini_batch_src_global generation:  0.024287700653076172
r_  generation:  0.1882162094116211
local_output_nid generation:  0.009571313858032227
local_in_edges_tensor generation:  0.009479522705078125
mini_batch_src_global generation:  0.023407459259033203
r_  generation:  0.17862319946289062
local_output_nid generation:  0.010010004043579102
local_in_edges_tensor generation:  0.009037017822265625
mini_batch_src_global generation:  0.02364325523376465
r_  generation:  0.18627595901489258
local_output_nid generation:  0.0097198486328125
local_in_edges_tensor generation:  0.008884191513061523
mini_batch_src_global generation:  0.022994518280029297
r_  generation:  0.17973041534423828
local_output_nid generation:  0.009687423706054688
local_in_edges_tensor generation:  0.008942604064941406
mini_batch_src_global generation:  0.022677898406982422
r_  generation:  0.18178653717041016
local_output_nid generation:  0.00971221923828125
local_in_edges_tensor generation:  0.009244680404663086
mini_batch_src_global generation:  0.023156404495239258
r_  generation:  0.18189263343811035
local_output_nid generation:  0.009655237197875977
local_in_edges_tensor generation:  0.008789539337158203
mini_batch_src_global generation:  0.02226877212524414
r_  generation:  0.17940568923950195
local_output_nid generation:  0.00977778434753418
local_in_edges_tensor generation:  0.00935983657836914
mini_batch_src_global generation:  0.023404836654663086
r_  generation:  0.18392419815063477
local_output_nid generation:  0.010009765625
local_in_edges_tensor generation:  0.009331464767456055
mini_batch_src_global generation:  0.02386474609375
r_  generation:  0.18834781646728516
local_output_nid generation:  0.010229349136352539
local_in_edges_tensor generation:  0.009560108184814453
mini_batch_src_global generation:  0.02547764778137207
r_  generation:  0.1925358772277832
local_output_nid generation:  0.009450674057006836
local_in_edges_tensor generation:  0.00906515121459961
mini_batch_src_global generation:  0.023039817810058594
r_  generation:  0.18164682388305664
local_output_nid generation:  0.00989985466003418
local_in_edges_tensor generation:  0.009317874908447266
mini_batch_src_global generation:  0.02576160430908203
r_  generation:  0.185805082321167
----------------------check_connections_block total spend ----------------------------- 8.629345417022705
generate_one_block  0.25579404830932617
generate_one_block  0.24266386032104492
generate_one_block  0.24174952507019043
generate_one_block  0.25813794136047363
generate_one_block  0.271038293838501
generate_one_block  0.25232958793640137
generate_one_block  0.24980640411376953
generate_one_block  0.24117493629455566
generate_one_block  0.2524757385253906
generate_one_block  0.2433319091796875
generate_one_block  0.24017739295959473
generate_one_block  0.2552368640899658
generate_one_block  0.25316333770751953
generate_one_block  0.24417781829833984
generate_one_block  0.247786283493042
generate_one_block  0.2462782859802246
generate_one_block  0.25178098678588867
generate_one_block  0.2542273998260498
generate_one_block  0.26932406425476074
generate_one_block  0.2486896514892578
generate_one_block  0.2590043544769287
generate_one_block  0.2427217960357666
generate_one_block  0.25521159172058105
generate_one_block  0.24989700317382812
generate_one_block  0.24284625053405762
generate_one_block  0.2511410713195801
generate_one_block  0.2477428913116455
generate_one_block  0.25392723083496094
generate_one_block  0.25844407081604004
generate_one_block  0.26516222953796387
generate_one_block  0.2468419075012207
generate_one_block  0.2521541118621826
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04034543037414551
gen group dst list time:  0.11540055274963379
time for parepare:  0.020552396774291992
local_output_nid generation:  0.026040077209472656
local_in_edges_tensor generation:  0.04924964904785156
mini_batch_src_global generation:  0.04824042320251465
r_  generation:  0.49308252334594727
local_output_nid generation:  0.030819177627563477
local_in_edges_tensor generation:  0.03665351867675781
mini_batch_src_global generation:  0.06079840660095215
r_  generation:  0.4870927333831787
local_output_nid generation:  0.03288388252258301
local_in_edges_tensor generation:  0.03466320037841797
mini_batch_src_global generation:  0.058248281478881836
r_  generation:  0.4965023994445801
local_output_nid generation:  0.031677961349487305
local_in_edges_tensor generation:  0.03136110305786133
mini_batch_src_global generation:  0.058347463607788086
r_  generation:  0.5003809928894043
local_output_nid generation:  0.03209257125854492
local_in_edges_tensor generation:  0.03066849708557129
mini_batch_src_global generation:  0.05835533142089844
r_  generation:  0.49982500076293945
local_output_nid generation:  0.031919002532958984
local_in_edges_tensor generation:  0.03059697151184082
mini_batch_src_global generation:  0.05965566635131836
r_  generation:  0.5018069744110107
local_output_nid generation:  0.030862092971801758
local_in_edges_tensor generation:  0.030894994735717773
mini_batch_src_global generation:  0.058710575103759766
r_  generation:  0.5119712352752686
local_output_nid generation:  0.030427217483520508
local_in_edges_tensor generation:  0.033852338790893555
mini_batch_src_global generation:  0.05962681770324707
r_  generation:  0.4972991943359375
local_output_nid generation:  0.03011178970336914
local_in_edges_tensor generation:  0.031527042388916016
mini_batch_src_global generation:  0.06036996841430664
r_  generation:  0.5057342052459717
local_output_nid generation:  0.03013896942138672
local_in_edges_tensor generation:  0.03133344650268555
mini_batch_src_global generation:  0.06034040451049805
r_  generation:  0.4968578815460205
local_output_nid generation:  0.030106782913208008
local_in_edges_tensor generation:  0.02908611297607422
mini_batch_src_global generation:  0.05810236930847168
r_  generation:  0.4985692501068115
local_output_nid generation:  0.030614852905273438
local_in_edges_tensor generation:  0.0307769775390625
mini_batch_src_global generation:  0.061893463134765625
r_  generation:  0.5078473091125488
local_output_nid generation:  0.0302731990814209
local_in_edges_tensor generation:  0.03218865394592285
mini_batch_src_global generation:  0.05898714065551758
r_  generation:  0.5025856494903564
local_output_nid generation:  0.030539989471435547
local_in_edges_tensor generation:  0.030232667922973633
mini_batch_src_global generation:  0.05988645553588867
r_  generation:  0.5067563056945801
local_output_nid generation:  0.030446290969848633
local_in_edges_tensor generation:  0.033461570739746094
mini_batch_src_global generation:  0.05893731117248535
r_  generation:  0.5063784122467041
local_output_nid generation:  0.030318737030029297
local_in_edges_tensor generation:  0.03134584426879883
mini_batch_src_global generation:  0.06035137176513672
r_  generation:  0.5064857006072998
local_output_nid generation:  0.03069448471069336
local_in_edges_tensor generation:  0.029218196868896484
mini_batch_src_global generation:  0.06061410903930664
r_  generation:  0.5068879127502441
local_output_nid generation:  0.03192901611328125
local_in_edges_tensor generation:  0.03424358367919922
mini_batch_src_global generation:  0.060440778732299805
r_  generation:  0.5047757625579834
local_output_nid generation:  0.03138470649719238
local_in_edges_tensor generation:  0.03507590293884277
mini_batch_src_global generation:  0.059510231018066406
r_  generation:  0.5110416412353516
local_output_nid generation:  0.03062295913696289
local_in_edges_tensor generation:  0.03185772895812988
mini_batch_src_global generation:  0.059392452239990234
r_  generation:  0.49655628204345703
local_output_nid generation:  0.03144097328186035
local_in_edges_tensor generation:  0.03172421455383301
mini_batch_src_global generation:  0.06141829490661621
r_  generation:  0.507448673248291
local_output_nid generation:  0.030904769897460938
local_in_edges_tensor generation:  0.033651113510131836
mini_batch_src_global generation:  0.06235337257385254
r_  generation:  0.5050897598266602
local_output_nid generation:  0.031146764755249023
local_in_edges_tensor generation:  0.03654217720031738
mini_batch_src_global generation:  0.06166577339172363
r_  generation:  0.5090808868408203
local_output_nid generation:  0.03277301788330078
local_in_edges_tensor generation:  0.030948638916015625
mini_batch_src_global generation:  0.06316685676574707
r_  generation:  0.5191771984100342
local_output_nid generation:  0.033203840255737305
local_in_edges_tensor generation:  0.02948451042175293
mini_batch_src_global generation:  0.06269145011901855
r_  generation:  0.5054290294647217
local_output_nid generation:  0.03109431266784668
local_in_edges_tensor generation:  0.02918553352355957
mini_batch_src_global generation:  0.06016707420349121
r_  generation:  0.49670934677124023
local_output_nid generation:  0.03075575828552246
local_in_edges_tensor generation:  0.033155202865600586
mini_batch_src_global generation:  0.05902719497680664
r_  generation:  0.5031650066375732
local_output_nid generation:  0.030908584594726562
local_in_edges_tensor generation:  0.028339147567749023
mini_batch_src_global generation:  0.06218671798706055
r_  generation:  0.5036542415618896
local_output_nid generation:  0.0309298038482666
local_in_edges_tensor generation:  0.03159618377685547
mini_batch_src_global generation:  0.05899524688720703
r_  generation:  0.5055184364318848
local_output_nid generation:  0.03117966651916504
local_in_edges_tensor generation:  0.03351569175720215
mini_batch_src_global generation:  0.06106829643249512
r_  generation:  0.5193800926208496
local_output_nid generation:  0.030736446380615234
local_in_edges_tensor generation:  0.02970290184020996
mini_batch_src_global generation:  0.05925250053405762
r_  generation:  0.5060865879058838
local_output_nid generation:  0.031011104583740234
local_in_edges_tensor generation:  0.02938103675842285
mini_batch_src_global generation:  0.05987954139709473
r_  generation:  0.5029866695404053
----------------------check_connections_block total spend ----------------------------- 23.598466157913208
generate_one_block  0.6923491954803467
generate_one_block  0.6775839328765869
generate_one_block  0.6741158962249756
generate_one_block  0.6892712116241455
generate_one_block  0.7911806106567383
generate_one_block  0.6827657222747803
generate_one_block  0.6828739643096924
generate_one_block  0.6736440658569336
generate_one_block  0.6767928600311279
generate_one_block  0.6697337627410889
generate_one_block  0.6783478260040283
generate_one_block  0.6910362243652344
generate_one_block  0.6823861598968506
generate_one_block  0.6839070320129395
generate_one_block  0.6798796653747559
generate_one_block  0.6816391944885254
generate_one_block  0.6832239627838135
generate_one_block  0.6896071434020996
generate_one_block  0.703824520111084
generate_one_block  0.6856238842010498
generate_one_block  0.6809513568878174
generate_one_block  0.6764826774597168
generate_one_block  0.6808900833129883
generate_one_block  0.6813173294067383
generate_one_block  0.6917438507080078
generate_one_block  0.6741125583648682
generate_one_block  0.6865334510803223
generate_one_block  0.6859731674194336
generate_one_block  0.6887214183807373
generate_one_block  0.6816411018371582
generate_one_block  0.6788845062255859
generate_one_block  0.6734528541564941
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.1308307647705078  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

connection checking time:  32.22781157493591
block generation total time  29.994930028915405
average batch blocks generation time:  0.9373415634036064
block dataloader generation time/epoch 65.96566196282704
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10885953903198242  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.36205768585205  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10913944244384766  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.625391483306885  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10884714126586914  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.58610439300537  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10950803756713867  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 21.234806537628174  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10918140411376953  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 21.159367084503174  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10941648483276367  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 21.097943782806396  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10936546325683594  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 21.008609294891357  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10909509658813477  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.558576583862305  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10897254943847656  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.88446569442749  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10887384414672852  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.546069622039795  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10888433456420898  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.395191192626953  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10943460464477539  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.91538953781128  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10911417007446289  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.909788131713867  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10909318923950195  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.63496446609497  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10926532745361328  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.695209980010986  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10912084579467773  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.604357719421387  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10934209823608398  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.809105396270752  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.1093449592590332  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 20.909181594848633  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.10966062545776367  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 21.47111415863037  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10869741439819336  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.2529878616333  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10941219329833984  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 21.013163089752197  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10913228988647461  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.44520139694214  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10946130752563477  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.985772132873535  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10936355590820312  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.624364852905273  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10911989212036133  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.42734670639038  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10929441452026367  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.706160068511963  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10905742645263672  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.4871244430542  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10919713973999023  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.781630992889404  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10924196243286133  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.988722801208496  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.1098332405090332  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 21.358922004699707  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10892868041992188  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.598456859588623  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10929203033447266  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.824875831604004  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03142585605382919 |0.024186916649341583 |0.6349911317229271 |9.836256504058838e-05 |1.1958280503749847 |0.009637117385864258 |
----------------------------------------------------------pseudo_mini_loss sum 1.3483190536499023
Total (block generation + training)time/epoch 126.05320862929027
Training time/epoch 60.440215826034546
Training time without block to device /epoch 59.666234493255615
Training time without total dataloading part /epoch 58.59899854660034
load block tensor time/epoch 1.0056273937225342
block to device time/epoch 0.7739813327789307
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  9157943
Number of first layer input nodes during this epoch:  4807065
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.13116121292114258  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024847984313964844
range selection method range initialization spend 0.01722264289855957
time for parepare:  0.02091217041015625
local_output_nid generation:  0.0009789466857910156
local_in_edges_tensor generation:  0.006523847579956055
mini_batch_src_global generation:  0.0022237300872802734
r_  generation:  0.01213383674621582
local_output_nid generation:  0.0010516643524169922
local_in_edges_tensor generation:  0.0007059574127197266
mini_batch_src_global generation:  0.0016570091247558594
r_  generation:  0.010904550552368164
local_output_nid generation:  0.0009403228759765625
local_in_edges_tensor generation:  0.0006093978881835938
mini_batch_src_global generation:  0.0012257099151611328
r_  generation:  0.009966135025024414
local_output_nid generation:  0.0008985996246337891
local_in_edges_tensor generation:  0.0006017684936523438
mini_batch_src_global generation:  0.0011255741119384766
r_  generation:  0.009857177734375
local_output_nid generation:  0.0009484291076660156
local_in_edges_tensor generation:  0.0006365776062011719
mini_batch_src_global generation:  0.0012254714965820312
r_  generation:  0.010259628295898438
local_output_nid generation:  0.0009129047393798828
local_in_edges_tensor generation:  0.0006093978881835938
mini_batch_src_global generation:  0.0011990070343017578
r_  generation:  0.010435104370117188
local_output_nid generation:  0.00089263916015625
local_in_edges_tensor generation:  0.0006098747253417969
mini_batch_src_global generation:  0.0012607574462890625
r_  generation:  0.010442256927490234
local_output_nid generation:  0.0009028911590576172
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0011832714080810547
r_  generation:  0.010245084762573242
local_output_nid generation:  0.0008893013000488281
local_in_edges_tensor generation:  0.00063323974609375
mini_batch_src_global generation:  0.0012378692626953125
r_  generation:  0.010328054428100586
local_output_nid generation:  0.0008831024169921875
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0011472702026367188
r_  generation:  0.010547637939453125
local_output_nid generation:  0.0009016990661621094
local_in_edges_tensor generation:  0.0006186962127685547
mini_batch_src_global generation:  0.001203775405883789
r_  generation:  0.0102386474609375
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0006022453308105469
mini_batch_src_global generation:  0.0012385845184326172
r_  generation:  0.010724782943725586
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.0006167888641357422
mini_batch_src_global generation:  0.0012116432189941406
r_  generation:  0.010904312133789062
local_output_nid generation:  0.0008771419525146484
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.0011248588562011719
r_  generation:  0.01016688346862793
local_output_nid generation:  0.0008916854858398438
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.0011622905731201172
r_  generation:  0.01048898696899414
local_output_nid generation:  0.0008764266967773438
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.010447025299072266
local_output_nid generation:  0.0008754730224609375
local_in_edges_tensor generation:  0.0005967617034912109
mini_batch_src_global generation:  0.0011792182922363281
r_  generation:  0.010187864303588867
local_output_nid generation:  0.0008792877197265625
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.0012464523315429688
r_  generation:  0.010309696197509766
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0006067752838134766
mini_batch_src_global generation:  0.0012547969818115234
r_  generation:  0.01085042953491211
local_output_nid generation:  0.0008931159973144531
local_in_edges_tensor generation:  0.0005965232849121094
mini_batch_src_global generation:  0.0011413097381591797
r_  generation:  0.009902715682983398
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0005819797515869141
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.010392427444458008
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0006191730499267578
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.010314702987670898
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005850791931152344
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.010288000106811523
local_output_nid generation:  0.0009012222290039062
local_in_edges_tensor generation:  0.0006146430969238281
mini_batch_src_global generation:  0.0011813640594482422
r_  generation:  0.012599706649780273
local_output_nid generation:  0.0009434223175048828
local_in_edges_tensor generation:  0.0005867481231689453
mini_batch_src_global generation:  0.001226663589477539
r_  generation:  0.010442972183227539
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0006048679351806641
mini_batch_src_global generation:  0.001260995864868164
r_  generation:  0.010796308517456055
local_output_nid generation:  0.0008962154388427734
local_in_edges_tensor generation:  0.0006067752838134766
mini_batch_src_global generation:  0.001230001449584961
r_  generation:  0.010544538497924805
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.0005736351013183594
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.010347366333007812
local_output_nid generation:  0.0009124279022216797
local_in_edges_tensor generation:  0.0006115436553955078
mini_batch_src_global generation:  0.0012030601501464844
r_  generation:  0.01053309440612793
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.01021265983581543
local_output_nid generation:  0.0009214878082275391
local_in_edges_tensor generation:  0.0006010532379150391
mini_batch_src_global generation:  0.0011606216430664062
r_  generation:  0.010337591171264648
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.0011463165283203125
r_  generation:  0.010355472564697266
----------------------check_connections_block total spend ----------------------------- 0.5342183113098145
generate_one_block  0.025870561599731445
generate_one_block  0.02139878273010254
generate_one_block  0.019557952880859375
generate_one_block  0.021071910858154297
generate_one_block  0.01952815055847168
generate_one_block  0.01939702033996582
generate_one_block  0.01920914649963379
generate_one_block  0.018910884857177734
generate_one_block  0.01920151710510254
generate_one_block  0.0192718505859375
generate_one_block  0.018637418746948242
generate_one_block  0.021790504455566406
generate_one_block  0.02051091194152832
generate_one_block  0.019887685775756836
generate_one_block  0.01939225196838379
generate_one_block  0.019002437591552734
generate_one_block  0.018655061721801758
generate_one_block  0.01878952980041504
generate_one_block  0.019695758819580078
generate_one_block  0.01803302764892578
generate_one_block  0.01884317398071289
generate_one_block  0.018742799758911133
generate_one_block  0.01872086524963379
generate_one_block  0.02058696746826172
generate_one_block  0.01919245719909668
generate_one_block  0.019600391387939453
generate_one_block  0.019237279891967773
generate_one_block  0.01869821548461914
generate_one_block  0.01919102668762207
generate_one_block  0.018612384796142578
generate_one_block  0.018790721893310547
generate_one_block  0.018912553787231445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03957700729370117
gen group dst list time:  0.02803325653076172
time for parepare:  0.022225618362426758
local_output_nid generation:  0.005842685699462891
local_in_edges_tensor generation:  0.018827438354492188
mini_batch_src_global generation:  0.02044391632080078
r_  generation:  0.16825366020202637
local_output_nid generation:  0.008113861083984375
local_in_edges_tensor generation:  0.011078119277954102
mini_batch_src_global generation:  0.024483919143676758
r_  generation:  0.1980743408203125
local_output_nid generation:  0.012810707092285156
local_in_edges_tensor generation:  0.05874061584472656
mini_batch_src_global generation:  0.023458242416381836
r_  generation:  0.20789861679077148
local_output_nid generation:  0.01166844367980957
local_in_edges_tensor generation:  0.011071920394897461
mini_batch_src_global generation:  0.0359342098236084
r_  generation:  0.20283174514770508
local_output_nid generation:  0.010790586471557617
local_in_edges_tensor generation:  0.011198043823242188
mini_batch_src_global generation:  0.033722639083862305
r_  generation:  0.18218731880187988
local_output_nid generation:  0.010296821594238281
local_in_edges_tensor generation:  0.01146245002746582
mini_batch_src_global generation:  0.025180816650390625
r_  generation:  0.18319416046142578
local_output_nid generation:  0.010021448135375977
local_in_edges_tensor generation:  0.011839151382446289
mini_batch_src_global generation:  0.025343894958496094
r_  generation:  0.18387126922607422
local_output_nid generation:  0.009253501892089844
local_in_edges_tensor generation:  0.011542797088623047
mini_batch_src_global generation:  0.024812698364257812
r_  generation:  0.17857122421264648
local_output_nid generation:  0.009054899215698242
local_in_edges_tensor generation:  0.011195182800292969
mini_batch_src_global generation:  0.03032374382019043
r_  generation:  0.18232321739196777
local_output_nid generation:  0.01007699966430664
local_in_edges_tensor generation:  0.009134292602539062
mini_batch_src_global generation:  0.023262977600097656
r_  generation:  0.18527507781982422
local_output_nid generation:  0.00926065444946289
local_in_edges_tensor generation:  0.009071588516235352
mini_batch_src_global generation:  0.0232083797454834
r_  generation:  0.18059206008911133
local_output_nid generation:  0.010045051574707031
local_in_edges_tensor generation:  0.009868621826171875
mini_batch_src_global generation:  0.0247342586517334
r_  generation:  0.18776750564575195
local_output_nid generation:  0.010334253311157227
local_in_edges_tensor generation:  0.01213526725769043
mini_batch_src_global generation:  0.050699472427368164
r_  generation:  0.20029592514038086
local_output_nid generation:  0.01131892204284668
local_in_edges_tensor generation:  0.009992599487304688
mini_batch_src_global generation:  0.02519536018371582
r_  generation:  0.17627882957458496
local_output_nid generation:  0.010528326034545898
local_in_edges_tensor generation:  0.009310483932495117
mini_batch_src_global generation:  0.02614569664001465
r_  generation:  0.21617364883422852
local_output_nid generation:  0.013538599014282227
local_in_edges_tensor generation:  0.009578466415405273
mini_batch_src_global generation:  0.03194785118103027
r_  generation:  0.1852858066558838
local_output_nid generation:  0.009830951690673828
local_in_edges_tensor generation:  0.008850336074829102
mini_batch_src_global generation:  0.025720596313476562
r_  generation:  0.18559622764587402
local_output_nid generation:  0.01024174690246582
local_in_edges_tensor generation:  0.009170770645141602
mini_batch_src_global generation:  0.025700807571411133
r_  generation:  0.18396782875061035
local_output_nid generation:  0.010370254516601562
local_in_edges_tensor generation:  0.00902414321899414
mini_batch_src_global generation:  0.02678966522216797
r_  generation:  0.18914031982421875
local_output_nid generation:  0.009691715240478516
local_in_edges_tensor generation:  0.008403301239013672
mini_batch_src_global generation:  0.02480626106262207
r_  generation:  0.22286295890808105
local_output_nid generation:  0.009929895401000977
local_in_edges_tensor generation:  0.009125471115112305
mini_batch_src_global generation:  0.023836135864257812
r_  generation:  0.18374037742614746
local_output_nid generation:  0.010151386260986328
local_in_edges_tensor generation:  0.008821964263916016
mini_batch_src_global generation:  0.0230715274810791
r_  generation:  0.18288779258728027
local_output_nid generation:  0.010198354721069336
local_in_edges_tensor generation:  0.008719921112060547
mini_batch_src_global generation:  0.022984027862548828
r_  generation:  0.18301916122436523
local_output_nid generation:  0.010252714157104492
local_in_edges_tensor generation:  0.009101390838623047
mini_batch_src_global generation:  0.02362990379333496
r_  generation:  0.18831372261047363
local_output_nid generation:  0.01031041145324707
local_in_edges_tensor generation:  0.008852481842041016
mini_batch_src_global generation:  0.023705720901489258
r_  generation:  0.1862783432006836
local_output_nid generation:  0.010582208633422852
local_in_edges_tensor generation:  0.009398460388183594
mini_batch_src_global generation:  0.024017333984375
r_  generation:  0.18991565704345703
local_output_nid generation:  0.010406732559204102
local_in_edges_tensor generation:  0.011361122131347656
mini_batch_src_global generation:  0.023928165435791016
r_  generation:  0.1899425983428955
local_output_nid generation:  0.009944677352905273
local_in_edges_tensor generation:  0.009002447128295898
mini_batch_src_global generation:  0.023196935653686523
r_  generation:  0.1841738224029541
local_output_nid generation:  0.010003805160522461
local_in_edges_tensor generation:  0.01062154769897461
mini_batch_src_global generation:  0.023627519607543945
r_  generation:  0.19052672386169434
local_output_nid generation:  0.009949207305908203
local_in_edges_tensor generation:  0.008943796157836914
mini_batch_src_global generation:  0.0233156681060791
r_  generation:  0.18429160118103027
local_output_nid generation:  0.012172937393188477
local_in_edges_tensor generation:  0.008942365646362305
mini_batch_src_global generation:  0.023028135299682617
r_  generation:  0.18658733367919922
local_output_nid generation:  0.010134220123291016
local_in_edges_tensor generation:  0.00978994369506836
mini_batch_src_global generation:  0.023827075958251953
r_  generation:  0.18977904319763184
----------------------check_connections_block total spend ----------------------------- 8.979012250900269
generate_one_block  0.264754056930542
generate_one_block  0.245039701461792
generate_one_block  0.24619412422180176
generate_one_block  0.24185919761657715
generate_one_block  0.2695894241333008
generate_one_block  0.26850438117980957
generate_one_block  0.2630736827850342
generate_one_block  0.24641156196594238
generate_one_block  0.2506284713745117
generate_one_block  0.25514721870422363
generate_one_block  0.2474989891052246
generate_one_block  0.25861644744873047
generate_one_block  0.26113200187683105
generate_one_block  0.23368000984191895
generate_one_block  0.2497267723083496
generate_one_block  0.24797582626342773
generate_one_block  0.2510683536529541
generate_one_block  0.24516916275024414
generate_one_block  0.2533838748931885
generate_one_block  0.23955273628234863
generate_one_block  0.24751496315002441
generate_one_block  0.2470862865447998
generate_one_block  0.24413228034973145
generate_one_block  0.2558145523071289
generate_one_block  0.2568817138671875
generate_one_block  0.27132248878479004
generate_one_block  0.25516843795776367
generate_one_block  0.2534210681915283
generate_one_block  0.25806617736816406
generate_one_block  0.24987101554870605
generate_one_block  0.24913883209228516
generate_one_block  0.2547261714935303
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03826189041137695
gen group dst list time:  0.11492443084716797
time for parepare:  0.020526647567749023
local_output_nid generation:  0.02807164192199707
local_in_edges_tensor generation:  0.05220174789428711
mini_batch_src_global generation:  0.047000885009765625
r_  generation:  0.4954054355621338
local_output_nid generation:  0.030561208724975586
local_in_edges_tensor generation:  0.037322998046875
mini_batch_src_global generation:  0.06336045265197754
r_  generation:  0.4926118850708008
local_output_nid generation:  0.031010866165161133
local_in_edges_tensor generation:  0.03613471984863281
mini_batch_src_global generation:  0.05955934524536133
r_  generation:  0.5046525001525879
local_output_nid generation:  0.03078770637512207
local_in_edges_tensor generation:  0.032552242279052734
mini_batch_src_global generation:  0.06163978576660156
r_  generation:  0.5074756145477295
local_output_nid generation:  0.03146028518676758
local_in_edges_tensor generation:  0.031447649002075195
mini_batch_src_global generation:  0.062012672424316406
r_  generation:  0.518866777420044
local_output_nid generation:  0.03329038619995117
local_in_edges_tensor generation:  0.037992238998413086
mini_batch_src_global generation:  0.05971217155456543
r_  generation:  0.5008339881896973
local_output_nid generation:  0.03068065643310547
local_in_edges_tensor generation:  0.03316521644592285
mini_batch_src_global generation:  0.06079983711242676
r_  generation:  0.5047252178192139
local_output_nid generation:  0.03063368797302246
local_in_edges_tensor generation:  0.03459286689758301
mini_batch_src_global generation:  0.061458587646484375
r_  generation:  0.5004701614379883
local_output_nid generation:  0.030459165573120117
local_in_edges_tensor generation:  0.0324864387512207
mini_batch_src_global generation:  0.058475494384765625
r_  generation:  0.5160799026489258
local_output_nid generation:  0.03023076057434082
local_in_edges_tensor generation:  0.03070688247680664
mini_batch_src_global generation:  0.06279778480529785
r_  generation:  0.5026605129241943
local_output_nid generation:  0.030467748641967773
local_in_edges_tensor generation:  0.02940201759338379
mini_batch_src_global generation:  0.05851030349731445
r_  generation:  0.5136723518371582
local_output_nid generation:  0.03082871437072754
local_in_edges_tensor generation:  0.028253555297851562
mini_batch_src_global generation:  0.05978965759277344
r_  generation:  0.5003573894500732
local_output_nid generation:  0.03149223327636719
local_in_edges_tensor generation:  0.035643577575683594
mini_batch_src_global generation:  0.05835366249084473
r_  generation:  0.5057551860809326
local_output_nid generation:  0.031824350357055664
local_in_edges_tensor generation:  0.03683280944824219
mini_batch_src_global generation:  0.059792280197143555
r_  generation:  0.4941565990447998
local_output_nid generation:  0.03061652183532715
local_in_edges_tensor generation:  0.02859783172607422
mini_batch_src_global generation:  0.06050872802734375
r_  generation:  0.500800371170044
local_output_nid generation:  0.03044724464416504
local_in_edges_tensor generation:  0.028712987899780273
mini_batch_src_global generation:  0.06005382537841797
r_  generation:  0.4984562397003174
local_output_nid generation:  0.030467510223388672
local_in_edges_tensor generation:  0.029656171798706055
mini_batch_src_global generation:  0.059332847595214844
r_  generation:  0.5087161064147949
local_output_nid generation:  0.03090953826904297
local_in_edges_tensor generation:  0.03127717971801758
mini_batch_src_global generation:  0.0615084171295166
r_  generation:  0.4972529411315918
local_output_nid generation:  0.030642986297607422
local_in_edges_tensor generation:  0.03205251693725586
mini_batch_src_global generation:  0.05880546569824219
r_  generation:  0.503150463104248
local_output_nid generation:  0.030195951461791992
local_in_edges_tensor generation:  0.03609824180603027
mini_batch_src_global generation:  0.06097674369812012
r_  generation:  0.49550390243530273
local_output_nid generation:  0.0306093692779541
local_in_edges_tensor generation:  0.029020309448242188
mini_batch_src_global generation:  0.06004929542541504
r_  generation:  0.5029757022857666
local_output_nid generation:  0.030561447143554688
local_in_edges_tensor generation:  0.0327916145324707
mini_batch_src_global generation:  0.060018301010131836
r_  generation:  0.5187633037567139
local_output_nid generation:  0.03317117691040039
local_in_edges_tensor generation:  0.035129547119140625
mini_batch_src_global generation:  0.06084108352661133
r_  generation:  0.5020787715911865
local_output_nid generation:  0.030915021896362305
local_in_edges_tensor generation:  0.031580209732055664
mini_batch_src_global generation:  0.0600128173828125
r_  generation:  0.4995300769805908
local_output_nid generation:  0.030580997467041016
local_in_edges_tensor generation:  0.03086066246032715
mini_batch_src_global generation:  0.05819892883300781
r_  generation:  0.5028109550476074
local_output_nid generation:  0.03117227554321289
local_in_edges_tensor generation:  0.031244993209838867
mini_batch_src_global generation:  0.05949211120605469
r_  generation:  0.5051484107971191
local_output_nid generation:  0.031219959259033203
local_in_edges_tensor generation:  0.030973434448242188
mini_batch_src_global generation:  0.05899930000305176
r_  generation:  0.5091829299926758
local_output_nid generation:  0.030588865280151367
local_in_edges_tensor generation:  0.02917003631591797
mini_batch_src_global generation:  0.05972695350646973
r_  generation:  0.5077524185180664
local_output_nid generation:  0.030791044235229492
local_in_edges_tensor generation:  0.031017065048217773
mini_batch_src_global generation:  0.06043386459350586
r_  generation:  0.5024654865264893
local_output_nid generation:  0.03054189682006836
local_in_edges_tensor generation:  0.03300356864929199
mini_batch_src_global generation:  0.05999135971069336
r_  generation:  0.5021286010742188
local_output_nid generation:  0.03061056137084961
local_in_edges_tensor generation:  0.028865575790405273
mini_batch_src_global generation:  0.058411598205566406
r_  generation:  0.500391960144043
local_output_nid generation:  0.030790328979492188
local_in_edges_tensor generation:  0.030811786651611328
mini_batch_src_global generation:  0.061791419982910156
r_  generation:  0.5017783641815186
----------------------check_connections_block total spend ----------------------------- 23.6082923412323
generate_one_block  0.6985867023468018
generate_one_block  0.6702070236206055
generate_one_block  0.6792621612548828
generate_one_block  0.6749870777130127
generate_one_block  0.7883789539337158
generate_one_block  0.6805644035339355
generate_one_block  0.6807451248168945
generate_one_block  0.6784873008728027
generate_one_block  0.6792585849761963
generate_one_block  0.6776304244995117
generate_one_block  0.6768341064453125
generate_one_block  0.6830551624298096
generate_one_block  0.68422532081604
generate_one_block  0.685650110244751
generate_one_block  0.6751806735992432
generate_one_block  0.6864781379699707
generate_one_block  0.6786971092224121
generate_one_block  0.679232120513916
generate_one_block  0.6825683116912842
generate_one_block  0.6722805500030518
generate_one_block  0.6760356426239014
generate_one_block  0.6808876991271973
generate_one_block  0.6808772087097168
generate_one_block  0.6868076324462891
generate_one_block  0.7050161361694336
generate_one_block  0.6866788864135742
generate_one_block  0.6927969455718994
generate_one_block  0.6733496189117432
generate_one_block  0.6763010025024414
generate_one_block  0.6799685955047607
generate_one_block  0.6722097396850586
generate_one_block  0.6782152652740479
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.13116121292114258  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

connection checking time:  32.58730459213257
block generation total time  29.983603715896606
average batch blocks generation time:  0.936987616121769
block dataloader generation time/epoch 65.99044495362502
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.1093754768371582  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.92269468307495  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10919427871704102  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.60398817062378  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.1094808578491211  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.776605129241943  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10906171798706055  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.553035259246826  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10932588577270508  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.923433780670166  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10928916931152344  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.96885871887207  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10938835144042969  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.981996536254883  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10919904708862305  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.56031560897827  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.1092829704284668  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.833266258239746  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.1090855598449707  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.93825101852417  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10915231704711914  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.607247829437256  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10952425003051758  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 21.190303802490234  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10955142974853516  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 21.28764772415161  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10891389846801758  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.148136138916016  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10907220840454102  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.915217876434326  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10929346084594727  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.74539852142334  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10927867889404297  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.74623966217041  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10909843444824219  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.662893772125244  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10943126678466797  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.960355758666992  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10884714126586914  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.121274948120117  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10914945602416992  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.59406805038452  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.1088099479675293  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.685829162597656  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10912942886352539  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.552438735961914  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10949993133544922  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 21.00460147857666  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10937261581420898  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.87869119644165  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10944557189941406  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 21.109601497650146  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.1097111701965332  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.93408441543579  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10902214050292969  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.64888095855713  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10958051681518555  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.924850463867188  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10941219329833984  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.692076683044434  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10905838012695312  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.481083869934082  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.1095113754272461  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.753697395324707  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02699217200279236 |0.022704146802425385 |0.6298995688557625 |9.769946336746216e-05 |1.1904548034071922 |0.005462646484375 |
----------------------------------------------------------pseudo_mini_loss sum 1.3272650241851807
Total (block generation + training)time/epoch 126.06482788232657
Training time/epoch 59.91615843772888
Training time without block to device /epoch 59.18962574005127
Training time without total dataloading part /epoch 58.259928941726685
load block tensor time/epoch 0.8637495040893555
block to device time/epoch 0.7265326976776123
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  9165011
Number of first layer input nodes during this epoch:  4811086
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.13128185272216797  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024962186813354492
range selection method range initialization spend 0.017082691192626953
time for parepare:  0.01772022247314453
local_output_nid generation:  0.0009469985961914062
local_in_edges_tensor generation:  0.0045337677001953125
mini_batch_src_global generation:  0.0025415420532226562
r_  generation:  0.015586376190185547
local_output_nid generation:  0.0013206005096435547
local_in_edges_tensor generation:  0.0007956027984619141
mini_batch_src_global generation:  0.0017161369323730469
r_  generation:  0.011733293533325195
local_output_nid generation:  0.0011434555053710938
local_in_edges_tensor generation:  0.0006809234619140625
mini_batch_src_global generation:  0.001341104507446289
r_  generation:  0.010122299194335938
local_output_nid generation:  0.0011713504791259766
local_in_edges_tensor generation:  0.0006732940673828125
mini_batch_src_global generation:  0.00124359130859375
r_  generation:  0.010315895080566406
local_output_nid generation:  0.0011353492736816406
local_in_edges_tensor generation:  0.0006830692291259766
mini_batch_src_global generation:  0.001371622085571289
r_  generation:  0.010523796081542969
local_output_nid generation:  0.0011255741119384766
local_in_edges_tensor generation:  0.0006659030914306641
mini_batch_src_global generation:  0.0013837814331054688
r_  generation:  0.010287761688232422
local_output_nid generation:  0.0010936260223388672
local_in_edges_tensor generation:  0.0006787776947021484
mini_batch_src_global generation:  0.0012977123260498047
r_  generation:  0.010468721389770508
local_output_nid generation:  0.0011451244354248047
local_in_edges_tensor generation:  0.0006537437438964844
mini_batch_src_global generation:  0.0013689994812011719
r_  generation:  0.010561227798461914
local_output_nid generation:  0.002336740493774414
local_in_edges_tensor generation:  0.0015025138854980469
mini_batch_src_global generation:  0.003538846969604492
r_  generation:  0.015191316604614258
local_output_nid generation:  0.0010724067687988281
local_in_edges_tensor generation:  0.0006692409515380859
mini_batch_src_global generation:  0.001422882080078125
r_  generation:  0.01079249382019043
local_output_nid generation:  0.0009758472442626953
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.001195669174194336
r_  generation:  0.01018071174621582
local_output_nid generation:  0.0009138584136962891
local_in_edges_tensor generation:  0.0006017684936523438
mini_batch_src_global generation:  0.001142263412475586
r_  generation:  0.010101318359375
local_output_nid generation:  0.0009086132049560547
local_in_edges_tensor generation:  0.0006182193756103516
mini_batch_src_global generation:  0.0011372566223144531
r_  generation:  0.010329246520996094
local_output_nid generation:  0.0009083747863769531
local_in_edges_tensor generation:  0.0005922317504882812
mini_batch_src_global generation:  0.0012421607971191406
r_  generation:  0.010459423065185547
local_output_nid generation:  0.0008909702301025391
local_in_edges_tensor generation:  0.0006282329559326172
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.01036977767944336
local_output_nid generation:  0.0008738040924072266
local_in_edges_tensor generation:  0.0006475448608398438
mini_batch_src_global generation:  0.0011835098266601562
r_  generation:  0.01076054573059082
local_output_nid generation:  0.0008976459503173828
local_in_edges_tensor generation:  0.0005831718444824219
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.010030508041381836
local_output_nid generation:  0.0009503364562988281
local_in_edges_tensor generation:  0.0006139278411865234
mini_batch_src_global generation:  0.0014090538024902344
r_  generation:  0.010172605514526367
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.0011143684387207031
r_  generation:  0.01004934310913086
local_output_nid generation:  0.0008671283721923828
local_in_edges_tensor generation:  0.0005843639373779297
mini_batch_src_global generation:  0.0012524127960205078
r_  generation:  0.010399341583251953
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0006320476531982422
mini_batch_src_global generation:  0.0014309883117675781
r_  generation:  0.010364532470703125
local_output_nid generation:  0.0008637905120849609
local_in_edges_tensor generation:  0.0005950927734375
mini_batch_src_global generation:  0.0011591911315917969
r_  generation:  0.010444402694702148
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0005824565887451172
mini_batch_src_global generation:  0.0014379024505615234
r_  generation:  0.010190486907958984
local_output_nid generation:  0.0008935928344726562
local_in_edges_tensor generation:  0.0005750656127929688
mini_batch_src_global generation:  0.0011599063873291016
r_  generation:  0.009984731674194336
local_output_nid generation:  0.0008764266967773438
local_in_edges_tensor generation:  0.0005621910095214844
mini_batch_src_global generation:  0.001100301742553711
r_  generation:  0.010132074356079102
local_output_nid generation:  0.0008883476257324219
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.0012538433074951172
r_  generation:  0.01017308235168457
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0005922317504882812
mini_batch_src_global generation:  0.0012133121490478516
r_  generation:  0.010454654693603516
local_output_nid generation:  0.0008943080902099609
local_in_edges_tensor generation:  0.0005903244018554688
mini_batch_src_global generation:  0.0011563301086425781
r_  generation:  0.010375022888183594
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0005822181701660156
mini_batch_src_global generation:  0.0011441707611083984
r_  generation:  0.010272741317749023
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0005941390991210938
mini_batch_src_global generation:  0.001199483871459961
r_  generation:  0.010771751403808594
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.0005676746368408203
mini_batch_src_global generation:  0.0011947154998779297
r_  generation:  0.010389328002929688
local_output_nid generation:  0.0008912086486816406
local_in_edges_tensor generation:  0.0005772113800048828
mini_batch_src_global generation:  0.0012199878692626953
r_  generation:  0.010545015335083008
----------------------check_connections_block total spend ----------------------------- 0.5502979755401611
generate_one_block  0.026181697845458984
generate_one_block  0.021291732788085938
generate_one_block  0.01948261260986328
generate_one_block  0.01914358139038086
generate_one_block  0.01965641975402832
generate_one_block  0.019093036651611328
generate_one_block  0.018841266632080078
generate_one_block  0.0192110538482666
generate_one_block  0.01986837387084961
generate_one_block  0.019236326217651367
generate_one_block  0.018396377563476562
generate_one_block  0.020618677139282227
generate_one_block  0.01971745491027832
generate_one_block  0.019173145294189453
generate_one_block  0.01891803741455078
generate_one_block  0.01942157745361328
generate_one_block  0.018173933029174805
generate_one_block  0.018594026565551758
generate_one_block  0.018349885940551758
generate_one_block  0.01905226707458496
generate_one_block  0.018815279006958008
generate_one_block  0.01914381980895996
generate_one_block  0.018869638442993164
generate_one_block  0.01811695098876953
generate_one_block  0.018846511840820312
generate_one_block  0.018693923950195312
generate_one_block  0.01915597915649414
generate_one_block  0.01885080337524414
generate_one_block  0.02156519889831543
generate_one_block  0.019684553146362305
generate_one_block  0.018767595291137695
generate_one_block  0.01906275749206543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04193377494812012
gen group dst list time:  0.02312755584716797
time for parepare:  0.019936561584472656
local_output_nid generation:  0.0059185028076171875
local_in_edges_tensor generation:  0.016334056854248047
mini_batch_src_global generation:  0.017775297164916992
r_  generation:  0.1675584316253662
local_output_nid generation:  0.00783848762512207
local_in_edges_tensor generation:  0.012166023254394531
mini_batch_src_global generation:  0.021632671356201172
r_  generation:  0.17513442039489746
local_output_nid generation:  0.009168863296508789
local_in_edges_tensor generation:  0.03542971611022949
mini_batch_src_global generation:  0.02053523063659668
r_  generation:  0.1809384822845459
local_output_nid generation:  0.009105920791625977
local_in_edges_tensor generation:  0.009336233139038086
mini_batch_src_global generation:  0.02167987823486328
r_  generation:  0.17745494842529297
local_output_nid generation:  0.009126901626586914
local_in_edges_tensor generation:  0.0115814208984375
mini_batch_src_global generation:  0.02201247215270996
r_  generation:  0.17997956275939941
local_output_nid generation:  0.009129524230957031
local_in_edges_tensor generation:  0.008669376373291016
mini_batch_src_global generation:  0.02217411994934082
r_  generation:  0.1811361312866211
local_output_nid generation:  0.00902700424194336
local_in_edges_tensor generation:  0.00921773910522461
mini_batch_src_global generation:  0.02239704132080078
r_  generation:  0.17957568168640137
local_output_nid generation:  0.00911259651184082
local_in_edges_tensor generation:  0.008794784545898438
mini_batch_src_global generation:  0.027875185012817383
r_  generation:  0.18223023414611816
local_output_nid generation:  0.009216547012329102
local_in_edges_tensor generation:  0.012151241302490234
mini_batch_src_global generation:  0.02729487419128418
r_  generation:  0.18759369850158691
local_output_nid generation:  0.009207725524902344
local_in_edges_tensor generation:  0.008797168731689453
mini_batch_src_global generation:  0.02296161651611328
r_  generation:  0.18448853492736816
local_output_nid generation:  0.008956432342529297
local_in_edges_tensor generation:  0.011535882949829102
mini_batch_src_global generation:  0.023576974868774414
r_  generation:  0.17777419090270996
local_output_nid generation:  0.009097814559936523
local_in_edges_tensor generation:  0.010103225708007812
mini_batch_src_global generation:  0.021840810775756836
r_  generation:  0.17696285247802734
local_output_nid generation:  0.009511709213256836
local_in_edges_tensor generation:  0.008921384811401367
mini_batch_src_global generation:  0.02333521842956543
r_  generation:  0.1835339069366455
local_output_nid generation:  0.009602069854736328
local_in_edges_tensor generation:  0.011844873428344727
mini_batch_src_global generation:  0.022905588150024414
r_  generation:  0.1857893466949463
local_output_nid generation:  0.009537935256958008
local_in_edges_tensor generation:  0.009003877639770508
mini_batch_src_global generation:  0.024740934371948242
r_  generation:  0.18471765518188477
local_output_nid generation:  0.009603500366210938
local_in_edges_tensor generation:  0.009035587310791016
mini_batch_src_global generation:  0.02452230453491211
r_  generation:  0.18918204307556152
local_output_nid generation:  0.009545326232910156
local_in_edges_tensor generation:  0.00867319107055664
mini_batch_src_global generation:  0.023174762725830078
r_  generation:  0.177168607711792
local_output_nid generation:  0.00946354866027832
local_in_edges_tensor generation:  0.008861780166625977
mini_batch_src_global generation:  0.02282118797302246
r_  generation:  0.18190908432006836
local_output_nid generation:  0.009271621704101562
local_in_edges_tensor generation:  0.00864863395690918
mini_batch_src_global generation:  0.022652387619018555
r_  generation:  0.17823195457458496
local_output_nid generation:  0.009701967239379883
local_in_edges_tensor generation:  0.008975505828857422
mini_batch_src_global generation:  0.022908687591552734
r_  generation:  0.18517661094665527
local_output_nid generation:  0.009533405303955078
local_in_edges_tensor generation:  0.009186267852783203
mini_batch_src_global generation:  0.024271488189697266
r_  generation:  0.1873912811279297
local_output_nid generation:  0.00980067253112793
local_in_edges_tensor generation:  0.009665489196777344
mini_batch_src_global generation:  0.02321457862854004
r_  generation:  0.19103503227233887
local_output_nid generation:  0.00971078872680664
local_in_edges_tensor generation:  0.008990049362182617
mini_batch_src_global generation:  0.02347278594970703
r_  generation:  0.18474650382995605
local_output_nid generation:  0.011008739471435547
local_in_edges_tensor generation:  0.008719444274902344
mini_batch_src_global generation:  0.022491931915283203
r_  generation:  0.18021035194396973
local_output_nid generation:  0.009770631790161133
local_in_edges_tensor generation:  0.009018898010253906
mini_batch_src_global generation:  0.02307581901550293
r_  generation:  0.18582487106323242
local_output_nid generation:  0.009687662124633789
local_in_edges_tensor generation:  0.0089263916015625
mini_batch_src_global generation:  0.02270960807800293
r_  generation:  0.18389511108398438
local_output_nid generation:  0.009731769561767578
local_in_edges_tensor generation:  0.008972883224487305
mini_batch_src_global generation:  0.02570056915283203
r_  generation:  0.18880653381347656
local_output_nid generation:  0.009529590606689453
local_in_edges_tensor generation:  0.009291648864746094
mini_batch_src_global generation:  0.022955656051635742
r_  generation:  0.18642139434814453
local_output_nid generation:  0.009608745574951172
local_in_edges_tensor generation:  0.00892186164855957
mini_batch_src_global generation:  0.028508424758911133
r_  generation:  0.187272310256958
local_output_nid generation:  0.009762048721313477
local_in_edges_tensor generation:  0.010687112808227539
mini_batch_src_global generation:  0.023696184158325195
r_  generation:  0.19581031799316406
local_output_nid generation:  0.009760141372680664
local_in_edges_tensor generation:  0.009368658065795898
mini_batch_src_global generation:  0.02327728271484375
r_  generation:  0.18412566184997559
local_output_nid generation:  0.009673595428466797
local_in_edges_tensor generation:  0.012040138244628906
mini_batch_src_global generation:  0.023825883865356445
r_  generation:  0.18968534469604492
----------------------check_connections_block total spend ----------------------------- 8.610522031784058
generate_one_block  0.2647721767425537
generate_one_block  0.2511446475982666
generate_one_block  0.24558234214782715
generate_one_block  0.252469539642334
generate_one_block  0.2769663333892822
generate_one_block  0.2557687759399414
generate_one_block  0.25082945823669434
generate_one_block  0.25218796730041504
generate_one_block  0.2603645324707031
generate_one_block  0.25281381607055664
generate_one_block  0.24184894561767578
generate_one_block  0.24088811874389648
generate_one_block  0.25164246559143066
generate_one_block  0.252122163772583
generate_one_block  0.24815130233764648
generate_one_block  0.25453782081604004
generate_one_block  0.24150586128234863
generate_one_block  0.2442917823791504
generate_one_block  0.2380368709564209
generate_one_block  0.26096606254577637
generate_one_block  0.25969386100769043
generate_one_block  0.2552473545074463
generate_one_block  0.24775385856628418
generate_one_block  0.2389991283416748
generate_one_block  0.24827837944030762
generate_one_block  0.24634289741516113
generate_one_block  0.2525489330291748
generate_one_block  0.25014328956604004
generate_one_block  0.25424933433532715
generate_one_block  0.2595806121826172
generate_one_block  0.2435925006866455
generate_one_block  0.25318384170532227
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04140281677246094
gen group dst list time:  0.11311507225036621
time for parepare:  0.019344568252563477
local_output_nid generation:  0.026163101196289062
local_in_edges_tensor generation:  0.05278277397155762
mini_batch_src_global generation:  0.04706716537475586
r_  generation:  0.4917757511138916
local_output_nid generation:  0.030811548233032227
local_in_edges_tensor generation:  0.03746342658996582
mini_batch_src_global generation:  0.05904340744018555
r_  generation:  0.4994847774505615
local_output_nid generation:  0.03125572204589844
local_in_edges_tensor generation:  0.031965017318725586
mini_batch_src_global generation:  0.05753922462463379
r_  generation:  0.5007965564727783
local_output_nid generation:  0.031027793884277344
local_in_edges_tensor generation:  0.03253436088562012
mini_batch_src_global generation:  0.05862593650817871
r_  generation:  0.4932258129119873
local_output_nid generation:  0.031089067459106445
local_in_edges_tensor generation:  0.030579805374145508
mini_batch_src_global generation:  0.05782485008239746
r_  generation:  0.503849983215332
local_output_nid generation:  0.03132796287536621
local_in_edges_tensor generation:  0.0306856632232666
mini_batch_src_global generation:  0.05931544303894043
r_  generation:  0.5018906593322754
local_output_nid generation:  0.02982497215270996
local_in_edges_tensor generation:  0.0310516357421875
mini_batch_src_global generation:  0.05827808380126953
r_  generation:  0.507131814956665
local_output_nid generation:  0.02999734878540039
local_in_edges_tensor generation:  0.03058624267578125
mini_batch_src_global generation:  0.059764862060546875
r_  generation:  0.5042920112609863
local_output_nid generation:  0.029553651809692383
local_in_edges_tensor generation:  0.03148984909057617
mini_batch_src_global generation:  0.0603024959564209
r_  generation:  0.5098316669464111
local_output_nid generation:  0.03000664710998535
local_in_edges_tensor generation:  0.030678510665893555
mini_batch_src_global generation:  0.0602414608001709
r_  generation:  0.5028140544891357
local_output_nid generation:  0.029448986053466797
local_in_edges_tensor generation:  0.0338287353515625
mini_batch_src_global generation:  0.05802440643310547
r_  generation:  0.505138635635376
local_output_nid generation:  0.02956247329711914
local_in_edges_tensor generation:  0.03219246864318848
mini_batch_src_global generation:  0.05939507484436035
r_  generation:  0.49626779556274414
local_output_nid generation:  0.03107285499572754
local_in_edges_tensor generation:  0.033774614334106445
mini_batch_src_global generation:  0.05837678909301758
r_  generation:  0.5057830810546875
local_output_nid generation:  0.03032231330871582
local_in_edges_tensor generation:  0.030904293060302734
mini_batch_src_global generation:  0.06113600730895996
r_  generation:  0.5025203227996826
local_output_nid generation:  0.02979421615600586
local_in_edges_tensor generation:  0.03055095672607422
mini_batch_src_global generation:  0.058808088302612305
r_  generation:  0.5090267658233643
local_output_nid generation:  0.03086686134338379
local_in_edges_tensor generation:  0.033510684967041016
mini_batch_src_global generation:  0.06067943572998047
r_  generation:  0.5062122344970703
local_output_nid generation:  0.031406402587890625
local_in_edges_tensor generation:  0.030818700790405273
mini_batch_src_global generation:  0.05874013900756836
r_  generation:  0.502061128616333
local_output_nid generation:  0.03034806251525879
local_in_edges_tensor generation:  0.030634641647338867
mini_batch_src_global generation:  0.060363054275512695
r_  generation:  0.5113160610198975
local_output_nid generation:  0.03032660484313965
local_in_edges_tensor generation:  0.028958559036254883
mini_batch_src_global generation:  0.058007240295410156
r_  generation:  0.5000238418579102
local_output_nid generation:  0.03069281578063965
local_in_edges_tensor generation:  0.03163456916809082
mini_batch_src_global generation:  0.06001687049865723
r_  generation:  0.5027854442596436
local_output_nid generation:  0.030765533447265625
local_in_edges_tensor generation:  0.033147573471069336
mini_batch_src_global generation:  0.05884695053100586
r_  generation:  0.5084142684936523
local_output_nid generation:  0.030626296997070312
local_in_edges_tensor generation:  0.03281521797180176
mini_batch_src_global generation:  0.06021261215209961
r_  generation:  0.5130541324615479
local_output_nid generation:  0.03098773956298828
local_in_edges_tensor generation:  0.029522180557250977
mini_batch_src_global generation:  0.0585017204284668
r_  generation:  0.5073440074920654
local_output_nid generation:  0.030890941619873047
local_in_edges_tensor generation:  0.031085491180419922
mini_batch_src_global generation:  0.059324026107788086
r_  generation:  0.5048174858093262
local_output_nid generation:  0.03086376190185547
local_in_edges_tensor generation:  0.03384208679199219
mini_batch_src_global generation:  0.05877518653869629
r_  generation:  0.5086328983306885
local_output_nid generation:  0.030991554260253906
local_in_edges_tensor generation:  0.03355836868286133
mini_batch_src_global generation:  0.06137394905090332
r_  generation:  0.5035665035247803
local_output_nid generation:  0.03074955940246582
local_in_edges_tensor generation:  0.02995920181274414
mini_batch_src_global generation:  0.058606624603271484
r_  generation:  0.5051803588867188
local_output_nid generation:  0.03056812286376953
local_in_edges_tensor generation:  0.032998085021972656
mini_batch_src_global generation:  0.05984091758728027
r_  generation:  0.4985175132751465
local_output_nid generation:  0.030742168426513672
local_in_edges_tensor generation:  0.0327908992767334
mini_batch_src_global generation:  0.05894589424133301
r_  generation:  0.5097775459289551
local_output_nid generation:  0.030822038650512695
local_in_edges_tensor generation:  0.03287076950073242
mini_batch_src_global generation:  0.06161308288574219
r_  generation:  0.5025801658630371
local_output_nid generation:  0.030660390853881836
local_in_edges_tensor generation:  0.02910161018371582
mini_batch_src_global generation:  0.059207916259765625
r_  generation:  0.5061244964599609
local_output_nid generation:  0.030620098114013672
local_in_edges_tensor generation:  0.02869725227355957
mini_batch_src_global generation:  0.05968761444091797
r_  generation:  0.5021970272064209
----------------------check_connections_block total spend ----------------------------- 23.558310508728027
generate_one_block  0.6996364593505859
generate_one_block  0.6763129234313965
generate_one_block  0.6784679889678955
generate_one_block  0.6822919845581055
generate_one_block  0.7886888980865479
generate_one_block  0.6827797889709473
generate_one_block  0.6772315502166748
generate_one_block  0.6821990013122559
generate_one_block  0.6854355335235596
generate_one_block  0.677628755569458
generate_one_block  0.6854128837585449
generate_one_block  0.6810340881347656
generate_one_block  0.6817009449005127
generate_one_block  0.6813573837280273
generate_one_block  0.6759490966796875
generate_one_block  0.6880111694335938
generate_one_block  0.6786000728607178
generate_one_block  0.679335355758667
generate_one_block  0.6757783889770508
generate_one_block  0.686525821685791
generate_one_block  0.6856138706207275
generate_one_block  0.6845078468322754
generate_one_block  0.6710565090179443
generate_one_block  0.6735072135925293
generate_one_block  0.7066433429718018
generate_one_block  0.6757793426513672
generate_one_block  0.6842541694641113
generate_one_block  0.6774306297302246
generate_one_block  0.6989994049072266
generate_one_block  0.6872062683105469
generate_one_block  0.6805009841918945
generate_one_block  0.680605411529541
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.13128185272216797  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

connection checking time:  32.168832540512085
block generation total time  29.99698805809021
average batch blocks generation time:  0.9374058768153191
block dataloader generation time/epoch 65.97937420436314
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10933351516723633  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.869545459747314  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10925102233886719  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.735432147979736  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10897207260131836  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.64646291732788  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10927915573120117  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.871260166168213  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.1092071533203125  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.872093677520752  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.1093435287475586  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.82257890701294  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10904216766357422  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.75050115585327  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.1096200942993164  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.883057117462158  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10932588577270508  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 21.167466163635254  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10918426513671875  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.91347360610962  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10880708694458008  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.409966468811035  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10871171951293945  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.42471218109131  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10935258865356445  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.848727703094482  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10930013656616211  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.915923595428467  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.10905313491821289  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.792224884033203  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10956668853759766  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.129565238952637  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10885477066040039  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.418365001678467  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10903692245483398  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.628511905670166  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10873126983642578  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.357760429382324  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10934782028198242  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.799203395843506  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1094217300415039  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.989537239074707  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10948991775512695  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.01172113418579  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1092677116394043  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.78648328781128  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10900211334228516  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.367918968200684  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10960865020751953  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.828094959259033  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10930681228637695  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.653196334838867  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10920906066894531  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.874664306640625  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10895586013793945  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.696068286895752  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1093130111694336  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.899590492248535  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1095576286315918  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.205405235290527  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10908174514770508  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.64645528793335  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10908794403076172  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.929431438446045  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03619761019945145 |0.023326553404331207 |0.6306191086769104 |9.570270776748657e-05 |1.190715566277504 |0.005803108215332031 |
----------------------------------------------------------pseudo_mini_loss sum 1.3228307962417603
Total (block generation + training)time/epoch 126.06662876265389
Training time/epoch 60.25431966781616
Training time without block to device /epoch 59.50786995887756
Training time without total dataloading part /epoch 58.29157519340515
load block tensor time/epoch 1.1583235263824463
block to device time/epoch 0.7464497089385986
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  9160896
Number of first layer input nodes during this epoch:  4806729
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.13179922103881836  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025346755981445312
range selection method range initialization spend 0.014428377151489258
time for parepare:  0.02031087875366211
local_output_nid generation:  0.0010235309600830078
local_in_edges_tensor generation:  0.007831573486328125
mini_batch_src_global generation:  0.0016143321990966797
r_  generation:  0.010921955108642578
local_output_nid generation:  0.0009999275207519531
local_in_edges_tensor generation:  0.0006926059722900391
mini_batch_src_global generation:  0.0015676021575927734
r_  generation:  0.010950803756713867
local_output_nid generation:  0.0009527206420898438
local_in_edges_tensor generation:  0.0006213188171386719
mini_batch_src_global generation:  0.0011820793151855469
r_  generation:  0.009963274002075195
local_output_nid generation:  0.0009372234344482422
local_in_edges_tensor generation:  0.0006194114685058594
mini_batch_src_global generation:  0.0010647773742675781
r_  generation:  0.009721994400024414
local_output_nid generation:  0.0009126663208007812
local_in_edges_tensor generation:  0.0006008148193359375
mini_batch_src_global generation:  0.001027822494506836
r_  generation:  0.009776115417480469
local_output_nid generation:  0.0008857250213623047
local_in_edges_tensor generation:  0.0006039142608642578
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.010148286819458008
local_output_nid generation:  0.0008871555328369141
local_in_edges_tensor generation:  0.0005860328674316406
mini_batch_src_global generation:  0.0011582374572753906
r_  generation:  0.010314464569091797
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0010504722595214844
r_  generation:  0.009891986846923828
local_output_nid generation:  0.0008826255798339844
local_in_edges_tensor generation:  0.0006053447723388672
mini_batch_src_global generation:  0.001050710678100586
r_  generation:  0.01034235954284668
local_output_nid generation:  0.0008728504180908203
local_in_edges_tensor generation:  0.0006015300750732422
mini_batch_src_global generation:  0.0011577606201171875
r_  generation:  0.010746955871582031
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.0011682510375976562
r_  generation:  0.010258913040161133
local_output_nid generation:  0.0008590221405029297
local_in_edges_tensor generation:  0.000591278076171875
mini_batch_src_global generation:  0.001196146011352539
r_  generation:  0.010457754135131836
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0005893707275390625
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.010538578033447266
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0005843639373779297
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.010478734970092773
local_output_nid generation:  0.0008461475372314453
local_in_edges_tensor generation:  0.0005772113800048828
mini_batch_src_global generation:  0.0011370182037353516
r_  generation:  0.010180473327636719
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.0011105537414550781
r_  generation:  0.010245561599731445
local_output_nid generation:  0.0008718967437744141
local_in_edges_tensor generation:  0.0006000995635986328
mini_batch_src_global generation:  0.0012714862823486328
r_  generation:  0.010739564895629883
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005838871002197266
mini_batch_src_global generation:  0.001125335693359375
r_  generation:  0.010218381881713867
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0006089210510253906
mini_batch_src_global generation:  0.0011458396911621094
r_  generation:  0.010366201400756836
local_output_nid generation:  0.0008804798126220703
local_in_edges_tensor generation:  0.0006055831909179688
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.0106353759765625
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005750656127929688
mini_batch_src_global generation:  0.0011801719665527344
r_  generation:  0.010187625885009766
local_output_nid generation:  0.0008728504180908203
local_in_edges_tensor generation:  0.0006008148193359375
mini_batch_src_global generation:  0.0010597705841064453
r_  generation:  0.01213693618774414
local_output_nid generation:  0.0009336471557617188
local_in_edges_tensor generation:  0.0006310939788818359
mini_batch_src_global generation:  0.0012311935424804688
r_  generation:  0.010976552963256836
local_output_nid generation:  0.0008761882781982422
local_in_edges_tensor generation:  0.0006029605865478516
mini_batch_src_global generation:  0.0011706352233886719
r_  generation:  0.010406494140625
local_output_nid generation:  0.0008649826049804688
local_in_edges_tensor generation:  0.0005903244018554688
mini_batch_src_global generation:  0.0012133121490478516
r_  generation:  0.010278940200805664
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0005917549133300781
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.010650873184204102
local_output_nid generation:  0.0008606910705566406
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0011641979217529297
r_  generation:  0.01035618782043457
local_output_nid generation:  0.0008592605590820312
local_in_edges_tensor generation:  0.0005903244018554688
mini_batch_src_global generation:  0.0011544227600097656
r_  generation:  0.010610342025756836
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0006101131439208984
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.010763168334960938
local_output_nid generation:  0.000865936279296875
local_in_edges_tensor generation:  0.0005910396575927734
mini_batch_src_global generation:  0.0011682510375976562
r_  generation:  0.010535240173339844
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0005958080291748047
mini_batch_src_global generation:  0.0012285709381103516
r_  generation:  0.010538101196289062
local_output_nid generation:  0.0008618831634521484
local_in_edges_tensor generation:  0.0005860328674316406
mini_batch_src_global generation:  0.0011930465698242188
r_  generation:  0.010522842407226562
----------------------check_connections_block total spend ----------------------------- 0.5294482707977295
generate_one_block  0.02155900001525879
generate_one_block  0.021294832229614258
generate_one_block  0.01923370361328125
generate_one_block  0.0185699462890625
generate_one_block  0.01846456527709961
generate_one_block  0.018967390060424805
generate_one_block  0.018765926361083984
generate_one_block  0.018512725830078125
generate_one_block  0.018871068954467773
generate_one_block  0.01956319808959961
generate_one_block  0.01845264434814453
generate_one_block  0.021290302276611328
generate_one_block  0.019475936889648438
generate_one_block  0.018805980682373047
generate_one_block  0.018166542053222656
generate_one_block  0.018551349639892578
generate_one_block  0.019202232360839844
generate_one_block  0.0183103084564209
generate_one_block  0.01866459846496582
generate_one_block  0.018944740295410156
generate_one_block  0.01840972900390625
generate_one_block  0.02000260353088379
generate_one_block  0.020209312438964844
generate_one_block  0.022780179977416992
generate_one_block  0.018656015396118164
generate_one_block  0.0192263126373291
generate_one_block  0.018810033798217773
generate_one_block  0.019303083419799805
generate_one_block  0.019227027893066406
generate_one_block  0.019090652465820312
generate_one_block  0.01887679100036621
generate_one_block  0.018802404403686523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037934303283691406
gen group dst list time:  0.022730588912963867
time for parepare:  0.022045135498046875
local_output_nid generation:  0.005800008773803711
local_in_edges_tensor generation:  0.019841909408569336
mini_batch_src_global generation:  0.017895936965942383
r_  generation:  0.1641526222229004
local_output_nid generation:  0.007885217666625977
local_in_edges_tensor generation:  0.010921955108642578
mini_batch_src_global generation:  0.021814823150634766
r_  generation:  0.17004871368408203
local_output_nid generation:  0.008047342300415039
local_in_edges_tensor generation:  0.03310847282409668
mini_batch_src_global generation:  0.020386219024658203
r_  generation:  0.1725921630859375
local_output_nid generation:  0.008142709732055664
local_in_edges_tensor generation:  0.008666276931762695
mini_batch_src_global generation:  0.021062135696411133
r_  generation:  0.17360544204711914
local_output_nid generation:  0.008591890335083008
local_in_edges_tensor generation:  0.00860285758972168
mini_batch_src_global generation:  0.021575927734375
r_  generation:  0.17696738243103027
local_output_nid generation:  0.009012460708618164
local_in_edges_tensor generation:  0.011033296585083008
mini_batch_src_global generation:  0.02285146713256836
r_  generation:  0.17961382865905762
local_output_nid generation:  0.008960247039794922
local_in_edges_tensor generation:  0.009147405624389648
mini_batch_src_global generation:  0.02237081527709961
r_  generation:  0.1790928840637207
local_output_nid generation:  0.008688688278198242
local_in_edges_tensor generation:  0.008849382400512695
mini_batch_src_global generation:  0.02220010757446289
r_  generation:  0.17786216735839844
local_output_nid generation:  0.008707284927368164
local_in_edges_tensor generation:  0.008856058120727539
mini_batch_src_global generation:  0.026620864868164062
r_  generation:  0.18220138549804688
local_output_nid generation:  0.009155511856079102
local_in_edges_tensor generation:  0.012181520462036133
mini_batch_src_global generation:  0.024460554122924805
r_  generation:  0.1907808780670166
local_output_nid generation:  0.009176015853881836
local_in_edges_tensor generation:  0.008797168731689453
mini_batch_src_global generation:  0.02317976951599121
r_  generation:  0.17990779876708984
local_output_nid generation:  0.009066581726074219
local_in_edges_tensor generation:  0.010227203369140625
mini_batch_src_global generation:  0.023603439331054688
r_  generation:  0.1833045482635498
local_output_nid generation:  0.00928044319152832
local_in_edges_tensor generation:  0.011145830154418945
mini_batch_src_global generation:  0.02375483512878418
r_  generation:  0.18589353561401367
local_output_nid generation:  0.009432315826416016
local_in_edges_tensor generation:  0.00913691520690918
mini_batch_src_global generation:  0.022932767868041992
r_  generation:  0.1853957176208496
local_output_nid generation:  0.009095191955566406
local_in_edges_tensor generation:  0.010075569152832031
mini_batch_src_global generation:  0.022426843643188477
r_  generation:  0.17718863487243652
local_output_nid generation:  0.009256124496459961
local_in_edges_tensor generation:  0.008740663528442383
mini_batch_src_global generation:  0.021805763244628906
r_  generation:  0.1802384853363037
local_output_nid generation:  0.009633302688598633
local_in_edges_tensor generation:  0.009069204330444336
mini_batch_src_global generation:  0.026330947875976562
r_  generation:  0.18947386741638184
local_output_nid generation:  0.009174108505249023
local_in_edges_tensor generation:  0.008882999420166016
mini_batch_src_global generation:  0.022494792938232422
r_  generation:  0.18187403678894043
local_output_nid generation:  0.009265422821044922
local_in_edges_tensor generation:  0.008886098861694336
mini_batch_src_global generation:  0.02393054962158203
r_  generation:  0.18534636497497559
local_output_nid generation:  0.009426593780517578
local_in_edges_tensor generation:  0.00970149040222168
mini_batch_src_global generation:  0.02283167839050293
r_  generation:  0.18427681922912598
local_output_nid generation:  0.009331703186035156
local_in_edges_tensor generation:  0.009073257446289062
mini_batch_src_global generation:  0.022786617279052734
r_  generation:  0.18121933937072754
local_output_nid generation:  0.009962797164916992
local_in_edges_tensor generation:  0.011206388473510742
mini_batch_src_global generation:  0.024992942810058594
r_  generation:  0.1979973316192627
local_output_nid generation:  0.009331226348876953
local_in_edges_tensor generation:  0.009216785430908203
mini_batch_src_global generation:  0.023092985153198242
r_  generation:  0.18302607536315918
local_output_nid generation:  0.009401082992553711
local_in_edges_tensor generation:  0.009509563446044922
mini_batch_src_global generation:  0.023644447326660156
r_  generation:  0.1852877140045166
local_output_nid generation:  0.009405851364135742
local_in_edges_tensor generation:  0.009659290313720703
mini_batch_src_global generation:  0.022668838500976562
r_  generation:  0.18366193771362305
local_output_nid generation:  0.009548187255859375
local_in_edges_tensor generation:  0.009357452392578125
mini_batch_src_global generation:  0.023476123809814453
r_  generation:  0.1896512508392334
local_output_nid generation:  0.009418010711669922
local_in_edges_tensor generation:  0.009461164474487305
mini_batch_src_global generation:  0.023488283157348633
r_  generation:  0.18654203414916992
local_output_nid generation:  0.009724140167236328
local_in_edges_tensor generation:  0.010267257690429688
mini_batch_src_global generation:  0.023523569107055664
r_  generation:  0.19259881973266602
local_output_nid generation:  0.009759902954101562
local_in_edges_tensor generation:  0.00897836685180664
mini_batch_src_global generation:  0.024229049682617188
r_  generation:  0.1907973289489746
local_output_nid generation:  0.009506702423095703
local_in_edges_tensor generation:  0.01104116439819336
mini_batch_src_global generation:  0.02331995964050293
r_  generation:  0.19046354293823242
local_output_nid generation:  0.009526968002319336
local_in_edges_tensor generation:  0.00930333137512207
mini_batch_src_global generation:  0.02323627471923828
r_  generation:  0.1839756965637207
local_output_nid generation:  0.009292840957641602
local_in_edges_tensor generation:  0.009539365768432617
mini_batch_src_global generation:  0.02266216278076172
r_  generation:  0.18474984169006348
----------------------check_connections_block total spend ----------------------------- 8.557903051376343
generate_one_block  0.25150442123413086
generate_one_block  0.24213910102844238
generate_one_block  0.24326443672180176
generate_one_block  0.2392258644104004
generate_one_block  0.25910258293151855
generate_one_block  0.24686837196350098
generate_one_block  0.24449419975280762
generate_one_block  0.23949408531188965
generate_one_block  0.24640202522277832
generate_one_block  0.2602574825286865
generate_one_block  0.2414250373840332
generate_one_block  0.2472844123840332
generate_one_block  0.250873327255249
generate_one_block  0.24769306182861328
generate_one_block  0.23430752754211426
generate_one_block  0.23874473571777344
generate_one_block  0.25423669815063477
generate_one_block  0.24168729782104492
generate_one_block  0.24701666831970215
generate_one_block  0.25112199783325195
generate_one_block  0.24124550819396973
generate_one_block  0.2681713104248047
generate_one_block  0.2386789321899414
generate_one_block  0.24590039253234863
generate_one_block  0.2436223030090332
generate_one_block  0.2538270950317383
generate_one_block  0.2496018409729004
generate_one_block  0.26038312911987305
generate_one_block  0.25351428985595703
generate_one_block  0.2511758804321289
generate_one_block  0.24765324592590332
generate_one_block  0.24634957313537598
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03751778602600098
gen group dst list time:  0.10556197166442871
time for parepare:  0.01923966407775879
local_output_nid generation:  0.024664878845214844
local_in_edges_tensor generation:  0.05222940444946289
mini_batch_src_global generation:  0.04788827896118164
r_  generation:  0.49012279510498047
local_output_nid generation:  0.03028559684753418
local_in_edges_tensor generation:  0.03684282302856445
mini_batch_src_global generation:  0.061382293701171875
r_  generation:  0.48636531829833984
local_output_nid generation:  0.030683040618896484
local_in_edges_tensor generation:  0.033186912536621094
mini_batch_src_global generation:  0.05774402618408203
r_  generation:  0.4993321895599365
local_output_nid generation:  0.031113862991333008
local_in_edges_tensor generation:  0.03704380989074707
mini_batch_src_global generation:  0.05938458442687988
r_  generation:  0.494457483291626
local_output_nid generation:  0.030716896057128906
local_in_edges_tensor generation:  0.030068159103393555
mini_batch_src_global generation:  0.06012272834777832
r_  generation:  0.4993014335632324
local_output_nid generation:  0.031007051467895508
local_in_edges_tensor generation:  0.03570199012756348
mini_batch_src_global generation:  0.05937910079956055
r_  generation:  0.4980130195617676
local_output_nid generation:  0.02954864501953125
local_in_edges_tensor generation:  0.028664350509643555
mini_batch_src_global generation:  0.058875083923339844
r_  generation:  0.49887728691101074
local_output_nid generation:  0.02906036376953125
local_in_edges_tensor generation:  0.02814793586730957
mini_batch_src_global generation:  0.06240367889404297
r_  generation:  0.4950284957885742
local_output_nid generation:  0.029180526733398438
local_in_edges_tensor generation:  0.028971433639526367
mini_batch_src_global generation:  0.058718204498291016
r_  generation:  0.5032985210418701
local_output_nid generation:  0.029485464096069336
local_in_edges_tensor generation:  0.038580894470214844
mini_batch_src_global generation:  0.062467098236083984
r_  generation:  0.5031747817993164
local_output_nid generation:  0.029392242431640625
local_in_edges_tensor generation:  0.030105113983154297
mini_batch_src_global generation:  0.05903029441833496
r_  generation:  0.5015506744384766
local_output_nid generation:  0.029356718063354492
local_in_edges_tensor generation:  0.03136157989501953
mini_batch_src_global generation:  0.06002664566040039
r_  generation:  0.5020501613616943
local_output_nid generation:  0.02921438217163086
local_in_edges_tensor generation:  0.03378725051879883
mini_batch_src_global generation:  0.05926394462585449
r_  generation:  0.5010015964508057
local_output_nid generation:  0.029321670532226562
local_in_edges_tensor generation:  0.028237342834472656
mini_batch_src_global generation:  0.06005978584289551
r_  generation:  0.49779772758483887
local_output_nid generation:  0.029360294342041016
local_in_edges_tensor generation:  0.034288883209228516
mini_batch_src_global generation:  0.05913186073303223
r_  generation:  0.49593043327331543
local_output_nid generation:  0.029044389724731445
local_in_edges_tensor generation:  0.03020167350769043
mini_batch_src_global generation:  0.05923771858215332
r_  generation:  0.49605655670166016
local_output_nid generation:  0.029342174530029297
local_in_edges_tensor generation:  0.0316004753112793
mini_batch_src_global generation:  0.05849289894104004
r_  generation:  0.5017833709716797
local_output_nid generation:  0.029074668884277344
local_in_edges_tensor generation:  0.028852462768554688
mini_batch_src_global generation:  0.05979299545288086
r_  generation:  0.5006227493286133
local_output_nid generation:  0.029394865036010742
local_in_edges_tensor generation:  0.029512882232666016
mini_batch_src_global generation:  0.05957460403442383
r_  generation:  0.49919843673706055
local_output_nid generation:  0.029438018798828125
local_in_edges_tensor generation:  0.028264522552490234
mini_batch_src_global generation:  0.059980154037475586
r_  generation:  0.49974894523620605
local_output_nid generation:  0.029188871383666992
local_in_edges_tensor generation:  0.03092360496520996
mini_batch_src_global generation:  0.05852675437927246
r_  generation:  0.5020406246185303
local_output_nid generation:  0.029621601104736328
local_in_edges_tensor generation:  0.032711029052734375
mini_batch_src_global generation:  0.060048818588256836
r_  generation:  0.5045444965362549
local_output_nid generation:  0.029725074768066406
local_in_edges_tensor generation:  0.03139662742614746
mini_batch_src_global generation:  0.0584869384765625
r_  generation:  0.5037851333618164
local_output_nid generation:  0.030364036560058594
local_in_edges_tensor generation:  0.030844688415527344
mini_batch_src_global generation:  0.05973649024963379
r_  generation:  0.5014185905456543
local_output_nid generation:  0.029706478118896484
local_in_edges_tensor generation:  0.03089761734008789
mini_batch_src_global generation:  0.05878281593322754
r_  generation:  0.5049231052398682
local_output_nid generation:  0.0298612117767334
local_in_edges_tensor generation:  0.03123784065246582
mini_batch_src_global generation:  0.06049990653991699
r_  generation:  0.5029449462890625
local_output_nid generation:  0.029414653778076172
local_in_edges_tensor generation:  0.030821800231933594
mini_batch_src_global generation:  0.05916643142700195
r_  generation:  0.5075099468231201
local_output_nid generation:  0.03015303611755371
local_in_edges_tensor generation:  0.031774282455444336
mini_batch_src_global generation:  0.06099128723144531
r_  generation:  0.5070521831512451
local_output_nid generation:  0.029707908630371094
local_in_edges_tensor generation:  0.031737327575683594
mini_batch_src_global generation:  0.05932736396789551
r_  generation:  0.5059459209442139
local_output_nid generation:  0.02932906150817871
local_in_edges_tensor generation:  0.030259132385253906
mini_batch_src_global generation:  0.05970120429992676
r_  generation:  0.49945926666259766
local_output_nid generation:  0.029337167739868164
local_in_edges_tensor generation:  0.030771493911743164
mini_batch_src_global generation:  0.058988332748413086
r_  generation:  0.5097792148590088
local_output_nid generation:  0.030347108840942383
local_in_edges_tensor generation:  0.030922412872314453
mini_batch_src_global generation:  0.060112953186035156
r_  generation:  0.4947988986968994
----------------------check_connections_block total spend ----------------------------- 23.38262915611267
generate_one_block  0.6862900257110596
generate_one_block  0.6814539432525635
generate_one_block  0.6755802631378174
generate_one_block  0.6759870052337646
generate_one_block  0.7651689052581787
generate_one_block  0.6776173114776611
generate_one_block  0.6776533126831055
generate_one_block  0.6785702705383301
generate_one_block  0.6792809963226318
generate_one_block  0.6796023845672607
generate_one_block  0.6784799098968506
generate_one_block  0.6718242168426514
generate_one_block  0.6790928840637207
generate_one_block  0.680121898651123
generate_one_block  0.6757388114929199
generate_one_block  0.6719563007354736
generate_one_block  0.6739652156829834
generate_one_block  0.6735546588897705
generate_one_block  0.6814610958099365
generate_one_block  0.6857690811157227
generate_one_block  0.6791040897369385
generate_one_block  0.6873741149902344
generate_one_block  0.6812405586242676
generate_one_block  0.6796936988830566
generate_one_block  0.7001025676727295
generate_one_block  0.6792144775390625
generate_one_block  0.6799008846282959
generate_one_block  0.6808454990386963
generate_one_block  0.6807725429534912
generate_one_block  0.6799914836883545
generate_one_block  0.680267333984375
generate_one_block  0.6743810176849365
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.13179922103881836  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

connection checking time:  31.940532207489014
block generation total time  29.759323596954346
average batch blocks generation time:  0.9299788624048233
block dataloader generation time/epoch 65.93506428400676
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10927963256835938  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.74391746520996  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10886669158935547  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.53015947341919  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1093912124633789  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.730398178100586  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10941743850708008  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.598662853240967  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10901260375976562  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.58473253250122  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10937261581420898  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.745206832885742  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10906410217285156  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.66509771347046  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10913562774658203  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.5612850189209  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10906553268432617  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.759883880615234  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10960054397583008  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.27364730834961  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1093440055847168  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.603415966033936  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10912847518920898  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.80476713180542  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10926246643066406  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.02872610092163  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10918760299682617  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.82266902923584  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10902881622314453  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.256776809692383  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10876035690307617  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.366366386413574  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10939216613769531  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.037959575653076  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10886716842651367  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.50771999359131  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10908985137939453  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.781035900115967  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1091609001159668  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.675562381744385  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10919475555419922  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.570597171783447  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10956192016601562  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.44658327102661  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10898590087890625  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.439231872558594  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10913991928100586  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.739655017852783  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10913372039794922  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.6260027885437  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10945510864257812  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.923521041870117  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10929155349731445  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.751640796661377  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10963582992553711  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.18770408630371  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1094827651977539  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.021613121032715  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10905313491821289  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.90335988998413  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10915851593017578  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.72478437423706  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10890626907348633  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.578930854797363  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02786053717136383 |0.021300658583641052 |0.6277102530002594 |9.685009717941284e-05 |1.184377260506153 |0.0058515071868896484 |
----------------------------------------------------------pseudo_mini_loss sum 1.3196486234664917
Total (block generation + training)time/epoch 125.99228458404541
Training time/epoch 59.63646483421326
Training time without block to device /epoch 58.95484375953674
Training time without total dataloading part /epoch 57.99575114250183
load block tensor time/epoch 0.8915371894836426
block to device time/epoch 0.6816210746765137
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  9157999
Number of first layer input nodes during this epoch:  4807796
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.13142156600952148  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026651859283447266
range selection method range initialization spend 0.013857603073120117
time for parepare:  0.01944112777709961
local_output_nid generation:  0.0010025501251220703
local_in_edges_tensor generation:  0.005747079849243164
mini_batch_src_global generation:  0.0015690326690673828
r_  generation:  0.011197090148925781
local_output_nid generation:  0.0009768009185791016
local_in_edges_tensor generation:  0.0006892681121826172
mini_batch_src_global generation:  0.001392364501953125
r_  generation:  0.010592222213745117
local_output_nid generation:  0.0009372234344482422
local_in_edges_tensor generation:  0.000621795654296875
mini_batch_src_global generation:  0.0011017322540283203
r_  generation:  0.009588241577148438
local_output_nid generation:  0.0009016990661621094
local_in_edges_tensor generation:  0.0006155967712402344
mini_batch_src_global generation:  0.0010521411895751953
r_  generation:  0.009716510772705078
local_output_nid generation:  0.0009000301361083984
local_in_edges_tensor generation:  0.0006043910980224609
mini_batch_src_global generation:  0.0010614395141601562
r_  generation:  0.010011911392211914
local_output_nid generation:  0.0008976459503173828
local_in_edges_tensor generation:  0.0005872249603271484
mini_batch_src_global generation:  0.0010755062103271484
r_  generation:  0.009664058685302734
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0006053447723388672
mini_batch_src_global generation:  0.0010907649993896484
r_  generation:  0.01009821891784668
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.0005834102630615234
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.009971380233764648
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0005927085876464844
mini_batch_src_global generation:  0.0011138916015625
r_  generation:  0.010418176651000977
local_output_nid generation:  0.0008778572082519531
local_in_edges_tensor generation:  0.0005955696105957031
mini_batch_src_global generation:  0.0011341571807861328
r_  generation:  0.010402917861938477
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.0011768341064453125
r_  generation:  0.010363340377807617
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.000583648681640625
mini_batch_src_global generation:  0.001088857650756836
r_  generation:  0.010120391845703125
local_output_nid generation:  0.0008685588836669922
local_in_edges_tensor generation:  0.0005772113800048828
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.010449409484863281
local_output_nid generation:  0.0008823871612548828
local_in_edges_tensor generation:  0.0006213188171386719
mini_batch_src_global generation:  0.0011713504791259766
r_  generation:  0.010837316513061523
local_output_nid generation:  0.0008933544158935547
local_in_edges_tensor generation:  0.0006053447723388672
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.010548830032348633
local_output_nid generation:  0.0008828639984130859
local_in_edges_tensor generation:  0.0006129741668701172
mini_batch_src_global generation:  0.0011930465698242188
r_  generation:  0.010768413543701172
local_output_nid generation:  0.000911712646484375
local_in_edges_tensor generation:  0.0006031990051269531
mini_batch_src_global generation:  0.0010998249053955078
r_  generation:  0.010243892669677734
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.0006024837493896484
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.010402917861938477
local_output_nid generation:  0.000888824462890625
local_in_edges_tensor generation:  0.0006039142608642578
mini_batch_src_global generation:  0.0011496543884277344
r_  generation:  0.010537147521972656
local_output_nid generation:  0.0008778572082519531
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.010146617889404297
local_output_nid generation:  0.0008754730224609375
local_in_edges_tensor generation:  0.0006091594696044922
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.010556221008300781
local_output_nid generation:  0.0008687973022460938
local_in_edges_tensor generation:  0.0006122589111328125
mini_batch_src_global generation:  0.0012025833129882812
r_  generation:  0.010785579681396484
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0006055831909179688
mini_batch_src_global generation:  0.0012195110321044922
r_  generation:  0.010268688201904297
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0006029605865478516
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.010405302047729492
local_output_nid generation:  0.0008835792541503906
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0010921955108642578
r_  generation:  0.010294198989868164
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0005917549133300781
mini_batch_src_global generation:  0.0011911392211914062
r_  generation:  0.010325193405151367
local_output_nid generation:  0.0008790493011474609
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.01057887077331543
local_output_nid generation:  0.0008823871612548828
local_in_edges_tensor generation:  0.00058746337890625
mini_batch_src_global generation:  0.0011544227600097656
r_  generation:  0.010663509368896484
local_output_nid generation:  0.0008547306060791016
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.0011129379272460938
r_  generation:  0.010255813598632812
local_output_nid generation:  0.0008604526519775391
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.0011031627655029297
r_  generation:  0.010160684585571289
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.001100301742553711
r_  generation:  0.010349512100219727
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.01022481918334961
----------------------check_connections_block total spend ----------------------------- 0.5215330123901367
generate_one_block  0.02229022979736328
generate_one_block  0.02094411849975586
generate_one_block  0.019067049026489258
generate_one_block  0.018800020217895508
generate_one_block  0.019202709197998047
generate_one_block  0.018430471420288086
generate_one_block  0.018997907638549805
generate_one_block  0.01860833168029785
generate_one_block  0.019390344619750977
generate_one_block  0.019196033477783203
generate_one_block  0.018941640853881836
generate_one_block  0.020872831344604492
generate_one_block  0.01951122283935547
generate_one_block  0.020050764083862305
generate_one_block  0.019218921661376953
generate_one_block  0.019533872604370117
generate_one_block  0.0187528133392334
generate_one_block  0.018912553787231445
generate_one_block  0.019258737564086914
generate_one_block  0.018778562545776367
generate_one_block  0.019403934478759766
generate_one_block  0.019620895385742188
generate_one_block  0.018972158432006836
generate_one_block  0.019010066986083984
generate_one_block  0.019010066986083984
generate_one_block  0.018999338150024414
generate_one_block  0.01946115493774414
generate_one_block  0.019402742385864258
generate_one_block  0.01866769790649414
generate_one_block  0.018711566925048828
generate_one_block  0.019066572189331055
generate_one_block  0.018790483474731445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03725004196166992
gen group dst list time:  0.02062225341796875
time for parepare:  0.020173311233520508
local_output_nid generation:  0.005873441696166992
local_in_edges_tensor generation:  0.015047550201416016
mini_batch_src_global generation:  0.017425537109375
r_  generation:  0.1695413589477539
local_output_nid generation:  0.007748842239379883
local_in_edges_tensor generation:  0.011191129684448242
mini_batch_src_global generation:  0.02197265625
r_  generation:  0.1675121784210205
local_output_nid generation:  0.007901668548583984
local_in_edges_tensor generation:  0.0361177921295166
mini_batch_src_global generation:  0.020158052444458008
r_  generation:  0.1701812744140625
local_output_nid generation:  0.008122444152832031
local_in_edges_tensor generation:  0.00917959213256836
mini_batch_src_global generation:  0.02119755744934082
r_  generation:  0.1714327335357666
local_output_nid generation:  0.008789539337158203
local_in_edges_tensor generation:  0.010070562362670898
mini_batch_src_global generation:  0.022464513778686523
r_  generation:  0.1754469871520996
local_output_nid generation:  0.008813858032226562
local_in_edges_tensor generation:  0.009373903274536133
mini_batch_src_global generation:  0.02159571647644043
r_  generation:  0.1721038818359375
local_output_nid generation:  0.008911371231079102
local_in_edges_tensor generation:  0.011569499969482422
mini_batch_src_global generation:  0.023369789123535156
r_  generation:  0.18100595474243164
local_output_nid generation:  0.008679866790771484
local_in_edges_tensor generation:  0.008682727813720703
mini_batch_src_global generation:  0.021782875061035156
r_  generation:  0.17476224899291992
local_output_nid generation:  0.008888721466064453
local_in_edges_tensor generation:  0.010447502136230469
mini_batch_src_global generation:  0.024071693420410156
r_  generation:  0.18547534942626953
local_output_nid generation:  0.008971214294433594
local_in_edges_tensor generation:  0.009123563766479492
mini_batch_src_global generation:  0.023892641067504883
r_  generation:  0.18309473991394043
local_output_nid generation:  0.008951902389526367
local_in_edges_tensor generation:  0.009373903274536133
mini_batch_src_global generation:  0.023793697357177734
r_  generation:  0.18151307106018066
local_output_nid generation:  0.009075164794921875
local_in_edges_tensor generation:  0.00856637954711914
mini_batch_src_global generation:  0.022391557693481445
r_  generation:  0.17728281021118164
local_output_nid generation:  0.009268999099731445
local_in_edges_tensor generation:  0.009423017501831055
mini_batch_src_global generation:  0.0228271484375
r_  generation:  0.18127822875976562
local_output_nid generation:  0.009540081024169922
local_in_edges_tensor generation:  0.012561559677124023
mini_batch_src_global generation:  0.024465560913085938
r_  generation:  0.19044995307922363
local_output_nid generation:  0.009481668472290039
local_in_edges_tensor generation:  0.01026296615600586
mini_batch_src_global generation:  0.024228334426879883
r_  generation:  0.18485236167907715
local_output_nid generation:  0.009470462799072266
local_in_edges_tensor generation:  0.010090351104736328
mini_batch_src_global generation:  0.024111270904541016
r_  generation:  0.18889832496643066
local_output_nid generation:  0.009046316146850586
local_in_edges_tensor generation:  0.009056329727172852
mini_batch_src_global generation:  0.02282118797302246
r_  generation:  0.1757357120513916
local_output_nid generation:  0.009288549423217773
local_in_edges_tensor generation:  0.009494304656982422
mini_batch_src_global generation:  0.022902727127075195
r_  generation:  0.18241214752197266
local_output_nid generation:  0.009450197219848633
local_in_edges_tensor generation:  0.009426593780517578
mini_batch_src_global generation:  0.023993492126464844
r_  generation:  0.18694329261779785
local_output_nid generation:  0.009273529052734375
local_in_edges_tensor generation:  0.009154319763183594
mini_batch_src_global generation:  0.02304983139038086
r_  generation:  0.1809835433959961
local_output_nid generation:  0.009307146072387695
local_in_edges_tensor generation:  0.009419679641723633
mini_batch_src_global generation:  0.02365732192993164
r_  generation:  0.18827033042907715
local_output_nid generation:  0.009544610977172852
local_in_edges_tensor generation:  0.010382652282714844
mini_batch_src_global generation:  0.024764537811279297
r_  generation:  0.1891951560974121
local_output_nid generation:  0.009411334991455078
local_in_edges_tensor generation:  0.009313344955444336
mini_batch_src_global generation:  0.023047924041748047
r_  generation:  0.18347406387329102
local_output_nid generation:  0.00945734977722168
local_in_edges_tensor generation:  0.009995222091674805
mini_batch_src_global generation:  0.02316141128540039
r_  generation:  0.18416428565979004
local_output_nid generation:  0.00974130630493164
local_in_edges_tensor generation:  0.009012937545776367
mini_batch_src_global generation:  0.0229189395904541
r_  generation:  0.18267250061035156
local_output_nid generation:  0.00936579704284668
local_in_edges_tensor generation:  0.009004592895507812
mini_batch_src_global generation:  0.02241802215576172
r_  generation:  0.18171072006225586
local_output_nid generation:  0.009509563446044922
local_in_edges_tensor generation:  0.00898432731628418
mini_batch_src_global generation:  0.023192644119262695
r_  generation:  0.1867969036102295
local_output_nid generation:  0.009519815444946289
local_in_edges_tensor generation:  0.009032964706420898
mini_batch_src_global generation:  0.023699045181274414
r_  generation:  0.18716907501220703
local_output_nid generation:  0.009266376495361328
local_in_edges_tensor generation:  0.008896589279174805
mini_batch_src_global generation:  0.022695064544677734
r_  generation:  0.18064165115356445
local_output_nid generation:  0.009284496307373047
local_in_edges_tensor generation:  0.008875131607055664
mini_batch_src_global generation:  0.022394657135009766
r_  generation:  0.18065929412841797
local_output_nid generation:  0.00940394401550293
local_in_edges_tensor generation:  0.009726524353027344
mini_batch_src_global generation:  0.022723913192749023
r_  generation:  0.187835693359375
local_output_nid generation:  0.010486841201782227
local_in_edges_tensor generation:  0.009435415267944336
mini_batch_src_global generation:  0.022439956665039062
r_  generation:  0.18056583404541016
----------------------check_connections_block total spend ----------------------------- 8.494881391525269
generate_one_block  0.2544214725494385
generate_one_block  0.24278855323791504
generate_one_block  0.2400798797607422
generate_one_block  0.24215435981750488
generate_one_block  0.2613515853881836
generate_one_block  0.2435140609741211
generate_one_block  0.2527172565460205
generate_one_block  0.23859786987304688
generate_one_block  0.25913429260253906
generate_one_block  0.2540581226348877
generate_one_block  0.25056958198547363
generate_one_block  0.244551420211792
generate_one_block  0.24859237670898438
generate_one_block  0.26054930686950684
generate_one_block  0.25403261184692383
generate_one_block  0.2596628665924072
generate_one_block  0.24120569229125977
generate_one_block  0.2545754909515381
generate_one_block  0.25633978843688965
generate_one_block  0.25251126289367676
generate_one_block  0.25735902786254883
generate_one_block  0.26108765602111816
generate_one_block  0.24602341651916504
generate_one_block  0.2545299530029297
generate_one_block  0.2468881607055664
generate_one_block  0.24812841415405273
generate_one_block  0.2532773017883301
generate_one_block  0.25498080253601074
generate_one_block  0.24363446235656738
generate_one_block  0.24697113037109375
generate_one_block  0.24692201614379883
generate_one_block  0.24423003196716309
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03076910972595215
gen group dst list time:  0.11062741279602051
time for parepare:  0.019711017608642578
local_output_nid generation:  0.024463653564453125
local_in_edges_tensor generation:  0.05691051483154297
mini_batch_src_global generation:  0.047960519790649414
r_  generation:  0.4852120876312256
local_output_nid generation:  0.030367374420166016
local_in_edges_tensor generation:  0.04092264175415039
mini_batch_src_global generation:  0.05855393409729004
r_  generation:  0.4839644432067871
local_output_nid generation:  0.030893802642822266
local_in_edges_tensor generation:  0.03157377243041992
mini_batch_src_global generation:  0.05840754508972168
r_  generation:  0.4980146884918213
local_output_nid generation:  0.030965566635131836
local_in_edges_tensor generation:  0.03300833702087402
mini_batch_src_global generation:  0.057886362075805664
r_  generation:  0.48894500732421875
local_output_nid generation:  0.030819177627563477
local_in_edges_tensor generation:  0.031583309173583984
mini_batch_src_global generation:  0.05750417709350586
r_  generation:  0.5007448196411133
local_output_nid generation:  0.030960798263549805
local_in_edges_tensor generation:  0.0300443172454834
mini_batch_src_global generation:  0.058515310287475586
r_  generation:  0.49373531341552734
local_output_nid generation:  0.029625654220581055
local_in_edges_tensor generation:  0.031775474548339844
mini_batch_src_global generation:  0.058008670806884766
r_  generation:  0.5015528202056885
local_output_nid generation:  0.029106616973876953
local_in_edges_tensor generation:  0.03211784362792969
mini_batch_src_global generation:  0.058550357818603516
r_  generation:  0.4951450824737549
local_output_nid generation:  0.0299530029296875
local_in_edges_tensor generation:  0.03187298774719238
mini_batch_src_global generation:  0.057996273040771484
r_  generation:  0.5043957233428955
local_output_nid generation:  0.029120206832885742
local_in_edges_tensor generation:  0.03214144706726074
mini_batch_src_global generation:  0.05963611602783203
r_  generation:  0.4975755214691162
local_output_nid generation:  0.03138327598571777
local_in_edges_tensor generation:  0.0319828987121582
mini_batch_src_global generation:  0.057950735092163086
r_  generation:  0.5049169063568115
local_output_nid generation:  0.02936267852783203
local_in_edges_tensor generation:  0.032444000244140625
mini_batch_src_global generation:  0.05916118621826172
r_  generation:  0.49506163597106934
local_output_nid generation:  0.029439449310302734
local_in_edges_tensor generation:  0.031079530715942383
mini_batch_src_global generation:  0.057264089584350586
r_  generation:  0.497302770614624
local_output_nid generation:  0.029514551162719727
local_in_edges_tensor generation:  0.03227639198303223
mini_batch_src_global generation:  0.05934858322143555
r_  generation:  0.49663257598876953
local_output_nid generation:  0.02962327003479004
local_in_edges_tensor generation:  0.03152036666870117
mini_batch_src_global generation:  0.058324337005615234
r_  generation:  0.5027337074279785
local_output_nid generation:  0.029705524444580078
local_in_edges_tensor generation:  0.03180527687072754
mini_batch_src_global generation:  0.0589597225189209
r_  generation:  0.4962472915649414
local_output_nid generation:  0.02906513214111328
local_in_edges_tensor generation:  0.031331539154052734
mini_batch_src_global generation:  0.05700945854187012
r_  generation:  0.49708127975463867
local_output_nid generation:  0.029837608337402344
local_in_edges_tensor generation:  0.031728506088256836
mini_batch_src_global generation:  0.05934619903564453
r_  generation:  0.4962339401245117
local_output_nid generation:  0.029782772064208984
local_in_edges_tensor generation:  0.030181407928466797
mini_batch_src_global generation:  0.05847764015197754
r_  generation:  0.507925271987915
local_output_nid generation:  0.029429912567138672
local_in_edges_tensor generation:  0.029567241668701172
mini_batch_src_global generation:  0.0596318244934082
r_  generation:  0.4995136260986328
local_output_nid generation:  0.029435396194458008
local_in_edges_tensor generation:  0.03158974647521973
mini_batch_src_global generation:  0.05854940414428711
r_  generation:  0.5055279731750488
local_output_nid generation:  0.029750823974609375
local_in_edges_tensor generation:  0.029821395874023438
mini_batch_src_global generation:  0.05948996543884277
r_  generation:  0.4977688789367676
local_output_nid generation:  0.029623031616210938
local_in_edges_tensor generation:  0.03410172462463379
mini_batch_src_global generation:  0.05804562568664551
r_  generation:  0.5031046867370605
local_output_nid generation:  0.02945256233215332
local_in_edges_tensor generation:  0.03152632713317871
mini_batch_src_global generation:  0.06151604652404785
r_  generation:  0.49852514266967773
local_output_nid generation:  0.0292513370513916
local_in_edges_tensor generation:  0.03451061248779297
mini_batch_src_global generation:  0.05815768241882324
r_  generation:  0.4994165897369385
local_output_nid generation:  0.029314517974853516
local_in_edges_tensor generation:  0.029939651489257812
mini_batch_src_global generation:  0.059223175048828125
r_  generation:  0.49440503120422363
local_output_nid generation:  0.029165029525756836
local_in_edges_tensor generation:  0.033737897872924805
mini_batch_src_global generation:  0.05754876136779785
r_  generation:  0.4977080821990967
local_output_nid generation:  0.029360532760620117
local_in_edges_tensor generation:  0.03027820587158203
mini_batch_src_global generation:  0.06061720848083496
r_  generation:  0.4984757900238037
local_output_nid generation:  0.029047489166259766
local_in_edges_tensor generation:  0.0293734073638916
mini_batch_src_global generation:  0.057885169982910156
r_  generation:  0.49750208854675293
local_output_nid generation:  0.02975749969482422
local_in_edges_tensor generation:  0.031210660934448242
mini_batch_src_global generation:  0.061075687408447266
r_  generation:  0.4962284564971924
local_output_nid generation:  0.029581785202026367
local_in_edges_tensor generation:  0.031625986099243164
mini_batch_src_global generation:  0.06013059616088867
r_  generation:  0.5004189014434814
local_output_nid generation:  0.029232025146484375
local_in_edges_tensor generation:  0.02929091453552246
mini_batch_src_global generation:  0.05919599533081055
r_  generation:  0.4984397888183594
----------------------check_connections_block total spend ----------------------------- 23.268848419189453
generate_one_block  0.6819953918457031
generate_one_block  0.6746079921722412
generate_one_block  0.6771254539489746
generate_one_block  0.6813392639160156
generate_one_block  0.7706811428070068
generate_one_block  0.6733436584472656
generate_one_block  0.6777236461639404
generate_one_block  0.6681830883026123
generate_one_block  0.69590163230896
generate_one_block  0.6797504425048828
generate_one_block  0.6704277992248535
generate_one_block  0.6833045482635498
generate_one_block  0.6708707809448242
generate_one_block  0.6845598220825195
generate_one_block  0.6871609687805176
generate_one_block  0.6858317852020264
generate_one_block  0.6745553016662598
generate_one_block  0.6764836311340332
generate_one_block  0.6866226196289062
generate_one_block  0.6698641777038574
generate_one_block  0.6809971332550049
generate_one_block  0.6817963123321533
generate_one_block  0.6876137256622314
generate_one_block  0.6806375980377197
generate_one_block  0.6927955150604248
generate_one_block  0.6798663139343262
generate_one_block  0.6766867637634277
generate_one_block  0.6826574802398682
generate_one_block  0.6827526092529297
generate_one_block  0.6877341270446777
generate_one_block  0.6960475444793701
generate_one_block  0.6804440021514893
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.13142156600952148  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

connection checking time:  31.76372981071472
block generation total time  29.89580249786377
average batch blocks generation time:  0.9342438280582428
block dataloader generation time/epoch 65.88759206235409
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1092538833618164  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.00923252105713  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10904741287231445  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.521923542022705  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10912847518920898  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.419270992279053  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10900211334228516  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.562897205352783  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10919857025146484  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.656633377075195  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10893774032592773  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.38518476486206  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10900449752807617  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.825358867645264  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10898542404174805  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.338002681732178  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10963201522827148  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.11110544204712  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10914468765258789  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.907410621643066  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10919618606567383  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.83092737197876  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10929059982299805  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.55135726928711  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10923290252685547  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.711140632629395  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10933589935302734  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.229232788085938  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10949516296386719  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.005548000335693  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10948896408081055  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.170620441436768  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10880517959594727  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.28166437149048  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10917425155639648  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.80516242980957  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1093745231628418  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.991862297058105  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10906457901000977  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.624961853027344  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10913419723510742  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.02737522125244  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10944604873657227  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.139859199523926  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10946512222290039  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.75113821029663  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10956621170043945  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.876150131225586  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10925579071044922  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.67463254928589  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10922908782958984  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.705389499664307  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10914421081542969  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.941648483276367  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1091761589050293  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.946306228637695  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10896968841552734  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.544483184814453  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1090397834777832  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.627795696258545  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10944080352783203  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.752001762390137  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1089472770690918  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.55689811706543  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027903489768505096 |0.025386549532413483 |0.6403942778706551 |0.00010009855031967163 |1.192861832678318 |0.00944828987121582 |
----------------------------------------------------------pseudo_mini_loss sum 1.2808176279067993
Total (block generation + training)time/epoch 125.96929228305817
Training time/epoch 60.44858145713806
Training time without block to device /epoch 59.63621187210083
Training time without total dataloading part /epoch 58.676846981048584
load block tensor time/epoch 0.8929116725921631
block to device time/epoch 0.8123695850372314
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  9155546
Number of first layer input nodes during this epoch:  4807572
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1307220458984375  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02987194061279297
range selection method range initialization spend 0.015103578567504883
time for parepare:  0.031250953674316406
local_output_nid generation:  0.0017647743225097656
local_in_edges_tensor generation:  0.005095720291137695
mini_batch_src_global generation:  0.0029773712158203125
r_  generation:  0.01235508918762207
local_output_nid generation:  0.0010080337524414062
local_in_edges_tensor generation:  0.0006895065307617188
mini_batch_src_global generation:  0.0016224384307861328
r_  generation:  0.010667085647583008
local_output_nid generation:  0.0009710788726806641
local_in_edges_tensor generation:  0.0006308555603027344
mini_batch_src_global generation:  0.0012788772583007812
r_  generation:  0.009992122650146484
local_output_nid generation:  0.0009675025939941406
local_in_edges_tensor generation:  0.0006098747253417969
mini_batch_src_global generation:  0.001280069351196289
r_  generation:  0.010418176651000977
local_output_nid generation:  0.0009505748748779297
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.0011916160583496094
r_  generation:  0.009624719619750977
local_output_nid generation:  0.0009179115295410156
local_in_edges_tensor generation:  0.0005881786346435547
mini_batch_src_global generation:  0.0012409687042236328
r_  generation:  0.010073661804199219
local_output_nid generation:  0.0009109973907470703
local_in_edges_tensor generation:  0.0005886554718017578
mini_batch_src_global generation:  0.001195669174194336
r_  generation:  0.010288238525390625
local_output_nid generation:  0.0009918212890625
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.001186370849609375
r_  generation:  0.010052919387817383
local_output_nid generation:  0.0009410381317138672
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.0011801719665527344
r_  generation:  0.010358810424804688
local_output_nid generation:  0.0009062290191650391
local_in_edges_tensor generation:  0.0006210803985595703
mini_batch_src_global generation:  0.0012297630310058594
r_  generation:  0.010600566864013672
local_output_nid generation:  0.0009274482727050781
local_in_edges_tensor generation:  0.00058746337890625
mini_batch_src_global generation:  0.0012333393096923828
r_  generation:  0.010488510131835938
local_output_nid generation:  0.0009591579437255859
local_in_edges_tensor generation:  0.0006101131439208984
mini_batch_src_global generation:  0.0011975765228271484
r_  generation:  0.010944128036499023
local_output_nid generation:  0.0009291172027587891
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0011925697326660156
r_  generation:  0.010158538818359375
local_output_nid generation:  0.0009276866912841797
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.009958744049072266
local_output_nid generation:  0.0009298324584960938
local_in_edges_tensor generation:  0.0005919933319091797
mini_batch_src_global generation:  0.001169443130493164
r_  generation:  0.010216951370239258
local_output_nid generation:  0.0009303092956542969
local_in_edges_tensor generation:  0.0005710124969482422
mini_batch_src_global generation:  0.0011935234069824219
r_  generation:  0.01019287109375
local_output_nid generation:  0.0009407997131347656
local_in_edges_tensor generation:  0.000579833984375
mini_batch_src_global generation:  0.0012106895446777344
r_  generation:  0.010273933410644531
local_output_nid generation:  0.0009222030639648438
local_in_edges_tensor generation:  0.0005762577056884766
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.010159969329833984
local_output_nid generation:  0.0009443759918212891
local_in_edges_tensor generation:  0.0005600452423095703
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.010189533233642578
local_output_nid generation:  0.0009396076202392578
local_in_edges_tensor generation:  0.0005793571472167969
mini_batch_src_global generation:  0.0011539459228515625
r_  generation:  0.010328531265258789
local_output_nid generation:  0.0009400844573974609
local_in_edges_tensor generation:  0.0006022453308105469
mini_batch_src_global generation:  0.0011820793151855469
r_  generation:  0.010356903076171875
local_output_nid generation:  0.0009222030639648438
local_in_edges_tensor generation:  0.0005905628204345703
mini_batch_src_global generation:  0.0012621879577636719
r_  generation:  0.010609626770019531
local_output_nid generation:  0.0009243488311767578
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0012230873107910156
r_  generation:  0.010365724563598633
local_output_nid generation:  0.0009264945983886719
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0011568069458007812
r_  generation:  0.0103759765625
local_output_nid generation:  0.0009205341339111328
local_in_edges_tensor generation:  0.0005941390991210938
mini_batch_src_global generation:  0.0011556148529052734
r_  generation:  0.010139942169189453
local_output_nid generation:  0.0009374618530273438
local_in_edges_tensor generation:  0.0005676746368408203
mini_batch_src_global generation:  0.0011601448059082031
r_  generation:  0.010247230529785156
local_output_nid generation:  0.0009455680847167969
local_in_edges_tensor generation:  0.0006017684936523438
mini_batch_src_global generation:  0.001203298568725586
r_  generation:  0.010591983795166016
local_output_nid generation:  0.0009484291076660156
local_in_edges_tensor generation:  0.0005927085876464844
mini_batch_src_global generation:  0.0012423992156982422
r_  generation:  0.01111149787902832
local_output_nid generation:  0.0009486675262451172
local_in_edges_tensor generation:  0.0005986690521240234
mini_batch_src_global generation:  0.0012769699096679688
r_  generation:  0.010766267776489258
local_output_nid generation:  0.0009634494781494141
local_in_edges_tensor generation:  0.0005700588226318359
mini_batch_src_global generation:  0.0011398792266845703
r_  generation:  0.01004791259765625
local_output_nid generation:  0.0009622573852539062
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0011928081512451172
r_  generation:  0.010259866714477539
local_output_nid generation:  0.0008699893951416016
local_in_edges_tensor generation:  0.0005822181701660156
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.010221719741821289
----------------------check_connections_block total spend ----------------------------- 0.541597843170166
generate_one_block  0.02590012550354004
generate_one_block  0.0213775634765625
generate_one_block  0.01979804039001465
generate_one_block  0.020247459411621094
generate_one_block  0.018564701080322266
generate_one_block  0.01912999153137207
generate_one_block  0.01933884620666504
generate_one_block  0.018683910369873047
generate_one_block  0.01929950714111328
generate_one_block  0.019672870635986328
generate_one_block  0.019320249557495117
generate_one_block  0.0224764347076416
generate_one_block  0.019342422485351562
generate_one_block  0.018506765365600586
generate_one_block  0.01890110969543457
generate_one_block  0.018701553344726562
generate_one_block  0.01894235610961914
generate_one_block  0.018682003021240234
generate_one_block  0.018766164779663086
generate_one_block  0.0188748836517334
generate_one_block  0.018967390060424805
generate_one_block  0.019356966018676758
generate_one_block  0.01882648468017578
generate_one_block  0.018911361694335938
generate_one_block  0.01874828338623047
generate_one_block  0.018964052200317383
generate_one_block  0.019345998764038086
generate_one_block  0.01994490623474121
generate_one_block  0.019533634185791016
generate_one_block  0.018492460250854492
generate_one_block  0.018828392028808594
generate_one_block  0.018774747848510742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04043865203857422
gen group dst list time:  0.025441646575927734
time for parepare:  0.022410154342651367
local_output_nid generation:  0.0056819915771484375
local_in_edges_tensor generation:  0.01797032356262207
mini_batch_src_global generation:  0.019860029220581055
r_  generation:  0.1666872501373291
local_output_nid generation:  0.008006811141967773
local_in_edges_tensor generation:  0.011638164520263672
mini_batch_src_global generation:  0.034476518630981445
r_  generation:  0.18394136428833008
local_output_nid generation:  0.012339115142822266
local_in_edges_tensor generation:  0.049333810806274414
mini_batch_src_global generation:  0.025930166244506836
r_  generation:  0.18370819091796875
local_output_nid generation:  0.010165214538574219
local_in_edges_tensor generation:  0.012430906295776367
mini_batch_src_global generation:  0.02526545524597168
r_  generation:  0.18890142440795898
local_output_nid generation:  0.008979320526123047
local_in_edges_tensor generation:  0.011815309524536133
mini_batch_src_global generation:  0.025300025939941406
r_  generation:  0.17743587493896484
local_output_nid generation:  0.008978843688964844
local_in_edges_tensor generation:  0.012032032012939453
mini_batch_src_global generation:  0.02551889419555664
r_  generation:  0.18622446060180664
local_output_nid generation:  0.009282350540161133
local_in_edges_tensor generation:  0.011168241500854492
mini_batch_src_global generation:  0.026041269302368164
r_  generation:  0.19019579887390137
local_output_nid generation:  0.00860142707824707
local_in_edges_tensor generation:  0.009428739547729492
mini_batch_src_global generation:  0.023279190063476562
r_  generation:  0.182450532913208
local_output_nid generation:  0.008671998977661133
local_in_edges_tensor generation:  0.010919332504272461
mini_batch_src_global generation:  0.024524927139282227
r_  generation:  0.19045376777648926
local_output_nid generation:  0.008958816528320312
local_in_edges_tensor generation:  0.011205673217773438
mini_batch_src_global generation:  0.024262428283691406
r_  generation:  0.19037318229675293
local_output_nid generation:  0.009182453155517578
local_in_edges_tensor generation:  0.009679317474365234
mini_batch_src_global generation:  0.03662610054016113
r_  generation:  0.20137548446655273
local_output_nid generation:  0.011245965957641602
local_in_edges_tensor generation:  0.013231515884399414
mini_batch_src_global generation:  0.026705265045166016
r_  generation:  0.1967322826385498
local_output_nid generation:  0.009594917297363281
local_in_edges_tensor generation:  0.010820150375366211
mini_batch_src_global generation:  0.025800228118896484
r_  generation:  0.1906270980834961
local_output_nid generation:  0.009121179580688477
local_in_edges_tensor generation:  0.010389089584350586
mini_batch_src_global generation:  0.025717735290527344
r_  generation:  0.18968534469604492
local_output_nid generation:  0.009388208389282227
local_in_edges_tensor generation:  0.012047052383422852
mini_batch_src_global generation:  0.03666377067565918
r_  generation:  0.19870829582214355
local_output_nid generation:  0.010452747344970703
local_in_edges_tensor generation:  0.013008356094360352
mini_batch_src_global generation:  0.025587081909179688
r_  generation:  0.19156336784362793
local_output_nid generation:  0.009448051452636719
local_in_edges_tensor generation:  0.011275768280029297
mini_batch_src_global generation:  0.026376724243164062
r_  generation:  0.1912093162536621
local_output_nid generation:  0.009299278259277344
local_in_edges_tensor generation:  0.011455297470092773
mini_batch_src_global generation:  0.023983001708984375
r_  generation:  0.18910861015319824
local_output_nid generation:  0.009259939193725586
local_in_edges_tensor generation:  0.010923624038696289
mini_batch_src_global generation:  0.023579835891723633
r_  generation:  0.19041180610656738
local_output_nid generation:  0.009355545043945312
local_in_edges_tensor generation:  0.012844562530517578
mini_batch_src_global generation:  0.024076461791992188
r_  generation:  0.20049428939819336
local_output_nid generation:  0.012469291687011719
local_in_edges_tensor generation:  0.011325359344482422
mini_batch_src_global generation:  0.023617029190063477
r_  generation:  0.18676090240478516
local_output_nid generation:  0.009832382202148438
local_in_edges_tensor generation:  0.013822555541992188
mini_batch_src_global generation:  0.024923324584960938
r_  generation:  0.18863606452941895
local_output_nid generation:  0.00939035415649414
local_in_edges_tensor generation:  0.010093927383422852
mini_batch_src_global generation:  0.02289104461669922
r_  generation:  0.18238162994384766
local_output_nid generation:  0.009441852569580078
local_in_edges_tensor generation:  0.011159420013427734
mini_batch_src_global generation:  0.023039579391479492
r_  generation:  0.18156790733337402
local_output_nid generation:  0.009502410888671875
local_in_edges_tensor generation:  0.009899377822875977
mini_batch_src_global generation:  0.022595882415771484
r_  generation:  0.18080639839172363
local_output_nid generation:  0.009480476379394531
local_in_edges_tensor generation:  0.009910345077514648
mini_batch_src_global generation:  0.022880077362060547
r_  generation:  0.18210339546203613
local_output_nid generation:  0.009656906127929688
local_in_edges_tensor generation:  0.010978937149047852
mini_batch_src_global generation:  0.02427530288696289
r_  generation:  0.1883556842803955
local_output_nid generation:  0.010110855102539062
local_in_edges_tensor generation:  0.01325225830078125
mini_batch_src_global generation:  0.02520298957824707
r_  generation:  0.1940174102783203
local_output_nid generation:  0.009633064270019531
local_in_edges_tensor generation:  0.01052403450012207
mini_batch_src_global generation:  0.02387261390686035
r_  generation:  0.18963265419006348
local_output_nid generation:  0.009288311004638672
local_in_edges_tensor generation:  0.010644674301147461
mini_batch_src_global generation:  0.02301168441772461
r_  generation:  0.18190741539001465
local_output_nid generation:  0.009336233139038086
local_in_edges_tensor generation:  0.010038614273071289
mini_batch_src_global generation:  0.022573232650756836
r_  generation:  0.18388748168945312
local_output_nid generation:  0.00949239730834961
local_in_edges_tensor generation:  0.009960174560546875
mini_batch_src_global generation:  0.022606372833251953
r_  generation:  0.18271803855895996
----------------------check_connections_block total spend ----------------------------- 8.924944400787354
generate_one_block  0.2572040557861328
generate_one_block  0.24323534965515137
generate_one_block  0.24731159210205078
generate_one_block  0.25731825828552246
generate_one_block  0.25722765922546387
generate_one_block  0.2444908618927002
generate_one_block  0.2545657157897949
generate_one_block  0.24280166625976562
generate_one_block  0.25455737113952637
generate_one_block  0.26578378677368164
generate_one_block  0.2516927719116211
generate_one_block  0.26920223236083984
generate_one_block  0.24894118309020996
generate_one_block  0.24874520301818848
generate_one_block  0.25244951248168945
generate_one_block  0.2422926425933838
generate_one_block  0.24971246719360352
generate_one_block  0.2486402988433838
generate_one_block  0.24925994873046875
generate_one_block  0.26234865188598633
generate_one_block  0.2545759677886963
generate_one_block  0.2582056522369385
generate_one_block  0.24559450149536133
generate_one_block  0.24725794792175293
generate_one_block  0.24335741996765137
generate_one_block  0.2484416961669922
generate_one_block  0.25997138023376465
generate_one_block  0.26813721656799316
generate_one_block  0.26001715660095215
generate_one_block  0.24643492698669434
generate_one_block  0.24851393699645996
generate_one_block  0.246781587600708
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03959846496582031
gen group dst list time:  0.11307477951049805
time for parepare:  0.02119898796081543
local_output_nid generation:  0.027759790420532227
local_in_edges_tensor generation:  0.053346872329711914
mini_batch_src_global generation:  0.04656052589416504
r_  generation:  0.5054056644439697
local_output_nid generation:  0.033838510513305664
local_in_edges_tensor generation:  0.03675699234008789
mini_batch_src_global generation:  0.059984445571899414
r_  generation:  0.4855844974517822
local_output_nid generation:  0.03151059150695801
local_in_edges_tensor generation:  0.03715658187866211
mini_batch_src_global generation:  0.0594325065612793
r_  generation:  0.5020852088928223
local_output_nid generation:  0.03183770179748535
local_in_edges_tensor generation:  0.0368962287902832
mini_batch_src_global generation:  0.05801820755004883
r_  generation:  0.4938833713531494
local_output_nid generation:  0.03193545341491699
local_in_edges_tensor generation:  0.028700590133666992
mini_batch_src_global generation:  0.05810189247131348
r_  generation:  0.500709056854248
local_output_nid generation:  0.03207993507385254
local_in_edges_tensor generation:  0.031855106353759766
mini_batch_src_global generation:  0.059026479721069336
r_  generation:  0.49528002738952637
local_output_nid generation:  0.030933618545532227
local_in_edges_tensor generation:  0.03771209716796875
mini_batch_src_global generation:  0.06074237823486328
r_  generation:  0.506314754486084
local_output_nid generation:  0.02997875213623047
local_in_edges_tensor generation:  0.03320956230163574
mini_batch_src_global generation:  0.0591580867767334
r_  generation:  0.4933314323425293
local_output_nid generation:  0.030246734619140625
local_in_edges_tensor generation:  0.033327341079711914
mini_batch_src_global generation:  0.0583193302154541
r_  generation:  0.5161373615264893
local_output_nid generation:  0.030582427978515625
local_in_edges_tensor generation:  0.02826380729675293
mini_batch_src_global generation:  0.05970597267150879
r_  generation:  0.5042159557342529
local_output_nid generation:  0.030799388885498047
local_in_edges_tensor generation:  0.02826094627380371
mini_batch_src_global generation:  0.05824089050292969
r_  generation:  0.5069484710693359
local_output_nid generation:  0.030730724334716797
local_in_edges_tensor generation:  0.03823065757751465
mini_batch_src_global generation:  0.06263947486877441
r_  generation:  0.5099096298217773
local_output_nid generation:  0.031551361083984375
local_in_edges_tensor generation:  0.032602787017822266
mini_batch_src_global generation:  0.0621180534362793
r_  generation:  0.5073330402374268
local_output_nid generation:  0.03007793426513672
local_in_edges_tensor generation:  0.03347134590148926
mini_batch_src_global generation:  0.059053897857666016
r_  generation:  0.49654197692871094
local_output_nid generation:  0.030347585678100586
local_in_edges_tensor generation:  0.03017711639404297
mini_batch_src_global generation:  0.06033730506896973
r_  generation:  0.507448673248291
local_output_nid generation:  0.03079509735107422
local_in_edges_tensor generation:  0.029626131057739258
mini_batch_src_global generation:  0.0617372989654541
r_  generation:  0.49573707580566406
local_output_nid generation:  0.03216099739074707
local_in_edges_tensor generation:  0.03136706352233887
mini_batch_src_global generation:  0.05999135971069336
r_  generation:  0.5082833766937256
local_output_nid generation:  0.030330657958984375
local_in_edges_tensor generation:  0.03330373764038086
mini_batch_src_global generation:  0.06221270561218262
r_  generation:  0.5035314559936523
local_output_nid generation:  0.030263662338256836
local_in_edges_tensor generation:  0.029595613479614258
mini_batch_src_global generation:  0.05801582336425781
r_  generation:  0.5055310726165771
local_output_nid generation:  0.030414104461669922
local_in_edges_tensor generation:  0.03205466270446777
mini_batch_src_global generation:  0.0592806339263916
r_  generation:  0.49938154220581055
local_output_nid generation:  0.030457258224487305
local_in_edges_tensor generation:  0.03219485282897949
mini_batch_src_global generation:  0.0584406852722168
r_  generation:  0.5054254531860352
local_output_nid generation:  0.03239870071411133
local_in_edges_tensor generation:  0.031449317932128906
mini_batch_src_global generation:  0.060163021087646484
r_  generation:  0.5009675025939941
local_output_nid generation:  0.03045964241027832
local_in_edges_tensor generation:  0.03601217269897461
mini_batch_src_global generation:  0.05946946144104004
r_  generation:  0.5058300495147705
local_output_nid generation:  0.03052043914794922
local_in_edges_tensor generation:  0.031223773956298828
mini_batch_src_global generation:  0.06242823600769043
r_  generation:  0.5077660083770752
local_output_nid generation:  0.03282594680786133
local_in_edges_tensor generation:  0.032529354095458984
mini_batch_src_global generation:  0.05975794792175293
r_  generation:  0.5034468173980713
local_output_nid generation:  0.03050541877746582
local_in_edges_tensor generation:  0.030843496322631836
mini_batch_src_global generation:  0.059172868728637695
r_  generation:  0.4936537742614746
local_output_nid generation:  0.030878543853759766
local_in_edges_tensor generation:  0.030986785888671875
mini_batch_src_global generation:  0.05850696563720703
r_  generation:  0.5043380260467529
local_output_nid generation:  0.031090974807739258
local_in_edges_tensor generation:  0.03513193130493164
mini_batch_src_global generation:  0.06205034255981445
r_  generation:  0.5025978088378906
local_output_nid generation:  0.0305631160736084
local_in_edges_tensor generation:  0.02936530113220215
mini_batch_src_global generation:  0.05860280990600586
r_  generation:  0.511075496673584
local_output_nid generation:  0.030666112899780273
local_in_edges_tensor generation:  0.0289609432220459
mini_batch_src_global generation:  0.059445858001708984
r_  generation:  0.497957706451416
local_output_nid generation:  0.03077077865600586
local_in_edges_tensor generation:  0.028826475143432617
mini_batch_src_global generation:  0.05810689926147461
r_  generation:  0.5168483257293701
local_output_nid generation:  0.0306854248046875
local_in_edges_tensor generation:  0.03092360496520996
mini_batch_src_global generation:  0.06010603904724121
r_  generation:  0.5012702941894531
----------------------check_connections_block total spend ----------------------------- 23.55288791656494
generate_one_block  0.6917381286621094
generate_one_block  0.673581600189209
generate_one_block  0.6807029247283936
generate_one_block  0.6778452396392822
generate_one_block  0.7853775024414062
generate_one_block  0.6759312152862549
generate_one_block  0.6859080791473389
generate_one_block  0.6760904788970947
generate_one_block  0.6801176071166992
generate_one_block  0.6843111515045166
generate_one_block  0.6749405860900879
generate_one_block  0.6901333332061768
generate_one_block  0.676250696182251
generate_one_block  0.6761689186096191
generate_one_block  0.6829462051391602
generate_one_block  0.6817169189453125
generate_one_block  0.6814844608306885
generate_one_block  0.6804115772247314
generate_one_block  0.6838815212249756
generate_one_block  0.68560791015625
generate_one_block  0.6849567890167236
generate_one_block  0.6908566951751709
generate_one_block  0.6788120269775391
generate_one_block  0.6820595264434814
generate_one_block  0.7007160186767578
generate_one_block  0.6824917793273926
generate_one_block  0.6882035732269287
generate_one_block  0.7003741264343262
generate_one_block  0.6848223209381104
generate_one_block  0.6737051010131836
generate_one_block  0.6855659484863281
generate_one_block  0.6861352920532227
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1307220458984375  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

connection checking time:  32.477832317352295
block generation total time  30.038915872573853
average batch blocks generation time:  0.9387161210179329
block dataloader generation time/epoch 65.90255940661712
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10901355743408203  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.602660655975342  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10895109176635742  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.607742309570312  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10915422439575195  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.735199451446533  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1094059944152832  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.166356563568115  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10897588729858398  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.32343101501465  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10913610458374023  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.527116298675537  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10950899124145508  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.09452772140503  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10884571075439453  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.435163974761963  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10960102081298828  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.92437744140625  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10945606231689453  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.98581838607788  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10912466049194336  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.775782585144043  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10977029800415039  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.386330604553223  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1092991828918457  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.732866764068604  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10893535614013672  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.610257625579834  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1093454360961914  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.85170841217041  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1093130111694336  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.47083854675293  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10918331146240234  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.664610385894775  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10928583145141602  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.678277015686035  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10930252075195312  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.643404483795166  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10925722122192383  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.742687702178955  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10923624038696289  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.688544750213623  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10954093933105469  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.101834297180176  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10880565643310547  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.608044624328613  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10910558700561523  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.64646005630493  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10905838012695312  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.612294673919678  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1090707778930664  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 20.696918487548828  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.1092376708984375  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 21.087570667266846  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3670654296875 GB
    Memory Allocated: 0.10979795455932617  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 21.463091373443604  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.1093912124633789  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 21.10272741317749  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.1091609001159668  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.55404806137085  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10918998718261719  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.707597255706787  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.1092371940612793  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.663856506347656  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03492707014083862 |0.022342249751091003 |0.6300969570875168 |9.673088788986206e-05 |1.1907406374812126 |0.004073143005371094 |
----------------------------------------------------------pseudo_mini_loss sum 1.2760798931121826
Total (block generation + training)time/epoch 125.98973420087029
Training time/epoch 60.17451858520508
Training time without block to device /epoch 59.459566593170166
Training time without total dataloading part /epoch 58.27397155761719
load block tensor time/epoch 1.117666244506836
block to device time/epoch 0.7149519920349121
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  9160689
Number of first layer input nodes during this epoch:  4809621
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.13137102127075195  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027112483978271484
range selection method range initialization spend 0.01708245277404785
time for parepare:  0.01965785026550293
local_output_nid generation:  0.0009915828704833984
local_in_edges_tensor generation:  0.006647586822509766
mini_batch_src_global generation:  0.0019257068634033203
r_  generation:  0.012038230895996094
local_output_nid generation:  0.000982522964477539
local_in_edges_tensor generation:  0.0007698535919189453
mini_batch_src_global generation:  0.0014786720275878906
r_  generation:  0.010861873626708984
local_output_nid generation:  0.0009398460388183594
local_in_edges_tensor generation:  0.0006582736968994141
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.010341882705688477
local_output_nid generation:  0.0009031295776367188
local_in_edges_tensor generation:  0.0006327629089355469
mini_batch_src_global generation:  0.0011763572692871094
r_  generation:  0.010061502456665039
local_output_nid generation:  0.0008857250213623047
local_in_edges_tensor generation:  0.0006327629089355469
mini_batch_src_global generation:  0.0011038780212402344
r_  generation:  0.010251045227050781
local_output_nid generation:  0.0008838176727294922
local_in_edges_tensor generation:  0.0007102489471435547
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.010009765625
local_output_nid generation:  0.0008852481842041016
local_in_edges_tensor generation:  0.00063323974609375
mini_batch_src_global generation:  0.0010943412780761719
r_  generation:  0.009815216064453125
local_output_nid generation:  0.0009317398071289062
local_in_edges_tensor generation:  0.0006468296051025391
mini_batch_src_global generation:  0.001138925552368164
r_  generation:  0.009602069854736328
local_output_nid generation:  0.000888824462890625
local_in_edges_tensor generation:  0.0006048679351806641
mini_batch_src_global generation:  0.0011191368103027344
r_  generation:  0.010045289993286133
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.0006177425384521484
mini_batch_src_global generation:  0.0011703968048095703
r_  generation:  0.010204553604125977
local_output_nid generation:  0.0008792877197265625
local_in_edges_tensor generation:  0.0006110668182373047
mini_batch_src_global generation:  0.001111745834350586
r_  generation:  0.010252237319946289
local_output_nid generation:  0.0008919239044189453
local_in_edges_tensor generation:  0.0006070137023925781
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.010032892227172852
local_output_nid generation:  0.0008831024169921875
local_in_edges_tensor generation:  0.0005829334259033203
mini_batch_src_global generation:  0.0011069774627685547
r_  generation:  0.010181665420532227
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0012347698211669922
r_  generation:  0.010473966598510742
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0006811618804931641
mini_batch_src_global generation:  0.0011820793151855469
r_  generation:  0.010663509368896484
local_output_nid generation:  0.0009083747863769531
local_in_edges_tensor generation:  0.0006520748138427734
mini_batch_src_global generation:  0.0011799335479736328
r_  generation:  0.010385274887084961
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.010172128677368164
local_output_nid generation:  0.0009307861328125
local_in_edges_tensor generation:  0.0005960464477539062
mini_batch_src_global generation:  0.0011696815490722656
r_  generation:  0.010354042053222656
local_output_nid generation:  0.0009100437164306641
local_in_edges_tensor generation:  0.0006268024444580078
mini_batch_src_global generation:  0.0011241436004638672
r_  generation:  0.010118246078491211
local_output_nid generation:  0.0008893013000488281
local_in_edges_tensor generation:  0.0006270408630371094
mini_batch_src_global generation:  0.0010933876037597656
r_  generation:  0.01009821891784668
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0005795955657958984
mini_batch_src_global generation:  0.0012123584747314453
r_  generation:  0.010189056396484375
local_output_nid generation:  0.0009124279022216797
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0012078285217285156
r_  generation:  0.01044321060180664
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0005838871002197266
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.01034855842590332
local_output_nid generation:  0.0008661746978759766
local_in_edges_tensor generation:  0.0005898475646972656
mini_batch_src_global generation:  0.0011425018310546875
r_  generation:  0.010228872299194336
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0005767345428466797
mini_batch_src_global generation:  0.0011599063873291016
r_  generation:  0.010595560073852539
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0006072521209716797
mini_batch_src_global generation:  0.00125885009765625
r_  generation:  0.01070404052734375
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0006082057952880859
mini_batch_src_global generation:  0.001214742660522461
r_  generation:  0.01041555404663086
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0006458759307861328
mini_batch_src_global generation:  0.001220703125
r_  generation:  0.010638236999511719
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.0006706714630126953
mini_batch_src_global generation:  0.0011878013610839844
r_  generation:  0.010391473770141602
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005793571472167969
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.010278701782226562
local_output_nid generation:  0.0008921623229980469
local_in_edges_tensor generation:  0.0007169246673583984
mini_batch_src_global generation:  0.0011911392211914062
r_  generation:  0.010802030563354492
local_output_nid generation:  0.0008699893951416016
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.0012102127075195312
r_  generation:  0.01008462905883789
----------------------check_connections_block total spend ----------------------------- 0.5262925624847412
generate_one_block  0.02547764778137207
generate_one_block  0.021587848663330078
generate_one_block  0.02033829689025879
generate_one_block  0.021514177322387695
generate_one_block  0.019985675811767578
generate_one_block  0.019017696380615234
generate_one_block  0.0183870792388916
generate_one_block  0.018145084381103516
generate_one_block  0.01873016357421875
generate_one_block  0.018924713134765625
generate_one_block  0.019129514694213867
generate_one_block  0.02079463005065918
generate_one_block  0.019466638565063477
generate_one_block  0.019501924514770508
generate_one_block  0.01961970329284668
generate_one_block  0.01912665367126465
generate_one_block  0.01875162124633789
generate_one_block  0.019230127334594727
generate_one_block  0.01857900619506836
generate_one_block  0.018605470657348633
generate_one_block  0.01889348030090332
generate_one_block  0.01973438262939453
generate_one_block  0.019327163696289062
generate_one_block  0.01880788803100586
generate_one_block  0.019428014755249023
generate_one_block  0.01962137222290039
generate_one_block  0.01946854591369629
generate_one_block  0.019430160522460938
generate_one_block  0.019292593002319336
generate_one_block  0.018811464309692383
generate_one_block  0.019852161407470703
generate_one_block  0.01871657371520996
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04273629188537598
gen group dst list time:  0.02339315414428711
time for parepare:  0.020203828811645508
local_output_nid generation:  0.005710601806640625
local_in_edges_tensor generation:  0.019875764846801758
mini_batch_src_global generation:  0.017750978469848633
r_  generation:  0.15961432456970215
local_output_nid generation:  0.007949352264404297
local_in_edges_tensor generation:  0.011095762252807617
mini_batch_src_global generation:  0.02200603485107422
r_  generation:  0.17120814323425293
local_output_nid generation:  0.00821065902709961
local_in_edges_tensor generation:  0.03399944305419922
mini_batch_src_global generation:  0.022394180297851562
r_  generation:  0.18270230293273926
local_output_nid generation:  0.008278608322143555
local_in_edges_tensor generation:  0.011170148849487305
mini_batch_src_global generation:  0.021305084228515625
r_  generation:  0.20864152908325195
local_output_nid generation:  0.011365413665771484
local_in_edges_tensor generation:  0.009197235107421875
mini_batch_src_global generation:  0.02265763282775879
r_  generation:  0.18927836418151855
local_output_nid generation:  0.008850574493408203
local_in_edges_tensor generation:  0.012003183364868164
mini_batch_src_global generation:  0.021848678588867188
r_  generation:  0.18130278587341309
local_output_nid generation:  0.010246992111206055
local_in_edges_tensor generation:  0.009404659271240234
mini_batch_src_global generation:  0.022194623947143555
r_  generation:  0.18071675300598145
local_output_nid generation:  0.009974241256713867
local_in_edges_tensor generation:  0.01059103012084961
mini_batch_src_global generation:  0.021138906478881836
r_  generation:  0.1786043643951416
local_output_nid generation:  0.009221076965332031
local_in_edges_tensor generation:  0.010989665985107422
mini_batch_src_global generation:  0.02307438850402832
r_  generation:  0.17995047569274902
local_output_nid generation:  0.009208440780639648
local_in_edges_tensor generation:  0.008780241012573242
mini_batch_src_global generation:  0.02216196060180664
r_  generation:  0.17848587036132812
local_output_nid generation:  0.009216547012329102
local_in_edges_tensor generation:  0.009799718856811523
mini_batch_src_global generation:  0.024422883987426758
r_  generation:  0.18293023109436035
local_output_nid generation:  0.009281396865844727
local_in_edges_tensor generation:  0.008871316909790039
mini_batch_src_global generation:  0.022389888763427734
r_  generation:  0.17893648147583008
local_output_nid generation:  0.009547948837280273
local_in_edges_tensor generation:  0.00896143913269043
mini_batch_src_global generation:  0.023291587829589844
r_  generation:  0.1803421974182129
local_output_nid generation:  0.009502172470092773
local_in_edges_tensor generation:  0.008927106857299805
mini_batch_src_global generation:  0.024184465408325195
r_  generation:  0.18524408340454102
local_output_nid generation:  0.00964665412902832
local_in_edges_tensor generation:  0.010476112365722656
mini_batch_src_global generation:  0.023679256439208984
r_  generation:  0.18847870826721191
local_output_nid generation:  0.009522438049316406
local_in_edges_tensor generation:  0.009098529815673828
mini_batch_src_global generation:  0.023060321807861328
r_  generation:  0.18382549285888672
local_output_nid generation:  0.00931406021118164
local_in_edges_tensor generation:  0.008991003036499023
mini_batch_src_global generation:  0.022901058197021484
r_  generation:  0.1784670352935791
local_output_nid generation:  0.009711742401123047
local_in_edges_tensor generation:  0.009040594100952148
mini_batch_src_global generation:  0.023199796676635742
r_  generation:  0.18525123596191406
local_output_nid generation:  0.009402275085449219
local_in_edges_tensor generation:  0.008892059326171875
mini_batch_src_global generation:  0.023200035095214844
r_  generation:  0.17903685569763184
local_output_nid generation:  0.009494781494140625
local_in_edges_tensor generation:  0.009019136428833008
mini_batch_src_global generation:  0.022531747817993164
r_  generation:  0.17900681495666504
local_output_nid generation:  0.009617090225219727
local_in_edges_tensor generation:  0.008856058120727539
mini_batch_src_global generation:  0.02276015281677246
r_  generation:  0.1792457103729248
local_output_nid generation:  0.00969243049621582
local_in_edges_tensor generation:  0.01019144058227539
mini_batch_src_global generation:  0.02425694465637207
r_  generation:  0.19115138053894043
local_output_nid generation:  0.009661674499511719
local_in_edges_tensor generation:  0.010404109954833984
mini_batch_src_global generation:  0.025525808334350586
r_  generation:  0.18943238258361816
local_output_nid generation:  0.009541749954223633
local_in_edges_tensor generation:  0.009084701538085938
mini_batch_src_global generation:  0.02288651466369629
r_  generation:  0.18213129043579102
local_output_nid generation:  0.009827136993408203
local_in_edges_tensor generation:  0.008766412734985352
mini_batch_src_global generation:  0.024508953094482422
r_  generation:  0.18829870223999023
local_output_nid generation:  0.009808540344238281
local_in_edges_tensor generation:  0.010457277297973633
mini_batch_src_global generation:  0.024582624435424805
r_  generation:  0.18976163864135742
local_output_nid generation:  0.009654045104980469
local_in_edges_tensor generation:  0.009695053100585938
mini_batch_src_global generation:  0.02341485023498535
r_  generation:  0.18895292282104492
local_output_nid generation:  0.009877204895019531
local_in_edges_tensor generation:  0.009710550308227539
mini_batch_src_global generation:  0.023445606231689453
r_  generation:  0.19179987907409668
local_output_nid generation:  0.009769916534423828
local_in_edges_tensor generation:  0.008963346481323242
mini_batch_src_global generation:  0.023470401763916016
r_  generation:  0.19088435173034668
local_output_nid generation:  0.00954890251159668
local_in_edges_tensor generation:  0.009026527404785156
mini_batch_src_global generation:  0.022803306579589844
r_  generation:  0.1846778392791748
local_output_nid generation:  0.010038375854492188
local_in_edges_tensor generation:  0.010219097137451172
mini_batch_src_global generation:  0.02446436882019043
r_  generation:  0.19551777839660645
local_output_nid generation:  0.009238958358764648
local_in_edges_tensor generation:  0.009052038192749023
mini_batch_src_global generation:  0.023133277893066406
r_  generation:  0.1841719150543213
----------------------check_connections_block total spend ----------------------------- 8.612051248550415
generate_one_block  0.2559695243835449
generate_one_block  0.2514204978942871
generate_one_block  0.26113080978393555
generate_one_block  0.24919605255126953
generate_one_block  0.276503324508667
generate_one_block  0.2507166862487793
generate_one_block  0.24788188934326172
generate_one_block  0.23986363410949707
generate_one_block  0.2515733242034912
generate_one_block  0.2501668930053711
generate_one_block  0.25789403915405273
generate_one_block  0.2465956211090088
generate_one_block  0.24823474884033203
generate_one_block  0.25469112396240234
generate_one_block  0.25534725189208984
generate_one_block  0.24978303909301758
generate_one_block  0.241591215133667
generate_one_block  0.2559783458709717
generate_one_block  0.24248170852661133
generate_one_block  0.255265474319458
generate_one_block  0.24620914459228516
generate_one_block  0.2622673511505127
generate_one_block  0.25343775749206543
generate_one_block  0.24388718605041504
generate_one_block  0.2565340995788574
generate_one_block  0.25552845001220703
generate_one_block  0.2535285949707031
generate_one_block  0.254256010055542
generate_one_block  0.2566661834716797
generate_one_block  0.2462925910949707
generate_one_block  0.2594466209411621
generate_one_block  0.24207544326782227
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036690473556518555
gen group dst list time:  0.11289167404174805
time for parepare:  0.019697189331054688
local_output_nid generation:  0.025810956954956055
local_in_edges_tensor generation:  0.05550503730773926
mini_batch_src_global generation:  0.04809117317199707
r_  generation:  0.4846763610839844
local_output_nid generation:  0.030797719955444336
local_in_edges_tensor generation:  0.038181304931640625
mini_batch_src_global generation:  0.06171393394470215
r_  generation:  0.49066853523254395
local_output_nid generation:  0.030708789825439453
local_in_edges_tensor generation:  0.03560900688171387
mini_batch_src_global generation:  0.05752205848693848
r_  generation:  0.5012633800506592
local_output_nid generation:  0.03196525573730469
local_in_edges_tensor generation:  0.030370712280273438
mini_batch_src_global generation:  0.05928492546081543
r_  generation:  0.49422669410705566
local_output_nid generation:  0.031207561492919922
local_in_edges_tensor generation:  0.02945566177368164
mini_batch_src_global generation:  0.05973100662231445
r_  generation:  0.5019505023956299
local_output_nid generation:  0.03100442886352539
local_in_edges_tensor generation:  0.03354835510253906
mini_batch_src_global generation:  0.059581756591796875
r_  generation:  0.49974608421325684
local_output_nid generation:  0.029977083206176758
local_in_edges_tensor generation:  0.035256147384643555
mini_batch_src_global generation:  0.05941629409790039
r_  generation:  0.5030205249786377
local_output_nid generation:  0.029268264770507812
local_in_edges_tensor generation:  0.03168320655822754
mini_batch_src_global generation:  0.059407711029052734
r_  generation:  0.4944114685058594
local_output_nid generation:  0.03233480453491211
local_in_edges_tensor generation:  0.033054351806640625
mini_batch_src_global generation:  0.059853315353393555
r_  generation:  0.5028693675994873
local_output_nid generation:  0.029929161071777344
local_in_edges_tensor generation:  0.031487464904785156
mini_batch_src_global generation:  0.06186032295227051
r_  generation:  0.5020689964294434
local_output_nid generation:  0.029764890670776367
local_in_edges_tensor generation:  0.038007497787475586
mini_batch_src_global generation:  0.05970144271850586
r_  generation:  0.5026257038116455
local_output_nid generation:  0.02976250648498535
local_in_edges_tensor generation:  0.03023386001586914
mini_batch_src_global generation:  0.060105323791503906
r_  generation:  0.49634504318237305
local_output_nid generation:  0.029762983322143555
local_in_edges_tensor generation:  0.0316157341003418
mini_batch_src_global generation:  0.061403512954711914
r_  generation:  0.5017898082733154
local_output_nid generation:  0.03091120719909668
local_in_edges_tensor generation:  0.029721975326538086
mini_batch_src_global generation:  0.060281991958618164
r_  generation:  0.5054233074188232
local_output_nid generation:  0.029462337493896484
local_in_edges_tensor generation:  0.03381633758544922
mini_batch_src_global generation:  0.06559109687805176
r_  generation:  0.5143387317657471
local_output_nid generation:  0.032607078552246094
local_in_edges_tensor generation:  0.036852359771728516
mini_batch_src_global generation:  0.06253814697265625
r_  generation:  0.5005247592926025
local_output_nid generation:  0.030034780502319336
local_in_edges_tensor generation:  0.03147172927856445
mini_batch_src_global generation:  0.058836936950683594
r_  generation:  0.5004398822784424
local_output_nid generation:  0.030417442321777344
local_in_edges_tensor generation:  0.031645774841308594
mini_batch_src_global generation:  0.06028103828430176
r_  generation:  0.5028042793273926
local_output_nid generation:  0.030295848846435547
local_in_edges_tensor generation:  0.031063318252563477
mini_batch_src_global generation:  0.05893540382385254
r_  generation:  0.5001733303070068
local_output_nid generation:  0.03025507926940918
local_in_edges_tensor generation:  0.03368115425109863
mini_batch_src_global generation:  0.0599362850189209
r_  generation:  0.4983963966369629
local_output_nid generation:  0.03082275390625
local_in_edges_tensor generation:  0.032056331634521484
mini_batch_src_global generation:  0.06079816818237305
r_  generation:  0.508345365524292
local_output_nid generation:  0.030484914779663086
local_in_edges_tensor generation:  0.0335848331451416
mini_batch_src_global generation:  0.06050753593444824
r_  generation:  0.5002796649932861
local_output_nid generation:  0.030739545822143555
local_in_edges_tensor generation:  0.034386396408081055
mini_batch_src_global generation:  0.05957651138305664
r_  generation:  0.5062046051025391
local_output_nid generation:  0.030730724334716797
local_in_edges_tensor generation:  0.0291292667388916
mini_batch_src_global generation:  0.06058812141418457
r_  generation:  0.4967374801635742
local_output_nid generation:  0.03072953224182129
local_in_edges_tensor generation:  0.03281068801879883
mini_batch_src_global generation:  0.061721086502075195
r_  generation:  0.5048997402191162
local_output_nid generation:  0.030863046646118164
local_in_edges_tensor generation:  0.03360152244567871
mini_batch_src_global generation:  0.05986523628234863
r_  generation:  0.497783899307251
local_output_nid generation:  0.03095698356628418
local_in_edges_tensor generation:  0.03095531463623047
mini_batch_src_global generation:  0.05897808074951172
r_  generation:  0.5045464038848877
local_output_nid generation:  0.03086996078491211
local_in_edges_tensor generation:  0.030094146728515625
mini_batch_src_global generation:  0.05991864204406738
r_  generation:  0.5029749870300293
local_output_nid generation:  0.031591176986694336
local_in_edges_tensor generation:  0.037035226821899414
mini_batch_src_global generation:  0.05883359909057617
r_  generation:  0.5081651210784912
local_output_nid generation:  0.030455827713012695
local_in_edges_tensor generation:  0.03730320930480957
mini_batch_src_global generation:  0.06053423881530762
r_  generation:  0.49692273139953613
local_output_nid generation:  0.03064107894897461
local_in_edges_tensor generation:  0.034981727600097656
mini_batch_src_global generation:  0.05934023857116699
r_  generation:  0.5079691410064697
local_output_nid generation:  0.03102421760559082
local_in_edges_tensor generation:  0.033414602279663086
mini_batch_src_global generation:  0.05988121032714844
r_  generation:  0.502633810043335
----------------------check_connections_block total spend ----------------------------- 23.54581594467163
generate_one_block  0.6936526298522949
generate_one_block  0.6752529144287109
generate_one_block  0.6768946647644043
generate_one_block  0.6810016632080078
generate_one_block  0.7850940227508545
generate_one_block  0.677009105682373
generate_one_block  0.6727900505065918
generate_one_block  0.667334794998169
generate_one_block  0.6814517974853516
generate_one_block  0.6887402534484863
generate_one_block  0.6890630722045898
generate_one_block  0.6810145378112793
generate_one_block  0.6798925399780273
generate_one_block  0.6747348308563232
generate_one_block  0.6777029037475586
generate_one_block  0.6873655319213867
generate_one_block  0.6710278987884521
generate_one_block  0.6795713901519775
generate_one_block  0.6784095764160156
generate_one_block  0.6759719848632812
generate_one_block  0.6913516521453857
generate_one_block  0.682117223739624
generate_one_block  0.6916236877441406
generate_one_block  0.6764101982116699
generate_one_block  0.7026870250701904
generate_one_block  0.6881818771362305
generate_one_block  0.6849846839904785
generate_one_block  0.6792893409729004
generate_one_block  0.691615104675293
generate_one_block  0.678924560546875
generate_one_block  0.6831269264221191
generate_one_block  0.674971342086792
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.13137102127075195  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

connection checking time:  32.157867193222046
block generation total time  29.991674423217773
average batch blocks generation time:  0.9372398257255554
block dataloader generation time/epoch 65.89713356229994
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10889673233032227  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.391613006591797  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10929298400878906  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.805991172790527  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10923385620117188  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 21.08251190185547  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10905790328979492  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.639407634735107  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.1093134880065918  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 21.00616693496704  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10926008224487305  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.596828937530518  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10894060134887695  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.439030170440674  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10873174667358398  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.2014102935791  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10918951034545898  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.684852123260498  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10922431945800781  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.6361722946167  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.1092534065246582  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.91094446182251  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10886383056640625  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.53729248046875  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10916757583618164  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.695321559906006  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10924720764160156  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.897286891937256  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10899162292480469  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.938406944274902  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10939836502075195  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.83076286315918  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10870552062988281  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.408477306365967  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10935640335083008  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.9684476852417  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10923385620117188  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.49417543411255  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.1090688705444336  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.42706060409546  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.10917043685913086  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 20.602220058441162  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5018310546875 GB
    Memory Allocated: 0.1094660758972168  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5799560546875 GB
    Memory Allocated: 21.13980484008789  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10920381546020508  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.979941844940186  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10917854309082031  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.617955207824707  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1094827651977539  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.041391372680664  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10953426361083984  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.07933759689331  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10947179794311523  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.996408939361572  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10944223403930664  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.010079383850098  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10953378677368164  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.04051971435547  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10901069641113281  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.492218017578125  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10964632034301758  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.31141424179077  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1092844009399414  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.588205337524414  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03303027153015137 |0.023459002375602722 |0.6277329474687576 |9.546428918838501e-05 |1.1892327070236206 |0.005411624908447266 |
----------------------------------------------------------pseudo_mini_loss sum 1.2624353170394897
Total (block generation + training)time/epoch 125.98070855935414
Training time/epoch 60.02211141586304
Training time without block to device /epoch 59.27142333984375
Training time without total dataloading part /epoch 58.15136742591858
load block tensor time/epoch 1.0569686889648438
block to device time/epoch 0.7506880760192871
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  9160668
Number of first layer input nodes during this epoch:  4807732
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1314849853515625  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02595996856689453
range selection method range initialization spend 0.014219999313354492
time for parepare:  0.019361257553100586
local_output_nid generation:  0.0011494159698486328
local_in_edges_tensor generation:  0.0043735504150390625
mini_batch_src_global generation:  0.0026006698608398438
r_  generation:  0.015971660614013672
local_output_nid generation:  0.0014033317565917969
local_in_edges_tensor generation:  0.0008280277252197266
mini_batch_src_global generation:  0.0015819072723388672
r_  generation:  0.018342256546020508
local_output_nid generation:  0.0016372203826904297
local_in_edges_tensor generation:  0.0010259151458740234
mini_batch_src_global generation:  0.0018489360809326172
r_  generation:  0.011602401733398438
local_output_nid generation:  0.0009758472442626953
local_in_edges_tensor generation:  0.0006175041198730469
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.009550094604492188
local_output_nid generation:  0.0009393692016601562
local_in_edges_tensor generation:  0.0005893707275390625
mini_batch_src_global generation:  0.0011289119720458984
r_  generation:  0.009785652160644531
local_output_nid generation:  0.0009102821350097656
local_in_edges_tensor generation:  0.0006406307220458984
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.010230779647827148
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0005671977996826172
mini_batch_src_global generation:  0.001087188720703125
r_  generation:  0.010029792785644531
local_output_nid generation:  0.000896453857421875
local_in_edges_tensor generation:  0.0005953311920166016
mini_batch_src_global generation:  0.0010483264923095703
r_  generation:  0.010045528411865234
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0005943775177001953
mini_batch_src_global generation:  0.0011737346649169922
r_  generation:  0.010297536849975586
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0005958080291748047
mini_batch_src_global generation:  0.001150369644165039
r_  generation:  0.010600566864013672
local_output_nid generation:  0.0008492469787597656
local_in_edges_tensor generation:  0.0005993843078613281
mini_batch_src_global generation:  0.0011372566223144531
r_  generation:  0.010336637496948242
local_output_nid generation:  0.0008587837219238281
local_in_edges_tensor generation:  0.0005881786346435547
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.0103759765625
local_output_nid generation:  0.0008649826049804688
local_in_edges_tensor generation:  0.0005927085876464844
mini_batch_src_global generation:  0.0011553764343261719
r_  generation:  0.010503292083740234
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0005946159362792969
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.010695934295654297
local_output_nid generation:  0.0008718967437744141
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.010329484939575195
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0006213188171386719
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.010313749313354492
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.010461568832397461
local_output_nid generation:  0.0008499622344970703
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.010450601577758789
local_output_nid generation:  0.0008609294891357422
local_in_edges_tensor generation:  0.0006005764007568359
mini_batch_src_global generation:  0.0012767314910888672
r_  generation:  0.01100921630859375
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0006055831909179688
mini_batch_src_global generation:  0.0012199878692626953
r_  generation:  0.010315895080566406
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.001119852066040039
r_  generation:  0.010135412216186523
local_output_nid generation:  0.0008492469787597656
local_in_edges_tensor generation:  0.0006213188171386719
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.010645389556884766
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.000598907470703125
mini_batch_src_global generation:  0.0012538433074951172
r_  generation:  0.010817766189575195
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.010997533798217773
local_output_nid generation:  0.0008463859558105469
local_in_edges_tensor generation:  0.0005853176116943359
mini_batch_src_global generation:  0.0011684894561767578
r_  generation:  0.010491609573364258
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.0010941028594970703
r_  generation:  0.010231971740722656
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005869865417480469
mini_batch_src_global generation:  0.0011074542999267578
r_  generation:  0.010289192199707031
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0011436939239501953
r_  generation:  0.010537385940551758
local_output_nid generation:  0.0008783340454101562
local_in_edges_tensor generation:  0.0005788803100585938
mini_batch_src_global generation:  0.0012392997741699219
r_  generation:  0.010536432266235352
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005662441253662109
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.010298013687133789
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.0005831718444824219
mini_batch_src_global generation:  0.001176595687866211
r_  generation:  0.010643959045410156
local_output_nid generation:  0.0008513927459716797
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0011043548583984375
r_  generation:  0.01027059555053711
----------------------check_connections_block total spend ----------------------------- 0.5443029403686523
generate_one_block  0.021892070770263672
generate_one_block  0.021396160125732422
generate_one_block  0.018793582916259766
generate_one_block  0.018184423446655273
generate_one_block  0.018744945526123047
generate_one_block  0.019277095794677734
generate_one_block  0.018834829330444336
generate_one_block  0.018663644790649414
generate_one_block  0.01905083656311035
generate_one_block  0.019371509552001953
generate_one_block  0.01874375343322754
generate_one_block  0.021276473999023438
generate_one_block  0.01962757110595703
generate_one_block  0.019358158111572266
generate_one_block  0.018728256225585938
generate_one_block  0.018678903579711914
generate_one_block  0.01876974105834961
generate_one_block  0.018743276596069336
generate_one_block  0.019818782806396484
generate_one_block  0.01850748062133789
generate_one_block  0.0185396671295166
generate_one_block  0.019228219985961914
generate_one_block  0.01967144012451172
generate_one_block  0.019572734832763672
generate_one_block  0.01896810531616211
generate_one_block  0.018297195434570312
generate_one_block  0.018648862838745117
generate_one_block  0.018931150436401367
generate_one_block  0.01899433135986328
generate_one_block  0.018585205078125
generate_one_block  0.019204378128051758
generate_one_block  0.018448352813720703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04025554656982422
gen group dst list time:  0.022812366485595703
time for parepare:  0.020223140716552734
local_output_nid generation:  0.0059587955474853516
local_in_edges_tensor generation:  0.01679706573486328
mini_batch_src_global generation:  0.01723790168762207
r_  generation:  0.16727185249328613
local_output_nid generation:  0.008635520935058594
local_in_edges_tensor generation:  0.013137340545654297
mini_batch_src_global generation:  0.0210874080657959
r_  generation:  0.17064881324768066
local_output_nid generation:  0.008125066757202148
local_in_edges_tensor generation:  0.0344996452331543
mini_batch_src_global generation:  0.020875215530395508
r_  generation:  0.20067167282104492
local_output_nid generation:  0.008071422576904297
local_in_edges_tensor generation:  0.010979890823364258
mini_batch_src_global generation:  0.019495248794555664
r_  generation:  0.19376802444458008
local_output_nid generation:  0.011716127395629883
local_in_edges_tensor generation:  0.009477853775024414
mini_batch_src_global generation:  0.02615189552307129
r_  generation:  0.17908191680908203
local_output_nid generation:  0.008954524993896484
local_in_edges_tensor generation:  0.00922083854675293
mini_batch_src_global generation:  0.022574663162231445
r_  generation:  0.17610836029052734
local_output_nid generation:  0.008907794952392578
local_in_edges_tensor generation:  0.009902477264404297
mini_batch_src_global generation:  0.02161097526550293
r_  generation:  0.17789220809936523
local_output_nid generation:  0.008946657180786133
local_in_edges_tensor generation:  0.01007986068725586
mini_batch_src_global generation:  0.023156404495239258
r_  generation:  0.18396401405334473
local_output_nid generation:  0.008767366409301758
local_in_edges_tensor generation:  0.010541439056396484
mini_batch_src_global generation:  0.03665494918823242
r_  generation:  0.2344074249267578
local_output_nid generation:  0.014317512512207031
local_in_edges_tensor generation:  0.011983633041381836
mini_batch_src_global generation:  0.03026580810546875
r_  generation:  0.19730067253112793
local_output_nid generation:  0.009351730346679688
local_in_edges_tensor generation:  0.009016990661621094
mini_batch_src_global generation:  0.027178525924682617
r_  generation:  0.19480347633361816
local_output_nid generation:  0.009521722793579102
local_in_edges_tensor generation:  0.009904861450195312
mini_batch_src_global generation:  0.026704072952270508
r_  generation:  0.1950225830078125
local_output_nid generation:  0.009792566299438477
local_in_edges_tensor generation:  0.009561300277709961
mini_batch_src_global generation:  0.03475832939147949
r_  generation:  0.20036792755126953
local_output_nid generation:  0.009703874588012695
local_in_edges_tensor generation:  0.010477781295776367
mini_batch_src_global generation:  0.02685856819152832
r_  generation:  0.19889378547668457
local_output_nid generation:  0.00955820083618164
local_in_edges_tensor generation:  0.008710861206054688
mini_batch_src_global generation:  0.027117490768432617
r_  generation:  0.2297656536102295
local_output_nid generation:  0.009759902954101562
local_in_edges_tensor generation:  0.010540962219238281
mini_batch_src_global generation:  0.025861501693725586
r_  generation:  0.208984375
local_output_nid generation:  0.01188206672668457
local_in_edges_tensor generation:  0.01068878173828125
mini_batch_src_global generation:  0.0298001766204834
r_  generation:  0.19893956184387207
local_output_nid generation:  0.009651660919189453
local_in_edges_tensor generation:  0.009532451629638672
mini_batch_src_global generation:  0.028362035751342773
r_  generation:  0.19611620903015137
local_output_nid generation:  0.010107994079589844
local_in_edges_tensor generation:  0.010820150375366211
mini_batch_src_global generation:  0.028438568115234375
r_  generation:  0.21150922775268555
local_output_nid generation:  0.009554624557495117
local_in_edges_tensor generation:  0.008627176284790039
mini_batch_src_global generation:  0.02754807472229004
r_  generation:  0.20362377166748047
local_output_nid generation:  0.009665489196777344
local_in_edges_tensor generation:  0.011369943618774414
mini_batch_src_global generation:  0.025307178497314453
r_  generation:  0.19852614402770996
local_output_nid generation:  0.009836196899414062
local_in_edges_tensor generation:  0.012028932571411133
mini_batch_src_global generation:  0.02755141258239746
r_  generation:  0.20021748542785645
local_output_nid generation:  0.010031938552856445
local_in_edges_tensor generation:  0.009872198104858398
mini_batch_src_global generation:  0.027686119079589844
r_  generation:  0.20569086074829102
local_output_nid generation:  0.009993314743041992
local_in_edges_tensor generation:  0.009656667709350586
mini_batch_src_global generation:  0.02677464485168457
r_  generation:  0.20241880416870117
local_output_nid generation:  0.009749174118041992
local_in_edges_tensor generation:  0.010623455047607422
mini_batch_src_global generation:  0.027593135833740234
r_  generation:  0.19905328750610352
local_output_nid generation:  0.009478092193603516
local_in_edges_tensor generation:  0.00914621353149414
mini_batch_src_global generation:  0.025728702545166016
r_  generation:  0.19338607788085938
local_output_nid generation:  0.009642362594604492
local_in_edges_tensor generation:  0.010289907455444336
mini_batch_src_global generation:  0.02624225616455078
r_  generation:  0.19782447814941406
local_output_nid generation:  0.009780406951904297
local_in_edges_tensor generation:  0.008988618850708008
mini_batch_src_global generation:  0.0276339054107666
r_  generation:  0.20457887649536133
local_output_nid generation:  0.010924816131591797
local_in_edges_tensor generation:  0.012127399444580078
mini_batch_src_global generation:  0.02830028533935547
r_  generation:  0.21383452415466309
local_output_nid generation:  0.011345386505126953
local_in_edges_tensor generation:  0.00966787338256836
mini_batch_src_global generation:  0.026944637298583984
r_  generation:  0.20156598091125488
local_output_nid generation:  0.009887933731079102
local_in_edges_tensor generation:  0.009960651397705078
mini_batch_src_global generation:  0.028604984283447266
r_  generation:  0.20170974731445312
local_output_nid generation:  0.010580062866210938
local_in_edges_tensor generation:  0.013421297073364258
mini_batch_src_global generation:  0.026227712631225586
r_  generation:  0.19887757301330566
----------------------check_connections_block total spend ----------------------------- 9.335689067840576
generate_one_block  0.27286553382873535
generate_one_block  0.24830365180969238
generate_one_block  0.2403402328491211
generate_one_block  0.236114501953125
generate_one_block  0.2636120319366455
generate_one_block  0.2428758144378662
generate_one_block  0.23868441581726074
generate_one_block  0.2503323554992676
generate_one_block  0.25469517707824707
generate_one_block  0.2581484317779541
generate_one_block  0.2682969570159912
generate_one_block  0.2563292980194092
generate_one_block  0.25983500480651855
generate_one_block  0.2608373165130615
generate_one_block  0.253603458404541
generate_one_block  0.25269007682800293
generate_one_block  0.25114989280700684
generate_one_block  0.24793195724487305
generate_one_block  0.26916027069091797
generate_one_block  0.25634288787841797
generate_one_block  0.2543954849243164
generate_one_block  0.2612295150756836
generate_one_block  0.26284027099609375
generate_one_block  0.2607426643371582
generate_one_block  0.2557861804962158
generate_one_block  0.24327898025512695
generate_one_block  0.2488114833831787
generate_one_block  0.2573850154876709
generate_one_block  0.2651405334472656
generate_one_block  0.25403475761413574
generate_one_block  0.2529623508453369
generate_one_block  0.24651598930358887
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03949689865112305
gen group dst list time:  0.11617183685302734
time for parepare:  0.01934051513671875
local_output_nid generation:  0.02591109275817871
local_in_edges_tensor generation:  0.05436420440673828
mini_batch_src_global generation:  0.04677891731262207
r_  generation:  0.489377498626709
local_output_nid generation:  0.03056812286376953
local_in_edges_tensor generation:  0.03695535659790039
mini_batch_src_global generation:  0.05945706367492676
r_  generation:  0.4897797107696533
local_output_nid generation:  0.03087759017944336
local_in_edges_tensor generation:  0.03681540489196777
mini_batch_src_global generation:  0.05899667739868164
r_  generation:  0.4946298599243164
local_output_nid generation:  0.03082561492919922
local_in_edges_tensor generation:  0.03471565246582031
mini_batch_src_global generation:  0.06871318817138672
r_  generation:  0.49178266525268555
local_output_nid generation:  0.031032323837280273
local_in_edges_tensor generation:  0.027917861938476562
mini_batch_src_global generation:  0.06009721755981445
r_  generation:  0.5029346942901611
local_output_nid generation:  0.031133651733398438
local_in_edges_tensor generation:  0.02871561050415039
mini_batch_src_global generation:  0.05961155891418457
r_  generation:  0.5007617473602295
local_output_nid generation:  0.030109643936157227
local_in_edges_tensor generation:  0.028560161590576172
mini_batch_src_global generation:  0.05886411666870117
r_  generation:  0.5020310878753662
local_output_nid generation:  0.031099796295166016
local_in_edges_tensor generation:  0.03416776657104492
mini_batch_src_global generation:  0.05988645553588867
r_  generation:  0.5068986415863037
local_output_nid generation:  0.029392719268798828
local_in_edges_tensor generation:  0.03809952735900879
mini_batch_src_global generation:  0.0608212947845459
r_  generation:  0.5049037933349609
local_output_nid generation:  0.02975010871887207
local_in_edges_tensor generation:  0.03363966941833496
mini_batch_src_global generation:  0.06008768081665039
r_  generation:  0.5009572505950928
local_output_nid generation:  0.029252290725708008
local_in_edges_tensor generation:  0.03333401679992676
mini_batch_src_global generation:  0.05836033821105957
r_  generation:  0.50357985496521
local_output_nid generation:  0.02943134307861328
local_in_edges_tensor generation:  0.029438257217407227
mini_batch_src_global generation:  0.05918407440185547
r_  generation:  0.504993200302124
local_output_nid generation:  0.030736684799194336
local_in_edges_tensor generation:  0.02911376953125
mini_batch_src_global generation:  0.059105873107910156
r_  generation:  0.5030007362365723
local_output_nid generation:  0.02951645851135254
local_in_edges_tensor generation:  0.031777143478393555
mini_batch_src_global generation:  0.06383013725280762
r_  generation:  0.5012943744659424
local_output_nid generation:  0.02946949005126953
local_in_edges_tensor generation:  0.029767751693725586
mini_batch_src_global generation:  0.05871272087097168
r_  generation:  0.5060656070709229
local_output_nid generation:  0.02992415428161621
local_in_edges_tensor generation:  0.03550267219543457
mini_batch_src_global generation:  0.061959266662597656
r_  generation:  0.50758957862854
local_output_nid generation:  0.030626773834228516
local_in_edges_tensor generation:  0.034369468688964844
mini_batch_src_global generation:  0.05874276161193848
r_  generation:  0.5124180316925049
local_output_nid generation:  0.03001689910888672
local_in_edges_tensor generation:  0.03067302703857422
mini_batch_src_global generation:  0.05964231491088867
r_  generation:  0.5068910121917725
local_output_nid generation:  0.02988123893737793
local_in_edges_tensor generation:  0.03692960739135742
mini_batch_src_global generation:  0.06324148178100586
r_  generation:  0.5017974376678467
local_output_nid generation:  0.031473398208618164
local_in_edges_tensor generation:  0.029515981674194336
mini_batch_src_global generation:  0.06020808219909668
r_  generation:  0.49689626693725586
local_output_nid generation:  0.030710458755493164
local_in_edges_tensor generation:  0.03226017951965332
mini_batch_src_global generation:  0.05906558036804199
r_  generation:  0.5018002986907959
local_output_nid generation:  0.03039240837097168
local_in_edges_tensor generation:  0.03113842010498047
mini_batch_src_global generation:  0.060791730880737305
r_  generation:  0.5047688484191895
local_output_nid generation:  0.030985116958618164
local_in_edges_tensor generation:  0.031824588775634766
mini_batch_src_global generation:  0.06130576133728027
r_  generation:  0.5099923610687256
local_output_nid generation:  0.03092479705810547
local_in_edges_tensor generation:  0.03040313720703125
mini_batch_src_global generation:  0.06058931350708008
r_  generation:  0.5011508464813232
local_output_nid generation:  0.030967235565185547
local_in_edges_tensor generation:  0.03066730499267578
mini_batch_src_global generation:  0.05907106399536133
r_  generation:  0.5074832439422607
local_output_nid generation:  0.030570030212402344
local_in_edges_tensor generation:  0.03114628791809082
mini_batch_src_global generation:  0.060457706451416016
r_  generation:  0.5005393028259277
local_output_nid generation:  0.030730247497558594
local_in_edges_tensor generation:  0.03113698959350586
mini_batch_src_global generation:  0.05932760238647461
r_  generation:  0.5006835460662842
local_output_nid generation:  0.030770540237426758
local_in_edges_tensor generation:  0.03068399429321289
mini_batch_src_global generation:  0.06070065498352051
r_  generation:  0.5047674179077148
local_output_nid generation:  0.030637502670288086
local_in_edges_tensor generation:  0.031638145446777344
mini_batch_src_global generation:  0.05977201461791992
r_  generation:  0.5087954998016357
local_output_nid generation:  0.030603408813476562
local_in_edges_tensor generation:  0.030568599700927734
mini_batch_src_global generation:  0.06019091606140137
r_  generation:  0.5015451908111572
local_output_nid generation:  0.030756711959838867
local_in_edges_tensor generation:  0.030713558197021484
mini_batch_src_global generation:  0.0594027042388916
r_  generation:  0.5055170059204102
local_output_nid generation:  0.030457019805908203
local_in_edges_tensor generation:  0.031049489974975586
mini_batch_src_global generation:  0.06037425994873047
r_  generation:  0.5039553642272949
----------------------check_connections_block total spend ----------------------------- 23.556485414505005
generate_one_block  0.6969277858734131
generate_one_block  0.6795058250427246
generate_one_block  0.6727871894836426
generate_one_block  0.6689109802246094
generate_one_block  0.7831134796142578
generate_one_block  0.6778895854949951
generate_one_block  0.6757056713104248
generate_one_block  0.6787106990814209
generate_one_block  0.6809027194976807
generate_one_block  0.6816155910491943
generate_one_block  0.6822061538696289
generate_one_block  0.6772348880767822
generate_one_block  0.682706356048584
generate_one_block  0.6763129234313965
generate_one_block  0.6817419528961182
generate_one_block  0.6823153495788574
generate_one_block  0.669771671295166
generate_one_block  0.6744265556335449
generate_one_block  0.6850471496582031
generate_one_block  0.6721985340118408
generate_one_block  0.6716907024383545
generate_one_block  0.6841461658477783
generate_one_block  0.696723461151123
generate_one_block  0.6810674667358398
generate_one_block  0.6996147632598877
generate_one_block  0.6756687164306641
generate_one_block  0.6799261569976807
generate_one_block  0.6825013160705566
generate_one_block  0.6826615333557129
generate_one_block  0.680532693862915
generate_one_block  0.688657283782959
generate_one_block  0.6829912662506104
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1314849853515625  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

connection checking time:  32.89217448234558
block generation total time  30.031485080718994
average batch blocks generation time:  0.9384839087724686
block dataloader generation time/epoch 65.93256210025989
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10916662216186523  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.735839366912842  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10896921157836914  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.67913007736206  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10882759094238281  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.294925689697266  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1086111068725586  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.129820346832275  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10890865325927734  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.737541675567627  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1091604232788086  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.582433700561523  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10892581939697266  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.34807014465332  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10910415649414062  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.756675720214844  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10946083068847656  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.984389781951904  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10939693450927734  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.04424238204956  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1091461181640625  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.78187131881714  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10909557342529297  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.907896518707275  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10950136184692383  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.979668140411377  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10887813568115234  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.078009605407715  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10925626754760742  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.81274652481079  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10930109024047852  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.78751564025879  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10918331146240234  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.65730047225952  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10902976989746094  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.580979824066162  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10965156555175781  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.432339191436768  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10912609100341797  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.4901762008667  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10919427871704102  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.443645000457764  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10923290252685547  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.913156986236572  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10962438583374023  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.244423866271973  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10949039459228516  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.102216243743896  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10922861099243164  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.823527812957764  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1090078353881836  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.394513607025146  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10924768447875977  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.679240703582764  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10937738418579102  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.906041145324707  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10950565338134766  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.09106969833374  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10906744003295898  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.810413360595703  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10925674438476562  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.91390609741211  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10919857025146484  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.61151933670044  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02646898478269577 |0.021626025438308716 |0.6295991465449333 |9.679794311523438e-05 |1.192087508738041 |0.005423545837402344 |
----------------------------------------------------------pseudo_mini_loss sum 1.2433202266693115
Total (block generation + training)time/epoch 126.00691686178509
Training time/epoch 59.90814161300659
Training time without block to device /epoch 59.21610879898071
Training time without total dataloading part /epoch 58.302494049072266
load block tensor time/epoch 0.8470075130462646
block to device time/epoch 0.6920328140258789
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  9157723
Number of first layer input nodes during this epoch:  4806232
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1315317153930664  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0258636474609375
range selection method range initialization spend 0.014133691787719727
time for parepare:  0.019489288330078125
local_output_nid generation:  0.0010180473327636719
local_in_edges_tensor generation:  0.0074613094329833984
mini_batch_src_global generation:  0.0014121532440185547
r_  generation:  0.010753393173217773
local_output_nid generation:  0.0009772777557373047
local_in_edges_tensor generation:  0.00070953369140625
mini_batch_src_global generation:  0.0014083385467529297
r_  generation:  0.011131048202514648
local_output_nid generation:  0.0009238719940185547
local_in_edges_tensor generation:  0.0006346702575683594
mini_batch_src_global generation:  0.001154184341430664
r_  generation:  0.010034799575805664
local_output_nid generation:  0.0008914470672607422
local_in_edges_tensor generation:  0.0006277561187744141
mini_batch_src_global generation:  0.0010614395141601562
r_  generation:  0.009823083877563477
local_output_nid generation:  0.0009052753448486328
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.001066446304321289
r_  generation:  0.010033845901489258
local_output_nid generation:  0.0008878707885742188
local_in_edges_tensor generation:  0.0006010532379150391
mini_batch_src_global generation:  0.001077413558959961
r_  generation:  0.010301828384399414
local_output_nid generation:  0.0009045600891113281
local_in_edges_tensor generation:  0.0006034374237060547
mini_batch_src_global generation:  0.0011293888092041016
r_  generation:  0.010234832763671875
local_output_nid generation:  0.0009107589721679688
local_in_edges_tensor generation:  0.0006074905395507812
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.01058816909790039
local_output_nid generation:  0.000904083251953125
local_in_edges_tensor generation:  0.0005955696105957031
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.009958982467651367
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0006155967712402344
mini_batch_src_global generation:  0.0011403560638427734
r_  generation:  0.01047968864440918
local_output_nid generation:  0.0008947849273681641
local_in_edges_tensor generation:  0.0005981922149658203
mini_batch_src_global generation:  0.0011532306671142578
r_  generation:  0.010627985000610352
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0006012916564941406
mini_batch_src_global generation:  0.0012104511260986328
r_  generation:  0.010637998580932617
local_output_nid generation:  0.0008661746978759766
local_in_edges_tensor generation:  0.0005881786346435547
mini_batch_src_global generation:  0.0010821819305419922
r_  generation:  0.00996088981628418
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0006093978881835938
mini_batch_src_global generation:  0.0012316703796386719
r_  generation:  0.010721921920776367
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0005795955657958984
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.010221719741821289
local_output_nid generation:  0.0008864402770996094
local_in_edges_tensor generation:  0.0005915164947509766
mini_batch_src_global generation:  0.0012481212615966797
r_  generation:  0.010252714157104492
local_output_nid generation:  0.0008580684661865234
local_in_edges_tensor generation:  0.0005910396575927734
mini_batch_src_global generation:  0.0011641979217529297
r_  generation:  0.010313749313354492
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.0006349086761474609
mini_batch_src_global generation:  0.0011997222900390625
r_  generation:  0.010722875595092773
local_output_nid generation:  0.0008637905120849609
local_in_edges_tensor generation:  0.0006020069122314453
mini_batch_src_global generation:  0.0012271404266357422
r_  generation:  0.010526180267333984
local_output_nid generation:  0.0008981227874755859
local_in_edges_tensor generation:  0.0006206035614013672
mini_batch_src_global generation:  0.0011446475982666016
r_  generation:  0.010572433471679688
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.0005857944488525391
mini_batch_src_global generation:  0.001161336898803711
r_  generation:  0.010280847549438477
local_output_nid generation:  0.0008780956268310547
local_in_edges_tensor generation:  0.0006055831909179688
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.010733604431152344
local_output_nid generation:  0.0008559226989746094
local_in_edges_tensor generation:  0.0005803108215332031
mini_batch_src_global generation:  0.001180887222290039
r_  generation:  0.010097742080688477
local_output_nid generation:  0.0008893013000488281
local_in_edges_tensor generation:  0.0006105899810791016
mini_batch_src_global generation:  0.0011987686157226562
r_  generation:  0.010913372039794922
local_output_nid generation:  0.0009019374847412109
local_in_edges_tensor generation:  0.0005793571472167969
mini_batch_src_global generation:  0.0012331008911132812
r_  generation:  0.010498046875
local_output_nid generation:  0.0008921623229980469
local_in_edges_tensor generation:  0.0005838871002197266
mini_batch_src_global generation:  0.0011219978332519531
r_  generation:  0.010358095169067383
local_output_nid generation:  0.0008814334869384766
local_in_edges_tensor generation:  0.0005884170532226562
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.010393857955932617
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005929470062255859
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.009862899780273438
local_output_nid generation:  0.0008792877197265625
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.0012118816375732422
r_  generation:  0.010166645050048828
local_output_nid generation:  0.0008728504180908203
local_in_edges_tensor generation:  0.0005736351013183594
mini_batch_src_global generation:  0.0011875629425048828
r_  generation:  0.010360479354858398
local_output_nid generation:  0.0009145736694335938
local_in_edges_tensor generation:  0.000621795654296875
mini_batch_src_global generation:  0.0011811256408691406
r_  generation:  0.010374307632446289
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0005676746368408203
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.010506629943847656
----------------------check_connections_block total spend ----------------------------- 0.5262460708618164
generate_one_block  0.021944761276245117
generate_one_block  0.021652698516845703
generate_one_block  0.019661426544189453
generate_one_block  0.01897454261779785
generate_one_block  0.019388914108276367
generate_one_block  0.0192413330078125
generate_one_block  0.01911473274230957
generate_one_block  0.019737720489501953
generate_one_block  0.018590927124023438
generate_one_block  0.01927971839904785
generate_one_block  0.019418954849243164
generate_one_block  0.024022817611694336
generate_one_block  0.018897294998168945
generate_one_block  0.01999211311340332
generate_one_block  0.018630504608154297
generate_one_block  0.01908397674560547
generate_one_block  0.019015073776245117
generate_one_block  0.019793033599853516
generate_one_block  0.01911187171936035
generate_one_block  0.019343137741088867
generate_one_block  0.01872110366821289
generate_one_block  0.019713401794433594
generate_one_block  0.018647193908691406
generate_one_block  0.019954204559326172
generate_one_block  0.01923227310180664
generate_one_block  0.018991947174072266
generate_one_block  0.019089937210083008
generate_one_block  0.01814126968383789
generate_one_block  0.01842021942138672
generate_one_block  0.019057750701904297
generate_one_block  0.018722057342529297
generate_one_block  0.01901531219482422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03906416893005371
gen group dst list time:  0.02097344398498535
time for parepare:  0.021587133407592773
local_output_nid generation:  0.005781888961791992
local_in_edges_tensor generation:  0.0186460018157959
mini_batch_src_global generation:  0.0167543888092041
r_  generation:  0.1642768383026123
local_output_nid generation:  0.007945537567138672
local_in_edges_tensor generation:  0.011223077774047852
mini_batch_src_global generation:  0.022209644317626953
r_  generation:  0.17107081413269043
local_output_nid generation:  0.008149147033691406
local_in_edges_tensor generation:  0.033364057540893555
mini_batch_src_global generation:  0.02056598663330078
r_  generation:  0.17366838455200195
local_output_nid generation:  0.008306026458740234
local_in_edges_tensor generation:  0.009203672409057617
mini_batch_src_global generation:  0.020493268966674805
r_  generation:  0.17452383041381836
local_output_nid generation:  0.008803367614746094
local_in_edges_tensor generation:  0.011005640029907227
mini_batch_src_global generation:  0.02254796028137207
r_  generation:  0.1822035312652588
local_output_nid generation:  0.008989334106445312
local_in_edges_tensor generation:  0.011426448822021484
mini_batch_src_global generation:  0.02222156524658203
r_  generation:  0.1771559715270996
local_output_nid generation:  0.008936405181884766
local_in_edges_tensor generation:  0.008749961853027344
mini_batch_src_global generation:  0.022659778594970703
r_  generation:  0.17983794212341309
local_output_nid generation:  0.009020090103149414
local_in_edges_tensor generation:  0.01026010513305664
mini_batch_src_global generation:  0.022788047790527344
r_  generation:  0.18400287628173828
local_output_nid generation:  0.008444786071777344
local_in_edges_tensor generation:  0.008753299713134766
mini_batch_src_global generation:  0.02274608612060547
r_  generation:  0.1773684024810791
local_output_nid generation:  0.00910329818725586
local_in_edges_tensor generation:  0.008955001831054688
mini_batch_src_global generation:  0.022727251052856445
r_  generation:  0.1800987720489502
local_output_nid generation:  0.009198188781738281
local_in_edges_tensor generation:  0.008951663970947266
mini_batch_src_global generation:  0.02436089515686035
r_  generation:  0.18692660331726074
local_output_nid generation:  0.009505748748779297
local_in_edges_tensor generation:  0.009843587875366211
mini_batch_src_global generation:  0.023461103439331055
r_  generation:  0.1846926212310791
local_output_nid generation:  0.008819818496704102
local_in_edges_tensor generation:  0.011539459228515625
mini_batch_src_global generation:  0.023327350616455078
r_  generation:  0.17576193809509277
local_output_nid generation:  0.009665250778198242
local_in_edges_tensor generation:  0.010671615600585938
mini_batch_src_global generation:  0.024983644485473633
r_  generation:  0.19099855422973633
local_output_nid generation:  0.009187936782836914
local_in_edges_tensor generation:  0.008839845657348633
mini_batch_src_global generation:  0.02317953109741211
r_  generation:  0.1753075122833252
local_output_nid generation:  0.009205341339111328
local_in_edges_tensor generation:  0.00909733772277832
mini_batch_src_global generation:  0.02317190170288086
r_  generation:  0.1815323829650879
local_output_nid generation:  0.009290933609008789
local_in_edges_tensor generation:  0.008981466293334961
mini_batch_src_global generation:  0.023080825805664062
r_  generation:  0.18414807319641113
local_output_nid generation:  0.00944662094116211
local_in_edges_tensor generation:  0.008914470672607422
mini_batch_src_global generation:  0.023774385452270508
r_  generation:  0.18655800819396973
local_output_nid generation:  0.009412765502929688
local_in_edges_tensor generation:  0.009138345718383789
mini_batch_src_global generation:  0.023914575576782227
r_  generation:  0.18497729301452637
local_output_nid generation:  0.009499788284301758
local_in_edges_tensor generation:  0.009722471237182617
mini_batch_src_global generation:  0.023490428924560547
r_  generation:  0.1875743865966797
local_output_nid generation:  0.009166479110717773
local_in_edges_tensor generation:  0.009523391723632812
mini_batch_src_global generation:  0.02290964126586914
r_  generation:  0.182509183883667
local_output_nid generation:  0.009541988372802734
local_in_edges_tensor generation:  0.009691238403320312
mini_batch_src_global generation:  0.02377772331237793
r_  generation:  0.18821382522583008
local_output_nid generation:  0.009180784225463867
local_in_edges_tensor generation:  0.008891105651855469
mini_batch_src_global generation:  0.025173187255859375
r_  generation:  0.17791295051574707
local_output_nid generation:  0.009844541549682617
local_in_edges_tensor generation:  0.009408950805664062
mini_batch_src_global generation:  0.023943185806274414
r_  generation:  0.19081354141235352
local_output_nid generation:  0.009470224380493164
local_in_edges_tensor generation:  0.010497093200683594
mini_batch_src_global generation:  0.02354717254638672
r_  generation:  0.18755292892456055
local_output_nid generation:  0.009417533874511719
local_in_edges_tensor generation:  0.009642601013183594
mini_batch_src_global generation:  0.023095130920410156
r_  generation:  0.1860051155090332
local_output_nid generation:  0.009567975997924805
local_in_edges_tensor generation:  0.009889364242553711
mini_batch_src_global generation:  0.02341151237487793
r_  generation:  0.19031858444213867
local_output_nid generation:  0.009240865707397461
local_in_edges_tensor generation:  0.008809804916381836
mini_batch_src_global generation:  0.0236203670501709
r_  generation:  0.17904305458068848
local_output_nid generation:  0.009329795837402344
local_in_edges_tensor generation:  0.011793375015258789
mini_batch_src_global generation:  0.02251410484313965
r_  generation:  0.18234682083129883
local_output_nid generation:  0.009466409683227539
local_in_edges_tensor generation:  0.009093523025512695
mini_batch_src_global generation:  0.023540973663330078
r_  generation:  0.18508028984069824
local_output_nid generation:  0.009389638900756836
local_in_edges_tensor generation:  0.009472370147705078
mini_batch_src_global generation:  0.022852182388305664
r_  generation:  0.18467140197753906
local_output_nid generation:  0.00942683219909668
local_in_edges_tensor generation:  0.008989334106445312
mini_batch_src_global generation:  0.02335977554321289
r_  generation:  0.18778443336486816
----------------------check_connections_block total spend ----------------------------- 8.54690957069397
generate_one_block  0.24522686004638672
generate_one_block  0.2454679012298584
generate_one_block  0.24695611000061035
generate_one_block  0.2471010684967041
generate_one_block  0.2687346935272217
generate_one_block  0.24561738967895508
generate_one_block  0.25104308128356934
generate_one_block  0.25249314308166504
generate_one_block  0.24641060829162598
generate_one_block  0.2473604679107666
generate_one_block  0.25296473503112793
generate_one_block  0.2513916492462158
generate_one_block  0.2390272617340088
generate_one_block  0.2572615146636963
generate_one_block  0.23778891563415527
generate_one_block  0.24590516090393066
generate_one_block  0.2493579387664795
generate_one_block  0.25537562370300293
generate_one_block  0.2522573471069336
generate_one_block  0.2576737403869629
generate_one_block  0.24942493438720703
generate_one_block  0.2546379566192627
generate_one_block  0.23507022857666016
generate_one_block  0.2563362121582031
generate_one_block  0.25188589096069336
generate_one_block  0.24771332740783691
generate_one_block  0.25361061096191406
generate_one_block  0.23795485496520996
generate_one_block  0.24083638191223145
generate_one_block  0.2505817413330078
generate_one_block  0.24619269371032715
generate_one_block  0.25186800956726074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03692054748535156
gen group dst list time:  0.11237478256225586
time for parepare:  0.020725011825561523
local_output_nid generation:  0.02497243881225586
local_in_edges_tensor generation:  0.052823543548583984
mini_batch_src_global generation:  0.0471646785736084
r_  generation:  0.49094247817993164
local_output_nid generation:  0.030385971069335938
local_in_edges_tensor generation:  0.03639507293701172
mini_batch_src_global generation:  0.0586857795715332
r_  generation:  0.48103785514831543
local_output_nid generation:  0.03084087371826172
local_in_edges_tensor generation:  0.03163456916809082
mini_batch_src_global generation:  0.057984352111816406
r_  generation:  0.49858593940734863
local_output_nid generation:  0.03083944320678711
local_in_edges_tensor generation:  0.03065347671508789
mini_batch_src_global generation:  0.05908679962158203
r_  generation:  0.4906303882598877
local_output_nid generation:  0.031560420989990234
local_in_edges_tensor generation:  0.03086996078491211
mini_batch_src_global generation:  0.05914616584777832
r_  generation:  0.505385160446167
local_output_nid generation:  0.031062841415405273
local_in_edges_tensor generation:  0.03058767318725586
mini_batch_src_global generation:  0.059537410736083984
r_  generation:  0.49320125579833984
local_output_nid generation:  0.03008294105529785
local_in_edges_tensor generation:  0.03059077262878418
mini_batch_src_global generation:  0.058489322662353516
r_  generation:  0.5028514862060547
local_output_nid generation:  0.02951526641845703
local_in_edges_tensor generation:  0.03128480911254883
mini_batch_src_global generation:  0.05993485450744629
r_  generation:  0.4956483840942383
local_output_nid generation:  0.029401779174804688
local_in_edges_tensor generation:  0.030559062957763672
mini_batch_src_global generation:  0.05863022804260254
r_  generation:  0.5017533302307129
local_output_nid generation:  0.02936267852783203
local_in_edges_tensor generation:  0.030546188354492188
mini_batch_src_global generation:  0.059339284896850586
r_  generation:  0.4916343688964844
local_output_nid generation:  0.029374122619628906
local_in_edges_tensor generation:  0.030822038650512695
mini_batch_src_global generation:  0.05861020088195801
r_  generation:  0.5036709308624268
local_output_nid generation:  0.02961564064025879
local_in_edges_tensor generation:  0.03105449676513672
mini_batch_src_global generation:  0.06091594696044922
r_  generation:  0.4943110942840576
local_output_nid generation:  0.02928900718688965
local_in_edges_tensor generation:  0.03039383888244629
mini_batch_src_global generation:  0.058577775955200195
r_  generation:  0.49987316131591797
local_output_nid generation:  0.029745817184448242
local_in_edges_tensor generation:  0.03136801719665527
mini_batch_src_global generation:  0.06009650230407715
r_  generation:  0.5013847351074219
local_output_nid generation:  0.029516935348510742
local_in_edges_tensor generation:  0.03067779541015625
mini_batch_src_global generation:  0.05855917930603027
r_  generation:  0.5039076805114746
local_output_nid generation:  0.029677391052246094
local_in_edges_tensor generation:  0.03127169609069824
mini_batch_src_global generation:  0.06029772758483887
r_  generation:  0.49957966804504395
local_output_nid generation:  0.029516935348510742
local_in_edges_tensor generation:  0.031298160552978516
mini_batch_src_global generation:  0.05879402160644531
r_  generation:  0.506134033203125
local_output_nid generation:  0.029526233673095703
local_in_edges_tensor generation:  0.03128337860107422
mini_batch_src_global generation:  0.05965447425842285
r_  generation:  0.4959683418273926
local_output_nid generation:  0.029757261276245117
local_in_edges_tensor generation:  0.03092479705810547
mini_batch_src_global generation:  0.05914926528930664
r_  generation:  0.4986143112182617
local_output_nid generation:  0.029677629470825195
local_in_edges_tensor generation:  0.03111124038696289
mini_batch_src_global generation:  0.0601959228515625
r_  generation:  0.4943675994873047
local_output_nid generation:  0.02935791015625
local_in_edges_tensor generation:  0.030991077423095703
mini_batch_src_global generation:  0.05839180946350098
r_  generation:  0.5015707015991211
local_output_nid generation:  0.02942824363708496
local_in_edges_tensor generation:  0.03017139434814453
mini_batch_src_global generation:  0.06007719039916992
r_  generation:  0.4956493377685547
local_output_nid generation:  0.030988454818725586
local_in_edges_tensor generation:  0.030492067337036133
mini_batch_src_global generation:  0.057962894439697266
r_  generation:  0.49747776985168457
local_output_nid generation:  0.029684782028198242
local_in_edges_tensor generation:  0.03113865852355957
mini_batch_src_global generation:  0.05922293663024902
r_  generation:  0.49859189987182617
local_output_nid generation:  0.029698848724365234
local_in_edges_tensor generation:  0.030989646911621094
mini_batch_src_global generation:  0.05839681625366211
r_  generation:  0.51007080078125
local_output_nid generation:  0.02957320213317871
local_in_edges_tensor generation:  0.029953479766845703
mini_batch_src_global generation:  0.05907487869262695
r_  generation:  0.5026905536651611
local_output_nid generation:  0.0300595760345459
local_in_edges_tensor generation:  0.031062841415405273
mini_batch_src_global generation:  0.057970285415649414
r_  generation:  0.5054183006286621
local_output_nid generation:  0.029562711715698242
local_in_edges_tensor generation:  0.030855655670166016
mini_batch_src_global generation:  0.05942487716674805
r_  generation:  0.5037393569946289
local_output_nid generation:  0.02983856201171875
local_in_edges_tensor generation:  0.030687332153320312
mini_batch_src_global generation:  0.058007001876831055
r_  generation:  0.5057337284088135
local_output_nid generation:  0.02992868423461914
local_in_edges_tensor generation:  0.030458688735961914
mini_batch_src_global generation:  0.05935859680175781
r_  generation:  0.5029828548431396
local_output_nid generation:  0.029716968536376953
local_in_edges_tensor generation:  0.031007766723632812
mini_batch_src_global generation:  0.058480024337768555
r_  generation:  0.5039832592010498
local_output_nid generation:  0.03004598617553711
local_in_edges_tensor generation:  0.03409099578857422
mini_batch_src_global generation:  0.05947160720825195
r_  generation:  0.5049536228179932
----------------------check_connections_block total spend ----------------------------- 23.32238245010376
generate_one_block  0.6856949329376221
generate_one_block  0.6771395206451416
generate_one_block  0.67405104637146
generate_one_block  0.6716973781585693
generate_one_block  0.767716646194458
generate_one_block  0.67691969871521
generate_one_block  0.6689143180847168
generate_one_block  0.6836702823638916
generate_one_block  0.6711215972900391
generate_one_block  0.6771326065063477
generate_one_block  0.6812119483947754
generate_one_block  0.6854517459869385
generate_one_block  0.6735377311706543
generate_one_block  0.6899240016937256
generate_one_block  0.6745059490203857
generate_one_block  0.6838796138763428
generate_one_block  0.6819751262664795
generate_one_block  0.6772761344909668
generate_one_block  0.6785614490509033
generate_one_block  0.686211109161377
generate_one_block  0.6782889366149902
generate_one_block  0.6785657405853271
generate_one_block  0.6728401184082031
generate_one_block  0.682988166809082
generate_one_block  0.6999545097351074
generate_one_block  0.68058180809021
generate_one_block  0.687375545501709
generate_one_block  0.6759521961212158
generate_one_block  0.6815686225891113
generate_one_block  0.6811110973358154
generate_one_block  0.688673734664917
generate_one_block  0.6850991249084473
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1315317153930664  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

connection checking time:  31.86929202079773
block generation total time  29.831120491027832
average batch blocks generation time:  0.9322225153446198
block dataloader generation time/epoch 65.89916881322861
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10920333862304688  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.607951641082764  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1089634895324707  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.640753746032715  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10925865173339844  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.653464794158936  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10906744003295898  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.66800022125244  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10927438735961914  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.01955795288086  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10905647277832031  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.616899490356445  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10882711410522461  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.67664909362793  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10956716537475586  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.00706434249878  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10892581939697266  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.518001556396484  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10909271240234375  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.665571689605713  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10954475402832031  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.94922685623169  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10951566696166992  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.00880527496338  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1088409423828125  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.287531852722168  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10975170135498047  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.293210983276367  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10894298553466797  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.271431922912598  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10948848724365234  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.78400421142578  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1092844009399414  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.72992706298828  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10928535461425781  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.027221202850342  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10919809341430664  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.919806480407715  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1093902587890625  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.954479694366455  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10898303985595703  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.744215488433838  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.1093754768371582  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.017467498779297  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10901403427124023  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.248578548431396  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10953474044799805  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.18261957168579  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10939455032348633  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.935250282287598  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10915470123291016  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.78035879135132  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10936355590820312  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 21.014562129974365  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10901737213134766  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.389521598815918  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10899829864501953  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.447449684143066  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10898351669311523  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.800707817077637  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10926628112792969  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.635522842407227  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.10965728759765625  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 20.938761234283447  GigaBytes
Max Memory Allocated: 21.669678211212158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03243298828601837 |0.023395076394081116 |0.6347378492355347 |9.882450103759766e-05 |1.1963913291692734 |0.00489497184753418 |
----------------------------------------------------------pseudo_mini_loss sum 1.2337722778320312
Total (block generation + training)time/epoch 125.99296021461487
Training time/epoch 60.46283721923828
Training time without block to device /epoch 59.714194774627686
Training time without total dataloading part /epoch 58.604191064834595
load block tensor time/epoch 1.037855625152588
block to device time/epoch 0.7486424446105957
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  9162035
Number of first layer input nodes during this epoch:  4808955
