Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647797829.5086093
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024592161178588867
range selection method range initialization spend 0.013399362564086914
time for parepare:  0.017682790756225586
local_output_nid generation:  0.0007119178771972656
local_in_edges_tensor generation:  0.003501415252685547
mini_batch_src_global generation:  0.0013265609741210938
r_  generation:  0.008799076080322266
local_output_nid generation:  0.0007264614105224609
local_in_edges_tensor generation:  0.0005600452423095703
mini_batch_src_global generation:  0.0012688636779785156
r_  generation:  0.008061408996582031
local_output_nid generation:  0.0006949901580810547
local_in_edges_tensor generation:  0.00048041343688964844
mini_batch_src_global generation:  0.0007915496826171875
r_  generation:  0.007760047912597656
local_output_nid generation:  0.0007009506225585938
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0007174015045166016
r_  generation:  0.0071222782135009766
local_output_nid generation:  0.0006961822509765625
local_in_edges_tensor generation:  0.0004596710205078125
mini_batch_src_global generation:  0.0007069110870361328
r_  generation:  0.00758814811706543
local_output_nid generation:  0.0007150173187255859
local_in_edges_tensor generation:  0.00046896934509277344
mini_batch_src_global generation:  0.0007488727569580078
r_  generation:  0.0076067447662353516
local_output_nid generation:  0.0006947517395019531
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.0007483959197998047
r_  generation:  0.0077037811279296875
local_output_nid generation:  0.0007030963897705078
local_in_edges_tensor generation:  0.0004630088806152344
mini_batch_src_global generation:  0.0007474422454833984
r_  generation:  0.008011817932128906
local_output_nid generation:  0.0006890296936035156
local_in_edges_tensor generation:  0.000446319580078125
mini_batch_src_global generation:  0.0007677078247070312
r_  generation:  0.0077915191650390625
local_output_nid generation:  0.0006999969482421875
local_in_edges_tensor generation:  0.00045752525329589844
mini_batch_src_global generation:  0.0007846355438232422
r_  generation:  0.007927417755126953
local_output_nid generation:  0.0006856918334960938
local_in_edges_tensor generation:  0.0004563331604003906
mini_batch_src_global generation:  0.0007963180541992188
r_  generation:  0.008141756057739258
local_output_nid generation:  0.0007150173187255859
local_in_edges_tensor generation:  0.0004661083221435547
mini_batch_src_global generation:  0.0007967948913574219
r_  generation:  0.008157730102539062
local_output_nid generation:  0.0007264614105224609
local_in_edges_tensor generation:  0.0004520416259765625
mini_batch_src_global generation:  0.0008141994476318359
r_  generation:  0.008192062377929688
local_output_nid generation:  0.0006973743438720703
local_in_edges_tensor generation:  0.0004565715789794922
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.009241342544555664
local_output_nid generation:  0.0007064342498779297
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0008540153503417969
r_  generation:  0.00837564468383789
local_output_nid generation:  0.000713348388671875
local_in_edges_tensor generation:  0.0004546642303466797
mini_batch_src_global generation:  0.0008399486541748047
r_  generation:  0.007984638214111328
local_output_nid generation:  0.0007250308990478516
local_in_edges_tensor generation:  0.0004570484161376953
mini_batch_src_global generation:  0.0007970333099365234
r_  generation:  0.007856607437133789
local_output_nid generation:  0.00070953369140625
local_in_edges_tensor generation:  0.0004608631134033203
mini_batch_src_global generation:  0.0008153915405273438
r_  generation:  0.008209466934204102
local_output_nid generation:  0.0007128715515136719
local_in_edges_tensor generation:  0.0004584789276123047
mini_batch_src_global generation:  0.0008032321929931641
r_  generation:  0.00799250602722168
local_output_nid generation:  0.0007054805755615234
local_in_edges_tensor generation:  0.0004563331604003906
mini_batch_src_global generation:  0.0008218288421630859
r_  generation:  0.007976055145263672
local_output_nid generation:  0.0006973743438720703
local_in_edges_tensor generation:  0.00045228004455566406
mini_batch_src_global generation:  0.0007944107055664062
r_  generation:  0.008194684982299805
local_output_nid generation:  0.0006978511810302734
local_in_edges_tensor generation:  0.00045871734619140625
mini_batch_src_global generation:  0.0008091926574707031
r_  generation:  0.008208274841308594
local_output_nid generation:  0.0006921291351318359
local_in_edges_tensor generation:  0.00045299530029296875
mini_batch_src_global generation:  0.0007843971252441406
r_  generation:  0.007932424545288086
local_output_nid generation:  0.0007026195526123047
local_in_edges_tensor generation:  0.0004646778106689453
mini_batch_src_global generation:  0.0007662773132324219
r_  generation:  0.007937192916870117
local_output_nid generation:  0.0007078647613525391
local_in_edges_tensor generation:  0.0004496574401855469
mini_batch_src_global generation:  0.0008058547973632812
r_  generation:  0.00818634033203125
local_output_nid generation:  0.0006957054138183594
local_in_edges_tensor generation:  0.00044655799865722656
mini_batch_src_global generation:  0.0008127689361572266
r_  generation:  0.008198738098144531
local_output_nid generation:  0.0006918907165527344
local_in_edges_tensor generation:  0.00046253204345703125
mini_batch_src_global generation:  0.0008254051208496094
r_  generation:  0.007993698120117188
local_output_nid generation:  0.0006954669952392578
local_in_edges_tensor generation:  0.0004546642303466797
mini_batch_src_global generation:  0.0008068084716796875
r_  generation:  0.008074760437011719
local_output_nid generation:  0.0007004737854003906
local_in_edges_tensor generation:  0.0004513263702392578
mini_batch_src_global generation:  0.0008008480072021484
r_  generation:  0.00812840461730957
local_output_nid generation:  0.0007061958312988281
local_in_edges_tensor generation:  0.003949403762817383
mini_batch_src_global generation:  0.0009601116180419922
r_  generation:  0.00803518295288086
local_output_nid generation:  0.0007500648498535156
local_in_edges_tensor generation:  0.00047469139099121094
mini_batch_src_global generation:  0.0008623600006103516
r_  generation:  0.007929325103759766
local_output_nid generation:  0.0007302761077880859
local_in_edges_tensor generation:  0.0004589557647705078
mini_batch_src_global generation:  0.0008666515350341797
r_  generation:  0.008362054824829102
----------------------check_connections_block total spend ----------------------------- 0.41025876998901367
generate_one_block  0.01384282112121582
generate_one_block  0.013345956802368164
generate_one_block  0.013043642044067383
generate_one_block  0.012376546859741211
generate_one_block  0.012970924377441406
generate_one_block  0.012837886810302734
generate_one_block  0.012897491455078125
generate_one_block  0.013206720352172852
generate_one_block  0.012854814529418945
generate_one_block  0.013275384902954102
generate_one_block  0.013173580169677734
generate_one_block  0.013320207595825195
generate_one_block  0.013217926025390625
generate_one_block  0.013603448867797852
generate_one_block  0.013468265533447266
generate_one_block  0.012944459915161133
generate_one_block  0.01274871826171875
generate_one_block  0.0133056640625
generate_one_block  0.012863397598266602
generate_one_block  0.012928485870361328
generate_one_block  0.013054132461547852
generate_one_block  0.013229608535766602
generate_one_block  0.012775659561157227
generate_one_block  0.012612342834472656
generate_one_block  0.013076066970825195
generate_one_block  0.013011693954467773
generate_one_block  0.013130664825439453
generate_one_block  0.013134479522705078
generate_one_block  0.01300358772277832
generate_one_block  0.012816190719604492
generate_one_block  0.012959957122802734
generate_one_block  0.013286113739013672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04188132286071777
gen group dst list time:  0.021739959716796875
time for parepare:  0.018723249435424805
local_output_nid generation:  0.003795146942138672
local_in_edges_tensor generation:  0.012323617935180664
mini_batch_src_global generation:  0.011388301849365234
r_  generation:  0.11688637733459473
local_output_nid generation:  0.006397724151611328
local_in_edges_tensor generation:  0.0071642398834228516
mini_batch_src_global generation:  0.014416694641113281
r_  generation:  0.12154412269592285
local_output_nid generation:  0.0065460205078125
local_in_edges_tensor generation:  0.006990909576416016
mini_batch_src_global generation:  0.013307571411132812
r_  generation:  0.12216544151306152
local_output_nid generation:  0.00616145133972168
local_in_edges_tensor generation:  0.008008480072021484
mini_batch_src_global generation:  0.013375520706176758
r_  generation:  0.11814475059509277
local_output_nid generation:  0.006244182586669922
local_in_edges_tensor generation:  0.009182453155517578
mini_batch_src_global generation:  0.014243125915527344
r_  generation:  0.12888073921203613
local_output_nid generation:  0.00635218620300293
local_in_edges_tensor generation:  0.00730443000793457
mini_batch_src_global generation:  0.015001773834228516
r_  generation:  0.12612223625183105
local_output_nid generation:  0.006452322006225586
local_in_edges_tensor generation:  0.007677793502807617
mini_batch_src_global generation:  0.014796018600463867
r_  generation:  0.12880897521972656
local_output_nid generation:  0.006735086441040039
local_in_edges_tensor generation:  0.010933876037597656
mini_batch_src_global generation:  0.015826940536499023
r_  generation:  0.1369783878326416
local_output_nid generation:  0.0065729618072509766
local_in_edges_tensor generation:  0.008611679077148438
mini_batch_src_global generation:  0.015400886535644531
r_  generation:  0.1294078826904297
local_output_nid generation:  0.006788969039916992
local_in_edges_tensor generation:  0.008644342422485352
mini_batch_src_global generation:  0.015203475952148438
r_  generation:  0.13025283813476562
local_output_nid generation:  0.006745815277099609
local_in_edges_tensor generation:  0.009001970291137695
mini_batch_src_global generation:  0.016738414764404297
r_  generation:  0.13264751434326172
local_output_nid generation:  0.00687861442565918
local_in_edges_tensor generation:  0.007902860641479492
mini_batch_src_global generation:  0.01687026023864746
r_  generation:  0.13449978828430176
local_output_nid generation:  0.006823539733886719
local_in_edges_tensor generation:  0.00774383544921875
mini_batch_src_global generation:  0.01596856117248535
r_  generation:  0.1312882900238037
local_output_nid generation:  0.007033109664916992
local_in_edges_tensor generation:  0.00980067253112793
mini_batch_src_global generation:  0.01645207405090332
r_  generation:  0.1367807388305664
local_output_nid generation:  0.0070362091064453125
local_in_edges_tensor generation:  0.008055686950683594
mini_batch_src_global generation:  0.0162808895111084
r_  generation:  0.13905644416809082
local_output_nid generation:  0.006788969039916992
local_in_edges_tensor generation:  0.007992029190063477
mini_batch_src_global generation:  0.01569366455078125
r_  generation:  0.13097357749938965
local_output_nid generation:  0.006694316864013672
local_in_edges_tensor generation:  0.007652997970581055
mini_batch_src_global generation:  0.015920639038085938
r_  generation:  0.12609386444091797
local_output_nid generation:  0.006989479064941406
local_in_edges_tensor generation:  0.007861614227294922
mini_batch_src_global generation:  0.017031192779541016
r_  generation:  0.13696575164794922
local_output_nid generation:  0.006922245025634766
local_in_edges_tensor generation:  0.010040760040283203
mini_batch_src_global generation:  0.015708208084106445
r_  generation:  0.13094377517700195
local_output_nid generation:  0.006871700286865234
local_in_edges_tensor generation:  0.007934093475341797
mini_batch_src_global generation:  0.015779733657836914
r_  generation:  0.13011455535888672
local_output_nid generation:  0.006955146789550781
local_in_edges_tensor generation:  0.007905721664428711
mini_batch_src_global generation:  0.01615619659423828
r_  generation:  0.1349775791168213
local_output_nid generation:  0.006972074508666992
local_in_edges_tensor generation:  0.009085893630981445
mini_batch_src_global generation:  0.017078399658203125
r_  generation:  0.13959074020385742
local_output_nid generation:  0.0068187713623046875
local_in_edges_tensor generation:  0.008025169372558594
mini_batch_src_global generation:  0.015578508377075195
r_  generation:  0.12808465957641602
local_output_nid generation:  0.006724834442138672
local_in_edges_tensor generation:  0.007796049118041992
mini_batch_src_global generation:  0.014955997467041016
r_  generation:  0.1284952163696289
local_output_nid generation:  0.0069310665130615234
local_in_edges_tensor generation:  0.008932113647460938
mini_batch_src_global generation:  0.016649723052978516
r_  generation:  0.13363242149353027
local_output_nid generation:  0.006888866424560547
local_in_edges_tensor generation:  0.007867813110351562
mini_batch_src_global generation:  0.01600480079650879
r_  generation:  0.13532710075378418
local_output_nid generation:  0.006901741027832031
local_in_edges_tensor generation:  0.008701801300048828
mini_batch_src_global generation:  0.016134023666381836
r_  generation:  0.13356781005859375
local_output_nid generation:  0.007002830505371094
local_in_edges_tensor generation:  0.007967710494995117
mini_batch_src_global generation:  0.016292572021484375
r_  generation:  0.13605356216430664
local_output_nid generation:  0.006985902786254883
local_in_edges_tensor generation:  0.00797128677368164
mini_batch_src_global generation:  0.01575446128845215
r_  generation:  0.1348419189453125
local_output_nid generation:  0.006753444671630859
local_in_edges_tensor generation:  0.007666349411010742
mini_batch_src_global generation:  0.015377521514892578
r_  generation:  0.13009119033813477
local_output_nid generation:  0.006864070892333984
local_in_edges_tensor generation:  0.00767827033996582
mini_batch_src_global generation:  0.015670061111450195
r_  generation:  0.13174819946289062
local_output_nid generation:  0.007063865661621094
local_in_edges_tensor generation:  0.008736848831176758
mini_batch_src_global generation:  0.017363786697387695
r_  generation:  0.13643693923950195
----------------------check_connections_block total spend ----------------------------- 6.187967538833618
generate_one_block  0.17254328727722168
generate_one_block  0.16186213493347168
generate_one_block  0.1808481216430664
generate_one_block  0.15440917015075684
generate_one_block  0.16363024711608887
generate_one_block  0.1613941192626953
generate_one_block  0.16435599327087402
generate_one_block  0.16790008544921875
generate_one_block  0.1680006980895996
generate_one_block  0.16620850563049316
generate_one_block  0.16989517211914062
generate_one_block  0.17257905006408691
generate_one_block  0.16826510429382324
generate_one_block  0.17356491088867188
generate_one_block  0.17809510231018066
generate_one_block  0.194990873336792
generate_one_block  0.16395998001098633
generate_one_block  0.1705002784729004
generate_one_block  0.16496920585632324
generate_one_block  0.16042280197143555
generate_one_block  0.16802692413330078
generate_one_block  0.17310786247253418
generate_one_block  0.15925312042236328
generate_one_block  0.15612459182739258
generate_one_block  0.16708636283874512
generate_one_block  0.16516327857971191
generate_one_block  0.16876530647277832
generate_one_block  0.16773366928100586
generate_one_block  0.16602659225463867
generate_one_block  0.1610856056213379
generate_one_block  0.16280245780944824
generate_one_block  0.17219114303588867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05575990676879883
gen group dst list time:  0.11037993431091309
time for parepare:  0.018941164016723633
local_output_nid generation:  0.0198822021484375
local_in_edges_tensor generation:  0.047016143798828125
mini_batch_src_global generation:  0.03665947914123535
r_  generation:  0.40892767906188965
local_output_nid generation:  0.02668595314025879
local_in_edges_tensor generation:  0.0404052734375
mini_batch_src_global generation:  0.04554009437561035
r_  generation:  0.3836092948913574
local_output_nid generation:  0.02707839012145996
local_in_edges_tensor generation:  0.03799629211425781
mini_batch_src_global generation:  0.0538785457611084
r_  generation:  0.3930397033691406
local_output_nid generation:  0.026205778121948242
local_in_edges_tensor generation:  0.03312230110168457
mini_batch_src_global generation:  0.04596281051635742
r_  generation:  0.3988838195800781
local_output_nid generation:  0.025437116622924805
local_in_edges_tensor generation:  0.03888392448425293
mini_batch_src_global generation:  0.04876875877380371
r_  generation:  0.39947986602783203
local_output_nid generation:  0.027380704879760742
local_in_edges_tensor generation:  0.035584449768066406
mini_batch_src_global generation:  0.047667741775512695
r_  generation:  0.3923017978668213
local_output_nid generation:  0.026071786880493164
local_in_edges_tensor generation:  0.027283668518066406
mini_batch_src_global generation:  0.046524763107299805
r_  generation:  0.39619898796081543
local_output_nid generation:  0.026561260223388672
local_in_edges_tensor generation:  0.03469371795654297
mini_batch_src_global generation:  0.05322575569152832
r_  generation:  0.4147460460662842
local_output_nid generation:  0.026442527770996094
local_in_edges_tensor generation:  0.030687808990478516
mini_batch_src_global generation:  0.047209978103637695
r_  generation:  0.3993709087371826
local_output_nid generation:  0.026058435440063477
local_in_edges_tensor generation:  0.027545928955078125
mini_batch_src_global generation:  0.048439741134643555
r_  generation:  0.3939697742462158
local_output_nid generation:  0.02623128890991211
local_in_edges_tensor generation:  0.03520035743713379
mini_batch_src_global generation:  0.04621624946594238
r_  generation:  0.4002268314361572
local_output_nid generation:  0.026777029037475586
local_in_edges_tensor generation:  0.03567075729370117
mini_batch_src_global generation:  0.050173044204711914
r_  generation:  0.39961862564086914
local_output_nid generation:  0.02637648582458496
local_in_edges_tensor generation:  0.027603626251220703
mini_batch_src_global generation:  0.04694533348083496
r_  generation:  0.39911627769470215
local_output_nid generation:  0.026962995529174805
local_in_edges_tensor generation:  0.03118753433227539
mini_batch_src_global generation:  0.055410146713256836
r_  generation:  0.4044818878173828
local_output_nid generation:  0.0269927978515625
local_in_edges_tensor generation:  0.03417634963989258
mini_batch_src_global generation:  0.04771828651428223
r_  generation:  0.400315523147583
local_output_nid generation:  0.026455163955688477
local_in_edges_tensor generation:  0.027616262435913086
mini_batch_src_global generation:  0.047826528549194336
r_  generation:  0.3992147445678711
local_output_nid generation:  0.02660822868347168
local_in_edges_tensor generation:  0.028714656829833984
mini_batch_src_global generation:  0.04638838768005371
r_  generation:  0.394695520401001
local_output_nid generation:  0.02716231346130371
local_in_edges_tensor generation:  0.039472341537475586
mini_batch_src_global generation:  0.05009150505065918
r_  generation:  0.40270185470581055
local_output_nid generation:  0.026421070098876953
local_in_edges_tensor generation:  0.030991792678833008
mini_batch_src_global generation:  0.047267913818359375
r_  generation:  0.40044307708740234
local_output_nid generation:  0.026850223541259766
local_in_edges_tensor generation:  0.04371762275695801
mini_batch_src_global generation:  0.04725909233093262
r_  generation:  0.3937690258026123
local_output_nid generation:  0.027008533477783203
local_in_edges_tensor generation:  0.02826714515686035
mini_batch_src_global generation:  0.0492095947265625
r_  generation:  0.40041637420654297
local_output_nid generation:  0.02686452865600586
local_in_edges_tensor generation:  0.0320429801940918
mini_batch_src_global generation:  0.046883344650268555
r_  generation:  0.3982243537902832
local_output_nid generation:  0.026539325714111328
local_in_edges_tensor generation:  0.023827075958251953
mini_batch_src_global generation:  0.04694485664367676
r_  generation:  0.39581799507141113
local_output_nid generation:  0.0265810489654541
local_in_edges_tensor generation:  0.02432537078857422
mini_batch_src_global generation:  0.04671335220336914
r_  generation:  0.3962094783782959
local_output_nid generation:  0.027573823928833008
local_in_edges_tensor generation:  0.03198552131652832
mini_batch_src_global generation:  0.049222707748413086
r_  generation:  0.39778566360473633
local_output_nid generation:  0.02670431137084961
local_in_edges_tensor generation:  0.031093597412109375
mini_batch_src_global generation:  0.04663896560668945
r_  generation:  0.3961772918701172
local_output_nid generation:  0.02662181854248047
local_in_edges_tensor generation:  0.024564266204833984
mini_batch_src_global generation:  0.04756951332092285
r_  generation:  0.39998698234558105
local_output_nid generation:  0.0268862247467041
local_in_edges_tensor generation:  0.02826070785522461
mini_batch_src_global generation:  0.04994487762451172
r_  generation:  0.40279388427734375
local_output_nid generation:  0.026970386505126953
local_in_edges_tensor generation:  0.032587528228759766
mini_batch_src_global generation:  0.04663276672363281
r_  generation:  0.40012478828430176
local_output_nid generation:  0.026687145233154297
local_in_edges_tensor generation:  0.024179458618164062
mini_batch_src_global generation:  0.0471799373626709
r_  generation:  0.3947751522064209
local_output_nid generation:  0.026449203491210938
local_in_edges_tensor generation:  0.024648666381835938
mini_batch_src_global generation:  0.047890424728393555
r_  generation:  0.3962674140930176
local_output_nid generation:  0.027027130126953125
local_in_edges_tensor generation:  0.03549695014953613
mini_batch_src_global generation:  0.05029940605163574
r_  generation:  0.3996007442474365
----------------------check_connections_block total spend ----------------------------- 18.982847452163696
generate_one_block  0.6109163761138916
generate_one_block  0.5083754062652588
generate_one_block  0.527857780456543
generate_one_block  0.5002679824829102
generate_one_block  0.5157368183135986
generate_one_block  0.516594409942627
generate_one_block  0.5049667358398438
generate_one_block  0.5229666233062744
generate_one_block  0.518099308013916
generate_one_block  0.5082597732543945
generate_one_block  0.5148835182189941
generate_one_block  0.5296452045440674
generate_one_block  0.5033113956451416
generate_one_block  0.5185585021972656
generate_one_block  0.5297627449035645
generate_one_block  0.5031759738922119
generate_one_block  0.5019807815551758
generate_one_block  0.5191788673400879
generate_one_block  0.506037712097168
generate_one_block  0.5013234615325928
generate_one_block  0.524860143661499
generate_one_block  0.5262570381164551
generate_one_block  0.4985487461090088
generate_one_block  0.497800350189209
generate_one_block  0.5135676860809326
generate_one_block  0.5097637176513672
generate_one_block  0.5762393474578857
generate_one_block  0.5274245738983154
generate_one_block  0.5162856578826904
generate_one_block  0.5002491474151611
generate_one_block  0.5021834373474121
generate_one_block  0.5484578609466553
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  25.170814990997314
block generation total time  21.969298839569092
average batch blocks generation time:  0.6865405887365341
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08687829971313477  GigaBytes
Max Memory Allocated: 0.08687829971313477  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6658935546875 GB
    Memory Allocated: 15.877890586853027  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4158935546875 GB
    Memory Allocated: 0.09258604049682617  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4608154296875 GB
    Memory Allocated: 15.618846893310547  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4627685546875 GB
    Memory Allocated: 0.09453153610229492  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 15.733570575714111  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 0.09197664260864258  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 15.163708209991455  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 0.09353923797607422  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 15.711649894714355  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 0.09277057647705078  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 15.631847381591797  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 0.09242630004882812  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 15.562280178070068  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 0.09399080276489258  GigaBytes
Max Memory Allocated: 15.908472061157227  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 15.889318943023682  GigaBytes
Max Memory Allocated: 15.920759201049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 0.09242916107177734  GigaBytes
Max Memory Allocated: 15.920759201049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 15.681373119354248  GigaBytes
Max Memory Allocated: 15.920759201049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0623779296875 GB
    Memory Allocated: 0.09253406524658203  GigaBytes
Max Memory Allocated: 15.920759201049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1385498046875 GB
    Memory Allocated: 15.611536026000977  GigaBytes
Max Memory Allocated: 15.920759201049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1385498046875 GB
    Memory Allocated: 0.09350776672363281  GigaBytes
Max Memory Allocated: 15.920759201049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1385498046875 GB
    Memory Allocated: 15.844238758087158  GigaBytes
Max Memory Allocated: 15.920759201049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1385498046875 GB
    Memory Allocated: 0.09373092651367188  GigaBytes
Max Memory Allocated: 15.920759201049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 16.01112651824951  GigaBytes
Max Memory Allocated: 16.042391300201416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.09342288970947266  GigaBytes
Max Memory Allocated: 16.042391300201416  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 15.793354988098145  GigaBytes
Max Memory Allocated: 16.042391300201416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.09400224685668945  GigaBytes
Max Memory Allocated: 16.042391300201416  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 16.106363773345947  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.09461259841918945  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 16.065420627593994  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.09259653091430664  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 15.720576286315918  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.09338855743408203  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 15.45362138748169  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.09376239776611328  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 16.008565425872803  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.09242677688598633  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 15.713822841644287  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.09259176254272461  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 15.544121265411377  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.0924835205078125  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 15.726034164428711  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.0937185287475586  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 16.027552127838135  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.0921778678894043  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 15.386574745178223  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.0920877456665039  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 15.314151763916016  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.0935525894165039  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 15.73315954208374  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7420654296875 GB
    Memory Allocated: 0.09222555160522461  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7694091796875 GB
    Memory Allocated: 15.560277462005615  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.09345245361328125  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.580170631408691  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.09373903274536133  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.834012508392334  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.09351634979248047  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.621099472045898  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.09224605560302734  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.376865863800049  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.0923757553100586  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.502987384796143  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.09363269805908203  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.95637559890747  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032086752355098724 |0.02526121586561203 |0.2847048118710518 |9.939074516296387e-05 |0.45270588994026184 |0.007704734802246094 |
----------------------------------------------------------pseudo_mini_loss sum 5.372616767883301
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8578417
Number of first layer input nodes during this epoch:  4654392
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1217036247253418  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02826070785522461
range selection method range initialization spend 0.018014192581176758
time for parepare:  0.019436359405517578
local_output_nid generation:  0.0009515285491943359
local_in_edges_tensor generation:  0.013640165328979492
mini_batch_src_global generation:  0.0017619132995605469
r_  generation:  0.008929967880249023
local_output_nid generation:  0.001039743423461914
local_in_edges_tensor generation:  0.00107574462890625
mini_batch_src_global generation:  0.0014603137969970703
r_  generation:  0.00891566276550293
local_output_nid generation:  0.0009849071502685547
local_in_edges_tensor generation:  0.0008471012115478516
mini_batch_src_global generation:  0.0009582042694091797
r_  generation:  0.007965326309204102
local_output_nid generation:  0.0009207725524902344
local_in_edges_tensor generation:  0.0005710124969482422
mini_batch_src_global generation:  0.0008935928344726562
r_  generation:  0.007925271987915039
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0007722377777099609
mini_batch_src_global generation:  0.0008790493011474609
r_  generation:  0.007690906524658203
local_output_nid generation:  0.0008580684661865234
local_in_edges_tensor generation:  0.0009703636169433594
mini_batch_src_global generation:  0.0009610652923583984
r_  generation:  0.008461952209472656
local_output_nid generation:  0.0008361339569091797
local_in_edges_tensor generation:  0.0005352497100830078
mini_batch_src_global generation:  0.0008726119995117188
r_  generation:  0.00809025764465332
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0008397102355957031
mini_batch_src_global generation:  0.0010457038879394531
r_  generation:  0.008035898208618164
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0005066394805908203
mini_batch_src_global generation:  0.0008695125579833984
r_  generation:  0.008071422576904297
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0005202293395996094
mini_batch_src_global generation:  0.0008952617645263672
r_  generation:  0.008460760116577148
local_output_nid generation:  0.0009253025054931641
local_in_edges_tensor generation:  0.00075531005859375
mini_batch_src_global generation:  0.0009391307830810547
r_  generation:  0.009903669357299805
local_output_nid generation:  0.0009059906005859375
local_in_edges_tensor generation:  0.0005173683166503906
mini_batch_src_global generation:  0.0009348392486572266
r_  generation:  0.00830388069152832
local_output_nid generation:  0.0008864402770996094
local_in_edges_tensor generation:  0.0005171298980712891
mini_batch_src_global generation:  0.0009264945983886719
r_  generation:  0.008432388305664062
local_output_nid generation:  0.0008552074432373047
local_in_edges_tensor generation:  0.0005168914794921875
mini_batch_src_global generation:  0.00093841552734375
r_  generation:  0.008243083953857422
local_output_nid generation:  0.0008547306060791016
local_in_edges_tensor generation:  0.0004992485046386719
mini_batch_src_global generation:  0.0008828639984130859
r_  generation:  0.008250951766967773
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.0005156993865966797
mini_batch_src_global generation:  0.0009002685546875
r_  generation:  0.00802469253540039
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0004906654357910156
mini_batch_src_global generation:  0.0008795261383056641
r_  generation:  0.008114337921142578
local_output_nid generation:  0.0008435249328613281
local_in_edges_tensor generation:  0.0006692409515380859
mini_batch_src_global generation:  0.0008728504180908203
r_  generation:  0.007938623428344727
local_output_nid generation:  0.0008406639099121094
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0008594989776611328
r_  generation:  0.008270025253295898
local_output_nid generation:  0.0008559226989746094
local_in_edges_tensor generation:  0.0004839897155761719
mini_batch_src_global generation:  0.0008652210235595703
r_  generation:  0.00815582275390625
local_output_nid generation:  0.0008323192596435547
local_in_edges_tensor generation:  0.0004894733428955078
mini_batch_src_global generation:  0.0008754730224609375
r_  generation:  0.008284568786621094
local_output_nid generation:  0.0008559226989746094
local_in_edges_tensor generation:  0.0004749298095703125
mini_batch_src_global generation:  0.0008633136749267578
r_  generation:  0.008143901824951172
local_output_nid generation:  0.0008194446563720703
local_in_edges_tensor generation:  0.0005049705505371094
mini_batch_src_global generation:  0.0008828639984130859
r_  generation:  0.008363962173461914
local_output_nid generation:  0.000812530517578125
local_in_edges_tensor generation:  0.0007889270782470703
mini_batch_src_global generation:  0.0009062290191650391
r_  generation:  0.008454084396362305
local_output_nid generation:  0.0008311271667480469
local_in_edges_tensor generation:  0.0005450248718261719
mini_batch_src_global generation:  0.0008985996246337891
r_  generation:  0.008232831954956055
local_output_nid generation:  0.0008320808410644531
local_in_edges_tensor generation:  0.0005609989166259766
mini_batch_src_global generation:  0.0008845329284667969
r_  generation:  0.008211612701416016
local_output_nid generation:  0.0008089542388916016
local_in_edges_tensor generation:  0.0005586147308349609
mini_batch_src_global generation:  0.0008957386016845703
r_  generation:  0.008223772048950195
local_output_nid generation:  0.0008242130279541016
local_in_edges_tensor generation:  0.0005509853363037109
mini_batch_src_global generation:  0.0008783340454101562
r_  generation:  0.008259296417236328
local_output_nid generation:  0.0008051395416259766
local_in_edges_tensor generation:  0.0006544589996337891
mini_batch_src_global generation:  0.0008802413940429688
r_  generation:  0.008281230926513672
local_output_nid generation:  0.0008041858673095703
local_in_edges_tensor generation:  0.0005028247833251953
mini_batch_src_global generation:  0.0008711814880371094
r_  generation:  0.008121013641357422
local_output_nid generation:  0.0008225440979003906
local_in_edges_tensor generation:  0.000507354736328125
mini_batch_src_global generation:  0.0008974075317382812
r_  generation:  0.008333683013916016
local_output_nid generation:  0.0008170604705810547
local_in_edges_tensor generation:  0.0007417201995849609
mini_batch_src_global generation:  0.0009052753448486328
r_  generation:  0.008456707000732422
----------------------check_connections_block total spend ----------------------------- 0.4471569061279297
generate_one_block  0.021316051483154297
generate_one_block  0.01747441291809082
generate_one_block  0.014917373657226562
generate_one_block  0.01733112335205078
generate_one_block  0.014342308044433594
generate_one_block  0.015398740768432617
generate_one_block  0.014850139617919922
generate_one_block  0.01478433609008789
generate_one_block  0.014690637588500977
generate_one_block  0.015141010284423828
generate_one_block  0.015342950820922852
generate_one_block  0.015010356903076172
generate_one_block  0.014902353286743164
generate_one_block  0.014662027359008789
generate_one_block  0.014497995376586914
generate_one_block  0.014348983764648438
generate_one_block  0.014551162719726562
generate_one_block  0.014431238174438477
generate_one_block  0.014923810958862305
generate_one_block  0.014605045318603516
generate_one_block  0.014822006225585938
generate_one_block  0.014333724975585938
generate_one_block  0.015167474746704102
generate_one_block  0.015117645263671875
generate_one_block  0.014663219451904297
generate_one_block  0.014822006225585938
generate_one_block  0.01470637321472168
generate_one_block  0.0145111083984375
generate_one_block  0.014649391174316406
generate_one_block  0.014316082000732422
generate_one_block  0.014825105667114258
generate_one_block  0.014909505844116211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05002903938293457
gen group dst list time:  0.021733760833740234
time for parepare:  0.019512414932250977
local_output_nid generation:  0.00493621826171875
local_in_edges_tensor generation:  0.020340442657470703
mini_batch_src_global generation:  0.011982202529907227
r_  generation:  0.11692929267883301
local_output_nid generation:  0.00738978385925293
local_in_edges_tensor generation:  0.008741378784179688
mini_batch_src_global generation:  0.014904499053955078
r_  generation:  0.12433362007141113
local_output_nid generation:  0.007245540618896484
local_in_edges_tensor generation:  0.025418996810913086
mini_batch_src_global generation:  0.013317346572875977
r_  generation:  0.12539887428283691
local_output_nid generation:  0.0073206424713134766
local_in_edges_tensor generation:  0.008101940155029297
mini_batch_src_global generation:  0.014181852340698242
r_  generation:  0.12875747680664062
local_output_nid generation:  0.0076677799224853516
local_in_edges_tensor generation:  0.009261369705200195
mini_batch_src_global generation:  0.014483928680419922
r_  generation:  0.12867951393127441
local_output_nid generation:  0.008217096328735352
local_in_edges_tensor generation:  0.009880304336547852
mini_batch_src_global generation:  0.015942096710205078
r_  generation:  0.13680768013000488
local_output_nid generation:  0.008148670196533203
local_in_edges_tensor generation:  0.007588624954223633
mini_batch_src_global generation:  0.015578031539916992
r_  generation:  0.13190603256225586
local_output_nid generation:  0.008365869522094727
local_in_edges_tensor generation:  0.009522199630737305
mini_batch_src_global generation:  0.015768051147460938
r_  generation:  0.13322091102600098
local_output_nid generation:  0.008111953735351562
local_in_edges_tensor generation:  0.007676124572753906
mini_batch_src_global generation:  0.015969038009643555
r_  generation:  0.13249659538269043
local_output_nid generation:  0.008393287658691406
local_in_edges_tensor generation:  0.01112675666809082
mini_batch_src_global generation:  0.016376018524169922
r_  generation:  0.13812470436096191
local_output_nid generation:  0.008589982986450195
local_in_edges_tensor generation:  0.008130311965942383
mini_batch_src_global generation:  0.016590356826782227
r_  generation:  0.1392507553100586
local_output_nid generation:  0.008645296096801758
local_in_edges_tensor generation:  0.007771730422973633
mini_batch_src_global generation:  0.01626133918762207
r_  generation:  0.1355571746826172
local_output_nid generation:  0.008668184280395508
local_in_edges_tensor generation:  0.007919549942016602
mini_batch_src_global generation:  0.02015829086303711
r_  generation:  0.13869571685791016
local_output_nid generation:  0.008436203002929688
local_in_edges_tensor generation:  0.007812738418579102
mini_batch_src_global generation:  0.01572418212890625
r_  generation:  0.13233661651611328
local_output_nid generation:  0.008458852767944336
local_in_edges_tensor generation:  0.009074926376342773
mini_batch_src_global generation:  0.015796184539794922
r_  generation:  0.13397860527038574
local_output_nid generation:  0.008471965789794922
local_in_edges_tensor generation:  0.00994873046875
mini_batch_src_global generation:  0.015902996063232422
r_  generation:  0.13488245010375977
local_output_nid generation:  0.008770465850830078
local_in_edges_tensor generation:  0.007906913757324219
mini_batch_src_global generation:  0.01595902442932129
r_  generation:  0.13530397415161133
local_output_nid generation:  0.008536338806152344
local_in_edges_tensor generation:  0.008486509323120117
mini_batch_src_global generation:  0.016664743423461914
r_  generation:  0.13437342643737793
local_output_nid generation:  0.008713006973266602
local_in_edges_tensor generation:  0.011115074157714844
mini_batch_src_global generation:  0.016387939453125
r_  generation:  0.1351790428161621
local_output_nid generation:  0.008566141128540039
local_in_edges_tensor generation:  0.007824182510375977
mini_batch_src_global generation:  0.016126394271850586
r_  generation:  0.1341383457183838
local_output_nid generation:  0.008426904678344727
local_in_edges_tensor generation:  0.009090662002563477
mini_batch_src_global generation:  0.016088247299194336
r_  generation:  0.1344890594482422
local_output_nid generation:  0.008168697357177734
local_in_edges_tensor generation:  0.008940458297729492
mini_batch_src_global generation:  0.01597738265991211
r_  generation:  0.1347506046295166
local_output_nid generation:  0.008547782897949219
local_in_edges_tensor generation:  0.010499715805053711
mini_batch_src_global generation:  0.01628398895263672
r_  generation:  0.1370677947998047
local_output_nid generation:  0.008406877517700195
local_in_edges_tensor generation:  0.009015321731567383
mini_batch_src_global generation:  0.016907453536987305
r_  generation:  0.1376323699951172
local_output_nid generation:  0.008302450180053711
local_in_edges_tensor generation:  0.01004171371459961
mini_batch_src_global generation:  0.016106367111206055
r_  generation:  0.13905024528503418
local_output_nid generation:  0.008437871932983398
local_in_edges_tensor generation:  0.009071826934814453
mini_batch_src_global generation:  0.016187191009521484
r_  generation:  0.13557052612304688
local_output_nid generation:  0.008389472961425781
local_in_edges_tensor generation:  0.009243965148925781
mini_batch_src_global generation:  0.017269134521484375
r_  generation:  0.13867545127868652
local_output_nid generation:  0.008209466934204102
local_in_edges_tensor generation:  0.007960796356201172
mini_batch_src_global generation:  0.01945185661315918
r_  generation:  0.13457345962524414
local_output_nid generation:  0.008348226547241211
local_in_edges_tensor generation:  0.009838342666625977
mini_batch_src_global generation:  0.018649816513061523
r_  generation:  0.13531756401062012
local_output_nid generation:  0.008254051208496094
local_in_edges_tensor generation:  0.007936716079711914
mini_batch_src_global generation:  0.015995025634765625
r_  generation:  0.13490056991577148
local_output_nid generation:  0.008438825607299805
local_in_edges_tensor generation:  0.010347604751586914
mini_batch_src_global generation:  0.01597285270690918
r_  generation:  0.13843989372253418
local_output_nid generation:  0.008448123931884766
local_in_edges_tensor generation:  0.009066343307495117
mini_batch_src_global generation:  0.016599655151367188
r_  generation:  0.13854002952575684
----------------------check_connections_block total spend ----------------------------- 6.419945478439331
generate_one_block  0.17766118049621582
generate_one_block  0.1730666160583496
generate_one_block  0.17085933685302734
generate_one_block  0.1718456745147705
generate_one_block  0.18145084381103516
generate_one_block  0.17955660820007324
generate_one_block  0.18139123916625977
generate_one_block  0.17217350006103516
generate_one_block  0.17200565338134766
generate_one_block  0.18622851371765137
generate_one_block  0.1792738437652588
generate_one_block  0.17956233024597168
generate_one_block  0.17792201042175293
generate_one_block  0.16983485221862793
generate_one_block  0.17025208473205566
generate_one_block  0.17242908477783203
generate_one_block  0.1708359718322754
generate_one_block  0.17098021507263184
generate_one_block  0.1728532314300537
generate_one_block  0.20226168632507324
generate_one_block  0.17227721214294434
generate_one_block  0.17187714576721191
generate_one_block  0.17663073539733887
generate_one_block  0.18018245697021484
generate_one_block  0.17421579360961914
generate_one_block  0.17385244369506836
generate_one_block  0.17644381523132324
generate_one_block  0.173262357711792
generate_one_block  0.18964815139770508
generate_one_block  0.17094039916992188
generate_one_block  0.17481493949890137
generate_one_block  0.1827096939086914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04899716377258301
gen group dst list time:  0.09878706932067871
time for parepare:  0.017527341842651367
local_output_nid generation:  0.022000789642333984
local_in_edges_tensor generation:  0.05035591125488281
mini_batch_src_global generation:  0.03847694396972656
r_  generation:  0.3799784183502197
local_output_nid generation:  0.027287006378173828
local_in_edges_tensor generation:  0.039939165115356445
mini_batch_src_global generation:  0.04852485656738281
r_  generation:  0.3921358585357666
local_output_nid generation:  0.02760481834411621
local_in_edges_tensor generation:  0.029572486877441406
mini_batch_src_global generation:  0.04569578170776367
r_  generation:  0.3943932056427002
local_output_nid generation:  0.025480031967163086
local_in_edges_tensor generation:  0.03271222114562988
mini_batch_src_global generation:  0.0461430549621582
r_  generation:  0.3967931270599365
local_output_nid generation:  0.025731563568115234
local_in_edges_tensor generation:  0.03275251388549805
mini_batch_src_global generation:  0.04604625701904297
r_  generation:  0.3949146270751953
local_output_nid generation:  0.02600574493408203
local_in_edges_tensor generation:  0.03333616256713867
mini_batch_src_global generation:  0.046912431716918945
r_  generation:  0.4005904197692871
local_output_nid generation:  0.0257723331451416
local_in_edges_tensor generation:  0.026403188705444336
mini_batch_src_global generation:  0.04669475555419922
r_  generation:  0.39606690406799316
local_output_nid generation:  0.026391267776489258
local_in_edges_tensor generation:  0.026077747344970703
mini_batch_src_global generation:  0.04976987838745117
r_  generation:  0.3998532295227051
local_output_nid generation:  0.026405811309814453
local_in_edges_tensor generation:  0.03350329399108887
mini_batch_src_global generation:  0.0466771125793457
r_  generation:  0.4066436290740967
local_output_nid generation:  0.026532411575317383
local_in_edges_tensor generation:  0.03326249122619629
mini_batch_src_global generation:  0.04989171028137207
r_  generation:  0.4038541316986084
local_output_nid generation:  0.02642536163330078
local_in_edges_tensor generation:  0.029984235763549805
mini_batch_src_global generation:  0.04989361763000488
r_  generation:  0.40396904945373535
local_output_nid generation:  0.026347637176513672
local_in_edges_tensor generation:  0.02639293670654297
mini_batch_src_global generation:  0.04815816879272461
r_  generation:  0.40631103515625
local_output_nid generation:  0.02628636360168457
local_in_edges_tensor generation:  0.026311159133911133
mini_batch_src_global generation:  0.04710507392883301
r_  generation:  0.4006972312927246
local_output_nid generation:  0.026062965393066406
local_in_edges_tensor generation:  0.026692628860473633
mini_batch_src_global generation:  0.047384023666381836
r_  generation:  0.3974735736846924
local_output_nid generation:  0.026600360870361328
local_in_edges_tensor generation:  0.026026248931884766
mini_batch_src_global generation:  0.04685854911804199
r_  generation:  0.39649462699890137
local_output_nid generation:  0.02652907371520996
local_in_edges_tensor generation:  0.03692746162414551
mini_batch_src_global generation:  0.04989504814147949
r_  generation:  0.4078035354614258
local_output_nid generation:  0.026426076889038086
local_in_edges_tensor generation:  0.026210784912109375
mini_batch_src_global generation:  0.047040462493896484
r_  generation:  0.4017517566680908
local_output_nid generation:  0.026389122009277344
local_in_edges_tensor generation:  0.03259110450744629
mini_batch_src_global generation:  0.04947614669799805
r_  generation:  0.4071812629699707
local_output_nid generation:  0.027541399002075195
local_in_edges_tensor generation:  0.03363490104675293
mini_batch_src_global generation:  0.05879497528076172
r_  generation:  0.4040515422821045
local_output_nid generation:  0.027645349502563477
local_in_edges_tensor generation:  0.03768134117126465
mini_batch_src_global generation:  0.049790382385253906
r_  generation:  0.4064335823059082
local_output_nid generation:  0.02778482437133789
local_in_edges_tensor generation:  0.029340028762817383
mini_batch_src_global generation:  0.04772686958312988
r_  generation:  0.4051535129547119
local_output_nid generation:  0.02761220932006836
local_in_edges_tensor generation:  0.030045509338378906
mini_batch_src_global generation:  0.05057835578918457
r_  generation:  0.4066336154937744
local_output_nid generation:  0.02756643295288086
local_in_edges_tensor generation:  0.03321051597595215
mini_batch_src_global generation:  0.04727911949157715
r_  generation:  0.4073140621185303
local_output_nid generation:  0.027435779571533203
local_in_edges_tensor generation:  0.03342556953430176
mini_batch_src_global generation:  0.048445940017700195
r_  generation:  0.4104444980621338
local_output_nid generation:  0.02755451202392578
local_in_edges_tensor generation:  0.026526212692260742
mini_batch_src_global generation:  0.05062460899353027
r_  generation:  0.40393781661987305
local_output_nid generation:  0.027471542358398438
local_in_edges_tensor generation:  0.02655196189880371
mini_batch_src_global generation:  0.06823062896728516
r_  generation:  0.40499186515808105
local_output_nid generation:  0.027465343475341797
local_in_edges_tensor generation:  0.029694795608520508
mini_batch_src_global generation:  0.04756355285644531
r_  generation:  0.4046452045440674
local_output_nid generation:  0.027479887008666992
local_in_edges_tensor generation:  0.03434276580810547
mini_batch_src_global generation:  0.047193288803100586
r_  generation:  0.40256619453430176
local_output_nid generation:  0.027335405349731445
local_in_edges_tensor generation:  0.030454397201538086
mini_batch_src_global generation:  0.046730995178222656
r_  generation:  0.4039340019226074
local_output_nid generation:  0.02745199203491211
local_in_edges_tensor generation:  0.030534029006958008
mini_batch_src_global generation:  0.0469667911529541
r_  generation:  0.4114515781402588
local_output_nid generation:  0.02726912498474121
local_in_edges_tensor generation:  0.033063411712646484
mini_batch_src_global generation:  0.04628419876098633
r_  generation:  0.4069352149963379
local_output_nid generation:  0.02726435661315918
local_in_edges_tensor generation:  0.03364396095275879
mini_batch_src_global generation:  0.04720902442932129
r_  generation:  0.4062051773071289
----------------------check_connections_block total spend ----------------------------- 19.112184524536133
generate_one_block  0.5336763858795166
generate_one_block  0.5406234264373779
generate_one_block  0.5254364013671875
generate_one_block  0.5220701694488525
generate_one_block  0.6191728115081787
generate_one_block  0.5396788120269775
generate_one_block  0.5249252319335938
generate_one_block  0.5266597270965576
generate_one_block  0.5327179431915283
generate_one_block  0.5379295349121094
generate_one_block  0.535876989364624
generate_one_block  0.5210597515106201
generate_one_block  0.5301504135131836
generate_one_block  0.5198683738708496
generate_one_block  0.5270235538482666
generate_one_block  0.532966136932373
generate_one_block  0.528240442276001
generate_one_block  0.5375111103057861
generate_one_block  0.5267477035522461
generate_one_block  0.5288183689117432
generate_one_block  0.5268125534057617
generate_one_block  0.5414619445800781
generate_one_block  0.5398683547973633
generate_one_block  0.5400664806365967
generate_one_block  0.5420334339141846
generate_one_block  0.5328884124755859
generate_one_block  0.5302689075469971
generate_one_block  0.5304844379425049
generate_one_block  0.5291125774383545
generate_one_block  0.5784411430358887
generate_one_block  0.5329644680023193
generate_one_block  0.5303983688354492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1217036247253418  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

connection checking time:  25.532130002975464
block generation total time  22.79525399208069
average batch blocks generation time:  0.7123516872525215
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10395002365112305  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.672476291656494  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1030893325805664  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.812684535980225  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1038818359375  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.529252529144287  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1021871566772461  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.546151161193848  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10387325286865234  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.49153995513916  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1039729118347168  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.984676837921143  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10265970230102539  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.545001983642578  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10314798355102539  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.63825798034668  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1039743423461914  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.670176982879639  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10411739349365234  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.966384887695312  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10506010055541992  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 16.0551700592041  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10403633117675781  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.85186243057251  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10394048690795898  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.888769626617432  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10276937484741211  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.412474155426025  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1027684211730957  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.496111392974854  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10324287414550781  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.635544776916504  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10391521453857422  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.573197841644287  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10276937484741211  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.546115398406982  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10287714004516602  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.612535953521729  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10300540924072266  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.567974090576172  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10391902923583984  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.60978078842163  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10330724716186523  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.651174068450928  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10501527786254883  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.85789442062378  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10403585433959961  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.967868328094482  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10499715805053711  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.761441707611084  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10291290283203125  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.728166580200195  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10401630401611328  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.82036828994751  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10311412811279297  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.709137439727783  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10286235809326172  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.719919204711914  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1032719612121582  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.606066703796387  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10299253463745117  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.709628105163574  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10286331176757812  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.794737815856934  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031751640141010284 |0.01306895911693573 |0.2648436203598976 |9.42423939704895e-05 |0.43803820759058 |0.0050275325775146484 |
----------------------------------------------------------pseudo_mini_loss sum 3.849348545074463
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8576972
Number of first layer input nodes during this epoch:  4655195
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.11975526809692383  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02521038055419922
range selection method range initialization spend 0.013051271438598633
time for parepare:  0.02032470703125
local_output_nid generation:  0.0009071826934814453
local_in_edges_tensor generation:  0.007124185562133789
mini_batch_src_global generation:  0.0014486312866210938
r_  generation:  0.00855255126953125
local_output_nid generation:  0.0009737014770507812
local_in_edges_tensor generation:  0.0006196498870849609
mini_batch_src_global generation:  0.0011081695556640625
r_  generation:  0.00838780403137207
local_output_nid generation:  0.0009264945983886719
local_in_edges_tensor generation:  0.0005712509155273438
mini_batch_src_global generation:  0.000949859619140625
r_  generation:  0.007834911346435547
local_output_nid generation:  0.0008873939514160156
local_in_edges_tensor generation:  0.0005400180816650391
mini_batch_src_global generation:  0.0008778572082519531
r_  generation:  0.008048057556152344
local_output_nid generation:  0.0008409023284912109
local_in_edges_tensor generation:  0.0005013942718505859
mini_batch_src_global generation:  0.0008122920989990234
r_  generation:  0.00791478157043457
local_output_nid generation:  0.0008459091186523438
local_in_edges_tensor generation:  0.0005526542663574219
mini_batch_src_global generation:  0.0008487701416015625
r_  generation:  0.008099555969238281
local_output_nid generation:  0.0008394718170166016
local_in_edges_tensor generation:  0.0005123615264892578
mini_batch_src_global generation:  0.0008745193481445312
r_  generation:  0.008179426193237305
local_output_nid generation:  0.0008251667022705078
local_in_edges_tensor generation:  0.0005009174346923828
mini_batch_src_global generation:  0.0008149147033691406
r_  generation:  0.00782632827758789
local_output_nid generation:  0.0008385181427001953
local_in_edges_tensor generation:  0.0005171298980712891
mini_batch_src_global generation:  0.0008909702301025391
r_  generation:  0.008476972579956055
local_output_nid generation:  0.0008559226989746094
local_in_edges_tensor generation:  0.0005044937133789062
mini_batch_src_global generation:  0.0008609294891357422
r_  generation:  0.008082866668701172
local_output_nid generation:  0.0008199214935302734
local_in_edges_tensor generation:  0.0005252361297607422
mini_batch_src_global generation:  0.0009188652038574219
r_  generation:  0.008327484130859375
local_output_nid generation:  0.0008194446563720703
local_in_edges_tensor generation:  0.0005357265472412109
mini_batch_src_global generation:  0.0008432865142822266
r_  generation:  0.007780790328979492
local_output_nid generation:  0.0008151531219482422
local_in_edges_tensor generation:  0.0004942417144775391
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.008288860321044922
local_output_nid generation:  0.0008180141448974609
local_in_edges_tensor generation:  0.0004949569702148438
mini_batch_src_global generation:  0.00091552734375
r_  generation:  0.008286476135253906
local_output_nid generation:  0.0008087158203125
local_in_edges_tensor generation:  0.0004923343658447266
mini_batch_src_global generation:  0.0008604526519775391
r_  generation:  0.008445262908935547
local_output_nid generation:  0.0008180141448974609
local_in_edges_tensor generation:  0.0004956722259521484
mini_batch_src_global generation:  0.0009410381317138672
r_  generation:  0.008342981338500977
local_output_nid generation:  0.0008091926574707031
local_in_edges_tensor generation:  0.0005106925964355469
mini_batch_src_global generation:  0.0008883476257324219
r_  generation:  0.008233070373535156
local_output_nid generation:  0.0008141994476318359
local_in_edges_tensor generation:  0.0005130767822265625
mini_batch_src_global generation:  0.0008714199066162109
r_  generation:  0.008104801177978516
local_output_nid generation:  0.0007984638214111328
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.0009281635284423828
r_  generation:  0.008430004119873047
local_output_nid generation:  0.0008053779602050781
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0008466243743896484
r_  generation:  0.007972240447998047
local_output_nid generation:  0.0007913112640380859
local_in_edges_tensor generation:  0.0004830360412597656
mini_batch_src_global generation:  0.0008456707000732422
r_  generation:  0.00815892219543457
local_output_nid generation:  0.0008003711700439453
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.0008428096771240234
r_  generation:  0.007943391799926758
local_output_nid generation:  0.0007944107055664062
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0008690357208251953
r_  generation:  0.00833439826965332
local_output_nid generation:  0.0007874965667724609
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0008723735809326172
r_  generation:  0.008167266845703125
local_output_nid generation:  0.0008015632629394531
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.0008552074432373047
r_  generation:  0.008161306381225586
local_output_nid generation:  0.0007941722869873047
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.0008821487426757812
r_  generation:  0.008424043655395508
local_output_nid generation:  0.0008032321929931641
local_in_edges_tensor generation:  0.0005185604095458984
mini_batch_src_global generation:  0.000942230224609375
r_  generation:  0.009981393814086914
local_output_nid generation:  0.0008194446563720703
local_in_edges_tensor generation:  0.0005021095275878906
mini_batch_src_global generation:  0.0009279251098632812
r_  generation:  0.008185148239135742
local_output_nid generation:  0.0008130073547363281
local_in_edges_tensor generation:  0.00048351287841796875
mini_batch_src_global generation:  0.0008616447448730469
r_  generation:  0.008013248443603516
local_output_nid generation:  0.0008232593536376953
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.0009021759033203125
r_  generation:  0.007873773574829102
local_output_nid generation:  0.0007944107055664062
local_in_edges_tensor generation:  0.00047707557678222656
mini_batch_src_global generation:  0.0008590221405029297
r_  generation:  0.008209943771362305
local_output_nid generation:  0.0007994174957275391
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0008635520935058594
r_  generation:  0.008046388626098633
----------------------check_connections_block total spend ----------------------------- 0.4283900260925293
generate_one_block  0.020507335662841797
generate_one_block  0.016466856002807617
generate_one_block  0.014677762985229492
generate_one_block  0.014999866485595703
generate_one_block  0.014367818832397461
generate_one_block  0.014774322509765625
generate_one_block  0.01447296142578125
generate_one_block  0.014146804809570312
generate_one_block  0.01495218276977539
generate_one_block  0.014429330825805664
generate_one_block  0.01474618911743164
generate_one_block  0.014143228530883789
generate_one_block  0.014616250991821289
generate_one_block  0.014660358428955078
generate_one_block  0.014620065689086914
generate_one_block  0.014416217803955078
generate_one_block  0.014360427856445312
generate_one_block  0.014176130294799805
generate_one_block  0.014715433120727539
generate_one_block  0.01402139663696289
generate_one_block  0.014429330825805664
generate_one_block  0.013913869857788086
generate_one_block  0.014542579650878906
generate_one_block  0.014353513717651367
generate_one_block  0.014294624328613281
generate_one_block  0.014784574508666992
generate_one_block  0.01494288444519043
generate_one_block  0.014395475387573242
generate_one_block  0.014023542404174805
generate_one_block  0.01415562629699707
generate_one_block  0.014308691024780273
generate_one_block  0.014215469360351562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03807425498962402
gen group dst list time:  0.021147727966308594
time for parepare:  0.01958465576171875
local_output_nid generation:  0.004304170608520508
local_in_edges_tensor generation:  0.014810323715209961
mini_batch_src_global generation:  0.011810302734375
r_  generation:  0.11724352836608887
local_output_nid generation:  0.0064623355865478516
local_in_edges_tensor generation:  0.008404970169067383
mini_batch_src_global generation:  0.014200210571289062
r_  generation:  0.15737104415893555
local_output_nid generation:  0.006548881530761719
local_in_edges_tensor generation:  0.025603771209716797
mini_batch_src_global generation:  0.01560664176940918
r_  generation:  0.1303260326385498
local_output_nid generation:  0.006906032562255859
local_in_edges_tensor generation:  0.00801229476928711
mini_batch_src_global generation:  0.01750636100769043
r_  generation:  0.13579249382019043
local_output_nid generation:  0.006909608840942383
local_in_edges_tensor generation:  0.006834983825683594
mini_batch_src_global generation:  0.014801025390625
r_  generation:  0.16405653953552246
local_output_nid generation:  0.007315397262573242
local_in_edges_tensor generation:  0.0069463253021240234
mini_batch_src_global generation:  0.015526533126831055
r_  generation:  0.13691306114196777
local_output_nid generation:  0.007314920425415039
local_in_edges_tensor generation:  0.0099945068359375
mini_batch_src_global generation:  0.015603065490722656
r_  generation:  0.1386852264404297
local_output_nid generation:  0.007216453552246094
local_in_edges_tensor generation:  0.0073626041412353516
mini_batch_src_global generation:  0.017000436782836914
r_  generation:  0.13794374465942383
local_output_nid generation:  0.007521390914916992
local_in_edges_tensor generation:  0.007333993911743164
mini_batch_src_global generation:  0.016080856323242188
r_  generation:  0.1411726474761963
local_output_nid generation:  0.007636070251464844
local_in_edges_tensor generation:  0.007110118865966797
mini_batch_src_global generation:  0.016286134719848633
r_  generation:  0.13794684410095215
local_output_nid generation:  0.007648468017578125
local_in_edges_tensor generation:  0.007143497467041016
mini_batch_src_global generation:  0.016361713409423828
r_  generation:  0.1430807113647461
local_output_nid generation:  0.007353544235229492
local_in_edges_tensor generation:  0.00803518295288086
mini_batch_src_global generation:  0.0167236328125
r_  generation:  0.1354050636291504
local_output_nid generation:  0.007725238800048828
local_in_edges_tensor generation:  0.008363485336303711
mini_batch_src_global generation:  0.01944732666015625
r_  generation:  0.14213824272155762
local_output_nid generation:  0.007718086242675781
local_in_edges_tensor generation:  0.008185148239135742
mini_batch_src_global generation:  0.01824164390563965
r_  generation:  0.14107704162597656
local_output_nid generation:  0.0077402591705322266
local_in_edges_tensor generation:  0.009648323059082031
mini_batch_src_global generation:  0.016190767288208008
r_  generation:  0.13924360275268555
local_output_nid generation:  0.0076847076416015625
local_in_edges_tensor generation:  0.007127285003662109
mini_batch_src_global generation:  0.016155242919921875
r_  generation:  0.13683485984802246
local_output_nid generation:  0.007619380950927734
local_in_edges_tensor generation:  0.007679462432861328
mini_batch_src_global generation:  0.017359495162963867
r_  generation:  0.13985538482666016
local_output_nid generation:  0.007479190826416016
local_in_edges_tensor generation:  0.010077238082885742
mini_batch_src_global generation:  0.018726587295532227
r_  generation:  0.13483977317810059
local_output_nid generation:  0.007816553115844727
local_in_edges_tensor generation:  0.008068323135375977
mini_batch_src_global generation:  0.016774892807006836
r_  generation:  0.14740610122680664
local_output_nid generation:  0.007677555084228516
local_in_edges_tensor generation:  0.007344245910644531
mini_batch_src_global generation:  0.01618361473083496
r_  generation:  0.13677692413330078
local_output_nid generation:  0.007735729217529297
local_in_edges_tensor generation:  0.007479667663574219
mini_batch_src_global generation:  0.01639080047607422
r_  generation:  0.13718843460083008
local_output_nid generation:  0.0076444149017333984
local_in_edges_tensor generation:  0.008222818374633789
mini_batch_src_global generation:  0.01603221893310547
r_  generation:  0.1332864761352539
local_output_nid generation:  0.0077707767486572266
local_in_edges_tensor generation:  0.0073604583740234375
mini_batch_src_global generation:  0.02310013771057129
r_  generation:  0.1395397186279297
local_output_nid generation:  0.007893085479736328
local_in_edges_tensor generation:  0.010576963424682617
mini_batch_src_global generation:  0.01706385612487793
r_  generation:  0.1387341022491455
local_output_nid generation:  0.008650779724121094
local_in_edges_tensor generation:  0.0072863101959228516
mini_batch_src_global generation:  0.0177609920501709
r_  generation:  0.1397106647491455
local_output_nid generation:  0.00798177719116211
local_in_edges_tensor generation:  0.00743412971496582
mini_batch_src_global generation:  0.022355079650878906
r_  generation:  0.14133167266845703
local_output_nid generation:  0.009374618530273438
local_in_edges_tensor generation:  0.007651090621948242
mini_batch_src_global generation:  0.0168759822845459
r_  generation:  0.14420390129089355
local_output_nid generation:  0.00804901123046875
local_in_edges_tensor generation:  0.007940292358398438
mini_batch_src_global generation:  0.01750946044921875
r_  generation:  0.14002609252929688
local_output_nid generation:  0.007967233657836914
local_in_edges_tensor generation:  0.00729060173034668
mini_batch_src_global generation:  0.015955209732055664
r_  generation:  0.1367044448852539
local_output_nid generation:  0.007956743240356445
local_in_edges_tensor generation:  0.007416963577270508
mini_batch_src_global generation:  0.016199111938476562
r_  generation:  0.13482046127319336
local_output_nid generation:  0.007790565490722656
local_in_edges_tensor generation:  0.007161617279052734
mini_batch_src_global generation:  0.015778303146362305
r_  generation:  0.13800644874572754
local_output_nid generation:  0.0076100826263427734
local_in_edges_tensor generation:  0.007895708084106445
mini_batch_src_global generation:  0.016361236572265625
r_  generation:  0.13462591171264648
----------------------check_connections_block total spend ----------------------------- 6.562400817871094
generate_one_block  0.1733710765838623
generate_one_block  0.16727519035339355
generate_one_block  0.1688227653503418
generate_one_block  0.1783761978149414
generate_one_block  0.18224287033081055
generate_one_block  0.1736128330230713
generate_one_block  0.1738729476928711
generate_one_block  0.174729585647583
generate_one_block  0.17964768409729004
generate_one_block  0.17829060554504395
generate_one_block  0.18731045722961426
generate_one_block  0.16983962059020996
generate_one_block  0.17682361602783203
generate_one_block  0.17867636680603027
generate_one_block  0.17647767066955566
generate_one_block  0.174635648727417
generate_one_block  0.1712169647216797
generate_one_block  0.1721482276916504
generate_one_block  0.18111085891723633
generate_one_block  0.19783544540405273
generate_one_block  0.1742250919342041
generate_one_block  0.17291545867919922
generate_one_block  0.17765259742736816
generate_one_block  0.1731123924255371
generate_one_block  0.17301344871520996
generate_one_block  0.18209099769592285
generate_one_block  0.18324780464172363
generate_one_block  0.17960166931152344
generate_one_block  0.17356395721435547
generate_one_block  0.17110013961791992
generate_one_block  0.17214131355285645
generate_one_block  0.17322874069213867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03760075569152832
gen group dst list time:  0.11029291152954102
time for parepare:  0.02100348472595215
local_output_nid generation:  0.022431373596191406
local_in_edges_tensor generation:  0.05063939094543457
mini_batch_src_global generation:  0.03644990921020508
r_  generation:  0.38960766792297363
local_output_nid generation:  0.026888132095336914
local_in_edges_tensor generation:  0.03276824951171875
mini_batch_src_global generation:  0.04650568962097168
r_  generation:  0.39104700088500977
local_output_nid generation:  0.026703596115112305
local_in_edges_tensor generation:  0.027117013931274414
mini_batch_src_global generation:  0.045014381408691406
r_  generation:  0.4019463062286377
local_output_nid generation:  0.026381254196166992
local_in_edges_tensor generation:  0.025107145309448242
mini_batch_src_global generation:  0.050562143325805664
r_  generation:  0.41205692291259766
local_output_nid generation:  0.02641463279724121
local_in_edges_tensor generation:  0.026162385940551758
mini_batch_src_global generation:  0.04842782020568848
r_  generation:  0.4068162441253662
local_output_nid generation:  0.026401519775390625
local_in_edges_tensor generation:  0.025116682052612305
mini_batch_src_global generation:  0.04907655715942383
r_  generation:  0.40026330947875977
local_output_nid generation:  0.026366472244262695
local_in_edges_tensor generation:  0.028513193130493164
mini_batch_src_global generation:  0.04726243019104004
r_  generation:  0.4123384952545166
local_output_nid generation:  0.026346921920776367
local_in_edges_tensor generation:  0.02715015411376953
mini_batch_src_global generation:  0.04794049263000488
r_  generation:  0.4028465747833252
local_output_nid generation:  0.02729177474975586
local_in_edges_tensor generation:  0.031058073043823242
mini_batch_src_global generation:  0.04825019836425781
r_  generation:  0.40857601165771484
local_output_nid generation:  0.02656078338623047
local_in_edges_tensor generation:  0.027681827545166016
mini_batch_src_global generation:  0.04754328727722168
r_  generation:  0.40449023246765137
local_output_nid generation:  0.028362751007080078
local_in_edges_tensor generation:  0.028652667999267578
mini_batch_src_global generation:  0.046649932861328125
r_  generation:  0.41057562828063965
local_output_nid generation:  0.026239395141601562
local_in_edges_tensor generation:  0.028490543365478516
mini_batch_src_global generation:  0.048714399337768555
r_  generation:  0.39592909812927246
local_output_nid generation:  0.028350114822387695
local_in_edges_tensor generation:  0.025232791900634766
mini_batch_src_global generation:  0.046149253845214844
r_  generation:  0.41135263442993164
local_output_nid generation:  0.026536941528320312
local_in_edges_tensor generation:  0.026715993881225586
mini_batch_src_global generation:  0.04777789115905762
r_  generation:  0.4040062427520752
local_output_nid generation:  0.02645254135131836
local_in_edges_tensor generation:  0.02870321273803711
mini_batch_src_global generation:  0.04620623588562012
r_  generation:  0.4215071201324463
local_output_nid generation:  0.027196645736694336
local_in_edges_tensor generation:  0.025635957717895508
mini_batch_src_global generation:  0.04786562919616699
r_  generation:  0.40937066078186035
local_output_nid generation:  0.028508424758911133
local_in_edges_tensor generation:  0.0269773006439209
mini_batch_src_global generation:  0.04656481742858887
r_  generation:  0.40475940704345703
local_output_nid generation:  0.026948213577270508
local_in_edges_tensor generation:  0.03034353256225586
mini_batch_src_global generation:  0.04887747764587402
r_  generation:  0.4002859592437744
local_output_nid generation:  0.027756214141845703
local_in_edges_tensor generation:  0.027296066284179688
mini_batch_src_global generation:  0.04639458656311035
r_  generation:  0.4109623432159424
local_output_nid generation:  0.027203083038330078
local_in_edges_tensor generation:  0.02798008918762207
mini_batch_src_global generation:  0.04715371131896973
r_  generation:  0.3961155414581299
local_output_nid generation:  0.027319908142089844
local_in_edges_tensor generation:  0.024938106536865234
mini_batch_src_global generation:  0.04982280731201172
r_  generation:  0.407562255859375
local_output_nid generation:  0.026804208755493164
local_in_edges_tensor generation:  0.027509689331054688
mini_batch_src_global generation:  0.048653602600097656
r_  generation:  0.40494871139526367
local_output_nid generation:  0.027256011962890625
local_in_edges_tensor generation:  0.027402877807617188
mini_batch_src_global generation:  0.04590320587158203
r_  generation:  0.40844082832336426
local_output_nid generation:  0.027254343032836914
local_in_edges_tensor generation:  0.02526688575744629
mini_batch_src_global generation:  0.04907059669494629
r_  generation:  0.3997781276702881
local_output_nid generation:  0.027518033981323242
local_in_edges_tensor generation:  0.026765108108520508
mini_batch_src_global generation:  0.04624581336975098
r_  generation:  0.40511131286621094
local_output_nid generation:  0.027353286743164062
local_in_edges_tensor generation:  0.02978205680847168
mini_batch_src_global generation:  0.048603057861328125
r_  generation:  0.4076530933380127
local_output_nid generation:  0.02738165855407715
local_in_edges_tensor generation:  0.027102947235107422
mini_batch_src_global generation:  0.04717206954956055
r_  generation:  0.4071834087371826
local_output_nid generation:  0.027798175811767578
local_in_edges_tensor generation:  0.02758026123046875
mini_batch_src_global generation:  0.04840850830078125
r_  generation:  0.4015936851501465
local_output_nid generation:  0.027271509170532227
local_in_edges_tensor generation:  0.033521413803100586
mini_batch_src_global generation:  0.046657562255859375
r_  generation:  0.40294313430786133
local_output_nid generation:  0.028110980987548828
local_in_edges_tensor generation:  0.030515193939208984
mini_batch_src_global generation:  0.0483701229095459
r_  generation:  0.4028477668762207
local_output_nid generation:  0.02716350555419922
local_in_edges_tensor generation:  0.02896595001220703
mini_batch_src_global generation:  0.04682111740112305
r_  generation:  0.4053981304168701
local_output_nid generation:  0.027486085891723633
local_in_edges_tensor generation:  0.027533769607543945
mini_batch_src_global generation:  0.04935169219970703
r_  generation:  0.40041136741638184
----------------------check_connections_block total spend ----------------------------- 19.120901107788086
generate_one_block  0.5403931140899658
generate_one_block  0.5304021835327148
generate_one_block  0.5351114273071289
generate_one_block  0.5418365001678467
generate_one_block  0.619483470916748
generate_one_block  0.5295166969299316
generate_one_block  0.5448546409606934
generate_one_block  0.5313093662261963
generate_one_block  0.5386722087860107
generate_one_block  0.5314857959747314
generate_one_block  0.5420515537261963
generate_one_block  0.5244293212890625
generate_one_block  0.534294605255127
generate_one_block  0.5341219902038574
generate_one_block  0.5320405960083008
generate_one_block  0.5365035533905029
generate_one_block  0.5238752365112305
generate_one_block  0.5348067283630371
generate_one_block  0.5416245460510254
generate_one_block  0.5304715633392334
generate_one_block  0.548330545425415
generate_one_block  0.5221889019012451
generate_one_block  0.5270497798919678
generate_one_block  0.5327093601226807
generate_one_block  0.5631005764007568
generate_one_block  0.5439484119415283
generate_one_block  0.5447659492492676
generate_one_block  0.5465600490570068
generate_one_block  0.5301711559295654
generate_one_block  0.5359756946563721
generate_one_block  0.5282883644104004
generate_one_block  0.5319054126739502
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.11975526809692383  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

connection checking time:  25.68330192565918
block generation total time  22.874489545822144
average batch blocks generation time:  0.714827798306942
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10279417037963867  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.477510452270508  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10299873352050781  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.524528980255127  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1027374267578125  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.605359554290771  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10427999496459961  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 16.029388427734375  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10393142700195312  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.607434749603271  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1030282974243164  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.760757446289062  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10500907897949219  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.83922290802002  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10280179977416992  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.604337692260742  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10505247116088867  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.967473030090332  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10299110412597656  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.755787372589111  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1050405502319336  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.955953121185303  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1027073860168457  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.33192491531372  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10389232635498047  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.890668869018555  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1041111946105957  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.799829006195068  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10305929183959961  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.793336391448975  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10300874710083008  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.66841459274292  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10389232635498047  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.52922773361206  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1027369499206543  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.517472743988037  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10393619537353516  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.977751731872559  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1027536392211914  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.441038608551025  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10400009155273438  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.705313205718994  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10233116149902344  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.306421756744385  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10282039642333984  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.63145923614502  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10274362564086914  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.539499282836914  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1039571762084961  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.65519905090332  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10380935668945312  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.962430477142334  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10405826568603516  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 16.028037548065186  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10421276092529297  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.886762619018555  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10286903381347656  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.461596012115479  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10280895233154297  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.491317749023438  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10269546508789062  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.522080421447754  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10283851623535156  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.528369903564453  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03285844624042511 |0.013619333505630493 |0.2630230337381363 |9.379535913467407e-05 |0.4299923852086067 |0.005985260009765625 |
----------------------------------------------------------pseudo_mini_loss sum 3.3334269523620605
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  8570208
Number of first layer input nodes during this epoch:  4650434
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.11995315551757812  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02284979820251465
range selection method range initialization spend 0.013405323028564453
time for parepare:  0.019003868103027344
local_output_nid generation:  0.0008962154388427734
local_in_edges_tensor generation:  0.006403923034667969
mini_batch_src_global generation:  0.0015213489532470703
r_  generation:  0.008580207824707031
local_output_nid generation:  0.0009405612945556641
local_in_edges_tensor generation:  0.0006082057952880859
mini_batch_src_global generation:  0.0012750625610351562
r_  generation:  0.008209705352783203
local_output_nid generation:  0.0008859634399414062
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0009610652923583984
r_  generation:  0.008193731307983398
local_output_nid generation:  0.000904083251953125
local_in_edges_tensor generation:  0.0005433559417724609
mini_batch_src_global generation:  0.0008509159088134766
r_  generation:  0.007796287536621094
local_output_nid generation:  0.0008883476257324219
local_in_edges_tensor generation:  0.0005018711090087891
mini_batch_src_global generation:  0.0009310245513916016
r_  generation:  0.008169889450073242
local_output_nid generation:  0.0008356571197509766
local_in_edges_tensor generation:  0.0005650520324707031
mini_batch_src_global generation:  0.0008978843688964844
r_  generation:  0.00831913948059082
local_output_nid generation:  0.0008211135864257812
local_in_edges_tensor generation:  0.0005261898040771484
mini_batch_src_global generation:  0.0008931159973144531
r_  generation:  0.008219718933105469
local_output_nid generation:  0.0008158683776855469
local_in_edges_tensor generation:  0.0005679130554199219
mini_batch_src_global generation:  0.0009617805480957031
r_  generation:  0.008284568786621094
local_output_nid generation:  0.0008127689361572266
local_in_edges_tensor generation:  0.0005583763122558594
mini_batch_src_global generation:  0.0008530616760253906
r_  generation:  0.007919073104858398
local_output_nid generation:  0.0008065700531005859
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0008783340454101562
r_  generation:  0.008201837539672852
local_output_nid generation:  0.0008096694946289062
local_in_edges_tensor generation:  0.0005192756652832031
mini_batch_src_global generation:  0.0009319782257080078
r_  generation:  0.008624553680419922
local_output_nid generation:  0.0008120536804199219
local_in_edges_tensor generation:  0.00048828125
mini_batch_src_global generation:  0.00092315673828125
r_  generation:  0.008098363876342773
local_output_nid generation:  0.0008058547973632812
local_in_edges_tensor generation:  0.0005037784576416016
mini_batch_src_global generation:  0.0008819103240966797
r_  generation:  0.008355379104614258
local_output_nid generation:  0.0008020401000976562
local_in_edges_tensor generation:  0.0004973411560058594
mini_batch_src_global generation:  0.0009260177612304688
r_  generation:  0.008239030838012695
local_output_nid generation:  0.0007929801940917969
local_in_edges_tensor generation:  0.00048041343688964844
mini_batch_src_global generation:  0.0009367465972900391
r_  generation:  0.008275032043457031
local_output_nid generation:  0.0007991790771484375
local_in_edges_tensor generation:  0.0004909038543701172
mini_batch_src_global generation:  0.000911712646484375
r_  generation:  0.00800776481628418
local_output_nid generation:  0.0007905960083007812
local_in_edges_tensor generation:  0.0004971027374267578
mini_batch_src_global generation:  0.0009753704071044922
r_  generation:  0.008284807205200195
local_output_nid generation:  0.0007944107055664062
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.0009584426879882812
r_  generation:  0.007996797561645508
local_output_nid generation:  0.00078582763671875
local_in_edges_tensor generation:  0.0005035400390625
mini_batch_src_global generation:  0.0008559226989746094
r_  generation:  0.007995128631591797
local_output_nid generation:  0.0007846355438232422
local_in_edges_tensor generation:  0.0005099773406982422
mini_batch_src_global generation:  0.0009291172027587891
r_  generation:  0.009434938430786133
local_output_nid generation:  0.0007903575897216797
local_in_edges_tensor generation:  0.0005052089691162109
mini_batch_src_global generation:  0.0009436607360839844
r_  generation:  0.008406639099121094
local_output_nid generation:  0.0007975101470947266
local_in_edges_tensor generation:  0.0005166530609130859
mini_batch_src_global generation:  0.0009207725524902344
r_  generation:  0.008336544036865234
local_output_nid generation:  0.0008080005645751953
local_in_edges_tensor generation:  0.0005018711090087891
mini_batch_src_global generation:  0.0008990764617919922
r_  generation:  0.008127927780151367
local_output_nid generation:  0.0008022785186767578
local_in_edges_tensor generation:  0.000476837158203125
mini_batch_src_global generation:  0.0008842945098876953
r_  generation:  0.00820302963256836
local_output_nid generation:  0.000797271728515625
local_in_edges_tensor generation:  0.0004985332489013672
mini_batch_src_global generation:  0.0008900165557861328
r_  generation:  0.008275985717773438
local_output_nid generation:  0.0007867813110351562
local_in_edges_tensor generation:  0.0004940032958984375
mini_batch_src_global generation:  0.0009098052978515625
r_  generation:  0.00847315788269043
local_output_nid generation:  0.0008001327514648438
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0008833408355712891
r_  generation:  0.008434295654296875
local_output_nid generation:  0.0007927417755126953
local_in_edges_tensor generation:  0.0004892349243164062
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.008113622665405273
local_output_nid generation:  0.0008041858673095703
local_in_edges_tensor generation:  0.0005040168762207031
mini_batch_src_global generation:  0.0008599758148193359
r_  generation:  0.008248090744018555
local_output_nid generation:  0.0007910728454589844
local_in_edges_tensor generation:  0.0004942417144775391
mini_batch_src_global generation:  0.0008807182312011719
r_  generation:  0.008386611938476562
local_output_nid generation:  0.000789642333984375
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0008752346038818359
r_  generation:  0.008262395858764648
local_output_nid generation:  0.0007939338684082031
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0008778572082519531
r_  generation:  0.008227109909057617
----------------------check_connections_block total spend ----------------------------- 0.43068671226501465
generate_one_block  0.022814035415649414
generate_one_block  0.016293764114379883
generate_one_block  0.015326499938964844
generate_one_block  0.014469146728515625
generate_one_block  0.01492762565612793
generate_one_block  0.015003204345703125
generate_one_block  0.014572381973266602
generate_one_block  0.014812707901000977
generate_one_block  0.014238834381103516
generate_one_block  0.014466047286987305
generate_one_block  0.015278100967407227
generate_one_block  0.014463663101196289
generate_one_block  0.01470947265625
generate_one_block  0.0146026611328125
generate_one_block  0.014722347259521484
generate_one_block  0.014176607131958008
generate_one_block  0.014516830444335938
generate_one_block  0.014164447784423828
generate_one_block  0.014055967330932617
generate_one_block  0.014967203140258789
generate_one_block  0.014574289321899414
generate_one_block  0.014549732208251953
generate_one_block  0.01435542106628418
generate_one_block  0.014259576797485352
generate_one_block  0.014466524124145508
generate_one_block  0.01479792594909668
generate_one_block  0.014681577682495117
generate_one_block  0.01417994499206543
generate_one_block  0.014434576034545898
generate_one_block  0.014508485794067383
generate_one_block  0.014563560485839844
generate_one_block  0.014441728591918945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038867950439453125
gen group dst list time:  0.021108388900756836
time for parepare:  0.02129530906677246
local_output_nid generation:  0.004563570022583008
local_in_edges_tensor generation:  0.014945030212402344
mini_batch_src_global generation:  0.012221097946166992
r_  generation:  0.11858820915222168
local_output_nid generation:  0.006456851959228516
local_in_edges_tensor generation:  0.008381128311157227
mini_batch_src_global generation:  0.014093399047851562
r_  generation:  0.12244129180908203
local_output_nid generation:  0.006864070892333984
local_in_edges_tensor generation:  0.027261734008789062
mini_batch_src_global generation:  0.0211639404296875
r_  generation:  0.13202190399169922
local_output_nid generation:  0.0068247318267822266
local_in_edges_tensor generation:  0.00692296028137207
mini_batch_src_global generation:  0.014039039611816406
r_  generation:  0.12638235092163086
local_output_nid generation:  0.007394313812255859
local_in_edges_tensor generation:  0.007104158401489258
mini_batch_src_global generation:  0.017104148864746094
r_  generation:  0.1343858242034912
local_output_nid generation:  0.007280826568603516
local_in_edges_tensor generation:  0.007571697235107422
mini_batch_src_global generation:  0.015707969665527344
r_  generation:  0.13547873497009277
local_output_nid generation:  0.007104635238647461
local_in_edges_tensor generation:  0.007036447525024414
mini_batch_src_global generation:  0.015238761901855469
r_  generation:  0.1309208869934082
local_output_nid generation:  0.0073244571685791016
local_in_edges_tensor generation:  0.007019996643066406
mini_batch_src_global generation:  0.015880346298217773
r_  generation:  0.13657212257385254
local_output_nid generation:  0.0071201324462890625
local_in_edges_tensor generation:  0.00963282585144043
mini_batch_src_global generation:  0.01597452163696289
r_  generation:  0.13211846351623535
local_output_nid generation:  0.007209300994873047
local_in_edges_tensor generation:  0.007112264633178711
mini_batch_src_global generation:  0.015631675720214844
r_  generation:  0.1340923309326172
local_output_nid generation:  0.00784444808959961
local_in_edges_tensor generation:  0.007421016693115234
mini_batch_src_global generation:  0.0165555477142334
r_  generation:  0.1434171199798584
local_output_nid generation:  0.007592201232910156
local_in_edges_tensor generation:  0.007153511047363281
mini_batch_src_global generation:  0.016354799270629883
r_  generation:  0.1334240436553955
local_output_nid generation:  0.007807254791259766
local_in_edges_tensor generation:  0.007764339447021484
mini_batch_src_global generation:  0.016255617141723633
r_  generation:  0.13795685768127441
local_output_nid generation:  0.0077855587005615234
local_in_edges_tensor generation:  0.007818222045898438
mini_batch_src_global generation:  0.01686239242553711
r_  generation:  0.1365060806274414
local_output_nid generation:  0.007901668548583984
local_in_edges_tensor generation:  0.007437705993652344
mini_batch_src_global generation:  0.015947341918945312
r_  generation:  0.13848209381103516
local_output_nid generation:  0.007664680480957031
local_in_edges_tensor generation:  0.00732874870300293
mini_batch_src_global generation:  0.015993595123291016
r_  generation:  0.1347332000732422
local_output_nid generation:  0.007764339447021484
local_in_edges_tensor generation:  0.007452249526977539
mini_batch_src_global generation:  0.01580333709716797
r_  generation:  0.13651800155639648
local_output_nid generation:  0.00772404670715332
local_in_edges_tensor generation:  0.007079362869262695
mini_batch_src_global generation:  0.016025543212890625
r_  generation:  0.1322629451751709
local_output_nid generation:  0.007688283920288086
local_in_edges_tensor generation:  0.0071086883544921875
mini_batch_src_global generation:  0.015470266342163086
r_  generation:  0.1333296298980713
local_output_nid generation:  0.008128166198730469
local_in_edges_tensor generation:  0.007501363754272461
mini_batch_src_global generation:  0.016665935516357422
r_  generation:  0.14117193222045898
local_output_nid generation:  0.0079345703125
local_in_edges_tensor generation:  0.007468223571777344
mini_batch_src_global generation:  0.01638484001159668
r_  generation:  0.13685059547424316
local_output_nid generation:  0.007908105850219727
local_in_edges_tensor generation:  0.007249593734741211
mini_batch_src_global generation:  0.01628255844116211
r_  generation:  0.13535833358764648
local_output_nid generation:  0.007904291152954102
local_in_edges_tensor generation:  0.0082855224609375
mini_batch_src_global generation:  0.016084671020507812
r_  generation:  0.13656187057495117
local_output_nid generation:  0.007917404174804688
local_in_edges_tensor generation:  0.007943153381347656
mini_batch_src_global generation:  0.01626753807067871
r_  generation:  0.1377241611480713
local_output_nid generation:  0.008062362670898438
local_in_edges_tensor generation:  0.007889509201049805
mini_batch_src_global generation:  0.015866756439208984
r_  generation:  0.1377701759338379
local_output_nid generation:  0.007959604263305664
local_in_edges_tensor generation:  0.008338212966918945
mini_batch_src_global generation:  0.01665782928466797
r_  generation:  0.14074325561523438
local_output_nid generation:  0.007997512817382812
local_in_edges_tensor generation:  0.008393526077270508
mini_batch_src_global generation:  0.01642131805419922
r_  generation:  0.14459991455078125
local_output_nid generation:  0.00782322883605957
local_in_edges_tensor generation:  0.007311105728149414
mini_batch_src_global generation:  0.016060352325439453
r_  generation:  0.1344435214996338
local_output_nid generation:  0.007984638214111328
local_in_edges_tensor generation:  0.007390499114990234
mini_batch_src_global generation:  0.015943288803100586
r_  generation:  0.13733720779418945
local_output_nid generation:  0.007977962493896484
local_in_edges_tensor generation:  0.007791280746459961
mini_batch_src_global generation:  0.017133712768554688
r_  generation:  0.1383826732635498
local_output_nid generation:  0.008065462112426758
local_in_edges_tensor generation:  0.007912158966064453
mini_batch_src_global generation:  0.01625847816467285
r_  generation:  0.13991308212280273
local_output_nid generation:  0.007981300354003906
local_in_edges_tensor generation:  0.0073015689849853516
mini_batch_src_global generation:  0.016260147094726562
r_  generation:  0.13566088676452637
----------------------check_connections_block total spend ----------------------------- 6.396128416061401
generate_one_block  0.16992592811584473
generate_one_block  0.16302275657653809
generate_one_block  0.17692160606384277
generate_one_block  0.16825032234191895
generate_one_block  0.19137048721313477
generate_one_block  0.178208589553833
generate_one_block  0.1686105728149414
generate_one_block  0.17458319664001465
generate_one_block  0.16927337646484375
generate_one_block  0.17304205894470215
generate_one_block  0.1831660270690918
generate_one_block  0.17051124572753906
generate_one_block  0.17586255073547363
generate_one_block  0.17509150505065918
generate_one_block  0.17766451835632324
generate_one_block  0.17385649681091309
generate_one_block  0.1798250675201416
generate_one_block  0.17248034477233887
generate_one_block  0.17084789276123047
generate_one_block  0.20755290985107422
generate_one_block  0.17444539070129395
generate_one_block  0.17554974555969238
generate_one_block  0.17537593841552734
generate_one_block  0.17664456367492676
generate_one_block  0.1748640537261963
generate_one_block  0.18093538284301758
generate_one_block  0.1843254566192627
generate_one_block  0.17275762557983398
generate_one_block  0.17455196380615234
generate_one_block  0.17757415771484375
generate_one_block  0.17773914337158203
generate_one_block  0.17265605926513672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05057406425476074
gen group dst list time:  0.10004734992980957
time for parepare:  0.019077301025390625
local_output_nid generation:  0.022139549255371094
local_in_edges_tensor generation:  0.03499960899353027
mini_batch_src_global generation:  0.03616762161254883
r_  generation:  0.3904588222503662
local_output_nid generation:  0.027180910110473633
local_in_edges_tensor generation:  0.03528165817260742
mini_batch_src_global generation:  0.04609203338623047
r_  generation:  0.3849513530731201
local_output_nid generation:  0.02823948860168457
local_in_edges_tensor generation:  0.027756452560424805
mini_batch_src_global generation:  0.047383785247802734
r_  generation:  0.4033961296081543
local_output_nid generation:  0.027541637420654297
local_in_edges_tensor generation:  0.02612018585205078
mini_batch_src_global generation:  0.04728889465332031
r_  generation:  0.3917067050933838
local_output_nid generation:  0.02638411521911621
local_in_edges_tensor generation:  0.025246143341064453
mini_batch_src_global generation:  0.04654860496520996
r_  generation:  0.40816378593444824
local_output_nid generation:  0.026134729385375977
local_in_edges_tensor generation:  0.03382992744445801
mini_batch_src_global generation:  0.04896426200866699
r_  generation:  0.39946699142456055
local_output_nid generation:  0.02647709846496582
local_in_edges_tensor generation:  0.027740955352783203
mini_batch_src_global generation:  0.04607534408569336
r_  generation:  0.4022810459136963
local_output_nid generation:  0.02625560760498047
local_in_edges_tensor generation:  0.02502894401550293
mini_batch_src_global generation:  0.04920172691345215
r_  generation:  0.40350866317749023
local_output_nid generation:  0.02651047706604004
local_in_edges_tensor generation:  0.025151968002319336
mini_batch_src_global generation:  0.04577946662902832
r_  generation:  0.4019443988800049
local_output_nid generation:  0.026440143585205078
local_in_edges_tensor generation:  0.028311967849731445
mini_batch_src_global generation:  0.04969000816345215
r_  generation:  0.39844441413879395
local_output_nid generation:  0.026772499084472656
local_in_edges_tensor generation:  0.026833295822143555
mini_batch_src_global generation:  0.046770572662353516
r_  generation:  0.41116952896118164
local_output_nid generation:  0.02630472183227539
local_in_edges_tensor generation:  0.02979111671447754
mini_batch_src_global generation:  0.0496218204498291
r_  generation:  0.3978419303894043
local_output_nid generation:  0.0275423526763916
local_in_edges_tensor generation:  0.025397300720214844
mini_batch_src_global generation:  0.047698020935058594
r_  generation:  0.40798521041870117
local_output_nid generation:  0.026563644409179688
local_in_edges_tensor generation:  0.028643131256103516
mini_batch_src_global generation:  0.04784035682678223
r_  generation:  0.40076112747192383
local_output_nid generation:  0.026849746704101562
local_in_edges_tensor generation:  0.0272214412689209
mini_batch_src_global generation:  0.048459529876708984
r_  generation:  0.409304141998291
local_output_nid generation:  0.02667832374572754
local_in_edges_tensor generation:  0.025443315505981445
mini_batch_src_global generation:  0.04782676696777344
r_  generation:  0.39731645584106445
local_output_nid generation:  0.02661275863647461
local_in_edges_tensor generation:  0.025539875030517578
mini_batch_src_global generation:  0.04625535011291504
r_  generation:  0.40554332733154297
local_output_nid generation:  0.026491880416870117
local_in_edges_tensor generation:  0.02476358413696289
mini_batch_src_global generation:  0.047708988189697266
r_  generation:  0.4004507064819336
local_output_nid generation:  0.02677178382873535
local_in_edges_tensor generation:  0.02513861656188965
mini_batch_src_global generation:  0.046854496002197266
r_  generation:  0.40396642684936523
local_output_nid generation:  0.02669072151184082
local_in_edges_tensor generation:  0.026709794998168945
mini_batch_src_global generation:  0.04813861846923828
r_  generation:  0.40189695358276367
local_output_nid generation:  0.026913881301879883
local_in_edges_tensor generation:  0.028202295303344727
mini_batch_src_global generation:  0.04697227478027344
r_  generation:  0.4043717384338379
local_output_nid generation:  0.031319618225097656
local_in_edges_tensor generation:  0.025345563888549805
mini_batch_src_global generation:  0.05487823486328125
r_  generation:  0.3998749256134033
local_output_nid generation:  0.027495622634887695
local_in_edges_tensor generation:  0.025313615798950195
mini_batch_src_global generation:  0.046433448791503906
r_  generation:  0.4031965732574463
local_output_nid generation:  0.02736210823059082
local_in_edges_tensor generation:  0.02687549591064453
mini_batch_src_global generation:  0.04768180847167969
r_  generation:  0.40108442306518555
local_output_nid generation:  0.02757740020751953
local_in_edges_tensor generation:  0.026680469512939453
mini_batch_src_global generation:  0.046430110931396484
r_  generation:  0.4041917324066162
local_output_nid generation:  0.028301715850830078
local_in_edges_tensor generation:  0.02875542640686035
mini_batch_src_global generation:  0.05096244812011719
r_  generation:  0.40331459045410156
local_output_nid generation:  0.027374982833862305
local_in_edges_tensor generation:  0.028555870056152344
mini_batch_src_global generation:  0.04683184623718262
r_  generation:  0.40514159202575684
local_output_nid generation:  0.027009010314941406
local_in_edges_tensor generation:  0.02519679069519043
mini_batch_src_global generation:  0.047583818435668945
r_  generation:  0.40441226959228516
local_output_nid generation:  0.02790546417236328
local_in_edges_tensor generation:  0.02577686309814453
mini_batch_src_global generation:  0.04652714729309082
r_  generation:  0.4079258441925049
local_output_nid generation:  0.02765941619873047
local_in_edges_tensor generation:  0.027706384658813477
mini_batch_src_global generation:  0.04773259162902832
r_  generation:  0.4061906337738037
local_output_nid generation:  0.027504920959472656
local_in_edges_tensor generation:  0.03072047233581543
mini_batch_src_global generation:  0.04681539535522461
r_  generation:  0.41080379486083984
local_output_nid generation:  0.027509450912475586
local_in_edges_tensor generation:  0.025057077407836914
mini_batch_src_global generation:  0.04734516143798828
r_  generation:  0.4003734588623047
----------------------check_connections_block total spend ----------------------------- 18.995065212249756
generate_one_block  0.5276997089385986
generate_one_block  0.5125505924224854
generate_one_block  0.5398437976837158
generate_one_block  0.5278363227844238
generate_one_block  0.6194026470184326
generate_one_block  0.5313420295715332
generate_one_block  0.5278294086456299
generate_one_block  0.5312132835388184
generate_one_block  0.5207874774932861
generate_one_block  0.5228080749511719
generate_one_block  0.5412628650665283
generate_one_block  0.5233950614929199
generate_one_block  0.5385875701904297
generate_one_block  0.5326039791107178
generate_one_block  0.5339550971984863
generate_one_block  0.522951602935791
generate_one_block  0.5245652198791504
generate_one_block  0.5228683948516846
generate_one_block  0.5332911014556885
generate_one_block  0.535750150680542
generate_one_block  0.532456636428833
generate_one_block  0.5250999927520752
generate_one_block  0.5329368114471436
generate_one_block  0.5304486751556396
generate_one_block  0.5425786972045898
generate_one_block  0.5319454669952393
generate_one_block  0.540675163269043
generate_one_block  0.5251369476318359
generate_one_block  0.530545711517334
generate_one_block  0.5374698638916016
generate_one_block  0.5460009574890137
generate_one_block  0.5259075164794922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.11995315551757812  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

connection checking time:  25.391193628311157
block generation total time  22.70923376083374
average batch blocks generation time:  0.7096635550260544
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10392904281616211  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.589051246643066  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10233497619628906  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.12070083618164  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10503530502319336  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.928056240081787  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10291671752929688  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.439577579498291  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10503005981445312  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.852420330047607  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10409069061279297  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.870866775512695  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10390377044677734  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.556544780731201  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10302400588989258  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.773063659667969  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10271787643432617  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.460321426391602  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1028904914855957  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 15.514394283294678  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.1040191650390625  GigaBytes
Max Memory Allocated: 16.138062477111816  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 16.1267147064209  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7713623046875 GB
    Memory Allocated: 0.10273265838623047  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.567296504974365  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.1040201187133789  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.765256404876709  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10307645797729492  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.72327470779419  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10502338409423828  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.860143661499023  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10277795791625977  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.427875995635986  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10292387008666992  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.610689163208008  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.1027679443359375  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.465002059936523  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.1039266586303711  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.595854759216309  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10419702529907227  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 16.049408435821533  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10499191284179688  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.760162830352783  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10304403305053711  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.6719388961792  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10499954223632812  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.760654926300049  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.1032562255859375  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.74325180053711  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10395336151123047  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.641594886779785  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10402345657348633  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.944779872894287  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10396099090576172  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.980196475982666  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10270929336547852  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.524765014648438  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10500335693359375  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.787699222564697  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10402536392211914  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.826570987701416  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10385704040527344  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.895588397979736  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10293292999267578  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.593323707580566  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03793174773454666 |0.0105571448802948 |0.26339393854141235 |9.100139141082764e-05 |0.4262310639023781 |0.006034374237060547 |
----------------------------------------------------------pseudo_mini_loss sum 2.693070650100708
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  8575478
Number of first layer input nodes during this epoch:  4654710
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.11984062194824219  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0214235782623291
range selection method range initialization spend 0.016615867614746094
time for parepare:  0.020537376403808594
local_output_nid generation:  0.0008904933929443359
local_in_edges_tensor generation:  0.0065653324127197266
mini_batch_src_global generation:  0.0018062591552734375
r_  generation:  0.009903907775878906
local_output_nid generation:  0.0009512901306152344
local_in_edges_tensor generation:  0.0006804466247558594
mini_batch_src_global generation:  0.0014357566833496094
r_  generation:  0.010642290115356445
local_output_nid generation:  0.0009462833404541016
local_in_edges_tensor generation:  0.0005598068237304688
mini_batch_src_global generation:  0.0010380744934082031
r_  generation:  0.007740497589111328
local_output_nid generation:  0.0009174346923828125
local_in_edges_tensor generation:  0.0005145072937011719
mini_batch_src_global generation:  0.0010142326354980469
r_  generation:  0.007967948913574219
local_output_nid generation:  0.0008983612060546875
local_in_edges_tensor generation:  0.0005106925964355469
mini_batch_src_global generation:  0.0009207725524902344
r_  generation:  0.007826805114746094
local_output_nid generation:  0.0008282661437988281
local_in_edges_tensor generation:  0.0004968643188476562
mini_batch_src_global generation:  0.0009284019470214844
r_  generation:  0.008009672164916992
local_output_nid generation:  0.0008153915405273438
local_in_edges_tensor generation:  0.0005140304565429688
mini_batch_src_global generation:  0.0010280609130859375
r_  generation:  0.008374691009521484
local_output_nid generation:  0.00081634521484375
local_in_edges_tensor generation:  0.0004968643188476562
mini_batch_src_global generation:  0.0009186267852783203
r_  generation:  0.008229970932006836
local_output_nid generation:  0.0008320808410644531
local_in_edges_tensor generation:  0.0005025863647460938
mini_batch_src_global generation:  0.0009162425994873047
r_  generation:  0.00824284553527832
local_output_nid generation:  0.0008108615875244141
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.000896453857421875
r_  generation:  0.00813746452331543
local_output_nid generation:  0.0008141994476318359
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.0009131431579589844
r_  generation:  0.008374214172363281
local_output_nid generation:  0.0008046627044677734
local_in_edges_tensor generation:  0.0005288124084472656
mini_batch_src_global generation:  0.0009174346923828125
r_  generation:  0.008254528045654297
local_output_nid generation:  0.0008091926574707031
local_in_edges_tensor generation:  0.0005481243133544922
mini_batch_src_global generation:  0.0008976459503173828
r_  generation:  0.007999420166015625
local_output_nid generation:  0.0008032321929931641
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.0009338855743408203
r_  generation:  0.008287668228149414
local_output_nid generation:  0.0008089542388916016
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0009236335754394531
r_  generation:  0.008381366729736328
local_output_nid generation:  0.0008151531219482422
local_in_edges_tensor generation:  0.0005290508270263672
mini_batch_src_global generation:  0.0009377002716064453
r_  generation:  0.008206605911254883
local_output_nid generation:  0.0008141994476318359
local_in_edges_tensor generation:  0.0005316734313964844
mini_batch_src_global generation:  0.0008985996246337891
r_  generation:  0.008294105529785156
local_output_nid generation:  0.0008180141448974609
local_in_edges_tensor generation:  0.000530242919921875
mini_batch_src_global generation:  0.0008897781372070312
r_  generation:  0.008061885833740234
local_output_nid generation:  0.0008208751678466797
local_in_edges_tensor generation:  0.0005214214324951172
mini_batch_src_global generation:  0.0008845329284667969
r_  generation:  0.009462356567382812
local_output_nid generation:  0.0008099079132080078
local_in_edges_tensor generation:  0.0005440711975097656
mini_batch_src_global generation:  0.0009334087371826172
r_  generation:  0.008316993713378906
local_output_nid generation:  0.0008127689361572266
local_in_edges_tensor generation:  0.0005290508270263672
mini_batch_src_global generation:  0.0009045600891113281
r_  generation:  0.008280754089355469
local_output_nid generation:  0.0008103847503662109
local_in_edges_tensor generation:  0.000537872314453125
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.008394002914428711
local_output_nid generation:  0.0007941722869873047
local_in_edges_tensor generation:  0.000530242919921875
mini_batch_src_global generation:  0.0008966922760009766
r_  generation:  0.00828099250793457
local_output_nid generation:  0.0008029937744140625
local_in_edges_tensor generation:  0.0005300045013427734
mini_batch_src_global generation:  0.0009868144989013672
r_  generation:  0.008226394653320312
local_output_nid generation:  0.0007927417755126953
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0009393692016601562
r_  generation:  0.008405923843383789
local_output_nid generation:  0.0007898807525634766
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.0009093284606933594
r_  generation:  0.008341312408447266
local_output_nid generation:  0.00078582763671875
local_in_edges_tensor generation:  0.0005242824554443359
mini_batch_src_global generation:  0.0008795261383056641
r_  generation:  0.008249282836914062
local_output_nid generation:  0.000789642333984375
local_in_edges_tensor generation:  0.0005171298980712891
mini_batch_src_global generation:  0.0008983612060546875
r_  generation:  0.008350372314453125
local_output_nid generation:  0.0008347034454345703
local_in_edges_tensor generation:  0.0005362033843994141
mini_batch_src_global generation:  0.0009052753448486328
r_  generation:  0.008306264877319336
local_output_nid generation:  0.0008025169372558594
local_in_edges_tensor generation:  0.0005335807800292969
mini_batch_src_global generation:  0.0009112358093261719
r_  generation:  0.008232831954956055
local_output_nid generation:  0.0007913112640380859
local_in_edges_tensor generation:  0.0005223751068115234
mini_batch_src_global generation:  0.0008978843688964844
r_  generation:  0.00833582878112793
local_output_nid generation:  0.0007853507995605469
local_in_edges_tensor generation:  0.0005395412445068359
mini_batch_src_global generation:  0.0009098052978515625
r_  generation:  0.008443117141723633
----------------------check_connections_block total spend ----------------------------- 0.44160008430480957
generate_one_block  0.02054429054260254
generate_one_block  0.016585826873779297
generate_one_block  0.0196530818939209
generate_one_block  0.014917850494384766
generate_one_block  0.01459956169128418
generate_one_block  0.01466989517211914
generate_one_block  0.01506662368774414
generate_one_block  0.014686346054077148
generate_one_block  0.014716386795043945
generate_one_block  0.016972780227661133
generate_one_block  0.014883041381835938
generate_one_block  0.014680624008178711
generate_one_block  0.014171600341796875
generate_one_block  0.014642000198364258
generate_one_block  0.014841079711914062
generate_one_block  0.014347314834594727
generate_one_block  0.016516923904418945
generate_one_block  0.014247655868530273
generate_one_block  0.014295578002929688
generate_one_block  0.014846324920654297
generate_one_block  0.014640092849731445
generate_one_block  0.014671087265014648
generate_one_block  0.014570951461791992
generate_one_block  0.01640915870666504
generate_one_block  0.015107870101928711
generate_one_block  0.014866113662719727
generate_one_block  0.014545679092407227
generate_one_block  0.014676094055175781
generate_one_block  0.014422178268432617
generate_one_block  0.014529705047607422
generate_one_block  0.017414093017578125
generate_one_block  0.014925718307495117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03773808479309082
gen group dst list time:  0.02378702163696289
time for parepare:  0.02649378776550293
local_output_nid generation:  0.005106925964355469
local_in_edges_tensor generation:  0.017184734344482422
mini_batch_src_global generation:  0.014302730560302734
r_  generation:  0.12327265739440918
local_output_nid generation:  0.006539583206176758
local_in_edges_tensor generation:  0.008745431900024414
mini_batch_src_global generation:  0.01917099952697754
r_  generation:  0.13150429725646973
local_output_nid generation:  0.008055925369262695
local_in_edges_tensor generation:  0.030886173248291016
mini_batch_src_global generation:  0.0160977840423584
r_  generation:  0.12732601165771484
local_output_nid generation:  0.0068166255950927734
local_in_edges_tensor generation:  0.007837057113647461
mini_batch_src_global generation:  0.024100303649902344
r_  generation:  0.13065266609191895
local_output_nid generation:  0.007125377655029297
local_in_edges_tensor generation:  0.007284641265869141
mini_batch_src_global generation:  0.014632940292358398
r_  generation:  0.13235187530517578
local_output_nid generation:  0.007052898406982422
local_in_edges_tensor generation:  0.0074231624603271484
mini_batch_src_global generation:  0.01556539535522461
r_  generation:  0.13443732261657715
local_output_nid generation:  0.007409334182739258
local_in_edges_tensor generation:  0.007993459701538086
mini_batch_src_global generation:  0.0158536434173584
r_  generation:  0.176727294921875
local_output_nid generation:  0.009928703308105469
local_in_edges_tensor generation:  0.008311986923217773
mini_batch_src_global generation:  0.018799304962158203
r_  generation:  0.13824677467346191
local_output_nid generation:  0.007416248321533203
local_in_edges_tensor generation:  0.007562398910522461
mini_batch_src_global generation:  0.01625680923461914
r_  generation:  0.1394054889678955
local_output_nid generation:  0.0072174072265625
local_in_edges_tensor generation:  0.0075032711029052734
mini_batch_src_global generation:  0.015819549560546875
r_  generation:  0.135847806930542
local_output_nid generation:  0.007736682891845703
local_in_edges_tensor generation:  0.007578849792480469
mini_batch_src_global generation:  0.016932010650634766
r_  generation:  0.14147543907165527
local_output_nid generation:  0.007652997970581055
local_in_edges_tensor generation:  0.006958723068237305
mini_batch_src_global generation:  0.016011714935302734
r_  generation:  0.1388847827911377
local_output_nid generation:  0.0076406002044677734
local_in_edges_tensor generation:  0.007355928421020508
mini_batch_src_global generation:  0.015565633773803711
r_  generation:  0.1308448314666748
local_output_nid generation:  0.007748126983642578
local_in_edges_tensor generation:  0.007144927978515625
mini_batch_src_global generation:  0.01724839210510254
r_  generation:  0.13528966903686523
local_output_nid generation:  0.007927656173706055
local_in_edges_tensor generation:  0.0084381103515625
mini_batch_src_global generation:  0.017206907272338867
r_  generation:  0.1401660442352295
local_output_nid generation:  0.007805585861206055
local_in_edges_tensor generation:  0.007182121276855469
mini_batch_src_global generation:  0.01603555679321289
r_  generation:  0.13434886932373047
local_output_nid generation:  0.007964849472045898
local_in_edges_tensor generation:  0.007831096649169922
mini_batch_src_global generation:  0.01684713363647461
r_  generation:  0.13946318626403809
local_output_nid generation:  0.007727622985839844
local_in_edges_tensor generation:  0.0070459842681884766
mini_batch_src_global generation:  0.01617288589477539
r_  generation:  0.13428139686584473
local_output_nid generation:  0.0077168941497802734
local_in_edges_tensor generation:  0.007417201995849609
mini_batch_src_global generation:  0.015741586685180664
r_  generation:  0.13611745834350586
local_output_nid generation:  0.007813215255737305
local_in_edges_tensor generation:  0.0072824954986572266
mini_batch_src_global generation:  0.01625657081604004
r_  generation:  0.13843750953674316
local_output_nid generation:  0.007916450500488281
local_in_edges_tensor generation:  0.007315635681152344
mini_batch_src_global generation:  0.0159914493560791
r_  generation:  0.13788723945617676
local_output_nid generation:  0.00795125961303711
local_in_edges_tensor generation:  0.007799625396728516
mini_batch_src_global generation:  0.016547679901123047
r_  generation:  0.1723649501800537
local_output_nid generation:  0.007910013198852539
local_in_edges_tensor generation:  0.009770393371582031
mini_batch_src_global generation:  0.016323566436767578
r_  generation:  0.16660475730895996
local_output_nid generation:  0.007893085479736328
local_in_edges_tensor generation:  0.008035421371459961
mini_batch_src_global generation:  0.016751527786254883
r_  generation:  0.13950467109680176
local_output_nid generation:  0.008119821548461914
local_in_edges_tensor generation:  0.007406711578369141
mini_batch_src_global generation:  0.0165097713470459
r_  generation:  0.14522671699523926
local_output_nid generation:  0.008138179779052734
local_in_edges_tensor generation:  0.008064508438110352
mini_batch_src_global generation:  0.016878604888916016
r_  generation:  0.14346671104431152
local_output_nid generation:  0.008836984634399414
local_in_edges_tensor generation:  0.007747173309326172
mini_batch_src_global generation:  0.016295671463012695
r_  generation:  0.14317798614501953
local_output_nid generation:  0.00810384750366211
local_in_edges_tensor generation:  0.01053166389465332
mini_batch_src_global generation:  0.017127037048339844
r_  generation:  0.13962626457214355
local_output_nid generation:  0.007914543151855469
local_in_edges_tensor generation:  0.00892949104309082
mini_batch_src_global generation:  0.0162200927734375
r_  generation:  0.13891172409057617
local_output_nid generation:  0.007967472076416016
local_in_edges_tensor generation:  0.0072841644287109375
mini_batch_src_global generation:  0.016242027282714844
r_  generation:  0.14810609817504883
local_output_nid generation:  0.010348081588745117
local_in_edges_tensor generation:  0.008207082748413086
mini_batch_src_global generation:  0.018908977508544922
r_  generation:  0.14229083061218262
local_output_nid generation:  0.008316755294799805
local_in_edges_tensor generation:  0.007955074310302734
mini_batch_src_global generation:  0.017069578170776367
r_  generation:  0.14165067672729492
----------------------check_connections_block total spend ----------------------------- 6.652843952178955
generate_one_block  0.18400907516479492
generate_one_block  0.16973352432250977
generate_one_block  0.1696929931640625
generate_one_block  0.16972041130065918
generate_one_block  0.18314456939697266
generate_one_block  0.17500591278076172
generate_one_block  0.17850780487060547
generate_one_block  0.17945146560668945
generate_one_block  0.18367481231689453
generate_one_block  0.18857932090759277
generate_one_block  0.18224883079528809
generate_one_block  0.17299103736877441
generate_one_block  0.16783714294433594
generate_one_block  0.17690205574035645
generate_one_block  0.1858212947845459
generate_one_block  0.17378568649291992
generate_one_block  0.18004107475280762
generate_one_block  0.17390084266662598
generate_one_block  0.17452263832092285
generate_one_block  0.20586228370666504
generate_one_block  0.18092560768127441
generate_one_block  0.17319655418395996
generate_one_block  0.17724347114562988
generate_one_block  0.1773386001586914
generate_one_block  0.18156099319458008
generate_one_block  0.18291759490966797
generate_one_block  0.17720413208007812
generate_one_block  0.17908501625061035
generate_one_block  0.17315196990966797
generate_one_block  0.1773068904876709
generate_one_block  0.18560171127319336
generate_one_block  0.18306565284729004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04222226142883301
gen group dst list time:  0.1086111068725586
time for parepare:  0.018482208251953125
local_output_nid generation:  0.022379398345947266
local_in_edges_tensor generation:  0.0449371337890625
mini_batch_src_global generation:  0.03682136535644531
r_  generation:  0.38703489303588867
local_output_nid generation:  0.027719497680664062
local_in_edges_tensor generation:  0.033641815185546875
mini_batch_src_global generation:  0.04635882377624512
r_  generation:  0.39446353912353516
local_output_nid generation:  0.02815556526184082
local_in_edges_tensor generation:  0.026208877563476562
mini_batch_src_global generation:  0.0455935001373291
r_  generation:  0.39699602127075195
local_output_nid generation:  0.02757120132446289
local_in_edges_tensor generation:  0.02526235580444336
mini_batch_src_global generation:  0.04676032066345215
r_  generation:  0.39255595207214355
local_output_nid generation:  0.02713799476623535
local_in_edges_tensor generation:  0.026369333267211914
mini_batch_src_global generation:  0.048058509826660156
r_  generation:  0.40079212188720703
local_output_nid generation:  0.026190757751464844
local_in_edges_tensor generation:  0.025934934616088867
mini_batch_src_global generation:  0.04951620101928711
r_  generation:  0.3978006839752197
local_output_nid generation:  0.026366472244262695
local_in_edges_tensor generation:  0.03278064727783203
mini_batch_src_global generation:  0.046535491943359375
r_  generation:  0.40605998039245605
local_output_nid generation:  0.026332616806030273
local_in_edges_tensor generation:  0.026227235794067383
mini_batch_src_global generation:  0.04792213439941406
r_  generation:  0.4104001522064209
local_output_nid generation:  0.026700735092163086
local_in_edges_tensor generation:  0.028861284255981445
mini_batch_src_global generation:  0.04863119125366211
r_  generation:  0.4117307662963867
local_output_nid generation:  0.029349327087402344
local_in_edges_tensor generation:  0.02538609504699707
mini_batch_src_global generation:  0.04851865768432617
r_  generation:  0.399151086807251
local_output_nid generation:  0.026671648025512695
local_in_edges_tensor generation:  0.025110960006713867
mini_batch_src_global generation:  0.04849100112915039
r_  generation:  0.40881967544555664
local_output_nid generation:  0.026490449905395508
local_in_edges_tensor generation:  0.03130316734313965
mini_batch_src_global generation:  0.0482935905456543
r_  generation:  0.3996603488922119
local_output_nid generation:  0.026089191436767578
local_in_edges_tensor generation:  0.02637648582458496
mini_batch_src_global generation:  0.054004669189453125
r_  generation:  0.400301456451416
local_output_nid generation:  0.026183128356933594
local_in_edges_tensor generation:  0.028630971908569336
mini_batch_src_global generation:  0.05311942100524902
r_  generation:  0.40185976028442383
local_output_nid generation:  0.026233911514282227
local_in_edges_tensor generation:  0.027847766876220703
mini_batch_src_global generation:  0.05086708068847656
r_  generation:  0.40893030166625977
local_output_nid generation:  0.026642799377441406
local_in_edges_tensor generation:  0.03025054931640625
mini_batch_src_global generation:  0.049581050872802734
r_  generation:  0.39902353286743164
local_output_nid generation:  0.026987075805664062
local_in_edges_tensor generation:  0.028675556182861328
mini_batch_src_global generation:  0.048682451248168945
r_  generation:  0.40970826148986816
local_output_nid generation:  0.027268648147583008
local_in_edges_tensor generation:  0.02409648895263672
mini_batch_src_global generation:  0.049402713775634766
r_  generation:  0.395108699798584
local_output_nid generation:  0.026040315628051758
local_in_edges_tensor generation:  0.02565908432006836
mini_batch_src_global generation:  0.04550957679748535
r_  generation:  0.40085434913635254
local_output_nid generation:  0.026261329650878906
local_in_edges_tensor generation:  0.02398085594177246
mini_batch_src_global generation:  0.04743671417236328
r_  generation:  0.41361522674560547
local_output_nid generation:  0.02940988540649414
local_in_edges_tensor generation:  0.02753424644470215
mini_batch_src_global generation:  0.0490269660949707
r_  generation:  0.4050252437591553
local_output_nid generation:  0.026833057403564453
local_in_edges_tensor generation:  0.026619434356689453
mini_batch_src_global generation:  0.047888994216918945
r_  generation:  0.39784932136535645
local_output_nid generation:  0.02688145637512207
local_in_edges_tensor generation:  0.024662494659423828
mini_batch_src_global generation:  0.04658913612365723
r_  generation:  0.4031972885131836
local_output_nid generation:  0.027192354202270508
local_in_edges_tensor generation:  0.02405691146850586
mini_batch_src_global generation:  0.04929494857788086
r_  generation:  0.39658594131469727
local_output_nid generation:  0.02722787857055664
local_in_edges_tensor generation:  0.024726152420043945
mini_batch_src_global generation:  0.046530723571777344
r_  generation:  0.40276670455932617
local_output_nid generation:  0.027462244033813477
local_in_edges_tensor generation:  0.02814769744873047
mini_batch_src_global generation:  0.04854154586791992
r_  generation:  0.40110087394714355
local_output_nid generation:  0.027220726013183594
local_in_edges_tensor generation:  0.026297330856323242
mini_batch_src_global generation:  0.04661893844604492
r_  generation:  0.4033660888671875
local_output_nid generation:  0.027294158935546875
local_in_edges_tensor generation:  0.02627873420715332
mini_batch_src_global generation:  0.048264503479003906
r_  generation:  0.40021300315856934
local_output_nid generation:  0.027237892150878906
local_in_edges_tensor generation:  0.026299238204956055
mini_batch_src_global generation:  0.04661846160888672
r_  generation:  0.41503453254699707
local_output_nid generation:  0.02722454071044922
local_in_edges_tensor generation:  0.02431511878967285
mini_batch_src_global generation:  0.04844212532043457
r_  generation:  0.3961491584777832
local_output_nid generation:  0.0272979736328125
local_in_edges_tensor generation:  0.0250394344329834
mini_batch_src_global generation:  0.04852938652038574
r_  generation:  0.40437960624694824
local_output_nid generation:  0.02755141258239746
local_in_edges_tensor generation:  0.02794647216796875
mini_batch_src_global generation:  0.04899477958679199
r_  generation:  0.4043548107147217
----------------------check_connections_block total spend ----------------------------- 19.004709482192993
generate_one_block  0.5393304824829102
generate_one_block  0.5209610462188721
generate_one_block  0.5323734283447266
generate_one_block  0.5247106552124023
generate_one_block  0.6235988140106201
generate_one_block  0.5400705337524414
generate_one_block  0.5323419570922852
generate_one_block  0.5303921699523926
generate_one_block  0.5410733222961426
generate_one_block  0.5324225425720215
generate_one_block  0.5324928760528564
generate_one_block  0.5352077484130859
generate_one_block  0.526369571685791
generate_one_block  0.5272805690765381
generate_one_block  0.5400559902191162
generate_one_block  0.5331354141235352
generate_one_block  0.5367670059204102
generate_one_block  0.5258479118347168
generate_one_block  0.5258898735046387
generate_one_block  0.5304627418518066
generate_one_block  0.534191370010376
generate_one_block  0.5421183109283447
generate_one_block  0.5266687870025635
generate_one_block  0.5361027717590332
generate_one_block  0.5508792400360107
generate_one_block  0.5372216701507568
generate_one_block  0.536041259765625
generate_one_block  0.5337300300598145
generate_one_block  0.532170295715332
generate_one_block  0.5253517627716064
generate_one_block  0.5387325286865234
generate_one_block  0.5539867877960205
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.11984062194824219  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

connection checking time:  25.65755343437195
block generation total time  22.902010440826416
average batch blocks generation time:  0.7156878262758255
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10288000106811523  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.590301036834717  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10292530059814453  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.45322322845459  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10286664962768555  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.459948062896729  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10270500183105469  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.452050685882568  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10387611389160156  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.556257724761963  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10313749313354492  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.75905179977417  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.1050257682800293  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.80682373046875  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.1040639877319336  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.87669563293457  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10502862930297852  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.97373342514038  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.1029052734375  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.597223281860352  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10503292083740234  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.876830101013184  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10303401947021484  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.578768253326416  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10266923904418945  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.221105098724365  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10303258895874023  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.626895427703857  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10401725769042969  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 16.026782512664795  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10306549072265625  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.594359397888184  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.1050262451171875  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.909762382507324  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10285043716430664  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.479524612426758  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10260915756225586  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.483273983001709  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10295820236206055  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.619484901428223  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.1039876937866211  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.679781436920166  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10321044921875  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.723286628723145  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10281991958618164  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.704421520233154  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10295343399047852  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.741328716278076  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10389947891235352  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.853175163269043  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10402631759643555  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.935227394104004  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10402393341064453  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.771725177764893  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10314273834228516  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.74687671661377  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10396957397460938  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.670405387878418  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10297155380249023  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.646843910217285  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10397529602050781  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.902433395385742  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10420656204223633  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.971796035766602  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03250498324632645 |0.009724386036396027 |0.2676023170351982 |9.576231241226196e-05 |0.43019920587539673 |0.00557255744934082 |
----------------------------------------------------------pseudo_mini_loss sum 2.3109283447265625
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  8576550
Number of first layer input nodes during this epoch:  4655164
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.12208414077758789  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0203857421875
range selection method range initialization spend 0.01358342170715332
time for parepare:  0.01899409294128418
local_output_nid generation:  0.0008945465087890625
local_in_edges_tensor generation:  0.006232023239135742
mini_batch_src_global generation:  0.0013427734375
r_  generation:  0.010521888732910156
local_output_nid generation:  0.000949859619140625
local_in_edges_tensor generation:  0.0006914138793945312
mini_batch_src_global generation:  0.0011954307556152344
r_  generation:  0.008346080780029297
local_output_nid generation:  0.0008981227874755859
local_in_edges_tensor generation:  0.0005948543548583984
mini_batch_src_global generation:  0.0009827613830566406
r_  generation:  0.008112907409667969
local_output_nid generation:  0.0008971691131591797
local_in_edges_tensor generation:  0.0006496906280517578
mini_batch_src_global generation:  0.0009655952453613281
r_  generation:  0.00830078125
local_output_nid generation:  0.0008797645568847656
local_in_edges_tensor generation:  0.0005917549133300781
mini_batch_src_global generation:  0.0008885860443115234
r_  generation:  0.007975578308105469
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0006153583526611328
mini_batch_src_global generation:  0.0008559226989746094
r_  generation:  0.007872343063354492
local_output_nid generation:  0.0008146762847900391
local_in_edges_tensor generation:  0.0004892349243164062
mini_batch_src_global generation:  0.0008857250213623047
r_  generation:  0.008230924606323242
local_output_nid generation:  0.0008015632629394531
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0008361339569091797
r_  generation:  0.007866859436035156
local_output_nid generation:  0.0008103847503662109
local_in_edges_tensor generation:  0.0005009174346923828
mini_batch_src_global generation:  0.0009167194366455078
r_  generation:  0.011681795120239258
local_output_nid generation:  0.0008106231689453125
local_in_edges_tensor generation:  0.0006041526794433594
mini_batch_src_global generation:  0.0009324550628662109
r_  generation:  0.008323431015014648
local_output_nid generation:  0.0008089542388916016
local_in_edges_tensor generation:  0.0005409717559814453
mini_batch_src_global generation:  0.0009260177612304688
r_  generation:  0.00845479965209961
local_output_nid generation:  0.0008044242858886719
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.0009069442749023438
r_  generation:  0.008159637451171875
local_output_nid generation:  0.0008029937744140625
local_in_edges_tensor generation:  0.0005259513854980469
mini_batch_src_global generation:  0.0009000301361083984
r_  generation:  0.007976055145263672
local_output_nid generation:  0.0008015632629394531
local_in_edges_tensor generation:  0.00048828125
mini_batch_src_global generation:  0.0009052753448486328
r_  generation:  0.00841069221496582
local_output_nid generation:  0.0008115768432617188
local_in_edges_tensor generation:  0.0006115436553955078
mini_batch_src_global generation:  0.0008838176727294922
r_  generation:  0.007898092269897461
local_output_nid generation:  0.0008022785186767578
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0008702278137207031
r_  generation:  0.008249044418334961
local_output_nid generation:  0.0008039474487304688
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.0009160041809082031
r_  generation:  0.008435726165771484
local_output_nid generation:  0.0007963180541992188
local_in_edges_tensor generation:  0.0004799365997314453
mini_batch_src_global generation:  0.0008742809295654297
r_  generation:  0.008932828903198242
local_output_nid generation:  0.0008399486541748047
local_in_edges_tensor generation:  0.000499725341796875
mini_batch_src_global generation:  0.0008828639984130859
r_  generation:  0.008260488510131836
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.0008723735809326172
r_  generation:  0.008035898208618164
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0005762577056884766
mini_batch_src_global generation:  0.0008764266967773438
r_  generation:  0.008087396621704102
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.000484466552734375
mini_batch_src_global generation:  0.0008487701416015625
r_  generation:  0.008122920989990234
local_output_nid generation:  0.0008563995361328125
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.0009160041809082031
r_  generation:  0.008626222610473633
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.0005481243133544922
mini_batch_src_global generation:  0.0009238719940185547
r_  generation:  0.008628606796264648
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0005297660827636719
mini_batch_src_global generation:  0.0009138584136962891
r_  generation:  0.00854039192199707
local_output_nid generation:  0.0008497238159179688
local_in_edges_tensor generation:  0.0004899501800537109
mini_batch_src_global generation:  0.0009016990661621094
r_  generation:  0.009329795837402344
local_output_nid generation:  0.0008533000946044922
local_in_edges_tensor generation:  0.0005650520324707031
mini_batch_src_global generation:  0.0009593963623046875
r_  generation:  0.008389949798583984
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.00048279762268066406
mini_batch_src_global generation:  0.00089263916015625
r_  generation:  0.008268594741821289
local_output_nid generation:  0.0008494853973388672
local_in_edges_tensor generation:  0.0004885196685791016
mini_batch_src_global generation:  0.0008645057678222656
r_  generation:  0.008179426193237305
local_output_nid generation:  0.0008516311645507812
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0008699893951416016
r_  generation:  0.008034944534301758
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0004942417144775391
mini_batch_src_global generation:  0.0008955001831054688
r_  generation:  0.008444070816040039
local_output_nid generation:  0.0008499622344970703
local_in_edges_tensor generation:  0.0005447864532470703
mini_batch_src_global generation:  0.0009262561798095703
r_  generation:  0.008485078811645508
----------------------check_connections_block total spend ----------------------------- 0.44264864921569824
generate_one_block  0.017011165618896484
generate_one_block  0.01869654655456543
generate_one_block  0.015033483505249023
generate_one_block  0.015214920043945312
generate_one_block  0.014580249786376953
generate_one_block  0.014102935791015625
generate_one_block  0.014733314514160156
generate_one_block  0.014077186584472656
generate_one_block  0.015131235122680664
generate_one_block  0.014877080917358398
generate_one_block  0.014999628067016602
generate_one_block  0.01455998420715332
generate_one_block  0.014186620712280273
generate_one_block  0.014731168746948242
generate_one_block  0.016542911529541016
generate_one_block  0.01815962791442871
generate_one_block  0.014868736267089844
generate_one_block  0.014589309692382812
generate_one_block  0.014441490173339844
generate_one_block  0.014045238494873047
generate_one_block  0.01407003402709961
generate_one_block  0.014033079147338867
generate_one_block  0.01501917839050293
generate_one_block  0.014816761016845703
generate_one_block  0.014665603637695312
generate_one_block  0.014392614364624023
generate_one_block  0.014725685119628906
generate_one_block  0.014333486557006836
generate_one_block  0.016781330108642578
generate_one_block  0.01768207550048828
generate_one_block  0.014638423919677734
generate_one_block  0.01494908332824707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03445720672607422
gen group dst list time:  0.021459579467773438
time for parepare:  0.021865129470825195
local_output_nid generation:  0.004991054534912109
local_in_edges_tensor generation:  0.022944927215576172
mini_batch_src_global generation:  0.01598811149597168
r_  generation:  0.12686395645141602
local_output_nid generation:  0.00982522964477539
local_in_edges_tensor generation:  0.0113677978515625
mini_batch_src_global generation:  0.015822172164916992
r_  generation:  0.1273362636566162
local_output_nid generation:  0.011063814163208008
local_in_edges_tensor generation:  0.03647971153259277
mini_batch_src_global generation:  0.01433563232421875
r_  generation:  0.14853119850158691
local_output_nid generation:  0.01101541519165039
local_in_edges_tensor generation:  0.010215520858764648
mini_batch_src_global generation:  0.01739978790283203
r_  generation:  0.1446983814239502
local_output_nid generation:  0.00915980339050293
local_in_edges_tensor generation:  0.007569789886474609
mini_batch_src_global generation:  0.01726388931274414
r_  generation:  0.14111852645874023
local_output_nid generation:  0.011885881423950195
local_in_edges_tensor generation:  0.008402585983276367
mini_batch_src_global generation:  0.02147960662841797
r_  generation:  0.1394345760345459
local_output_nid generation:  0.00847315788269043
local_in_edges_tensor generation:  0.007163286209106445
mini_batch_src_global generation:  0.021257400512695312
r_  generation:  0.1498258113861084
local_output_nid generation:  0.008257150650024414
local_in_edges_tensor generation:  0.006980419158935547
mini_batch_src_global generation:  0.018303871154785156
r_  generation:  0.1423780918121338
local_output_nid generation:  0.007752180099487305
local_in_edges_tensor generation:  0.007907390594482422
mini_batch_src_global generation:  0.01973128318786621
r_  generation:  0.15372419357299805
local_output_nid generation:  0.0077288150787353516
local_in_edges_tensor generation:  0.008929014205932617
mini_batch_src_global generation:  0.01911759376525879
r_  generation:  0.15334701538085938
local_output_nid generation:  0.008481502532958984
local_in_edges_tensor generation:  0.00792074203491211
mini_batch_src_global generation:  0.020979881286621094
r_  generation:  0.15608811378479004
local_output_nid generation:  0.008225202560424805
local_in_edges_tensor generation:  0.008466720581054688
mini_batch_src_global generation:  0.019618749618530273
r_  generation:  0.14779877662658691
local_output_nid generation:  0.008111000061035156
local_in_edges_tensor generation:  0.008389949798583984
mini_batch_src_global generation:  0.018384933471679688
r_  generation:  0.14781665802001953
local_output_nid generation:  0.008370637893676758
local_in_edges_tensor generation:  0.00943756103515625
mini_batch_src_global generation:  0.01931309700012207
r_  generation:  0.15539073944091797
local_output_nid generation:  0.008076906204223633
local_in_edges_tensor generation:  0.007479667663574219
mini_batch_src_global generation:  0.0188138484954834
r_  generation:  0.14932680130004883
local_output_nid generation:  0.008360624313354492
local_in_edges_tensor generation:  0.011507987976074219
mini_batch_src_global generation:  0.01993250846862793
r_  generation:  0.1662764549255371
local_output_nid generation:  0.008321523666381836
local_in_edges_tensor generation:  0.00902557373046875
mini_batch_src_global generation:  0.01938629150390625
r_  generation:  0.1755533218383789
local_output_nid generation:  0.008378267288208008
local_in_edges_tensor generation:  0.00872349739074707
mini_batch_src_global generation:  0.019235849380493164
r_  generation:  0.1843273639678955
local_output_nid generation:  0.008189916610717773
local_in_edges_tensor generation:  0.007754087448120117
mini_batch_src_global generation:  0.020137310028076172
r_  generation:  0.15032362937927246
local_output_nid generation:  0.008267641067504883
local_in_edges_tensor generation:  0.007645845413208008
mini_batch_src_global generation:  0.018780946731567383
r_  generation:  0.14866971969604492
local_output_nid generation:  0.008024930953979492
local_in_edges_tensor generation:  0.008183717727661133
mini_batch_src_global generation:  0.018929719924926758
r_  generation:  0.14899778366088867
local_output_nid generation:  0.008684873580932617
local_in_edges_tensor generation:  0.009578943252563477
mini_batch_src_global generation:  0.019047975540161133
r_  generation:  0.14827322959899902
local_output_nid generation:  0.008559465408325195
local_in_edges_tensor generation:  0.008195638656616211
mini_batch_src_global generation:  0.0198061466217041
r_  generation:  0.15807867050170898
local_output_nid generation:  0.00963592529296875
local_in_edges_tensor generation:  0.00824737548828125
mini_batch_src_global generation:  0.01951003074645996
r_  generation:  0.1528770923614502
local_output_nid generation:  0.008647918701171875
local_in_edges_tensor generation:  0.008223533630371094
mini_batch_src_global generation:  0.01994037628173828
r_  generation:  0.15335416793823242
local_output_nid generation:  0.008587360382080078
local_in_edges_tensor generation:  0.007929563522338867
mini_batch_src_global generation:  0.019942283630371094
r_  generation:  0.15111351013183594
local_output_nid generation:  0.008850336074829102
local_in_edges_tensor generation:  0.0076465606689453125
mini_batch_src_global generation:  0.02008533477783203
r_  generation:  0.15622949600219727
local_output_nid generation:  0.008664369583129883
local_in_edges_tensor generation:  0.007846832275390625
mini_batch_src_global generation:  0.02035236358642578
r_  generation:  0.15046429634094238
local_output_nid generation:  0.008581161499023438
local_in_edges_tensor generation:  0.0072116851806640625
mini_batch_src_global generation:  0.019245624542236328
r_  generation:  0.1495978832244873
local_output_nid generation:  0.008586645126342773
local_in_edges_tensor generation:  0.007658958435058594
mini_batch_src_global generation:  0.01902484893798828
r_  generation:  0.14690184593200684
local_output_nid generation:  0.00870370864868164
local_in_edges_tensor generation:  0.007460832595825195
mini_batch_src_global generation:  0.019512653350830078
r_  generation:  0.15276098251342773
local_output_nid generation:  0.008733272552490234
local_in_edges_tensor generation:  0.00901174545288086
mini_batch_src_global generation:  0.01964402198791504
r_  generation:  0.15467524528503418
----------------------check_connections_block total spend ----------------------------- 7.208963632583618
generate_one_block  0.18449878692626953
generate_one_block  0.18244600296020508
generate_one_block  0.1772310733795166
generate_one_block  0.18274259567260742
generate_one_block  0.1913621425628662
generate_one_block  0.16691136360168457
generate_one_block  0.18063139915466309
generate_one_block  0.17063260078430176
generate_one_block  0.18308782577514648
generate_one_block  0.18245220184326172
generate_one_block  0.18508601188659668
generate_one_block  0.1740260124206543
generate_one_block  0.17280197143554688
generate_one_block  0.18172836303710938
generate_one_block  0.17005491256713867
generate_one_block  0.17846107482910156
generate_one_block  0.17993903160095215
generate_one_block  0.18049335479736328
generate_one_block  0.17586350440979004
generate_one_block  0.20221710205078125
generate_one_block  0.17060279846191406
generate_one_block  0.17637896537780762
generate_one_block  0.18452787399291992
generate_one_block  0.17880487442016602
generate_one_block  0.17940187454223633
generate_one_block  0.17522478103637695
generate_one_block  0.1895146369934082
generate_one_block  0.17371439933776855
generate_one_block  0.17182421684265137
generate_one_block  0.16975665092468262
generate_one_block  0.17712163925170898
generate_one_block  0.17909812927246094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036598920822143555
gen group dst list time:  0.1051030158996582
time for parepare:  0.01994180679321289
local_output_nid generation:  0.02226853370666504
local_in_edges_tensor generation:  0.04004549980163574
mini_batch_src_global generation:  0.03629660606384277
r_  generation:  0.39151549339294434
local_output_nid generation:  0.02750396728515625
local_in_edges_tensor generation:  0.03155684471130371
mini_batch_src_global generation:  0.04658317565917969
r_  generation:  0.38770318031311035
local_output_nid generation:  0.027997732162475586
local_in_edges_tensor generation:  0.026215553283691406
mini_batch_src_global generation:  0.04555773735046387
r_  generation:  0.40471816062927246
local_output_nid generation:  0.028296709060668945
local_in_edges_tensor generation:  0.026585102081298828
mini_batch_src_global generation:  0.048256874084472656
r_  generation:  0.40171074867248535
local_output_nid generation:  0.028040647506713867
local_in_edges_tensor generation:  0.02655482292175293
mini_batch_src_global generation:  0.04665994644165039
r_  generation:  0.40613460540771484
local_output_nid generation:  0.027077913284301758
local_in_edges_tensor generation:  0.028194904327392578
mini_batch_src_global generation:  0.047612905502319336
r_  generation:  0.3941953182220459
local_output_nid generation:  0.02652716636657715
local_in_edges_tensor generation:  0.027359962463378906
mini_batch_src_global generation:  0.04727315902709961
r_  generation:  0.4063122272491455
local_output_nid generation:  0.028122425079345703
local_in_edges_tensor generation:  0.029964685440063477
mini_batch_src_global generation:  0.05198073387145996
r_  generation:  0.3983042240142822
local_output_nid generation:  0.026654958724975586
local_in_edges_tensor generation:  0.02756476402282715
mini_batch_src_global generation:  0.04829597473144531
r_  generation:  0.41149187088012695
local_output_nid generation:  0.029558420181274414
local_in_edges_tensor generation:  0.026320219039916992
mini_batch_src_global generation:  0.04843473434448242
r_  generation:  0.4084470272064209
local_output_nid generation:  0.026787281036376953
local_in_edges_tensor generation:  0.02904510498046875
mini_batch_src_global generation:  0.04745221138000488
r_  generation:  0.4150712490081787
local_output_nid generation:  0.026476383209228516
local_in_edges_tensor generation:  0.030651092529296875
mini_batch_src_global generation:  0.050192832946777344
r_  generation:  0.3959767818450928
local_output_nid generation:  0.026587724685668945
local_in_edges_tensor generation:  0.024265527725219727
mini_batch_src_global generation:  0.04693603515625
r_  generation:  0.4034707546234131
local_output_nid generation:  0.026657819747924805
local_in_edges_tensor generation:  0.024292945861816406
mini_batch_src_global generation:  0.049710988998413086
r_  generation:  0.41817426681518555
local_output_nid generation:  0.027275562286376953
local_in_edges_tensor generation:  0.024053335189819336
mini_batch_src_global generation:  0.04712200164794922
r_  generation:  0.40664005279541016
local_output_nid generation:  0.028650999069213867
local_in_edges_tensor generation:  0.025090456008911133
mini_batch_src_global generation:  0.049602508544921875
r_  generation:  0.40163493156433105
local_output_nid generation:  0.027369260787963867
local_in_edges_tensor generation:  0.024731874465942383
mini_batch_src_global generation:  0.046810150146484375
r_  generation:  0.4053211212158203
local_output_nid generation:  0.027378082275390625
local_in_edges_tensor generation:  0.02652430534362793
mini_batch_src_global generation:  0.04959416389465332
r_  generation:  0.39940619468688965
local_output_nid generation:  0.027164220809936523
local_in_edges_tensor generation:  0.024928569793701172
mini_batch_src_global generation:  0.04642438888549805
r_  generation:  0.4035179615020752
local_output_nid generation:  0.027385473251342773
local_in_edges_tensor generation:  0.02579808235168457
mini_batch_src_global generation:  0.049643754959106445
r_  generation:  0.3967249393463135
local_output_nid generation:  0.027363300323486328
local_in_edges_tensor generation:  0.024515628814697266
mini_batch_src_global generation:  0.04601120948791504
r_  generation:  0.4101381301879883
local_output_nid generation:  0.027291536331176758
local_in_edges_tensor generation:  0.023946285247802734
mini_batch_src_global generation:  0.047770023345947266
r_  generation:  0.40027523040771484
local_output_nid generation:  0.0280001163482666
local_in_edges_tensor generation:  0.03173089027404785
mini_batch_src_global generation:  0.04866933822631836
r_  generation:  0.40728020668029785
local_output_nid generation:  0.02759575843811035
local_in_edges_tensor generation:  0.02702808380126953
mini_batch_src_global generation:  0.048612117767333984
r_  generation:  0.4010906219482422
local_output_nid generation:  0.027451753616333008
local_in_edges_tensor generation:  0.024715662002563477
mini_batch_src_global generation:  0.04670453071594238
r_  generation:  0.40547704696655273
local_output_nid generation:  0.027471542358398438
local_in_edges_tensor generation:  0.024952173233032227
mini_batch_src_global generation:  0.047770023345947266
r_  generation:  0.3993692398071289
local_output_nid generation:  0.027574539184570312
local_in_edges_tensor generation:  0.027930021286010742
mini_batch_src_global generation:  0.04677867889404297
r_  generation:  0.41057825088500977
local_output_nid generation:  0.027646541595458984
local_in_edges_tensor generation:  0.026160001754760742
mini_batch_src_global generation:  0.04806256294250488
r_  generation:  0.4010190963745117
local_output_nid generation:  0.02711963653564453
local_in_edges_tensor generation:  0.023956298828125
mini_batch_src_global generation:  0.04600048065185547
r_  generation:  0.4035181999206543
local_output_nid generation:  0.027641773223876953
local_in_edges_tensor generation:  0.027386903762817383
mini_batch_src_global generation:  0.04800057411193848
r_  generation:  0.3989527225494385
local_output_nid generation:  0.027429580688476562
local_in_edges_tensor generation:  0.028080224990844727
mini_batch_src_global generation:  0.04706168174743652
r_  generation:  0.4084012508392334
local_output_nid generation:  0.027549028396606445
local_in_edges_tensor generation:  0.027959823608398438
mini_batch_src_global generation:  0.047672271728515625
r_  generation:  0.4038217067718506
----------------------check_connections_block total spend ----------------------------- 19.0664644241333
generate_one_block  0.5436117649078369
generate_one_block  0.5202345848083496
generate_one_block  0.5310332775115967
generate_one_block  0.5377678871154785
generate_one_block  0.6249532699584961
generate_one_block  0.5267033576965332
generate_one_block  0.5370488166809082
generate_one_block  0.5323503017425537
generate_one_block  0.5409014225006104
generate_one_block  0.5427567958831787
generate_one_block  0.5402071475982666
generate_one_block  0.5308985710144043
generate_one_block  0.5261235237121582
generate_one_block  0.5295968055725098
generate_one_block  0.5269036293029785
generate_one_block  0.5475759506225586
generate_one_block  0.5353710651397705
generate_one_block  0.5397710800170898
generate_one_block  0.5401027202606201
generate_one_block  0.525820255279541
generate_one_block  0.5231788158416748
generate_one_block  0.5333569049835205
generate_one_block  0.5512254238128662
generate_one_block  0.5426926612854004
generate_one_block  0.5494179725646973
generate_one_block  0.5304176807403564
generate_one_block  0.5431764125823975
generate_one_block  0.5321385860443115
generate_one_block  0.5327975749969482
generate_one_block  0.5309231281280518
generate_one_block  0.5575299263000488
generate_one_block  0.5325484275817871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.12208414077758789  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

connection checking time:  26.27542805671692
block generation total time  22.967773914337158
average batch blocks generation time:  0.7177429348230362
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10501575469970703  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.827787399291992  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10250091552734375  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.340516090393066  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10399150848388672  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.682116985321045  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10422563552856445  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.983551979064941  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10270166397094727  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.64898681640625  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10253143310546875  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.188408374786377  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10503101348876953  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.909274578094482  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10293197631835938  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.478249073028564  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.1050562858581543  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 16.029649257659912  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.10430097579956055  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 15.956254482269287  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7967529296875 GB
    Memory Allocated: 0.1050710678100586  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.11864709854126  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10273551940917969  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.534582138061523  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10377979278564453  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.379459381103516  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10306024551391602  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.851555824279785  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1025395393371582  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.258084774017334  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10403203964233398  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.85450029373169  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10500717163085938  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.778119564056396  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10410261154174805  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.90619707107544  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1040048599243164  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.714316368103027  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10297489166259766  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.42814826965332  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1027989387512207  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.414934635162354  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10257625579833984  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.473350524902344  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10506105422973633  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.03500747680664  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10397195816040039  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.861644268035889  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10403823852539062  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.795268058776855  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10310602188110352  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.603309154510498  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10505962371826172  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.041276454925537  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10306930541992188  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.621648788452148  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10276079177856445  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.503785610198975  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1030130386352539  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.454692363739014  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10402488708496094  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.777584552764893  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10314702987670898  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.712303638458252  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03693557530641556 |0.010002680122852325 |0.2622436434030533 |9.004771709442139e-05 |0.42878854274749756 |0.007089376449584961 |
----------------------------------------------------------pseudo_mini_loss sum 2.1287639141082764
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  8578675
Number of first layer input nodes during this epoch:  4655725
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1208491325378418  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02001047134399414
range selection method range initialization spend 0.013017654418945312
time for parepare:  0.017543554306030273
local_output_nid generation:  0.0009148120880126953
local_in_edges_tensor generation:  0.007741212844848633
mini_batch_src_global generation:  0.00127410888671875
r_  generation:  0.008900880813598633
local_output_nid generation:  0.0009262561798095703
local_in_edges_tensor generation:  0.0007345676422119141
mini_batch_src_global generation:  0.001247406005859375
r_  generation:  0.008836984634399414
local_output_nid generation:  0.0008947849273681641
local_in_edges_tensor generation:  0.0005590915679931641
mini_batch_src_global generation:  0.0010139942169189453
r_  generation:  0.008093833923339844
local_output_nid generation:  0.0008459091186523438
local_in_edges_tensor generation:  0.0006551742553710938
mini_batch_src_global generation:  0.0009429454803466797
r_  generation:  0.007913827896118164
local_output_nid generation:  0.0008373260498046875
local_in_edges_tensor generation:  0.0006144046783447266
mini_batch_src_global generation:  0.000934600830078125
r_  generation:  0.007800579071044922
local_output_nid generation:  0.0008404254913330078
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.0010209083557128906
r_  generation:  0.008035421371459961
local_output_nid generation:  0.0008220672607421875
local_in_edges_tensor generation:  0.0006430149078369141
mini_batch_src_global generation:  0.0009047985076904297
r_  generation:  0.00813913345336914
local_output_nid generation:  0.0008039474487304688
local_in_edges_tensor generation:  0.0005090236663818359
mini_batch_src_global generation:  0.0008697509765625
r_  generation:  0.00789332389831543
local_output_nid generation:  0.0008122920989990234
local_in_edges_tensor generation:  0.0005042552947998047
mini_batch_src_global generation:  0.0008769035339355469
r_  generation:  0.00809025764465332
local_output_nid generation:  0.0008161067962646484
local_in_edges_tensor generation:  0.0005228519439697266
mini_batch_src_global generation:  0.0008952617645263672
r_  generation:  0.008071184158325195
local_output_nid generation:  0.0008101463317871094
local_in_edges_tensor generation:  0.0005171298980712891
mini_batch_src_global generation:  0.0009055137634277344
r_  generation:  0.008385658264160156
local_output_nid generation:  0.0008149147033691406
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0009031295776367188
r_  generation:  0.008272886276245117
local_output_nid generation:  0.0008094310760498047
local_in_edges_tensor generation:  0.0005061626434326172
mini_batch_src_global generation:  0.0008749961853027344
r_  generation:  0.008056640625
local_output_nid generation:  0.0008106231689453125
local_in_edges_tensor generation:  0.0004971027374267578
mini_batch_src_global generation:  0.0009062290191650391
r_  generation:  0.008135795593261719
local_output_nid generation:  0.0008063316345214844
local_in_edges_tensor generation:  0.0004961490631103516
mini_batch_src_global generation:  0.0008792877197265625
r_  generation:  0.008246898651123047
local_output_nid generation:  0.0007922649383544922
local_in_edges_tensor generation:  0.0005154609680175781
mini_batch_src_global generation:  0.0009236335754394531
r_  generation:  0.008427858352661133
local_output_nid generation:  0.0008053779602050781
local_in_edges_tensor generation:  0.0005085468292236328
mini_batch_src_global generation:  0.0010385513305664062
r_  generation:  0.008367776870727539
local_output_nid generation:  0.0007958412170410156
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.0009312629699707031
r_  generation:  0.00831151008605957
local_output_nid generation:  0.0008087158203125
local_in_edges_tensor generation:  0.0005018711090087891
mini_batch_src_global generation:  0.00091552734375
r_  generation:  0.008336544036865234
local_output_nid generation:  0.0007917881011962891
local_in_edges_tensor generation:  0.0005285739898681641
mini_batch_src_global generation:  0.0009028911590576172
r_  generation:  0.008314132690429688
local_output_nid generation:  0.0007960796356201172
local_in_edges_tensor generation:  0.0004947185516357422
mini_batch_src_global generation:  0.0009520053863525391
r_  generation:  0.008254766464233398
local_output_nid generation:  0.0007991790771484375
local_in_edges_tensor generation:  0.0004971027374267578
mini_batch_src_global generation:  0.0009021759033203125
r_  generation:  0.00841212272644043
local_output_nid generation:  0.0007827281951904297
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0008821487426757812
r_  generation:  0.008150100708007812
local_output_nid generation:  0.0008003711700439453
local_in_edges_tensor generation:  0.0005166530609130859
mini_batch_src_global generation:  0.0009746551513671875
r_  generation:  0.008109092712402344
local_output_nid generation:  0.00080108642578125
local_in_edges_tensor generation:  0.0005080699920654297
mini_batch_src_global generation:  0.0009288787841796875
r_  generation:  0.008446216583251953
local_output_nid generation:  0.0007894039154052734
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0008945465087890625
r_  generation:  0.008329153060913086
local_output_nid generation:  0.0007927417755126953
local_in_edges_tensor generation:  0.000484466552734375
mini_batch_src_global generation:  0.0010104179382324219
r_  generation:  0.008427858352661133
local_output_nid generation:  0.0007939338684082031
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0009157657623291016
r_  generation:  0.008111715316772461
local_output_nid generation:  0.0007815361022949219
local_in_edges_tensor generation:  0.0004830360412597656
mini_batch_src_global generation:  0.0008869171142578125
r_  generation:  0.008313179016113281
local_output_nid generation:  0.0007789134979248047
local_in_edges_tensor generation:  0.0004901885986328125
mini_batch_src_global generation:  0.000982046127319336
r_  generation:  0.008411884307861328
local_output_nid generation:  0.0007798671722412109
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0008952617645263672
r_  generation:  0.008204936981201172
local_output_nid generation:  0.0007953643798828125
local_in_edges_tensor generation:  0.0005075931549072266
mini_batch_src_global generation:  0.0009036064147949219
r_  generation:  0.008290529251098633
----------------------check_connections_block total spend ----------------------------- 0.4304206371307373
generate_one_block  0.017248868942260742
generate_one_block  0.017680644989013672
generate_one_block  0.01500391960144043
generate_one_block  0.01470041275024414
generate_one_block  0.014335870742797852
generate_one_block  0.014409542083740234
generate_one_block  0.014441251754760742
generate_one_block  0.01405024528503418
generate_one_block  0.014410257339477539
generate_one_block  0.014305353164672852
generate_one_block  0.014573335647583008
generate_one_block  0.014642000198364258
generate_one_block  0.014252662658691406
generate_one_block  0.014176130294799805
generate_one_block  0.01424407958984375
generate_one_block  0.014555215835571289
generate_one_block  0.014618396759033203
generate_one_block  0.014451265335083008
generate_one_block  0.014472484588623047
generate_one_block  0.01443624496459961
generate_one_block  0.01449441909790039
generate_one_block  0.014634132385253906
generate_one_block  0.014405965805053711
generate_one_block  0.014072895050048828
generate_one_block  0.01485896110534668
generate_one_block  0.014548063278198242
generate_one_block  0.01467585563659668
generate_one_block  0.014001607894897461
generate_one_block  0.014528512954711914
generate_one_block  0.014594316482543945
generate_one_block  0.01434946060180664
generate_one_block  0.014388799667358398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03754115104675293
gen group dst list time:  0.01935887336730957
time for parepare:  0.019780397415161133
local_output_nid generation:  0.004769086837768555
local_in_edges_tensor generation:  0.016878604888916016
mini_batch_src_global generation:  0.013088703155517578
r_  generation:  0.12317538261413574
local_output_nid generation:  0.0067822933197021484
local_in_edges_tensor generation:  0.009351968765258789
mini_batch_src_global generation:  0.016018152236938477
r_  generation:  0.13043427467346191
local_output_nid generation:  0.006775617599487305
local_in_edges_tensor generation:  0.029388904571533203
mini_batch_src_global generation:  0.014316082000732422
r_  generation:  0.12897181510925293
local_output_nid generation:  0.007006406784057617
local_in_edges_tensor generation:  0.006996870040893555
mini_batch_src_global generation:  0.014409780502319336
r_  generation:  0.1315171718597412
local_output_nid generation:  0.0071299076080322266
local_in_edges_tensor generation:  0.008771181106567383
mini_batch_src_global generation:  0.015477418899536133
r_  generation:  0.12830805778503418
local_output_nid generation:  0.007473468780517578
local_in_edges_tensor generation:  0.007021903991699219
mini_batch_src_global generation:  0.01539301872253418
r_  generation:  0.13228368759155273
local_output_nid generation:  0.00738978385925293
local_in_edges_tensor generation:  0.007036924362182617
mini_batch_src_global generation:  0.015700578689575195
r_  generation:  0.13322091102600098
local_output_nid generation:  0.007339000701904297
local_in_edges_tensor generation:  0.007030487060546875
mini_batch_src_global generation:  0.015389680862426758
r_  generation:  0.13002967834472656
local_output_nid generation:  0.007214784622192383
local_in_edges_tensor generation:  0.007786989212036133
mini_batch_src_global generation:  0.015984773635864258
r_  generation:  0.1348559856414795
local_output_nid generation:  0.007235050201416016
local_in_edges_tensor generation:  0.0074405670166015625
mini_batch_src_global generation:  0.015944480895996094
r_  generation:  0.13377022743225098
local_output_nid generation:  0.007384538650512695
local_in_edges_tensor generation:  0.007901906967163086
mini_batch_src_global generation:  0.016966819763183594
r_  generation:  0.13744115829467773
local_output_nid generation:  0.007474660873413086
local_in_edges_tensor generation:  0.007652759552001953
mini_batch_src_global generation:  0.016356468200683594
r_  generation:  0.1376504898071289
local_output_nid generation:  0.007701396942138672
local_in_edges_tensor generation:  0.008343219757080078
mini_batch_src_global generation:  0.016045570373535156
r_  generation:  0.13490056991577148
local_output_nid generation:  0.007771492004394531
local_in_edges_tensor generation:  0.007757663726806641
mini_batch_src_global generation:  0.016156435012817383
r_  generation:  0.13496637344360352
local_output_nid generation:  0.00758814811706543
local_in_edges_tensor generation:  0.007841348648071289
mini_batch_src_global generation:  0.015700578689575195
r_  generation:  0.13559913635253906
local_output_nid generation:  0.007883787155151367
local_in_edges_tensor generation:  0.008040189743041992
mini_batch_src_global generation:  0.016420364379882812
r_  generation:  0.13743233680725098
local_output_nid generation:  0.007927656173706055
local_in_edges_tensor generation:  0.0078008174896240234
mini_batch_src_global generation:  0.016217470169067383
r_  generation:  0.1416630744934082
local_output_nid generation:  0.007704734802246094
local_in_edges_tensor generation:  0.010988950729370117
mini_batch_src_global generation:  0.016398191452026367
r_  generation:  0.13801932334899902
local_output_nid generation:  0.0077555179595947266
local_in_edges_tensor generation:  0.00796961784362793
mini_batch_src_global generation:  0.015958070755004883
r_  generation:  0.13619732856750488
local_output_nid generation:  0.007802009582519531
local_in_edges_tensor generation:  0.007970571517944336
mini_batch_src_global generation:  0.01953291893005371
r_  generation:  0.13627219200134277
local_output_nid generation:  0.007857084274291992
local_in_edges_tensor generation:  0.00792837142944336
mini_batch_src_global generation:  0.016274690628051758
r_  generation:  0.13848233222961426
local_output_nid generation:  0.007966041564941406
local_in_edges_tensor generation:  0.008005857467651367
mini_batch_src_global generation:  0.016157150268554688
r_  generation:  0.13782215118408203
local_output_nid generation:  0.007860422134399414
local_in_edges_tensor generation:  0.00726008415222168
mini_batch_src_global generation:  0.01610112190246582
r_  generation:  0.1397256851196289
local_output_nid generation:  0.007810831069946289
local_in_edges_tensor generation:  0.007383823394775391
mini_batch_src_global generation:  0.015933752059936523
r_  generation:  0.13479089736938477
local_output_nid generation:  0.00821685791015625
local_in_edges_tensor generation:  0.008644342422485352
mini_batch_src_global generation:  0.017406463623046875
r_  generation:  0.14229965209960938
local_output_nid generation:  0.007806301116943359
local_in_edges_tensor generation:  0.007243156433105469
mini_batch_src_global generation:  0.016390085220336914
r_  generation:  0.1387631893157959
local_output_nid generation:  0.008128643035888672
local_in_edges_tensor generation:  0.007537126541137695
mini_batch_src_global generation:  0.016503572463989258
r_  generation:  0.14254474639892578
local_output_nid generation:  0.007752656936645508
local_in_edges_tensor generation:  0.007437944412231445
mini_batch_src_global generation:  0.01637864112854004
r_  generation:  0.13576912879943848
local_output_nid generation:  0.007999658584594727
local_in_edges_tensor generation:  0.007509708404541016
mini_batch_src_global generation:  0.016150236129760742
r_  generation:  0.14070773124694824
local_output_nid generation:  0.007946968078613281
local_in_edges_tensor generation:  0.007718324661254883
mini_batch_src_global generation:  0.016132354736328125
r_  generation:  0.1377885341644287
local_output_nid generation:  0.00794076919555664
local_in_edges_tensor generation:  0.007925748825073242
mini_batch_src_global generation:  0.015694379806518555
r_  generation:  0.14005041122436523
local_output_nid generation:  0.008791208267211914
local_in_edges_tensor generation:  0.007826089859008789
mini_batch_src_global generation:  0.015855073928833008
r_  generation:  0.1363992691040039
----------------------check_connections_block total spend ----------------------------- 6.432760238647461
generate_one_block  0.17798161506652832
generate_one_block  0.1793508529663086
generate_one_block  0.17533326148986816
generate_one_block  0.17582440376281738
generate_one_block  0.1826953887939453
generate_one_block  0.173720121383667
generate_one_block  0.1754906177520752
generate_one_block  0.17299914360046387
generate_one_block  0.1740422248840332
generate_one_block  0.17496395111083984
generate_one_block  0.1792135238647461
generate_one_block  0.17997264862060547
generate_one_block  0.17315983772277832
generate_one_block  0.1731109619140625
generate_one_block  0.17252898216247559
generate_one_block  0.17781925201416016
generate_one_block  0.18122410774230957
generate_one_block  0.1744534969329834
generate_one_block  0.17334389686584473
generate_one_block  0.20407629013061523
generate_one_block  0.17707586288452148
generate_one_block  0.17820096015930176
generate_one_block  0.17368316650390625
generate_one_block  0.1722102165222168
generate_one_block  0.18615460395812988
generate_one_block  0.17569446563720703
generate_one_block  0.18159985542297363
generate_one_block  0.17304396629333496
generate_one_block  0.17811322212219238
generate_one_block  0.1777341365814209
generate_one_block  0.17332696914672852
generate_one_block  0.17519092559814453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031056880950927734
gen group dst list time:  0.10017919540405273
time for parepare:  0.02029871940612793
local_output_nid generation:  0.022196054458618164
local_in_edges_tensor generation:  0.044945478439331055
mini_batch_src_global generation:  0.03685927391052246
r_  generation:  0.3966665267944336
local_output_nid generation:  0.027504682540893555
local_in_edges_tensor generation:  0.03162646293640137
mini_batch_src_global generation:  0.04838824272155762
r_  generation:  0.39506077766418457
local_output_nid generation:  0.02716994285583496
local_in_edges_tensor generation:  0.03122401237487793
mini_batch_src_global generation:  0.04716372489929199
r_  generation:  0.4059319496154785
local_output_nid generation:  0.027494192123413086
local_in_edges_tensor generation:  0.028242111206054688
mini_batch_src_global generation:  0.04713177680969238
r_  generation:  0.39707446098327637
local_output_nid generation:  0.027496814727783203
local_in_edges_tensor generation:  0.02507948875427246
mini_batch_src_global generation:  0.04795193672180176
r_  generation:  0.4012451171875
local_output_nid generation:  0.027100801467895508
local_in_edges_tensor generation:  0.024097681045532227
mini_batch_src_global generation:  0.04743051528930664
r_  generation:  0.3988926410675049
local_output_nid generation:  0.025994062423706055
local_in_edges_tensor generation:  0.02384018898010254
mini_batch_src_global generation:  0.046277523040771484
r_  generation:  0.4027540683746338
local_output_nid generation:  0.025676965713500977
local_in_edges_tensor generation:  0.024355411529541016
mini_batch_src_global generation:  0.04680013656616211
r_  generation:  0.39304447174072266
local_output_nid generation:  0.026161670684814453
local_in_edges_tensor generation:  0.024213552474975586
mini_batch_src_global generation:  0.0455169677734375
r_  generation:  0.40422892570495605
local_output_nid generation:  0.025819063186645508
local_in_edges_tensor generation:  0.0243682861328125
mini_batch_src_global generation:  0.04729056358337402
r_  generation:  0.39739179611206055
local_output_nid generation:  0.02627396583557129
local_in_edges_tensor generation:  0.026087045669555664
mini_batch_src_global generation:  0.046480417251586914
r_  generation:  0.41042590141296387
local_output_nid generation:  0.026137590408325195
local_in_edges_tensor generation:  0.02627253532409668
mini_batch_src_global generation:  0.04974007606506348
r_  generation:  0.40026116371154785
local_output_nid generation:  0.025701284408569336
local_in_edges_tensor generation:  0.02476978302001953
mini_batch_src_global generation:  0.04567432403564453
r_  generation:  0.4001915454864502
local_output_nid generation:  0.0260009765625
local_in_edges_tensor generation:  0.024495363235473633
mini_batch_src_global generation:  0.047182321548461914
r_  generation:  0.39917922019958496
local_output_nid generation:  0.025811195373535156
local_in_edges_tensor generation:  0.026237010955810547
mini_batch_src_global generation:  0.049820899963378906
r_  generation:  0.40634799003601074
local_output_nid generation:  0.026250123977661133
local_in_edges_tensor generation:  0.02637505531311035
mini_batch_src_global generation:  0.04951596260070801
r_  generation:  0.40027284622192383
local_output_nid generation:  0.026077747344970703
local_in_edges_tensor generation:  0.02807164192199707
mini_batch_src_global generation:  0.048249244689941406
r_  generation:  0.40915989875793457
local_output_nid generation:  0.02634143829345703
local_in_edges_tensor generation:  0.028101205825805664
mini_batch_src_global generation:  0.04925704002380371
r_  generation:  0.40188050270080566
local_output_nid generation:  0.02624821662902832
local_in_edges_tensor generation:  0.023763656616210938
mini_batch_src_global generation:  0.04635262489318848
r_  generation:  0.40003299713134766
local_output_nid generation:  0.026370525360107422
local_in_edges_tensor generation:  0.0249936580657959
mini_batch_src_global generation:  0.049165964126586914
r_  generation:  0.39925622940063477
local_output_nid generation:  0.026122570037841797
local_in_edges_tensor generation:  0.026501178741455078
mini_batch_src_global generation:  0.04572105407714844
r_  generation:  0.40729379653930664
local_output_nid generation:  0.02645111083984375
local_in_edges_tensor generation:  0.024432659149169922
mini_batch_src_global generation:  0.048895835876464844
r_  generation:  0.40055155754089355
local_output_nid generation:  0.026084184646606445
local_in_edges_tensor generation:  0.02826070785522461
mini_batch_src_global generation:  0.046278953552246094
r_  generation:  0.40131044387817383
local_output_nid generation:  0.026392221450805664
local_in_edges_tensor generation:  0.02508544921875
mini_batch_src_global generation:  0.047144412994384766
r_  generation:  0.3998410701751709
local_output_nid generation:  0.026366710662841797
local_in_edges_tensor generation:  0.028989315032958984
mini_batch_src_global generation:  0.0468745231628418
r_  generation:  0.40673351287841797
local_output_nid generation:  0.026316404342651367
local_in_edges_tensor generation:  0.026057958602905273
mini_batch_src_global generation:  0.0477292537689209
r_  generation:  0.3973977565765381
local_output_nid generation:  0.02658843994140625
local_in_edges_tensor generation:  0.024959564208984375
mini_batch_src_global generation:  0.04606032371520996
r_  generation:  0.4068143367767334
local_output_nid generation:  0.02649545669555664
local_in_edges_tensor generation:  0.02475881576538086
mini_batch_src_global generation:  0.04786109924316406
r_  generation:  0.3985152244567871
local_output_nid generation:  0.02665424346923828
local_in_edges_tensor generation:  0.024132728576660156
mini_batch_src_global generation:  0.04741692543029785
r_  generation:  0.4082341194152832
local_output_nid generation:  0.026421070098876953
local_in_edges_tensor generation:  0.025165796279907227
mini_batch_src_global generation:  0.04787588119506836
r_  generation:  0.3993244171142578
local_output_nid generation:  0.02631521224975586
local_in_edges_tensor generation:  0.024674415588378906
mini_batch_src_global generation:  0.0463557243347168
r_  generation:  0.4089648723602295
local_output_nid generation:  0.026244163513183594
local_in_edges_tensor generation:  0.026363134384155273
mini_batch_src_global generation:  0.05004525184631348
r_  generation:  0.3976914882659912
----------------------check_connections_block total spend ----------------------------- 18.90794062614441
generate_one_block  0.5335421562194824
generate_one_block  0.5377743244171143
generate_one_block  0.5233266353607178
generate_one_block  0.5254614353179932
generate_one_block  0.5972466468811035
generate_one_block  0.5285203456878662
generate_one_block  0.5242490768432617
generate_one_block  0.5179941654205322
generate_one_block  0.5274767875671387
generate_one_block  0.5330898761749268
generate_one_block  0.5317103862762451
generate_one_block  0.5333218574523926
generate_one_block  0.5238220691680908
generate_one_block  0.5300438404083252
generate_one_block  0.5251805782318115
generate_one_block  0.5279443264007568
generate_one_block  0.5385458469390869
generate_one_block  0.5315322875976562
generate_one_block  0.5272552967071533
generate_one_block  0.5334224700927734
generate_one_block  0.53059983253479
generate_one_block  0.530820369720459
generate_one_block  0.5239565372467041
generate_one_block  0.5326495170593262
generate_one_block  0.554948091506958
generate_one_block  0.5256056785583496
generate_one_block  0.5335185527801514
generate_one_block  0.532881498336792
generate_one_block  0.5342681407928467
generate_one_block  0.5278055667877197
generate_one_block  0.5359270572662354
generate_one_block  0.5322487354278564
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1208491325378418  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

connection checking time:  25.34070086479187
block generation total time  22.720022916793823
average batch blocks generation time:  0.710000716149807
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1050405502319336  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.940942764282227  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10413837432861328  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.065460681915283  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10299396514892578  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.712646961212158  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10326480865478516  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.78463077545166  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10276269912719727  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.351827621459961  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10297298431396484  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.637172222137451  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10291671752929688  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.575878143310547  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10285282135009766  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.299254894256592  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10285282135009766  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.652712345123291  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10291719436645508  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.607114315032959  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10501956939697266  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.847595691680908  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10399532318115234  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.888829708099365  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10261344909667969  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.537731170654297  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10304117202758789  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.661523342132568  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10266256332397461  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.525420665740967  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10295438766479492  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.734941005706787  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10396528244018555  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.896672248840332  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10308170318603516  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.682708740234375  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.103851318359375  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.466341495513916  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10313987731933594  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.654231071472168  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10398483276367188  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.706686973571777  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10312080383300781  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.770319938659668  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10388374328613281  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.565436840057373  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10312557220458984  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.57912826538086  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1050572395324707  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.0309100151062  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10286331176757812  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.654747486114502  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10504484176635742  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.961058616638184  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1030740737915039  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.491715908050537  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1050105094909668  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.79177713394165  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10311317443847656  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.684232234954834  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1039133071899414  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.580646991729736  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10305595397949219  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.641149997711182  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03312268853187561 |0.011634767055511475 |0.27014098316431046 |9.438395500183105e-05 |0.4296574294567108 |0.00588679313659668 |
----------------------------------------------------------pseudo_mini_loss sum 1.9847873449325562
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  8577819
Number of first layer input nodes during this epoch:  4655637
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.11985301971435547  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025814294815063477
range selection method range initialization spend 0.014986515045166016
time for parepare:  0.023354053497314453
local_output_nid generation:  0.0011341571807861328
local_in_edges_tensor generation:  0.0070781707763671875
mini_batch_src_global generation:  0.004081010818481445
r_  generation:  0.008153915405273438
local_output_nid generation:  0.0009508132934570312
local_in_edges_tensor generation:  0.0006585121154785156
mini_batch_src_global generation:  0.0017304420471191406
r_  generation:  0.009097576141357422
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0005922317504882812
mini_batch_src_global generation:  0.0012111663818359375
r_  generation:  0.007898807525634766
local_output_nid generation:  0.0009214878082275391
local_in_edges_tensor generation:  0.0005629062652587891
mini_batch_src_global generation:  0.001178741455078125
r_  generation:  0.008136510848999023
local_output_nid generation:  0.000885009765625
local_in_edges_tensor generation:  0.0005857944488525391
mini_batch_src_global generation:  0.0010972023010253906
r_  generation:  0.010426044464111328
local_output_nid generation:  0.0009145736694335938
local_in_edges_tensor generation:  0.0005869865417480469
mini_batch_src_global generation:  0.0012617111206054688
r_  generation:  0.008392572402954102
local_output_nid generation:  0.0008790493011474609
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0011661052703857422
r_  generation:  0.00844264030456543
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0005514621734619141
mini_batch_src_global generation:  0.0010671615600585938
r_  generation:  0.008352279663085938
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0005505084991455078
mini_batch_src_global generation:  0.000993967056274414
r_  generation:  0.008187532424926758
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0005328655242919922
mini_batch_src_global generation:  0.0010311603546142578
r_  generation:  0.008465051651000977
local_output_nid generation:  0.0008785724639892578
local_in_edges_tensor generation:  0.00054931640625
mini_batch_src_global generation:  0.0010325908660888672
r_  generation:  0.00829625129699707
local_output_nid generation:  0.0009043216705322266
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.001041412353515625
r_  generation:  0.008493900299072266
local_output_nid generation:  0.0008966922760009766
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.0010325908660888672
r_  generation:  0.008097171783447266
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0005431175231933594
mini_batch_src_global generation:  0.0010106563568115234
r_  generation:  0.008482217788696289
local_output_nid generation:  0.0009028911590576172
local_in_edges_tensor generation:  0.0005514621734619141
mini_batch_src_global generation:  0.001007080078125
r_  generation:  0.008437156677246094
local_output_nid generation:  0.0009315013885498047
local_in_edges_tensor generation:  0.0005509853363037109
mini_batch_src_global generation:  0.0009982585906982422
r_  generation:  0.008395195007324219
local_output_nid generation:  0.0009019374847412109
local_in_edges_tensor generation:  0.0005428791046142578
mini_batch_src_global generation:  0.0010025501251220703
r_  generation:  0.008590936660766602
local_output_nid generation:  0.0008878707885742188
local_in_edges_tensor generation:  0.0005705356597900391
mini_batch_src_global generation:  0.0010094642639160156
r_  generation:  0.008274316787719727
local_output_nid generation:  0.0009217262268066406
local_in_edges_tensor generation:  0.0006046295166015625
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.00817108154296875
local_output_nid generation:  0.0008938312530517578
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.0009796619415283203
r_  generation:  0.008428812026977539
local_output_nid generation:  0.0008985996246337891
local_in_edges_tensor generation:  0.0005650520324707031
mini_batch_src_global generation:  0.0010356903076171875
r_  generation:  0.010501861572265625
local_output_nid generation:  0.0009539127349853516
local_in_edges_tensor generation:  0.0005853176116943359
mini_batch_src_global generation:  0.0010027885437011719
r_  generation:  0.008474111557006836
local_output_nid generation:  0.0009028911590576172
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.001009225845336914
r_  generation:  0.008323192596435547
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.0005328655242919922
mini_batch_src_global generation:  0.0009913444519042969
r_  generation:  0.008350372314453125
local_output_nid generation:  0.000881195068359375
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0010437965393066406
r_  generation:  0.00829625129699707
local_output_nid generation:  0.0008761882781982422
local_in_edges_tensor generation:  0.0005550384521484375
mini_batch_src_global generation:  0.0009801387786865234
r_  generation:  0.008478879928588867
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0005466938018798828
mini_batch_src_global generation:  0.0009925365447998047
r_  generation:  0.008504629135131836
local_output_nid generation:  0.0008249282836914062
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0011916160583496094
r_  generation:  0.00817728042602539
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.0005679130554199219
mini_batch_src_global generation:  0.0009961128234863281
r_  generation:  0.008202791213989258
local_output_nid generation:  0.0008482933044433594
local_in_edges_tensor generation:  0.0005528926849365234
mini_batch_src_global generation:  0.0010020732879638672
r_  generation:  0.008373260498046875
local_output_nid generation:  0.0008959770202636719
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0010249614715576172
r_  generation:  0.008400678634643555
local_output_nid generation:  0.0008840560913085938
local_in_edges_tensor generation:  0.0005447864532470703
mini_batch_src_global generation:  0.0010097026824951172
r_  generation:  0.008440017700195312
----------------------check_connections_block total spend ----------------------------- 0.4599924087524414
generate_one_block  0.02321004867553711
generate_one_block  0.032766103744506836
generate_one_block  0.014974832534790039
generate_one_block  0.014867067337036133
generate_one_block  0.014737129211425781
generate_one_block  0.014865875244140625
generate_one_block  0.014648914337158203
generate_one_block  0.014594078063964844
generate_one_block  0.015636682510375977
generate_one_block  0.01483297348022461
generate_one_block  0.014545202255249023
generate_one_block  0.014970779418945312
generate_one_block  0.013897895812988281
generate_one_block  0.014748811721801758
generate_one_block  0.014361143112182617
generate_one_block  0.014431238174438477
generate_one_block  0.017407894134521484
generate_one_block  0.014243125915527344
generate_one_block  0.014091014862060547
generate_one_block  0.014436960220336914
generate_one_block  0.01456594467163086
generate_one_block  0.014621973037719727
generate_one_block  0.014364957809448242
generate_one_block  0.017401933670043945
generate_one_block  0.014294147491455078
generate_one_block  0.014503955841064453
generate_one_block  0.014516592025756836
generate_one_block  0.014057159423828125
generate_one_block  0.014099359512329102
generate_one_block  0.014376640319824219
generate_one_block  0.018170595169067383
generate_one_block  0.014625787734985352
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06342339515686035
gen group dst list time:  0.02800774574279785
time for parepare:  0.02343297004699707
local_output_nid generation:  0.0047054290771484375
local_in_edges_tensor generation:  0.016803503036499023
mini_batch_src_global generation:  0.014568567276000977
r_  generation:  0.12508058547973633
local_output_nid generation:  0.006815195083618164
local_in_edges_tensor generation:  0.009018421173095703
mini_batch_src_global generation:  0.018033981323242188
r_  generation:  0.13367056846618652
local_output_nid generation:  0.006714344024658203
local_in_edges_tensor generation:  0.029195308685302734
mini_batch_src_global generation:  0.016424179077148438
r_  generation:  0.1317884922027588
local_output_nid generation:  0.00704646110534668
local_in_edges_tensor generation:  0.009540081024169922
mini_batch_src_global generation:  0.01756882667541504
r_  generation:  0.13866877555847168
local_output_nid generation:  0.0075337886810302734
local_in_edges_tensor generation:  0.012012720108032227
mini_batch_src_global generation:  0.044576168060302734
r_  generation:  0.1493518352508545
local_output_nid generation:  0.011341333389282227
local_in_edges_tensor generation:  0.010535240173339844
mini_batch_src_global generation:  0.019124269485473633
r_  generation:  0.15198040008544922
local_output_nid generation:  0.012034177780151367
local_in_edges_tensor generation:  0.01147317886352539
mini_batch_src_global generation:  0.018420696258544922
r_  generation:  0.1531984806060791
local_output_nid generation:  0.012006282806396484
local_in_edges_tensor generation:  0.010049104690551758
mini_batch_src_global generation:  0.018610715866088867
r_  generation:  0.15168452262878418
local_output_nid generation:  0.011507749557495117
local_in_edges_tensor generation:  0.010761260986328125
mini_batch_src_global generation:  0.018320798873901367
r_  generation:  0.14951515197753906
local_output_nid generation:  0.012848854064941406
local_in_edges_tensor generation:  0.009547710418701172
mini_batch_src_global generation:  0.03737688064575195
r_  generation:  0.14185690879821777
local_output_nid generation:  0.008930683135986328
local_in_edges_tensor generation:  0.008747339248657227
mini_batch_src_global generation:  0.018807411193847656
r_  generation:  0.1373600959777832
local_output_nid generation:  0.008649826049804688
local_in_edges_tensor generation:  0.007666349411010742
mini_batch_src_global generation:  0.019808292388916016
r_  generation:  0.14080238342285156
local_output_nid generation:  0.00787973403930664
local_in_edges_tensor generation:  0.007657051086425781
mini_batch_src_global generation:  0.018111228942871094
r_  generation:  0.13513565063476562
local_output_nid generation:  0.008253812789916992
local_in_edges_tensor generation:  0.009414196014404297
mini_batch_src_global generation:  0.0199587345123291
r_  generation:  0.1447608470916748
local_output_nid generation:  0.009656906127929688
local_in_edges_tensor generation:  0.009734869003295898
mini_batch_src_global generation:  0.01943373680114746
r_  generation:  0.14031124114990234
local_output_nid generation:  0.008201360702514648
local_in_edges_tensor generation:  0.0077702999114990234
mini_batch_src_global generation:  0.019263267517089844
r_  generation:  0.14117431640625
local_output_nid generation:  0.008089303970336914
local_in_edges_tensor generation:  0.008503913879394531
mini_batch_src_global generation:  0.01922917366027832
r_  generation:  0.14037466049194336
local_output_nid generation:  0.0078125
local_in_edges_tensor generation:  0.007200717926025391
mini_batch_src_global generation:  0.025908231735229492
r_  generation:  0.16846561431884766
local_output_nid generation:  0.008438348770141602
local_in_edges_tensor generation:  0.007208347320556641
mini_batch_src_global generation:  0.03271484375
r_  generation:  0.13620662689208984
local_output_nid generation:  0.008290290832519531
local_in_edges_tensor generation:  0.008672714233398438
mini_batch_src_global generation:  0.01981663703918457
r_  generation:  0.1423325538635254
local_output_nid generation:  0.008228063583374023
local_in_edges_tensor generation:  0.007790088653564453
mini_batch_src_global generation:  0.01936650276184082
r_  generation:  0.13965463638305664
local_output_nid generation:  0.008182525634765625
local_in_edges_tensor generation:  0.008005142211914062
mini_batch_src_global generation:  0.019459962844848633
r_  generation:  0.14336299896240234
local_output_nid generation:  0.008086204528808594
local_in_edges_tensor generation:  0.0077610015869140625
mini_batch_src_global generation:  0.01914811134338379
r_  generation:  0.1483900547027588
local_output_nid generation:  0.00970149040222168
local_in_edges_tensor generation:  0.007756710052490234
mini_batch_src_global generation:  0.026607990264892578
r_  generation:  0.16502904891967773
local_output_nid generation:  0.009412288665771484
local_in_edges_tensor generation:  0.008693933486938477
mini_batch_src_global generation:  0.0186769962310791
r_  generation:  0.1398167610168457
local_output_nid generation:  0.008562803268432617
local_in_edges_tensor generation:  0.007959127426147461
mini_batch_src_global generation:  0.0174105167388916
r_  generation:  0.15401577949523926
local_output_nid generation:  0.008333921432495117
local_in_edges_tensor generation:  0.00995182991027832
mini_batch_src_global generation:  0.017091035842895508
r_  generation:  0.1420426368713379
local_output_nid generation:  0.008064508438110352
local_in_edges_tensor generation:  0.007338047027587891
mini_batch_src_global generation:  0.018540143966674805
r_  generation:  0.13927841186523438
local_output_nid generation:  0.008939027786254883
local_in_edges_tensor generation:  0.007871389389038086
mini_batch_src_global generation:  0.02844691276550293
r_  generation:  0.1385197639465332
local_output_nid generation:  0.008147954940795898
local_in_edges_tensor generation:  0.009780168533325195
mini_batch_src_global generation:  0.017361164093017578
r_  generation:  0.14463520050048828
local_output_nid generation:  0.008098602294921875
local_in_edges_tensor generation:  0.007816076278686523
mini_batch_src_global generation:  0.01853036880493164
r_  generation:  0.14100265502929688
local_output_nid generation:  0.008142232894897461
local_in_edges_tensor generation:  0.010421514511108398
mini_batch_src_global generation:  0.0186920166015625
r_  generation:  0.1423492431640625
----------------------check_connections_block total spend ----------------------------- 7.024142742156982
generate_one_block  0.18694734573364258
generate_one_block  0.18469572067260742
generate_one_block  0.171875
generate_one_block  0.17746210098266602
generate_one_block  0.19140625
generate_one_block  0.178147554397583
generate_one_block  0.1790015697479248
generate_one_block  0.17547178268432617
generate_one_block  0.1725308895111084
generate_one_block  0.1801612377166748
generate_one_block  0.17178750038146973
generate_one_block  0.1795806884765625
generate_one_block  0.16833877563476562
generate_one_block  0.17974209785461426
generate_one_block  0.1770322322845459
generate_one_block  0.1945958137512207
generate_one_block  0.18268609046936035
generate_one_block  0.1687307357788086
generate_one_block  0.1722252368927002
generate_one_block  0.21427416801452637
generate_one_block  0.1790146827697754
generate_one_block  0.18416547775268555
generate_one_block  0.17724609375
generate_one_block  0.1758573055267334
generate_one_block  0.17744946479797363
generate_one_block  0.18068671226501465
generate_one_block  0.18176984786987305
generate_one_block  0.17303919792175293
generate_one_block  0.17199325561523438
generate_one_block  0.18063139915466309
generate_one_block  0.17577815055847168
generate_one_block  0.17842769622802734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038728952407836914
gen group dst list time:  0.10750389099121094
time for parepare:  0.021088361740112305
local_output_nid generation:  0.024779558181762695
local_in_edges_tensor generation:  0.04729318618774414
mini_batch_src_global generation:  0.03702354431152344
r_  generation:  0.3988933563232422
local_output_nid generation:  0.031850576400756836
local_in_edges_tensor generation:  0.031146526336669922
mini_batch_src_global generation:  0.04952502250671387
r_  generation:  0.3972740173339844
local_output_nid generation:  0.028072357177734375
local_in_edges_tensor generation:  0.02447962760925293
mini_batch_src_global generation:  0.04530692100524902
r_  generation:  0.3952960968017578
local_output_nid generation:  0.028795242309570312
local_in_edges_tensor generation:  0.026795148849487305
mini_batch_src_global generation:  0.049306392669677734
r_  generation:  0.39929938316345215
local_output_nid generation:  0.028740644454956055
local_in_edges_tensor generation:  0.0264132022857666
mini_batch_src_global generation:  0.04635977745056152
r_  generation:  0.40436792373657227
local_output_nid generation:  0.027787208557128906
local_in_edges_tensor generation:  0.02626633644104004
mini_batch_src_global generation:  0.04822587966918945
r_  generation:  0.4023771286010742
local_output_nid generation:  0.026996612548828125
local_in_edges_tensor generation:  0.02502274513244629
mini_batch_src_global generation:  0.04736137390136719
r_  generation:  0.4053046703338623
local_output_nid generation:  0.027118921279907227
local_in_edges_tensor generation:  0.02469658851623535
mini_batch_src_global generation:  0.04785513877868652
r_  generation:  0.3988809585571289
local_output_nid generation:  0.02715134620666504
local_in_edges_tensor generation:  0.025000333786010742
mini_batch_src_global generation:  0.046788930892944336
r_  generation:  0.4029877185821533
local_output_nid generation:  0.027174949645996094
local_in_edges_tensor generation:  0.027774333953857422
mini_batch_src_global generation:  0.048272132873535156
r_  generation:  0.4013998508453369
local_output_nid generation:  0.02695775032043457
local_in_edges_tensor generation:  0.025046348571777344
mini_batch_src_global generation:  0.04616141319274902
r_  generation:  0.4014241695404053
local_output_nid generation:  0.02703404426574707
local_in_edges_tensor generation:  0.026595354080200195
mini_batch_src_global generation:  0.04958224296569824
r_  generation:  0.400571346282959
local_output_nid generation:  0.026605606079101562
local_in_edges_tensor generation:  0.024297475814819336
mini_batch_src_global generation:  0.04577803611755371
r_  generation:  0.4064757823944092
local_output_nid generation:  0.0274810791015625
local_in_edges_tensor generation:  0.02684473991394043
mini_batch_src_global generation:  0.0480198860168457
r_  generation:  0.4045557975769043
local_output_nid generation:  0.02705073356628418
local_in_edges_tensor generation:  0.026468992233276367
mini_batch_src_global generation:  0.046071767807006836
r_  generation:  0.40263891220092773
local_output_nid generation:  0.027594327926635742
local_in_edges_tensor generation:  0.0269012451171875
mini_batch_src_global generation:  0.04997563362121582
r_  generation:  0.41253232955932617
local_output_nid generation:  0.027260541915893555
local_in_edges_tensor generation:  0.02777695655822754
mini_batch_src_global generation:  0.04637765884399414
r_  generation:  0.409076452255249
local_output_nid generation:  0.02843618392944336
local_in_edges_tensor generation:  0.026590347290039062
mini_batch_src_global generation:  0.04789376258850098
r_  generation:  0.39706921577453613
local_output_nid generation:  0.027190685272216797
local_in_edges_tensor generation:  0.030267000198364258
mini_batch_src_global generation:  0.04595327377319336
r_  generation:  0.40268445014953613
local_output_nid generation:  0.027268171310424805
local_in_edges_tensor generation:  0.030849695205688477
mini_batch_src_global generation:  0.04913163185119629
r_  generation:  0.40492892265319824
local_output_nid generation:  0.027251482009887695
local_in_edges_tensor generation:  0.024364709854125977
mini_batch_src_global generation:  0.04641556739807129
r_  generation:  0.406404972076416
local_output_nid generation:  0.027504920959472656
local_in_edges_tensor generation:  0.026177406311035156
mini_batch_src_global generation:  0.053681135177612305
r_  generation:  0.40401387214660645
local_output_nid generation:  0.02688288688659668
local_in_edges_tensor generation:  0.028442859649658203
mini_batch_src_global generation:  0.04600834846496582
r_  generation:  0.40616869926452637
local_output_nid generation:  0.02717900276184082
local_in_edges_tensor generation:  0.02561807632446289
mini_batch_src_global generation:  0.05090808868408203
r_  generation:  0.4013192653656006
local_output_nid generation:  0.027415037155151367
local_in_edges_tensor generation:  0.025196552276611328
mini_batch_src_global generation:  0.046686410903930664
r_  generation:  0.4255542755126953
local_output_nid generation:  0.028288602828979492
local_in_edges_tensor generation:  0.029310226440429688
mini_batch_src_global generation:  0.0527193546295166
r_  generation:  0.40242910385131836
local_output_nid generation:  0.028136014938354492
local_in_edges_tensor generation:  0.02553272247314453
mini_batch_src_global generation:  0.046242713928222656
r_  generation:  0.4114720821380615
local_output_nid generation:  0.027170181274414062
local_in_edges_tensor generation:  0.02535557746887207
mini_batch_src_global generation:  0.04821634292602539
r_  generation:  0.3964390754699707
local_output_nid generation:  0.027350902557373047
local_in_edges_tensor generation:  0.02406787872314453
mini_batch_src_global generation:  0.045937538146972656
r_  generation:  0.40699267387390137
local_output_nid generation:  0.0273892879486084
local_in_edges_tensor generation:  0.029834508895874023
mini_batch_src_global generation:  0.050145626068115234
r_  generation:  0.4020676612854004
local_output_nid generation:  0.02728891372680664
local_in_edges_tensor generation:  0.024571657180786133
mini_batch_src_global generation:  0.04563403129577637
r_  generation:  0.4044077396392822
local_output_nid generation:  0.02735590934753418
local_in_edges_tensor generation:  0.024353981018066406
mini_batch_src_global generation:  0.04759621620178223
r_  generation:  0.3983592987060547
----------------------check_connections_block total spend ----------------------------- 19.073432207107544
generate_one_block  0.5428574085235596
generate_one_block  0.5387170314788818
generate_one_block  0.5185506343841553
generate_one_block  0.5385539531707764
generate_one_block  0.628896951675415
generate_one_block  0.5309431552886963
generate_one_block  0.534902811050415
generate_one_block  0.5352575778961182
generate_one_block  0.5259552001953125
generate_one_block  0.5390110015869141
generate_one_block  0.5308172702789307
generate_one_block  0.5318613052368164
generate_one_block  0.5201716423034668
generate_one_block  0.5428087711334229
generate_one_block  0.5271754264831543
generate_one_block  0.5418956279754639
generate_one_block  0.5445504188537598
generate_one_block  0.5284771919250488
generate_one_block  0.5342028141021729
generate_one_block  0.5476622581481934
generate_one_block  0.5350997447967529
generate_one_block  0.5434722900390625
generate_one_block  0.5324132442474365
generate_one_block  0.5340428352355957
generate_one_block  0.5520782470703125
generate_one_block  0.5370831489562988
generate_one_block  0.5420117378234863
generate_one_block  0.5339221954345703
generate_one_block  0.5300076007843018
generate_one_block  0.5395162105560303
generate_one_block  0.5280632972717285
generate_one_block  0.531794548034668
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.11985301971435547  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

connection checking time:  26.097574949264526
block generation total time  22.96552562713623
average batch blocks generation time:  0.7176726758480072
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10384607315063477  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.453258037567139  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10433769226074219  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.882988452911377  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10269975662231445  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.428661346435547  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10419273376464844  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.860834121704102  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10401725769042969  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.788611888885498  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10399866104125977  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.92447280883789  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10394430160522461  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.935581684112549  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10414743423461914  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.798425197601318  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1039133071899414  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.569645404815674  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1042013168334961  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.92569351196289  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.103912353515625  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.612433433532715  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10419559478759766  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.846487522125244  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10230588912963867  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.191082954406738  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10413026809692383  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.952124118804932  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10277223587036133  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.47565221786499  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1041569709777832  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.860052585601807  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10502481460571289  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.882301807403564  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1030416488647461  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.386328220367432  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10383319854736328  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.439509391784668  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10420799255371094  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.899441719055176  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10394954681396484  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.64702320098877  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10431528091430664  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.880084037780762  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10281562805175781  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.554436683654785  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1028447151184082  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.699793815612793  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10298824310302734  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.725613117218018  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10320281982421875  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.71538257598877  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10401582717895508  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.815121173858643  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10292339324951172  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.4316725730896  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10379695892333984  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.378625869750977  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10388565063476562  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.81266450881958  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1027984619140625  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.529412746429443  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10308074951171875  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.664968013763428  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03740540146827698 |0.011329218745231628 |0.2643452137708664 |9.260326623916626e-05 |0.4307217597961426 |0.0034513473510742188 |
----------------------------------------------------------pseudo_mini_loss sum 1.8826014995574951
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  8576064
Number of first layer input nodes during this epoch:  4655708
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.12038040161132812  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025828123092651367
range selection method range initialization spend 0.01457071304321289
time for parepare:  0.02143120765686035
local_output_nid generation:  0.0011188983917236328
local_in_edges_tensor generation:  0.004778385162353516
mini_batch_src_global generation:  0.004231929779052734
r_  generation:  0.009741067886352539
local_output_nid generation:  0.0009946823120117188
local_in_edges_tensor generation:  0.0006928443908691406
mini_batch_src_global generation:  0.001699686050415039
r_  generation:  0.008635282516479492
local_output_nid generation:  0.0009076595306396484
local_in_edges_tensor generation:  0.0006604194641113281
mini_batch_src_global generation:  0.0013685226440429688
r_  generation:  0.008578062057495117
local_output_nid generation:  0.0009860992431640625
local_in_edges_tensor generation:  0.0006003379821777344
mini_batch_src_global generation:  0.0012214183807373047
r_  generation:  0.007929801940917969
local_output_nid generation:  0.0009584426879882812
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.008141040802001953
local_output_nid generation:  0.000942230224609375
local_in_edges_tensor generation:  0.000579833984375
mini_batch_src_global generation:  0.0012354850769042969
r_  generation:  0.00849151611328125
local_output_nid generation:  0.0009200572967529297
local_in_edges_tensor generation:  0.0005860328674316406
mini_batch_src_global generation:  0.001264810562133789
r_  generation:  0.008202314376831055
local_output_nid generation:  0.0009045600891113281
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.001062154769897461
r_  generation:  0.01033639907836914
local_output_nid generation:  0.0009067058563232422
local_in_edges_tensor generation:  0.0005731582641601562
mini_batch_src_global generation:  0.0012297630310058594
r_  generation:  0.008435964584350586
local_output_nid generation:  0.00091552734375
local_in_edges_tensor generation:  0.0005583763122558594
mini_batch_src_global generation:  0.0012145042419433594
r_  generation:  0.008196353912353516
local_output_nid generation:  0.0009026527404785156
local_in_edges_tensor generation:  0.0006349086761474609
mini_batch_src_global generation:  0.0010955333709716797
r_  generation:  0.008385896682739258
local_output_nid generation:  0.0009016990661621094
local_in_edges_tensor generation:  0.0005390644073486328
mini_batch_src_global generation:  0.0011093616485595703
r_  generation:  0.008177757263183594
local_output_nid generation:  0.0009191036224365234
local_in_edges_tensor generation:  0.0005822181701660156
mini_batch_src_global generation:  0.001050710678100586
r_  generation:  0.008334636688232422
local_output_nid generation:  0.0009124279022216797
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.0011980533599853516
r_  generation:  0.008507013320922852
local_output_nid generation:  0.0009095668792724609
local_in_edges_tensor generation:  0.0005359649658203125
mini_batch_src_global generation:  0.0011341571807861328
r_  generation:  0.008174419403076172
local_output_nid generation:  0.0009007453918457031
local_in_edges_tensor generation:  0.0005710124969482422
mini_batch_src_global generation:  0.0010471343994140625
r_  generation:  0.008474349975585938
local_output_nid generation:  0.005326271057128906
local_in_edges_tensor generation:  0.000812530517578125
mini_batch_src_global generation:  0.0013811588287353516
r_  generation:  0.009276151657104492
local_output_nid generation:  0.0011281967163085938
local_in_edges_tensor generation:  0.0007727146148681641
mini_batch_src_global generation:  0.0012538433074951172
r_  generation:  0.008116722106933594
local_output_nid generation:  0.0009379386901855469
local_in_edges_tensor generation:  0.0007116794586181641
mini_batch_src_global generation:  0.0010755062103271484
r_  generation:  0.008303642272949219
local_output_nid generation:  0.0009255409240722656
local_in_edges_tensor generation:  0.0006756782531738281
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.008179426193237305
local_output_nid generation:  0.0009205341339111328
local_in_edges_tensor generation:  0.0006766319274902344
mini_batch_src_global generation:  0.0010941028594970703
r_  generation:  0.008241653442382812
local_output_nid generation:  0.0009129047393798828
local_in_edges_tensor generation:  0.0005974769592285156
mini_batch_src_global generation:  0.0011212825775146484
r_  generation:  0.008081912994384766
local_output_nid generation:  0.0009262561798095703
local_in_edges_tensor generation:  0.0005719661712646484
mini_batch_src_global generation:  0.0010259151458740234
r_  generation:  0.008252620697021484
local_output_nid generation:  0.0009033679962158203
local_in_edges_tensor generation:  0.0006263256072998047
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.011447906494140625
local_output_nid generation:  0.0011706352233886719
local_in_edges_tensor generation:  0.0006723403930664062
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.008332490921020508
local_output_nid generation:  0.0009174346923828125
local_in_edges_tensor generation:  0.0005652904510498047
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.008240461349487305
local_output_nid generation:  0.0009167194366455078
local_in_edges_tensor generation:  0.0007083415985107422
mini_batch_src_global generation:  0.0010290145874023438
r_  generation:  0.008263349533081055
local_output_nid generation:  0.0009198188781738281
local_in_edges_tensor generation:  0.000804901123046875
mini_batch_src_global generation:  0.0011277198791503906
r_  generation:  0.008663654327392578
local_output_nid generation:  0.0009410381317138672
local_in_edges_tensor generation:  0.0006320476531982422
mini_batch_src_global generation:  0.001041412353515625
r_  generation:  0.013091087341308594
local_output_nid generation:  0.00225830078125
local_in_edges_tensor generation:  0.0012826919555664062
mini_batch_src_global generation:  0.0027649402618408203
r_  generation:  0.01249074935913086
local_output_nid generation:  0.0011074542999267578
local_in_edges_tensor generation:  0.0006146430969238281
mini_batch_src_global generation:  0.0013248920440673828
r_  generation:  0.010684967041015625
local_output_nid generation:  0.0009927749633789062
local_in_edges_tensor generation:  0.0005705356597900391
mini_batch_src_global generation:  0.0012874603271484375
r_  generation:  0.008468389511108398
----------------------check_connections_block total spend ----------------------------- 0.48560023307800293
generate_one_block  0.023382902145385742
generate_one_block  0.017583131790161133
generate_one_block  0.015386819839477539
generate_one_block  0.014590024948120117
generate_one_block  0.017048120498657227
generate_one_block  0.01566934585571289
generate_one_block  0.014430046081542969
generate_one_block  0.014472246170043945
generate_one_block  0.015098333358764648
generate_one_block  0.014415264129638672
generate_one_block  0.014646768569946289
generate_one_block  0.017536401748657227
generate_one_block  0.014830827713012695
generate_one_block  0.014956474304199219
generate_one_block  0.014393091201782227
generate_one_block  0.014785289764404297
generate_one_block  0.014942407608032227
generate_one_block  0.014106035232543945
generate_one_block  0.016718149185180664
generate_one_block  0.014571905136108398
generate_one_block  0.014276981353759766
generate_one_block  0.01412820816040039
generate_one_block  0.014745235443115234
generate_one_block  0.014861345291137695
generate_one_block  0.014388799667358398
generate_one_block  0.01695537567138672
generate_one_block  0.014684677124023438
generate_one_block  0.015017032623291016
generate_one_block  0.014481306076049805
generate_one_block  0.01502680778503418
generate_one_block  0.014301061630249023
generate_one_block  0.014755010604858398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037755727767944336
gen group dst list time:  0.0219113826751709
time for parepare:  0.0208590030670166
local_output_nid generation:  0.005071878433227539
local_in_edges_tensor generation:  0.014863729476928711
mini_batch_src_global generation:  0.018723249435424805
r_  generation:  0.13182520866394043
local_output_nid generation:  0.007631540298461914
local_in_edges_tensor generation:  0.00877070426940918
mini_batch_src_global generation:  0.01832294464111328
r_  generation:  0.1314079761505127
local_output_nid generation:  0.007027626037597656
local_in_edges_tensor generation:  0.0329134464263916
mini_batch_src_global generation:  0.016588687896728516
r_  generation:  0.13320446014404297
local_output_nid generation:  0.006884574890136719
local_in_edges_tensor generation:  0.008745431900024414
mini_batch_src_global generation:  0.017192363739013672
r_  generation:  0.13106465339660645
local_output_nid generation:  0.0072479248046875
local_in_edges_tensor generation:  0.00686955451965332
mini_batch_src_global generation:  0.017483949661254883
r_  generation:  0.13433003425598145
local_output_nid generation:  0.007645845413208008
local_in_edges_tensor generation:  0.007179737091064453
mini_batch_src_global generation:  0.01827692985534668
r_  generation:  0.13985466957092285
local_output_nid generation:  0.007478475570678711
local_in_edges_tensor generation:  0.00687408447265625
mini_batch_src_global generation:  0.018274784088134766
r_  generation:  0.13545465469360352
local_output_nid generation:  0.007526874542236328
local_in_edges_tensor generation:  0.0070343017578125
mini_batch_src_global generation:  0.018294811248779297
r_  generation:  0.1366438865661621
local_output_nid generation:  0.007394313812255859
local_in_edges_tensor generation:  0.007327079772949219
mini_batch_src_global generation:  0.026775836944580078
r_  generation:  0.15713000297546387
local_output_nid generation:  0.008551359176635742
local_in_edges_tensor generation:  0.007120370864868164
mini_batch_src_global generation:  0.031496286392211914
r_  generation:  0.1381053924560547
local_output_nid generation:  0.008102178573608398
local_in_edges_tensor generation:  0.007847785949707031
mini_batch_src_global generation:  0.019188642501831055
r_  generation:  0.14607453346252441
local_output_nid generation:  0.00781702995300293
local_in_edges_tensor generation:  0.008159160614013672
mini_batch_src_global generation:  0.02692127227783203
r_  generation:  0.1580798625946045
local_output_nid generation:  0.012731075286865234
local_in_edges_tensor generation:  0.01138162612915039
mini_batch_src_global generation:  0.043515920639038086
r_  generation:  0.14082074165344238
local_output_nid generation:  0.008831024169921875
local_in_edges_tensor generation:  0.008542060852050781
mini_batch_src_global generation:  0.020859241485595703
r_  generation:  0.14131498336791992
local_output_nid generation:  0.008071184158325195
local_in_edges_tensor generation:  0.007792949676513672
mini_batch_src_global generation:  0.0204007625579834
r_  generation:  0.142303466796875
local_output_nid generation:  0.007935762405395508
local_in_edges_tensor generation:  0.007777690887451172
mini_batch_src_global generation:  0.0356442928314209
r_  generation:  0.17382311820983887
local_output_nid generation:  0.011568546295166016
local_in_edges_tensor generation:  0.00954747200012207
mini_batch_src_global generation:  0.025953054428100586
r_  generation:  0.1480717658996582
local_output_nid generation:  0.007653951644897461
local_in_edges_tensor generation:  0.0069348812103271484
mini_batch_src_global generation:  0.03322410583496094
r_  generation:  0.13330507278442383
local_output_nid generation:  0.007822036743164062
local_in_edges_tensor generation:  0.00777888298034668
mini_batch_src_global generation:  0.018719196319580078
r_  generation:  0.13924121856689453
local_output_nid generation:  0.0077779293060302734
local_in_edges_tensor generation:  0.007227420806884766
mini_batch_src_global generation:  0.018331050872802734
r_  generation:  0.1375584602355957
local_output_nid generation:  0.0076525211334228516
local_in_edges_tensor generation:  0.007582187652587891
mini_batch_src_global generation:  0.018370628356933594
r_  generation:  0.13747143745422363
local_output_nid generation:  0.007690906524658203
local_in_edges_tensor generation:  0.0076329708099365234
mini_batch_src_global generation:  0.026579618453979492
r_  generation:  0.15344476699829102
local_output_nid generation:  0.008952140808105469
local_in_edges_tensor generation:  0.00855708122253418
mini_batch_src_global generation:  0.032828330993652344
r_  generation:  0.16855120658874512
local_output_nid generation:  0.008164644241333008
local_in_edges_tensor generation:  0.008289575576782227
mini_batch_src_global generation:  0.04232001304626465
r_  generation:  0.1722123622894287
local_output_nid generation:  0.00783085823059082
local_in_edges_tensor generation:  0.007631778717041016
mini_batch_src_global generation:  0.018857479095458984
r_  generation:  0.13963532447814941
local_output_nid generation:  0.00791168212890625
local_in_edges_tensor generation:  0.007797718048095703
mini_batch_src_global generation:  0.018872499465942383
r_  generation:  0.14727067947387695
local_output_nid generation:  0.007899999618530273
local_in_edges_tensor generation:  0.010391712188720703
mini_batch_src_global generation:  0.01876354217529297
r_  generation:  0.17441225051879883
local_output_nid generation:  0.012560606002807617
local_in_edges_tensor generation:  0.014346122741699219
mini_batch_src_global generation:  0.0214536190032959
r_  generation:  0.1747579574584961
local_output_nid generation:  0.012602567672729492
local_in_edges_tensor generation:  0.013945579528808594
mini_batch_src_global generation:  0.01981377601623535
r_  generation:  0.15897488594055176
local_output_nid generation:  0.011055469512939453
local_in_edges_tensor generation:  0.010250091552734375
mini_batch_src_global generation:  0.019835710525512695
r_  generation:  0.1494460105895996
local_output_nid generation:  0.008638858795166016
local_in_edges_tensor generation:  0.008294343948364258
mini_batch_src_global generation:  0.018789052963256836
r_  generation:  0.14196372032165527
local_output_nid generation:  0.0083770751953125
local_in_edges_tensor generation:  0.007834434509277344
mini_batch_src_global generation:  0.017527103424072266
r_  generation:  0.14897656440734863
----------------------check_connections_block total spend ----------------------------- 7.14972448348999
generate_one_block  0.19690871238708496
generate_one_block  0.18255257606506348
generate_one_block  0.17915058135986328
generate_one_block  0.17387962341308594
generate_one_block  0.1895465850830078
generate_one_block  0.18030095100402832
generate_one_block  0.17379093170166016
generate_one_block  0.1751694679260254
generate_one_block  0.18105459213256836
generate_one_block  0.17229080200195312
generate_one_block  0.17780423164367676
generate_one_block  0.1781327724456787
generate_one_block  0.17922019958496094
generate_one_block  0.1780376434326172
generate_one_block  0.17579174041748047
generate_one_block  0.1785116195678711
generate_one_block  0.1798086166381836
generate_one_block  0.16965508460998535
generate_one_block  0.17423200607299805
generate_one_block  0.20063209533691406
generate_one_block  0.16993165016174316
generate_one_block  0.17047548294067383
generate_one_block  0.1749112606048584
generate_one_block  0.17820215225219727
generate_one_block  0.17807531356811523
generate_one_block  0.17958617210388184
generate_one_block  0.17697644233703613
generate_one_block  0.18736743927001953
generate_one_block  0.1780376434326172
generate_one_block  0.184708833694458
generate_one_block  0.17001605033874512
generate_one_block  0.17835426330566406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03719305992126465
gen group dst list time:  0.12987065315246582
time for parepare:  0.020255088806152344
local_output_nid generation:  0.02276921272277832
local_in_edges_tensor generation:  0.04741716384887695
mini_batch_src_global generation:  0.04969048500061035
r_  generation:  0.416018009185791
local_output_nid generation:  0.027681827545166016
local_in_edges_tensor generation:  0.035321712493896484
mini_batch_src_global generation:  0.05221295356750488
r_  generation:  0.4335362911224365
local_output_nid generation:  0.03202700614929199
local_in_edges_tensor generation:  0.030793428421020508
mini_batch_src_global generation:  0.04887080192565918
r_  generation:  0.40714311599731445
local_output_nid generation:  0.02869868278503418
local_in_edges_tensor generation:  0.028341293334960938
mini_batch_src_global generation:  0.04764986038208008
r_  generation:  0.3993699550628662
local_output_nid generation:  0.028524160385131836
local_in_edges_tensor generation:  0.027240514755249023
mini_batch_src_global generation:  0.046422719955444336
r_  generation:  0.40566229820251465
local_output_nid generation:  0.02953648567199707
local_in_edges_tensor generation:  0.02441883087158203
mini_batch_src_global generation:  0.050919532775878906
r_  generation:  0.404801607131958
local_output_nid generation:  0.029584407806396484
local_in_edges_tensor generation:  0.025025606155395508
mini_batch_src_global generation:  0.046689748764038086
r_  generation:  0.407501220703125
local_output_nid generation:  0.02965259552001953
local_in_edges_tensor generation:  0.02445197105407715
mini_batch_src_global generation:  0.04766845703125
r_  generation:  0.4000885486602783
local_output_nid generation:  0.03019857406616211
local_in_edges_tensor generation:  0.02796316146850586
mini_batch_src_global generation:  0.0473635196685791
r_  generation:  0.42340517044067383
local_output_nid generation:  0.030121803283691406
local_in_edges_tensor generation:  0.024794816970825195
mini_batch_src_global generation:  0.05076098442077637
r_  generation:  0.4057033061981201
local_output_nid generation:  0.03032708168029785
local_in_edges_tensor generation:  0.024856090545654297
mini_batch_src_global generation:  0.050373077392578125
r_  generation:  0.42351818084716797
local_output_nid generation:  0.030211448669433594
local_in_edges_tensor generation:  0.028795242309570312
mini_batch_src_global generation:  0.051099538803100586
r_  generation:  0.40648961067199707
local_output_nid generation:  0.030267953872680664
local_in_edges_tensor generation:  0.026476621627807617
mini_batch_src_global generation:  0.04709362983703613
r_  generation:  0.4075019359588623
local_output_nid generation:  0.030715465545654297
local_in_edges_tensor generation:  0.031992197036743164
mini_batch_src_global generation:  0.047838449478149414
r_  generation:  0.40427303314208984
local_output_nid generation:  0.03049182891845703
local_in_edges_tensor generation:  0.03148174285888672
mini_batch_src_global generation:  0.04666256904602051
r_  generation:  0.42819762229919434
local_output_nid generation:  0.032186269760131836
local_in_edges_tensor generation:  0.02878284454345703
mini_batch_src_global generation:  0.050498247146606445
r_  generation:  0.4062347412109375
local_output_nid generation:  0.027873516082763672
local_in_edges_tensor generation:  0.028064250946044922
mini_batch_src_global generation:  0.048023223876953125
r_  generation:  0.4211900234222412
local_output_nid generation:  0.027529001235961914
local_in_edges_tensor generation:  0.026752948760986328
mini_batch_src_global generation:  0.047490835189819336
r_  generation:  0.398850679397583
local_output_nid generation:  0.028055429458618164
local_in_edges_tensor generation:  0.0256192684173584
mini_batch_src_global generation:  0.046395063400268555
r_  generation:  0.40918564796447754
local_output_nid generation:  0.027344703674316406
local_in_edges_tensor generation:  0.024977922439575195
mini_batch_src_global generation:  0.049759864807128906
r_  generation:  0.4010934829711914
local_output_nid generation:  0.02943730354309082
local_in_edges_tensor generation:  0.029146671295166016
mini_batch_src_global generation:  0.046751976013183594
r_  generation:  0.40329813957214355
local_output_nid generation:  0.027579545974731445
local_in_edges_tensor generation:  0.026394367218017578
mini_batch_src_global generation:  0.04788470268249512
r_  generation:  0.39723920822143555
local_output_nid generation:  0.027789592742919922
local_in_edges_tensor generation:  0.02484583854675293
mini_batch_src_global generation:  0.04816079139709473
r_  generation:  0.4058833122253418
local_output_nid generation:  0.02745342254638672
local_in_edges_tensor generation:  0.025596141815185547
mini_batch_src_global generation:  0.04762530326843262
r_  generation:  0.39768028259277344
local_output_nid generation:  0.027484416961669922
local_in_edges_tensor generation:  0.027562856674194336
mini_batch_src_global generation:  0.0471193790435791
r_  generation:  0.4064602851867676
local_output_nid generation:  0.02786731719970703
local_in_edges_tensor generation:  0.027774810791015625
mini_batch_src_global generation:  0.0502476692199707
r_  generation:  0.40380120277404785
local_output_nid generation:  0.027483463287353516
local_in_edges_tensor generation:  0.0284268856048584
mini_batch_src_global generation:  0.04996538162231445
r_  generation:  0.40619921684265137
local_output_nid generation:  0.02786850929260254
local_in_edges_tensor generation:  0.029685258865356445
mini_batch_src_global generation:  0.050786495208740234
r_  generation:  0.409299373626709
local_output_nid generation:  0.027644634246826172
local_in_edges_tensor generation:  0.026236534118652344
mini_batch_src_global generation:  0.047931671142578125
r_  generation:  0.4109506607055664
local_output_nid generation:  0.02792525291442871
local_in_edges_tensor generation:  0.02783679962158203
mini_batch_src_global generation:  0.048331260681152344
r_  generation:  0.40579724311828613
local_output_nid generation:  0.02747488021850586
local_in_edges_tensor generation:  0.03002762794494629
mini_batch_src_global generation:  0.04824399948120117
r_  generation:  0.40761709213256836
local_output_nid generation:  0.02851700782775879
local_in_edges_tensor generation:  0.026868820190429688
mini_batch_src_global generation:  0.04813814163208008
r_  generation:  0.41602540016174316
----------------------check_connections_block total spend ----------------------------- 19.375221252441406
generate_one_block  0.5615642070770264
generate_one_block  0.5261943340301514
generate_one_block  0.53912353515625
generate_one_block  0.5303511619567871
generate_one_block  0.7278592586517334
generate_one_block  0.5441148281097412
generate_one_block  0.5290038585662842
generate_one_block  0.5431637763977051
generate_one_block  0.5475101470947266
generate_one_block  0.5314507484436035
generate_one_block  0.5391509532928467
generate_one_block  0.5293500423431396
generate_one_block  0.5280666351318359
generate_one_block  0.5361497402191162
generate_one_block  0.5598409175872803
generate_one_block  0.5401673316955566
generate_one_block  0.5399289131164551
generate_one_block  0.5238039493560791
generate_one_block  0.531627893447876
generate_one_block  0.5293121337890625
generate_one_block  0.5317516326904297
generate_one_block  0.5306875705718994
generate_one_block  0.5377509593963623
generate_one_block  0.5388059616088867
generate_one_block  0.5513911247253418
generate_one_block  0.5446274280548096
generate_one_block  0.531618595123291
generate_one_block  0.5455353260040283
generate_one_block  0.5342273712158203
generate_one_block  0.5406832695007324
generate_one_block  0.5312802791595459
generate_one_block  0.5350022315979004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.12038040161132812  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

connection checking time:  26.524945735931396
block generation total time  23.11420965194702
average batch blocks generation time:  0.7223190516233444
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10506629943847656  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.105753898620605  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1041722297668457  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.855889797210693  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10503053665161133  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.939269065856934  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10304403305053711  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.581406116485596  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10279417037963867  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.55670976638794  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10426902770996094  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.01363468170166  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10266494750976562  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.556704044342041  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10283803939819336  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.672991752624512  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10504007339477539  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.970226764678955  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10299491882324219  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.521228790283203  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1050267219543457  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.826874256134033  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1027536392211914  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.61604642868042  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10265302658081055  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.607284545898438  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10307550430297852  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.75317907333374  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10291910171508789  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.729817390441895  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1040334701538086  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.877676486968994  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10502147674560547  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.865387916564941  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10277652740478516  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.218677520751953  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10393428802490234  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.613532066345215  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10280942916870117  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.481212139129639  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10272550582885742  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.456792831420898  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10299062728881836  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.43574047088623  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10388469696044922  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.540691375732422  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10273218154907227  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.68666934967041  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10390472412109375  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.54910659790039  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10407495498657227  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.830039978027344  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.103851318359375  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.487785816192627  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1042170524597168  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.09205675125122  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10392475128173828  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.5852689743042  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10426092147827148  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.933060646057129  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10382843017578125  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.456260681152344  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10299873352050781  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.69070291519165  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03916655480861664 |0.011967793107032776 |0.2685640752315521 |9.444355964660645e-05 |0.42911820113658905 |0.004312038421630859 |
----------------------------------------------------------pseudo_mini_loss sum 1.7945499420166016
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  8580573
Number of first layer input nodes during this epoch:  4655876
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.12025070190429688  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04056358337402344
range selection method range initialization spend 0.016419410705566406
time for parepare:  0.020227909088134766
local_output_nid generation:  0.0009255409240722656
local_in_edges_tensor generation:  0.0038084983825683594
mini_batch_src_global generation:  0.0018813610076904297
r_  generation:  0.010159969329833984
local_output_nid generation:  0.0009438991546630859
local_in_edges_tensor generation:  0.0006103515625
mini_batch_src_global generation:  0.0012917518615722656
r_  generation:  0.008555412292480469
local_output_nid generation:  0.0009248256683349609
local_in_edges_tensor generation:  0.0005612373352050781
mini_batch_src_global generation:  0.0010197162628173828
r_  generation:  0.008022069931030273
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0005140304565429688
mini_batch_src_global generation:  0.0009608268737792969
r_  generation:  0.007969379425048828
local_output_nid generation:  0.0008478164672851562
local_in_edges_tensor generation:  0.0005137920379638672
mini_batch_src_global generation:  0.0009489059448242188
r_  generation:  0.008121967315673828
local_output_nid generation:  0.0008246898651123047
local_in_edges_tensor generation:  0.0004899501800537109
mini_batch_src_global generation:  0.0009112358093261719
r_  generation:  0.008063554763793945
local_output_nid generation:  0.0008475780487060547
local_in_edges_tensor generation:  0.0005116462707519531
mini_batch_src_global generation:  0.0009982585906982422
r_  generation:  0.008378267288208008
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0005104541778564453
mini_batch_src_global generation:  0.0008761882781982422
r_  generation:  0.007812738418579102
local_output_nid generation:  0.0008196830749511719
local_in_edges_tensor generation:  0.0005116462707519531
mini_batch_src_global generation:  0.00087738037109375
r_  generation:  0.008016824722290039
local_output_nid generation:  0.0008172988891601562
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.0008854866027832031
r_  generation:  0.00822758674621582
local_output_nid generation:  0.0008146762847900391
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.0009074211120605469
r_  generation:  0.00828242301940918
local_output_nid generation:  0.0008118152618408203
local_in_edges_tensor generation:  0.0005216598510742188
mini_batch_src_global generation:  0.0008847713470458984
r_  generation:  0.008047342300415039
local_output_nid generation:  0.0007958412170410156
local_in_edges_tensor generation:  0.0004756450653076172
mini_batch_src_global generation:  0.0008783340454101562
r_  generation:  0.008362293243408203
local_output_nid generation:  0.0007867813110351562
local_in_edges_tensor generation:  0.0005078315734863281
mini_batch_src_global generation:  0.0009198188781738281
r_  generation:  0.008112907409667969
local_output_nid generation:  0.0008106231689453125
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0009183883666992188
r_  generation:  0.00825810432434082
local_output_nid generation:  0.0007951259613037109
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.0009419918060302734
r_  generation:  0.00810384750366211
local_output_nid generation:  0.0008296966552734375
local_in_edges_tensor generation:  0.0005021095275878906
mini_batch_src_global generation:  0.0009286403656005859
r_  generation:  0.008366107940673828
local_output_nid generation:  0.0007917881011962891
local_in_edges_tensor generation:  0.0004951953887939453
mini_batch_src_global generation:  0.0008845329284667969
r_  generation:  0.008222341537475586
local_output_nid generation:  0.0008029937744140625
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.0008654594421386719
r_  generation:  0.008170366287231445
local_output_nid generation:  0.0007951259613037109
local_in_edges_tensor generation:  0.00048732757568359375
mini_batch_src_global generation:  0.0009002685546875
r_  generation:  0.008144140243530273
local_output_nid generation:  0.000843048095703125
local_in_edges_tensor generation:  0.000507354736328125
mini_batch_src_global generation:  0.0009312629699707031
r_  generation:  0.008542537689208984
local_output_nid generation:  0.0007865428924560547
local_in_edges_tensor generation:  0.0004887580871582031
mini_batch_src_global generation:  0.0009047985076904297
r_  generation:  0.008385181427001953
local_output_nid generation:  0.0007941722869873047
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009016990661621094
r_  generation:  0.008344173431396484
local_output_nid generation:  0.0007953643798828125
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0008790493011474609
r_  generation:  0.008127450942993164
local_output_nid generation:  0.0008139610290527344
local_in_edges_tensor generation:  0.000499725341796875
mini_batch_src_global generation:  0.0009472370147705078
r_  generation:  0.008508920669555664
local_output_nid generation:  0.0007891654968261719
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.0009407997131347656
r_  generation:  0.008527755737304688
local_output_nid generation:  0.0007917881011962891
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0008966922760009766
r_  generation:  0.0084381103515625
local_output_nid generation:  0.0007917881011962891
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0008924007415771484
r_  generation:  0.008397102355957031
local_output_nid generation:  0.0008111000061035156
local_in_edges_tensor generation:  0.0004987716674804688
mini_batch_src_global generation:  0.0009024143218994141
r_  generation:  0.008444786071777344
local_output_nid generation:  0.0007841587066650391
local_in_edges_tensor generation:  0.0004799365997314453
mini_batch_src_global generation:  0.0008766651153564453
r_  generation:  0.008308887481689453
local_output_nid generation:  0.0008056163787841797
local_in_edges_tensor generation:  0.0005044937133789062
mini_batch_src_global generation:  0.0008912086486816406
r_  generation:  0.00825810432434082
local_output_nid generation:  0.0007827281951904297
local_in_edges_tensor generation:  0.0004916191101074219
mini_batch_src_global generation:  0.0008895397186279297
r_  generation:  0.007947921752929688
----------------------check_connections_block total spend ----------------------------- 0.4299485683441162
generate_one_block  0.02042531967163086
generate_one_block  0.01681375503540039
generate_one_block  0.015032291412353516
generate_one_block  0.014635324478149414
generate_one_block  0.014804601669311523
generate_one_block  0.014498472213745117
generate_one_block  0.014880180358886719
generate_one_block  0.014113187789916992
generate_one_block  0.014244318008422852
generate_one_block  0.014691591262817383
generate_one_block  0.014582395553588867
generate_one_block  0.01441812515258789
generate_one_block  0.014634847640991211
generate_one_block  0.014429569244384766
generate_one_block  0.014305830001831055
generate_one_block  0.014398813247680664
generate_one_block  0.014585256576538086
generate_one_block  0.014287710189819336
generate_one_block  0.014256715774536133
generate_one_block  0.01444244384765625
generate_one_block  0.014730215072631836
generate_one_block  0.014707088470458984
generate_one_block  0.01448965072631836
generate_one_block  0.014400482177734375
generate_one_block  0.014762639999389648
generate_one_block  0.014813899993896484
generate_one_block  0.014659404754638672
generate_one_block  0.014580488204956055
generate_one_block  0.0145721435546875
generate_one_block  0.01442408561706543
generate_one_block  0.014160871505737305
generate_one_block  0.013862133026123047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0552978515625
gen group dst list time:  0.021488189697265625
time for parepare:  0.021733522415161133
local_output_nid generation:  0.004552125930786133
local_in_edges_tensor generation:  0.013584375381469727
mini_batch_src_global generation:  0.012844324111938477
r_  generation:  0.14440584182739258
local_output_nid generation:  0.010485172271728516
local_in_edges_tensor generation:  0.01129460334777832
mini_batch_src_global generation:  0.015993356704711914
r_  generation:  0.13181853294372559
local_output_nid generation:  0.011246442794799805
local_in_edges_tensor generation:  0.03984522819519043
mini_batch_src_global generation:  0.015456914901733398
r_  generation:  0.1422727108001709
local_output_nid generation:  0.011444330215454102
local_in_edges_tensor generation:  0.01085519790649414
mini_batch_src_global generation:  0.015334129333496094
r_  generation:  0.14018607139587402
local_output_nid generation:  0.012499570846557617
local_in_edges_tensor generation:  0.010525703430175781
mini_batch_src_global generation:  0.017484188079833984
r_  generation:  0.16549324989318848
local_output_nid generation:  0.011536359786987305
local_in_edges_tensor generation:  0.008241415023803711
mini_batch_src_global generation:  0.02199721336364746
r_  generation:  0.15447068214416504
local_output_nid generation:  0.0128173828125
local_in_edges_tensor generation:  0.011340141296386719
mini_batch_src_global generation:  0.020565271377563477
r_  generation:  0.17208313941955566
local_output_nid generation:  0.01123356819152832
local_in_edges_tensor generation:  0.00866079330444336
mini_batch_src_global generation:  0.017887353897094727
r_  generation:  0.1398470401763916
local_output_nid generation:  0.00844717025756836
local_in_edges_tensor generation:  0.007689476013183594
mini_batch_src_global generation:  0.017525672912597656
r_  generation:  0.14188694953918457
local_output_nid generation:  0.00810551643371582
local_in_edges_tensor generation:  0.0076558589935302734
mini_batch_src_global generation:  0.018114566802978516
r_  generation:  0.16306495666503906
local_output_nid generation:  0.009844541549682617
local_in_edges_tensor generation:  0.00970005989074707
mini_batch_src_global generation:  0.019093751907348633
r_  generation:  0.14806246757507324
local_output_nid generation:  0.008319377899169922
local_in_edges_tensor generation:  0.0076999664306640625
mini_batch_src_global generation:  0.01984262466430664
r_  generation:  0.184401273727417
local_output_nid generation:  0.009267568588256836
local_in_edges_tensor generation:  0.010954618453979492
mini_batch_src_global generation:  0.018856525421142578
r_  generation:  0.16680335998535156
local_output_nid generation:  0.012459993362426758
local_in_edges_tensor generation:  0.011037826538085938
mini_batch_src_global generation:  0.018251657485961914
r_  generation:  0.15546298027038574
local_output_nid generation:  0.010320186614990234
local_in_edges_tensor generation:  0.009287118911743164
mini_batch_src_global generation:  0.018932580947875977
r_  generation:  0.1451582908630371
local_output_nid generation:  0.00907444953918457
local_in_edges_tensor generation:  0.008393526077270508
mini_batch_src_global generation:  0.019360065460205078
r_  generation:  0.14638495445251465
local_output_nid generation:  0.008799552917480469
local_in_edges_tensor generation:  0.008004903793334961
mini_batch_src_global generation:  0.018425703048706055
r_  generation:  0.14475488662719727
local_output_nid generation:  0.008529901504516602
local_in_edges_tensor generation:  0.007830619812011719
mini_batch_src_global generation:  0.018001079559326172
r_  generation:  0.14500141143798828
local_output_nid generation:  0.008435249328613281
local_in_edges_tensor generation:  0.008385419845581055
mini_batch_src_global generation:  0.01819443702697754
r_  generation:  0.14245009422302246
local_output_nid generation:  0.008550643920898438
local_in_edges_tensor generation:  0.007571220397949219
mini_batch_src_global generation:  0.01860809326171875
r_  generation:  0.14724040031433105
local_output_nid generation:  0.008688688278198242
local_in_edges_tensor generation:  0.008530855178833008
mini_batch_src_global generation:  0.01845097541809082
r_  generation:  0.14836883544921875
local_output_nid generation:  0.008321285247802734
local_in_edges_tensor generation:  0.008094310760498047
mini_batch_src_global generation:  0.019342899322509766
r_  generation:  0.15095043182373047
local_output_nid generation:  0.008642196655273438
local_in_edges_tensor generation:  0.0077724456787109375
mini_batch_src_global generation:  0.01891613006591797
r_  generation:  0.14722108840942383
local_output_nid generation:  0.008439064025878906
local_in_edges_tensor generation:  0.007858037948608398
mini_batch_src_global generation:  0.018198490142822266
r_  generation:  0.14844584465026855
local_output_nid generation:  0.008768796920776367
local_in_edges_tensor generation:  0.00928354263305664
mini_batch_src_global generation:  0.019365549087524414
r_  generation:  0.1519768238067627
local_output_nid generation:  0.008640527725219727
local_in_edges_tensor generation:  0.010465860366821289
mini_batch_src_global generation:  0.019638776779174805
r_  generation:  0.1525864601135254
local_output_nid generation:  0.009259462356567383
local_in_edges_tensor generation:  0.008152484893798828
mini_batch_src_global generation:  0.018939495086669922
r_  generation:  0.15640902519226074
local_output_nid generation:  0.009531736373901367
local_in_edges_tensor generation:  0.008222579956054688
mini_batch_src_global generation:  0.018806934356689453
r_  generation:  0.1497640609741211
local_output_nid generation:  0.00865626335144043
local_in_edges_tensor generation:  0.008040666580200195
mini_batch_src_global generation:  0.018764019012451172
r_  generation:  0.14957237243652344
local_output_nid generation:  0.008871316909790039
local_in_edges_tensor generation:  0.00798487663269043
mini_batch_src_global generation:  0.01848745346069336
r_  generation:  0.14850425720214844
local_output_nid generation:  0.008547306060791016
local_in_edges_tensor generation:  0.007441520690917969
mini_batch_src_global generation:  0.018244266510009766
r_  generation:  0.1432323455810547
local_output_nid generation:  0.008219003677368164
local_in_edges_tensor generation:  0.008122682571411133
mini_batch_src_global generation:  0.017489194869995117
r_  generation:  0.14218664169311523
----------------------check_connections_block total spend ----------------------------- 7.194910287857056
generate_one_block  0.18774008750915527
generate_one_block  0.1728668212890625
generate_one_block  0.17648005485534668
generate_one_block  0.17443442344665527
generate_one_block  0.20917081832885742
generate_one_block  0.1722867488861084
generate_one_block  0.1841127872467041
generate_one_block  0.16941046714782715
generate_one_block  0.17026042938232422
generate_one_block  0.17880034446716309
generate_one_block  0.177138090133667
generate_one_block  0.17022418975830078
generate_one_block  0.17899298667907715
generate_one_block  0.18459486961364746
generate_one_block  0.19062256813049316
generate_one_block  0.18440985679626465
generate_one_block  0.17856550216674805
generate_one_block  0.17476367950439453
generate_one_block  0.17391419410705566
generate_one_block  0.18688178062438965
generate_one_block  0.1845855712890625
generate_one_block  0.18936395645141602
generate_one_block  0.1815791130065918
generate_one_block  0.17892742156982422
generate_one_block  0.1861581802368164
generate_one_block  0.18761563301086426
generate_one_block  0.18499350547790527
generate_one_block  0.1792736053466797
generate_one_block  0.1833934783935547
generate_one_block  0.17959856986999512
generate_one_block  0.1768786907196045
generate_one_block  0.17305970191955566
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032797813415527344
gen group dst list time:  0.10969996452331543
time for parepare:  0.020649194717407227
local_output_nid generation:  0.02285313606262207
local_in_edges_tensor generation:  0.043025970458984375
mini_batch_src_global generation:  0.03716397285461426
r_  generation:  0.40207767486572266
local_output_nid generation:  0.029552459716796875
local_in_edges_tensor generation:  0.0320589542388916
mini_batch_src_global generation:  0.04628252983093262
r_  generation:  0.39244627952575684
local_output_nid generation:  0.028844356536865234
local_in_edges_tensor generation:  0.027312278747558594
mini_batch_src_global generation:  0.04633641242980957
r_  generation:  0.40692853927612305
local_output_nid generation:  0.028229713439941406
local_in_edges_tensor generation:  0.031195878982543945
mini_batch_src_global generation:  0.047728538513183594
r_  generation:  0.3990180492401123
local_output_nid generation:  0.0289306640625
local_in_edges_tensor generation:  0.027342557907104492
mini_batch_src_global generation:  0.04712724685668945
r_  generation:  0.4109368324279785
local_output_nid generation:  0.029766559600830078
local_in_edges_tensor generation:  0.02576422691345215
mini_batch_src_global generation:  0.0487360954284668
r_  generation:  0.408123254776001
local_output_nid generation:  0.026987791061401367
local_in_edges_tensor generation:  0.025155305862426758
mini_batch_src_global generation:  0.04722332954406738
r_  generation:  0.41106176376342773
local_output_nid generation:  0.026468753814697266
local_in_edges_tensor generation:  0.027497291564941406
mini_batch_src_global generation:  0.04810333251953125
r_  generation:  0.39595937728881836
local_output_nid generation:  0.02738332748413086
local_in_edges_tensor generation:  0.0263516902923584
mini_batch_src_global generation:  0.04829740524291992
r_  generation:  0.40742921829223633
local_output_nid generation:  0.02750873565673828
local_in_edges_tensor generation:  0.030546903610229492
mini_batch_src_global generation:  0.05198478698730469
r_  generation:  0.40300822257995605
local_output_nid generation:  0.026941299438476562
local_in_edges_tensor generation:  0.027233123779296875
mini_batch_src_global generation:  0.04713249206542969
r_  generation:  0.4096353054046631
local_output_nid generation:  0.02691650390625
local_in_edges_tensor generation:  0.025196552276611328
mini_batch_src_global generation:  0.04982805252075195
r_  generation:  0.3999745845794678
local_output_nid generation:  0.02685999870300293
local_in_edges_tensor generation:  0.028257131576538086
mini_batch_src_global generation:  0.04626345634460449
r_  generation:  0.4054996967315674
local_output_nid generation:  0.027370214462280273
local_in_edges_tensor generation:  0.028872966766357422
mini_batch_src_global generation:  0.04887557029724121
r_  generation:  0.40642666816711426
local_output_nid generation:  0.028285503387451172
local_in_edges_tensor generation:  0.02909231185913086
mini_batch_src_global generation:  0.04738497734069824
r_  generation:  0.40691280364990234
local_output_nid generation:  0.027506113052368164
local_in_edges_tensor generation:  0.026076555252075195
mini_batch_src_global generation:  0.05042552947998047
r_  generation:  0.40648961067199707
local_output_nid generation:  0.027325868606567383
local_in_edges_tensor generation:  0.028731584548950195
mini_batch_src_global generation:  0.04691433906555176
r_  generation:  0.41060757637023926
local_output_nid generation:  0.02703261375427246
local_in_edges_tensor generation:  0.028974056243896484
mini_batch_src_global generation:  0.04821348190307617
r_  generation:  0.4078946113586426
local_output_nid generation:  0.02850484848022461
local_in_edges_tensor generation:  0.02845144271850586
mini_batch_src_global generation:  0.048887014389038086
r_  generation:  0.40543246269226074
local_output_nid generation:  0.02739238739013672
local_in_edges_tensor generation:  0.0254058837890625
mini_batch_src_global generation:  0.04877901077270508
r_  generation:  0.40244150161743164
local_output_nid generation:  0.027116775512695312
local_in_edges_tensor generation:  0.027259111404418945
mini_batch_src_global generation:  0.04858899116516113
r_  generation:  0.4048917293548584
local_output_nid generation:  0.027503490447998047
local_in_edges_tensor generation:  0.026023387908935547
mini_batch_src_global generation:  0.048534393310546875
r_  generation:  0.40478014945983887
local_output_nid generation:  0.02747321128845215
local_in_edges_tensor generation:  0.02789306640625
mini_batch_src_global generation:  0.0467832088470459
r_  generation:  0.4057300090789795
local_output_nid generation:  0.027257919311523438
local_in_edges_tensor generation:  0.02611374855041504
mini_batch_src_global generation:  0.04834866523742676
r_  generation:  0.39882874488830566
local_output_nid generation:  0.027358055114746094
local_in_edges_tensor generation:  0.026990413665771484
mini_batch_src_global generation:  0.04882693290710449
r_  generation:  0.40860509872436523
local_output_nid generation:  0.027276992797851562
local_in_edges_tensor generation:  0.027001142501831055
mini_batch_src_global generation:  0.05020856857299805
r_  generation:  0.4048333168029785
local_output_nid generation:  0.02763962745666504
local_in_edges_tensor generation:  0.025028467178344727
mini_batch_src_global generation:  0.04762387275695801
r_  generation:  0.4128451347351074
local_output_nid generation:  0.027498960494995117
local_in_edges_tensor generation:  0.0272524356842041
mini_batch_src_global generation:  0.04879188537597656
r_  generation:  0.40523529052734375
local_output_nid generation:  0.027332782745361328
local_in_edges_tensor generation:  0.027126550674438477
mini_batch_src_global generation:  0.04706454277038574
r_  generation:  0.40990233421325684
local_output_nid generation:  0.02742767333984375
local_in_edges_tensor generation:  0.029113054275512695
mini_batch_src_global generation:  0.04851818084716797
r_  generation:  0.40375590324401855
local_output_nid generation:  0.027544498443603516
local_in_edges_tensor generation:  0.025557756423950195
mini_batch_src_global generation:  0.04651069641113281
r_  generation:  0.401047945022583
local_output_nid generation:  0.02709674835205078
local_in_edges_tensor generation:  0.025834321975708008
mini_batch_src_global generation:  0.04706573486328125
r_  generation:  0.3997154235839844
----------------------check_connections_block total spend ----------------------------- 19.165448904037476
generate_one_block  0.5405936241149902
generate_one_block  0.5270082950592041
generate_one_block  0.5315618515014648
generate_one_block  0.5289528369903564
generate_one_block  0.6241998672485352
generate_one_block  0.5262219905853271
generate_one_block  0.5367355346679688
generate_one_block  0.5228128433227539
generate_one_block  0.5356078147888184
generate_one_block  0.5376508235931396
generate_one_block  0.5320913791656494
generate_one_block  0.532135009765625
generate_one_block  0.5288891792297363
generate_one_block  0.5367076396942139
generate_one_block  0.5374469757080078
generate_one_block  0.5443782806396484
generate_one_block  0.5345160961151123
generate_one_block  0.5345451831817627
generate_one_block  0.5301241874694824
generate_one_block  0.5371851921081543
generate_one_block  0.538433313369751
generate_one_block  0.5446498394012451
generate_one_block  0.5404431819915771
generate_one_block  0.5297067165374756
generate_one_block  0.5501337051391602
generate_one_block  0.5410988330841064
generate_one_block  0.5422074794769287
generate_one_block  0.5400354862213135
generate_one_block  0.5444724559783936
generate_one_block  0.5392558574676514
generate_one_block  0.5404050350189209
generate_one_block  0.5303370952606201
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.12025070190429688  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

connection checking time:  26.36035919189453
block generation total time  23.021641731262207
average batch blocks generation time:  0.719426304101944
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10399484634399414  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.695603847503662  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10294628143310547  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.444722652435303  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1049952507019043  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.764877796173096  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10294628143310547  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.574644565582275  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1050271987915039  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.908371925354004  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10261201858520508  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.475578784942627  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10408163070678711  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.04842185974121  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1026906967163086  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.29326343536377  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.102783203125  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.422321319580078  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10321474075317383  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.71294641494751  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10268974304199219  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.629703521728516  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10259723663330078  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.446109294891357  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10275506973266602  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.527946472167969  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10412168502807617  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.759968757629395  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10389328002929688  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.553285598754883  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1041860580444336  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.88961935043335  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10394763946533203  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.644443988800049  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10288333892822266  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.549402713775635  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1028289794921875  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.4984769821167  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1040949821472168  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.808504581451416  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1039423942565918  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.890697002410889  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10422277450561523  GigaBytes
Max Memory Allocated: 16.158446788787842  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.132795810699463  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1050114631652832  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.831521034240723  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10313177108764648  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.596319675445557  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10503816604614258  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.948883056640625  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10409355163574219  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.867900848388672  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10504722595214844  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.006989002227783  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1041259765625  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.897294998168945  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10395383834838867  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.880475044250488  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10433387756347656  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.82615852355957  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10270977020263672  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.386934757232666  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10258865356445312  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.31371259689331  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037720538675785065 |0.012470290064811707 |0.2648417353630066 |9.179115295410156e-05 |0.42848867177963257 |0.0035867691040039062 |
----------------------------------------------------------pseudo_mini_loss sum 1.7259595394134521
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  8577232
Number of first layer input nodes during this epoch:  4654906
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.11961126327514648  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022777318954467773
range selection method range initialization spend 0.012847185134887695
time for parepare:  0.02100682258605957
local_output_nid generation:  0.0009272098541259766
local_in_edges_tensor generation:  0.005979776382446289
mini_batch_src_global generation:  0.0014295578002929688
r_  generation:  0.00830221176147461
local_output_nid generation:  0.0009407997131347656
local_in_edges_tensor generation:  0.0006084442138671875
mini_batch_src_global generation:  0.0012791156768798828
r_  generation:  0.008783817291259766
local_output_nid generation:  0.0008914470672607422
local_in_edges_tensor generation:  0.0005495548248291016
mini_batch_src_global generation:  0.0009684562683105469
r_  generation:  0.008104324340820312
local_output_nid generation:  0.0009047985076904297
local_in_edges_tensor generation:  0.0005075931549072266
mini_batch_src_global generation:  0.000843048095703125
r_  generation:  0.007740497589111328
local_output_nid generation:  0.0008854866027832031
local_in_edges_tensor generation:  0.0005052089691162109
mini_batch_src_global generation:  0.0008287429809570312
r_  generation:  0.008011579513549805
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0005121231079101562
mini_batch_src_global generation:  0.000926971435546875
r_  generation:  0.008001565933227539
local_output_nid generation:  0.0008380413055419922
local_in_edges_tensor generation:  0.0005173683166503906
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.00810551643371582
local_output_nid generation:  0.0008273124694824219
local_in_edges_tensor generation:  0.0004913806915283203
mini_batch_src_global generation:  0.0008289813995361328
r_  generation:  0.008103370666503906
local_output_nid generation:  0.0008227825164794922
local_in_edges_tensor generation:  0.0004839897155761719
mini_batch_src_global generation:  0.0008077621459960938
r_  generation:  0.008196353912353516
local_output_nid generation:  0.0008089542388916016
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.0008602142333984375
r_  generation:  0.00804448127746582
local_output_nid generation:  0.000850677490234375
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.0008537769317626953
r_  generation:  0.008143424987792969
local_output_nid generation:  0.0008022785186767578
local_in_edges_tensor generation:  0.00048828125
mini_batch_src_global generation:  0.00084686279296875
r_  generation:  0.00795125961303711
local_output_nid generation:  0.0008089542388916016
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.00084686279296875
r_  generation:  0.008026361465454102
local_output_nid generation:  0.0008218288421630859
local_in_edges_tensor generation:  0.0004787445068359375
mini_batch_src_global generation:  0.0008716583251953125
r_  generation:  0.008266210556030273
local_output_nid generation:  0.0008084774017333984
local_in_edges_tensor generation:  0.00048661231994628906
mini_batch_src_global generation:  0.0008690357208251953
r_  generation:  0.008071422576904297
local_output_nid generation:  0.0008068084716796875
local_in_edges_tensor generation:  0.0004985332489013672
mini_batch_src_global generation:  0.0008285045623779297
r_  generation:  0.008044958114624023
local_output_nid generation:  0.0008149147033691406
local_in_edges_tensor generation:  0.00047016143798828125
mini_batch_src_global generation:  0.0008347034454345703
r_  generation:  0.00811767578125
local_output_nid generation:  0.0008015632629394531
local_in_edges_tensor generation:  0.0004925727844238281
mini_batch_src_global generation:  0.000988006591796875
r_  generation:  0.008403778076171875
local_output_nid generation:  0.0008137226104736328
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.0008816719055175781
r_  generation:  0.008277654647827148
local_output_nid generation:  0.0008211135864257812
local_in_edges_tensor generation:  0.0005004405975341797
mini_batch_src_global generation:  0.0008835792541503906
r_  generation:  0.008347272872924805
local_output_nid generation:  0.0007977485656738281
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.0008511543273925781
r_  generation:  0.008121728897094727
local_output_nid generation:  0.0008096694946289062
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0008440017700195312
r_  generation:  0.008269786834716797
local_output_nid generation:  0.0008080005645751953
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0008268356323242188
r_  generation:  0.007979631423950195
local_output_nid generation:  0.0008132457733154297
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.0008406639099121094
r_  generation:  0.008022069931030273
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.00047278404235839844
mini_batch_src_global generation:  0.0008587837219238281
r_  generation:  0.008246183395385742
local_output_nid generation:  0.0007939338684082031
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0008478164672851562
r_  generation:  0.008348464965820312
local_output_nid generation:  0.0008070468902587891
local_in_edges_tensor generation:  0.00047659873962402344
mini_batch_src_global generation:  0.0008380413055419922
r_  generation:  0.009704828262329102
local_output_nid generation:  0.0008149147033691406
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0008733272552490234
r_  generation:  0.008225679397583008
local_output_nid generation:  0.0008084774017333984
local_in_edges_tensor generation:  0.0005059242248535156
mini_batch_src_global generation:  0.0008456707000732422
r_  generation:  0.008204460144042969
local_output_nid generation:  0.0007922649383544922
local_in_edges_tensor generation:  0.0004947185516357422
mini_batch_src_global generation:  0.0008323192596435547
r_  generation:  0.007992267608642578
local_output_nid generation:  0.0007979869842529297
local_in_edges_tensor generation:  0.0004792213439941406
mini_batch_src_global generation:  0.0008375644683837891
r_  generation:  0.008197307586669922
local_output_nid generation:  0.0008001327514648438
local_in_edges_tensor generation:  0.0004885196685791016
mini_batch_src_global generation:  0.0008230209350585938
r_  generation:  0.008011579513549805
----------------------check_connections_block total spend ----------------------------- 0.4270143508911133
generate_one_block  0.019852638244628906
generate_one_block  0.01709437370300293
generate_one_block  0.015173196792602539
generate_one_block  0.014321565628051758
generate_one_block  0.014632225036621094
generate_one_block  0.014464378356933594
generate_one_block  0.014478921890258789
generate_one_block  0.014452457427978516
generate_one_block  0.01592111587524414
generate_one_block  0.014377593994140625
generate_one_block  0.014383316040039062
generate_one_block  0.01426553726196289
generate_one_block  0.014171600341796875
generate_one_block  0.014469623565673828
generate_one_block  0.014163494110107422
generate_one_block  0.014051437377929688
generate_one_block  0.014310836791992188
generate_one_block  0.01466226577758789
generate_one_block  0.014804363250732422
generate_one_block  0.014719009399414062
generate_one_block  0.014152288436889648
generate_one_block  0.014259576797485352
generate_one_block  0.01660013198852539
generate_one_block  0.014119386672973633
generate_one_block  0.01444697380065918
generate_one_block  0.01450037956237793
generate_one_block  0.014293909072875977
generate_one_block  0.014288902282714844
generate_one_block  0.014322996139526367
generate_one_block  0.01401519775390625
generate_one_block  0.01436305046081543
generate_one_block  0.014054298400878906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036515235900878906
gen group dst list time:  0.02146148681640625
time for parepare:  0.02333807945251465
local_output_nid generation:  0.004626274108886719
local_in_edges_tensor generation:  0.014742374420166016
mini_batch_src_global generation:  0.012526750564575195
r_  generation:  0.11758279800415039
local_output_nid generation:  0.006647586822509766
local_in_edges_tensor generation:  0.010155916213989258
mini_batch_src_global generation:  0.016242265701293945
r_  generation:  0.16507911682128906
local_output_nid generation:  0.006862163543701172
local_in_edges_tensor generation:  0.029707908630371094
mini_batch_src_global generation:  0.017057180404663086
r_  generation:  0.1380615234375
local_output_nid generation:  0.00690460205078125
local_in_edges_tensor generation:  0.0073757171630859375
mini_batch_src_global generation:  0.018153667449951172
r_  generation:  0.13669037818908691
local_output_nid generation:  0.009368181228637695
local_in_edges_tensor generation:  0.007510185241699219
mini_batch_src_global generation:  0.018908023834228516
r_  generation:  0.13926267623901367
local_output_nid generation:  0.007497549057006836
local_in_edges_tensor generation:  0.013147830963134766
mini_batch_src_global generation:  0.01732611656188965
r_  generation:  0.13912010192871094
local_output_nid generation:  0.007574558258056641
local_in_edges_tensor generation:  0.010228395462036133
mini_batch_src_global generation:  0.01704883575439453
r_  generation:  0.1401674747467041
local_output_nid generation:  0.007821798324584961
local_in_edges_tensor generation:  0.00748896598815918
mini_batch_src_global generation:  0.02007603645324707
r_  generation:  0.13820791244506836
local_output_nid generation:  0.007420778274536133
local_in_edges_tensor generation:  0.007291555404663086
mini_batch_src_global generation:  0.01626443862915039
r_  generation:  0.13510584831237793
local_output_nid generation:  0.00736689567565918
local_in_edges_tensor generation:  0.00776362419128418
mini_batch_src_global generation:  0.01595759391784668
r_  generation:  0.13459134101867676
local_output_nid generation:  0.007734775543212891
local_in_edges_tensor generation:  0.008867263793945312
mini_batch_src_global generation:  0.016879558563232422
r_  generation:  0.13909602165222168
local_output_nid generation:  0.007623434066772461
local_in_edges_tensor generation:  0.007174491882324219
mini_batch_src_global generation:  0.016335725784301758
r_  generation:  0.13399791717529297
local_output_nid generation:  0.007780551910400391
local_in_edges_tensor generation:  0.007344961166381836
mini_batch_src_global generation:  0.016072988510131836
r_  generation:  0.13624119758605957
local_output_nid generation:  0.008010387420654297
local_in_edges_tensor generation:  0.008453130722045898
mini_batch_src_global generation:  0.017435073852539062
r_  generation:  0.13994932174682617
local_output_nid generation:  0.007797956466674805
local_in_edges_tensor generation:  0.007233619689941406
mini_batch_src_global generation:  0.016108989715576172
r_  generation:  0.13667893409729004
local_output_nid generation:  0.007862091064453125
local_in_edges_tensor generation:  0.007368803024291992
mini_batch_src_global generation:  0.016289949417114258
r_  generation:  0.1359870433807373
local_output_nid generation:  0.00786733627319336
local_in_edges_tensor generation:  0.007360935211181641
mini_batch_src_global generation:  0.01610708236694336
r_  generation:  0.1372220516204834
local_output_nid generation:  0.008046388626098633
local_in_edges_tensor generation:  0.008087635040283203
mini_batch_src_global generation:  0.019464969635009766
r_  generation:  0.14491605758666992
local_output_nid generation:  0.00895071029663086
local_in_edges_tensor generation:  0.011232852935791016
mini_batch_src_global generation:  0.019275188446044922
r_  generation:  0.14531898498535156
local_output_nid generation:  0.00820469856262207
local_in_edges_tensor generation:  0.008198976516723633
mini_batch_src_global generation:  0.01886439323425293
r_  generation:  0.14691996574401855
local_output_nid generation:  0.008213996887207031
local_in_edges_tensor generation:  0.00737452507019043
mini_batch_src_global generation:  0.02361273765563965
r_  generation:  0.1401960849761963
local_output_nid generation:  0.009185552597045898
local_in_edges_tensor generation:  0.007967233657836914
mini_batch_src_global generation:  0.016654491424560547
r_  generation:  0.1396780014038086
local_output_nid generation:  0.008113861083984375
local_in_edges_tensor generation:  0.007741689682006836
mini_batch_src_global generation:  0.016262531280517578
r_  generation:  0.13851213455200195
local_output_nid generation:  0.008175134658813477
local_in_edges_tensor generation:  0.007182121276855469
mini_batch_src_global generation:  0.016405105590820312
r_  generation:  0.13643145561218262
local_output_nid generation:  0.008323907852172852
local_in_edges_tensor generation:  0.008069753646850586
mini_batch_src_global generation:  0.017105817794799805
r_  generation:  0.1423778533935547
local_output_nid generation:  0.00826263427734375
local_in_edges_tensor generation:  0.009211063385009766
mini_batch_src_global generation:  0.016942739486694336
r_  generation:  0.1417529582977295
local_output_nid generation:  0.008274078369140625
local_in_edges_tensor generation:  0.00786280632019043
mini_batch_src_global generation:  0.016337871551513672
r_  generation:  0.14072489738464355
local_output_nid generation:  0.008228778839111328
local_in_edges_tensor generation:  0.007482767105102539
mini_batch_src_global generation:  0.016767263412475586
r_  generation:  0.13974690437316895
local_output_nid generation:  0.008263826370239258
local_in_edges_tensor generation:  0.007849931716918945
mini_batch_src_global generation:  0.017247438430786133
r_  generation:  0.1403636932373047
local_output_nid generation:  0.008133649826049805
local_in_edges_tensor generation:  0.007412910461425781
mini_batch_src_global generation:  0.016368865966796875
r_  generation:  0.13809990882873535
local_output_nid generation:  0.008249759674072266
local_in_edges_tensor generation:  0.0076313018798828125
mini_batch_src_global generation:  0.016141414642333984
r_  generation:  0.19065499305725098
local_output_nid generation:  0.007932901382446289
local_in_edges_tensor generation:  0.007383584976196289
mini_batch_src_global generation:  0.016770601272583008
r_  generation:  0.136549711227417
----------------------check_connections_block total spend ----------------------------- 6.664746046066284
generate_one_block  0.17535138130187988
generate_one_block  0.18020105361938477
generate_one_block  0.17888236045837402
generate_one_block  0.17669892311096191
generate_one_block  0.20504045486450195
generate_one_block  0.17700886726379395
generate_one_block  0.1739814281463623
generate_one_block  0.1795520782470703
generate_one_block  0.1729447841644287
generate_one_block  0.17258477210998535
generate_one_block  0.17719030380249023
generate_one_block  0.17085552215576172
generate_one_block  0.17827129364013672
generate_one_block  0.19062566757202148
generate_one_block  0.1738874912261963
generate_one_block  0.17294955253601074
generate_one_block  0.17400312423706055
generate_one_block  0.1836109161376953
generate_one_block  0.1819765567779541
generate_one_block  0.1876075267791748
generate_one_block  0.1744518280029297
generate_one_block  0.17677545547485352
generate_one_block  0.17647075653076172
generate_one_block  0.17206048965454102
generate_one_block  0.17935705184936523
generate_one_block  0.18135714530944824
generate_one_block  0.17921018600463867
generate_one_block  0.17478537559509277
generate_one_block  0.1786057949066162
generate_one_block  0.17305326461791992
generate_one_block  0.1773371696472168
generate_one_block  0.17079401016235352
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04162430763244629
gen group dst list time:  0.12282323837280273
time for parepare:  0.019929170608520508
local_output_nid generation:  0.02213311195373535
local_in_edges_tensor generation:  0.04492664337158203
mini_batch_src_global generation:  0.036566734313964844
r_  generation:  0.3915872573852539
local_output_nid generation:  0.02769923210144043
local_in_edges_tensor generation:  0.032067298889160156
mini_batch_src_global generation:  0.048566341400146484
r_  generation:  0.40237879753112793
local_output_nid generation:  0.029501914978027344
local_in_edges_tensor generation:  0.034775495529174805
mini_batch_src_global generation:  0.04577517509460449
r_  generation:  0.4180734157562256
local_output_nid generation:  0.028318405151367188
local_in_edges_tensor generation:  0.034781455993652344
mini_batch_src_global generation:  0.049513816833496094
r_  generation:  0.4226362705230713
local_output_nid generation:  0.03179359436035156
local_in_edges_tensor generation:  0.030583620071411133
mini_batch_src_global generation:  0.05012989044189453
r_  generation:  0.40595293045043945
local_output_nid generation:  0.028491497039794922
local_in_edges_tensor generation:  0.026178359985351562
mini_batch_src_global generation:  0.047844648361206055
r_  generation:  0.40138673782348633
local_output_nid generation:  0.027394533157348633
local_in_edges_tensor generation:  0.028217792510986328
mini_batch_src_global generation:  0.04655098915100098
r_  generation:  0.4049232006072998
local_output_nid generation:  0.027312755584716797
local_in_edges_tensor generation:  0.026641130447387695
mini_batch_src_global generation:  0.048090457916259766
r_  generation:  0.40300822257995605
local_output_nid generation:  0.027161121368408203
local_in_edges_tensor generation:  0.025428295135498047
mini_batch_src_global generation:  0.05786728858947754
r_  generation:  0.41308021545410156
local_output_nid generation:  0.027220487594604492
local_in_edges_tensor generation:  0.02572011947631836
mini_batch_src_global generation:  0.04767322540283203
r_  generation:  0.40233683586120605
local_output_nid generation:  0.027620315551757812
local_in_edges_tensor generation:  0.02777719497680664
mini_batch_src_global generation:  0.04835343360900879
r_  generation:  0.41326284408569336
local_output_nid generation:  0.02706766128540039
local_in_edges_tensor generation:  0.026758432388305664
mini_batch_src_global generation:  0.04775547981262207
r_  generation:  0.4030792713165283
local_output_nid generation:  0.027867555618286133
local_in_edges_tensor generation:  0.02971816062927246
mini_batch_src_global generation:  0.05071234703063965
r_  generation:  0.40811967849731445
local_output_nid generation:  0.027372360229492188
local_in_edges_tensor generation:  0.028383970260620117
mini_batch_src_global generation:  0.048349618911743164
r_  generation:  0.4048116207122803
local_output_nid generation:  0.03306221961975098
local_in_edges_tensor generation:  0.02896404266357422
mini_batch_src_global generation:  0.05581307411193848
r_  generation:  0.4054079055786133
local_output_nid generation:  0.02919912338256836
local_in_edges_tensor generation:  0.026996612548828125
mini_batch_src_global generation:  0.04757833480834961
r_  generation:  0.3961048126220703
local_output_nid generation:  0.02717113494873047
local_in_edges_tensor generation:  0.027683496475219727
mini_batch_src_global generation:  0.04626941680908203
r_  generation:  0.4051203727722168
local_output_nid generation:  0.027870655059814453
local_in_edges_tensor generation:  0.02700495719909668
mini_batch_src_global generation:  0.04836273193359375
r_  generation:  0.4043421745300293
local_output_nid generation:  0.02781963348388672
local_in_edges_tensor generation:  0.030635833740234375
mini_batch_src_global generation:  0.046807050704956055
r_  generation:  0.4122426509857178
local_output_nid generation:  0.027321815490722656
local_in_edges_tensor generation:  0.04031944274902344
mini_batch_src_global generation:  0.04844498634338379
r_  generation:  0.40781450271606445
local_output_nid generation:  0.027429819107055664
local_in_edges_tensor generation:  0.024734973907470703
mini_batch_src_global generation:  0.04663658142089844
r_  generation:  0.41660237312316895
local_output_nid generation:  0.027261734008789062
local_in_edges_tensor generation:  0.02725505828857422
mini_batch_src_global generation:  0.04889822006225586
r_  generation:  0.40720033645629883
local_output_nid generation:  0.027378320693969727
local_in_edges_tensor generation:  0.029410839080810547
mini_batch_src_global generation:  0.04647374153137207
r_  generation:  0.40992212295532227
local_output_nid generation:  0.027381420135498047
local_in_edges_tensor generation:  0.02676105499267578
mini_batch_src_global generation:  0.049869537353515625
r_  generation:  0.4088871479034424
local_output_nid generation:  0.027636051177978516
local_in_edges_tensor generation:  0.030602216720581055
mini_batch_src_global generation:  0.047026634216308594
r_  generation:  0.41494297981262207
local_output_nid generation:  0.02768087387084961
local_in_edges_tensor generation:  0.025972604751586914
mini_batch_src_global generation:  0.048375606536865234
r_  generation:  0.4031345844268799
local_output_nid generation:  0.0274198055267334
local_in_edges_tensor generation:  0.027439594268798828
mini_batch_src_global generation:  0.04683208465576172
r_  generation:  0.4137411117553711
local_output_nid generation:  0.02750873565673828
local_in_edges_tensor generation:  0.025504589080810547
mini_batch_src_global generation:  0.05021238327026367
r_  generation:  0.41014599800109863
local_output_nid generation:  0.027374267578125
local_in_edges_tensor generation:  0.030833721160888672
mini_batch_src_global generation:  0.04847550392150879
r_  generation:  0.41378211975097656
local_output_nid generation:  0.027603626251220703
local_in_edges_tensor generation:  0.028901338577270508
mini_batch_src_global generation:  0.050688982009887695
r_  generation:  0.4018087387084961
local_output_nid generation:  0.027905702590942383
local_in_edges_tensor generation:  0.03408646583557129
mini_batch_src_global generation:  0.04709219932556152
r_  generation:  0.4151945114135742
local_output_nid generation:  0.027203798294067383
local_in_edges_tensor generation:  0.026701688766479492
mini_batch_src_global generation:  0.049634456634521484
r_  generation:  0.40137338638305664
----------------------check_connections_block total spend ----------------------------- 19.334330320358276
generate_one_block  0.5429055690765381
generate_one_block  0.540327787399292
generate_one_block  0.5379559993743896
generate_one_block  0.534959077835083
generate_one_block  0.6302430629730225
generate_one_block  0.5341348648071289
generate_one_block  0.5388610363006592
generate_one_block  0.5410261154174805
generate_one_block  0.5281431674957275
generate_one_block  0.5267295837402344
generate_one_block  0.534792423248291
generate_one_block  0.5294773578643799
generate_one_block  0.5377333164215088
generate_one_block  0.5366294384002686
generate_one_block  0.5309605598449707
generate_one_block  0.5289561748504639
generate_one_block  0.528059720993042
generate_one_block  0.548698902130127
generate_one_block  0.5451750755310059
generate_one_block  0.5377278327941895
generate_one_block  0.5366115570068359
generate_one_block  0.5332226753234863
generate_one_block  0.5332591533660889
generate_one_block  0.5373387336730957
generate_one_block  0.562777042388916
generate_one_block  0.5422165393829346
generate_one_block  0.5444867610931396
generate_one_block  0.5397067070007324
generate_one_block  0.530543327331543
generate_one_block  0.5295512676239014
generate_one_block  0.5393946170806885
generate_one_block  0.525799036026001
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.11961126327514648  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

connection checking time:  25.99907636642456
block generation total time  22.96588706970215
average batch blocks generation time:  0.7176839709281921
block dataloader generation time/epoch 51.448952198028564
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10280418395996094  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.443825244903564  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10396909713745117  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.83902359008789  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10402393341064453  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.810128688812256  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10401201248168945  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.757899761199951  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10280752182006836  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.666444778442383  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10448598861694336  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.781893253326416  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10396957397460938  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.67305850982666  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10394811630249023  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.892728328704834  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10392951965332031  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.591192245483398  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10296010971069336  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.494998455047607  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10500764846801758  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.799876689910889  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10266971588134766  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.436180591583252  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10397720336914062  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.658098220825195  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1040811538696289  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.844618797302246  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10280990600585938  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.525900840759277  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10307073593139648  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.494358539581299  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1038980484008789  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.560284614562988  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1042013168334961  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.00566530227661  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10504150390625  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.009981155395508  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1041412353515625  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.070434093475342  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10398578643798828  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.7150239944458  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10300540924072266  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.741895198822021  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10292530059814453  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.621976852416992  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10312223434448242  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.595902442932129  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10502243041992188  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.91991376876831  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10407209396362305  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.927560806274414  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10397720336914062  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.805023670196533  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10309696197509766  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.727413654327393  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10289573669433594  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.711109638214111  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1029047966003418  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.485023021697998  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10500288009643555  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.748256206512451  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1027212142944336  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.4164137840271  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037014178931713104 |0.011550188064575195 |0.2617136389017105 |9.062141180038452e-05 |0.42886198312044144 |0.00446009635925293 |
----------------------------------------------------------pseudo_mini_loss sum 1.6612790822982788
Total (block generation + training)time/epoch 75.16300368309021
Training time/epoch 23.71377658843994
Training time without block to device /epoch 23.344170570373535
Training time without total dataloading part /epoch 22.105779886245728
load block tensor time/epoch 1.1844537258148193
block to device time/epoch 0.36960601806640625
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  8581362
Number of first layer input nodes during this epoch:  4655975
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.11971044540405273  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02460169792175293
range selection method range initialization spend 0.01435995101928711
time for parepare:  0.02309274673461914
local_output_nid generation:  0.001123189926147461
local_in_edges_tensor generation:  0.004570722579956055
mini_batch_src_global generation:  0.004031181335449219
r_  generation:  0.008182764053344727
local_output_nid generation:  0.0009734630584716797
local_in_edges_tensor generation:  0.0006678104400634766
mini_batch_src_global generation:  0.0023653507232666016
r_  generation:  0.008675336837768555
local_output_nid generation:  0.0009305477142333984
local_in_edges_tensor generation:  0.0006036758422851562
mini_batch_src_global generation:  0.0012252330780029297
r_  generation:  0.007938385009765625
local_output_nid generation:  0.0009129047393798828
local_in_edges_tensor generation:  0.0006167888641357422
mini_batch_src_global generation:  0.0012578964233398438
r_  generation:  0.00828409194946289
local_output_nid generation:  0.0008919239044189453
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.0010690689086914062
r_  generation:  0.008016109466552734
local_output_nid generation:  0.0009112358093261719
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.0010712146759033203
r_  generation:  0.008353471755981445
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.0006055831909179688
mini_batch_src_global generation:  0.001138925552368164
r_  generation:  0.008423566818237305
local_output_nid generation:  0.0009009838104248047
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0010223388671875
r_  generation:  0.00833439826965332
local_output_nid generation:  0.00089263916015625
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.0010237693786621094
r_  generation:  0.008210897445678711
local_output_nid generation:  0.0009019374847412109
local_in_edges_tensor generation:  0.0005733966827392578
mini_batch_src_global generation:  0.0009968280792236328
r_  generation:  0.008352041244506836
local_output_nid generation:  0.0009224414825439453
local_in_edges_tensor generation:  0.0005428791046142578
mini_batch_src_global generation:  0.0009930133819580078
r_  generation:  0.008248090744018555
local_output_nid generation:  0.0009026527404785156
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.008231639862060547
local_output_nid generation:  0.0008916854858398438
local_in_edges_tensor generation:  0.0005471706390380859
mini_batch_src_global generation:  0.0009794235229492188
r_  generation:  0.008418798446655273
local_output_nid generation:  0.0009052753448486328
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.001049041748046875
r_  generation:  0.008404970169067383
local_output_nid generation:  0.0009090900421142578
local_in_edges_tensor generation:  0.0005710124969482422
mini_batch_src_global generation:  0.001188039779663086
r_  generation:  0.008137941360473633
local_output_nid generation:  0.0009064674377441406
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0010259151458740234
r_  generation:  0.008305072784423828
local_output_nid generation:  0.0009143352508544922
local_in_edges_tensor generation:  0.0005495548248291016
mini_batch_src_global generation:  0.001012563705444336
r_  generation:  0.008469820022583008
local_output_nid generation:  0.000904083251953125
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0010509490966796875
r_  generation:  0.008474349975585938
local_output_nid generation:  0.0009121894836425781
local_in_edges_tensor generation:  0.0005528926849365234
mini_batch_src_global generation:  0.0009920597076416016
r_  generation:  0.008171558380126953
local_output_nid generation:  0.0009026527404785156
local_in_edges_tensor generation:  0.0005373954772949219
mini_batch_src_global generation:  0.0009627342224121094
r_  generation:  0.00815129280090332
local_output_nid generation:  0.0009021759033203125
local_in_edges_tensor generation:  0.0005550384521484375
mini_batch_src_global generation:  0.0009989738464355469
r_  generation:  0.008429765701293945
local_output_nid generation:  0.0009028911590576172
local_in_edges_tensor generation:  0.0005488395690917969
mini_batch_src_global generation:  0.0009903907775878906
r_  generation:  0.008206367492675781
local_output_nid generation:  0.0009055137634277344
local_in_edges_tensor generation:  0.0005495548248291016
mini_batch_src_global generation:  0.0010042190551757812
r_  generation:  0.008408069610595703
local_output_nid generation:  0.0008864402770996094
local_in_edges_tensor generation:  0.0005435943603515625
mini_batch_src_global generation:  0.0010008811950683594
r_  generation:  0.008556842803955078
local_output_nid generation:  0.0008897781372070312
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0011601448059082031
r_  generation:  0.008033514022827148
local_output_nid generation:  0.0008840560913085938
local_in_edges_tensor generation:  0.0005338191986083984
mini_batch_src_global generation:  0.0010018348693847656
r_  generation:  0.008466005325317383
local_output_nid generation:  0.0008814334869384766
local_in_edges_tensor generation:  0.0005578994750976562
mini_batch_src_global generation:  0.0010311603546142578
r_  generation:  0.008465766906738281
local_output_nid generation:  0.0009434223175048828
local_in_edges_tensor generation:  0.00055694580078125
mini_batch_src_global generation:  0.0009853839874267578
r_  generation:  0.008388042449951172
local_output_nid generation:  0.0008571147918701172
local_in_edges_tensor generation:  0.0005614757537841797
mini_batch_src_global generation:  0.0010190010070800781
r_  generation:  0.008455038070678711
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0005478858947753906
mini_batch_src_global generation:  0.000982522964477539
r_  generation:  0.00827646255493164
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0005402565002441406
mini_batch_src_global generation:  0.0010111331939697266
r_  generation:  0.008290767669677734
local_output_nid generation:  0.0008909702301025391
local_in_edges_tensor generation:  0.0005815029144287109
mini_batch_src_global generation:  0.001009225845336914
r_  generation:  0.008274555206298828
----------------------check_connections_block total spend ----------------------------- 0.45166683197021484
generate_one_block  0.022919893264770508
generate_one_block  0.018871068954467773
generate_one_block  0.015885591506958008
generate_one_block  0.015704631805419922
generate_one_block  0.01526498794555664
generate_one_block  0.01534128189086914
generate_one_block  0.01536703109741211
generate_one_block  0.015363693237304688
generate_one_block  0.015190601348876953
generate_one_block  0.015030860900878906
generate_one_block  0.015126466751098633
generate_one_block  0.015124797821044922
generate_one_block  0.015156030654907227
generate_one_block  0.015284299850463867
generate_one_block  0.014790773391723633
generate_one_block  0.01490473747253418
generate_one_block  0.01542043685913086
generate_one_block  0.015351295471191406
generate_one_block  0.014851808547973633
generate_one_block  0.014754056930541992
generate_one_block  0.015166044235229492
generate_one_block  0.014764070510864258
generate_one_block  0.015042543411254883
generate_one_block  0.015111446380615234
generate_one_block  0.014545202255249023
generate_one_block  0.01532435417175293
generate_one_block  0.029265403747558594
generate_one_block  0.015247821807861328
generate_one_block  0.01490163803100586
generate_one_block  0.014423370361328125
generate_one_block  0.014494657516479492
generate_one_block  0.014216184616088867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03957796096801758
gen group dst list time:  0.024105310440063477
time for parepare:  0.021464109420776367
local_output_nid generation:  0.0044345855712890625
local_in_edges_tensor generation:  0.014772891998291016
mini_batch_src_global generation:  0.01529240608215332
r_  generation:  0.12100362777709961
local_output_nid generation:  0.006562471389770508
local_in_edges_tensor generation:  0.00843358039855957
mini_batch_src_global generation:  0.017197370529174805
r_  generation:  0.1269526481628418
local_output_nid generation:  0.006702423095703125
local_in_edges_tensor generation:  0.027844905853271484
mini_batch_src_global generation:  0.0199129581451416
r_  generation:  0.15701889991760254
local_output_nid generation:  0.009551525115966797
local_in_edges_tensor generation:  0.010543107986450195
mini_batch_src_global generation:  0.04349946975708008
r_  generation:  0.13676190376281738
local_output_nid generation:  0.007180929183959961
local_in_edges_tensor generation:  0.006735801696777344
mini_batch_src_global generation:  0.018170595169067383
r_  generation:  0.13772106170654297
local_output_nid generation:  0.007478952407836914
local_in_edges_tensor generation:  0.006888389587402344
mini_batch_src_global generation:  0.018171072006225586
r_  generation:  0.13588190078735352
local_output_nid generation:  0.007596254348754883
local_in_edges_tensor generation:  0.008423566818237305
mini_batch_src_global generation:  0.01926445960998535
r_  generation:  0.13760948181152344
local_output_nid generation:  0.007477283477783203
local_in_edges_tensor generation:  0.007569551467895508
mini_batch_src_global generation:  0.018743276596069336
r_  generation:  0.13833045959472656
local_output_nid generation:  0.00720667839050293
local_in_edges_tensor generation:  0.007472991943359375
mini_batch_src_global generation:  0.02661442756652832
r_  generation:  0.15422368049621582
local_output_nid generation:  0.011391162872314453
local_in_edges_tensor generation:  0.010132074356079102
mini_batch_src_global generation:  0.018955707550048828
r_  generation:  0.15388083457946777
local_output_nid generation:  0.012478113174438477
local_in_edges_tensor generation:  0.008937835693359375
mini_batch_src_global generation:  0.024940967559814453
r_  generation:  0.1382124423980713
local_output_nid generation:  0.008588552474975586
local_in_edges_tensor generation:  0.007300138473510742
mini_batch_src_global generation:  0.01862311363220215
r_  generation:  0.13823175430297852
local_output_nid generation:  0.008413314819335938
local_in_edges_tensor generation:  0.00747227668762207
mini_batch_src_global generation:  0.0163271427154541
r_  generation:  0.13802075386047363
local_output_nid generation:  0.008149862289428711
local_in_edges_tensor generation:  0.0076673030853271484
mini_batch_src_global generation:  0.026329994201660156
r_  generation:  0.15791535377502441
local_output_nid generation:  0.011837959289550781
local_in_edges_tensor generation:  0.011151552200317383
mini_batch_src_global generation:  0.026190757751464844
r_  generation:  0.13752198219299316
local_output_nid generation:  0.009507179260253906
local_in_edges_tensor generation:  0.007055997848510742
mini_batch_src_global generation:  0.01854109764099121
r_  generation:  0.14017081260681152
local_output_nid generation:  0.009539127349853516
local_in_edges_tensor generation:  0.00861048698425293
mini_batch_src_global generation:  0.016806840896606445
r_  generation:  0.18448233604431152
local_output_nid generation:  0.010633707046508789
local_in_edges_tensor generation:  0.010549783706665039
mini_batch_src_global generation:  0.017690181732177734
r_  generation:  0.14546442031860352
local_output_nid generation:  0.007995128631591797
local_in_edges_tensor generation:  0.007599830627441406
mini_batch_src_global generation:  0.01655745506286621
r_  generation:  0.14206624031066895
local_output_nid generation:  0.007950782775878906
local_in_edges_tensor generation:  0.010530233383178711
mini_batch_src_global generation:  0.016323089599609375
r_  generation:  0.14137506484985352
local_output_nid generation:  0.007908344268798828
local_in_edges_tensor generation:  0.01064300537109375
mini_batch_src_global generation:  0.016760587692260742
r_  generation:  0.1428508758544922
local_output_nid generation:  0.007793426513671875
local_in_edges_tensor generation:  0.01002192497253418
mini_batch_src_global generation:  0.01839137077331543
r_  generation:  0.14224576950073242
local_output_nid generation:  0.007828474044799805
local_in_edges_tensor generation:  0.007608652114868164
mini_batch_src_global generation:  0.01859593391418457
r_  generation:  0.14645910263061523
local_output_nid generation:  0.010173797607421875
local_in_edges_tensor generation:  0.008564472198486328
mini_batch_src_global generation:  0.02097320556640625
r_  generation:  0.14364409446716309
local_output_nid generation:  0.007817506790161133
local_in_edges_tensor generation:  0.007816553115844727
mini_batch_src_global generation:  0.016443967819213867
r_  generation:  0.13422346115112305
local_output_nid generation:  0.00822901725769043
local_in_edges_tensor generation:  0.008163690567016602
mini_batch_src_global generation:  0.017398595809936523
r_  generation:  0.14423489570617676
local_output_nid generation:  0.008125066757202148
local_in_edges_tensor generation:  0.0076634883880615234
mini_batch_src_global generation:  0.016762971878051758
r_  generation:  0.17304539680480957
local_output_nid generation:  0.008110761642456055
local_in_edges_tensor generation:  0.007687568664550781
mini_batch_src_global generation:  0.0175325870513916
r_  generation:  0.18258309364318848
local_output_nid generation:  0.008112430572509766
local_in_edges_tensor generation:  0.008289813995361328
mini_batch_src_global generation:  0.01715707778930664
r_  generation:  0.13999533653259277
local_output_nid generation:  0.007981538772583008
local_in_edges_tensor generation:  0.0070056915283203125
mini_batch_src_global generation:  0.016274213790893555
r_  generation:  0.1383814811706543
local_output_nid generation:  0.00800180435180664
local_in_edges_tensor generation:  0.007193088531494141
mini_batch_src_global generation:  0.01645374298095703
r_  generation:  0.18474388122558594
local_output_nid generation:  0.007750988006591797
local_in_edges_tensor generation:  0.006886482238769531
mini_batch_src_global generation:  0.016623258590698242
r_  generation:  0.13615751266479492
----------------------check_connections_block total spend ----------------------------- 6.959367275238037
generate_one_block  0.17859888076782227
generate_one_block  0.17165422439575195
generate_one_block  0.17395472526550293
generate_one_block  0.1801927089691162
generate_one_block  0.20850276947021484
generate_one_block  0.17795300483703613
generate_one_block  0.17988181114196777
generate_one_block  0.17965102195739746
generate_one_block  0.18010592460632324
generate_one_block  0.1793808937072754
generate_one_block  0.17757391929626465
generate_one_block  0.17592191696166992
generate_one_block  0.18377399444580078
generate_one_block  0.1844937801361084
generate_one_block  0.17007088661193848
generate_one_block  0.17343688011169434
generate_one_block  0.1802210807800293
generate_one_block  0.17904424667358398
generate_one_block  0.17374563217163086
generate_one_block  0.17927145957946777
generate_one_block  0.18141674995422363
generate_one_block  0.17510104179382324
generate_one_block  0.17466259002685547
generate_one_block  0.17922639846801758
generate_one_block  0.1704251766204834
generate_one_block  0.19458913803100586
generate_one_block  0.18012666702270508
generate_one_block  0.1837754249572754
generate_one_block  0.18584561347961426
generate_one_block  0.18281173706054688
generate_one_block  0.17847275733947754
generate_one_block  0.1721513271331787
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03302645683288574
gen group dst list time:  0.10705351829528809
time for parepare:  0.021190643310546875
local_output_nid generation:  0.024455785751342773
local_in_edges_tensor generation:  0.04655933380126953
mini_batch_src_global generation:  0.036774396896362305
r_  generation:  0.393352746963501
local_output_nid generation:  0.029769182205200195
local_in_edges_tensor generation:  0.032674312591552734
mini_batch_src_global generation:  0.047026872634887695
r_  generation:  0.39039087295532227
local_output_nid generation:  0.029996395111083984
local_in_edges_tensor generation:  0.028554677963256836
mini_batch_src_global generation:  0.04553866386413574
r_  generation:  0.4057490825653076
local_output_nid generation:  0.030333757400512695
local_in_edges_tensor generation:  0.027794837951660156
mini_batch_src_global generation:  0.04970431327819824
r_  generation:  0.42283058166503906
local_output_nid generation:  0.03354001045227051
local_in_edges_tensor generation:  0.030273914337158203
mini_batch_src_global generation:  0.04857659339904785
r_  generation:  0.4062492847442627
local_output_nid generation:  0.027725934982299805
local_in_edges_tensor generation:  0.026159048080444336
mini_batch_src_global generation:  0.048200368881225586
r_  generation:  0.3986327648162842
local_output_nid generation:  0.02693343162536621
local_in_edges_tensor generation:  0.030215978622436523
mini_batch_src_global generation:  0.04665231704711914
r_  generation:  0.4069795608520508
local_output_nid generation:  0.027087926864624023
local_in_edges_tensor generation:  0.028163671493530273
mini_batch_src_global generation:  0.050328731536865234
r_  generation:  0.4053325653076172
local_output_nid generation:  0.027463912963867188
local_in_edges_tensor generation:  0.04064679145812988
mini_batch_src_global generation:  0.04717731475830078
r_  generation:  0.41503190994262695
local_output_nid generation:  0.027225017547607422
local_in_edges_tensor generation:  0.032446861267089844
mini_batch_src_global generation:  0.05097484588623047
r_  generation:  0.4068624973297119
local_output_nid generation:  0.027277469635009766
local_in_edges_tensor generation:  0.027752399444580078
mini_batch_src_global generation:  0.04778480529785156
r_  generation:  0.40964269638061523
local_output_nid generation:  0.02733755111694336
local_in_edges_tensor generation:  0.029255390167236328
mini_batch_src_global generation:  0.049561262130737305
r_  generation:  0.4057290554046631
local_output_nid generation:  0.028168916702270508
local_in_edges_tensor generation:  0.026681184768676758
mini_batch_src_global generation:  0.04676628112792969
r_  generation:  0.4115300178527832
local_output_nid generation:  0.027434110641479492
local_in_edges_tensor generation:  0.02816605567932129
mini_batch_src_global generation:  0.04799175262451172
r_  generation:  0.41901421546936035
local_output_nid generation:  0.029433488845825195
local_in_edges_tensor generation:  0.027785062789916992
mini_batch_src_global generation:  0.047489166259765625
r_  generation:  0.40636205673217773
local_output_nid generation:  0.027678489685058594
local_in_edges_tensor generation:  0.02675461769104004
mini_batch_src_global generation:  0.04828214645385742
r_  generation:  0.40187716484069824
local_output_nid generation:  0.027692556381225586
local_in_edges_tensor generation:  0.03166317939758301
mini_batch_src_global generation:  0.04861760139465332
r_  generation:  0.4128384590148926
local_output_nid generation:  0.02741217613220215
local_in_edges_tensor generation:  0.025026559829711914
mini_batch_src_global generation:  0.04842090606689453
r_  generation:  0.40269970893859863
local_output_nid generation:  0.027715682983398438
local_in_edges_tensor generation:  0.025121688842773438
mini_batch_src_global generation:  0.04680156707763672
r_  generation:  0.4203197956085205
local_output_nid generation:  0.027390480041503906
local_in_edges_tensor generation:  0.024878263473510742
mini_batch_src_global generation:  0.04825878143310547
r_  generation:  0.404355525970459
local_output_nid generation:  0.027451276779174805
local_in_edges_tensor generation:  0.027113914489746094
mini_batch_src_global generation:  0.04871344566345215
r_  generation:  0.41222429275512695
local_output_nid generation:  0.027547359466552734
local_in_edges_tensor generation:  0.02762460708618164
mini_batch_src_global generation:  0.048339128494262695
r_  generation:  0.4029815196990967
local_output_nid generation:  0.02719569206237793
local_in_edges_tensor generation:  0.026807546615600586
mini_batch_src_global generation:  0.04753422737121582
r_  generation:  0.4066629409790039
local_output_nid generation:  0.027430295944213867
local_in_edges_tensor generation:  0.02762293815612793
mini_batch_src_global generation:  0.04993724822998047
r_  generation:  0.40200090408325195
local_output_nid generation:  0.02717423439025879
local_in_edges_tensor generation:  0.02443242073059082
mini_batch_src_global generation:  0.04636430740356445
r_  generation:  0.4068787097930908
local_output_nid generation:  0.027771711349487305
local_in_edges_tensor generation:  0.024982213973999023
mini_batch_src_global generation:  0.047982215881347656
r_  generation:  0.4075164794921875
local_output_nid generation:  0.027811050415039062
local_in_edges_tensor generation:  0.032260894775390625
mini_batch_src_global generation:  0.04705524444580078
r_  generation:  0.4145231246948242
local_output_nid generation:  0.029052257537841797
local_in_edges_tensor generation:  0.030672788619995117
mini_batch_src_global generation:  0.04801750183105469
r_  generation:  0.40627217292785645
local_output_nid generation:  0.027696847915649414
local_in_edges_tensor generation:  0.025292158126831055
mini_batch_src_global generation:  0.046982765197753906
r_  generation:  0.4133565425872803
local_output_nid generation:  0.028040647506713867
local_in_edges_tensor generation:  0.0292203426361084
mini_batch_src_global generation:  0.04822230339050293
r_  generation:  0.3982419967651367
local_output_nid generation:  0.026942729949951172
local_in_edges_tensor generation:  0.026081323623657227
mini_batch_src_global generation:  0.04561042785644531
r_  generation:  0.4129929542541504
local_output_nid generation:  0.02684950828552246
local_in_edges_tensor generation:  0.024411678314208984
mini_batch_src_global generation:  0.049070119857788086
r_  generation:  0.39637231826782227
----------------------check_connections_block total spend ----------------------------- 19.2651207447052
generate_one_block  0.5466692447662354
generate_one_block  0.5362882614135742
generate_one_block  0.5263843536376953
generate_one_block  0.5398221015930176
generate_one_block  0.6339223384857178
generate_one_block  0.5352180004119873
generate_one_block  0.5387442111968994
generate_one_block  0.5437376499176025
generate_one_block  0.5383930206298828
generate_one_block  0.5468900203704834
generate_one_block  0.5258545875549316
generate_one_block  0.5331368446350098
generate_one_block  0.5366106033325195
generate_one_block  0.535348653793335
generate_one_block  0.5264103412628174
generate_one_block  0.5345001220703125
generate_one_block  0.5403852462768555
generate_one_block  0.538238525390625
generate_one_block  0.5318806171417236
generate_one_block  0.5331168174743652
generate_one_block  0.5410020351409912
generate_one_block  0.5320301055908203
generate_one_block  0.5279586315155029
generate_one_block  0.5431890487670898
generate_one_block  0.5453450679779053
generate_one_block  0.5343561172485352
generate_one_block  0.543543815612793
generate_one_block  0.5422837734222412
generate_one_block  0.5372755527496338
generate_one_block  0.5305023193359375
generate_one_block  0.5296003818511963
generate_one_block  0.5273895263671875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.11971044540405273  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

connection checking time:  26.224488019943237
block generation total time  23.00206232070923
average batch blocks generation time:  0.7188144475221634
block dataloader generation time/epoch 51.59618651866913
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10277700424194336  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.611619472503662  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10303974151611328  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.531962394714355  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.103912353515625  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.566390037536621  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10398435592651367  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.942956447601318  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10401725769042969  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.79677963256836  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1032266616821289  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.74179744720459  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10503339767456055  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.914114952087402  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10412359237670898  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.918298721313477  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1050257682800293  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.90798807144165  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10397720336914062  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.823587894439697  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10388374328613281  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.53771686553955  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10287189483642578  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.553956985473633  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10401058197021484  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.738356590270996  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10332584381103516  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.737999439239502  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10274267196655273  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.332991123199463  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10336780548095703  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.611475944519043  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10502195358276367  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.881152153015137  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10411882400512695  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.82975721359253  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10399627685546875  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.700263023376465  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10292387008666992  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.68671464920044  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10503435134887695  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.882407665252686  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10290145874023438  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.630149364471436  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10282373428344727  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.55817174911499  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10402250289916992  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.856956958770752  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10265684127807617  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.433241367340088  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1042470932006836  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.978381156921387  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10501384735107422  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.874769687652588  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10397768020629883  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.887479782104492  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10502147674560547  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.85823917388916  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1025247573852539  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.544008731842041  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10269737243652344  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.440386772155762  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10268211364746094  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.347254753112793  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.036287494003772736 |0.012036457657814026 |0.26311005651950836 |9.196996688842773e-05 |0.42976541072130203 |0.005872011184692383 |
----------------------------------------------------------pseudo_mini_loss sum 1.60719633102417
Total (block generation + training)time/epoch 75.34196245670319
Training time/epoch 23.77723717689514
Training time without block to device /epoch 23.392070531845093
Training time without total dataloading part /epoch 22.180830001831055
load block tensor time/epoch 1.1611998081207275
block to device time/epoch 0.38516664505004883
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  8578864
Number of first layer input nodes during this epoch:  4654998
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.11898660659790039  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023639440536499023
range selection method range initialization spend 0.01646280288696289
time for parepare:  0.01827096939086914
local_output_nid generation:  0.0009014606475830078
local_in_edges_tensor generation:  0.0038814544677734375
mini_batch_src_global generation:  0.0019266605377197266
r_  generation:  0.010282754898071289
local_output_nid generation:  0.0009360313415527344
local_in_edges_tensor generation:  0.0006225109100341797
mini_batch_src_global generation:  0.001355886459350586
r_  generation:  0.008515596389770508
local_output_nid generation:  0.0009083747863769531
local_in_edges_tensor generation:  0.0005447864532470703
mini_batch_src_global generation:  0.0009565353393554688
r_  generation:  0.008087873458862305
local_output_nid generation:  0.0009107589721679688
local_in_edges_tensor generation:  0.0005118846893310547
mini_batch_src_global generation:  0.0009124279022216797
r_  generation:  0.00821828842163086
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.0005233287811279297
mini_batch_src_global generation:  0.0008676052093505859
r_  generation:  0.007872343063354492
local_output_nid generation:  0.0008490085601806641
local_in_edges_tensor generation:  0.0005161762237548828
mini_batch_src_global generation:  0.0009469985961914062
r_  generation:  0.008155584335327148
local_output_nid generation:  0.0008265972137451172
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0008702278137207031
r_  generation:  0.008097648620605469
local_output_nid generation:  0.0008399486541748047
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.0008225440979003906
r_  generation:  0.008163928985595703
local_output_nid generation:  0.0008339881896972656
local_in_edges_tensor generation:  0.0004894733428955078
mini_batch_src_global generation:  0.0008323192596435547
r_  generation:  0.008031129837036133
local_output_nid generation:  0.0008203983306884766
local_in_edges_tensor generation:  0.0004951953887939453
mini_batch_src_global generation:  0.0008714199066162109
r_  generation:  0.008413076400756836
local_output_nid generation:  0.0008096694946289062
local_in_edges_tensor generation:  0.0005083084106445312
mini_batch_src_global generation:  0.0009031295776367188
r_  generation:  0.008353471755981445
local_output_nid generation:  0.0008127689361572266
local_in_edges_tensor generation:  0.0005009174346923828
mini_batch_src_global generation:  0.0008635520935058594
r_  generation:  0.008114337921142578
local_output_nid generation:  0.0007951259613037109
local_in_edges_tensor generation:  0.00048732757568359375
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.008337974548339844
local_output_nid generation:  0.0007982254028320312
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.0008988380432128906
r_  generation:  0.008367538452148438
local_output_nid generation:  0.0007994174957275391
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.0008802413940429688
r_  generation:  0.008152484893798828
local_output_nid generation:  0.0008056163787841797
local_in_edges_tensor generation:  0.0004968643188476562
mini_batch_src_global generation:  0.0008671283721923828
r_  generation:  0.008184432983398438
local_output_nid generation:  0.0008072853088378906
local_in_edges_tensor generation:  0.0004799365997314453
mini_batch_src_global generation:  0.0008738040924072266
r_  generation:  0.008292198181152344
local_output_nid generation:  0.0008087158203125
local_in_edges_tensor generation:  0.0004830360412597656
mini_batch_src_global generation:  0.0008575916290283203
r_  generation:  0.008179187774658203
local_output_nid generation:  0.0007967948913574219
local_in_edges_tensor generation:  0.0004799365997314453
mini_batch_src_global generation:  0.0008523464202880859
r_  generation:  0.008206605911254883
local_output_nid generation:  0.0008015632629394531
local_in_edges_tensor generation:  0.0004982948303222656
mini_batch_src_global generation:  0.0008552074432373047
r_  generation:  0.008357524871826172
local_output_nid generation:  0.0007903575897216797
local_in_edges_tensor generation:  0.0004918575286865234
mini_batch_src_global generation:  0.0008683204650878906
r_  generation:  0.008335590362548828
local_output_nid generation:  0.0007884502410888672
local_in_edges_tensor generation:  0.0004987716674804688
mini_batch_src_global generation:  0.0008931159973144531
r_  generation:  0.008137226104736328
local_output_nid generation:  0.0007879734039306641
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.0008504390716552734
r_  generation:  0.008198261260986328
local_output_nid generation:  0.0007913112640380859
local_in_edges_tensor generation:  0.0004901885986328125
mini_batch_src_global generation:  0.0010180473327636719
r_  generation:  0.008543729782104492
local_output_nid generation:  0.0007791519165039062
local_in_edges_tensor generation:  0.0004949569702148438
mini_batch_src_global generation:  0.0008780956268310547
r_  generation:  0.008068561553955078
local_output_nid generation:  0.0007922649383544922
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0009126663208007812
r_  generation:  0.008517265319824219
local_output_nid generation:  0.0007841587066650391
local_in_edges_tensor generation:  0.0004870891571044922
mini_batch_src_global generation:  0.000888824462890625
r_  generation:  0.008290767669677734
local_output_nid generation:  0.0007891654968261719
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.0008831024169921875
r_  generation:  0.008477210998535156
local_output_nid generation:  0.0007770061492919922
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.0008652210235595703
r_  generation:  0.008245468139648438
local_output_nid generation:  0.0007803440093994141
local_in_edges_tensor generation:  0.0004909038543701172
mini_batch_src_global generation:  0.0008554458618164062
r_  generation:  0.008269071578979492
local_output_nid generation:  0.0007774829864501953
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0008733272552490234
r_  generation:  0.008375883102416992
local_output_nid generation:  0.0007748603820800781
local_in_edges_tensor generation:  0.00048732757568359375
mini_batch_src_global generation:  0.0008647441864013672
r_  generation:  0.008271455764770508
----------------------check_connections_block total spend ----------------------------- 0.42836833000183105
generate_one_block  0.020534038543701172
generate_one_block  0.01709914207458496
generate_one_block  0.015090465545654297
generate_one_block  0.014973163604736328
generate_one_block  0.014359474182128906
generate_one_block  0.014449596405029297
generate_one_block  0.014295101165771484
generate_one_block  0.014400005340576172
generate_one_block  0.01430058479309082
generate_one_block  0.014758586883544922
generate_one_block  0.014704465866088867
generate_one_block  0.014388799667358398
generate_one_block  0.014605998992919922
generate_one_block  0.014569520950317383
generate_one_block  0.014189481735229492
generate_one_block  0.014434337615966797
generate_one_block  0.014565229415893555
generate_one_block  0.014236211776733398
generate_one_block  0.014275074005126953
generate_one_block  0.014346599578857422
generate_one_block  0.014540433883666992
generate_one_block  0.014097213745117188
generate_one_block  0.014330863952636719
generate_one_block  0.014723539352416992
generate_one_block  0.01400136947631836
generate_one_block  0.014736175537109375
generate_one_block  0.01440739631652832
generate_one_block  0.01464390754699707
generate_one_block  0.014461755752563477
generate_one_block  0.014320611953735352
generate_one_block  0.014519691467285156
generate_one_block  0.014308929443359375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035663604736328125
gen group dst list time:  0.02327895164489746
time for parepare:  0.02197551727294922
local_output_nid generation:  0.004570722579956055
local_in_edges_tensor generation:  0.014463663101196289
mini_batch_src_global generation:  0.015068292617797852
r_  generation:  0.12467598915100098
local_output_nid generation:  0.006595134735107422
local_in_edges_tensor generation:  0.008819580078125
mini_batch_src_global generation:  0.015354394912719727
r_  generation:  0.12574982643127441
local_output_nid generation:  0.006875038146972656
local_in_edges_tensor generation:  0.029381513595581055
mini_batch_src_global generation:  0.015209197998046875
r_  generation:  0.13361072540283203
local_output_nid generation:  0.007002592086791992
local_in_edges_tensor generation:  0.0067729949951171875
mini_batch_src_global generation:  0.01461029052734375
r_  generation:  0.13251447677612305
local_output_nid generation:  0.007268428802490234
local_in_edges_tensor generation:  0.008284330368041992
mini_batch_src_global generation:  0.015343666076660156
r_  generation:  0.13214564323425293
local_output_nid generation:  0.007390260696411133
local_in_edges_tensor generation:  0.006921291351318359
mini_batch_src_global generation:  0.01631760597229004
r_  generation:  0.13393163681030273
local_output_nid generation:  0.007472038269042969
local_in_edges_tensor generation:  0.006904125213623047
mini_batch_src_global generation:  0.015631675720214844
r_  generation:  0.13179755210876465
local_output_nid generation:  0.007571220397949219
local_in_edges_tensor generation:  0.0070133209228515625
mini_batch_src_global generation:  0.016020774841308594
r_  generation:  0.13507461547851562
local_output_nid generation:  0.0071964263916015625
local_in_edges_tensor generation:  0.006920814514160156
mini_batch_src_global generation:  0.01597762107849121
r_  generation:  0.13512420654296875
local_output_nid generation:  0.00755763053894043
local_in_edges_tensor generation:  0.007223606109619141
mini_batch_src_global generation:  0.016950607299804688
r_  generation:  0.13723039627075195
local_output_nid generation:  0.007822036743164062
local_in_edges_tensor generation:  0.008414506912231445
mini_batch_src_global generation:  0.0166780948638916
r_  generation:  0.18695759773254395
local_output_nid generation:  0.008144378662109375
local_in_edges_tensor generation:  0.0069637298583984375
mini_batch_src_global generation:  0.016991138458251953
r_  generation:  0.13457179069519043
local_output_nid generation:  0.00783395767211914
local_in_edges_tensor generation:  0.008540153503417969
mini_batch_src_global generation:  0.016421079635620117
r_  generation:  0.1398937702178955
local_output_nid generation:  0.007817745208740234
local_in_edges_tensor generation:  0.008682966232299805
mini_batch_src_global generation:  0.016698598861694336
r_  generation:  0.13794422149658203
local_output_nid generation:  0.007600307464599609
local_in_edges_tensor generation:  0.006962776184082031
mini_batch_src_global generation:  0.016231298446655273
r_  generation:  0.13606905937194824
local_output_nid generation:  0.007727622985839844
local_in_edges_tensor generation:  0.0070896148681640625
mini_batch_src_global generation:  0.0285336971282959
r_  generation:  0.13462328910827637
local_output_nid generation:  0.007805824279785156
local_in_edges_tensor generation:  0.007832527160644531
mini_batch_src_global generation:  0.01805257797241211
r_  generation:  0.13822555541992188
local_output_nid generation:  0.007703542709350586
local_in_edges_tensor generation:  0.007854938507080078
mini_batch_src_global generation:  0.016095876693725586
r_  generation:  0.13808441162109375
local_output_nid generation:  0.008046865463256836
local_in_edges_tensor generation:  0.007745504379272461
mini_batch_src_global generation:  0.016600608825683594
r_  generation:  0.13947796821594238
local_output_nid generation:  0.007703304290771484
local_in_edges_tensor generation:  0.008246183395385742
mini_batch_src_global generation:  0.01640176773071289
r_  generation:  0.13711333274841309
local_output_nid generation:  0.00786280632019043
local_in_edges_tensor generation:  0.007843732833862305
mini_batch_src_global generation:  0.01632380485534668
r_  generation:  0.13989734649658203
local_output_nid generation:  0.007744789123535156
local_in_edges_tensor generation:  0.007258176803588867
mini_batch_src_global generation:  0.015978336334228516
r_  generation:  0.135361909866333
local_output_nid generation:  0.007908821105957031
local_in_edges_tensor generation:  0.0072476863861083984
mini_batch_src_global generation:  0.0160520076751709
r_  generation:  0.14146113395690918
local_output_nid generation:  0.009004831314086914
local_in_edges_tensor generation:  0.008971929550170898
mini_batch_src_global generation:  0.01636028289794922
r_  generation:  0.14712810516357422
local_output_nid generation:  0.007861852645874023
local_in_edges_tensor generation:  0.008046388626098633
mini_batch_src_global generation:  0.016843557357788086
r_  generation:  0.13782095909118652
local_output_nid generation:  0.01002812385559082
local_in_edges_tensor generation:  0.00939178466796875
mini_batch_src_global generation:  0.01740741729736328
r_  generation:  0.14475798606872559
local_output_nid generation:  0.01081228256225586
local_in_edges_tensor generation:  0.00793147087097168
mini_batch_src_global generation:  0.01665186882019043
r_  generation:  0.1407468318939209
local_output_nid generation:  0.007951974868774414
local_in_edges_tensor generation:  0.01257777214050293
mini_batch_src_global generation:  0.01646900177001953
r_  generation:  0.14321327209472656
local_output_nid generation:  0.008043527603149414
local_in_edges_tensor generation:  0.013144254684448242
mini_batch_src_global generation:  0.01660633087158203
r_  generation:  0.1418743133544922
local_output_nid generation:  0.007910013198852539
local_in_edges_tensor generation:  0.00789785385131836
mini_batch_src_global generation:  0.01820230484008789
r_  generation:  0.14064431190490723
local_output_nid generation:  0.008522987365722656
local_in_edges_tensor generation:  0.008420467376708984
mini_batch_src_global generation:  0.024674654006958008
r_  generation:  0.14289307594299316
local_output_nid generation:  0.009022712707519531
local_in_edges_tensor generation:  0.0075261592864990234
mini_batch_src_global generation:  0.01649928092956543
r_  generation:  0.13599157333374023
----------------------check_connections_block total spend ----------------------------- 6.5881288051605225
generate_one_block  0.18215584754943848
generate_one_block  0.17611122131347656
generate_one_block  0.18150973320007324
generate_one_block  0.17702150344848633
generate_one_block  0.20215439796447754
generate_one_block  0.17580366134643555
generate_one_block  0.1697075366973877
generate_one_block  0.17831635475158691
generate_one_block  0.172257661819458
generate_one_block  0.1799466609954834
generate_one_block  0.18004894256591797
generate_one_block  0.16937828063964844
generate_one_block  0.1766049861907959
generate_one_block  0.17932534217834473
generate_one_block  0.17542505264282227
generate_one_block  0.17177700996398926
generate_one_block  0.1746387481689453
generate_one_block  0.1763758659362793
generate_one_block  0.17883872985839844
generate_one_block  0.1803731918334961
generate_one_block  0.17867350578308105
generate_one_block  0.16909408569335938
generate_one_block  0.17344880104064941
generate_one_block  0.18163275718688965
generate_one_block  0.168609619140625
generate_one_block  0.18192529678344727
generate_one_block  0.17584609985351562
generate_one_block  0.17783474922180176
generate_one_block  0.175917387008667
generate_one_block  0.17407894134521484
generate_one_block  0.17737221717834473
generate_one_block  0.17358613014221191
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03310251235961914
gen group dst list time:  0.10096287727355957
time for parepare:  0.020065784454345703
local_output_nid generation:  0.023064851760864258
local_in_edges_tensor generation:  0.04510092735290527
mini_batch_src_global generation:  0.03664231300354004
r_  generation:  0.39317917823791504
local_output_nid generation:  0.02846813201904297
local_in_edges_tensor generation:  0.03126931190490723
mini_batch_src_global generation:  0.047124385833740234
r_  generation:  0.39992761611938477
local_output_nid generation:  0.028423309326171875
local_in_edges_tensor generation:  0.027997732162475586
mini_batch_src_global generation:  0.047301292419433594
r_  generation:  0.40787839889526367
local_output_nid generation:  0.02873682975769043
local_in_edges_tensor generation:  0.025255203247070312
mini_batch_src_global generation:  0.04743051528930664
r_  generation:  0.39930295944213867
local_output_nid generation:  0.028819799423217773
local_in_edges_tensor generation:  0.029352426528930664
mini_batch_src_global generation:  0.04606485366821289
r_  generation:  0.4038815498352051
local_output_nid generation:  0.030529499053955078
local_in_edges_tensor generation:  0.028157711029052734
mini_batch_src_global generation:  0.04761242866516113
r_  generation:  0.40460968017578125
local_output_nid generation:  0.02802276611328125
local_in_edges_tensor generation:  0.029022216796875
mini_batch_src_global generation:  0.04631471633911133
r_  generation:  0.40425872802734375
local_output_nid generation:  0.027268648147583008
local_in_edges_tensor generation:  0.02581310272216797
mini_batch_src_global generation:  0.05227494239807129
r_  generation:  0.41831469535827637
local_output_nid generation:  0.028364896774291992
local_in_edges_tensor generation:  0.02912616729736328
mini_batch_src_global generation:  0.05020260810852051
r_  generation:  0.4056284427642822
local_output_nid generation:  0.02892923355102539
local_in_edges_tensor generation:  0.02820420265197754
mini_batch_src_global generation:  0.047832489013671875
r_  generation:  0.3998434543609619
local_output_nid generation:  0.02855706214904785
local_in_edges_tensor generation:  0.0272216796875
mini_batch_src_global generation:  0.0466463565826416
r_  generation:  0.4117395877838135
local_output_nid generation:  0.027840137481689453
local_in_edges_tensor generation:  0.024181842803955078
mini_batch_src_global generation:  0.04790806770324707
r_  generation:  0.39337158203125
local_output_nid generation:  0.028115272521972656
local_in_edges_tensor generation:  0.02826070785522461
mini_batch_src_global generation:  0.0480194091796875
r_  generation:  0.40672898292541504
local_output_nid generation:  0.028256654739379883
local_in_edges_tensor generation:  0.026201486587524414
mini_batch_src_global generation:  0.048026323318481445
r_  generation:  0.41392970085144043
local_output_nid generation:  0.02763080596923828
local_in_edges_tensor generation:  0.024548053741455078
mini_batch_src_global generation:  0.04634547233581543
r_  generation:  0.40771484375
local_output_nid generation:  0.027893781661987305
local_in_edges_tensor generation:  0.026504993438720703
mini_batch_src_global generation:  0.04748725891113281
r_  generation:  0.3998589515686035
local_output_nid generation:  0.028305768966674805
local_in_edges_tensor generation:  0.02764725685119629
mini_batch_src_global generation:  0.048039913177490234
r_  generation:  0.40883636474609375
local_output_nid generation:  0.028032302856445312
local_in_edges_tensor generation:  0.030646562576293945
mini_batch_src_global generation:  0.04832959175109863
r_  generation:  0.40191054344177246
local_output_nid generation:  0.02823042869567871
local_in_edges_tensor generation:  0.030472755432128906
mini_batch_src_global generation:  0.04748940467834473
r_  generation:  0.4019505977630615
local_output_nid generation:  0.028015851974487305
local_in_edges_tensor generation:  0.0261077880859375
mini_batch_src_global generation:  0.04952239990234375
r_  generation:  0.39943861961364746
local_output_nid generation:  0.027974367141723633
local_in_edges_tensor generation:  0.028119564056396484
mini_batch_src_global generation:  0.04643869400024414
r_  generation:  0.40355944633483887
local_output_nid generation:  0.02805948257446289
local_in_edges_tensor generation:  0.0244290828704834
mini_batch_src_global generation:  0.0473933219909668
r_  generation:  0.39722466468811035
local_output_nid generation:  0.02782583236694336
local_in_edges_tensor generation:  0.02810811996459961
mini_batch_src_global generation:  0.04547572135925293
r_  generation:  0.40616917610168457
local_output_nid generation:  0.028430700302124023
local_in_edges_tensor generation:  0.03006434440612793
mini_batch_src_global generation:  0.04977154731750488
r_  generation:  0.4075450897216797
local_output_nid generation:  0.028827428817749023
local_in_edges_tensor generation:  0.02921581268310547
mini_batch_src_global generation:  0.04843878746032715
r_  generation:  0.4006941318511963
local_output_nid generation:  0.02859187126159668
local_in_edges_tensor generation:  0.026574373245239258
mini_batch_src_global generation:  0.048192501068115234
r_  generation:  0.4089951515197754
local_output_nid generation:  0.027802467346191406
local_in_edges_tensor generation:  0.026627779006958008
mini_batch_src_global generation:  0.04954957962036133
r_  generation:  0.40381789207458496
local_output_nid generation:  0.028040409088134766
local_in_edges_tensor generation:  0.026463747024536133
mini_batch_src_global generation:  0.04813361167907715
r_  generation:  0.39754533767700195
local_output_nid generation:  0.02815413475036621
local_in_edges_tensor generation:  0.024280309677124023
mini_batch_src_global generation:  0.04623818397521973
r_  generation:  0.4119904041290283
local_output_nid generation:  0.027950525283813477
local_in_edges_tensor generation:  0.025916337966918945
mini_batch_src_global generation:  0.04779767990112305
r_  generation:  0.40256381034851074
local_output_nid generation:  0.02802872657775879
local_in_edges_tensor generation:  0.026689529418945312
mini_batch_src_global generation:  0.04815053939819336
r_  generation:  0.4171867370605469
local_output_nid generation:  0.029822587966918945
local_in_edges_tensor generation:  0.024100303649902344
mini_batch_src_global generation:  0.04764866828918457
r_  generation:  0.4006011486053467
----------------------check_connections_block total spend ----------------------------- 19.15995168685913
generate_one_block  0.5521037578582764
generate_one_block  0.532545804977417
generate_one_block  0.5349962711334229
generate_one_block  0.5240962505340576
generate_one_block  0.6235606670379639
generate_one_block  0.5320677757263184
generate_one_block  0.5433645248413086
generate_one_block  0.5399875640869141
generate_one_block  0.5304744243621826
generate_one_block  0.5433816909790039
generate_one_block  0.541175365447998
generate_one_block  0.5262174606323242
generate_one_block  0.5293593406677246
generate_one_block  0.5374021530151367
generate_one_block  0.5306451320648193
generate_one_block  0.5279583930969238
generate_one_block  0.534661054611206
generate_one_block  0.5436336994171143
generate_one_block  0.5340793132781982
generate_one_block  0.5332307815551758
generate_one_block  0.5408337116241455
generate_one_block  0.532524585723877
generate_one_block  0.5302538871765137
generate_one_block  0.5478112697601318
generate_one_block  0.5410373210906982
generate_one_block  0.5383694171905518
generate_one_block  0.5265705585479736
generate_one_block  0.5398612022399902
generate_one_block  0.5369021892547607
generate_one_block  0.5379650592803955
generate_one_block  0.5360426902770996
generate_one_block  0.5350661277770996
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.11898660659790039  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

connection checking time:  25.748080492019653
block generation total time  22.903969764709473
average batch blocks generation time:  0.715749055147171
block dataloader generation time/epoch 51.436448653539024
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10502433776855469  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.895195007324219  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10325098037719727  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.715022563934326  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10504913330078125  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.015929222106934  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10311603546142578  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.668891906738281  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10286331176757812  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.465108871459961  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10306692123413086  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.75347089767456  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1038370132446289  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.480917930603027  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1037445068359375  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.80669116973877  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10283517837524414  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.580741882324219  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10397005081176758  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.857253074645996  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10503339767456055  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.99652624130249  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10296010971069336  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.434722900390625  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10399913787841797  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.72411298751831  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1041107177734375  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.88034439086914  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1028299331665039  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.537077903747559  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10294532775878906  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.553345680236816  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10398578643798828  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.691063404083252  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10407209396362305  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.722311973571777  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10284900665283203  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.723188877105713  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10304880142211914  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.758491516113281  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.1040182113647461  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.750831127166748  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10303306579589844  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.400039196014404  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10285663604736328  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.559514999389648  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10438871383666992  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.943609237670898  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10270929336547852  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 15.335394859313965  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10410785675048828  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 16.009767055511475  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4022216796875 GB
    Memory Allocated: 0.10270881652832031  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.483301162719727  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.1030740737915039  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.662805557250977  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10401153564453125  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.720584392547607  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10286855697631836  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.691697597503662  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.104034423828125  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.762113571166992  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10309028625488281  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.55849027633667  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032673969864845276 |0.0120830237865448 |0.2701357752084732 |9.639561176300049e-05 |0.42901650071144104 |0.00590062141418457 |
----------------------------------------------------------pseudo_mini_loss sum 1.5669578313827515
Total (block generation + training)time/epoch 75.22225364049275
Training time/epoch 23.86560606956482
Training time without block to device /epoch 23.478949308395386
Training time without total dataloading part /epoch 22.381858110427856
load block tensor time/epoch 1.0455670356750488
block to device time/epoch 0.3866567611694336
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  8579956
Number of first layer input nodes during this epoch:  4657142
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.11942625045776367  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022869348526000977
range selection method range initialization spend 0.016416072845458984
time for parepare:  0.018477916717529297
local_output_nid generation:  0.0009219646453857422
local_in_edges_tensor generation:  0.0039174556732177734
mini_batch_src_global generation:  0.0016751289367675781
r_  generation:  0.010101318359375
local_output_nid generation:  0.0009441375732421875
local_in_edges_tensor generation:  0.0006368160247802734
mini_batch_src_global generation:  0.0012454986572265625
r_  generation:  0.008505821228027344
local_output_nid generation:  0.0008978843688964844
local_in_edges_tensor generation:  0.0005486011505126953
mini_batch_src_global generation:  0.0009567737579345703
r_  generation:  0.007988691329956055
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0005207061767578125
mini_batch_src_global generation:  0.0009319782257080078
r_  generation:  0.008144140243530273
local_output_nid generation:  0.0008389949798583984
local_in_edges_tensor generation:  0.0005052089691162109
mini_batch_src_global generation:  0.0008656978607177734
r_  generation:  0.007988691329956055
local_output_nid generation:  0.0008115768432617188
local_in_edges_tensor generation:  0.0005140304565429688
mini_batch_src_global generation:  0.0008623600006103516
r_  generation:  0.008057832717895508
local_output_nid generation:  0.0008330345153808594
local_in_edges_tensor generation:  0.0004980564117431641
mini_batch_src_global generation:  0.0009005069732666016
r_  generation:  0.008432626724243164
local_output_nid generation:  0.0008103847503662109
local_in_edges_tensor generation:  0.0004966259002685547
mini_batch_src_global generation:  0.0009047985076904297
r_  generation:  0.008413076400756836
local_output_nid generation:  0.0008196830749511719
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0008716583251953125
r_  generation:  0.008352279663085938
local_output_nid generation:  0.0008144378662109375
local_in_edges_tensor generation:  0.0004870891571044922
mini_batch_src_global generation:  0.0008716583251953125
r_  generation:  0.008184671401977539
local_output_nid generation:  0.0007982254028320312
local_in_edges_tensor generation:  0.0004894733428955078
mini_batch_src_global generation:  0.0008912086486816406
r_  generation:  0.008176326751708984
local_output_nid generation:  0.0007932186126708984
local_in_edges_tensor generation:  0.0004928112030029297
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.008093595504760742
local_output_nid generation:  0.000789642333984375
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0009329319000244141
r_  generation:  0.008403539657592773
local_output_nid generation:  0.0007960796356201172
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.0008833408355712891
r_  generation:  0.008218526840209961
local_output_nid generation:  0.0007884502410888672
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.001005411148071289
r_  generation:  0.008378267288208008
local_output_nid generation:  0.0008001327514648438
local_in_edges_tensor generation:  0.0005154609680175781
mini_batch_src_global generation:  0.0009667873382568359
r_  generation:  0.009552240371704102
local_output_nid generation:  0.0008006095886230469
local_in_edges_tensor generation:  0.0005106925964355469
mini_batch_src_global generation:  0.0010101795196533203
r_  generation:  0.00810861587524414
local_output_nid generation:  0.0008082389831542969
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.0009098052978515625
r_  generation:  0.007899761199951172
local_output_nid generation:  0.0008044242858886719
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  0.0009336471557617188
r_  generation:  0.008334875106811523
local_output_nid generation:  0.0008091926574707031
local_in_edges_tensor generation:  0.0005061626434326172
mini_batch_src_global generation:  0.0009706020355224609
r_  generation:  0.008067846298217773
local_output_nid generation:  0.0008072853088378906
local_in_edges_tensor generation:  0.0005056858062744141
mini_batch_src_global generation:  0.000957489013671875
r_  generation:  0.007936954498291016
local_output_nid generation:  0.0024967193603515625
local_in_edges_tensor generation:  0.0005528926849365234
mini_batch_src_global generation:  0.0009801387786865234
r_  generation:  0.008290290832519531
local_output_nid generation:  0.0008096694946289062
local_in_edges_tensor generation:  0.0004925727844238281
mini_batch_src_global generation:  0.0009400844573974609
r_  generation:  0.007905960083007812
local_output_nid generation:  0.0007991790771484375
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.0009706020355224609
r_  generation:  0.00834202766418457
local_output_nid generation:  0.0007946491241455078
local_in_edges_tensor generation:  0.0005028247833251953
mini_batch_src_global generation:  0.0010311603546142578
r_  generation:  0.008414745330810547
local_output_nid generation:  0.0007872581481933594
local_in_edges_tensor generation:  0.0005037784576416016
mini_batch_src_global generation:  0.0009534358978271484
r_  generation:  0.008538961410522461
local_output_nid generation:  0.0007967948913574219
local_in_edges_tensor generation:  0.0004980564117431641
mini_batch_src_global generation:  0.000965118408203125
r_  generation:  0.008168458938598633
local_output_nid generation:  0.0008077621459960938
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0008792877197265625
r_  generation:  0.008034467697143555
local_output_nid generation:  0.0008301734924316406
local_in_edges_tensor generation:  0.0005049705505371094
mini_batch_src_global generation:  0.0009284019470214844
r_  generation:  0.008524894714355469
local_output_nid generation:  0.0008103847503662109
local_in_edges_tensor generation:  0.00048828125
mini_batch_src_global generation:  0.0009174346923828125
r_  generation:  0.011642217636108398
local_output_nid generation:  0.00107574462890625
local_in_edges_tensor generation:  0.0006015300750732422
mini_batch_src_global generation:  0.0009300708770751953
r_  generation:  0.008693933486938477
local_output_nid generation:  0.0008111000061035156
local_in_edges_tensor generation:  0.0006434917449951172
mini_batch_src_global generation:  0.0009477138519287109
r_  generation:  0.007946968078613281
----------------------check_connections_block total spend ----------------------------- 0.435854434967041
generate_one_block  0.02256321907043457
generate_one_block  0.017041683197021484
generate_one_block  0.015156984329223633
generate_one_block  0.01750016212463379
generate_one_block  0.015043258666992188
generate_one_block  0.014423608779907227
generate_one_block  0.014772176742553711
generate_one_block  0.014668464660644531
generate_one_block  0.014494180679321289
generate_one_block  0.014908075332641602
generate_one_block  0.01652979850769043
generate_one_block  0.014654159545898438
generate_one_block  0.01500082015991211
generate_one_block  0.014596700668334961
generate_one_block  0.014855623245239258
generate_one_block  0.015146255493164062
generate_one_block  0.014369726181030273
generate_one_block  0.0159914493560791
generate_one_block  0.014859676361083984
generate_one_block  0.01423954963684082
generate_one_block  0.0140380859375
generate_one_block  0.014867544174194336
generate_one_block  0.014021635055541992
generate_one_block  0.014609098434448242
generate_one_block  0.01678776741027832
generate_one_block  0.014935493469238281
generate_one_block  0.014335393905639648
generate_one_block  0.014580965042114258
generate_one_block  0.015110492706298828
generate_one_block  0.014522314071655273
generate_one_block  0.014545202255249023
generate_one_block  0.015877485275268555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03580808639526367
gen group dst list time:  0.022092103958129883
time for parepare:  0.022169828414916992
local_output_nid generation:  0.0049092769622802734
local_in_edges_tensor generation:  0.014616966247558594
mini_batch_src_global generation:  0.01621389389038086
r_  generation:  0.12015628814697266
local_output_nid generation:  0.0069692134857177734
local_in_edges_tensor generation:  0.008706808090209961
mini_batch_src_global generation:  0.014997720718383789
r_  generation:  0.17170357704162598
local_output_nid generation:  0.007863283157348633
local_in_edges_tensor generation:  0.034987688064575195
mini_batch_src_global generation:  0.014719247817993164
r_  generation:  0.1609663963317871
local_output_nid generation:  0.0070416927337646484
local_in_edges_tensor generation:  0.007611751556396484
mini_batch_src_global generation:  0.015419244766235352
r_  generation:  0.16277599334716797
local_output_nid generation:  0.007486581802368164
local_in_edges_tensor generation:  0.006811857223510742
mini_batch_src_global generation:  0.016467571258544922
r_  generation:  0.15979361534118652
local_output_nid generation:  0.011522531509399414
local_in_edges_tensor generation:  0.010684728622436523
mini_batch_src_global generation:  0.01661968231201172
r_  generation:  0.1397266387939453
local_output_nid generation:  0.01268768310546875
local_in_edges_tensor generation:  0.010203123092651367
mini_batch_src_global generation:  0.018180370330810547
r_  generation:  0.1489105224609375
local_output_nid generation:  0.012687444686889648
local_in_edges_tensor generation:  0.011482715606689453
mini_batch_src_global generation:  0.01753973960876465
r_  generation:  0.14700770378112793
local_output_nid generation:  0.012092828750610352
local_in_edges_tensor generation:  0.01083064079284668
mini_batch_src_global generation:  0.017686843872070312
r_  generation:  0.1578660011291504
local_output_nid generation:  0.011378288269042969
local_in_edges_tensor generation:  0.010357856750488281
mini_batch_src_global generation:  0.02191019058227539
r_  generation:  0.1603400707244873
local_output_nid generation:  0.012901544570922852
local_in_edges_tensor generation:  0.009975910186767578
mini_batch_src_global generation:  0.018657207489013672
r_  generation:  0.152540922164917
local_output_nid generation:  0.013064384460449219
local_in_edges_tensor generation:  0.010248422622680664
mini_batch_src_global generation:  0.017697811126708984
r_  generation:  0.17534661293029785
local_output_nid generation:  0.011293888092041016
local_in_edges_tensor generation:  0.011148929595947266
mini_batch_src_global generation:  0.02131938934326172
r_  generation:  0.14852309226989746
local_output_nid generation:  0.009019851684570312
local_in_edges_tensor generation:  0.008175134658813477
mini_batch_src_global generation:  0.020741701126098633
r_  generation:  0.144761323928833
local_output_nid generation:  0.008610963821411133
local_in_edges_tensor generation:  0.008313894271850586
mini_batch_src_global generation:  0.02099132537841797
r_  generation:  0.1467127799987793
local_output_nid generation:  0.008598089218139648
local_in_edges_tensor generation:  0.008177042007446289
mini_batch_src_global generation:  0.021385908126831055
r_  generation:  0.1512908935546875
local_output_nid generation:  0.007999420166015625
local_in_edges_tensor generation:  0.007402658462524414
mini_batch_src_global generation:  0.020964860916137695
r_  generation:  0.1421675682067871
local_output_nid generation:  0.007880449295043945
local_in_edges_tensor generation:  0.00798797607421875
mini_batch_src_global generation:  0.019054889678955078
r_  generation:  0.1411590576171875
local_output_nid generation:  0.00820779800415039
local_in_edges_tensor generation:  0.007473468780517578
mini_batch_src_global generation:  0.02103447914123535
r_  generation:  0.1477959156036377
local_output_nid generation:  0.007848024368286133
local_in_edges_tensor generation:  0.008504867553710938
mini_batch_src_global generation:  0.0191805362701416
r_  generation:  0.17740154266357422
local_output_nid generation:  0.010625362396240234
local_in_edges_tensor generation:  0.00815892219543457
mini_batch_src_global generation:  0.01764082908630371
r_  generation:  0.14001989364624023
local_output_nid generation:  0.010702371597290039
local_in_edges_tensor generation:  0.011901140213012695
mini_batch_src_global generation:  0.018320560455322266
r_  generation:  0.14670705795288086
local_output_nid generation:  0.00796055793762207
local_in_edges_tensor generation:  0.010806798934936523
mini_batch_src_global generation:  0.017362117767333984
r_  generation:  0.17226934432983398
local_output_nid generation:  0.008165597915649414
local_in_edges_tensor generation:  0.008168220520019531
mini_batch_src_global generation:  0.019014835357666016
r_  generation:  0.18436622619628906
local_output_nid generation:  0.010557889938354492
local_in_edges_tensor generation:  0.008411407470703125
mini_batch_src_global generation:  0.01835465431213379
r_  generation:  0.1785881519317627
local_output_nid generation:  0.008529901504516602
local_in_edges_tensor generation:  0.008388280868530273
mini_batch_src_global generation:  0.018604755401611328
r_  generation:  0.18251442909240723
local_output_nid generation:  0.008152246475219727
local_in_edges_tensor generation:  0.007393836975097656
mini_batch_src_global generation:  0.017627477645874023
r_  generation:  0.14301753044128418
local_output_nid generation:  0.00818943977355957
local_in_edges_tensor generation:  0.007931709289550781
mini_batch_src_global generation:  0.021016836166381836
r_  generation:  0.14199185371398926
local_output_nid generation:  0.008465290069580078
local_in_edges_tensor generation:  0.007916927337646484
mini_batch_src_global generation:  0.01943802833557129
r_  generation:  0.1480395793914795
local_output_nid generation:  0.008371353149414062
local_in_edges_tensor generation:  0.007505655288696289
mini_batch_src_global generation:  0.018186330795288086
r_  generation:  0.14629769325256348
local_output_nid generation:  0.008312702178955078
local_in_edges_tensor generation:  0.007905244827270508
mini_batch_src_global generation:  0.018007278442382812
r_  generation:  0.14723825454711914
local_output_nid generation:  0.007990598678588867
local_in_edges_tensor generation:  0.00776982307434082
mini_batch_src_global generation:  0.017508983612060547
r_  generation:  0.13885998725891113
----------------------check_connections_block total spend ----------------------------- 7.268417119979858
generate_one_block  0.182114839553833
generate_one_block  0.17372488975524902
generate_one_block  0.1766681671142578
generate_one_block  0.17815351486206055
generate_one_block  0.20270514488220215
generate_one_block  0.16724324226379395
generate_one_block  0.17972469329833984
generate_one_block  0.17624735832214355
generate_one_block  0.17891454696655273
generate_one_block  0.2011432647705078
generate_one_block  0.17964696884155273
generate_one_block  0.17959070205688477
generate_one_block  0.18573665618896484
generate_one_block  0.18127799034118652
generate_one_block  0.18547797203063965
generate_one_block  0.19301533699035645
generate_one_block  0.17513585090637207
generate_one_block  0.17440080642700195
generate_one_block  0.18265628814697266
generate_one_block  0.18068695068359375
generate_one_block  0.17015600204467773
generate_one_block  0.17981767654418945
generate_one_block  0.1681971549987793
generate_one_block  0.18090033531188965
generate_one_block  0.17893481254577637
generate_one_block  0.18337631225585938
generate_one_block  0.1712641716003418
generate_one_block  0.17373061180114746
generate_one_block  0.18311357498168945
generate_one_block  0.17557764053344727
generate_one_block  0.17835044860839844
generate_one_block  0.16807961463928223
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03183126449584961
gen group dst list time:  0.10954642295837402
time for parepare:  0.0187225341796875
local_output_nid generation:  0.02247762680053711
local_in_edges_tensor generation:  0.04295039176940918
mini_batch_src_global generation:  0.03630375862121582
r_  generation:  0.3846321105957031
local_output_nid generation:  0.027667999267578125
local_in_edges_tensor generation:  0.03041982650756836
mini_batch_src_global generation:  0.04624056816101074
r_  generation:  0.3902428150177002
local_output_nid generation:  0.02820110321044922
local_in_edges_tensor generation:  0.026205062866210938
mini_batch_src_global generation:  0.04525899887084961
r_  generation:  0.40165019035339355
local_output_nid generation:  0.028331518173217773
local_in_edges_tensor generation:  0.029748201370239258
mini_batch_src_global generation:  0.04718923568725586
r_  generation:  0.4102334976196289
local_output_nid generation:  0.02800726890563965
local_in_edges_tensor generation:  0.024126291275024414
mini_batch_src_global generation:  0.04619240760803223
r_  generation:  0.40353989601135254
local_output_nid generation:  0.029266834259033203
local_in_edges_tensor generation:  0.026769638061523438
mini_batch_src_global generation:  0.04686260223388672
r_  generation:  0.3993549346923828
local_output_nid generation:  0.026572465896606445
local_in_edges_tensor generation:  0.03076624870300293
mini_batch_src_global generation:  0.04631662368774414
r_  generation:  0.4107332229614258
local_output_nid generation:  0.02644038200378418
local_in_edges_tensor generation:  0.027059316635131836
mini_batch_src_global generation:  0.05222797393798828
r_  generation:  0.40318965911865234
local_output_nid generation:  0.027468204498291016
local_in_edges_tensor generation:  0.030962228775024414
mini_batch_src_global generation:  0.047998666763305664
r_  generation:  0.4045405387878418
local_output_nid generation:  0.026968002319335938
local_in_edges_tensor generation:  0.02747488021850586
mini_batch_src_global generation:  0.0477292537689209
r_  generation:  0.41892266273498535
local_output_nid generation:  0.029732465744018555
local_in_edges_tensor generation:  0.02769160270690918
mini_batch_src_global generation:  0.04698801040649414
r_  generation:  0.40242552757263184
local_output_nid generation:  0.027738332748413086
local_in_edges_tensor generation:  0.02715921401977539
mini_batch_src_global generation:  0.04923868179321289
r_  generation:  0.3983454704284668
local_output_nid generation:  0.02763199806213379
local_in_edges_tensor generation:  0.024614810943603516
mini_batch_src_global generation:  0.04669022560119629
r_  generation:  0.40677356719970703
local_output_nid generation:  0.02763676643371582
local_in_edges_tensor generation:  0.027921676635742188
mini_batch_src_global generation:  0.047653913497924805
r_  generation:  0.4010944366455078
local_output_nid generation:  0.02768874168395996
local_in_edges_tensor generation:  0.02440500259399414
mini_batch_src_global generation:  0.04588174819946289
r_  generation:  0.4078516960144043
local_output_nid generation:  0.028666019439697266
local_in_edges_tensor generation:  0.029204368591308594
mini_batch_src_global generation:  0.048706769943237305
r_  generation:  0.40473079681396484
local_output_nid generation:  0.027447938919067383
local_in_edges_tensor generation:  0.02457451820373535
mini_batch_src_global generation:  0.045851707458496094
r_  generation:  0.4005272388458252
local_output_nid generation:  0.0274198055267334
local_in_edges_tensor generation:  0.023648500442504883
mini_batch_src_global generation:  0.04806852340698242
r_  generation:  0.39462780952453613
local_output_nid generation:  0.02781844139099121
local_in_edges_tensor generation:  0.025320768356323242
mini_batch_src_global generation:  0.04761052131652832
r_  generation:  0.4079890251159668
local_output_nid generation:  0.029204130172729492
local_in_edges_tensor generation:  0.028877735137939453
mini_batch_src_global generation:  0.048104286193847656
r_  generation:  0.39849162101745605
local_output_nid generation:  0.02750563621520996
local_in_edges_tensor generation:  0.027494192123413086
mini_batch_src_global generation:  0.046851158142089844
r_  generation:  0.3995661735534668
local_output_nid generation:  0.027772188186645508
local_in_edges_tensor generation:  0.025328874588012695
mini_batch_src_global generation:  0.05278468132019043
r_  generation:  0.4040060043334961
local_output_nid generation:  0.027545928955078125
local_in_edges_tensor generation:  0.028245925903320312
mini_batch_src_global generation:  0.048673391342163086
r_  generation:  0.4033982753753662
local_output_nid generation:  0.027804851531982422
local_in_edges_tensor generation:  0.02564549446105957
mini_batch_src_global generation:  0.05039548873901367
r_  generation:  0.40351128578186035
local_output_nid generation:  0.027535200119018555
local_in_edges_tensor generation:  0.03095245361328125
mini_batch_src_global generation:  0.047310829162597656
r_  generation:  0.40462279319763184
local_output_nid generation:  0.02812790870666504
local_in_edges_tensor generation:  0.028866291046142578
mini_batch_src_global generation:  0.05029153823852539
r_  generation:  0.40697765350341797
local_output_nid generation:  0.028582096099853516
local_in_edges_tensor generation:  0.027712106704711914
mini_batch_src_global generation:  0.0465242862701416
r_  generation:  0.40375399589538574
local_output_nid generation:  0.027510404586791992
local_in_edges_tensor generation:  0.0267031192779541
mini_batch_src_global generation:  0.05048823356628418
r_  generation:  0.40302228927612305
local_output_nid generation:  0.02797412872314453
local_in_edges_tensor generation:  0.02739429473876953
mini_batch_src_global generation:  0.04805445671081543
r_  generation:  0.4245152473449707
local_output_nid generation:  0.028830766677856445
local_in_edges_tensor generation:  0.027871370315551758
mini_batch_src_global generation:  0.04909515380859375
r_  generation:  0.40693044662475586
local_output_nid generation:  0.028650283813476562
local_in_edges_tensor generation:  0.02642083168029785
mini_batch_src_global generation:  0.04735279083251953
r_  generation:  0.40337395668029785
local_output_nid generation:  0.02742171287536621
local_in_edges_tensor generation:  0.03043651580810547
mini_batch_src_global generation:  0.04807329177856445
r_  generation:  0.3963942527770996
----------------------check_connections_block total spend ----------------------------- 19.10400390625
generate_one_block  0.5338342189788818
generate_one_block  0.5242083072662354
generate_one_block  0.5335254669189453
generate_one_block  0.5364460945129395
generate_one_block  0.6369454860687256
generate_one_block  0.5223026275634766
generate_one_block  0.5409767627716064
generate_one_block  0.5355582237243652
generate_one_block  0.5265979766845703
generate_one_block  0.529444694519043
generate_one_block  0.5384085178375244
generate_one_block  0.5349855422973633
generate_one_block  0.5384445190429688
generate_one_block  0.5393192768096924
generate_one_block  0.5313732624053955
generate_one_block  0.5429134368896484
generate_one_block  0.5296316146850586
generate_one_block  0.523690938949585
generate_one_block  0.5349612236022949
generate_one_block  0.5324501991271973
generate_one_block  0.525277853012085
generate_one_block  0.5392372608184814
generate_one_block  0.5269832611083984
generate_one_block  0.5363447666168213
generate_one_block  0.5425443649291992
generate_one_block  0.5452780723571777
generate_one_block  0.5290591716766357
generate_one_block  0.5330953598022461
generate_one_block  0.5478157997131348
generate_one_block  0.537024736404419
generate_one_block  0.542046070098877
generate_one_block  0.527271032333374
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.11942625045776367  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

connection checking time:  26.37242102622986
block generation total time  22.94375967979431
average batch blocks generation time:  0.7169924899935722
block dataloader generation time/epoch 51.53745895624161
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10257482528686523  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.376865863800049  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10260295867919922  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.636394500732422  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10400867462158203  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.72993516921997  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10409069061279297  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.85634708404541  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10280561447143555  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.508978366851807  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10298013687133789  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.355388164520264  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.1039113998413086  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.921110153198242  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10280895233154297  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.763885021209717  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10280513763427734  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.618525505065918  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10412406921386719  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.824830532073975  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10292577743530273  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.663709163665771  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10314750671386719  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.697800159454346  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.1039423942565918  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 16.011155128479004  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10409259796142578  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.750759601593018  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10502958297729492  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.883442401885986  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10445594787597656  GigaBytes
Max Memory Allocated: 16.170872688293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 16.213382720947266  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10280704498291016  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.406907558441162  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.1027841567993164  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.342476844787598  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10501432418823242  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.801953792572021  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10254383087158203  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.460963249206543  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10264062881469727  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.284192562103271  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10406970977783203  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.84409761428833  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10264825820922852  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.332972049713135  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.1040196418762207  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.829514980316162  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10398674011230469  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.694523334503174  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10429525375366211  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 16.057132720947266  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10271549224853516  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.507990837097168  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10281085968017578  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.642738342285156  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.1050562858581543  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 16.026283740997314  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10342741012573242  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.717990398406982  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10302400588989258  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.754550457000732  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.1026906967163086  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.31359052658081  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0367671400308609 |0.011923722922801971 |0.2619604617357254 |9.235739707946777e-05 |0.4281218349933624 |0.005852699279785156 |
----------------------------------------------------------pseudo_mini_loss sum 1.521227478981018
Total (block generation + training)time/epoch 75.3022329211235
Training time/epoch 23.70142388343811
Training time without block to device /epoch 23.319864749908447
Training time without total dataloading part /epoch 22.09144163131714
load block tensor time/epoch 1.1765484809875488
block to device time/epoch 0.3815591335296631
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  8570405
Number of first layer input nodes during this epoch:  4652125
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.12103605270385742  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022626638412475586
range selection method range initialization spend 0.01280832290649414
time for parepare:  0.01926565170288086
local_output_nid generation:  0.0009150505065917969
local_in_edges_tensor generation:  0.006566286087036133
mini_batch_src_global generation:  0.002283334732055664
r_  generation:  0.013063430786132812
local_output_nid generation:  0.001247406005859375
local_in_edges_tensor generation:  0.0006875991821289062
mini_batch_src_global generation:  0.0015075206756591797
r_  generation:  0.009368181228637695
local_output_nid generation:  0.0011038780212402344
local_in_edges_tensor generation:  0.0005972385406494141
mini_batch_src_global generation:  0.001012563705444336
r_  generation:  0.008277177810668945
local_output_nid generation:  0.0010683536529541016
local_in_edges_tensor generation:  0.0005578994750976562
mini_batch_src_global generation:  0.0010781288146972656
r_  generation:  0.008182287216186523
local_output_nid generation:  0.00102996826171875
local_in_edges_tensor generation:  0.0005819797515869141
mini_batch_src_global generation:  0.0011293888092041016
r_  generation:  0.008141040802001953
local_output_nid generation:  0.001009225845336914
local_in_edges_tensor generation:  0.0005447864532470703
mini_batch_src_global generation:  0.0009160041809082031
r_  generation:  0.008180618286132812
local_output_nid generation:  0.0009877681732177734
local_in_edges_tensor generation:  0.0005311965942382812
mini_batch_src_global generation:  0.0009462833404541016
r_  generation:  0.008306026458740234
local_output_nid generation:  0.0009741783142089844
local_in_edges_tensor generation:  0.0005474090576171875
mini_batch_src_global generation:  0.0010271072387695312
r_  generation:  0.008154869079589844
local_output_nid generation:  0.0009915828704833984
local_in_edges_tensor generation:  0.0005354881286621094
mini_batch_src_global generation:  0.0009443759918212891
r_  generation:  0.008246660232543945
local_output_nid generation:  0.0009942054748535156
local_in_edges_tensor generation:  0.0005342960357666016
mini_batch_src_global generation:  0.0009775161743164062
r_  generation:  0.008449077606201172
local_output_nid generation:  0.0009789466857910156
local_in_edges_tensor generation:  0.0005369186401367188
mini_batch_src_global generation:  0.0009796619415283203
r_  generation:  0.007946491241455078
local_output_nid generation:  0.0009870529174804688
local_in_edges_tensor generation:  0.0005385875701904297
mini_batch_src_global generation:  0.0009555816650390625
r_  generation:  0.008293628692626953
local_output_nid generation:  0.0009737014770507812
local_in_edges_tensor generation:  0.0005445480346679688
mini_batch_src_global generation:  0.0009696483612060547
r_  generation:  0.008194208145141602
local_output_nid generation:  0.0009748935699462891
local_in_edges_tensor generation:  0.0005307197570800781
mini_batch_src_global generation:  0.0009503364562988281
r_  generation:  0.00818014144897461
local_output_nid generation:  0.0009644031524658203
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.0033452510833740234
r_  generation:  0.018341064453125
local_output_nid generation:  0.0016584396362304688
local_in_edges_tensor generation:  0.0007944107055664062
mini_batch_src_global generation:  0.001348257064819336
r_  generation:  0.008879661560058594
local_output_nid generation:  0.0010106563568115234
local_in_edges_tensor generation:  0.0005528926849365234
mini_batch_src_global generation:  0.0010793209075927734
r_  generation:  0.00845956802368164
local_output_nid generation:  0.0009238719940185547
local_in_edges_tensor generation:  0.0004982948303222656
mini_batch_src_global generation:  0.0010094642639160156
r_  generation:  0.008419990539550781
local_output_nid generation:  0.0008921623229980469
local_in_edges_tensor generation:  0.0005118846893310547
mini_batch_src_global generation:  0.0009276866912841797
r_  generation:  0.007753133773803711
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0004942417144775391
mini_batch_src_global generation:  0.0009644031524658203
r_  generation:  0.008323431015014648
local_output_nid generation:  0.0008242130279541016
local_in_edges_tensor generation:  0.0005004405975341797
mini_batch_src_global generation:  0.0008981227874755859
r_  generation:  0.008107423782348633
local_output_nid generation:  0.0008139610290527344
local_in_edges_tensor generation:  0.0005214214324951172
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.008272647857666016
local_output_nid generation:  0.0008311271667480469
local_in_edges_tensor generation:  0.0004940032958984375
mini_batch_src_global generation:  0.0009000301361083984
r_  generation:  0.008453369140625
local_output_nid generation:  0.0008037090301513672
local_in_edges_tensor generation:  0.0004923343658447266
mini_batch_src_global generation:  0.0008916854858398438
r_  generation:  0.008377552032470703
local_output_nid generation:  0.0008039474487304688
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.0009160041809082031
r_  generation:  0.00830388069152832
local_output_nid generation:  0.0007910728454589844
local_in_edges_tensor generation:  0.0005052089691162109
mini_batch_src_global generation:  0.0008914470672607422
r_  generation:  0.008263111114501953
local_output_nid generation:  0.000797271728515625
local_in_edges_tensor generation:  0.0005183219909667969
mini_batch_src_global generation:  0.0008859634399414062
r_  generation:  0.008148670196533203
local_output_nid generation:  0.0008339881896972656
local_in_edges_tensor generation:  0.0005185604095458984
mini_batch_src_global generation:  0.0009205341339111328
r_  generation:  0.008466720581054688
local_output_nid generation:  0.0007872581481933594
local_in_edges_tensor generation:  0.0005176067352294922
mini_batch_src_global generation:  0.0009102821350097656
r_  generation:  0.008579015731811523
local_output_nid generation:  0.0007822513580322266
local_in_edges_tensor generation:  0.0004968643188476562
mini_batch_src_global generation:  0.0008847713470458984
r_  generation:  0.008263111114501953
local_output_nid generation:  0.0007734298706054688
local_in_edges_tensor generation:  0.0005013942718505859
mini_batch_src_global generation:  0.0008890628814697266
r_  generation:  0.008252859115600586
local_output_nid generation:  0.0007810592651367188
local_in_edges_tensor generation:  0.0004942417144775391
mini_batch_src_global generation:  0.0009036064147949219
r_  generation:  0.008502006530761719
----------------------check_connections_block total spend ----------------------------- 0.4630148410797119
generate_one_block  0.021930456161499023
generate_one_block  0.017063140869140625
generate_one_block  0.015187263488769531
generate_one_block  0.014925956726074219
generate_one_block  0.014617204666137695
generate_one_block  0.014758825302124023
generate_one_block  0.014432430267333984
generate_one_block  0.01598525047302246
generate_one_block  0.014386892318725586
generate_one_block  0.014719247817993164
generate_one_block  0.013944864273071289
generate_one_block  0.014657020568847656
generate_one_block  0.014317035675048828
generate_one_block  0.014328956604003906
generate_one_block  0.016590118408203125
generate_one_block  0.014530420303344727
generate_one_block  0.014440536499023438
generate_one_block  0.0144500732421875
generate_one_block  0.01366281509399414
generate_one_block  0.014460563659667969
generate_one_block  0.01419830322265625
generate_one_block  0.015743494033813477
generate_one_block  0.014507293701171875
generate_one_block  0.014317035675048828
generate_one_block  0.014432191848754883
generate_one_block  0.014391183853149414
generate_one_block  0.014194726943969727
generate_one_block  0.01469731330871582
generate_one_block  0.016191720962524414
generate_one_block  0.014358282089233398
generate_one_block  0.014327049255371094
generate_one_block  0.01475071907043457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03333258628845215
gen group dst list time:  0.019229412078857422
time for parepare:  0.022020578384399414
local_output_nid generation:  0.004891395568847656
local_in_edges_tensor generation:  0.015336990356445312
mini_batch_src_global generation:  0.012050151824951172
r_  generation:  0.127410888671875
local_output_nid generation:  0.008802175521850586
local_in_edges_tensor generation:  0.009018421173095703
mini_batch_src_global generation:  0.015745162963867188
r_  generation:  0.17020893096923828
local_output_nid generation:  0.007625579833984375
local_in_edges_tensor generation:  0.02925252914428711
mini_batch_src_global generation:  0.01605057716369629
r_  generation:  0.13829779624938965
local_output_nid generation:  0.007134437561035156
local_in_edges_tensor generation:  0.010464906692504883
mini_batch_src_global generation:  0.015117883682250977
r_  generation:  0.1356339454650879
local_output_nid generation:  0.008383035659790039
local_in_edges_tensor generation:  0.008615970611572266
mini_batch_src_global generation:  0.026640892028808594
r_  generation:  0.14011383056640625
local_output_nid generation:  0.00764012336730957
local_in_edges_tensor generation:  0.009180784225463867
mini_batch_src_global generation:  0.026514768600463867
r_  generation:  0.14202141761779785
local_output_nid generation:  0.007655620574951172
local_in_edges_tensor generation:  0.007703065872192383
mini_batch_src_global generation:  0.026468753814697266
r_  generation:  0.15167927742004395
local_output_nid generation:  0.011712789535522461
local_in_edges_tensor generation:  0.010144948959350586
mini_batch_src_global generation:  0.022707700729370117
r_  generation:  0.16485857963562012
local_output_nid generation:  0.009842872619628906
local_in_edges_tensor generation:  0.00914311408996582
mini_batch_src_global generation:  0.01970982551574707
r_  generation:  0.1340475082397461
local_output_nid generation:  0.008182525634765625
local_in_edges_tensor generation:  0.007854938507080078
mini_batch_src_global generation:  0.017128705978393555
r_  generation:  0.13865280151367188
local_output_nid generation:  0.007663726806640625
local_in_edges_tensor generation:  0.007676124572753906
mini_batch_src_global generation:  0.016073226928710938
r_  generation:  0.16456341743469238
local_output_nid generation:  0.007884025573730469
local_in_edges_tensor generation:  0.007531404495239258
mini_batch_src_global generation:  0.01647663116455078
r_  generation:  0.16965270042419434
local_output_nid generation:  0.00785970687866211
local_in_edges_tensor generation:  0.0072481632232666016
mini_batch_src_global generation:  0.016139984130859375
r_  generation:  0.13603973388671875
local_output_nid generation:  0.00781869888305664
local_in_edges_tensor generation:  0.00778961181640625
mini_batch_src_global generation:  0.016420602798461914
r_  generation:  0.13574957847595215
local_output_nid generation:  0.008245706558227539
local_in_edges_tensor generation:  0.00993657112121582
mini_batch_src_global generation:  0.018084049224853516
r_  generation:  0.14560794830322266
local_output_nid generation:  0.007914304733276367
local_in_edges_tensor generation:  0.007258176803588867
mini_batch_src_global generation:  0.018743276596069336
r_  generation:  0.14125752449035645
local_output_nid generation:  0.007940530776977539
local_in_edges_tensor generation:  0.007738828659057617
mini_batch_src_global generation:  0.018686294555664062
r_  generation:  0.14890360832214355
local_output_nid generation:  0.009813308715820312
local_in_edges_tensor generation:  0.007848262786865234
mini_batch_src_global generation:  0.020010948181152344
r_  generation:  0.14091253280639648
local_output_nid generation:  0.007890701293945312
local_in_edges_tensor generation:  0.007203817367553711
mini_batch_src_global generation:  0.016010522842407227
r_  generation:  0.13225293159484863
local_output_nid generation:  0.008108139038085938
local_in_edges_tensor generation:  0.007178544998168945
mini_batch_src_global generation:  0.01670384407043457
r_  generation:  0.13781499862670898
local_output_nid generation:  0.007979631423950195
local_in_edges_tensor generation:  0.0075914859771728516
mini_batch_src_global generation:  0.01634836196899414
r_  generation:  0.13661623001098633
local_output_nid generation:  0.00803685188293457
local_in_edges_tensor generation:  0.007738828659057617
mini_batch_src_global generation:  0.017102718353271484
r_  generation:  0.13873577117919922
local_output_nid generation:  0.00814199447631836
local_in_edges_tensor generation:  0.007814645767211914
mini_batch_src_global generation:  0.0166475772857666
r_  generation:  0.13973760604858398
local_output_nid generation:  0.008044004440307617
local_in_edges_tensor generation:  0.007646799087524414
mini_batch_src_global generation:  0.016394615173339844
r_  generation:  0.13799595832824707
local_output_nid generation:  0.008238077163696289
local_in_edges_tensor generation:  0.007738590240478516
mini_batch_src_global generation:  0.016295671463012695
r_  generation:  0.1396167278289795
local_output_nid generation:  0.008047342300415039
local_in_edges_tensor generation:  0.008156299591064453
mini_batch_src_global generation:  0.01635575294494629
r_  generation:  0.1390523910522461
local_output_nid generation:  0.008087873458862305
local_in_edges_tensor generation:  0.0072634220123291016
mini_batch_src_global generation:  0.016258955001831055
r_  generation:  0.14528155326843262
local_output_nid generation:  0.008177757263183594
local_in_edges_tensor generation:  0.007899999618530273
mini_batch_src_global generation:  0.017447948455810547
r_  generation:  0.14358806610107422
local_output_nid generation:  0.008422374725341797
local_in_edges_tensor generation:  0.008777618408203125
mini_batch_src_global generation:  0.016689300537109375
r_  generation:  0.14295601844787598
local_output_nid generation:  0.008137941360473633
local_in_edges_tensor generation:  0.008286476135253906
mini_batch_src_global generation:  0.016706466674804688
r_  generation:  0.14145612716674805
local_output_nid generation:  0.00812983512878418
local_in_edges_tensor generation:  0.007747650146484375
mini_batch_src_global generation:  0.01665949821472168
r_  generation:  0.13793611526489258
local_output_nid generation:  0.00837254524230957
local_in_edges_tensor generation:  0.00800323486328125
mini_batch_src_global generation:  0.017247676849365234
r_  generation:  0.1398146152496338
----------------------check_connections_block total spend ----------------------------- 6.805922508239746
generate_one_block  0.18868136405944824
generate_one_block  0.17924714088439941
generate_one_block  0.18047261238098145
generate_one_block  0.17849946022033691
generate_one_block  0.20316743850708008
generate_one_block  0.17882418632507324
generate_one_block  0.1758105754852295
generate_one_block  0.1787409782409668
generate_one_block  0.17123770713806152
generate_one_block  0.18268823623657227
generate_one_block  0.17035889625549316
generate_one_block  0.1787726879119873
generate_one_block  0.17561006546020508
generate_one_block  0.17779850959777832
generate_one_block  0.18822121620178223
generate_one_block  0.18218564987182617
generate_one_block  0.18248987197875977
generate_one_block  0.18229031562805176
generate_one_block  0.16972827911376953
generate_one_block  0.18230342864990234
generate_one_block  0.17505407333374023
generate_one_block  0.17780232429504395
generate_one_block  0.17697834968566895
generate_one_block  0.179121732711792
generate_one_block  0.1783161163330078
generate_one_block  0.17495393753051758
generate_one_block  0.1744215488433838
generate_one_block  0.1806039810180664
generate_one_block  0.1821303367614746
generate_one_block  0.18015289306640625
generate_one_block  0.176041841506958
generate_one_block  0.18359637260437012
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03418278694152832
gen group dst list time:  0.10847330093383789
time for parepare:  0.02064347267150879
local_output_nid generation:  0.02241063117980957
local_in_edges_tensor generation:  0.05453610420227051
mini_batch_src_global generation:  0.036690711975097656
r_  generation:  0.3926413059234619
local_output_nid generation:  0.02715897560119629
local_in_edges_tensor generation:  0.0313258171081543
mini_batch_src_global generation:  0.04713177680969238
r_  generation:  0.3965616226196289
local_output_nid generation:  0.027634859085083008
local_in_edges_tensor generation:  0.027849435806274414
mini_batch_src_global generation:  0.04791998863220215
r_  generation:  0.40712976455688477
local_output_nid generation:  0.027678489685058594
local_in_edges_tensor generation:  0.029776811599731445
mini_batch_src_global generation:  0.047669410705566406
r_  generation:  0.40055131912231445
local_output_nid generation:  0.027765274047851562
local_in_edges_tensor generation:  0.02585768699645996
mini_batch_src_global generation:  0.04822707176208496
r_  generation:  0.4050331115722656
local_output_nid generation:  0.027217626571655273
local_in_edges_tensor generation:  0.02782583236694336
mini_batch_src_global generation:  0.04807138442993164
r_  generation:  0.4032096862792969
local_output_nid generation:  0.026471376419067383
local_in_edges_tensor generation:  0.025789976119995117
mini_batch_src_global generation:  0.04643368721008301
r_  generation:  0.4066040515899658
local_output_nid generation:  0.026736736297607422
local_in_edges_tensor generation:  0.026802778244018555
mini_batch_src_global generation:  0.050298452377319336
r_  generation:  0.4009974002838135
local_output_nid generation:  0.027168989181518555
local_in_edges_tensor generation:  0.02981400489807129
mini_batch_src_global generation:  0.04614067077636719
r_  generation:  0.40122222900390625
local_output_nid generation:  0.026404380798339844
local_in_edges_tensor generation:  0.02626204490661621
mini_batch_src_global generation:  0.04807233810424805
r_  generation:  0.40125179290771484
local_output_nid generation:  0.026017427444458008
local_in_edges_tensor generation:  0.025995969772338867
mini_batch_src_global generation:  0.04604816436767578
r_  generation:  0.40015625953674316
local_output_nid generation:  0.02648186683654785
local_in_edges_tensor generation:  0.03239274024963379
mini_batch_src_global generation:  0.04989051818847656
r_  generation:  0.41739869117736816
local_output_nid generation:  0.02698516845703125
local_in_edges_tensor generation:  0.029523372650146484
mini_batch_src_global generation:  0.04708743095397949
r_  generation:  0.40541505813598633
local_output_nid generation:  0.02821826934814453
local_in_edges_tensor generation:  0.028130292892456055
mini_batch_src_global generation:  0.04971146583557129
r_  generation:  0.3998541831970215
local_output_nid generation:  0.027519941329956055
local_in_edges_tensor generation:  0.02806878089904785
mini_batch_src_global generation:  0.04855632781982422
r_  generation:  0.40981340408325195
local_output_nid generation:  0.027352333068847656
local_in_edges_tensor generation:  0.02651381492614746
mini_batch_src_global generation:  0.04839920997619629
r_  generation:  0.4027247428894043
local_output_nid generation:  0.027131080627441406
local_in_edges_tensor generation:  0.024729490280151367
mini_batch_src_global generation:  0.04638314247131348
r_  generation:  0.4064939022064209
local_output_nid generation:  0.02739715576171875
local_in_edges_tensor generation:  0.026700735092163086
mini_batch_src_global generation:  0.05161476135253906
r_  generation:  0.40271949768066406
local_output_nid generation:  0.026668787002563477
local_in_edges_tensor generation:  0.02951216697692871
mini_batch_src_global generation:  0.04660511016845703
r_  generation:  0.4026784896850586
local_output_nid generation:  0.02675342559814453
local_in_edges_tensor generation:  0.027326583862304688
mini_batch_src_global generation:  0.04792189598083496
r_  generation:  0.4100170135498047
local_output_nid generation:  0.026932239532470703
local_in_edges_tensor generation:  0.026156902313232422
mini_batch_src_global generation:  0.04651308059692383
r_  generation:  0.4055817127227783
local_output_nid generation:  0.027487516403198242
local_in_edges_tensor generation:  0.024667978286743164
mini_batch_src_global generation:  0.048966407775878906
r_  generation:  0.3997969627380371
local_output_nid generation:  0.027241230010986328
local_in_edges_tensor generation:  0.02691817283630371
mini_batch_src_global generation:  0.04716920852661133
r_  generation:  0.40908217430114746
local_output_nid generation:  0.026697397232055664
local_in_edges_tensor generation:  0.024913549423217773
mini_batch_src_global generation:  0.04918932914733887
r_  generation:  0.39853954315185547
local_output_nid generation:  0.027308225631713867
local_in_edges_tensor generation:  0.024956226348876953
mini_batch_src_global generation:  0.060559749603271484
r_  generation:  0.4052000045776367
local_output_nid generation:  0.026749134063720703
local_in_edges_tensor generation:  0.025119781494140625
mini_batch_src_global generation:  0.04808759689331055
r_  generation:  0.4011654853820801
local_output_nid generation:  0.02691340446472168
local_in_edges_tensor generation:  0.030857563018798828
mini_batch_src_global generation:  0.048610687255859375
r_  generation:  0.40827131271362305
local_output_nid generation:  0.02772665023803711
local_in_edges_tensor generation:  0.028038501739501953
mini_batch_src_global generation:  0.049491167068481445
r_  generation:  0.4069356918334961
local_output_nid generation:  0.027242183685302734
local_in_edges_tensor generation:  0.027348995208740234
mini_batch_src_global generation:  0.046936988830566406
r_  generation:  0.40643763542175293
local_output_nid generation:  0.027369022369384766
local_in_edges_tensor generation:  0.02530956268310547
mini_batch_src_global generation:  0.048857688903808594
r_  generation:  0.4009101390838623
local_output_nid generation:  0.027138471603393555
local_in_edges_tensor generation:  0.0259549617767334
mini_batch_src_global generation:  0.04700803756713867
r_  generation:  0.41386842727661133
local_output_nid generation:  0.027105331420898438
local_in_edges_tensor generation:  0.028438329696655273
mini_batch_src_global generation:  0.04875588417053223
r_  generation:  0.40460681915283203
----------------------check_connections_block total spend ----------------------------- 19.121995210647583
generate_one_block  0.5405285358428955
generate_one_block  0.5337460041046143
generate_one_block  0.536900520324707
generate_one_block  0.5350406169891357
generate_one_block  0.6228570938110352
generate_one_block  0.534959077835083
generate_one_block  0.5330202579498291
generate_one_block  0.5335307121276855
generate_one_block  0.5298378467559814
generate_one_block  0.5316512584686279
generate_one_block  0.5255272388458252
generate_one_block  0.5477011203765869
generate_one_block  0.5301592350006104
generate_one_block  0.5363364219665527
generate_one_block  0.5459561347961426
generate_one_block  0.5385544300079346
generate_one_block  0.530203104019165
generate_one_block  0.5378735065460205
generate_one_block  0.522160530090332
generate_one_block  0.5383408069610596
generate_one_block  0.534515380859375
generate_one_block  0.5377480983734131
generate_one_block  0.5372703075408936
generate_one_block  0.5259792804718018
generate_one_block  0.5519847869873047
generate_one_block  0.5257470607757568
generate_one_block  0.5509045124053955
generate_one_block  0.541008472442627
generate_one_block  0.5336935520172119
generate_one_block  0.5308191776275635
generate_one_block  0.5288419723510742
generate_one_block  0.5424685478210449
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.12103605270385742  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

connection checking time:  25.92791771888733
block generation total time  22.97216773033142
average batch blocks generation time:  0.7178802415728569
block dataloader generation time/epoch 51.50625829696655
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10301685333251953  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.772126197814941  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10297155380249023  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.781477928161621  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10389947891235352  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.965670108795166  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10413885116577148  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.845385551452637  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.1039266586303711  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.60106372833252  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.10429811477661133  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 15.865323066711426  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4100341796875 GB
    Memory Allocated: 0.1039743423461914  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.646103382110596  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10390949249267578  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.815567970275879  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10255765914916992  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.44841718673706  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10381317138671875  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.923792839050293  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10244226455688477  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.252429962158203  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10424566268920898  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.773294925689697  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10260486602783203  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.482385635375977  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10318899154663086  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.688811302185059  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10507011413574219  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.090447902679443  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10420417785644531  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.882323741912842  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10384750366210938  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.864006042480469  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10408639907836914  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.888788223266602  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1026148796081543  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.275516510009766  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10292911529541016  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.660813808441162  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10387325286865234  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.51594352722168  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1029505729675293  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.652294158935547  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10402202606201172  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.76184368133545  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1024928092956543  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.506441116333008  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10396671295166016  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.632467269897461  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10296440124511719  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.516079902648926  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10393524169921875  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.62760877609253  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10422372817993164  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.910717964172363  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10403251647949219  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.805856227874756  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10298538208007812  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.659202098846436  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1028742790222168  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.615014553070068  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10420465469360352  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.863030433654785  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0371822789311409 |0.009938955307006836 |0.2626153230667114 |9.006261825561523e-05 |0.42914823442697525 |0.004533529281616211 |
----------------------------------------------------------pseudo_mini_loss sum 1.4924159049987793
Total (block generation + training)time/epoch 75.25916485786438
Training time/epoch 23.705163955688477
Training time without block to device /epoch 23.387117385864258
Training time without total dataloading part /epoch 22.14384937286377
load block tensor time/epoch 1.1898329257965088
block to device time/epoch 0.31804656982421875
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  8577624
Number of first layer input nodes during this epoch:  4653076
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12216997146606445  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02500009536743164
range selection method range initialization spend 0.014537811279296875
time for parepare:  0.02149367332458496
local_output_nid generation:  0.0011577606201171875
local_in_edges_tensor generation:  0.006859540939331055
mini_batch_src_global generation:  0.0018193721771240234
r_  generation:  0.008397817611694336
local_output_nid generation:  0.0009958744049072266
local_in_edges_tensor generation:  0.0006568431854248047
mini_batch_src_global generation:  0.0016508102416992188
r_  generation:  0.009070634841918945
local_output_nid generation:  0.0009846687316894531
local_in_edges_tensor generation:  0.000621795654296875
mini_batch_src_global generation:  0.0012564659118652344
r_  generation:  0.008176326751708984
local_output_nid generation:  0.0009629726409912109
local_in_edges_tensor generation:  0.00064849853515625
mini_batch_src_global generation:  0.001218557357788086
r_  generation:  0.008108377456665039
local_output_nid generation:  0.0009167194366455078
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0011630058288574219
r_  generation:  0.008378982543945312
local_output_nid generation:  0.000926971435546875
local_in_edges_tensor generation:  0.0006616115570068359
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.008400201797485352
local_output_nid generation:  0.0009293556213378906
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.001043558120727539
r_  generation:  0.008357763290405273
local_output_nid generation:  0.0009119510650634766
local_in_edges_tensor generation:  0.0005614757537841797
mini_batch_src_global generation:  0.001009225845336914
r_  generation:  0.00834798812866211
local_output_nid generation:  0.0009560585021972656
local_in_edges_tensor generation:  0.0005731582641601562
mini_batch_src_global generation:  0.0010750293731689453
r_  generation:  0.008198976516723633
local_output_nid generation:  0.0009570121765136719
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0010251998901367188
r_  generation:  0.008280754089355469
local_output_nid generation:  0.0009572505950927734
local_in_edges_tensor generation:  0.0005517005920410156
mini_batch_src_global generation:  0.0009884834289550781
r_  generation:  0.008416414260864258
local_output_nid generation:  0.0009484291076660156
local_in_edges_tensor generation:  0.0005638599395751953
mini_batch_src_global generation:  0.0009987354278564453
r_  generation:  0.008326530456542969
local_output_nid generation:  0.0009620189666748047
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0009849071502685547
r_  generation:  0.00850677490234375
local_output_nid generation:  0.0009469985961914062
local_in_edges_tensor generation:  0.0005433559417724609
mini_batch_src_global generation:  0.0010333061218261719
r_  generation:  0.008422613143920898
local_output_nid generation:  0.0009324550628662109
local_in_edges_tensor generation:  0.0005497932434082031
mini_batch_src_global generation:  0.0009586811065673828
r_  generation:  0.008486509323120117
local_output_nid generation:  0.0009446144104003906
local_in_edges_tensor generation:  0.0005340576171875
mini_batch_src_global generation:  0.0009713172912597656
r_  generation:  0.008312702178955078
local_output_nid generation:  0.0009379386901855469
local_in_edges_tensor generation:  0.0005419254302978516
mini_batch_src_global generation:  0.0009541511535644531
r_  generation:  0.008405447006225586
local_output_nid generation:  0.0009472370147705078
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.0009844303131103516
r_  generation:  0.008525371551513672
local_output_nid generation:  0.0009057521820068359
local_in_edges_tensor generation:  0.0006229877471923828
mini_batch_src_global generation:  0.0012562274932861328
r_  generation:  0.00993490219116211
local_output_nid generation:  0.0009553432464599609
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.0010886192321777344
r_  generation:  0.008638143539428711
local_output_nid generation:  0.0009620189666748047
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.0010313987731933594
r_  generation:  0.008302450180053711
local_output_nid generation:  0.002357006072998047
local_in_edges_tensor generation:  0.0012776851654052734
mini_batch_src_global generation:  0.003161191940307617
r_  generation:  0.014264106750488281
local_output_nid generation:  0.001276254653930664
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0013246536254882812
r_  generation:  0.008241891860961914
local_output_nid generation:  0.0009462833404541016
local_in_edges_tensor generation:  0.0005178451538085938
mini_batch_src_global generation:  0.0010378360748291016
r_  generation:  0.008256673812866211
local_output_nid generation:  0.0009083747863769531
local_in_edges_tensor generation:  0.0005364418029785156
mini_batch_src_global generation:  0.0010249614715576172
r_  generation:  0.008346319198608398
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0009272098541259766
r_  generation:  0.008249759674072266
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0012383460998535156
r_  generation:  0.008351564407348633
local_output_nid generation:  0.0008478164672851562
local_in_edges_tensor generation:  0.0004963874816894531
mini_batch_src_global generation:  0.0009832382202148438
r_  generation:  0.00801849365234375
local_output_nid generation:  0.0008482933044433594
local_in_edges_tensor generation:  0.0004932880401611328
mini_batch_src_global generation:  0.0008790493011474609
r_  generation:  0.008108139038085938
local_output_nid generation:  0.0008230209350585938
local_in_edges_tensor generation:  0.0004811286926269531
mini_batch_src_global generation:  0.0009086132049560547
r_  generation:  0.008283138275146484
local_output_nid generation:  0.0008249282836914062
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0008709430694580078
r_  generation:  0.008093595504760742
local_output_nid generation:  0.0008237361907958984
local_in_edges_tensor generation:  0.00048279762268066406
mini_batch_src_global generation:  0.000858306884765625
r_  generation:  0.008138895034790039
----------------------check_connections_block total spend ----------------------------- 0.4631047248840332
generate_one_block  0.016720056533813477
generate_one_block  0.01735854148864746
generate_one_block  0.014935970306396484
generate_one_block  0.014443635940551758
generate_one_block  0.014833211898803711
generate_one_block  0.01457357406616211
generate_one_block  0.014625072479248047
generate_one_block  0.01476430892944336
generate_one_block  0.014454841613769531
generate_one_block  0.014285564422607422
generate_one_block  0.014321327209472656
generate_one_block  0.01468348503112793
generate_one_block  0.014470100402832031
generate_one_block  0.014516592025756836
generate_one_block  0.01454615592956543
generate_one_block  0.014457225799560547
generate_one_block  0.014475584030151367
generate_one_block  0.014658212661743164
generate_one_block  0.014978408813476562
generate_one_block  0.0148468017578125
generate_one_block  0.014394760131835938
generate_one_block  0.014519929885864258
generate_one_block  0.014198541641235352
generate_one_block  0.014426708221435547
generate_one_block  0.01472330093383789
generate_one_block  0.014248371124267578
generate_one_block  0.014405488967895508
generate_one_block  0.013951539993286133
generate_one_block  0.014208078384399414
generate_one_block  0.014461994171142578
generate_one_block  0.014099836349487305
generate_one_block  0.014280557632446289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03626298904418945
gen group dst list time:  0.021486282348632812
time for parepare:  0.019824504852294922
local_output_nid generation:  0.004577159881591797
local_in_edges_tensor generation:  0.015873193740844727
mini_batch_src_global generation:  0.013897895812988281
r_  generation:  0.12438249588012695
local_output_nid generation:  0.006726264953613281
local_in_edges_tensor generation:  0.008813858032226562
mini_batch_src_global generation:  0.01883864402770996
r_  generation:  0.1548900604248047
local_output_nid generation:  0.011156797409057617
local_in_edges_tensor generation:  0.03995060920715332
mini_batch_src_global generation:  0.016234636306762695
r_  generation:  0.15061259269714355
local_output_nid generation:  0.01376032829284668
local_in_edges_tensor generation:  0.011543512344360352
mini_batch_src_global generation:  0.021904706954956055
r_  generation:  0.13793253898620605
local_output_nid generation:  0.009825706481933594
local_in_edges_tensor generation:  0.008485555648803711
mini_batch_src_global generation:  0.017936229705810547
r_  generation:  0.14945650100708008
local_output_nid generation:  0.008800506591796875
local_in_edges_tensor generation:  0.00763702392578125
mini_batch_src_global generation:  0.027708768844604492
r_  generation:  0.15932011604309082
local_output_nid generation:  0.01067662239074707
local_in_edges_tensor generation:  0.0077974796295166016
mini_batch_src_global generation:  0.01907205581665039
r_  generation:  0.14417004585266113
local_output_nid generation:  0.008433341979980469
local_in_edges_tensor generation:  0.008825540542602539
mini_batch_src_global generation:  0.02006220817565918
r_  generation:  0.1390998363494873
local_output_nid generation:  0.00795602798461914
local_in_edges_tensor generation:  0.007099151611328125
mini_batch_src_global generation:  0.026926517486572266
r_  generation:  0.1643064022064209
local_output_nid generation:  0.008448123931884766
local_in_edges_tensor generation:  0.007792949676513672
mini_batch_src_global generation:  0.01894545555114746
r_  generation:  0.1356503963470459
local_output_nid generation:  0.00806283950805664
local_in_edges_tensor generation:  0.007164478302001953
mini_batch_src_global generation:  0.018474817276000977
r_  generation:  0.1408238410949707
local_output_nid generation:  0.008552789688110352
local_in_edges_tensor generation:  0.007631540298461914
mini_batch_src_global generation:  0.01920175552368164
r_  generation:  0.17052721977233887
local_output_nid generation:  0.012549161911010742
local_in_edges_tensor generation:  0.011719703674316406
mini_batch_src_global generation:  0.01967024803161621
r_  generation:  0.1556251049041748
local_output_nid generation:  0.011181116104125977
local_in_edges_tensor generation:  0.008906364440917969
mini_batch_src_global generation:  0.028308868408203125
r_  generation:  0.16547060012817383
local_output_nid generation:  0.009985923767089844
local_in_edges_tensor generation:  0.008591651916503906
mini_batch_src_global generation:  0.027458906173706055
r_  generation:  0.17528414726257324
local_output_nid generation:  0.00909113883972168
local_in_edges_tensor generation:  0.008011817932128906
mini_batch_src_global generation:  0.03148913383483887
r_  generation:  0.16181302070617676
local_output_nid generation:  0.012520074844360352
local_in_edges_tensor generation:  0.010349750518798828
mini_batch_src_global generation:  0.0392918586730957
r_  generation:  0.15952706336975098
local_output_nid generation:  0.01264810562133789
local_in_edges_tensor generation:  0.010444879531860352
mini_batch_src_global generation:  0.01986241340637207
r_  generation:  0.15391993522644043
local_output_nid generation:  0.013078689575195312
local_in_edges_tensor generation:  0.014479875564575195
mini_batch_src_global generation:  0.031861066818237305
r_  generation:  0.14809823036193848
local_output_nid generation:  0.011228799819946289
local_in_edges_tensor generation:  0.008260488510131836
mini_batch_src_global generation:  0.01783466339111328
r_  generation:  0.1391890048980713
local_output_nid generation:  0.009223699569702148
local_in_edges_tensor generation:  0.009214639663696289
mini_batch_src_global generation:  0.016466856002807617
r_  generation:  0.13506388664245605
local_output_nid generation:  0.009107589721679688
local_in_edges_tensor generation:  0.007270336151123047
mini_batch_src_global generation:  0.016737937927246094
r_  generation:  0.13756299018859863
local_output_nid generation:  0.008295774459838867
local_in_edges_tensor generation:  0.0070912837982177734
mini_batch_src_global generation:  0.016236066818237305
r_  generation:  0.1376025676727295
local_output_nid generation:  0.008537530899047852
local_in_edges_tensor generation:  0.007020235061645508
mini_batch_src_global generation:  0.016515016555786133
r_  generation:  0.13400816917419434
local_output_nid generation:  0.008215665817260742
local_in_edges_tensor generation:  0.00836634635925293
mini_batch_src_global generation:  0.016678810119628906
r_  generation:  0.14469552040100098
local_output_nid generation:  0.008356571197509766
local_in_edges_tensor generation:  0.0070650577545166016
mini_batch_src_global generation:  0.01682877540588379
r_  generation:  0.13811326026916504
local_output_nid generation:  0.008362770080566406
local_in_edges_tensor generation:  0.007494211196899414
mini_batch_src_global generation:  0.016913414001464844
r_  generation:  0.14273595809936523
local_output_nid generation:  0.00953221321105957
local_in_edges_tensor generation:  0.007684230804443359
mini_batch_src_global generation:  0.019344329833984375
r_  generation:  0.13382554054260254
local_output_nid generation:  0.008195877075195312
local_in_edges_tensor generation:  0.008400917053222656
mini_batch_src_global generation:  0.0279543399810791
r_  generation:  0.13916683197021484
local_output_nid generation:  0.008392572402954102
local_in_edges_tensor generation:  0.008528947830200195
mini_batch_src_global generation:  0.017275333404541016
r_  generation:  0.13867974281311035
local_output_nid generation:  0.008135557174682617
local_in_edges_tensor generation:  0.006983280181884766
mini_batch_src_global generation:  0.018543481826782227
r_  generation:  0.14142465591430664
local_output_nid generation:  0.008288145065307617
local_in_edges_tensor generation:  0.007548809051513672
mini_batch_src_global generation:  0.020317792892456055
r_  generation:  0.13687419891357422
----------------------check_connections_block total spend ----------------------------- 7.15471076965332
generate_one_block  0.18069911003112793
generate_one_block  0.17954802513122559
generate_one_block  0.1733109951019287
generate_one_block  0.1720273494720459
generate_one_block  0.2050929069519043
generate_one_block  0.17657089233398438
generate_one_block  0.17562413215637207
generate_one_block  0.20380616188049316
generate_one_block  0.18079543113708496
generate_one_block  0.17551183700561523
generate_one_block  0.17808270454406738
generate_one_block  0.17815661430358887
generate_one_block  0.1798851490020752
generate_one_block  0.18126416206359863
generate_one_block  0.17873620986938477
generate_one_block  0.1824791431427002
generate_one_block  0.18010258674621582
generate_one_block  0.1912860870361328
generate_one_block  0.1894669532775879
generate_one_block  0.19141626358032227
generate_one_block  0.1724100112915039
generate_one_block  0.18491268157958984
generate_one_block  0.17382359504699707
generate_one_block  0.17307066917419434
generate_one_block  0.18153667449951172
generate_one_block  0.17412829399108887
generate_one_block  0.17726731300354004
generate_one_block  0.16858148574829102
generate_one_block  0.17200851440429688
generate_one_block  0.1784811019897461
generate_one_block  0.17449021339416504
generate_one_block  0.17609286308288574
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03417634963989258
gen group dst list time:  0.10883903503417969
time for parepare:  0.020647525787353516
local_output_nid generation:  0.02243518829345703
local_in_edges_tensor generation:  0.05357480049133301
mini_batch_src_global generation:  0.05035901069641113
r_  generation:  0.44248294830322266
local_output_nid generation:  0.031241893768310547
local_in_edges_tensor generation:  0.03445744514465332
mini_batch_src_global generation:  0.05101609230041504
r_  generation:  0.4075500965118408
local_output_nid generation:  0.028449058532714844
local_in_edges_tensor generation:  0.026475191116333008
mini_batch_src_global generation:  0.048161983489990234
r_  generation:  0.4147298336029053
local_output_nid generation:  0.03039240837097168
local_in_edges_tensor generation:  0.03480720520019531
mini_batch_src_global generation:  0.05588936805725098
r_  generation:  0.42128634452819824
local_output_nid generation:  0.034000396728515625
local_in_edges_tensor generation:  0.027683734893798828
mini_batch_src_global generation:  0.04907345771789551
r_  generation:  0.4102902412414551
local_output_nid generation:  0.028084754943847656
local_in_edges_tensor generation:  0.026012420654296875
mini_batch_src_global generation:  0.050440073013305664
r_  generation:  0.40163111686706543
local_output_nid generation:  0.02696704864501953
local_in_edges_tensor generation:  0.02608513832092285
mini_batch_src_global generation:  0.046826839447021484
r_  generation:  0.40924739837646484
local_output_nid generation:  0.02730584144592285
local_in_edges_tensor generation:  0.026278972625732422
mini_batch_src_global generation:  0.04870748519897461
r_  generation:  0.40493154525756836
local_output_nid generation:  0.02740478515625
local_in_edges_tensor generation:  0.02670598030090332
mini_batch_src_global generation:  0.04717731475830078
r_  generation:  0.42613649368286133
local_output_nid generation:  0.027273893356323242
local_in_edges_tensor generation:  0.024464130401611328
mini_batch_src_global generation:  0.04849052429199219
r_  generation:  0.40651750564575195
local_output_nid generation:  0.027522802352905273
local_in_edges_tensor generation:  0.02817368507385254
mini_batch_src_global generation:  0.048432350158691406
r_  generation:  0.413616418838501
local_output_nid generation:  0.027828693389892578
local_in_edges_tensor generation:  0.029674053192138672
mini_batch_src_global generation:  0.04988813400268555
r_  generation:  0.4055628776550293
local_output_nid generation:  0.02735614776611328
local_in_edges_tensor generation:  0.02673816680908203
mini_batch_src_global generation:  0.04725241661071777
r_  generation:  0.4087972640991211
local_output_nid generation:  0.027348756790161133
local_in_edges_tensor generation:  0.026371240615844727
mini_batch_src_global generation:  0.04869866371154785
r_  generation:  0.40700244903564453
local_output_nid generation:  0.027457475662231445
local_in_edges_tensor generation:  0.027338743209838867
mini_batch_src_global generation:  0.04706096649169922
r_  generation:  0.41188859939575195
local_output_nid generation:  0.028634309768676758
local_in_edges_tensor generation:  0.029664278030395508
mini_batch_src_global generation:  0.048903465270996094
r_  generation:  0.41014599800109863
local_output_nid generation:  0.029567241668701172
local_in_edges_tensor generation:  0.029247283935546875
mini_batch_src_global generation:  0.04710030555725098
r_  generation:  0.4188213348388672
local_output_nid generation:  0.028867483139038086
local_in_edges_tensor generation:  0.029903650283813477
mini_batch_src_global generation:  0.04906630516052246
r_  generation:  0.4287233352661133
local_output_nid generation:  0.03222203254699707
local_in_edges_tensor generation:  0.02696371078491211
mini_batch_src_global generation:  0.04944658279418945
r_  generation:  0.41191744804382324
local_output_nid generation:  0.02753305435180664
local_in_edges_tensor generation:  0.02915191650390625
mini_batch_src_global generation:  0.047937631607055664
r_  generation:  0.41158032417297363
local_output_nid generation:  0.026867151260375977
local_in_edges_tensor generation:  0.024216651916503906
mini_batch_src_global generation:  0.04744768142700195
r_  generation:  0.4000864028930664
local_output_nid generation:  0.027670621871948242
local_in_edges_tensor generation:  0.024898529052734375
mini_batch_src_global generation:  0.04758453369140625
r_  generation:  0.40221691131591797
local_output_nid generation:  0.027446985244750977
local_in_edges_tensor generation:  0.025255441665649414
mini_batch_src_global generation:  0.04618549346923828
r_  generation:  0.4045224189758301
local_output_nid generation:  0.027231931686401367
local_in_edges_tensor generation:  0.024319171905517578
mini_batch_src_global generation:  0.04747796058654785
r_  generation:  0.3995349407196045
local_output_nid generation:  0.02752852439880371
local_in_edges_tensor generation:  0.026551246643066406
mini_batch_src_global generation:  0.047220706939697266
r_  generation:  0.4092860221862793
local_output_nid generation:  0.027617931365966797
local_in_edges_tensor generation:  0.024782896041870117
mini_batch_src_global generation:  0.04804873466491699
r_  generation:  0.3995993137359619
local_output_nid generation:  0.02738022804260254
local_in_edges_tensor generation:  0.024904489517211914
mini_batch_src_global generation:  0.04676389694213867
r_  generation:  0.4056379795074463
local_output_nid generation:  0.027233600616455078
local_in_edges_tensor generation:  0.02526092529296875
mini_batch_src_global generation:  0.04747200012207031
r_  generation:  0.39786553382873535
local_output_nid generation:  0.02717423439025879
local_in_edges_tensor generation:  0.02416706085205078
mini_batch_src_global generation:  0.04623556137084961
r_  generation:  0.40601348876953125
local_output_nid generation:  0.02771925926208496
local_in_edges_tensor generation:  0.02663421630859375
mini_batch_src_global generation:  0.049704790115356445
r_  generation:  0.403989315032959
local_output_nid generation:  0.02769160270690918
local_in_edges_tensor generation:  0.027250289916992188
mini_batch_src_global generation:  0.046263694763183594
r_  generation:  0.4126567840576172
local_output_nid generation:  0.027453184127807617
local_in_edges_tensor generation:  0.02991032600402832
mini_batch_src_global generation:  0.05053567886352539
r_  generation:  0.40486931800842285
----------------------check_connections_block total spend ----------------------------- 19.381017208099365
generate_one_block  0.5453801155090332
generate_one_block  0.5320703983306885
generate_one_block  0.5327599048614502
generate_one_block  0.5333578586578369
generate_one_block  0.6329278945922852
generate_one_block  0.5358917713165283
generate_one_block  0.5375463962554932
generate_one_block  0.5432448387145996
generate_one_block  0.5361294746398926
generate_one_block  0.5269827842712402
generate_one_block  0.5283899307250977
generate_one_block  0.5320184230804443
generate_one_block  0.5299627780914307
generate_one_block  0.5409660339355469
generate_one_block  0.5403854846954346
generate_one_block  0.5373873710632324
generate_one_block  0.5484147071838379
generate_one_block  0.543936014175415
generate_one_block  0.5420596599578857
generate_one_block  0.5321767330169678
generate_one_block  0.5222930908203125
generate_one_block  0.5312881469726562
generate_one_block  0.5331039428710938
generate_one_block  0.527930498123169
generate_one_block  0.5597105026245117
generate_one_block  0.5278594493865967
generate_one_block  0.5309607982635498
generate_one_block  0.5203406810760498
generate_one_block  0.5275318622589111
generate_one_block  0.5389313697814941
generate_one_block  0.5415573120117188
generate_one_block  0.5376405715942383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12216997146606445  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

connection checking time:  26.535727977752686
block generation total time  22.99180293083191
average batch blocks generation time:  0.7184938415884972
block dataloader generation time/epoch 51.59609921773275
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10274171829223633  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.576591491699219  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10425424575805664  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.850079536437988  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10280275344848633  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.617591381072998  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10294198989868164  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.553434371948242  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10289478302001953  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.81551456451416  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10322141647338867  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.757497787475586  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10300064086914062  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.742661476135254  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10427188873291016  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.958725452423096  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10401153564453125  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.73871374130249  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1030263900756836  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.55155086517334  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10281181335449219  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.60446548461914  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10303401947021484  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.678543090820312  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10395431518554688  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.603196620941162  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10411834716796875  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.874403476715088  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10296058654785156  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.749045848846436  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10327291488647461  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.743459701538086  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1050105094909668  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.818447589874268  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10400199890136719  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.877344131469727  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10504961013793945  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.04193639755249  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10431909561157227  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.935481548309326  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10234498977661133  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.269801616668701  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10297632217407227  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.763341903686523  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10387516021728516  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.524916172027588  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10294342041015625  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.512491703033447  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10504579544067383  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.964987754821777  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10292434692382812  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.637720584869385  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.103973388671875  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.652830600738525  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10276603698730469  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.237688541412354  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1026906967163086  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.446020126342773  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10334444046020508  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.712287425994873  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10395145416259766  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.618866443634033  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10418462753295898  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.693623542785645  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03684217482805252 |0.012178495526313782 |0.26349372416734695 |9.157508611679077e-05 |0.4288753867149353 |0.005901336669921875 |
----------------------------------------------------------pseudo_mini_loss sum 1.46393620967865
Total (block generation + training)time/epoch 75.35420779387157
Training time/epoch 23.783870935440063
Training time without block to device /epoch 23.394159078598022
Training time without total dataloading part /epoch 22.16464328765869
load block tensor time/epoch 1.1789495944976807
block to device time/epoch 0.389711856842041
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  8575850
Number of first layer input nodes during this epoch:  4655429
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1224513053894043  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022389888763427734
range selection method range initialization spend 0.01657247543334961
time for parepare:  0.01895594596862793
local_output_nid generation:  0.0008985996246337891
local_in_edges_tensor generation:  0.003663778305053711
mini_batch_src_global generation:  0.0015187263488769531
r_  generation:  0.008941411972045898
local_output_nid generation:  0.0009412765502929688
local_in_edges_tensor generation:  0.0006556510925292969
mini_batch_src_global generation:  0.001312255859375
r_  generation:  0.00840139389038086
local_output_nid generation:  0.0009014606475830078
local_in_edges_tensor generation:  0.0005548000335693359
mini_batch_src_global generation:  0.0009827613830566406
r_  generation:  0.007930517196655273
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0005016326904296875
mini_batch_src_global generation:  0.0008769035339355469
r_  generation:  0.007942914962768555
local_output_nid generation:  0.0008375644683837891
local_in_edges_tensor generation:  0.000507354736328125
mini_batch_src_global generation:  0.0008683204650878906
r_  generation:  0.007883548736572266
local_output_nid generation:  0.0008218288421630859
local_in_edges_tensor generation:  0.0004966259002685547
mini_batch_src_global generation:  0.0008728504180908203
r_  generation:  0.008038043975830078
local_output_nid generation:  0.0008149147033691406
local_in_edges_tensor generation:  0.0005011558532714844
mini_batch_src_global generation:  0.0008687973022460938
r_  generation:  0.008183002471923828
local_output_nid generation:  0.0008139610290527344
local_in_edges_tensor generation:  0.0004949569702148438
mini_batch_src_global generation:  0.0008533000946044922
r_  generation:  0.008239507675170898
local_output_nid generation:  0.0008130073547363281
local_in_edges_tensor generation:  0.0004944801330566406
mini_batch_src_global generation:  0.0008549690246582031
r_  generation:  0.00780487060546875
local_output_nid generation:  0.00080108642578125
local_in_edges_tensor generation:  0.0005002021789550781
mini_batch_src_global generation:  0.0009150505065917969
r_  generation:  0.008099555969238281
local_output_nid generation:  0.0008296966552734375
local_in_edges_tensor generation:  0.0004925727844238281
mini_batch_src_global generation:  0.0008776187896728516
r_  generation:  0.008191585540771484
local_output_nid generation:  0.0008080005645751953
local_in_edges_tensor generation:  0.00048232078552246094
mini_batch_src_global generation:  0.0008747577667236328
r_  generation:  0.00832676887512207
local_output_nid generation:  0.0008149147033691406
local_in_edges_tensor generation:  0.0005042552947998047
mini_batch_src_global generation:  0.0008981227874755859
r_  generation:  0.008036613464355469
local_output_nid generation:  0.0008111000061035156
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0008788108825683594
r_  generation:  0.008187055587768555
local_output_nid generation:  0.0008084774017333984
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.0008862018585205078
r_  generation:  0.008074045181274414
local_output_nid generation:  0.0008234977722167969
local_in_edges_tensor generation:  0.0004990100860595703
mini_batch_src_global generation:  0.0009241104125976562
r_  generation:  0.008327484130859375
local_output_nid generation:  0.0008130073547363281
local_in_edges_tensor generation:  0.0004940032958984375
mini_batch_src_global generation:  0.0009291172027587891
r_  generation:  0.008154153823852539
local_output_nid generation:  0.0008103847503662109
local_in_edges_tensor generation:  0.0005044937133789062
mini_batch_src_global generation:  0.0009324550628662109
r_  generation:  0.008579015731811523
local_output_nid generation:  0.0007953643798828125
local_in_edges_tensor generation:  0.00048732757568359375
mini_batch_src_global generation:  0.0009136199951171875
r_  generation:  0.008373498916625977
local_output_nid generation:  0.0008046627044677734
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0010118484497070312
r_  generation:  0.008486270904541016
local_output_nid generation:  0.0007922649383544922
local_in_edges_tensor generation:  0.0005357265472412109
mini_batch_src_global generation:  0.0008859634399414062
r_  generation:  0.00799417495727539
local_output_nid generation:  0.0008029937744140625
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0008788108825683594
r_  generation:  0.008289813995361328
local_output_nid generation:  0.0007996559143066406
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0008902549743652344
r_  generation:  0.00838160514831543
local_output_nid generation:  0.0007922649383544922
local_in_edges_tensor generation:  0.0004799365997314453
mini_batch_src_global generation:  0.0009138584136962891
r_  generation:  0.008423805236816406
local_output_nid generation:  0.00078582763671875
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0008602142333984375
r_  generation:  0.008310556411743164
local_output_nid generation:  0.0007929801940917969
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.0008573532104492188
r_  generation:  0.010802984237670898
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005021095275878906
mini_batch_src_global generation:  0.0011255741119384766
r_  generation:  0.008339881896972656
local_output_nid generation:  0.0007822513580322266
local_in_edges_tensor generation:  0.0004932880401611328
mini_batch_src_global generation:  0.0008604526519775391
r_  generation:  0.007982254028320312
local_output_nid generation:  0.0007936954498291016
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0008630752563476562
r_  generation:  0.008426189422607422
local_output_nid generation:  0.0007963180541992188
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.000881195068359375
r_  generation:  0.008218765258789062
local_output_nid generation:  0.0008013248443603516
local_in_edges_tensor generation:  0.0004985332489013672
mini_batch_src_global generation:  0.0009212493896484375
r_  generation:  0.00848698616027832
local_output_nid generation:  0.0008099079132080078
local_in_edges_tensor generation:  0.0005025863647460938
mini_batch_src_global generation:  0.0008685588836669922
r_  generation:  0.007970094680786133
----------------------check_connections_block total spend ----------------------------- 0.42896270751953125
generate_one_block  0.020836353302001953
generate_one_block  0.019667387008666992
generate_one_block  0.015079498291015625
generate_one_block  0.014600276947021484
generate_one_block  0.014443159103393555
generate_one_block  0.014465808868408203
generate_one_block  0.014622211456298828
generate_one_block  0.014609336853027344
generate_one_block  0.01680588722229004
generate_one_block  0.014523744583129883
generate_one_block  0.014450788497924805
generate_one_block  0.014829874038696289
generate_one_block  0.014325618743896484
generate_one_block  0.014465570449829102
generate_one_block  0.014069557189941406
generate_one_block  0.017676115036010742
generate_one_block  0.014296770095825195
generate_one_block  0.01480555534362793
generate_one_block  0.014568805694580078
generate_one_block  0.014774084091186523
generate_one_block  0.01409006118774414
generate_one_block  0.014524221420288086
generate_one_block  0.016665935516357422
generate_one_block  0.014686822891235352
generate_one_block  0.014503002166748047
generate_one_block  0.01477193832397461
generate_one_block  0.014475822448730469
generate_one_block  0.013990640640258789
generate_one_block  0.01459646224975586
generate_one_block  0.01641225814819336
generate_one_block  0.014539003372192383
generate_one_block  0.01386260986328125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03806591033935547
gen group dst list time:  0.021952390670776367
time for parepare:  0.023824214935302734
local_output_nid generation:  0.00484013557434082
local_in_edges_tensor generation:  0.01716899871826172
mini_batch_src_global generation:  0.013252019882202148
r_  generation:  0.12896394729614258
local_output_nid generation:  0.0068585872650146484
local_in_edges_tensor generation:  0.008913516998291016
mini_batch_src_global generation:  0.016385793685913086
r_  generation:  0.1289682388305664
local_output_nid generation:  0.006913423538208008
local_in_edges_tensor generation:  0.031206846237182617
mini_batch_src_global generation:  0.014521121978759766
r_  generation:  0.1348860263824463
local_output_nid generation:  0.007697582244873047
local_in_edges_tensor generation:  0.009200572967529297
mini_batch_src_global generation:  0.0173037052154541
r_  generation:  0.13254618644714355
local_output_nid generation:  0.0073854923248291016
local_in_edges_tensor generation:  0.0070858001708984375
mini_batch_src_global generation:  0.015741586685180664
r_  generation:  0.1399531364440918
local_output_nid generation:  0.008929252624511719
local_in_edges_tensor generation:  0.008153676986694336
mini_batch_src_global generation:  0.027958154678344727
r_  generation:  0.13850808143615723
local_output_nid generation:  0.007973194122314453
local_in_edges_tensor generation:  0.007889032363891602
mini_batch_src_global generation:  0.01722574234008789
r_  generation:  0.13666176795959473
local_output_nid generation:  0.0077855587005615234
local_in_edges_tensor generation:  0.0076673030853271484
mini_batch_src_global generation:  0.016442298889160156
r_  generation:  0.13662028312683105
local_output_nid generation:  0.007274150848388672
local_in_edges_tensor generation:  0.008502960205078125
mini_batch_src_global generation:  0.015995502471923828
r_  generation:  0.1675879955291748
local_output_nid generation:  0.011981964111328125
local_in_edges_tensor generation:  0.010149955749511719
mini_batch_src_global generation:  0.019712209701538086
r_  generation:  0.17168903350830078
local_output_nid generation:  0.01035761833190918
local_in_edges_tensor generation:  0.008380651473999023
mini_batch_src_global generation:  0.01777195930480957
r_  generation:  0.1372387409210205
local_output_nid generation:  0.008663177490234375
local_in_edges_tensor generation:  0.007773876190185547
mini_batch_src_global generation:  0.01686835289001465
r_  generation:  0.13783502578735352
local_output_nid generation:  0.008278846740722656
local_in_edges_tensor generation:  0.007355451583862305
mini_batch_src_global generation:  0.016282320022583008
r_  generation:  0.1374218463897705
local_output_nid generation:  0.008120298385620117
local_in_edges_tensor generation:  0.007858037948608398
mini_batch_src_global generation:  0.01641988754272461
r_  generation:  0.13700342178344727
local_output_nid generation:  0.007895708084106445
local_in_edges_tensor generation:  0.007064104080200195
mini_batch_src_global generation:  0.015940427780151367
r_  generation:  0.16238999366760254
local_output_nid generation:  0.013010263442993164
local_in_edges_tensor generation:  0.010980844497680664
mini_batch_src_global generation:  0.021267414093017578
r_  generation:  0.17988348007202148
local_output_nid generation:  0.010451316833496094
local_in_edges_tensor generation:  0.009279966354370117
mini_batch_src_global generation:  0.017359256744384766
r_  generation:  0.1379566192626953
local_output_nid generation:  0.009080648422241211
local_in_edges_tensor generation:  0.008478403091430664
mini_batch_src_global generation:  0.01761341094970703
r_  generation:  0.1405329704284668
local_output_nid generation:  0.008321762084960938
local_in_edges_tensor generation:  0.008456945419311523
mini_batch_src_global generation:  0.01663994789123535
r_  generation:  0.13855814933776855
local_output_nid generation:  0.008458852767944336
local_in_edges_tensor generation:  0.008025884628295898
mini_batch_src_global generation:  0.016523122787475586
r_  generation:  0.17341828346252441
local_output_nid generation:  0.008056879043579102
local_in_edges_tensor generation:  0.007277727127075195
mini_batch_src_global generation:  0.016354799270629883
r_  generation:  0.16652512550354004
local_output_nid generation:  0.008220195770263672
local_in_edges_tensor generation:  0.007314443588256836
mini_batch_src_global generation:  0.016819477081298828
r_  generation:  0.171494722366333
local_output_nid generation:  0.008297443389892578
local_in_edges_tensor generation:  0.00838160514831543
mini_batch_src_global generation:  0.016542434692382812
r_  generation:  0.1732470989227295
local_output_nid generation:  0.008075714111328125
local_in_edges_tensor generation:  0.007968425750732422
mini_batch_src_global generation:  0.018799304962158203
r_  generation:  0.1872844696044922
local_output_nid generation:  0.008148670196533203
local_in_edges_tensor generation:  0.008036136627197266
mini_batch_src_global generation:  0.017119169235229492
r_  generation:  0.14020681381225586
local_output_nid generation:  0.008310556411743164
local_in_edges_tensor generation:  0.008109331130981445
mini_batch_src_global generation:  0.01665663719177246
r_  generation:  0.1411428451538086
local_output_nid generation:  0.008212566375732422
local_in_edges_tensor generation:  0.00781702995300293
mini_batch_src_global generation:  0.016663551330566406
r_  generation:  0.14347052574157715
local_output_nid generation:  0.008122920989990234
local_in_edges_tensor generation:  0.009035348892211914
mini_batch_src_global generation:  0.016221046447753906
r_  generation:  0.136887788772583
local_output_nid generation:  0.00817108154296875
local_in_edges_tensor generation:  0.0074462890625
mini_batch_src_global generation:  0.018398523330688477
r_  generation:  0.144089937210083
local_output_nid generation:  0.008029460906982422
local_in_edges_tensor generation:  0.007407665252685547
mini_batch_src_global generation:  0.016080617904663086
r_  generation:  0.16857552528381348
local_output_nid generation:  0.00821232795715332
local_in_edges_tensor generation:  0.008756160736083984
mini_batch_src_global generation:  0.017318010330200195
r_  generation:  0.1927504539489746
local_output_nid generation:  0.007904291152954102
local_in_edges_tensor generation:  0.008159160614013672
mini_batch_src_global generation:  0.016602516174316406
r_  generation:  0.13945651054382324
----------------------check_connections_block total spend ----------------------------- 7.021977663040161
generate_one_block  0.19277358055114746
generate_one_block  0.17974638938903809
generate_one_block  0.1844501495361328
generate_one_block  0.17502617835998535
generate_one_block  0.20382261276245117
generate_one_block  0.17623090744018555
generate_one_block  0.17755699157714844
generate_one_block  0.17960739135742188
generate_one_block  0.1692197322845459
generate_one_block  0.17484092712402344
generate_one_block  0.1748514175415039
generate_one_block  0.17934346199035645
generate_one_block  0.17688918113708496
generate_one_block  0.1786787509918213
generate_one_block  0.17119193077087402
generate_one_block  0.18581080436706543
generate_one_block  0.18207001686096191
generate_one_block  0.18480682373046875
generate_one_block  0.17913436889648438
generate_one_block  0.18903684616088867
generate_one_block  0.17327547073364258
generate_one_block  0.178117036819458
generate_one_block  0.1797797679901123
generate_one_block  0.1800694465637207
generate_one_block  0.17810726165771484
generate_one_block  0.18065381050109863
generate_one_block  0.17979216575622559
generate_one_block  0.1701951026916504
generate_one_block  0.17942523956298828
generate_one_block  0.16767334938049316
generate_one_block  0.17775464057922363
generate_one_block  0.1717219352722168
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034570932388305664
gen group dst list time:  0.11072039604187012
time for parepare:  0.020296335220336914
local_output_nid generation:  0.022965669631958008
local_in_edges_tensor generation:  0.046669721603393555
mini_batch_src_global generation:  0.03683185577392578
r_  generation:  0.4085526466369629
local_output_nid generation:  0.02777242660522461
local_in_edges_tensor generation:  0.0320887565612793
mini_batch_src_global generation:  0.04830431938171387
r_  generation:  0.39327144622802734
local_output_nid generation:  0.028215646743774414
local_in_edges_tensor generation:  0.03144979476928711
mini_batch_src_global generation:  0.04761195182800293
r_  generation:  0.4052393436431885
local_output_nid generation:  0.028106212615966797
local_in_edges_tensor generation:  0.029659509658813477
mini_batch_src_global generation:  0.04712700843811035
r_  generation:  0.3977944850921631
local_output_nid generation:  0.02998518943786621
local_in_edges_tensor generation:  0.03143930435180664
mini_batch_src_global generation:  0.04891633987426758
r_  generation:  0.41235923767089844
local_output_nid generation:  0.0299990177154541
local_in_edges_tensor generation:  0.03020954132080078
mini_batch_src_global generation:  0.04803967475891113
r_  generation:  0.4039621353149414
local_output_nid generation:  0.02642822265625
local_in_edges_tensor generation:  0.02864527702331543
mini_batch_src_global generation:  0.0466463565826416
r_  generation:  0.42798829078674316
local_output_nid generation:  0.029503583908081055
local_in_edges_tensor generation:  0.030562639236450195
mini_batch_src_global generation:  0.04820513725280762
r_  generation:  0.39832067489624023
local_output_nid generation:  0.027158737182617188
local_in_edges_tensor generation:  0.02689337730407715
mini_batch_src_global generation:  0.045923709869384766
r_  generation:  0.40291810035705566
local_output_nid generation:  0.027436494827270508
local_in_edges_tensor generation:  0.02653980255126953
mini_batch_src_global generation:  0.04808163642883301
r_  generation:  0.3977069854736328
local_output_nid generation:  0.027538537979125977
local_in_edges_tensor generation:  0.026969432830810547
mini_batch_src_global generation:  0.046602487564086914
r_  generation:  0.40505003929138184
local_output_nid generation:  0.027508258819580078
local_in_edges_tensor generation:  0.026941537857055664
mini_batch_src_global generation:  0.048248291015625
r_  generation:  0.4073026180267334
local_output_nid generation:  0.027399539947509766
local_in_edges_tensor generation:  0.026641845703125
mini_batch_src_global generation:  0.04688119888305664
r_  generation:  0.4070315361022949
local_output_nid generation:  0.027328014373779297
local_in_edges_tensor generation:  0.0272219181060791
mini_batch_src_global generation:  0.048005104064941406
r_  generation:  0.4020881652832031
local_output_nid generation:  0.027571916580200195
local_in_edges_tensor generation:  0.029429912567138672
mini_batch_src_global generation:  0.04628467559814453
r_  generation:  0.4013051986694336
local_output_nid generation:  0.027701377868652344
local_in_edges_tensor generation:  0.030017614364624023
mini_batch_src_global generation:  0.04826545715332031
r_  generation:  0.40581822395324707
local_output_nid generation:  0.027498722076416016
local_in_edges_tensor generation:  0.029872417449951172
mini_batch_src_global generation:  0.04676008224487305
r_  generation:  0.40532636642456055
local_output_nid generation:  0.027701139450073242
local_in_edges_tensor generation:  0.026581525802612305
mini_batch_src_global generation:  0.04778885841369629
r_  generation:  0.3991854190826416
local_output_nid generation:  0.02765655517578125
local_in_edges_tensor generation:  0.026528596878051758
mini_batch_src_global generation:  0.046999216079711914
r_  generation:  0.40508508682250977
local_output_nid generation:  0.028292417526245117
local_in_edges_tensor generation:  0.02658557891845703
mini_batch_src_global generation:  0.04980325698852539
r_  generation:  0.4013795852661133
local_output_nid generation:  0.02729177474975586
local_in_edges_tensor generation:  0.02680373191833496
mini_batch_src_global generation:  0.046356916427612305
r_  generation:  0.40226101875305176
local_output_nid generation:  0.02745819091796875
local_in_edges_tensor generation:  0.030237674713134766
mini_batch_src_global generation:  0.04800081253051758
r_  generation:  0.4057459831237793
local_output_nid generation:  0.027403831481933594
local_in_edges_tensor generation:  0.026923179626464844
mini_batch_src_global generation:  0.04798769950866699
r_  generation:  0.41025710105895996
local_output_nid generation:  0.027539968490600586
local_in_edges_tensor generation:  0.02691054344177246
mini_batch_src_global generation:  0.04830765724182129
r_  generation:  0.405475378036499
local_output_nid generation:  0.027610301971435547
local_in_edges_tensor generation:  0.027647018432617188
mini_batch_src_global generation:  0.04831385612487793
r_  generation:  0.4072444438934326
local_output_nid generation:  0.027617216110229492
local_in_edges_tensor generation:  0.02712559700012207
mini_batch_src_global generation:  0.04765009880065918
r_  generation:  0.4199960231781006
local_output_nid generation:  0.029268741607666016
local_in_edges_tensor generation:  0.02895498275756836
mini_batch_src_global generation:  0.05015087127685547
r_  generation:  0.40761375427246094
local_output_nid generation:  0.02783036231994629
local_in_edges_tensor generation:  0.027306079864501953
mini_batch_src_global generation:  0.047972679138183594
r_  generation:  0.3995778560638428
local_output_nid generation:  0.027553319931030273
local_in_edges_tensor generation:  0.02494192123413086
mini_batch_src_global generation:  0.04675555229187012
r_  generation:  0.4077949523925781
local_output_nid generation:  0.02738666534423828
local_in_edges_tensor generation:  0.028290748596191406
mini_batch_src_global generation:  0.04763197898864746
r_  generation:  0.3961145877838135
local_output_nid generation:  0.027729034423828125
local_in_edges_tensor generation:  0.024953126907348633
mini_batch_src_global generation:  0.04616069793701172
r_  generation:  0.4114842414855957
local_output_nid generation:  0.02740931510925293
local_in_edges_tensor generation:  0.026327848434448242
mini_batch_src_global generation:  0.04959535598754883
r_  generation:  0.3977243900299072
----------------------check_connections_block total spend ----------------------------- 19.180420398712158
generate_one_block  0.5477597713470459
generate_one_block  0.5277760028839111
generate_one_block  0.5298497676849365
generate_one_block  0.5273628234863281
generate_one_block  0.6401224136352539
generate_one_block  0.5357928276062012
generate_one_block  0.5388972759246826
generate_one_block  0.5320193767547607
generate_one_block  0.5227584838867188
generate_one_block  0.5312108993530273
generate_one_block  0.535982608795166
generate_one_block  0.5376503467559814
generate_one_block  0.5321557521820068
generate_one_block  0.5310430526733398
generate_one_block  0.5306966304779053
generate_one_block  0.5329487323760986
generate_one_block  0.5325074195861816
generate_one_block  0.5325326919555664
generate_one_block  0.5338866710662842
generate_one_block  0.5334899425506592
generate_one_block  0.5308754444122314
generate_one_block  0.5338900089263916
generate_one_block  0.533017635345459
generate_one_block  0.5397467613220215
generate_one_block  0.5503509044647217
generate_one_block  0.5418801307678223
generate_one_block  0.5411214828491211
generate_one_block  0.5284996032714844
generate_one_block  0.5404024124145508
generate_one_block  0.5342905521392822
generate_one_block  0.531914234161377
generate_one_block  0.5316698551177979
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1224513053894043  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

connection checking time:  26.20239806175232
block generation total time  22.93575620651245
average batch blocks generation time:  0.7167423814535141
block dataloader generation time/epoch 51.60306968007769
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10502767562866211  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.884861946105957  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10294389724731445  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.562038898468018  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10402488708496094  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.716919898986816  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10291528701782227  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.583141803741455  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10288238525390625  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.755497932434082  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10291624069213867  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.732326984405518  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1050105094909668  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.851545333862305  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1029958724975586  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.757815837860107  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10372734069824219  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.3089280128479  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1033625602722168  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.623450756072998  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1039276123046875  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.61795711517334  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10392332077026367  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.88225507736206  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10292387008666992  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.640161037445068  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1040806770324707  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.751375675201416  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10262823104858398  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.321564197540283  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1040792465209961  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.909925937652588  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10396289825439453  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.653219223022461  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10390377044677734  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.92598295211792  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10399723052978516  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.746405124664307  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10310554504394531  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.833197593688965  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10384845733642578  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.440460681915283  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10414266586303711  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.821356773376465  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10298442840576172  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.741360664367676  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10405158996582031  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.92354965209961  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10403680801391602  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.801115036010742  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1040806770324707  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.91975450515747  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10502195358276367  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.884259223937988  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10297489166259766  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.441125392913818  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10402393341064453  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.937849044799805  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10302066802978516  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.354493618011475  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1050119400024414  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.775986194610596  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10273218154907227  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.425365447998047  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03752052038908005 |0.011751338839530945 |0.26325327157974243 |9.182095527648926e-05 |0.42841605097055435 |0.00726771354675293 |
----------------------------------------------------------pseudo_mini_loss sum 1.4401497840881348
Total (block generation + training)time/epoch 75.36268472671509
Training time/epoch 23.768402338027954
Training time without block to device /epoch 23.392359495162964
Training time without total dataloading part /epoch 22.143624305725098
load block tensor time/epoch 1.2006566524505615
block to device time/epoch 0.37604284286499023
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  8581053
Number of first layer input nodes during this epoch:  4655853
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.11986541748046875  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02135467529296875
range selection method range initialization spend 0.012790679931640625
time for parepare:  0.018955707550048828
local_output_nid generation:  0.0009071826934814453
local_in_edges_tensor generation:  0.003583192825317383
mini_batch_src_global generation:  0.0015375614166259766
r_  generation:  0.009129762649536133
local_output_nid generation:  0.0009438991546630859
local_in_edges_tensor generation:  0.0006136894226074219
mini_batch_src_global generation:  0.0014014244079589844
r_  generation:  0.009034872055053711
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.0005645751953125
mini_batch_src_global generation:  0.000957489013671875
r_  generation:  0.007759571075439453
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0005228519439697266
mini_batch_src_global generation:  0.0009608268737792969
r_  generation:  0.008098363876342773
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005090236663818359
mini_batch_src_global generation:  0.0009307861328125
r_  generation:  0.007818460464477539
local_output_nid generation:  0.0008447170257568359
local_in_edges_tensor generation:  0.0005066394805908203
mini_batch_src_global generation:  0.0008440017700195312
r_  generation:  0.007920503616333008
local_output_nid generation:  0.0008502006530761719
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0009214878082275391
r_  generation:  0.008234262466430664
local_output_nid generation:  0.0008180141448974609
local_in_edges_tensor generation:  0.0005211830139160156
mini_batch_src_global generation:  0.000881195068359375
r_  generation:  0.008377313613891602
local_output_nid generation:  0.0008363723754882812
local_in_edges_tensor generation:  0.0004968643188476562
mini_batch_src_global generation:  0.0008559226989746094
r_  generation:  0.008026361465454102
local_output_nid generation:  0.0008118152618408203
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.0008585453033447266
r_  generation:  0.008507728576660156
local_output_nid generation:  0.0008089542388916016
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.0008575916290283203
r_  generation:  0.008157491683959961
local_output_nid generation:  0.0007903575897216797
local_in_edges_tensor generation:  0.0004906654357910156
mini_batch_src_global generation:  0.0008821487426757812
r_  generation:  0.008571863174438477
local_output_nid generation:  0.0007879734039306641
local_in_edges_tensor generation:  0.00047850608825683594
mini_batch_src_global generation:  0.0008618831634521484
r_  generation:  0.008284807205200195
local_output_nid generation:  0.0007917881011962891
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.0008692741394042969
r_  generation:  0.008179426193237305
local_output_nid generation:  0.0007805824279785156
local_in_edges_tensor generation:  0.0004744529724121094
mini_batch_src_global generation:  0.0008714199066162109
r_  generation:  0.008315086364746094
local_output_nid generation:  0.0008053779602050781
local_in_edges_tensor generation:  0.0004918575286865234
mini_batch_src_global generation:  0.0008823871612548828
r_  generation:  0.008282661437988281
local_output_nid generation:  0.0007963180541992188
local_in_edges_tensor generation:  0.0004923343658447266
mini_batch_src_global generation:  0.0008697509765625
r_  generation:  0.008182287216186523
local_output_nid generation:  0.000797271728515625
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0008759498596191406
r_  generation:  0.008150100708007812
local_output_nid generation:  0.000789642333984375
local_in_edges_tensor generation:  0.0004911422729492188
mini_batch_src_global generation:  0.0008747577667236328
r_  generation:  0.008092164993286133
local_output_nid generation:  0.000789642333984375
local_in_edges_tensor generation:  0.000476837158203125
mini_batch_src_global generation:  0.0009715557098388672
r_  generation:  0.00829172134399414
local_output_nid generation:  0.000797271728515625
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.0008504390716552734
r_  generation:  0.008188962936401367
local_output_nid generation:  0.0007781982421875
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0008769035339355469
r_  generation:  0.008444070816040039
local_output_nid generation:  0.000789642333984375
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.000881195068359375
r_  generation:  0.008406400680541992
local_output_nid generation:  0.0007886886596679688
local_in_edges_tensor generation:  0.0004944801330566406
mini_batch_src_global generation:  0.000885009765625
r_  generation:  0.008052825927734375
local_output_nid generation:  0.0007903575897216797
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.0008955001831054688
r_  generation:  0.007976055145263672
local_output_nid generation:  0.0007908344268798828
local_in_edges_tensor generation:  0.0004811286926269531
mini_batch_src_global generation:  0.0008759498596191406
r_  generation:  0.008266210556030273
local_output_nid generation:  0.0007901191711425781
local_in_edges_tensor generation:  0.0005075931549072266
mini_batch_src_global generation:  0.0009036064147949219
r_  generation:  0.008404254913330078
local_output_nid generation:  0.0008018016815185547
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0008804798126220703
r_  generation:  0.008308887481689453
local_output_nid generation:  0.0007851123809814453
local_in_edges_tensor generation:  0.00048804283142089844
mini_batch_src_global generation:  0.0008530616760253906
r_  generation:  0.007986068725585938
local_output_nid generation:  0.0007925033569335938
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0008890628814697266
r_  generation:  0.008140325546264648
local_output_nid generation:  0.0007760524749755859
local_in_edges_tensor generation:  0.0004901885986328125
mini_batch_src_global generation:  0.0008611679077148438
r_  generation:  0.008038997650146484
local_output_nid generation:  0.0007827281951904297
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.008180618286132812
----------------------check_connections_block total spend ----------------------------- 0.424959659576416
generate_one_block  0.0206148624420166
generate_one_block  0.016800880432128906
generate_one_block  0.014565229415893555
generate_one_block  0.014719009399414062
generate_one_block  0.014215946197509766
generate_one_block  0.014167070388793945
generate_one_block  0.014637231826782227
generate_one_block  0.014632701873779297
generate_one_block  0.014346837997436523
generate_one_block  0.014763832092285156
generate_one_block  0.014321088790893555
generate_one_block  0.015038013458251953
generate_one_block  0.014328241348266602
generate_one_block  0.014240503311157227
generate_one_block  0.014345169067382812
generate_one_block  0.014380693435668945
generate_one_block  0.014329671859741211
generate_one_block  0.014256477355957031
generate_one_block  0.014222145080566406
generate_one_block  0.014424324035644531
generate_one_block  0.014355897903442383
generate_one_block  0.01464700698852539
generate_one_block  0.014598846435546875
generate_one_block  0.01395869255065918
generate_one_block  0.014053821563720703
generate_one_block  0.01445150375366211
generate_one_block  0.014607429504394531
generate_one_block  0.01435708999633789
generate_one_block  0.014007091522216797
generate_one_block  0.014217138290405273
generate_one_block  0.014108896255493164
generate_one_block  0.014304161071777344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03414440155029297
gen group dst list time:  0.021574020385742188
time for parepare:  0.021906137466430664
local_output_nid generation:  0.004759073257446289
local_in_edges_tensor generation:  0.013862848281860352
mini_batch_src_global generation:  0.013327598571777344
r_  generation:  0.12322068214416504
local_output_nid generation:  0.00652623176574707
local_in_edges_tensor generation:  0.008630752563476562
mini_batch_src_global generation:  0.016275882720947266
r_  generation:  0.1287522315979004
local_output_nid generation:  0.006707668304443359
local_in_edges_tensor generation:  0.028593063354492188
mini_batch_src_global generation:  0.014477729797363281
r_  generation:  0.1260833740234375
local_output_nid generation:  0.007027864456176758
local_in_edges_tensor generation:  0.007798433303833008
mini_batch_src_global generation:  0.01482844352722168
r_  generation:  0.16715121269226074
local_output_nid generation:  0.009342193603515625
local_in_edges_tensor generation:  0.008532524108886719
mini_batch_src_global generation:  0.020352602005004883
r_  generation:  0.13428425788879395
local_output_nid generation:  0.0071103572845458984
local_in_edges_tensor generation:  0.007901191711425781
mini_batch_src_global generation:  0.017853260040283203
r_  generation:  0.13391733169555664
local_output_nid generation:  0.007622241973876953
local_in_edges_tensor generation:  0.007361888885498047
mini_batch_src_global generation:  0.016399383544921875
r_  generation:  0.1376509666442871
local_output_nid generation:  0.008827447891235352
local_in_edges_tensor generation:  0.008875370025634766
mini_batch_src_global generation:  0.016441822052001953
r_  generation:  0.137312650680542
local_output_nid generation:  0.007189035415649414
local_in_edges_tensor generation:  0.007130146026611328
mini_batch_src_global generation:  0.0177156925201416
r_  generation:  0.13710951805114746
local_output_nid generation:  0.007469654083251953
local_in_edges_tensor generation:  0.007330656051635742
mini_batch_src_global generation:  0.016658544540405273
r_  generation:  0.186415433883667
local_output_nid generation:  0.00791311264038086
local_in_edges_tensor generation:  0.010164260864257812
mini_batch_src_global generation:  0.019064664840698242
r_  generation:  0.13981914520263672
local_output_nid generation:  0.010465383529663086
local_in_edges_tensor generation:  0.00901031494140625
mini_batch_src_global generation:  0.019410371780395508
r_  generation:  0.14237546920776367
local_output_nid generation:  0.009193897247314453
local_in_edges_tensor generation:  0.010725975036621094
mini_batch_src_global generation:  0.017225980758666992
r_  generation:  0.1398930549621582
local_output_nid generation:  0.0077190399169921875
local_in_edges_tensor generation:  0.00974416732788086
mini_batch_src_global generation:  0.016913175582885742
r_  generation:  0.13832879066467285
local_output_nid generation:  0.007873773574829102
local_in_edges_tensor generation:  0.007838726043701172
mini_batch_src_global generation:  0.017731904983520508
r_  generation:  0.13709640502929688
local_output_nid generation:  0.007881879806518555
local_in_edges_tensor generation:  0.008398056030273438
mini_batch_src_global generation:  0.017000675201416016
r_  generation:  0.13794827461242676
local_output_nid generation:  0.007842302322387695
local_in_edges_tensor generation:  0.00824427604675293
mini_batch_src_global generation:  0.016300678253173828
r_  generation:  0.14649391174316406
local_output_nid generation:  0.010030508041381836
local_in_edges_tensor generation:  0.007915019989013672
mini_batch_src_global generation:  0.0164182186126709
r_  generation:  0.13708162307739258
local_output_nid generation:  0.008013486862182617
local_in_edges_tensor generation:  0.0076141357421875
mini_batch_src_global generation:  0.016270875930786133
r_  generation:  0.13597798347473145
local_output_nid generation:  0.008222579956054688
local_in_edges_tensor generation:  0.007871866226196289
mini_batch_src_global generation:  0.017015933990478516
r_  generation:  0.1391007900238037
local_output_nid generation:  0.007922887802124023
local_in_edges_tensor generation:  0.008427858352661133
mini_batch_src_global generation:  0.017335176467895508
r_  generation:  0.19264435768127441
local_output_nid generation:  0.008045673370361328
local_in_edges_tensor generation:  0.007779121398925781
mini_batch_src_global generation:  0.017978191375732422
r_  generation:  0.14007949829101562
local_output_nid generation:  0.008278846740722656
local_in_edges_tensor generation:  0.008037090301513672
mini_batch_src_global generation:  0.016503334045410156
r_  generation:  0.13908910751342773
local_output_nid generation:  0.00800180435180664
local_in_edges_tensor generation:  0.008989334106445312
mini_batch_src_global generation:  0.01583099365234375
r_  generation:  0.1365036964416504
local_output_nid generation:  0.007956504821777344
local_in_edges_tensor generation:  0.007454633712768555
mini_batch_src_global generation:  0.016279220581054688
r_  generation:  0.1355431079864502
local_output_nid generation:  0.008243322372436523
local_in_edges_tensor generation:  0.0075321197509765625
mini_batch_src_global generation:  0.016344308853149414
r_  generation:  0.13865995407104492
local_output_nid generation:  0.008380413055419922
local_in_edges_tensor generation:  0.007547855377197266
mini_batch_src_global generation:  0.01725149154663086
r_  generation:  0.1555461883544922
local_output_nid generation:  0.008202075958251953
local_in_edges_tensor generation:  0.008115053176879883
mini_batch_src_global generation:  0.016429662704467773
r_  generation:  0.14724135398864746
local_output_nid generation:  0.008107662200927734
local_in_edges_tensor generation:  0.007292270660400391
mini_batch_src_global generation:  0.016143798828125
r_  generation:  0.14140725135803223
local_output_nid generation:  0.008134126663208008
local_in_edges_tensor generation:  0.011309623718261719
mini_batch_src_global generation:  0.01635003089904785
r_  generation:  0.14177823066711426
local_output_nid generation:  0.008973360061645508
local_in_edges_tensor generation:  0.00795602798461914
mini_batch_src_global generation:  0.016519784927368164
r_  generation:  0.14079833030700684
local_output_nid generation:  0.008131742477416992
local_in_edges_tensor generation:  0.011003494262695312
mini_batch_src_global generation:  0.016474246978759766
r_  generation:  0.14275240898132324
----------------------check_connections_block total spend ----------------------------- 6.718311548233032
generate_one_block  0.19530653953552246
generate_one_block  0.1800367832183838
generate_one_block  0.1742558479309082
generate_one_block  0.18337774276733398
generate_one_block  0.20775890350341797
generate_one_block  0.17504358291625977
generate_one_block  0.17862296104431152
generate_one_block  0.18012166023254395
generate_one_block  0.17499923706054688
generate_one_block  0.18094372749328613
generate_one_block  0.17202472686767578
generate_one_block  0.18154120445251465
generate_one_block  0.1727292537689209
generate_one_block  0.1753556728363037
generate_one_block  0.17218756675720215
generate_one_block  0.17610549926757812
generate_one_block  0.17963171005249023
generate_one_block  0.19132471084594727
generate_one_block  0.19094419479370117
generate_one_block  0.1841890811920166
generate_one_block  0.18248295783996582
generate_one_block  0.1843128204345703
generate_one_block  0.1827840805053711
generate_one_block  0.17375779151916504
generate_one_block  0.1797466278076172
generate_one_block  0.18281960487365723
generate_one_block  0.18202733993530273
generate_one_block  0.18191051483154297
generate_one_block  0.18033075332641602
generate_one_block  0.17488622665405273
generate_one_block  0.1771538257598877
generate_one_block  0.17577481269836426
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0366055965423584
gen group dst list time:  0.11075401306152344
time for parepare:  0.01978921890258789
local_output_nid generation:  0.022774934768676758
local_in_edges_tensor generation:  0.04719424247741699
mini_batch_src_global generation:  0.03696131706237793
r_  generation:  0.390247106552124
local_output_nid generation:  0.027654409408569336
local_in_edges_tensor generation:  0.031022310256958008
mini_batch_src_global generation:  0.04839897155761719
r_  generation:  0.3924565315246582
local_output_nid generation:  0.027678489685058594
local_in_edges_tensor generation:  0.024479150772094727
mini_batch_src_global generation:  0.047241926193237305
r_  generation:  0.4097402095794678
local_output_nid generation:  0.027998685836791992
local_in_edges_tensor generation:  0.026478052139282227
mini_batch_src_global generation:  0.04898715019226074
r_  generation:  0.4060800075531006
local_output_nid generation:  0.029169797897338867
local_in_edges_tensor generation:  0.027609825134277344
mini_batch_src_global generation:  0.046884775161743164
r_  generation:  0.4100029468536377
local_output_nid generation:  0.02752828598022461
local_in_edges_tensor generation:  0.02907729148864746
mini_batch_src_global generation:  0.04785561561584473
r_  generation:  0.4012727737426758
local_output_nid generation:  0.02822399139404297
local_in_edges_tensor generation:  0.028023958206176758
mini_batch_src_global generation:  0.04777693748474121
r_  generation:  0.41522955894470215
local_output_nid generation:  0.026556730270385742
local_in_edges_tensor generation:  0.02913975715637207
mini_batch_src_global generation:  0.04965496063232422
r_  generation:  0.40435147285461426
local_output_nid generation:  0.028438568115234375
local_in_edges_tensor generation:  0.027529001235961914
mini_batch_src_global generation:  0.04688382148742676
r_  generation:  0.42410874366760254
local_output_nid generation:  0.03132224082946777
local_in_edges_tensor generation:  0.028814077377319336
mini_batch_src_global generation:  0.05168962478637695
r_  generation:  0.4048330783843994
local_output_nid generation:  0.027289628982543945
local_in_edges_tensor generation:  0.02699589729309082
mini_batch_src_global generation:  0.04701590538024902
r_  generation:  0.4017655849456787
local_output_nid generation:  0.027739524841308594
local_in_edges_tensor generation:  0.02680659294128418
mini_batch_src_global generation:  0.0503084659576416
r_  generation:  0.4021437168121338
local_output_nid generation:  0.02735161781311035
local_in_edges_tensor generation:  0.024835824966430664
mini_batch_src_global generation:  0.04674363136291504
r_  generation:  0.40280818939208984
local_output_nid generation:  0.027367353439331055
local_in_edges_tensor generation:  0.02635788917541504
mini_batch_src_global generation:  0.04825592041015625
r_  generation:  0.39614152908325195
local_output_nid generation:  0.027283430099487305
local_in_edges_tensor generation:  0.026495933532714844
mini_batch_src_global generation:  0.04689621925354004
r_  generation:  0.41264963150024414
local_output_nid generation:  0.027478694915771484
local_in_edges_tensor generation:  0.026645898818969727
mini_batch_src_global generation:  0.04814028739929199
r_  generation:  0.4033989906311035
local_output_nid generation:  0.02717900276184082
local_in_edges_tensor generation:  0.02817702293395996
mini_batch_src_global generation:  0.048287391662597656
r_  generation:  0.40833091735839844
local_output_nid generation:  0.02840566635131836
local_in_edges_tensor generation:  0.028760671615600586
mini_batch_src_global generation:  0.04844474792480469
r_  generation:  0.4031498432159424
local_output_nid generation:  0.027280569076538086
local_in_edges_tensor generation:  0.03062891960144043
mini_batch_src_global generation:  0.047110557556152344
r_  generation:  0.4014105796813965
local_output_nid generation:  0.027619600296020508
local_in_edges_tensor generation:  0.027108430862426758
mini_batch_src_global generation:  0.05066633224487305
r_  generation:  0.40101122856140137
local_output_nid generation:  0.027373313903808594
local_in_edges_tensor generation:  0.027883291244506836
mini_batch_src_global generation:  0.04701519012451172
r_  generation:  0.4075746536254883
local_output_nid generation:  0.027258872985839844
local_in_edges_tensor generation:  0.028941631317138672
mini_batch_src_global generation:  0.04840707778930664
r_  generation:  0.40233516693115234
local_output_nid generation:  0.027677059173583984
local_in_edges_tensor generation:  0.025719404220581055
mini_batch_src_global generation:  0.04703807830810547
r_  generation:  0.40749168395996094
local_output_nid generation:  0.027486801147460938
local_in_edges_tensor generation:  0.028682947158813477
mini_batch_src_global generation:  0.048462629318237305
r_  generation:  0.397796630859375
local_output_nid generation:  0.027515649795532227
local_in_edges_tensor generation:  0.02454400062561035
mini_batch_src_global generation:  0.046747684478759766
r_  generation:  0.4063377380371094
local_output_nid generation:  0.027493715286254883
local_in_edges_tensor generation:  0.02863478660583496
mini_batch_src_global generation:  0.04906177520751953
r_  generation:  0.40282511711120605
local_output_nid generation:  0.02763533592224121
local_in_edges_tensor generation:  0.024447917938232422
mini_batch_src_global generation:  0.0475459098815918
r_  generation:  0.40773487091064453
local_output_nid generation:  0.029214143753051758
local_in_edges_tensor generation:  0.028653860092163086
mini_batch_src_global generation:  0.04897594451904297
r_  generation:  0.40238523483276367
local_output_nid generation:  0.02744579315185547
local_in_edges_tensor generation:  0.025526762008666992
mini_batch_src_global generation:  0.04668283462524414
r_  generation:  0.4052097797393799
local_output_nid generation:  0.02753925323486328
local_in_edges_tensor generation:  0.03098273277282715
mini_batch_src_global generation:  0.05031943321228027
r_  generation:  0.39952921867370605
local_output_nid generation:  0.027511119842529297
local_in_edges_tensor generation:  0.026241540908813477
mini_batch_src_global generation:  0.047263145446777344
r_  generation:  0.40903544425964355
local_output_nid generation:  0.027938365936279297
local_in_edges_tensor generation:  0.025426626205444336
mini_batch_src_global generation:  0.049321889877319336
r_  generation:  0.42065000534057617
----------------------check_connections_block total spend ----------------------------- 19.165152311325073
generate_one_block  0.5432045459747314
generate_one_block  0.5358304977416992
generate_one_block  0.5235655307769775
generate_one_block  0.538837194442749
generate_one_block  0.6301441192626953
generate_one_block  0.5302724838256836
generate_one_block  0.5436372756958008
generate_one_block  0.5413355827331543
generate_one_block  0.5413417816162109
generate_one_block  0.5422542095184326
generate_one_block  0.5227739810943604
generate_one_block  0.5378189086914062
generate_one_block  0.5318331718444824
generate_one_block  0.5314395427703857
generate_one_block  0.531766414642334
generate_one_block  0.5352523326873779
generate_one_block  0.5308282375335693
generate_one_block  0.5483717918395996
generate_one_block  0.5279524326324463
generate_one_block  0.5322892665863037
generate_one_block  0.535895586013794
generate_one_block  0.5296940803527832
generate_one_block  0.5444769859313965
generate_one_block  0.5262985229492188
generate_one_block  0.5489587783813477
generate_one_block  0.5362627506256104
generate_one_block  0.5391075611114502
generate_one_block  0.5392515659332275
generate_one_block  0.5297591686248779
generate_one_block  0.5318193435668945
generate_one_block  0.5381317138671875
generate_one_block  0.5351781845092773
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.11986541748046875  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

connection checking time:  25.883463859558105
block generation total time  23.020071506500244
average batch blocks generation time:  0.7193772345781326
block dataloader generation time/epoch 51.565909296274185
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10403823852539062  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.91693639755249  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10411357879638672  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.773312091827393  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10268735885620117  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.425762176513672  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10427570343017578  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.901689529418945  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10393619537353516  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.635478973388672  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10309743881225586  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.517078399658203  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503053665161133  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.921045780181885  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1042013168334961  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.911264896392822  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1040201187133789  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.751888751983643  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10430383682250977  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.035911560058594  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10388374328613281  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.519932746887207  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10427188873291016  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.998896598815918  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10390472412109375  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.5274076461792  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1027379035949707  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.611700534820557  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10389328002929688  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.561842441558838  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10299539566040039  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.613202571868896  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10274124145507812  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.666804790496826  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10406303405761719  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.753283977508545  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10290384292602539  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.586018562316895  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10415077209472656  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.800909519195557  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10398006439208984  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.809174060821533  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10282087326049805  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.715430736541748  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10502386093139648  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.913806438446045  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10265970230102539  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.371230125427246  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10388946533203125  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.517490863800049  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10411500930786133  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.77957534790039  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1050252914428711  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.804091930389404  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10402727127075195  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.806674003601074  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10390090942382812  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.558550357818604  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10304069519042969  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.60261869430542  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10279464721679688  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.687612533569336  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10304594039916992  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.689513683319092  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0368514209985733 |0.011765502393245697 |0.2622673809528351 |9.1552734375e-05 |0.4291749745607376 |0.0058591365814208984 |
----------------------------------------------------------pseudo_mini_loss sum 1.4123438596725464
Total (block generation + training)time/epoch 75.32324331998825
Training time/epoch 23.741092443466187
Training time without block to device /epoch 23.364596366882324
Training time without total dataloading part /epoch 22.134944200515747
load block tensor time/epoch 1.1792454719543457
block to device time/epoch 0.3764960765838623
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  8582800
Number of first layer input nodes during this epoch:  4656313
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.11970329284667969  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020518064498901367
range selection method range initialization spend 0.012998104095458984
time for parepare:  0.01815962791442871
local_output_nid generation:  0.0009071826934814453
local_in_edges_tensor generation:  0.003411531448364258
mini_batch_src_global generation:  0.0014939308166503906
r_  generation:  0.008628129959106445
local_output_nid generation:  0.0009479522705078125
local_in_edges_tensor generation:  0.0006103515625
mini_batch_src_global generation:  0.0013582706451416016
r_  generation:  0.008832693099975586
local_output_nid generation:  0.0009014606475830078
local_in_edges_tensor generation:  0.0005481243133544922
mini_batch_src_global generation:  0.001026153564453125
r_  generation:  0.008106470108032227
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005114078521728516
mini_batch_src_global generation:  0.0009167194366455078
r_  generation:  0.007812976837158203
local_output_nid generation:  0.0008323192596435547
local_in_edges_tensor generation:  0.0005121231079101562
mini_batch_src_global generation:  0.0008828639984130859
r_  generation:  0.007952451705932617
local_output_nid generation:  0.0008249282836914062
local_in_edges_tensor generation:  0.0005176067352294922
mini_batch_src_global generation:  0.0008766651153564453
r_  generation:  0.008225679397583008
local_output_nid generation:  0.0008242130279541016
local_in_edges_tensor generation:  0.0005140304565429688
mini_batch_src_global generation:  0.0008857250213623047
r_  generation:  0.008269786834716797
local_output_nid generation:  0.000865936279296875
local_in_edges_tensor generation:  0.0004932880401611328
mini_batch_src_global generation:  0.0008561611175537109
r_  generation:  0.008256912231445312
local_output_nid generation:  0.0008041858673095703
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.0008847713470458984
r_  generation:  0.007871150970458984
local_output_nid generation:  0.0008015632629394531
local_in_edges_tensor generation:  0.000507354736328125
mini_batch_src_global generation:  0.0008990764617919922
r_  generation:  0.008325338363647461
local_output_nid generation:  0.0007948875427246094
local_in_edges_tensor generation:  0.0005316734313964844
mini_batch_src_global generation:  0.0008723735809326172
r_  generation:  0.008208990097045898
local_output_nid generation:  0.0007917881011962891
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.0008997917175292969
r_  generation:  0.008150339126586914
local_output_nid generation:  0.0007951259613037109
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.0008513927459716797
r_  generation:  0.008250951766967773
local_output_nid generation:  0.0007946491241455078
local_in_edges_tensor generation:  0.0004901885986328125
mini_batch_src_global generation:  0.000888824462890625
r_  generation:  0.008118152618408203
local_output_nid generation:  0.0007960796356201172
local_in_edges_tensor generation:  0.0004811286926269531
mini_batch_src_global generation:  0.0008757114410400391
r_  generation:  0.008273601531982422
local_output_nid generation:  0.0007977485656738281
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.0009062290191650391
r_  generation:  0.008392333984375
local_output_nid generation:  0.0008037090301513672
local_in_edges_tensor generation:  0.0004913806915283203
mini_batch_src_global generation:  0.0008630752563476562
r_  generation:  0.00808262825012207
local_output_nid generation:  0.0008044242858886719
local_in_edges_tensor generation:  0.00048279762268066406
mini_batch_src_global generation:  0.0008451938629150391
r_  generation:  0.008134603500366211
local_output_nid generation:  0.0007920265197753906
local_in_edges_tensor generation:  0.00048351287841796875
mini_batch_src_global generation:  0.0008509159088134766
r_  generation:  0.008217811584472656
local_output_nid generation:  0.000797271728515625
local_in_edges_tensor generation:  0.0004918575286865234
mini_batch_src_global generation:  0.0009341239929199219
r_  generation:  0.008363008499145508
local_output_nid generation:  0.0007944107055664062
local_in_edges_tensor generation:  0.0005090236663818359
mini_batch_src_global generation:  0.0009577274322509766
r_  generation:  0.009551763534545898
local_output_nid generation:  0.000797271728515625
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.0009336471557617188
r_  generation:  0.008288145065307617
local_output_nid generation:  0.0008046627044677734
local_in_edges_tensor generation:  0.0004892349243164062
mini_batch_src_global generation:  0.0008883476257324219
r_  generation:  0.008276939392089844
local_output_nid generation:  0.0008177757263183594
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.0008802413940429688
r_  generation:  0.00817728042602539
local_output_nid generation:  0.0007817745208740234
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0008666515350341797
r_  generation:  0.008249282836914062
local_output_nid generation:  0.0008001327514648438
local_in_edges_tensor generation:  0.0004982948303222656
mini_batch_src_global generation:  0.000881195068359375
r_  generation:  0.00791168212890625
local_output_nid generation:  0.0007910728454589844
local_in_edges_tensor generation:  0.0004811286926269531
mini_batch_src_global generation:  0.0008714199066162109
r_  generation:  0.00831913948059082
local_output_nid generation:  0.0007932186126708984
local_in_edges_tensor generation:  0.00048232078552246094
mini_batch_src_global generation:  0.0008540153503417969
r_  generation:  0.008223772048950195
local_output_nid generation:  0.0007817745208740234
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0008671283721923828
r_  generation:  0.00831294059753418
local_output_nid generation:  0.000774383544921875
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.0008649826049804688
r_  generation:  0.008110523223876953
local_output_nid generation:  0.0007884502410888672
local_in_edges_tensor generation:  0.0004906654357910156
mini_batch_src_global generation:  0.0010387897491455078
r_  generation:  0.00953531265258789
local_output_nid generation:  0.0007939338684082031
local_in_edges_tensor generation:  0.0005059242248535156
mini_batch_src_global generation:  0.0009360313415527344
r_  generation:  0.008603572845458984
----------------------check_connections_block total spend ----------------------------- 0.4274132251739502
generate_one_block  0.019753456115722656
generate_one_block  0.01691722869873047
generate_one_block  0.015285968780517578
generate_one_block  0.014284133911132812
generate_one_block  0.014482498168945312
generate_one_block  0.014704227447509766
generate_one_block  0.014701604843139648
generate_one_block  0.014647960662841797
generate_one_block  0.014097213745117188
generate_one_block  0.014562129974365234
generate_one_block  0.014296293258666992
generate_one_block  0.014578104019165039
generate_one_block  0.014507055282592773
generate_one_block  0.01430821418762207
generate_one_block  0.014537572860717773
generate_one_block  0.014590740203857422
generate_one_block  0.014120101928710938
generate_one_block  0.014183282852172852
generate_one_block  0.014549970626831055
generate_one_block  0.014666318893432617
generate_one_block  0.015051126480102539
generate_one_block  0.014483213424682617
generate_one_block  0.014377593994140625
generate_one_block  0.014280319213867188
generate_one_block  0.014522552490234375
generate_one_block  0.01388859748840332
generate_one_block  0.014620304107666016
generate_one_block  0.014322042465209961
generate_one_block  0.014482259750366211
generate_one_block  0.014219522476196289
generate_one_block  0.01503753662109375
generate_one_block  0.014845848083496094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034383296966552734
gen group dst list time:  0.021587610244750977
time for parepare:  0.023679018020629883
local_output_nid generation:  0.00457763671875
local_in_edges_tensor generation:  0.013290882110595703
mini_batch_src_global generation:  0.012572765350341797
r_  generation:  0.11806488037109375
local_output_nid generation:  0.006561756134033203
local_in_edges_tensor generation:  0.008738040924072266
mini_batch_src_global generation:  0.01620650291442871
r_  generation:  0.16499114036560059
local_output_nid generation:  0.00763249397277832
local_in_edges_tensor generation:  0.029226064682006836
mini_batch_src_global generation:  0.016411781311035156
r_  generation:  0.1316828727722168
local_output_nid generation:  0.006734371185302734
local_in_edges_tensor generation:  0.006552934646606445
mini_batch_src_global generation:  0.014868974685668945
r_  generation:  0.12706255912780762
local_output_nid generation:  0.007193088531494141
local_in_edges_tensor generation:  0.008849859237670898
mini_batch_src_global generation:  0.015839338302612305
r_  generation:  0.131058931350708
local_output_nid generation:  0.007427692413330078
local_in_edges_tensor generation:  0.006793022155761719
mini_batch_src_global generation:  0.016817569732666016
r_  generation:  0.1359100341796875
local_output_nid generation:  0.007597446441650391
local_in_edges_tensor generation:  0.0075528621673583984
mini_batch_src_global generation:  0.016155719757080078
r_  generation:  0.17246174812316895
local_output_nid generation:  0.008238077163696289
local_in_edges_tensor generation:  0.008547544479370117
mini_batch_src_global generation:  0.017852067947387695
r_  generation:  0.13699865341186523
local_output_nid generation:  0.007033586502075195
local_in_edges_tensor generation:  0.006918907165527344
mini_batch_src_global generation:  0.01597881317138672
r_  generation:  0.13611531257629395
local_output_nid generation:  0.007199764251708984
local_in_edges_tensor generation:  0.00703740119934082
mini_batch_src_global generation:  0.01607823371887207
r_  generation:  0.13333415985107422
local_output_nid generation:  0.007486104965209961
local_in_edges_tensor generation:  0.0070116519927978516
mini_batch_src_global generation:  0.0160369873046875
r_  generation:  0.13611054420471191
local_output_nid generation:  0.007598876953125
local_in_edges_tensor generation:  0.007505178451538086
mini_batch_src_global generation:  0.01651477813720703
r_  generation:  0.13594841957092285
local_output_nid generation:  0.007660865783691406
local_in_edges_tensor generation:  0.007624626159667969
mini_batch_src_global generation:  0.016315937042236328
r_  generation:  0.1373732089996338
local_output_nid generation:  0.007729291915893555
local_in_edges_tensor generation:  0.007051229476928711
mini_batch_src_global generation:  0.016282320022583008
r_  generation:  0.13301706314086914
local_output_nid generation:  0.007760763168334961
local_in_edges_tensor generation:  0.007151126861572266
mini_batch_src_global generation:  0.016637802124023438
r_  generation:  0.13894414901733398
local_output_nid generation:  0.007847070693969727
local_in_edges_tensor generation:  0.008162260055541992
mini_batch_src_global generation:  0.0174252986907959
r_  generation:  0.1374661922454834
local_output_nid generation:  0.007695674896240234
local_in_edges_tensor generation:  0.007511615753173828
mini_batch_src_global generation:  0.01586174964904785
r_  generation:  0.13199830055236816
local_output_nid generation:  0.007688283920288086
local_in_edges_tensor generation:  0.007173061370849609
mini_batch_src_global generation:  0.016353845596313477
r_  generation:  0.1353452205657959
local_output_nid generation:  0.007755279541015625
local_in_edges_tensor generation:  0.00721287727355957
mini_batch_src_global generation:  0.016672849655151367
r_  generation:  0.13815855979919434
local_output_nid generation:  0.007891416549682617
local_in_edges_tensor generation:  0.007322072982788086
mini_batch_src_global generation:  0.01688408851623535
r_  generation:  0.1414337158203125
local_output_nid generation:  0.008123636245727539
local_in_edges_tensor generation:  0.008076906204223633
mini_batch_src_global generation:  0.019267797470092773
r_  generation:  0.15027213096618652
local_output_nid generation:  0.007912635803222656
local_in_edges_tensor generation:  0.007351398468017578
mini_batch_src_global generation:  0.01719808578491211
r_  generation:  0.14471673965454102
local_output_nid generation:  0.008022308349609375
local_in_edges_tensor generation:  0.007776975631713867
mini_batch_src_global generation:  0.01745891571044922
r_  generation:  0.1976487636566162
local_output_nid generation:  0.007894277572631836
local_in_edges_tensor generation:  0.008137941360473633
mini_batch_src_global generation:  0.01702094078063965
r_  generation:  0.13709115982055664
local_output_nid generation:  0.007963418960571289
local_in_edges_tensor generation:  0.00847005844116211
mini_batch_src_global generation:  0.016234874725341797
r_  generation:  0.1414029598236084
local_output_nid generation:  0.007718086242675781
local_in_edges_tensor generation:  0.007631540298461914
mini_batch_src_global generation:  0.016329288482666016
r_  generation:  0.1364297866821289
local_output_nid generation:  0.008009195327758789
local_in_edges_tensor generation:  0.010247945785522461
mini_batch_src_global generation:  0.01694774627685547
r_  generation:  0.14542150497436523
local_output_nid generation:  0.008752822875976562
local_in_edges_tensor generation:  0.009435176849365234
mini_batch_src_global generation:  0.01666402816772461
r_  generation:  0.13935589790344238
local_output_nid generation:  0.008026599884033203
local_in_edges_tensor generation:  0.011152029037475586
mini_batch_src_global generation:  0.017024993896484375
r_  generation:  0.1495223045349121
local_output_nid generation:  0.010374784469604492
local_in_edges_tensor generation:  0.007807493209838867
mini_batch_src_global generation:  0.016591548919677734
r_  generation:  0.1417522430419922
local_output_nid generation:  0.008491754531860352
local_in_edges_tensor generation:  0.008609294891357422
mini_batch_src_global generation:  0.01759052276611328
r_  generation:  0.14551115036010742
local_output_nid generation:  0.008343696594238281
local_in_edges_tensor generation:  0.00858306884765625
mini_batch_src_global generation:  0.01731705665588379
r_  generation:  0.14136385917663574
----------------------check_connections_block total spend ----------------------------- 6.6538166999816895
generate_one_block  0.17571592330932617
generate_one_block  0.1758739948272705
generate_one_block  0.18008828163146973
generate_one_block  0.16952180862426758
generate_one_block  0.2046515941619873
generate_one_block  0.17884182929992676
generate_one_block  0.17476582527160645
generate_one_block  0.17574858665466309
generate_one_block  0.17150473594665527
generate_one_block  0.17354607582092285
generate_one_block  0.17461252212524414
generate_one_block  0.1757826805114746
generate_one_block  0.18320035934448242
generate_one_block  0.17534708976745605
generate_one_block  0.17744159698486328
generate_one_block  0.17877626419067383
generate_one_block  0.16944289207458496
generate_one_block  0.17324519157409668
generate_one_block  0.1770615577697754
generate_one_block  0.18264150619506836
generate_one_block  0.18482303619384766
generate_one_block  0.1783738136291504
generate_one_block  0.1729588508605957
generate_one_block  0.17920780181884766
generate_one_block  0.18828701972961426
generate_one_block  0.17174291610717773
generate_one_block  0.18368172645568848
generate_one_block  0.18044281005859375
generate_one_block  0.18115687370300293
generate_one_block  0.1798722743988037
generate_one_block  0.19630193710327148
generate_one_block  0.18605256080627441
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0367588996887207
gen group dst list time:  0.10860419273376465
time for parepare:  0.020095109939575195
local_output_nid generation:  0.022685766220092773
local_in_edges_tensor generation:  0.04560351371765137
mini_batch_src_global generation:  0.037866830825805664
r_  generation:  0.40476059913635254
local_output_nid generation:  0.033415794372558594
local_in_edges_tensor generation:  0.03296685218811035
mini_batch_src_global generation:  0.04683256149291992
r_  generation:  0.40016603469848633
local_output_nid generation:  0.028965234756469727
local_in_edges_tensor generation:  0.029945850372314453
mini_batch_src_global generation:  0.045824527740478516
r_  generation:  0.4039270877838135
local_output_nid generation:  0.02792978286743164
local_in_edges_tensor generation:  0.024657011032104492
mini_batch_src_global generation:  0.0476377010345459
r_  generation:  0.3935997486114502
local_output_nid generation:  0.02871847152709961
local_in_edges_tensor generation:  0.02397322654724121
mini_batch_src_global generation:  0.045885562896728516
r_  generation:  0.41469478607177734
local_output_nid generation:  0.027904272079467773
local_in_edges_tensor generation:  0.02517223358154297
mini_batch_src_global generation:  0.05116581916809082
r_  generation:  0.4039795398712158
local_output_nid generation:  0.026684999465942383
local_in_edges_tensor generation:  0.02689528465270996
mini_batch_src_global generation:  0.04809713363647461
r_  generation:  0.4054114818572998
local_output_nid generation:  0.028055906295776367
local_in_edges_tensor generation:  0.03177380561828613
mini_batch_src_global generation:  0.048224687576293945
r_  generation:  0.40317463874816895
local_output_nid generation:  0.027987957000732422
local_in_edges_tensor generation:  0.026207923889160156
mini_batch_src_global generation:  0.04672551155090332
r_  generation:  0.4053535461425781
local_output_nid generation:  0.027642488479614258
local_in_edges_tensor generation:  0.02671337127685547
mini_batch_src_global generation:  0.04986095428466797
r_  generation:  0.4025585651397705
local_output_nid generation:  0.026894807815551758
local_in_edges_tensor generation:  0.030112504959106445
mini_batch_src_global generation:  0.04647946357727051
r_  generation:  0.4182889461517334
local_output_nid generation:  0.030651330947875977
local_in_edges_tensor generation:  0.03014397621154785
mini_batch_src_global generation:  0.049111127853393555
r_  generation:  0.39736318588256836
local_output_nid generation:  0.027384281158447266
local_in_edges_tensor generation:  0.029100418090820312
mini_batch_src_global generation:  0.04695391654968262
r_  generation:  0.4070909023284912
local_output_nid generation:  0.027074813842773438
local_in_edges_tensor generation:  0.02997612953186035
mini_batch_src_global generation:  0.04764199256896973
r_  generation:  0.39638853073120117
local_output_nid generation:  0.027092456817626953
local_in_edges_tensor generation:  0.02662968635559082
mini_batch_src_global generation:  0.04628252983093262
r_  generation:  0.4043691158294678
local_output_nid generation:  0.0271298885345459
local_in_edges_tensor generation:  0.03062605857849121
mini_batch_src_global generation:  0.04811429977416992
r_  generation:  0.41176414489746094
local_output_nid generation:  0.027049541473388672
local_in_edges_tensor generation:  0.026353120803833008
mini_batch_src_global generation:  0.049974918365478516
r_  generation:  0.4037637710571289
local_output_nid generation:  0.02742171287536621
local_in_edges_tensor generation:  0.029887676239013672
mini_batch_src_global generation:  0.047916412353515625
r_  generation:  0.40113186836242676
local_output_nid generation:  0.027318954467773438
local_in_edges_tensor generation:  0.0268552303314209
mini_batch_src_global generation:  0.04821419715881348
r_  generation:  0.40801286697387695
local_output_nid generation:  0.028147220611572266
local_in_edges_tensor generation:  0.031989097595214844
mini_batch_src_global generation:  0.04810309410095215
r_  generation:  0.3969309329986572
local_output_nid generation:  0.027490615844726562
local_in_edges_tensor generation:  0.025128841400146484
mini_batch_src_global generation:  0.048371315002441406
r_  generation:  0.407149076461792
local_output_nid generation:  0.027613162994384766
local_in_edges_tensor generation:  0.028348445892333984
mini_batch_src_global generation:  0.048314809799194336
r_  generation:  0.39986300468444824
local_output_nid generation:  0.02746129035949707
local_in_edges_tensor generation:  0.02645111083984375
mini_batch_src_global generation:  0.049208879470825195
r_  generation:  0.40134191513061523
local_output_nid generation:  0.02708292007446289
local_in_edges_tensor generation:  0.026548385620117188
mini_batch_src_global generation:  0.04831194877624512
r_  generation:  0.3966553211212158
local_output_nid generation:  0.027318716049194336
local_in_edges_tensor generation:  0.024936437606811523
mini_batch_src_global generation:  0.04683732986450195
r_  generation:  0.40551114082336426
local_output_nid generation:  0.02690577507019043
local_in_edges_tensor generation:  0.024438858032226562
mini_batch_src_global generation:  0.04804372787475586
r_  generation:  0.3953213691711426
local_output_nid generation:  0.027411222457885742
local_in_edges_tensor generation:  0.02562403678894043
mini_batch_src_global generation:  0.04694724082946777
r_  generation:  0.4091944694519043
local_output_nid generation:  0.030242443084716797
local_in_edges_tensor generation:  0.026314735412597656
mini_batch_src_global generation:  0.0503077507019043
r_  generation:  0.39723682403564453
local_output_nid generation:  0.02721095085144043
local_in_edges_tensor generation:  0.0247039794921875
mini_batch_src_global generation:  0.048346519470214844
r_  generation:  0.40376877784729004
local_output_nid generation:  0.02724003791809082
local_in_edges_tensor generation:  0.024891138076782227
mini_batch_src_global generation:  0.04806661605834961
r_  generation:  0.39679837226867676
local_output_nid generation:  0.027719497680664062
local_in_edges_tensor generation:  0.027147293090820312
mini_batch_src_global generation:  0.04917120933532715
r_  generation:  0.4113800525665283
local_output_nid generation:  0.02736210823059082
local_in_edges_tensor generation:  0.028712987899780273
mini_batch_src_global generation:  0.050445556640625
r_  generation:  0.4037296772003174
----------------------check_connections_block total spend ----------------------------- 19.11040496826172
generate_one_block  0.5474300384521484
generate_one_block  0.5386483669281006
generate_one_block  0.5374288558959961
generate_one_block  0.5332424640655518
generate_one_block  0.636624813079834
generate_one_block  0.5336258411407471
generate_one_block  0.5296018123626709
generate_one_block  0.5331225395202637
generate_one_block  0.5222058296203613
generate_one_block  0.5351433753967285
generate_one_block  0.5360040664672852
generate_one_block  0.5299205780029297
generate_one_block  0.5515003204345703
generate_one_block  0.5321686267852783
generate_one_block  0.5326833724975586
generate_one_block  0.5332674980163574
generate_one_block  0.5328638553619385
generate_one_block  0.5353918075561523
generate_one_block  0.5376231670379639
generate_one_block  0.5315959453582764
generate_one_block  0.5431630611419678
generate_one_block  0.5384507179260254
generate_one_block  0.5321953296661377
generate_one_block  0.5276772975921631
generate_one_block  0.5481624603271484
generate_one_block  0.5275790691375732
generate_one_block  0.546100378036499
generate_one_block  0.5296003818511963
generate_one_block  0.5383381843566895
generate_one_block  0.5373978614807129
generate_one_block  0.5461483001708984
generate_one_block  0.5422091484069824
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.11970329284667969  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

connection checking time:  25.764221668243408
block generation total time  22.98782730102539
average batch blocks generation time:  0.7183696031570435
block dataloader generation time/epoch 51.5218935807546
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10387372970581055  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.505902767181396  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10295629501342773  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.714911460876465  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503053665161133  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.945297241210938  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10252761840820312  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.458878993988037  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10269403457641602  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.585506439208984  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1041111946105957  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.8523268699646  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10267972946166992  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.621662616729736  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1039896011352539  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.805808544158936  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1027216911315918  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.484423160552979  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10329818725585938  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.639094829559326  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1028895378112793  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.552729606628418  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10263252258300781  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.573888778686523  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10396385192871094  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.787396907806396  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.102935791015625  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.509204864501953  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1038503646850586  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.812773704528809  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10391426086425781  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.840093612670898  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10279417037963867  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.392916679382324  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10322237014770508  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.67162561416626  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10500812530517578  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.771329402923584  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10310173034667969  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.723236560821533  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10508394241333008  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.140380382537842  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10421180725097656  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.886680603027344  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10261392593383789  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.594415187835693  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10278558731079102  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.606919288635254  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1039886474609375  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.69870138168335  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10243988037109375  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.297585487365723  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503053665161133  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.926427364349365  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10287714004516602  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.546664237976074  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10298442840576172  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.769959926605225  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10286283493041992  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.657334327697754  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10508871078491211  GigaBytes
Max Memory Allocated: 16.245644092559814  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.219218730926514  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10389184951782227  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.954702854156494  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03766060620546341 |0.012176796793937683 |0.262435682117939 |9.180605411529541e-05 |0.42793312668800354 |0.005471229553222656 |
----------------------------------------------------------pseudo_mini_loss sum 1.3939505815505981
Total (block generation + training)time/epoch 75.27811490164862
Training time/epoch 23.747055530548096
Training time without block to device /epoch 23.35739803314209
Training time without total dataloading part /epoch 22.100210905075073
load block tensor time/epoch 1.205139398574829
block to device time/epoch 0.38965749740600586
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  8574678
Number of first layer input nodes during this epoch:  4651703
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12172079086303711  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023343324661254883
range selection method range initialization spend 0.01291966438293457
time for parepare:  0.020261526107788086
local_output_nid generation:  0.00091552734375
local_in_edges_tensor generation:  0.006771087646484375
mini_batch_src_global generation:  0.001543283462524414
r_  generation:  0.009001493453979492
local_output_nid generation:  0.0009312629699707031
local_in_edges_tensor generation:  0.0006186962127685547
mini_batch_src_global generation:  0.0013425350189208984
r_  generation:  0.008423328399658203
local_output_nid generation:  0.0008792877197265625
local_in_edges_tensor generation:  0.000553131103515625
mini_batch_src_global generation:  0.0009975433349609375
r_  generation:  0.008191108703613281
local_output_nid generation:  0.0008563995361328125
local_in_edges_tensor generation:  0.0005147457122802734
mini_batch_src_global generation:  0.0008714199066162109
r_  generation:  0.007862091064453125
local_output_nid generation:  0.0008192062377929688
local_in_edges_tensor generation:  0.0005333423614501953
mini_batch_src_global generation:  0.0008418560028076172
r_  generation:  0.007927417755126953
local_output_nid generation:  0.0008182525634765625
local_in_edges_tensor generation:  0.0005056858062744141
mini_batch_src_global generation:  0.0009458065032958984
r_  generation:  0.008125543594360352
local_output_nid generation:  0.0008168220520019531
local_in_edges_tensor generation:  0.0005104541778564453
mini_batch_src_global generation:  0.0008895397186279297
r_  generation:  0.00841212272644043
local_output_nid generation:  0.0008103847503662109
local_in_edges_tensor generation:  0.0005142688751220703
mini_batch_src_global generation:  0.0009036064147949219
r_  generation:  0.008467674255371094
local_output_nid generation:  0.000820159912109375
local_in_edges_tensor generation:  0.0004980564117431641
mini_batch_src_global generation:  0.0008661746978759766
r_  generation:  0.008084535598754883
local_output_nid generation:  0.0008242130279541016
local_in_edges_tensor generation:  0.0005199909210205078
mini_batch_src_global generation:  0.0009047985076904297
r_  generation:  0.008315324783325195
local_output_nid generation:  0.0008006095886230469
local_in_edges_tensor generation:  0.0005223751068115234
mini_batch_src_global generation:  0.0009605884552001953
r_  generation:  0.007940530776977539
local_output_nid generation:  0.0008087158203125
local_in_edges_tensor generation:  0.0005099773406982422
mini_batch_src_global generation:  0.0009551048278808594
r_  generation:  0.008330106735229492
local_output_nid generation:  0.0008132457733154297
local_in_edges_tensor generation:  0.000507354736328125
mini_batch_src_global generation:  0.0009238719940185547
r_  generation:  0.008366107940673828
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005326271057128906
mini_batch_src_global generation:  0.0008904933929443359
r_  generation:  0.00820779800415039
local_output_nid generation:  0.0007932186126708984
local_in_edges_tensor generation:  0.0005042552947998047
mini_batch_src_global generation:  0.0009050369262695312
r_  generation:  0.008328914642333984
local_output_nid generation:  0.0008091926574707031
local_in_edges_tensor generation:  0.0005095005035400391
mini_batch_src_global generation:  0.0010097026824951172
r_  generation:  0.008548498153686523
local_output_nid generation:  0.0008087158203125
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0009057521820068359
r_  generation:  0.00838160514831543
local_output_nid generation:  0.0007996559143066406
local_in_edges_tensor generation:  0.0005021095275878906
mini_batch_src_global generation:  0.0009062290191650391
r_  generation:  0.008088827133178711
local_output_nid generation:  0.0008065700531005859
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.0008685588836669922
r_  generation:  0.00801706314086914
local_output_nid generation:  0.0008115768432617188
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0008757114410400391
r_  generation:  0.008244514465332031
local_output_nid generation:  0.0008003711700439453
local_in_edges_tensor generation:  0.0005006790161132812
mini_batch_src_global generation:  0.0008935928344726562
r_  generation:  0.008255243301391602
local_output_nid generation:  0.0007960796356201172
local_in_edges_tensor generation:  0.00048804283142089844
mini_batch_src_global generation:  0.0008766651153564453
r_  generation:  0.008398294448852539
local_output_nid generation:  0.0007941722869873047
local_in_edges_tensor generation:  0.0004963874816894531
mini_batch_src_global generation:  0.0008800029754638672
r_  generation:  0.008177518844604492
local_output_nid generation:  0.0007946491241455078
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0008695125579833984
r_  generation:  0.008248329162597656
local_output_nid generation:  0.000789642333984375
local_in_edges_tensor generation:  0.0005128383636474609
mini_batch_src_global generation:  0.0008873939514160156
r_  generation:  0.007961273193359375
local_output_nid generation:  0.0007987022399902344
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.0008711814880371094
r_  generation:  0.008163690567016602
local_output_nid generation:  0.0007905960083007812
local_in_edges_tensor generation:  0.0004968643188476562
mini_batch_src_global generation:  0.0008738040924072266
r_  generation:  0.00802302360534668
local_output_nid generation:  0.0008001327514648438
local_in_edges_tensor generation:  0.0004985332489013672
mini_batch_src_global generation:  0.0009865760803222656
r_  generation:  0.008282899856567383
local_output_nid generation:  0.0008065700531005859
local_in_edges_tensor generation:  0.0004982948303222656
mini_batch_src_global generation:  0.0008871555328369141
r_  generation:  0.008147478103637695
local_output_nid generation:  0.0007946491241455078
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.000885009765625
r_  generation:  0.008234024047851562
local_output_nid generation:  0.0008020401000976562
local_in_edges_tensor generation:  0.0005095005035400391
mini_batch_src_global generation:  0.001028299331665039
r_  generation:  0.008556365966796875
local_output_nid generation:  0.0007977485656738281
local_in_edges_tensor generation:  0.0005066394805908203
mini_batch_src_global generation:  0.0008928775787353516
r_  generation:  0.008100748062133789
----------------------check_connections_block total spend ----------------------------- 0.4318065643310547
generate_one_block  0.02048659324645996
generate_one_block  0.016944408416748047
generate_one_block  0.015265226364135742
generate_one_block  0.014531135559082031
generate_one_block  0.014393806457519531
generate_one_block  0.014509916305541992
generate_one_block  0.014861822128295898
generate_one_block  0.015032052993774414
generate_one_block  0.014405488967895508
generate_one_block  0.014773130416870117
generate_one_block  0.014004945755004883
generate_one_block  0.015002012252807617
generate_one_block  0.014680624008178711
generate_one_block  0.014429807662963867
generate_one_block  0.014753580093383789
generate_one_block  0.014783382415771484
generate_one_block  0.014610052108764648
generate_one_block  0.01421809196472168
generate_one_block  0.014044523239135742
generate_one_block  0.014539480209350586
generate_one_block  0.014406204223632812
generate_one_block  0.014560222625732422
generate_one_block  0.014302968978881836
generate_one_block  0.01445150375366211
generate_one_block  0.013925313949584961
generate_one_block  0.014370203018188477
generate_one_block  0.014020919799804688
generate_one_block  0.014612197875976562
generate_one_block  0.013974189758300781
generate_one_block  0.014415502548217773
generate_one_block  0.014773368835449219
generate_one_block  0.01420903205871582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03504037857055664
gen group dst list time:  0.021181344985961914
time for parepare:  0.023033857345581055
local_output_nid generation:  0.004748106002807617
local_in_edges_tensor generation:  0.0165708065032959
mini_batch_src_global generation:  0.013197898864746094
r_  generation:  0.12359046936035156
local_output_nid generation:  0.006583452224731445
local_in_edges_tensor generation:  0.008169889450073242
mini_batch_src_global generation:  0.016178131103515625
r_  generation:  0.12702083587646484
local_output_nid generation:  0.007014036178588867
local_in_edges_tensor generation:  0.02803826332092285
mini_batch_src_global generation:  0.014506816864013672
r_  generation:  0.1310720443725586
local_output_nid generation:  0.006819963455200195
local_in_edges_tensor generation:  0.00774836540222168
mini_batch_src_global generation:  0.015436172485351562
r_  generation:  0.12958741188049316
local_output_nid generation:  0.0072519779205322266
local_in_edges_tensor generation:  0.006914854049682617
mini_batch_src_global generation:  0.015198469161987305
r_  generation:  0.1322617530822754
local_output_nid generation:  0.007438182830810547
local_in_edges_tensor generation:  0.006879329681396484
mini_batch_src_global generation:  0.016724109649658203
r_  generation:  0.1334245204925537
local_output_nid generation:  0.007691621780395508
local_in_edges_tensor generation:  0.007981061935424805
mini_batch_src_global generation:  0.01676774024963379
r_  generation:  0.1360933780670166
local_output_nid generation:  0.0077610015869140625
local_in_edges_tensor generation:  0.009538888931274414
mini_batch_src_global generation:  0.019160032272338867
r_  generation:  0.13861441612243652
local_output_nid generation:  0.0072553157806396484
local_in_edges_tensor generation:  0.007319450378417969
mini_batch_src_global generation:  0.016510486602783203
r_  generation:  0.13648462295532227
local_output_nid generation:  0.007406949996948242
local_in_edges_tensor generation:  0.0077702999114990234
mini_batch_src_global generation:  0.016495943069458008
r_  generation:  0.13768935203552246
local_output_nid generation:  0.007405519485473633
local_in_edges_tensor generation:  0.00876164436340332
mini_batch_src_global generation:  0.01644134521484375
r_  generation:  0.13196969032287598
local_output_nid generation:  0.007875204086303711
local_in_edges_tensor generation:  0.0074045658111572266
mini_batch_src_global generation:  0.01680469512939453
r_  generation:  0.13613104820251465
local_output_nid generation:  0.007832527160644531
local_in_edges_tensor generation:  0.0071752071380615234
mini_batch_src_global generation:  0.016791582107543945
r_  generation:  0.13853812217712402
local_output_nid generation:  0.007689952850341797
local_in_edges_tensor generation:  0.00732111930847168
mini_batch_src_global generation:  0.016858577728271484
r_  generation:  0.13599419593811035
local_output_nid generation:  0.007858514785766602
local_in_edges_tensor generation:  0.007411479949951172
mini_batch_src_global generation:  0.01740097999572754
r_  generation:  0.14059782028198242
local_output_nid generation:  0.007887601852416992
local_in_edges_tensor generation:  0.008209228515625
mini_batch_src_global generation:  0.01653575897216797
r_  generation:  0.13837575912475586
local_output_nid generation:  0.007895469665527344
local_in_edges_tensor generation:  0.007861852645874023
mini_batch_src_global generation:  0.016394853591918945
r_  generation:  0.13947272300720215
local_output_nid generation:  0.0076448917388916016
local_in_edges_tensor generation:  0.007938861846923828
mini_batch_src_global generation:  0.016420602798461914
r_  generation:  0.13512420654296875
local_output_nid generation:  0.007586479187011719
local_in_edges_tensor generation:  0.007250547409057617
mini_batch_src_global generation:  0.01562976837158203
r_  generation:  0.13196206092834473
local_output_nid generation:  0.007624149322509766
local_in_edges_tensor generation:  0.007348299026489258
mini_batch_src_global generation:  0.01631617546081543
r_  generation:  0.1359879970550537
local_output_nid generation:  0.007542848587036133
local_in_edges_tensor generation:  0.007435798645019531
mini_batch_src_global generation:  0.015954971313476562
r_  generation:  0.13531208038330078
local_output_nid generation:  0.007869482040405273
local_in_edges_tensor generation:  0.007627010345458984
mini_batch_src_global generation:  0.01651144027709961
r_  generation:  0.13755154609680176
local_output_nid generation:  0.007628917694091797
local_in_edges_tensor generation:  0.007326364517211914
mini_batch_src_global generation:  0.01608753204345703
r_  generation:  0.13443970680236816
local_output_nid generation:  0.007730007171630859
local_in_edges_tensor generation:  0.007485389709472656
mini_batch_src_global generation:  0.016509294509887695
r_  generation:  0.13779520988464355
local_output_nid generation:  0.007447481155395508
local_in_edges_tensor generation:  0.007308244705200195
mini_batch_src_global generation:  0.015705108642578125
r_  generation:  0.13172388076782227
local_output_nid generation:  0.007939577102661133
local_in_edges_tensor generation:  0.007294178009033203
mini_batch_src_global generation:  0.016103506088256836
r_  generation:  0.13870596885681152
local_output_nid generation:  0.007658243179321289
local_in_edges_tensor generation:  0.008193492889404297
mini_batch_src_global generation:  0.015608549118041992
r_  generation:  0.13504314422607422
local_output_nid generation:  0.008011579513549805
local_in_edges_tensor generation:  0.009605884552001953
mini_batch_src_global generation:  0.01717519760131836
r_  generation:  0.14208388328552246
local_output_nid generation:  0.00769495964050293
local_in_edges_tensor generation:  0.007330417633056641
mini_batch_src_global generation:  0.01599407196044922
r_  generation:  0.13323593139648438
local_output_nid generation:  0.008003711700439453
local_in_edges_tensor generation:  0.007510662078857422
mini_batch_src_global generation:  0.016153573989868164
r_  generation:  0.13757705688476562
local_output_nid generation:  0.008045434951782227
local_in_edges_tensor generation:  0.007918357849121094
mini_batch_src_global generation:  0.01691293716430664
r_  generation:  0.1423346996307373
local_output_nid generation:  0.00784921646118164
local_in_edges_tensor generation:  0.007286787033081055
mini_batch_src_global generation:  0.01642584800720215
r_  generation:  0.1394939422607422
----------------------check_connections_block total spend ----------------------------- 6.4362077713012695
generate_one_block  0.176591157913208
generate_one_block  0.1743605136871338
generate_one_block  0.17696309089660645
generate_one_block  0.17548131942749023
generate_one_block  0.19916605949401855
generate_one_block  0.1767117977142334
generate_one_block  0.17920589447021484
generate_one_block  0.18328404426574707
generate_one_block  0.1775045394897461
generate_one_block  0.1782982349395752
generate_one_block  0.1711435317993164
generate_one_block  0.1762373447418213
generate_one_block  0.17796969413757324
generate_one_block  0.17769813537597656
generate_one_block  0.1806349754333496
generate_one_block  0.17867469787597656
generate_one_block  0.18036890029907227
generate_one_block  0.17209982872009277
generate_one_block  0.16875100135803223
generate_one_block  0.2709934711456299
generate_one_block  0.1716630458831787
generate_one_block  0.17915797233581543
generate_one_block  0.17122578620910645
generate_one_block  0.17936182022094727
generate_one_block  0.16668367385864258
generate_one_block  0.1748363971710205
generate_one_block  0.17193341255187988
generate_one_block  0.18000221252441406
generate_one_block  0.17618370056152344
generate_one_block  0.17676973342895508
generate_one_block  0.1818864345550537
generate_one_block  0.17818021774291992
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03041672706604004
gen group dst list time:  0.10037469863891602
time for parepare:  0.018298625946044922
local_output_nid generation:  0.02188420295715332
local_in_edges_tensor generation:  0.03511643409729004
mini_batch_src_global generation:  0.03577423095703125
r_  generation:  0.38901853561401367
local_output_nid generation:  0.027237892150878906
local_in_edges_tensor generation:  0.030527353286743164
mini_batch_src_global generation:  0.04609322547912598
r_  generation:  0.3866238594055176
local_output_nid generation:  0.027409076690673828
local_in_edges_tensor generation:  0.029483795166015625
mini_batch_src_global generation:  0.04537487030029297
r_  generation:  0.4003024101257324
local_output_nid generation:  0.02778911590576172
local_in_edges_tensor generation:  0.026233196258544922
mini_batch_src_global generation:  0.04710745811462402
r_  generation:  0.3954432010650635
local_output_nid generation:  0.03019094467163086
local_in_edges_tensor generation:  0.02540898323059082
mini_batch_src_global generation:  0.04571723937988281
r_  generation:  0.4010350704193115
local_output_nid generation:  0.02662038803100586
local_in_edges_tensor generation:  0.025504589080810547
mini_batch_src_global generation:  0.04710793495178223
r_  generation:  0.3944692611694336
local_output_nid generation:  0.026319503784179688
local_in_edges_tensor generation:  0.025925636291503906
mini_batch_src_global generation:  0.04589414596557617
r_  generation:  0.40790724754333496
local_output_nid generation:  0.026378393173217773
local_in_edges_tensor generation:  0.02916550636291504
mini_batch_src_global generation:  0.04760551452636719
r_  generation:  0.3988637924194336
local_output_nid generation:  0.02617502212524414
local_in_edges_tensor generation:  0.027882099151611328
mini_batch_src_global generation:  0.046837806701660156
r_  generation:  0.4024498462677002
local_output_nid generation:  0.026286602020263672
local_in_edges_tensor generation:  0.026252031326293945
mini_batch_src_global generation:  0.047121286392211914
r_  generation:  0.3977065086364746
local_output_nid generation:  0.02669072151184082
local_in_edges_tensor generation:  0.026301145553588867
mini_batch_src_global generation:  0.045621395111083984
r_  generation:  0.3967301845550537
local_output_nid generation:  0.026569366455078125
local_in_edges_tensor generation:  0.02590322494506836
mini_batch_src_global generation:  0.04712653160095215
r_  generation:  0.3966078758239746
local_output_nid generation:  0.02644491195678711
local_in_edges_tensor generation:  0.02910327911376953
mini_batch_src_global generation:  0.04587888717651367
r_  generation:  0.4040257930755615
local_output_nid generation:  0.026648521423339844
local_in_edges_tensor generation:  0.02654576301574707
mini_batch_src_global generation:  0.0480647087097168
r_  generation:  0.3985860347747803
local_output_nid generation:  0.02645587921142578
local_in_edges_tensor generation:  0.02795267105102539
mini_batch_src_global generation:  0.04649710655212402
r_  generation:  0.41376805305480957
local_output_nid generation:  0.026698589324951172
local_in_edges_tensor generation:  0.0260622501373291
mini_batch_src_global generation:  0.04807782173156738
r_  generation:  0.40020155906677246
local_output_nid generation:  0.026080608367919922
local_in_edges_tensor generation:  0.0248415470123291
mini_batch_src_global generation:  0.047879695892333984
r_  generation:  0.4081156253814697
local_output_nid generation:  0.026546239852905273
local_in_edges_tensor generation:  0.026328086853027344
mini_batch_src_global generation:  0.04724431037902832
r_  generation:  0.401139497756958
local_output_nid generation:  0.026302337646484375
local_in_edges_tensor generation:  0.02804851531982422
mini_batch_src_global generation:  0.04534268379211426
r_  generation:  0.4030954837799072
local_output_nid generation:  0.026240110397338867
local_in_edges_tensor generation:  0.024747610092163086
mini_batch_src_global generation:  0.04765033721923828
r_  generation:  0.3984661102294922
local_output_nid generation:  0.026279449462890625
local_in_edges_tensor generation:  0.025528430938720703
mini_batch_src_global generation:  0.04572319984436035
r_  generation:  0.4096212387084961
local_output_nid generation:  0.026474475860595703
local_in_edges_tensor generation:  0.025118350982666016
mini_batch_src_global generation:  0.04766058921813965
r_  generation:  0.4008476734161377
local_output_nid generation:  0.02624678611755371
local_in_edges_tensor generation:  0.025192737579345703
mini_batch_src_global generation:  0.04564356803894043
r_  generation:  0.4032881259918213
local_output_nid generation:  0.026465654373168945
local_in_edges_tensor generation:  0.025110721588134766
mini_batch_src_global generation:  0.0513150691986084
r_  generation:  0.40435218811035156
local_output_nid generation:  0.026071548461914062
local_in_edges_tensor generation:  0.027970075607299805
mini_batch_src_global generation:  0.046509504318237305
r_  generation:  0.40268802642822266
local_output_nid generation:  0.026308298110961914
local_in_edges_tensor generation:  0.0267031192779541
mini_batch_src_global generation:  0.04939985275268555
r_  generation:  0.4009978771209717
local_output_nid generation:  0.026389122009277344
local_in_edges_tensor generation:  0.02734994888305664
mini_batch_src_global generation:  0.04581856727600098
r_  generation:  0.40100765228271484
local_output_nid generation:  0.02664780616760254
local_in_edges_tensor generation:  0.02782583236694336
mini_batch_src_global generation:  0.04770922660827637
r_  generation:  0.3994178771972656
local_output_nid generation:  0.026461124420166016
local_in_edges_tensor generation:  0.02645730972290039
mini_batch_src_global generation:  0.045952558517456055
r_  generation:  0.40671610832214355
local_output_nid generation:  0.02654719352722168
local_in_edges_tensor generation:  0.02603888511657715
mini_batch_src_global generation:  0.04743003845214844
r_  generation:  0.39690399169921875
local_output_nid generation:  0.027054309844970703
local_in_edges_tensor generation:  0.02686023712158203
mini_batch_src_global generation:  0.04632377624511719
r_  generation:  0.409822940826416
local_output_nid generation:  0.02668285369873047
local_in_edges_tensor generation:  0.027752161026000977
mini_batch_src_global generation:  0.047739267349243164
r_  generation:  0.4033548831939697
----------------------check_connections_block total spend ----------------------------- 18.9000346660614
generate_one_block  0.617992639541626
generate_one_block  0.5257327556610107
generate_one_block  0.5366051197052002
generate_one_block  0.5344276428222656
generate_one_block  0.53121018409729
generate_one_block  0.5286030769348145
generate_one_block  0.5313324928283691
generate_one_block  0.5386941432952881
generate_one_block  0.5343616008758545
generate_one_block  0.5333054065704346
generate_one_block  0.5470893383026123
generate_one_block  0.5269248485565186
generate_one_block  0.5352215766906738
generate_one_block  0.5369999408721924
generate_one_block  0.5353376865386963
generate_one_block  0.5308623313903809
generate_one_block  0.5351264476776123
generate_one_block  0.5283300876617432
generate_one_block  0.5253806114196777
generate_one_block  0.5308585166931152
generate_one_block  0.5268473625183105
generate_one_block  0.5314970016479492
generate_one_block  0.5250897407531738
generate_one_block  0.5398802757263184
generate_one_block  0.5223593711853027
generate_one_block  0.5348837375640869
generate_one_block  0.5355455875396729
generate_one_block  0.540499210357666
generate_one_block  0.5274596214294434
generate_one_block  0.5280249118804932
generate_one_block  0.5432085990905762
generate_one_block  0.558074951171875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12172079086303711  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

connection checking time:  25.33624243736267
block generation total time  22.917789459228516
average batch blocks generation time:  0.7161809206008911
block dataloader generation time/epoch 51.435339736938474
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10501956939697266  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.853397369384766  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10298395156860352  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.524089813232422  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1050114631652832  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.772444725036621  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10441017150878906  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.751337051391602  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10288000106811523  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.588167667388916  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10262298583984375  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.615166187286377  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10404586791992188  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.844912052154541  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10438108444213867  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.064998149871826  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10403728485107422  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.813528060913086  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10315895080566406  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.829343795776367  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10248994827270508  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.307400703430176  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10329771041870117  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.693366527557373  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10403251647949219  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.815587997436523  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10398149490356445  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.797080039978027  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503625869750977  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.892651557922363  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10288000106811523  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.809877872467041  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10385704040527344  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.888924598693848  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10295248031616211  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.514323234558105  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10373592376708984  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.352234840393066  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10307025909423828  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.553199768066406  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10270833969116211  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.375982284545898  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10309743881225586  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.673263549804688  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1037750244140625  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.430605411529541  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10430669784545898  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.802553176879883  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1025857925415039  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.2007474899292  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10323238372802734  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.656264305114746  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10284662246704102  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.419469356536865  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10422563552856445  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.988828182220459  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10269737243652344  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.43594217300415  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10251617431640625  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.634283542633057  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1050410270690918  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.987895965576172  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10407114028930664  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.770033836364746  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03785783797502518 |0.009519092738628387 |0.26211681962013245 |9.196251630783081e-05 |0.4279516488313675 |0.005516529083251953 |
----------------------------------------------------------pseudo_mini_loss sum 1.3673020601272583
Total (block generation + training)time/epoch 75.1814303636551
Training time/epoch 23.654687643051147
Training time without block to device /epoch 23.35007667541504
Training time without total dataloading part /epoch 22.0906503200531
load block tensor time/epoch 1.2114508152008057
block to device time/epoch 0.3046109676361084
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  8578827
Number of first layer input nodes during this epoch:  4656787
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12288045883178711  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0204312801361084
range selection method range initialization spend 0.012868404388427734
time for parepare:  0.01797962188720703
local_output_nid generation:  0.0009238719940185547
local_in_edges_tensor generation:  0.004132747650146484
mini_batch_src_global generation:  0.001316070556640625
r_  generation:  0.008690357208251953
local_output_nid generation:  0.0009720325469970703
local_in_edges_tensor generation:  0.0006291866302490234
mini_batch_src_global generation:  0.001264333724975586
r_  generation:  0.010001182556152344
local_output_nid generation:  0.0009295940399169922
local_in_edges_tensor generation:  0.0005557537078857422
mini_batch_src_global generation:  0.0010068416595458984
r_  generation:  0.007982254028320312
local_output_nid generation:  0.0008807182312011719
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0009181499481201172
r_  generation:  0.008121013641357422
local_output_nid generation:  0.0008862018585205078
local_in_edges_tensor generation:  0.0005276203155517578
mini_batch_src_global generation:  0.0008780956268310547
r_  generation:  0.007805347442626953
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0005221366882324219
mini_batch_src_global generation:  0.0008928775787353516
r_  generation:  0.008231163024902344
local_output_nid generation:  0.0008418560028076172
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0008802413940429688
r_  generation:  0.008121728897094727
local_output_nid generation:  0.0008196830749511719
local_in_edges_tensor generation:  0.0005080699920654297
mini_batch_src_global generation:  0.0008769035339355469
r_  generation:  0.008055686950683594
local_output_nid generation:  0.0008170604705810547
local_in_edges_tensor generation:  0.0005252361297607422
mini_batch_src_global generation:  0.0009915828704833984
r_  generation:  0.008402585983276367
local_output_nid generation:  0.0008254051208496094
local_in_edges_tensor generation:  0.0005173683166503906
mini_batch_src_global generation:  0.0009603500366210938
r_  generation:  0.009284734725952148
local_output_nid generation:  0.0008225440979003906
local_in_edges_tensor generation:  0.0005090236663818359
mini_batch_src_global generation:  0.0009236335754394531
r_  generation:  0.00837564468383789
local_output_nid generation:  0.0008420944213867188
local_in_edges_tensor generation:  0.000507354736328125
mini_batch_src_global generation:  0.0009119510650634766
r_  generation:  0.008324623107910156
local_output_nid generation:  0.0008168220520019531
local_in_edges_tensor generation:  0.0004897117614746094
mini_batch_src_global generation:  0.0009038448333740234
r_  generation:  0.008265495300292969
local_output_nid generation:  0.0008199214935302734
local_in_edges_tensor generation:  0.0005033016204833984
mini_batch_src_global generation:  0.0008883476257324219
r_  generation:  0.008171558380126953
local_output_nid generation:  0.0008118152618408203
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.0008697509765625
r_  generation:  0.008154153823852539
local_output_nid generation:  0.0008060932159423828
local_in_edges_tensor generation:  0.0004982948303222656
mini_batch_src_global generation:  0.0008738040924072266
r_  generation:  0.008255720138549805
local_output_nid generation:  0.0008027553558349609
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.0008673667907714844
r_  generation:  0.008088827133178711
local_output_nid generation:  0.0008106231689453125
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0009398460388183594
r_  generation:  0.0077402591705322266
local_output_nid generation:  0.0007994174957275391
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.0008788108825683594
r_  generation:  0.008119344711303711
local_output_nid generation:  0.0008249282836914062
local_in_edges_tensor generation:  0.0005030632019042969
mini_batch_src_global generation:  0.0009434223175048828
r_  generation:  0.009428024291992188
local_output_nid generation:  0.0008306503295898438
local_in_edges_tensor generation:  0.0005044937133789062
mini_batch_src_global generation:  0.0009591579437255859
r_  generation:  0.008614540100097656
local_output_nid generation:  0.0008111000061035156
local_in_edges_tensor generation:  0.0004925727844238281
mini_batch_src_global generation:  0.0008940696716308594
r_  generation:  0.008251190185546875
local_output_nid generation:  0.0008258819580078125
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0008873939514160156
r_  generation:  0.008233070373535156
local_output_nid generation:  0.0008139610290527344
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.0008718967437744141
r_  generation:  0.008332967758178711
local_output_nid generation:  0.0007877349853515625
local_in_edges_tensor generation:  0.0004885196685791016
mini_batch_src_global generation:  0.0008797645568847656
r_  generation:  0.008268594741821289
local_output_nid generation:  0.0007855892181396484
local_in_edges_tensor generation:  0.0004951953887939453
mini_batch_src_global generation:  0.0008788108825683594
r_  generation:  0.00831294059753418
local_output_nid generation:  0.0008025169372558594
local_in_edges_tensor generation:  0.0004992485046386719
mini_batch_src_global generation:  0.0008544921875
r_  generation:  0.008242368698120117
local_output_nid generation:  0.0008060932159423828
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.0008606910705566406
r_  generation:  0.008353471755981445
local_output_nid generation:  0.0007958412170410156
local_in_edges_tensor generation:  0.0004925727844238281
mini_batch_src_global generation:  0.0008409023284912109
r_  generation:  0.008180856704711914
local_output_nid generation:  0.0008018016815185547
local_in_edges_tensor generation:  0.0004887580871582031
mini_batch_src_global generation:  0.0008676052093505859
r_  generation:  0.008127450942993164
local_output_nid generation:  0.0007994174957275391
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0008664131164550781
r_  generation:  0.008329629898071289
local_output_nid generation:  0.0007910728454589844
local_in_edges_tensor generation:  0.0004940032958984375
mini_batch_src_global generation:  0.0008578300476074219
r_  generation:  0.008141279220581055
----------------------check_connections_block total spend ----------------------------- 0.4289731979370117
generate_one_block  0.016219615936279297
generate_one_block  0.017758607864379883
generate_one_block  0.014778375625610352
generate_one_block  0.014866113662719727
generate_one_block  0.014314889907836914
generate_one_block  0.014738798141479492
generate_one_block  0.014334917068481445
generate_one_block  0.014335870742797852
generate_one_block  0.01484823226928711
generate_one_block  0.015050172805786133
generate_one_block  0.014451742172241211
generate_one_block  0.014778375625610352
generate_one_block  0.014550924301147461
generate_one_block  0.014410257339477539
generate_one_block  0.014188766479492188
generate_one_block  0.014469385147094727
generate_one_block  0.014278173446655273
generate_one_block  0.013700485229492188
generate_one_block  0.014164924621582031
generate_one_block  0.015073299407958984
generate_one_block  0.01476144790649414
generate_one_block  0.014445066452026367
generate_one_block  0.0167081356048584
generate_one_block  0.014677762985229492
generate_one_block  0.014386653900146484
generate_one_block  0.014537572860717773
generate_one_block  0.014471769332885742
generate_one_block  0.014449357986450195
generate_one_block  0.014101982116699219
generate_one_block  0.014167308807373047
generate_one_block  0.01453852653503418
generate_one_block  0.014333724975585938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0381312370300293
gen group dst list time:  0.019564390182495117
time for parepare:  0.019747257232666016
local_output_nid generation:  0.004654884338378906
local_in_edges_tensor generation:  0.013373613357543945
mini_batch_src_global generation:  0.011642217636108398
r_  generation:  0.12441229820251465
local_output_nid generation:  0.0067708492279052734
local_in_edges_tensor generation:  0.008777618408203125
mini_batch_src_global generation:  0.01696944236755371
r_  generation:  0.16882801055908203
local_output_nid generation:  0.006684541702270508
local_in_edges_tensor generation:  0.028889179229736328
mini_batch_src_global generation:  0.015040397644042969
r_  generation:  0.13125944137573242
local_output_nid generation:  0.007244110107421875
local_in_edges_tensor generation:  0.00895833969116211
mini_batch_src_global generation:  0.01618051528930664
r_  generation:  0.13405895233154297
local_output_nid generation:  0.007266044616699219
local_in_edges_tensor generation:  0.008502006530761719
mini_batch_src_global generation:  0.0250701904296875
r_  generation:  0.14986300468444824
local_output_nid generation:  0.011453866958618164
local_in_edges_tensor generation:  0.011223316192626953
mini_batch_src_global generation:  0.0192413330078125
r_  generation:  0.14905977249145508
local_output_nid generation:  0.010330677032470703
local_in_edges_tensor generation:  0.007748603820800781
mini_batch_src_global generation:  0.019121885299682617
r_  generation:  0.1382145881652832
local_output_nid generation:  0.007967948913574219
local_in_edges_tensor generation:  0.0072252750396728516
mini_batch_src_global generation:  0.018671035766601562
r_  generation:  0.13555383682250977
local_output_nid generation:  0.007664203643798828
local_in_edges_tensor generation:  0.007538557052612305
mini_batch_src_global generation:  0.016535520553588867
r_  generation:  0.14294815063476562
local_output_nid generation:  0.00779414176940918
local_in_edges_tensor generation:  0.01179194450378418
mini_batch_src_global generation:  0.01747441291809082
r_  generation:  0.17904353141784668
local_output_nid generation:  0.008575439453125
local_in_edges_tensor generation:  0.00806117057800293
mini_batch_src_global generation:  0.01787543296813965
r_  generation:  0.14211487770080566
local_output_nid generation:  0.007772207260131836
local_in_edges_tensor generation:  0.011249780654907227
mini_batch_src_global generation:  0.017525911331176758
r_  generation:  0.14682626724243164
local_output_nid generation:  0.008107185363769531
local_in_edges_tensor generation:  0.009620189666748047
mini_batch_src_global generation:  0.01643681526184082
r_  generation:  0.17533230781555176
local_output_nid generation:  0.007658720016479492
local_in_edges_tensor generation:  0.0072824954986572266
mini_batch_src_global generation:  0.01719355583190918
r_  generation:  0.1419520378112793
local_output_nid generation:  0.0076677799224853516
local_in_edges_tensor generation:  0.00942540168762207
mini_batch_src_global generation:  0.016123533248901367
r_  generation:  0.1404731273651123
local_output_nid generation:  0.0077631473541259766
local_in_edges_tensor generation:  0.007313966751098633
mini_batch_src_global generation:  0.01665973663330078
r_  generation:  0.1467142105102539
local_output_nid generation:  0.009995460510253906
local_in_edges_tensor generation:  0.0077915191650390625
mini_batch_src_global generation:  0.017055273056030273
r_  generation:  0.14011621475219727
local_output_nid generation:  0.0075435638427734375
local_in_edges_tensor generation:  0.009046554565429688
mini_batch_src_global generation:  0.016206026077270508
r_  generation:  0.12784504890441895
local_output_nid generation:  0.0076465606689453125
local_in_edges_tensor generation:  0.0078105926513671875
mini_batch_src_global generation:  0.015660524368286133
r_  generation:  0.19025897979736328
local_output_nid generation:  0.00795602798461914
local_in_edges_tensor generation:  0.008010625839233398
mini_batch_src_global generation:  0.020678043365478516
r_  generation:  0.14127755165100098
local_output_nid generation:  0.008239507675170898
local_in_edges_tensor generation:  0.008909225463867188
mini_batch_src_global generation:  0.018272876739501953
r_  generation:  0.14434194564819336
local_output_nid generation:  0.007952690124511719
local_in_edges_tensor generation:  0.007272243499755859
mini_batch_src_global generation:  0.01694011688232422
r_  generation:  0.13683795928955078
local_output_nid generation:  0.007977962493896484
local_in_edges_tensor generation:  0.007297515869140625
mini_batch_src_global generation:  0.01589798927307129
r_  generation:  0.13892054557800293
local_output_nid generation:  0.0079345703125
local_in_edges_tensor generation:  0.0072782039642333984
mini_batch_src_global generation:  0.016731739044189453
r_  generation:  0.13660788536071777
local_output_nid generation:  0.008013486862182617
local_in_edges_tensor generation:  0.007293701171875
mini_batch_src_global generation:  0.015822887420654297
r_  generation:  0.1377561092376709
local_output_nid generation:  0.008063316345214844
local_in_edges_tensor generation:  0.007262468338012695
mini_batch_src_global generation:  0.02877211570739746
r_  generation:  0.1891157627105713
local_output_nid generation:  0.007979154586791992
local_in_edges_tensor generation:  0.00773310661315918
mini_batch_src_global generation:  0.01668691635131836
r_  generation:  0.13994598388671875
local_output_nid generation:  0.008074522018432617
local_in_edges_tensor generation:  0.007189273834228516
mini_batch_src_global generation:  0.016444921493530273
r_  generation:  0.13696074485778809
local_output_nid generation:  0.007919073104858398
local_in_edges_tensor generation:  0.0077054500579833984
mini_batch_src_global generation:  0.01652693748474121
r_  generation:  0.13796710968017578
local_output_nid generation:  0.008032560348510742
local_in_edges_tensor generation:  0.0072820186614990234
mini_batch_src_global generation:  0.01637411117553711
r_  generation:  0.13416600227355957
local_output_nid generation:  0.008077621459960938
local_in_edges_tensor generation:  0.007203340530395508
mini_batch_src_global generation:  0.016196727752685547
r_  generation:  0.13989925384521484
local_output_nid generation:  0.007987260818481445
local_in_edges_tensor generation:  0.008211612701416016
mini_batch_src_global generation:  0.016544103622436523
r_  generation:  0.13813400268554688
----------------------check_connections_block total spend ----------------------------- 6.861043930053711
generate_one_block  0.1797027587890625
generate_one_block  0.1927964687347412
generate_one_block  0.17862248420715332
generate_one_block  0.17943406105041504
generate_one_block  0.1841287612915039
generate_one_block  0.17745065689086914
generate_one_block  0.17612051963806152
generate_one_block  0.17456841468811035
generate_one_block  0.18065309524536133
generate_one_block  0.18506741523742676
generate_one_block  0.17488837242126465
generate_one_block  0.18036866188049316
generate_one_block  0.1788032054901123
generate_one_block  0.1785440444946289
generate_one_block  0.17442965507507324
generate_one_block  0.21132373809814453
generate_one_block  0.17977547645568848
generate_one_block  0.16539907455444336
generate_one_block  0.17746496200561523
generate_one_block  0.19123244285583496
generate_one_block  0.18649959564208984
generate_one_block  0.17632436752319336
generate_one_block  0.18018269538879395
generate_one_block  0.18295741081237793
generate_one_block  0.17441892623901367
generate_one_block  0.18226909637451172
generate_one_block  0.18272852897644043
generate_one_block  0.17447280883789062
generate_one_block  0.17365169525146484
generate_one_block  0.17146039009094238
generate_one_block  0.17545652389526367
generate_one_block  0.17421197891235352
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03423643112182617
gen group dst list time:  0.13558459281921387
time for parepare:  0.024147748947143555
local_output_nid generation:  0.02267909049987793
local_in_edges_tensor generation:  0.04546785354614258
mini_batch_src_global generation:  0.037994384765625
r_  generation:  0.39015793800354004
local_output_nid generation:  0.02809906005859375
local_in_edges_tensor generation:  0.03185606002807617
mini_batch_src_global generation:  0.049385786056518555
r_  generation:  0.40051960945129395
local_output_nid generation:  0.04039788246154785
local_in_edges_tensor generation:  0.024602651596069336
mini_batch_src_global generation:  0.05240678787231445
r_  generation:  0.411057710647583
local_output_nid generation:  0.02806568145751953
local_in_edges_tensor generation:  0.027585268020629883
mini_batch_src_global generation:  0.04778599739074707
r_  generation:  0.4048333168029785
local_output_nid generation:  0.02788829803466797
local_in_edges_tensor generation:  0.03401041030883789
mini_batch_src_global generation:  0.05415058135986328
r_  generation:  0.40500378608703613
local_output_nid generation:  0.027647972106933594
local_in_edges_tensor generation:  0.028547048568725586
mini_batch_src_global generation:  0.04854726791381836
r_  generation:  0.3995504379272461
local_output_nid generation:  0.02666759490966797
local_in_edges_tensor generation:  0.028080463409423828
mini_batch_src_global generation:  0.04798483848571777
r_  generation:  0.40819883346557617
local_output_nid generation:  0.026849985122680664
local_in_edges_tensor generation:  0.02651357650756836
mini_batch_src_global generation:  0.04875636100769043
r_  generation:  0.40769362449645996
local_output_nid generation:  0.027515411376953125
local_in_edges_tensor generation:  0.035976409912109375
mini_batch_src_global generation:  0.059857845306396484
r_  generation:  0.41252732276916504
local_output_nid generation:  0.028847455978393555
local_in_edges_tensor generation:  0.03840994834899902
mini_batch_src_global generation:  0.04907584190368652
r_  generation:  0.4038393497467041
local_output_nid generation:  0.027354717254638672
local_in_edges_tensor generation:  0.0263979434967041
mini_batch_src_global generation:  0.04810762405395508
r_  generation:  0.4059135913848877
local_output_nid generation:  0.027562856674194336
local_in_edges_tensor generation:  0.026520729064941406
mini_batch_src_global generation:  0.04873323440551758
r_  generation:  0.40131139755249023
local_output_nid generation:  0.02764439582824707
local_in_edges_tensor generation:  0.028647184371948242
mini_batch_src_global generation:  0.04795670509338379
r_  generation:  0.41350364685058594
local_output_nid generation:  0.02735280990600586
local_in_edges_tensor generation:  0.026257753372192383
mini_batch_src_global generation:  0.048627614974975586
r_  generation:  0.40167975425720215
local_output_nid generation:  0.027260303497314453
local_in_edges_tensor generation:  0.02733302116394043
mini_batch_src_global generation:  0.0493321418762207
r_  generation:  0.4044921398162842
local_output_nid generation:  0.02731800079345703
local_in_edges_tensor generation:  0.027907133102416992
mini_batch_src_global generation:  0.050148963928222656
r_  generation:  0.3987150192260742
local_output_nid generation:  0.027621746063232422
local_in_edges_tensor generation:  0.02809882164001465
mini_batch_src_global generation:  0.04790163040161133
r_  generation:  0.4055004119873047
local_output_nid generation:  0.026944875717163086
local_in_edges_tensor generation:  0.02612590789794922
mini_batch_src_global generation:  0.04788541793823242
r_  generation:  0.39232349395751953
local_output_nid generation:  0.027175426483154297
local_in_edges_tensor generation:  0.028688907623291016
mini_batch_src_global generation:  0.04752540588378906
r_  generation:  0.40705060958862305
local_output_nid generation:  0.02814650535583496
local_in_edges_tensor generation:  0.028383255004882812
mini_batch_src_global generation:  0.051084280014038086
r_  generation:  0.4118826389312744
local_output_nid generation:  0.02787470817565918
local_in_edges_tensor generation:  0.029809951782226562
mini_batch_src_global generation:  0.04865097999572754
r_  generation:  0.41319775581359863
local_output_nid generation:  0.02826976776123047
local_in_edges_tensor generation:  0.03388524055480957
mini_batch_src_global generation:  0.050464630126953125
r_  generation:  0.41617369651794434
local_output_nid generation:  0.028727293014526367
local_in_edges_tensor generation:  0.025725364685058594
mini_batch_src_global generation:  0.0496673583984375
r_  generation:  0.404325008392334
local_output_nid generation:  0.027329206466674805
local_in_edges_tensor generation:  0.026185989379882812
mini_batch_src_global generation:  0.04858803749084473
r_  generation:  0.3964400291442871
local_output_nid generation:  0.027272462844848633
local_in_edges_tensor generation:  0.024852514266967773
mini_batch_src_global generation:  0.04730725288391113
r_  generation:  0.4017484188079834
local_output_nid generation:  0.027691364288330078
local_in_edges_tensor generation:  0.024683237075805664
mini_batch_src_global generation:  0.04943060874938965
r_  generation:  0.402055025100708
local_output_nid generation:  0.03871750831604004
local_in_edges_tensor generation:  0.026738882064819336
mini_batch_src_global generation:  0.04936647415161133
r_  generation:  0.4095804691314697
local_output_nid generation:  0.027431964874267578
local_in_edges_tensor generation:  0.024396896362304688
mini_batch_src_global generation:  0.049027442932128906
r_  generation:  0.4001436233520508
local_output_nid generation:  0.027498245239257812
local_in_edges_tensor generation:  0.025821685791015625
mini_batch_src_global generation:  0.04770827293395996
r_  generation:  0.4082977771759033
local_output_nid generation:  0.027628183364868164
local_in_edges_tensor generation:  0.02853083610534668
mini_batch_src_global generation:  0.0485231876373291
r_  generation:  0.39924073219299316
local_output_nid generation:  0.02765822410583496
local_in_edges_tensor generation:  0.02565145492553711
mini_batch_src_global generation:  0.05082106590270996
r_  generation:  0.4187602996826172
local_output_nid generation:  0.027430295944213867
local_in_edges_tensor generation:  0.02686452865600586
mini_batch_src_global generation:  0.04838299751281738
r_  generation:  0.3992931842803955
----------------------check_connections_block total spend ----------------------------- 19.257802724838257
generate_one_block  0.5514016151428223
generate_one_block  0.5371041297912598
generate_one_block  0.5377426147460938
generate_one_block  0.5379946231842041
generate_one_block  0.6567275524139404
generate_one_block  0.5422866344451904
generate_one_block  0.5385830402374268
generate_one_block  0.5343661308288574
generate_one_block  0.5343542098999023
generate_one_block  0.5418863296508789
generate_one_block  0.5303342342376709
generate_one_block  0.5372726917266846
generate_one_block  0.5418822765350342
generate_one_block  0.5330901145935059
generate_one_block  0.5440089702606201
generate_one_block  0.5378644466400146
generate_one_block  0.5400409698486328
generate_one_block  0.527125358581543
generate_one_block  0.5293715000152588
generate_one_block  0.5470404624938965
generate_one_block  0.5425782203674316
generate_one_block  0.534416675567627
generate_one_block  0.5308980941772461
generate_one_block  0.5331892967224121
generate_one_block  0.54593825340271
generate_one_block  0.5425217151641846
generate_one_block  0.5370314121246338
generate_one_block  0.5312809944152832
generate_one_block  0.5406994819641113
generate_one_block  0.5335264205932617
generate_one_block  0.5371308326721191
generate_one_block  0.5366222858428955
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12288045883178711  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

connection checking time:  26.118846654891968
block generation total time  23.081719875335693
average batch blocks generation time:  0.7213037461042404
block dataloader generation time/epoch 51.45890381119468
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10397100448608398  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.674861431121826  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10413360595703125  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.06470823287964  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1029362678527832  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.701941967010498  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10400915145874023  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.833163261413574  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10277175903320312  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.501191139221191  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10320758819580078  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.797996997833252  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10399532318115234  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.710724353790283  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10302400588989258  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.710055828094482  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10402965545654297  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.972413063049316  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10416746139526367  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.135424613952637  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10293912887573242  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.669549465179443  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10407686233520508  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.91845703125  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10500955581665039  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.77375078201294  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1027674674987793  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.715695858001709  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10268068313598633  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.497153759002686  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1028141975402832  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.756970405578613  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10395622253417969  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.627718925476074  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1023101806640625  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 14.96735429763794  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10390090942382812  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.560925483703613  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10466289520263672  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.05796194076538  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10505437850952148  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.059499740600586  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1033172607421875  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.598592281341553  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10392189025878906  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.594690799713135  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10268259048461914  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.607513904571533  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10388565063476562  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.514864921569824  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10428953170776367  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.78425931930542  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10395526885986328  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.639418601989746  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1028451919555664  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.565814971923828  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10294103622436523  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.635268688201904  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10302305221557617  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.485139846801758  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1040048599243164  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.703887462615967  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10283708572387695  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.537204265594482  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031020373106002808 |0.012134812772274017 |0.26560071110725403 |9.259581565856934e-05 |0.4398595839738846 |0.0041844844818115234 |
----------------------------------------------------------pseudo_mini_loss sum 1.3442825078964233
Total (block generation + training)time/epoch 75.22844060984525
Training time/epoch 24.00373673439026
Training time without block to device /epoch 23.61542272567749
Training time without total dataloading part /epoch 22.58187699317932
load block tensor time/epoch 0.9926519393920898
block to device time/epoch 0.38831400871276855
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  8579255
Number of first layer input nodes during this epoch:  4656165
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1199183464050293  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021300315856933594
range selection method range initialization spend 0.016579389572143555
time for parepare:  0.021486282348632812
local_output_nid generation:  0.0009417533874511719
local_in_edges_tensor generation:  0.0045659542083740234
mini_batch_src_global generation:  0.005705118179321289
r_  generation:  0.012030601501464844
local_output_nid generation:  0.0012631416320800781
local_in_edges_tensor generation:  0.0006346702575683594
mini_batch_src_global generation:  0.0016872882843017578
r_  generation:  0.008328437805175781
local_output_nid generation:  0.001157522201538086
local_in_edges_tensor generation:  0.0005645751953125
mini_batch_src_global generation:  0.0011167526245117188
r_  generation:  0.007967233657836914
local_output_nid generation:  0.0011036396026611328
local_in_edges_tensor generation:  0.0006177425384521484
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.008385181427001953
local_output_nid generation:  0.001081705093383789
local_in_edges_tensor generation:  0.0005965232849121094
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.00853872299194336
local_output_nid generation:  0.0010907649993896484
local_in_edges_tensor generation:  0.0006053447723388672
mini_batch_src_global generation:  0.0011055469512939453
r_  generation:  0.00843667984008789
local_output_nid generation:  0.0010709762573242188
local_in_edges_tensor generation:  0.003385782241821289
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.00839543342590332
local_output_nid generation:  0.0010886192321777344
local_in_edges_tensor generation:  0.0007131099700927734
mini_batch_src_global generation:  0.0010097026824951172
r_  generation:  0.008246660232543945
local_output_nid generation:  0.0010554790496826172
local_in_edges_tensor generation:  0.0005979537963867188
mini_batch_src_global generation:  0.0010676383972167969
r_  generation:  0.00843191146850586
local_output_nid generation:  0.0010058879852294922
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0010371208190917969
r_  generation:  0.008157014846801758
local_output_nid generation:  0.0009930133819580078
local_in_edges_tensor generation:  0.0005958080291748047
mini_batch_src_global generation:  0.0010936260223388672
r_  generation:  0.008145570755004883
local_output_nid generation:  0.00099945068359375
local_in_edges_tensor generation:  0.0005548000335693359
mini_batch_src_global generation:  0.0009775161743164062
r_  generation:  0.00831294059753418
local_output_nid generation:  0.001005411148071289
local_in_edges_tensor generation:  0.0005772113800048828
mini_batch_src_global generation:  0.0010323524475097656
r_  generation:  0.008329153060913086
local_output_nid generation:  0.0009737014770507812
local_in_edges_tensor generation:  0.0005352497100830078
mini_batch_src_global generation:  0.0009746551513671875
r_  generation:  0.012046575546264648
local_output_nid generation:  0.0022821426391601562
local_in_edges_tensor generation:  0.0012362003326416016
mini_batch_src_global generation:  0.0026221275329589844
r_  generation:  0.0119476318359375
local_output_nid generation:  0.0010976791381835938
local_in_edges_tensor generation:  0.0005860328674316406
mini_batch_src_global generation:  0.0013208389282226562
r_  generation:  0.008502721786499023
local_output_nid generation:  0.0009601116180419922
local_in_edges_tensor generation:  0.0005185604095458984
mini_batch_src_global generation:  0.0010669231414794922
r_  generation:  0.008257389068603516
local_output_nid generation:  0.0009100437164306641
local_in_edges_tensor generation:  0.0004932880401611328
mini_batch_src_global generation:  0.0009632110595703125
r_  generation:  0.008334875106811523
local_output_nid generation:  0.0008807182312011719
local_in_edges_tensor generation:  0.0005214214324951172
mini_batch_src_global generation:  0.0009844303131103516
r_  generation:  0.009567975997924805
local_output_nid generation:  0.0008575916290283203
local_in_edges_tensor generation:  0.0005168914794921875
mini_batch_src_global generation:  0.0009324550628662109
r_  generation:  0.00800180435180664
local_output_nid generation:  0.0008287429809570312
local_in_edges_tensor generation:  0.0004975795745849609
mini_batch_src_global generation:  0.0009074211120605469
r_  generation:  0.010566234588623047
local_output_nid generation:  0.0008306503295898438
local_in_edges_tensor generation:  0.0006234645843505859
mini_batch_src_global generation:  0.0009732246398925781
r_  generation:  0.00818943977355957
local_output_nid generation:  0.0008034706115722656
local_in_edges_tensor generation:  0.0005419254302978516
mini_batch_src_global generation:  0.0008981227874755859
r_  generation:  0.008241653442382812
local_output_nid generation:  0.0008013248443603516
local_in_edges_tensor generation:  0.0004923343658447266
mini_batch_src_global generation:  0.0008757114410400391
r_  generation:  0.00820159912109375
local_output_nid generation:  0.00078582763671875
local_in_edges_tensor generation:  0.0004923343658447266
mini_batch_src_global generation:  0.0008900165557861328
r_  generation:  0.008246183395385742
local_output_nid generation:  0.0008330345153808594
local_in_edges_tensor generation:  0.0005056858062744141
mini_batch_src_global generation:  0.0009043216705322266
r_  generation:  0.008284568786621094
local_output_nid generation:  0.0008156299591064453
local_in_edges_tensor generation:  0.0005059242248535156
mini_batch_src_global generation:  0.0008757114410400391
r_  generation:  0.008315324783325195
local_output_nid generation:  0.0008280277252197266
local_in_edges_tensor generation:  0.0005095005035400391
mini_batch_src_global generation:  0.0008790493011474609
r_  generation:  0.008291244506835938
local_output_nid generation:  0.000858306884765625
local_in_edges_tensor generation:  0.0004942417144775391
mini_batch_src_global generation:  0.000919342041015625
r_  generation:  0.008412599563598633
local_output_nid generation:  0.0008292198181152344
local_in_edges_tensor generation:  0.0004951953887939453
mini_batch_src_global generation:  0.000934600830078125
r_  generation:  0.008485555648803711
local_output_nid generation:  0.0008287429809570312
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.0009095668792724609
r_  generation:  0.008126258850097656
local_output_nid generation:  0.0007927417755126953
local_in_edges_tensor generation:  0.0004744529724121094
mini_batch_src_global generation:  0.0008814334869384766
r_  generation:  0.008360147476196289
----------------------check_connections_block total spend ----------------------------- 0.47638654708862305
generate_one_block  0.024179935455322266
generate_one_block  0.016992568969726562
generate_one_block  0.014694690704345703
generate_one_block  0.01676654815673828
generate_one_block  0.015049219131469727
generate_one_block  0.014958381652832031
generate_one_block  0.01461172103881836
generate_one_block  0.014532804489135742
generate_one_block  0.014599800109863281
generate_one_block  0.014325380325317383
generate_one_block  0.01588749885559082
generate_one_block  0.014657258987426758
generate_one_block  0.014571905136108398
generate_one_block  0.014412641525268555
generate_one_block  0.01446676254272461
generate_one_block  0.014598369598388672
generate_one_block  0.014484882354736328
generate_one_block  0.015990495681762695
generate_one_block  0.015212059020996094
generate_one_block  0.01397705078125
generate_one_block  0.014586687088012695
generate_one_block  0.014194965362548828
generate_one_block  0.01698160171508789
generate_one_block  0.014469623565673828
generate_one_block  0.015825748443603516
generate_one_block  0.014522314071655273
generate_one_block  0.014496564865112305
generate_one_block  0.014465570449829102
generate_one_block  0.014669418334960938
generate_one_block  0.014719963073730469
generate_one_block  0.014070272445678711
generate_one_block  0.0158383846282959
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03761172294616699
gen group dst list time:  0.024181842803955078
time for parepare:  0.022129297256469727
local_output_nid generation:  0.004541873931884766
local_in_edges_tensor generation:  0.01503753662109375
mini_batch_src_global generation:  0.01522970199584961
r_  generation:  0.12456440925598145
local_output_nid generation:  0.0067403316497802734
local_in_edges_tensor generation:  0.008510351181030273
mini_batch_src_global generation:  0.01761174201965332
r_  generation:  0.15018177032470703
local_output_nid generation:  0.010983705520629883
local_in_edges_tensor generation:  0.03978443145751953
mini_batch_src_global generation:  0.015902996063232422
r_  generation:  0.14810490608215332
local_output_nid generation:  0.01230931282043457
local_in_edges_tensor generation:  0.015857458114624023
mini_batch_src_global generation:  0.026742935180664062
r_  generation:  0.1383669376373291
local_output_nid generation:  0.011191844940185547
local_in_edges_tensor generation:  0.009300470352172852
mini_batch_src_global generation:  0.018722057342529297
r_  generation:  0.1411283016204834
local_output_nid generation:  0.008706808090209961
local_in_edges_tensor generation:  0.008072137832641602
mini_batch_src_global generation:  0.019948244094848633
r_  generation:  0.13854002952575684
local_output_nid generation:  0.007788896560668945
local_in_edges_tensor generation:  0.009097814559936523
mini_batch_src_global generation:  0.018880844116210938
r_  generation:  0.13907957077026367
local_output_nid generation:  0.007528066635131836
local_in_edges_tensor generation:  0.0068666934967041016
mini_batch_src_global generation:  0.016787290573120117
r_  generation:  0.13259482383728027
local_output_nid generation:  0.007359981536865234
local_in_edges_tensor generation:  0.00759124755859375
mini_batch_src_global generation:  0.016679763793945312
r_  generation:  0.14050817489624023
local_output_nid generation:  0.007452726364135742
local_in_edges_tensor generation:  0.006990194320678711
mini_batch_src_global generation:  0.018169879913330078
r_  generation:  0.13473939895629883
local_output_nid generation:  0.008000850677490234
local_in_edges_tensor generation:  0.006834983825683594
mini_batch_src_global generation:  0.016143321990966797
r_  generation:  0.13814091682434082
local_output_nid generation:  0.008019208908081055
local_in_edges_tensor generation:  0.007044076919555664
mini_batch_src_global generation:  0.016477346420288086
r_  generation:  0.13861322402954102
local_output_nid generation:  0.007978200912475586
local_in_edges_tensor generation:  0.007147550582885742
mini_batch_src_global generation:  0.027642488479614258
r_  generation:  0.14997315406799316
local_output_nid generation:  0.008014678955078125
local_in_edges_tensor generation:  0.01202082633972168
mini_batch_src_global generation:  0.020630836486816406
r_  generation:  0.13728070259094238
local_output_nid generation:  0.00805521011352539
local_in_edges_tensor generation:  0.008950233459472656
mini_batch_src_global generation:  0.01571202278137207
r_  generation:  0.14061522483825684
local_output_nid generation:  0.008176326751708984
local_in_edges_tensor generation:  0.007203578948974609
mini_batch_src_global generation:  0.016681432723999023
r_  generation:  0.13590288162231445
local_output_nid generation:  0.008203268051147461
local_in_edges_tensor generation:  0.007750272750854492
mini_batch_src_global generation:  0.016751766204833984
r_  generation:  0.13990187644958496
local_output_nid generation:  0.008256196975708008
local_in_edges_tensor generation:  0.007750749588012695
mini_batch_src_global generation:  0.016883373260498047
r_  generation:  0.13724470138549805
local_output_nid generation:  0.008452415466308594
local_in_edges_tensor generation:  0.009597301483154297
mini_batch_src_global generation:  0.017739295959472656
r_  generation:  0.19381213188171387
local_output_nid generation:  0.008255720138549805
local_in_edges_tensor generation:  0.008843660354614258
mini_batch_src_global generation:  0.017196178436279297
r_  generation:  0.13263416290283203
local_output_nid generation:  0.008131265640258789
local_in_edges_tensor generation:  0.007428884506225586
mini_batch_src_global generation:  0.015902996063232422
r_  generation:  0.1415424346923828
local_output_nid generation:  0.008072376251220703
local_in_edges_tensor generation:  0.007030010223388672
mini_batch_src_global generation:  0.016361474990844727
r_  generation:  0.13352537155151367
local_output_nid generation:  0.008301496505737305
local_in_edges_tensor generation:  0.0073969364166259766
mini_batch_src_global generation:  0.016711711883544922
r_  generation:  0.14201831817626953
local_output_nid generation:  0.008152008056640625
local_in_edges_tensor generation:  0.009711265563964844
mini_batch_src_global generation:  0.016632795333862305
r_  generation:  0.13933849334716797
local_output_nid generation:  0.009120941162109375
local_in_edges_tensor generation:  0.0077702999114990234
mini_batch_src_global generation:  0.016121864318847656
r_  generation:  0.14008569717407227
local_output_nid generation:  0.008317708969116211
local_in_edges_tensor generation:  0.00836324691772461
mini_batch_src_global generation:  0.01683831214904785
r_  generation:  0.1388835906982422
local_output_nid generation:  0.008301258087158203
local_in_edges_tensor generation:  0.009350299835205078
mini_batch_src_global generation:  0.015727996826171875
r_  generation:  0.14180588722229004
local_output_nid generation:  0.007987022399902344
local_in_edges_tensor generation:  0.008372783660888672
mini_batch_src_global generation:  0.01668524742126465
r_  generation:  0.14782428741455078
local_output_nid generation:  0.01042032241821289
local_in_edges_tensor generation:  0.010110855102539062
mini_batch_src_global generation:  0.01688861846923828
r_  generation:  0.14264869689941406
local_output_nid generation:  0.008729219436645508
local_in_edges_tensor generation:  0.009253978729248047
mini_batch_src_global generation:  0.0182342529296875
r_  generation:  0.14165592193603516
local_output_nid generation:  0.008238792419433594
local_in_edges_tensor generation:  0.0070574283599853516
mini_batch_src_global generation:  0.01580071449279785
r_  generation:  0.13805294036865234
local_output_nid generation:  0.008513689041137695
local_in_edges_tensor generation:  0.007391691207885742
mini_batch_src_global generation:  0.017051219940185547
r_  generation:  0.13764238357543945
----------------------check_connections_block total spend ----------------------------- 6.786529779434204
generate_one_block  0.17586541175842285
generate_one_block  0.170823335647583
generate_one_block  0.1713545322418213
generate_one_block  0.18184781074523926
generate_one_block  0.1950395107269287
generate_one_block  0.18207955360412598
generate_one_block  0.1786196231842041
generate_one_block  0.17863869667053223
generate_one_block  0.19291067123413086
generate_one_block  0.17471837997436523
generate_one_block  0.1732311248779297
generate_one_block  0.1778566837310791
generate_one_block  0.17998099327087402
generate_one_block  0.17792487144470215
generate_one_block  0.17781710624694824
generate_one_block  0.17667913436889648
generate_one_block  0.17920184135437012
generate_one_block  0.18007302284240723
generate_one_block  0.18964004516601562
generate_one_block  0.17938852310180664
generate_one_block  0.18016958236694336
generate_one_block  0.17241764068603516
generate_one_block  0.1777944564819336
generate_one_block  0.17199921607971191
generate_one_block  0.17229986190795898
generate_one_block  0.17571640014648438
generate_one_block  0.17552423477172852
generate_one_block  0.1759030818939209
generate_one_block  0.17943429946899414
generate_one_block  0.18197178840637207
generate_one_block  0.17178773880004883
generate_one_block  0.17536044120788574
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03538775444030762
gen group dst list time:  0.10924077033996582
time for parepare:  0.021170854568481445
local_output_nid generation:  0.024515628814697266
local_in_edges_tensor generation:  0.04193258285522461
mini_batch_src_global generation:  0.03795433044433594
r_  generation:  0.3917973041534424
local_output_nid generation:  0.0296018123626709
local_in_edges_tensor generation:  0.03226876258850098
mini_batch_src_global generation:  0.04845285415649414
r_  generation:  0.41003990173339844
local_output_nid generation:  0.031743526458740234
local_in_edges_tensor generation:  0.028145551681518555
mini_batch_src_global generation:  0.04657459259033203
r_  generation:  0.3985896110534668
local_output_nid generation:  0.029080629348754883
local_in_edges_tensor generation:  0.026927947998046875
mini_batch_src_global generation:  0.04921555519104004
r_  generation:  0.40552830696105957
local_output_nid generation:  0.028931856155395508
local_in_edges_tensor generation:  0.02709031105041504
mini_batch_src_global generation:  0.046582698822021484
r_  generation:  0.4068481922149658
local_output_nid generation:  0.02892017364501953
local_in_edges_tensor generation:  0.026909828186035156
mini_batch_src_global generation:  0.0483860969543457
r_  generation:  0.4050638675689697
local_output_nid generation:  0.027148962020874023
local_in_edges_tensor generation:  0.02676701545715332
mini_batch_src_global generation:  0.047034502029418945
r_  generation:  0.4061119556427002
local_output_nid generation:  0.027484893798828125
local_in_edges_tensor generation:  0.025542020797729492
mini_batch_src_global generation:  0.04774832725524902
r_  generation:  0.39852404594421387
local_output_nid generation:  0.026955604553222656
local_in_edges_tensor generation:  0.0261991024017334
mini_batch_src_global generation:  0.04620480537414551
r_  generation:  0.40783095359802246
local_output_nid generation:  0.026722192764282227
local_in_edges_tensor generation:  0.026482820510864258
mini_batch_src_global generation:  0.0474095344543457
r_  generation:  0.40514278411865234
local_output_nid generation:  0.02679896354675293
local_in_edges_tensor generation:  0.026322603225708008
mini_batch_src_global generation:  0.04609942436218262
r_  generation:  0.4039952754974365
local_output_nid generation:  0.02972888946533203
local_in_edges_tensor generation:  0.026983976364135742
mini_batch_src_global generation:  0.04810476303100586
r_  generation:  0.4070088863372803
local_output_nid generation:  0.027413368225097656
local_in_edges_tensor generation:  0.026708126068115234
mini_batch_src_global generation:  0.046979427337646484
r_  generation:  0.4109795093536377
local_output_nid generation:  0.027531862258911133
local_in_edges_tensor generation:  0.032506704330444336
mini_batch_src_global generation:  0.04831385612487793
r_  generation:  0.4080042839050293
local_output_nid generation:  0.0276029109954834
local_in_edges_tensor generation:  0.02631402015686035
mini_batch_src_global generation:  0.0464787483215332
r_  generation:  0.41095685958862305
local_output_nid generation:  0.027360200881958008
local_in_edges_tensor generation:  0.027751445770263672
mini_batch_src_global generation:  0.057153940200805664
r_  generation:  0.3998837471008301
local_output_nid generation:  0.02744770050048828
local_in_edges_tensor generation:  0.028730392456054688
mini_batch_src_global generation:  0.04674673080444336
r_  generation:  0.4116513729095459
local_output_nid generation:  0.027269601821899414
local_in_edges_tensor generation:  0.028554677963256836
mini_batch_src_global generation:  0.048079490661621094
r_  generation:  0.399524450302124
local_output_nid generation:  0.02769756317138672
local_in_edges_tensor generation:  0.026921987533569336
mini_batch_src_global generation:  0.04696917533874512
r_  generation:  0.41414785385131836
local_output_nid generation:  0.02688765525817871
local_in_edges_tensor generation:  0.02431797981262207
mini_batch_src_global generation:  0.0499110221862793
r_  generation:  0.39606785774230957
local_output_nid generation:  0.028440475463867188
local_in_edges_tensor generation:  0.024827241897583008
mini_batch_src_global generation:  0.04842782020568848
r_  generation:  0.4091339111328125
local_output_nid generation:  0.02733635902404785
local_in_edges_tensor generation:  0.029587984085083008
mini_batch_src_global generation:  0.05390644073486328
r_  generation:  0.3995640277862549
local_output_nid generation:  0.027405738830566406
local_in_edges_tensor generation:  0.02672553062438965
mini_batch_src_global generation:  0.04857754707336426
r_  generation:  0.41034483909606934
local_output_nid generation:  0.027460575103759766
local_in_edges_tensor generation:  0.025226831436157227
mini_batch_src_global generation:  0.048212289810180664
r_  generation:  0.41745662689208984
local_output_nid generation:  0.028917551040649414
local_in_edges_tensor generation:  0.030940532684326172
mini_batch_src_global generation:  0.04820895195007324
r_  generation:  0.4049067497253418
local_output_nid generation:  0.0282900333404541
local_in_edges_tensor generation:  0.02503490447998047
mini_batch_src_global generation:  0.04747891426086426
r_  generation:  0.3992764949798584
local_output_nid generation:  0.027666568756103516
local_in_edges_tensor generation:  0.02627253532409668
mini_batch_src_global generation:  0.046410322189331055
r_  generation:  0.40564680099487305
local_output_nid generation:  0.027507543563842773
local_in_edges_tensor generation:  0.02552938461303711
mini_batch_src_global generation:  0.04839038848876953
r_  generation:  0.40564799308776855
local_output_nid generation:  0.027904033660888672
local_in_edges_tensor generation:  0.028102397918701172
mini_batch_src_global generation:  0.04854249954223633
r_  generation:  0.4087510108947754
local_output_nid generation:  0.028049468994140625
local_in_edges_tensor generation:  0.02565312385559082
mini_batch_src_global generation:  0.04838252067565918
r_  generation:  0.404782772064209
local_output_nid generation:  0.027495622634887695
local_in_edges_tensor generation:  0.025552988052368164
mini_batch_src_global generation:  0.04751253128051758
r_  generation:  0.4144861698150635
local_output_nid generation:  0.02775430679321289
local_in_edges_tensor generation:  0.025157928466796875
mini_batch_src_global generation:  0.048038482666015625
r_  generation:  0.4016604423522949
----------------------check_connections_block total spend ----------------------------- 19.1764714717865
generate_one_block  0.5434684753417969
generate_one_block  0.524848222732544
generate_one_block  0.5299286842346191
generate_one_block  0.5410284996032715
generate_one_block  0.6372835636138916
generate_one_block  0.5413675308227539
generate_one_block  0.5339422225952148
generate_one_block  0.5356540679931641
generate_one_block  0.5352485179901123
generate_one_block  0.531423807144165
generate_one_block  0.527576208114624
generate_one_block  0.5426731109619141
generate_one_block  0.5416514873504639
generate_one_block  0.534961462020874
generate_one_block  0.5309104919433594
generate_one_block  0.524132490158081
generate_one_block  0.5461716651916504
generate_one_block  0.5388839244842529
generate_one_block  0.5417029857635498
generate_one_block  0.5260958671569824
generate_one_block  0.5412099361419678
generate_one_block  0.530789852142334
generate_one_block  0.5371968746185303
generate_one_block  0.545027494430542
generate_one_block  0.5434637069702148
generate_one_block  0.5321850776672363
generate_one_block  0.5280435085296631
generate_one_block  0.5365269184112549
generate_one_block  0.5377485752105713
generate_one_block  0.5405564308166504
generate_one_block  0.5262725353240967
generate_one_block  0.5280582904815674
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1199183464050293  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

connection checking time:  25.963001251220703
block generation total time  22.940102100372314
average batch blocks generation time:  0.7168781906366348
block dataloader generation time/epoch 51.465385476748146
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10268497467041016  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.488245010375977  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10284948348999023  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.4421706199646  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10265731811523438  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.509426593780518  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10415792465209961  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.99500560760498  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.103912353515625  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.953067779541016  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10419034957885742  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.99625301361084  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10500383377075195  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.793690204620361  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10292673110961914  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.581325054168701  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10272645950317383  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.70099687576294  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10256385803222656  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.42820119857788  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10266399383544922  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.378537654876709  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10323572158813477  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.713996410369873  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1037740707397461  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.806135654449463  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1029820442199707  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.632310390472412  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10392284393310547  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.623609066009521  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10284137725830078  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.520864009857178  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10400390625  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.721642971038818  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10303497314453125  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.711356163024902  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1050868034362793  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.173893928527832  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10242652893066406  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.274925231933594  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503005981445312  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.922725677490234  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10298585891723633  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.530701637268066  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10501623153686523  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.860649585723877  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1031794548034668  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.587481021881104  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.103912353515625  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.577390193939209  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10314178466796875  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.752619743347168  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1039285659790039  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.603569507598877  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10307884216308594  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.728387355804443  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10400772094726562  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.881926536560059  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10439300537109375  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.019219875335693  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10272741317749023  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.533714771270752  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10307502746582031  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.679552555084229  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.036962561309337616 |0.011977329850196838 |0.2624155804514885 |9.081512689590454e-05 |0.4316595643758774 |0.003671884536743164 |
----------------------------------------------------------pseudo_mini_loss sum 1.325568437576294
Total (block generation + training)time/epoch 75.2405722339948
Training time/epoch 23.83706760406494
Training time without block to device /epoch 23.453793048858643
Training time without total dataloading part /epoch 22.21698260307312
load block tensor time/epoch 1.1828019618988037
block to device time/epoch 0.38327455520629883
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  8573281
Number of first layer input nodes during this epoch:  4652879
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1201629638671875  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026248693466186523
range selection method range initialization spend 0.013327598571777344
time for parepare:  0.019033193588256836
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.007015705108642578
mini_batch_src_global generation:  0.001482248306274414
r_  generation:  0.008693218231201172
local_output_nid generation:  0.0009293556213378906
local_in_edges_tensor generation:  0.0006148815155029297
mini_batch_src_global generation:  0.00135040283203125
r_  generation:  0.008564472198486328
local_output_nid generation:  0.0008952617645263672
local_in_edges_tensor generation:  0.0005571842193603516
mini_batch_src_global generation:  0.0009329319000244141
r_  generation:  0.007921934127807617
local_output_nid generation:  0.0008893013000488281
local_in_edges_tensor generation:  0.0005059242248535156
mini_batch_src_global generation:  0.0008599758148193359
r_  generation:  0.007753610610961914
local_output_nid generation:  0.0008826255798339844
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.00091552734375
r_  generation:  0.008274555206298828
local_output_nid generation:  0.0008580684661865234
local_in_edges_tensor generation:  0.0004956722259521484
mini_batch_src_global generation:  0.0009481906890869141
r_  generation:  0.008249521255493164
local_output_nid generation:  0.0008184909820556641
local_in_edges_tensor generation:  0.0005583763122558594
mini_batch_src_global generation:  0.0009102821350097656
r_  generation:  0.00832509994506836
local_output_nid generation:  0.0008077621459960938
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0008575916290283203
r_  generation:  0.008115530014038086
local_output_nid generation:  0.0008015632629394531
local_in_edges_tensor generation:  0.0005154609680175781
mini_batch_src_global generation:  0.0008754730224609375
r_  generation:  0.008168697357177734
local_output_nid generation:  0.0008008480072021484
local_in_edges_tensor generation:  0.0004901885986328125
mini_batch_src_global generation:  0.0008511543273925781
r_  generation:  0.008282184600830078
local_output_nid generation:  0.0007994174957275391
local_in_edges_tensor generation:  0.0005016326904296875
mini_batch_src_global generation:  0.0008528232574462891
r_  generation:  0.008235454559326172
local_output_nid generation:  0.0008025169372558594
local_in_edges_tensor generation:  0.0004916191101074219
mini_batch_src_global generation:  0.0009715557098388672
r_  generation:  0.008451223373413086
local_output_nid generation:  0.0007977485656738281
local_in_edges_tensor generation:  0.0005102157592773438
mini_batch_src_global generation:  0.0010547637939453125
r_  generation:  0.009507417678833008
local_output_nid generation:  0.0008103847503662109
local_in_edges_tensor generation:  0.0005106925964355469
mini_batch_src_global generation:  0.0009124279022216797
r_  generation:  0.00821065902709961
local_output_nid generation:  0.0008058547973632812
local_in_edges_tensor generation:  0.0005056858062744141
mini_batch_src_global generation:  0.0009284019470214844
r_  generation:  0.008365154266357422
local_output_nid generation:  0.0008153915405273438
local_in_edges_tensor generation:  0.0005042552947998047
mini_batch_src_global generation:  0.0008988380432128906
r_  generation:  0.008256673812866211
local_output_nid generation:  0.0008106231689453125
local_in_edges_tensor generation:  0.0005283355712890625
mini_batch_src_global generation:  0.0009410381317138672
r_  generation:  0.008038759231567383
local_output_nid generation:  0.0008111000061035156
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.0008642673492431641
r_  generation:  0.008155107498168945
local_output_nid generation:  0.0008351802825927734
local_in_edges_tensor generation:  0.0005152225494384766
mini_batch_src_global generation:  0.0009162425994873047
r_  generation:  0.008491992950439453
local_output_nid generation:  0.0008008480072021484
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0009524822235107422
r_  generation:  0.00789022445678711
local_output_nid generation:  0.0007894039154052734
local_in_edges_tensor generation:  0.0004923343658447266
mini_batch_src_global generation:  0.0008904933929443359
r_  generation:  0.008087158203125
local_output_nid generation:  0.0008451938629150391
local_in_edges_tensor generation:  0.0005011558532714844
mini_batch_src_global generation:  0.0008630752563476562
r_  generation:  0.008273839950561523
local_output_nid generation:  0.0007956027984619141
local_in_edges_tensor generation:  0.0004973411560058594
mini_batch_src_global generation:  0.0008745193481445312
r_  generation:  0.008118867874145508
local_output_nid generation:  0.0007886886596679688
local_in_edges_tensor generation:  0.0004749298095703125
mini_batch_src_global generation:  0.0008678436279296875
r_  generation:  0.008382320404052734
local_output_nid generation:  0.0007944107055664062
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0008816719055175781
r_  generation:  0.008105754852294922
local_output_nid generation:  0.0008091926574707031
local_in_edges_tensor generation:  0.0005197525024414062
mini_batch_src_global generation:  0.0008931159973144531
r_  generation:  0.0084686279296875
local_output_nid generation:  0.0007922649383544922
local_in_edges_tensor generation:  0.0005061626434326172
mini_batch_src_global generation:  0.0008780956268310547
r_  generation:  0.008209705352783203
local_output_nid generation:  0.0008001327514648438
local_in_edges_tensor generation:  0.0004916191101074219
mini_batch_src_global generation:  0.0008625984191894531
r_  generation:  0.008101701736450195
local_output_nid generation:  0.0008027553558349609
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0008487701416015625
r_  generation:  0.008336305618286133
local_output_nid generation:  0.0007958412170410156
local_in_edges_tensor generation:  0.00048828125
mini_batch_src_global generation:  0.0009064674377441406
r_  generation:  0.008111715316772461
local_output_nid generation:  0.0008382797241210938
local_in_edges_tensor generation:  0.0004918575286865234
mini_batch_src_global generation:  0.0008409023284912109
r_  generation:  0.008085966110229492
local_output_nid generation:  0.0007846355438232422
local_in_edges_tensor generation:  0.0004932880401611328
mini_batch_src_global generation:  0.0008440017700195312
r_  generation:  0.008069753646850586
----------------------check_connections_block total spend ----------------------------- 0.4298551082611084
generate_one_block  0.020716190338134766
generate_one_block  0.016794204711914062
generate_one_block  0.014908313751220703
generate_one_block  0.014570474624633789
generate_one_block  0.015071630477905273
generate_one_block  0.014658927917480469
generate_one_block  0.014651060104370117
generate_one_block  0.014391422271728516
generate_one_block  0.014412403106689453
generate_one_block  0.014375448226928711
generate_one_block  0.014260530471801758
generate_one_block  0.01497340202331543
generate_one_block  0.01513218879699707
generate_one_block  0.014265775680541992
generate_one_block  0.014652252197265625
generate_one_block  0.01454472541809082
generate_one_block  0.014261960983276367
generate_one_block  0.014268636703491211
generate_one_block  0.014717817306518555
generate_one_block  0.013829708099365234
generate_one_block  0.014243364334106445
generate_one_block  0.014419794082641602
generate_one_block  0.016375064849853516
generate_one_block  0.014913320541381836
generate_one_block  0.01448678970336914
generate_one_block  0.014639139175415039
generate_one_block  0.014325380325317383
generate_one_block  0.014059066772460938
generate_one_block  0.014270782470703125
generate_one_block  0.014239072799682617
generate_one_block  0.014064311981201172
generate_one_block  0.014161109924316406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03552579879760742
gen group dst list time:  0.021741390228271484
time for parepare:  0.022372961044311523
local_output_nid generation:  0.0044708251953125
local_in_edges_tensor generation:  0.015744686126708984
mini_batch_src_global generation:  0.01302480697631836
r_  generation:  0.12347006797790527
local_output_nid generation:  0.006654500961303711
local_in_edges_tensor generation:  0.008530139923095703
mini_batch_src_global generation:  0.01607370376586914
r_  generation:  0.1252596378326416
local_output_nid generation:  0.006751060485839844
local_in_edges_tensor generation:  0.028784513473510742
mini_batch_src_global generation:  0.014646530151367188
r_  generation:  0.12967157363891602
local_output_nid generation:  0.006840705871582031
local_in_edges_tensor generation:  0.008330583572387695
mini_batch_src_global generation:  0.015507221221923828
r_  generation:  0.12903881072998047
local_output_nid generation:  0.0074634552001953125
local_in_edges_tensor generation:  0.00794076919555664
mini_batch_src_global generation:  0.015921592712402344
r_  generation:  0.1362926959991455
local_output_nid generation:  0.007604837417602539
local_in_edges_tensor generation:  0.009100198745727539
mini_batch_src_global generation:  0.01620173454284668
r_  generation:  0.1354050636291504
local_output_nid generation:  0.007544040679931641
local_in_edges_tensor generation:  0.007620573043823242
mini_batch_src_global generation:  0.01597285270690918
r_  generation:  0.13699579238891602
local_output_nid generation:  0.007615804672241211
local_in_edges_tensor generation:  0.007016181945800781
mini_batch_src_global generation:  0.016132831573486328
r_  generation:  0.1334073543548584
local_output_nid generation:  0.007250785827636719
local_in_edges_tensor generation:  0.007105350494384766
mini_batch_src_global generation:  0.01581120491027832
r_  generation:  0.13450026512145996
local_output_nid generation:  0.00728917121887207
local_in_edges_tensor generation:  0.0072193145751953125
mini_batch_src_global generation:  0.016480207443237305
r_  generation:  0.13492107391357422
local_output_nid generation:  0.0076558589935302734
local_in_edges_tensor generation:  0.0070683956146240234
mini_batch_src_global generation:  0.016297340393066406
r_  generation:  0.13652539253234863
local_output_nid generation:  0.007835865020751953
local_in_edges_tensor generation:  0.007241010665893555
mini_batch_src_global generation:  0.017082929611206055
r_  generation:  0.13734173774719238
local_output_nid generation:  0.008028030395507812
local_in_edges_tensor generation:  0.008499622344970703
mini_batch_src_global generation:  0.017715930938720703
r_  generation:  0.14421701431274414
local_output_nid generation:  0.007626533508300781
local_in_edges_tensor generation:  0.008540868759155273
mini_batch_src_global generation:  0.01630377769470215
r_  generation:  0.13143587112426758
local_output_nid generation:  0.007764339447021484
local_in_edges_tensor generation:  0.0073435306549072266
mini_batch_src_global generation:  0.016089200973510742
r_  generation:  0.13893461227416992
local_output_nid generation:  0.007799863815307617
local_in_edges_tensor generation:  0.0071942806243896484
mini_batch_src_global generation:  0.01671433448791504
r_  generation:  0.1358637809753418
local_output_nid generation:  0.007810831069946289
local_in_edges_tensor generation:  0.00724029541015625
mini_batch_src_global generation:  0.01587510108947754
r_  generation:  0.1382617950439453
local_output_nid generation:  0.007805347442626953
local_in_edges_tensor generation:  0.007397651672363281
mini_batch_src_global generation:  0.01643967628479004
r_  generation:  0.13521289825439453
local_output_nid generation:  0.007999420166015625
local_in_edges_tensor generation:  0.00734400749206543
mini_batch_src_global generation:  0.016674518585205078
r_  generation:  0.1408240795135498
local_output_nid generation:  0.0076062679290771484
local_in_edges_tensor generation:  0.0069599151611328125
mini_batch_src_global generation:  0.015891313552856445
r_  generation:  0.12885570526123047
local_output_nid generation:  0.007736682891845703
local_in_edges_tensor generation:  0.0072116851806640625
mini_batch_src_global generation:  0.015741348266601562
r_  generation:  0.13698744773864746
local_output_nid generation:  0.007574558258056641
local_in_edges_tensor generation:  0.007082700729370117
mini_batch_src_global generation:  0.01683640480041504
r_  generation:  0.1355118751525879
local_output_nid generation:  0.007790803909301758
local_in_edges_tensor generation:  0.007262706756591797
mini_batch_src_global generation:  0.015621423721313477
r_  generation:  0.1356065273284912
local_output_nid generation:  0.007801055908203125
local_in_edges_tensor generation:  0.0072629451751708984
mini_batch_src_global generation:  0.016646862030029297
r_  generation:  0.137861967086792
local_output_nid generation:  0.007800102233886719
local_in_edges_tensor generation:  0.009263277053833008
mini_batch_src_global generation:  0.0160067081451416
r_  generation:  0.1390230655670166
local_output_nid generation:  0.008022785186767578
local_in_edges_tensor generation:  0.008561134338378906
mini_batch_src_global generation:  0.01685190200805664
r_  generation:  0.13959980010986328
local_output_nid generation:  0.008067607879638672
local_in_edges_tensor generation:  0.007256984710693359
mini_batch_src_global generation:  0.015931129455566406
r_  generation:  0.14192485809326172
local_output_nid generation:  0.007791996002197266
local_in_edges_tensor generation:  0.007149934768676758
mini_batch_src_global generation:  0.016543865203857422
r_  generation:  0.13475346565246582
local_output_nid generation:  0.007893085479736328
local_in_edges_tensor generation:  0.0071964263916015625
mini_batch_src_global generation:  0.015736103057861328
r_  generation:  0.13854765892028809
local_output_nid generation:  0.007899761199951172
local_in_edges_tensor generation:  0.008707284927368164
mini_batch_src_global generation:  0.016480207443237305
r_  generation:  0.13591694831848145
local_output_nid generation:  0.007811546325683594
local_in_edges_tensor generation:  0.007254600524902344
mini_batch_src_global generation:  0.015696287155151367
r_  generation:  0.1366276741027832
local_output_nid generation:  0.007899761199951172
local_in_edges_tensor generation:  0.007273674011230469
mini_batch_src_global generation:  0.016131162643432617
r_  generation:  0.13494133949279785
----------------------check_connections_block total spend ----------------------------- 6.426938533782959
generate_one_block  0.17934465408325195
generate_one_block  0.1707291603088379
generate_one_block  0.17579126358032227
generate_one_block  0.17370891571044922
generate_one_block  0.19252490997314453
generate_one_block  0.17877626419067383
generate_one_block  0.17651987075805664
generate_one_block  0.17307424545288086
generate_one_block  0.1728074550628662
generate_one_block  0.17576837539672852
generate_one_block  0.1732480525970459
generate_one_block  0.17986631393432617
generate_one_block  0.1824049949645996
generate_one_block  0.16883373260498047
generate_one_block  0.17915892601013184
generate_one_block  0.17464900016784668
generate_one_block  0.17367172241210938
generate_one_block  0.17273879051208496
generate_one_block  0.1774001121520996
generate_one_block  0.16829609870910645
generate_one_block  0.1718578338623047
generate_one_block  0.17444348335266113
generate_one_block  0.1706068515777588
generate_one_block  0.17855048179626465
generate_one_block  0.1751999855041504
generate_one_block  0.18244481086730957
generate_one_block  0.17666387557983398
generate_one_block  0.17250919342041016
generate_one_block  0.1771073341369629
generate_one_block  0.1749570369720459
generate_one_block  0.17302680015563965
generate_one_block  0.17258024215698242
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035633087158203125
gen group dst list time:  0.1011362075805664
time for parepare:  0.020511865615844727
local_output_nid generation:  0.021562814712524414
local_in_edges_tensor generation:  0.03824615478515625
mini_batch_src_global generation:  0.03695845603942871
r_  generation:  0.39225053787231445
local_output_nid generation:  0.027685880661010742
local_in_edges_tensor generation:  0.031195640563964844
mini_batch_src_global generation:  0.047091007232666016
r_  generation:  0.38529372215270996
local_output_nid generation:  0.028133630752563477
local_in_edges_tensor generation:  0.027992963790893555
mini_batch_src_global generation:  0.04780888557434082
r_  generation:  0.4007267951965332
local_output_nid generation:  0.027706384658813477
local_in_edges_tensor generation:  0.024840831756591797
mini_batch_src_global generation:  0.047232627868652344
r_  generation:  0.39116954803466797
local_output_nid generation:  0.028155803680419922
local_in_edges_tensor generation:  0.027225494384765625
mini_batch_src_global generation:  0.05043506622314453
r_  generation:  0.4030487537384033
local_output_nid generation:  0.02746438980102539
local_in_edges_tensor generation:  0.025836467742919922
mini_batch_src_global generation:  0.04839825630187988
r_  generation:  0.39890480041503906
local_output_nid generation:  0.027056217193603516
local_in_edges_tensor generation:  0.0276944637298584
mini_batch_src_global generation:  0.0489954948425293
r_  generation:  0.4005296230316162
local_output_nid generation:  0.026645183563232422
local_in_edges_tensor generation:  0.025232553482055664
mini_batch_src_global generation:  0.04823756217956543
r_  generation:  0.39593029022216797
local_output_nid generation:  0.026526451110839844
local_in_edges_tensor generation:  0.024036645889282227
mini_batch_src_global generation:  0.04864835739135742
r_  generation:  0.40117597579956055
local_output_nid generation:  0.026546001434326172
local_in_edges_tensor generation:  0.02584075927734375
mini_batch_src_global generation:  0.04800868034362793
r_  generation:  0.3959226608276367
local_output_nid generation:  0.026509523391723633
local_in_edges_tensor generation:  0.026144742965698242
mini_batch_src_global generation:  0.04695487022399902
r_  generation:  0.40165233612060547
local_output_nid generation:  0.026796817779541016
local_in_edges_tensor generation:  0.025918960571289062
mini_batch_src_global generation:  0.04845595359802246
r_  generation:  0.39931249618530273
local_output_nid generation:  0.026990413665771484
local_in_edges_tensor generation:  0.02668023109436035
mini_batch_src_global generation:  0.046875953674316406
r_  generation:  0.4057793617248535
local_output_nid generation:  0.02639007568359375
local_in_edges_tensor generation:  0.024234533309936523
mini_batch_src_global generation:  0.04795980453491211
r_  generation:  0.39368605613708496
local_output_nid generation:  0.0267641544342041
local_in_edges_tensor generation:  0.025360822677612305
mini_batch_src_global generation:  0.048158884048461914
r_  generation:  0.4041001796722412
local_output_nid generation:  0.027060508728027344
local_in_edges_tensor generation:  0.02621626853942871
mini_batch_src_global generation:  0.04822802543640137
r_  generation:  0.4013185501098633
local_output_nid generation:  0.026917695999145508
local_in_edges_tensor generation:  0.029729843139648438
mini_batch_src_global generation:  0.04690384864807129
r_  generation:  0.4092254638671875
local_output_nid generation:  0.027099609375
local_in_edges_tensor generation:  0.02520751953125
mini_batch_src_global generation:  0.04786229133605957
r_  generation:  0.399965763092041
local_output_nid generation:  0.02731490135192871
local_in_edges_tensor generation:  0.02699112892150879
mini_batch_src_global generation:  0.047319650650024414
r_  generation:  0.41230177879333496
local_output_nid generation:  0.026369810104370117
local_in_edges_tensor generation:  0.024978160858154297
mini_batch_src_global generation:  0.047560691833496094
r_  generation:  0.3961331844329834
local_output_nid generation:  0.026697397232055664
local_in_edges_tensor generation:  0.025033235549926758
mini_batch_src_global generation:  0.0488584041595459
r_  generation:  0.4011993408203125
local_output_nid generation:  0.026686906814575195
local_in_edges_tensor generation:  0.026173830032348633
mini_batch_src_global generation:  0.04859805107116699
r_  generation:  0.39807558059692383
local_output_nid generation:  0.02686595916748047
local_in_edges_tensor generation:  0.02501368522644043
mini_batch_src_global generation:  0.04623222351074219
r_  generation:  0.4040110111236572
local_output_nid generation:  0.02733755111694336
local_in_edges_tensor generation:  0.028089523315429688
mini_batch_src_global generation:  0.05005979537963867
r_  generation:  0.4041779041290283
local_output_nid generation:  0.026802539825439453
local_in_edges_tensor generation:  0.026657581329345703
mini_batch_src_global generation:  0.04677700996398926
r_  generation:  0.403613805770874
local_output_nid generation:  0.02710127830505371
local_in_edges_tensor generation:  0.026775360107421875
mini_batch_src_global generation:  0.04793977737426758
r_  generation:  0.4024972915649414
local_output_nid generation:  0.02740335464477539
local_in_edges_tensor generation:  0.026054859161376953
mini_batch_src_global generation:  0.04662442207336426
r_  generation:  0.40723323822021484
local_output_nid generation:  0.02664804458618164
local_in_edges_tensor generation:  0.02583765983581543
mini_batch_src_global generation:  0.04792523384094238
r_  generation:  0.39448022842407227
local_output_nid generation:  0.027219295501708984
local_in_edges_tensor generation:  0.026324748992919922
mini_batch_src_global generation:  0.04674339294433594
r_  generation:  0.40229010581970215
local_output_nid generation:  0.02706003189086914
local_in_edges_tensor generation:  0.024089813232421875
mini_batch_src_global generation:  0.05011487007141113
r_  generation:  0.40284132957458496
local_output_nid generation:  0.026664257049560547
local_in_edges_tensor generation:  0.027503490447998047
mini_batch_src_global generation:  0.046788692474365234
r_  generation:  0.40184688568115234
local_output_nid generation:  0.02681589126586914
local_in_edges_tensor generation:  0.02480792999267578
mini_batch_src_global generation:  0.04822349548339844
r_  generation:  0.4016115665435791
----------------------check_connections_block total spend ----------------------------- 18.905873775482178
generate_one_block  0.5319321155548096
generate_one_block  0.521709680557251
generate_one_block  0.5309786796569824
generate_one_block  0.523040771484375
generate_one_block  0.6175553798675537
generate_one_block  0.5286643505096436
generate_one_block  0.5308256149291992
generate_one_block  0.5272424221038818
generate_one_block  0.5331132411956787
generate_one_block  0.5273268222808838
generate_one_block  0.5259935855865479
generate_one_block  0.5388689041137695
generate_one_block  0.5352768898010254
generate_one_block  0.5170943737030029
generate_one_block  0.5264828205108643
generate_one_block  0.5297567844390869
generate_one_block  0.5289337635040283
generate_one_block  0.5240175724029541
generate_one_block  0.5443010330200195
generate_one_block  0.5273501873016357
generate_one_block  0.5245468616485596
generate_one_block  0.5367164611816406
generate_one_block  0.5276534557342529
generate_one_block  0.5395188331604004
generate_one_block  0.547992467880249
generate_one_block  0.5397813320159912
generate_one_block  0.5352413654327393
generate_one_block  0.5190744400024414
generate_one_block  0.5304591655731201
generate_one_block  0.5311276912689209
generate_one_block  0.5226476192474365
generate_one_block  0.527921199798584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1201629638671875  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

connection checking time:  25.332812309265137
block generation total time  22.672406673431396
average batch blocks generation time:  0.7085127085447311
block dataloader generation time/epoch 51.387996636904205
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10500907897949219  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.798432350158691  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10298824310302734  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.472587585449219  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10400867462158203  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.683195114135742  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10274839401245117  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.546611785888672  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503578186035156  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.923859596252441  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10401535034179688  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.847177028656006  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10502290725708008  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.857120990753174  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10296154022216797  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.572569370269775  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10287809371948242  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.695908069610596  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1027979850769043  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.76643991470337  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10396862030029297  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.680296897888184  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10408735275268555  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.933617115020752  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10508441925048828  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.135769844055176  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10258865356445312  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.324189186096191  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10379886627197266  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.857780933380127  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10414648056030273  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.808200359344482  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1040029525756836  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.726094245910645  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1029353141784668  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.618770122528076  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503053665161133  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.898832321166992  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1025543212890625  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.241625308990479  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10288572311401367  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.566194534301758  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10256528854370117  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.661500453948975  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10281515121459961  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.468165874481201  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1041412353515625  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.919080257415771  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1049966812133789  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.765564441680908  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10404014587402344  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.980624198913574  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10500717163085938  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.794243812561035  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10275888442993164  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.49182415008545  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10400676727294922  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.729050636291504  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10422182083129883  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.72585153579712  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1027984619140625  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.453839302062988  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10313034057617188  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.57233190536499  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037046223878860474 |0.010553881525993347 |0.26193878799676895 |9.10535454750061e-05 |0.43000344187021255 |0.004743099212646484 |
----------------------------------------------------------pseudo_mini_loss sum 1.3200068473815918
Total (block generation + training)time/epoch 75.1592804651994
Training time/epoch 23.724231004714966
Training time without block to device /epoch 23.38650679588318
Training time without total dataloading part /epoch 22.149808168411255
load block tensor time/epoch 1.1854791641235352
block to device time/epoch 0.3377242088317871
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  8581216
Number of first layer input nodes during this epoch:  4653768
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12069320678710938  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022099733352661133
range selection method range initialization spend 0.016075849533081055
time for parepare:  0.018991470336914062
local_output_nid generation:  0.0009086132049560547
local_in_edges_tensor generation:  0.003621816635131836
mini_batch_src_global generation:  0.0019457340240478516
r_  generation:  0.010413646697998047
local_output_nid generation:  0.0009589195251464844
local_in_edges_tensor generation:  0.0006351470947265625
mini_batch_src_global generation:  0.001294851303100586
r_  generation:  0.008394956588745117
local_output_nid generation:  0.0009002685546875
local_in_edges_tensor generation:  0.0005300045013427734
mini_batch_src_global generation:  0.0010027885437011719
r_  generation:  0.007849931716918945
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0005195140838623047
mini_batch_src_global generation:  0.0009911060333251953
r_  generation:  0.00805807113647461
local_output_nid generation:  0.0008385181427001953
local_in_edges_tensor generation:  0.0005280971527099609
mini_batch_src_global generation:  0.0010113716125488281
r_  generation:  0.008372306823730469
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.0005123615264892578
mini_batch_src_global generation:  0.0009534358978271484
r_  generation:  0.008299112319946289
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0005002021789550781
mini_batch_src_global generation:  0.0009009838104248047
r_  generation:  0.008147954940795898
local_output_nid generation:  0.0008502006530761719
local_in_edges_tensor generation:  0.0005016326904296875
mini_batch_src_global generation:  0.0008785724639892578
r_  generation:  0.0082855224609375
local_output_nid generation:  0.0008409023284912109
local_in_edges_tensor generation:  0.0005004405975341797
mini_batch_src_global generation:  0.0009412765502929688
r_  generation:  0.008535385131835938
local_output_nid generation:  0.0008502006530761719
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.0009913444519042969
r_  generation:  0.008412361145019531
local_output_nid generation:  0.0008139610290527344
local_in_edges_tensor generation:  0.0005078315734863281
mini_batch_src_global generation:  0.0008985996246337891
r_  generation:  0.00820612907409668
local_output_nid generation:  0.0008287429809570312
local_in_edges_tensor generation:  0.0005087852478027344
mini_batch_src_global generation:  0.00090789794921875
r_  generation:  0.008237361907958984
local_output_nid generation:  0.0008089542388916016
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.0010442733764648438
r_  generation:  0.008564472198486328
local_output_nid generation:  0.0008275508880615234
local_in_edges_tensor generation:  0.0005044937133789062
mini_batch_src_global generation:  0.0009632110595703125
r_  generation:  0.00842905044555664
local_output_nid generation:  0.0008132457733154297
local_in_edges_tensor generation:  0.0004978179931640625
mini_batch_src_global generation:  0.0009126663208007812
r_  generation:  0.00847172737121582
local_output_nid generation:  0.0008168220520019531
local_in_edges_tensor generation:  0.000484466552734375
mini_batch_src_global generation:  0.0009107589721679688
r_  generation:  0.008409738540649414
local_output_nid generation:  0.0008213520050048828
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0009403228759765625
r_  generation:  0.008001565933227539
local_output_nid generation:  0.0008418560028076172
local_in_edges_tensor generation:  0.0005006790161132812
mini_batch_src_global generation:  0.0009510517120361328
r_  generation:  0.008157491683959961
local_output_nid generation:  0.0008003711700439453
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.0008890628814697266
r_  generation:  0.008174657821655273
local_output_nid generation:  0.0007917881011962891
local_in_edges_tensor generation:  0.0004951953887939453
mini_batch_src_global generation:  0.0008919239044189453
r_  generation:  0.008365869522094727
local_output_nid generation:  0.0008378028869628906
local_in_edges_tensor generation:  0.0004892349243164062
mini_batch_src_global generation:  0.0008780956268310547
r_  generation:  0.008181571960449219
local_output_nid generation:  0.0008685588836669922
local_in_edges_tensor generation:  0.0004973411560058594
mini_batch_src_global generation:  0.0008847713470458984
r_  generation:  0.00836634635925293
local_output_nid generation:  0.0008013248443603516
local_in_edges_tensor generation:  0.0004830360412597656
mini_batch_src_global generation:  0.0008881092071533203
r_  generation:  0.008248567581176758
local_output_nid generation:  0.0007913112640380859
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.0008952617645263672
r_  generation:  0.008065223693847656
local_output_nid generation:  0.0008032321929931641
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0009026527404785156
r_  generation:  0.008313655853271484
local_output_nid generation:  0.0008249282836914062
local_in_edges_tensor generation:  0.0005328655242919922
mini_batch_src_global generation:  0.0008733272552490234
r_  generation:  0.008236885070800781
local_output_nid generation:  0.0008013248443603516
local_in_edges_tensor generation:  0.00048613548278808594
mini_batch_src_global generation:  0.0009632110595703125
r_  generation:  0.008467435836791992
local_output_nid generation:  0.0008027553558349609
local_in_edges_tensor generation:  0.0004994869232177734
mini_batch_src_global generation:  0.0010066032409667969
r_  generation:  0.008409976959228516
local_output_nid generation:  0.0008497238159179688
local_in_edges_tensor generation:  0.0005028247833251953
mini_batch_src_global generation:  0.0008869171142578125
r_  generation:  0.008263111114501953
local_output_nid generation:  0.000823974609375
local_in_edges_tensor generation:  0.000514984130859375
mini_batch_src_global generation:  0.000919342041015625
r_  generation:  0.008561134338378906
local_output_nid generation:  0.0007910728454589844
local_in_edges_tensor generation:  0.0005021095275878906
mini_batch_src_global generation:  0.0009169578552246094
r_  generation:  0.00853419303894043
local_output_nid generation:  0.0007956027984619141
local_in_edges_tensor generation:  0.0004947185516357422
mini_batch_src_global generation:  0.0008933544158935547
r_  generation:  0.008485078811645508
----------------------check_connections_block total spend ----------------------------- 0.43352699279785156
generate_one_block  0.020495891571044922
generate_one_block  0.016956090927124023
generate_one_block  0.01476144790649414
generate_one_block  0.014692306518554688
generate_one_block  0.01519918441772461
generate_one_block  0.014736175537109375
generate_one_block  0.014345407485961914
generate_one_block  0.014660835266113281
generate_one_block  0.015131950378417969
generate_one_block  0.014678239822387695
generate_one_block  0.014500141143798828
generate_one_block  0.014635324478149414
generate_one_block  0.014965057373046875
generate_one_block  0.01480865478515625
generate_one_block  0.014741659164428711
generate_one_block  0.014616250991821289
generate_one_block  0.014011859893798828
generate_one_block  0.014361381530761719
generate_one_block  0.014190673828125
generate_one_block  0.014626502990722656
generate_one_block  0.014430761337280273
generate_one_block  0.014503717422485352
generate_one_block  0.01686382293701172
generate_one_block  0.014127731323242188
generate_one_block  0.014722824096679688
generate_one_block  0.014389991760253906
generate_one_block  0.014732837677001953
generate_one_block  0.014670133590698242
generate_one_block  0.014529705047607422
generate_one_block  0.014842987060546875
generate_one_block  0.014656782150268555
generate_one_block  0.014580011367797852
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035483360290527344
gen group dst list time:  0.02373504638671875
time for parepare:  0.022111177444458008
local_output_nid generation:  0.0048296451568603516
local_in_edges_tensor generation:  0.01436924934387207
mini_batch_src_global generation:  0.015653371810913086
r_  generation:  0.1283740997314453
local_output_nid generation:  0.006555080413818359
local_in_edges_tensor generation:  0.008577108383178711
mini_batch_src_global generation:  0.018450260162353516
r_  generation:  0.16327357292175293
local_output_nid generation:  0.006780862808227539
local_in_edges_tensor generation:  0.02954387664794922
mini_batch_src_global generation:  0.016403675079345703
r_  generation:  0.13051152229309082
local_output_nid generation:  0.007402896881103516
local_in_edges_tensor generation:  0.009042501449584961
mini_batch_src_global generation:  0.01835918426513672
r_  generation:  0.13442635536193848
local_output_nid generation:  0.007626056671142578
local_in_edges_tensor generation:  0.007009267807006836
mini_batch_src_global generation:  0.01831793785095215
r_  generation:  0.13948702812194824
local_output_nid generation:  0.007502079010009766
local_in_edges_tensor generation:  0.006945610046386719
mini_batch_src_global generation:  0.01938939094543457
r_  generation:  0.1362295150756836
local_output_nid generation:  0.007341146469116211
local_in_edges_tensor generation:  0.006979465484619141
mini_batch_src_global generation:  0.016484737396240234
r_  generation:  0.1348893642425537
local_output_nid generation:  0.007246494293212891
local_in_edges_tensor generation:  0.008051395416259766
mini_batch_src_global generation:  0.027176856994628906
r_  generation:  0.15230631828308105
local_output_nid generation:  0.010493993759155273
local_in_edges_tensor generation:  0.009486913681030273
mini_batch_src_global generation:  0.021412372589111328
r_  generation:  0.14096832275390625
local_output_nid generation:  0.007761478424072266
local_in_edges_tensor generation:  0.008797168731689453
mini_batch_src_global generation:  0.016570091247558594
r_  generation:  0.13492703437805176
local_output_nid generation:  0.007670402526855469
local_in_edges_tensor generation:  0.007140398025512695
mini_batch_src_global generation:  0.01661825180053711
r_  generation:  0.13539600372314453
local_output_nid generation:  0.0077664852142333984
local_in_edges_tensor generation:  0.007100582122802734
mini_batch_src_global generation:  0.016283035278320312
r_  generation:  0.1331784725189209
local_output_nid generation:  0.007852315902709961
local_in_edges_tensor generation:  0.007238864898681641
mini_batch_src_global generation:  0.01636219024658203
r_  generation:  0.14123964309692383
local_output_nid generation:  0.007771015167236328
local_in_edges_tensor generation:  0.008294820785522461
mini_batch_src_global generation:  0.016694307327270508
r_  generation:  0.14066648483276367
local_output_nid generation:  0.007734775543212891
local_in_edges_tensor generation:  0.0078122615814208984
mini_batch_src_global generation:  0.016742944717407227
r_  generation:  0.14471840858459473
local_output_nid generation:  0.007935762405395508
local_in_edges_tensor generation:  0.007732868194580078
mini_batch_src_global generation:  0.016815185546875
r_  generation:  0.1453263759613037
local_output_nid generation:  0.007624626159667969
local_in_edges_tensor generation:  0.011141061782836914
mini_batch_src_global generation:  0.016039133071899414
r_  generation:  0.1402130126953125
local_output_nid generation:  0.007796049118041992
local_in_edges_tensor generation:  0.010987520217895508
mini_batch_src_global generation:  0.01761627197265625
r_  generation:  0.1363816261291504
local_output_nid generation:  0.007657051086425781
local_in_edges_tensor generation:  0.0070836544036865234
mini_batch_src_global generation:  0.015871763229370117
r_  generation:  0.1339576244354248
local_output_nid generation:  0.007918357849121094
local_in_edges_tensor generation:  0.009017467498779297
mini_batch_src_global generation:  0.01665496826171875
r_  generation:  0.1872563362121582
local_output_nid generation:  0.007769107818603516
local_in_edges_tensor generation:  0.008378744125366211
mini_batch_src_global generation:  0.017688512802124023
r_  generation:  0.14007949829101562
local_output_nid generation:  0.007771015167236328
local_in_edges_tensor generation:  0.007856607437133789
mini_batch_src_global generation:  0.016787052154541016
r_  generation:  0.13973116874694824
local_output_nid generation:  0.008041143417358398
local_in_edges_tensor generation:  0.007378578186035156
mini_batch_src_global generation:  0.016303539276123047
r_  generation:  0.14107728004455566
local_output_nid generation:  0.007684469223022461
local_in_edges_tensor generation:  0.0071032047271728516
mini_batch_src_global generation:  0.0162808895111084
r_  generation:  0.16263961791992188
local_output_nid generation:  0.01030421257019043
local_in_edges_tensor generation:  0.008209943771362305
mini_batch_src_global generation:  0.020215749740600586
r_  generation:  0.1420459747314453
local_output_nid generation:  0.007787466049194336
local_in_edges_tensor generation:  0.007267475128173828
mini_batch_src_global generation:  0.01672077178955078
r_  generation:  0.13757634162902832
local_output_nid generation:  0.008106708526611328
local_in_edges_tensor generation:  0.007977724075317383
mini_batch_src_global generation:  0.016970396041870117
r_  generation:  0.1441965103149414
local_output_nid generation:  0.007969379425048828
local_in_edges_tensor generation:  0.00893259048461914
mini_batch_src_global generation:  0.016704082489013672
r_  generation:  0.14293265342712402
local_output_nid generation:  0.008054733276367188
local_in_edges_tensor generation:  0.008036613464355469
mini_batch_src_global generation:  0.015836238861083984
r_  generation:  0.14461636543273926
local_output_nid generation:  0.008160591125488281
local_in_edges_tensor generation:  0.008616924285888672
mini_batch_src_global generation:  0.017206430435180664
r_  generation:  0.14727473258972168
local_output_nid generation:  0.008168458938598633
local_in_edges_tensor generation:  0.008389949798583984
mini_batch_src_global generation:  0.016400575637817383
r_  generation:  0.14701008796691895
local_output_nid generation:  0.009078264236450195
local_in_edges_tensor generation:  0.008443355560302734
mini_batch_src_global generation:  0.01685190200805664
r_  generation:  0.1508159637451172
----------------------check_connections_block total spend ----------------------------- 6.76848030090332
generate_one_block  0.18785500526428223
generate_one_block  0.17661190032958984
generate_one_block  0.17378902435302734
generate_one_block  0.18053984642028809
generate_one_block  0.19835281372070312
generate_one_block  0.1797339916229248
generate_one_block  0.1728205680847168
generate_one_block  0.17752528190612793
generate_one_block  0.18307042121887207
generate_one_block  0.17544126510620117
generate_one_block  0.1734917163848877
generate_one_block  0.17298007011413574
generate_one_block  0.18122506141662598
generate_one_block  0.1848440170288086
generate_one_block  0.18424415588378906
generate_one_block  0.18120098114013672
generate_one_block  0.17261910438537598
generate_one_block  0.17436647415161133
generate_one_block  0.16917800903320312
generate_one_block  0.19062161445617676
generate_one_block  0.18081402778625488
generate_one_block  0.1818232536315918
generate_one_block  0.17796111106872559
generate_one_block  0.17516350746154785
generate_one_block  0.18187236785888672
generate_one_block  0.17705845832824707
generate_one_block  0.1826469898223877
generate_one_block  0.17960858345031738
generate_one_block  0.18106865882873535
generate_one_block  0.18855571746826172
generate_one_block  0.17968344688415527
generate_one_block  0.18136191368103027
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03296017646789551
gen group dst list time:  0.11162829399108887
time for parepare:  0.023272275924682617
local_output_nid generation:  0.023509979248046875
local_in_edges_tensor generation:  0.05209040641784668
mini_batch_src_global generation:  0.04836702346801758
r_  generation:  0.4163525104522705
local_output_nid generation:  0.030757665634155273
local_in_edges_tensor generation:  0.031404733657836914
mini_batch_src_global generation:  0.04916691780090332
r_  generation:  0.39154911041259766
local_output_nid generation:  0.028197765350341797
local_in_edges_tensor generation:  0.027024269104003906
mini_batch_src_global generation:  0.045188188552856445
r_  generation:  0.3976864814758301
local_output_nid generation:  0.02888178825378418
local_in_edges_tensor generation:  0.026112794876098633
mini_batch_src_global generation:  0.04763960838317871
r_  generation:  0.39586448669433594
local_output_nid generation:  0.029177188873291016
local_in_edges_tensor generation:  0.026523828506469727
mini_batch_src_global generation:  0.04645109176635742
r_  generation:  0.408034086227417
local_output_nid generation:  0.028341054916381836
local_in_edges_tensor generation:  0.026221513748168945
mini_batch_src_global generation:  0.048197269439697266
r_  generation:  0.41311216354370117
local_output_nid generation:  0.02691364288330078
local_in_edges_tensor generation:  0.026204824447631836
mini_batch_src_global generation:  0.046350955963134766
r_  generation:  0.4071357250213623
local_output_nid generation:  0.02761244773864746
local_in_edges_tensor generation:  0.03167724609375
mini_batch_src_global generation:  0.048270225524902344
r_  generation:  0.4046497344970703
local_output_nid generation:  0.02776932716369629
local_in_edges_tensor generation:  0.03065967559814453
mini_batch_src_global generation:  0.04732561111450195
r_  generation:  0.41381216049194336
local_output_nid generation:  0.02759695053100586
local_in_edges_tensor generation:  0.02684307098388672
mini_batch_src_global generation:  0.048631906509399414
r_  generation:  0.3993518352508545
local_output_nid generation:  0.02980184555053711
local_in_edges_tensor generation:  0.027663707733154297
mini_batch_src_global generation:  0.046384334564208984
r_  generation:  0.40715551376342773
local_output_nid generation:  0.027112960815429688
local_in_edges_tensor generation:  0.03088998794555664
mini_batch_src_global generation:  0.04842996597290039
r_  generation:  0.41617512702941895
local_output_nid generation:  0.029986858367919922
local_in_edges_tensor generation:  0.02853560447692871
mini_batch_src_global generation:  0.0480799674987793
r_  generation:  0.40706729888916016
local_output_nid generation:  0.027682781219482422
local_in_edges_tensor generation:  0.02842259407043457
mini_batch_src_global generation:  0.04801464080810547
r_  generation:  0.39892029762268066
local_output_nid generation:  0.02743673324584961
local_in_edges_tensor generation:  0.025615692138671875
mini_batch_src_global generation:  0.04635000228881836
r_  generation:  0.405444860458374
local_output_nid generation:  0.027564525604248047
local_in_edges_tensor generation:  0.029591798782348633
mini_batch_src_global generation:  0.05202126502990723
r_  generation:  0.4021010398864746
local_output_nid generation:  0.02748584747314453
local_in_edges_tensor generation:  0.02425217628479004
mini_batch_src_global generation:  0.04646897315979004
r_  generation:  0.4135141372680664
local_output_nid generation:  0.02738165855407715
local_in_edges_tensor generation:  0.02397751808166504
mini_batch_src_global generation:  0.052340030670166016
r_  generation:  0.39937424659729004
local_output_nid generation:  0.02721881866455078
local_in_edges_tensor generation:  0.02727508544921875
mini_batch_src_global generation:  0.04573416709899902
r_  generation:  0.4007081985473633
local_output_nid generation:  0.02749156951904297
local_in_edges_tensor generation:  0.02451920509338379
mini_batch_src_global generation:  0.049570322036743164
r_  generation:  0.40110135078430176
local_output_nid generation:  0.027588367462158203
local_in_edges_tensor generation:  0.0301511287689209
mini_batch_src_global generation:  0.04645586013793945
r_  generation:  0.41535234451293945
local_output_nid generation:  0.027648210525512695
local_in_edges_tensor generation:  0.030968904495239258
mini_batch_src_global generation:  0.04834890365600586
r_  generation:  0.4047372341156006
local_output_nid generation:  0.027559757232666016
local_in_edges_tensor generation:  0.02408003807067871
mini_batch_src_global generation:  0.046042442321777344
r_  generation:  0.40942883491516113
local_output_nid generation:  0.02757549285888672
local_in_edges_tensor generation:  0.027926206588745117
mini_batch_src_global generation:  0.048119306564331055
r_  generation:  0.40209460258483887
local_output_nid generation:  0.03023505210876465
local_in_edges_tensor generation:  0.027970314025878906
mini_batch_src_global generation:  0.04699540138244629
r_  generation:  0.4149050712585449
local_output_nid generation:  0.02833724021911621
local_in_edges_tensor generation:  0.02683234214782715
mini_batch_src_global generation:  0.0485081672668457
r_  generation:  0.3990635871887207
local_output_nid generation:  0.027764320373535156
local_in_edges_tensor generation:  0.026547908782958984
mini_batch_src_global generation:  0.04812216758728027
r_  generation:  0.4091920852661133
local_output_nid generation:  0.027668237686157227
local_in_edges_tensor generation:  0.024643898010253906
mini_batch_src_global generation:  0.04851722717285156
r_  generation:  0.4058408737182617
local_output_nid generation:  0.0281674861907959
local_in_edges_tensor generation:  0.02688312530517578
mini_batch_src_global generation:  0.04800224304199219
r_  generation:  0.41255617141723633
local_output_nid generation:  0.027901172637939453
local_in_edges_tensor generation:  0.026798486709594727
mini_batch_src_global generation:  0.04949069023132324
r_  generation:  0.40656590461730957
local_output_nid generation:  0.02744603157043457
local_in_edges_tensor generation:  0.03024911880493164
mini_batch_src_global generation:  0.04663705825805664
r_  generation:  0.431473970413208
local_output_nid generation:  0.029579877853393555
local_in_edges_tensor generation:  0.026648283004760742
mini_batch_src_global generation:  0.049338579177856445
r_  generation:  0.4070749282836914
----------------------check_connections_block total spend ----------------------------- 19.275095224380493
generate_one_block  0.5468564033508301
generate_one_block  0.5304536819458008
generate_one_block  0.5258610248565674
generate_one_block  0.535860538482666
generate_one_block  0.6372785568237305
generate_one_block  0.5401079654693604
generate_one_block  0.5260193347930908
generate_one_block  0.5338730812072754
generate_one_block  0.5435192584991455
generate_one_block  0.5309853553771973
generate_one_block  0.5334789752960205
generate_one_block  0.5275599956512451
generate_one_block  0.5424337387084961
generate_one_block  0.5436606407165527
generate_one_block  0.5300769805908203
generate_one_block  0.538931131362915
generate_one_block  0.530205249786377
generate_one_block  0.5310366153717041
generate_one_block  0.5312056541442871
generate_one_block  0.5509111881256104
generate_one_block  0.5503149032592773
generate_one_block  0.5423243045806885
generate_one_block  0.5374176502227783
generate_one_block  0.5309362411499023
generate_one_block  0.5619335174560547
generate_one_block  0.5291194915771484
generate_one_block  0.5408008098602295
generate_one_block  0.540095329284668
generate_one_block  0.5390427112579346
generate_one_block  0.5491478443145752
generate_one_block  0.5383572578430176
generate_one_block  0.5444128513336182
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12069320678710938  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

connection checking time:  26.043575525283813
block generation total time  23.07234764099121
average batch blocks generation time:  0.7210108637809753
block dataloader generation time/epoch 51.400428789002554
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1050262451171875  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.913824081420898  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10300731658935547  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.559669971466064  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10264873504638672  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.470871448516846  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1030263900756836  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.735851287841797  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503864288330078  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.962715148925781  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10323429107666016  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.765850067138672  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10279083251953125  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.57286787033081  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10336637496948242  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.71294641494751  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10391044616699219  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.97134017944336  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10295772552490234  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.662048816680908  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10268735885620117  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.476201057434082  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10261154174804688  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.512694835662842  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10501575469970703  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.877068042755127  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10413742065429688  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.823151588439941  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10284900665283203  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.75829267501831  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10415410995483398  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.894896984100342  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1026005744934082  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.338975429534912  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10295438766479492  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.622807502746582  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10255002975463867  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.305620670318604  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10311222076416016  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.712557315826416  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10499715805053711  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.765276432037354  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10415458679199219  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.801024436950684  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10397624969482422  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.656377792358398  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10286092758178711  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.409868717193604  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10501861572265625  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.896597385406494  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10320806503295898  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.647554874420166  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1040501594543457  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.901283740997314  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10393619537353516  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.802437782287598  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10500192642211914  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.773459911346436  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10416221618652344  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.00255298614502  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1050119400024414  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.811913967132568  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10387802124023438  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.872899532318115  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03770453482866287 |0.012401692569255829 |0.2653326615691185 |9.34600830078125e-05 |0.42953185737133026 |0.005994081497192383 |
----------------------------------------------------------pseudo_mini_loss sum 1.2983131408691406
Total (block generation + training)time/epoch 75.18080714770726
Training time/epoch 23.898363828659058
Training time without block to device /epoch 23.50150966644287
Training time without total dataloading part /epoch 22.244649410247803
load block tensor time/epoch 1.206545114517212
block to device time/epoch 0.3968541622161865
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  8580692
Number of first layer input nodes during this epoch:  4654400
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12165069580078125  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022797107696533203
range selection method range initialization spend 0.016262054443359375
time for parepare:  0.01938629150390625
local_output_nid generation:  0.0008978843688964844
local_in_edges_tensor generation:  0.0038819313049316406
mini_batch_src_global generation:  0.0019061565399169922
r_  generation:  0.010112285614013672
local_output_nid generation:  0.0009336471557617188
local_in_edges_tensor generation:  0.0006539821624755859
mini_batch_src_global generation:  0.0014164447784423828
r_  generation:  0.009107589721679688
local_output_nid generation:  0.0009016990661621094
local_in_edges_tensor generation:  0.0005490779876708984
mini_batch_src_global generation:  0.0010402202606201172
r_  generation:  0.007811546325683594
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0005159378051757812
mini_batch_src_global generation:  0.0009479522705078125
r_  generation:  0.0078084468841552734
local_output_nid generation:  0.0008349418640136719
local_in_edges_tensor generation:  0.0005130767822265625
mini_batch_src_global generation:  0.0009238719940185547
r_  generation:  0.0077435970306396484
local_output_nid generation:  0.0008451938629150391
local_in_edges_tensor generation:  0.0005173683166503906
mini_batch_src_global generation:  0.0009655952453613281
r_  generation:  0.008144617080688477
local_output_nid generation:  0.0008215904235839844
local_in_edges_tensor generation:  0.0004963874816894531
mini_batch_src_global generation:  0.0009860992431640625
r_  generation:  0.008126020431518555
local_output_nid generation:  0.00080108642578125
local_in_edges_tensor generation:  0.0005018711090087891
mini_batch_src_global generation:  0.0008840560913085938
r_  generation:  0.008074283599853516
local_output_nid generation:  0.0008037090301513672
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0008871555328369141
r_  generation:  0.008110761642456055
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0005254745483398438
mini_batch_src_global generation:  0.0009229183197021484
r_  generation:  0.009394168853759766
local_output_nid generation:  0.0008108615875244141
local_in_edges_tensor generation:  0.0004994869232177734
mini_batch_src_global generation:  0.0009157657623291016
r_  generation:  0.00800776481628418
local_output_nid generation:  0.0008068084716796875
local_in_edges_tensor generation:  0.0005211830139160156
mini_batch_src_global generation:  0.0009036064147949219
r_  generation:  0.008321762084960938
local_output_nid generation:  0.0008108615875244141
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.0009441375732421875
r_  generation:  0.008225440979003906
local_output_nid generation:  0.0008797645568847656
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0009191036224365234
r_  generation:  0.008211374282836914
local_output_nid generation:  0.0008020401000976562
local_in_edges_tensor generation:  0.00048828125
mini_batch_src_global generation:  0.0008730888366699219
r_  generation:  0.010211467742919922
local_output_nid generation:  0.0009176731109619141
local_in_edges_tensor generation:  0.0005505084991455078
mini_batch_src_global generation:  0.0009281635284423828
r_  generation:  0.008286476135253906
local_output_nid generation:  0.0008075237274169922
local_in_edges_tensor generation:  0.0005176067352294922
mini_batch_src_global generation:  0.0009293556213378906
r_  generation:  0.008410930633544922
local_output_nid generation:  0.0008065700531005859
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0008974075317382812
r_  generation:  0.008076667785644531
local_output_nid generation:  0.0007967948913574219
local_in_edges_tensor generation:  0.0004899501800537109
mini_batch_src_global generation:  0.0008769035339355469
r_  generation:  0.008093595504760742
local_output_nid generation:  0.0007936954498291016
local_in_edges_tensor generation:  0.0005638599395751953
mini_batch_src_global generation:  0.0009469985961914062
r_  generation:  0.008378028869628906
local_output_nid generation:  0.0008046627044677734
local_in_edges_tensor generation:  0.0004849433898925781
mini_batch_src_global generation:  0.0008990764617919922
r_  generation:  0.007998228073120117
local_output_nid generation:  0.0007886886596679688
local_in_edges_tensor generation:  0.0005238056182861328
mini_batch_src_global generation:  0.0010635852813720703
r_  generation:  0.00996541976928711
local_output_nid generation:  0.0008313655853271484
local_in_edges_tensor generation:  0.000499725341796875
mini_batch_src_global generation:  0.0009315013885498047
r_  generation:  0.008159875869750977
local_output_nid generation:  0.0008075237274169922
local_in_edges_tensor generation:  0.0004966259002685547
mini_batch_src_global generation:  0.0009298324584960938
r_  generation:  0.008304834365844727
local_output_nid generation:  0.0008082389831542969
local_in_edges_tensor generation:  0.0005068778991699219
mini_batch_src_global generation:  0.0009202957153320312
r_  generation:  0.008112192153930664
local_output_nid generation:  0.0008044242858886719
local_in_edges_tensor generation:  0.0005550384521484375
mini_batch_src_global generation:  0.0010051727294921875
r_  generation:  0.00845956802368164
local_output_nid generation:  0.0008063316345214844
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0009093284606933594
r_  generation:  0.008174419403076172
local_output_nid generation:  0.0007948875427246094
local_in_edges_tensor generation:  0.0004913806915283203
mini_batch_src_global generation:  0.0008857250213623047
r_  generation:  0.00841975212097168
local_output_nid generation:  0.0008122920989990234
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0009253025054931641
r_  generation:  0.008535385131835938
local_output_nid generation:  0.0008027553558349609
local_in_edges_tensor generation:  0.0005345344543457031
mini_batch_src_global generation:  0.0009386539459228516
r_  generation:  0.008460521697998047
local_output_nid generation:  0.0007913112640380859
local_in_edges_tensor generation:  0.0004916191101074219
mini_batch_src_global generation:  0.0009045600891113281
r_  generation:  0.008241415023803711
local_output_nid generation:  0.000820159912109375
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0008890628814697266
r_  generation:  0.010754823684692383
----------------------check_connections_block total spend ----------------------------- 0.4408681392669678
generate_one_block  0.02138829231262207
generate_one_block  0.016932964324951172
generate_one_block  0.014636516571044922
generate_one_block  0.014295816421508789
generate_one_block  0.01421213150024414
generate_one_block  0.016660451889038086
generate_one_block  0.014521598815917969
generate_one_block  0.014364242553710938
generate_one_block  0.014464855194091797
generate_one_block  0.015016317367553711
generate_one_block  0.014137983322143555
generate_one_block  0.014811038970947266
generate_one_block  0.016524791717529297
generate_one_block  0.014529705047607422
generate_one_block  0.01416921615600586
generate_one_block  0.014234304428100586
generate_one_block  0.014707326889038086
generate_one_block  0.014156103134155273
generate_one_block  0.014251232147216797
generate_one_block  0.01456451416015625
generate_one_block  0.016075611114501953
generate_one_block  0.015298843383789062
generate_one_block  0.016638755798339844
generate_one_block  0.014605998992919922
generate_one_block  0.014251470565795898
generate_one_block  0.014641284942626953
generate_one_block  0.014238595962524414
generate_one_block  0.014965295791625977
generate_one_block  0.014683961868286133
generate_one_block  0.01475977897644043
generate_one_block  0.01439523696899414
generate_one_block  0.014481067657470703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04115629196166992
gen group dst list time:  0.026201963424682617
time for parepare:  0.022713661193847656
local_output_nid generation:  0.004883527755737305
local_in_edges_tensor generation:  0.016708850860595703
mini_batch_src_global generation:  0.01538848876953125
r_  generation:  0.12827062606811523
local_output_nid generation:  0.0065937042236328125
local_in_edges_tensor generation:  0.009235382080078125
mini_batch_src_global generation:  0.018316268920898438
r_  generation:  0.12907052040100098
local_output_nid generation:  0.006680488586425781
local_in_edges_tensor generation:  0.029833316802978516
mini_batch_src_global generation:  0.013840675354003906
r_  generation:  0.12904095649719238
local_output_nid generation:  0.0070726871490478516
local_in_edges_tensor generation:  0.007589817047119141
mini_batch_src_global generation:  0.014817237854003906
r_  generation:  0.1299571990966797
local_output_nid generation:  0.007252931594848633
local_in_edges_tensor generation:  0.007642984390258789
mini_batch_src_global generation:  0.014833450317382812
r_  generation:  0.1316213607788086
local_output_nid generation:  0.007547140121459961
local_in_edges_tensor generation:  0.008012056350708008
mini_batch_src_global generation:  0.015924930572509766
r_  generation:  0.1454174518585205
local_output_nid generation:  0.009068965911865234
local_in_edges_tensor generation:  0.007533073425292969
mini_batch_src_global generation:  0.01576852798461914
r_  generation:  0.13505101203918457
local_output_nid generation:  0.007842302322387695
local_in_edges_tensor generation:  0.007492542266845703
mini_batch_src_global generation:  0.01606607437133789
r_  generation:  0.13413119316101074
local_output_nid generation:  0.0074574947357177734
local_in_edges_tensor generation:  0.007529497146606445
mini_batch_src_global generation:  0.01582932472229004
r_  generation:  0.13671374320983887
local_output_nid generation:  0.0077953338623046875
local_in_edges_tensor generation:  0.010226011276245117
mini_batch_src_global generation:  0.01763439178466797
r_  generation:  0.1406416893005371
local_output_nid generation:  0.007730245590209961
local_in_edges_tensor generation:  0.007621288299560547
mini_batch_src_global generation:  0.015822172164916992
r_  generation:  0.1356947422027588
local_output_nid generation:  0.00783991813659668
local_in_edges_tensor generation:  0.008178949356079102
mini_batch_src_global generation:  0.017315149307250977
r_  generation:  0.1378617286682129
local_output_nid generation:  0.007887840270996094
local_in_edges_tensor generation:  0.009500265121459961
mini_batch_src_global generation:  0.01676321029663086
r_  generation:  0.14299368858337402
local_output_nid generation:  0.007813692092895508
local_in_edges_tensor generation:  0.007834196090698242
mini_batch_src_global generation:  0.016695261001586914
r_  generation:  0.13635945320129395
local_output_nid generation:  0.007603883743286133
local_in_edges_tensor generation:  0.008183956146240234
mini_batch_src_global generation:  0.01540064811706543
r_  generation:  0.13375043869018555
local_output_nid generation:  0.0076596736907958984
local_in_edges_tensor generation:  0.007644176483154297
mini_batch_src_global generation:  0.016041278839111328
r_  generation:  0.13300132751464844
local_output_nid generation:  0.007972240447998047
local_in_edges_tensor generation:  0.01025247573852539
mini_batch_src_global generation:  0.01653766632080078
r_  generation:  0.1419358253479004
local_output_nid generation:  0.007554054260253906
local_in_edges_tensor generation:  0.007707357406616211
mini_batch_src_global generation:  0.016434192657470703
r_  generation:  0.1347823143005371
local_output_nid generation:  0.007564067840576172
local_in_edges_tensor generation:  0.008820056915283203
mini_batch_src_global generation:  0.01590895652770996
r_  generation:  0.17464661598205566
local_output_nid generation:  0.012720823287963867
local_in_edges_tensor generation:  0.012285470962524414
mini_batch_src_global generation:  0.02671980857849121
r_  generation:  0.1388990879058838
local_output_nid generation:  0.009837865829467773
local_in_edges_tensor generation:  0.007658481597900391
mini_batch_src_global generation:  0.015862226486206055
r_  generation:  0.13736891746520996
local_output_nid generation:  0.008923530578613281
local_in_edges_tensor generation:  0.008149385452270508
mini_batch_src_global generation:  0.019281387329101562
r_  generation:  0.14411568641662598
local_output_nid generation:  0.008116960525512695
local_in_edges_tensor generation:  0.007749319076538086
mini_batch_src_global generation:  0.015726804733276367
r_  generation:  0.13916635513305664
local_output_nid generation:  0.009358882904052734
local_in_edges_tensor generation:  0.007738590240478516
mini_batch_src_global generation:  0.016534805297851562
r_  generation:  0.13895463943481445
local_output_nid generation:  0.007882356643676758
local_in_edges_tensor generation:  0.008994817733764648
mini_batch_src_global generation:  0.015635967254638672
r_  generation:  0.13947176933288574
local_output_nid generation:  0.007974863052368164
local_in_edges_tensor generation:  0.008989334106445312
mini_batch_src_global generation:  0.018025875091552734
r_  generation:  0.14148950576782227
local_output_nid generation:  0.007775068283081055
local_in_edges_tensor generation:  0.008355379104614258
mini_batch_src_global generation:  0.016210079193115234
r_  generation:  0.13846945762634277
local_output_nid generation:  0.007954835891723633
local_in_edges_tensor generation:  0.00854349136352539
mini_batch_src_global generation:  0.017405986785888672
r_  generation:  0.14150357246398926
local_output_nid generation:  0.008077621459960938
local_in_edges_tensor generation:  0.008548736572265625
mini_batch_src_global generation:  0.016391515731811523
r_  generation:  0.1419508457183838
local_output_nid generation:  0.00793313980102539
local_in_edges_tensor generation:  0.008358955383300781
mini_batch_src_global generation:  0.016643285751342773
r_  generation:  0.1411597728729248
local_output_nid generation:  0.0078084468841552734
local_in_edges_tensor generation:  0.007919549942016602
mini_batch_src_global generation:  0.01610255241394043
r_  generation:  0.13972973823547363
local_output_nid generation:  0.007816553115844727
local_in_edges_tensor generation:  0.008358240127563477
mini_batch_src_global generation:  0.01642918586730957
r_  generation:  0.1378006935119629
----------------------check_connections_block total spend ----------------------------- 6.600910663604736
generate_one_block  0.18476223945617676
generate_one_block  0.17312192916870117
generate_one_block  0.17356371879577637
generate_one_block  0.17510986328125
generate_one_block  0.19153857231140137
generate_one_block  0.17922425270080566
generate_one_block  0.18155336380004883
generate_one_block  0.18073034286499023
generate_one_block  0.182358980178833
generate_one_block  0.18852591514587402
generate_one_block  0.17589783668518066
generate_one_block  0.18171977996826172
generate_one_block  0.18601155281066895
generate_one_block  0.17830705642700195
generate_one_block  0.17014789581298828
generate_one_block  0.170485258102417
generate_one_block  0.18275833129882812
generate_one_block  0.17303156852722168
generate_one_block  0.1751856803894043
generate_one_block  0.18203425407409668
generate_one_block  0.1721665859222412
generate_one_block  0.1888420581817627
generate_one_block  0.1720728874206543
generate_one_block  0.1767284870147705
generate_one_block  0.17504382133483887
generate_one_block  0.18339800834655762
generate_one_block  0.18098020553588867
generate_one_block  0.19852566719055176
generate_one_block  0.18490362167358398
generate_one_block  0.18328309059143066
generate_one_block  0.1801164150238037
generate_one_block  0.17769932746887207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03355240821838379
gen group dst list time:  0.10880446434020996
time for parepare:  0.020960330963134766
local_output_nid generation:  0.023268699645996094
local_in_edges_tensor generation:  0.0399785041809082
mini_batch_src_global generation:  0.03766345977783203
r_  generation:  0.3964700698852539
local_output_nid generation:  0.027910947799682617
local_in_edges_tensor generation:  0.0331873893737793
mini_batch_src_global generation:  0.05031275749206543
r_  generation:  0.40511322021484375
local_output_nid generation:  0.02849411964416504
local_in_edges_tensor generation:  0.03438735008239746
mini_batch_src_global generation:  0.04947161674499512
r_  generation:  0.4065697193145752
local_output_nid generation:  0.029297351837158203
local_in_edges_tensor generation:  0.028519630432128906
mini_batch_src_global generation:  0.04902148246765137
r_  generation:  0.39994192123413086
local_output_nid generation:  0.028164386749267578
local_in_edges_tensor generation:  0.029591083526611328
mini_batch_src_global generation:  0.04630756378173828
r_  generation:  0.41445112228393555
local_output_nid generation:  0.030005931854248047
local_in_edges_tensor generation:  0.027199268341064453
mini_batch_src_global generation:  0.05059313774108887
r_  generation:  0.3975961208343506
local_output_nid generation:  0.027069807052612305
local_in_edges_tensor generation:  0.025475025177001953
mini_batch_src_global generation:  0.04661703109741211
r_  generation:  0.4038841724395752
local_output_nid generation:  0.027318716049194336
local_in_edges_tensor generation:  0.02682638168334961
mini_batch_src_global generation:  0.04821181297302246
r_  generation:  0.39708828926086426
local_output_nid generation:  0.026938199996948242
local_in_edges_tensor generation:  0.02623295783996582
mini_batch_src_global generation:  0.04662728309631348
r_  generation:  0.40662312507629395
local_output_nid generation:  0.027606725692749023
local_in_edges_tensor generation:  0.029477596282958984
mini_batch_src_global generation:  0.05042600631713867
r_  generation:  0.41473984718322754
local_output_nid generation:  0.027110576629638672
local_in_edges_tensor generation:  0.025517702102661133
mini_batch_src_global generation:  0.04676365852355957
r_  generation:  0.4080841541290283
local_output_nid generation:  0.027516603469848633
local_in_edges_tensor generation:  0.02505326271057129
mini_batch_src_global generation:  0.04835844039916992
r_  generation:  0.39914393424987793
local_output_nid generation:  0.027114391326904297
local_in_edges_tensor generation:  0.02515721321105957
mini_batch_src_global generation:  0.04738616943359375
r_  generation:  0.4087071418762207
local_output_nid generation:  0.028833389282226562
local_in_edges_tensor generation:  0.02685546875
mini_batch_src_global generation:  0.04943490028381348
r_  generation:  0.4009971618652344
local_output_nid generation:  0.02724623680114746
local_in_edges_tensor generation:  0.024421215057373047
mini_batch_src_global generation:  0.04662442207336426
r_  generation:  0.4021761417388916
local_output_nid generation:  0.02727818489074707
local_in_edges_tensor generation:  0.0256192684173584
mini_batch_src_global generation:  0.049017906188964844
r_  generation:  0.3963799476623535
local_output_nid generation:  0.02791881561279297
local_in_edges_tensor generation:  0.026822805404663086
mini_batch_src_global generation:  0.0464930534362793
r_  generation:  0.40996646881103516
local_output_nid generation:  0.027734041213989258
local_in_edges_tensor generation:  0.028476953506469727
mini_batch_src_global generation:  0.04781222343444824
r_  generation:  0.39787960052490234
local_output_nid generation:  0.028383493423461914
local_in_edges_tensor generation:  0.03300786018371582
mini_batch_src_global generation:  0.04596662521362305
r_  generation:  0.4058878421783447
local_output_nid generation:  0.027949810028076172
local_in_edges_tensor generation:  0.028463363647460938
mini_batch_src_global generation:  0.047614336013793945
r_  generation:  0.40155625343322754
local_output_nid generation:  0.02755594253540039
local_in_edges_tensor generation:  0.027757883071899414
mini_batch_src_global generation:  0.04821157455444336
r_  generation:  0.40488123893737793
local_output_nid generation:  0.027966022491455078
local_in_edges_tensor generation:  0.030411720275878906
mini_batch_src_global generation:  0.048044681549072266
r_  generation:  0.41454243659973145
local_output_nid generation:  0.0290219783782959
local_in_edges_tensor generation:  0.026045799255371094
mini_batch_src_global generation:  0.04678511619567871
r_  generation:  0.40578556060791016
local_output_nid generation:  0.02782440185546875
local_in_edges_tensor generation:  0.026568174362182617
mini_batch_src_global generation:  0.049771785736083984
r_  generation:  0.40035462379455566
local_output_nid generation:  0.027774333953857422
local_in_edges_tensor generation:  0.027905702590942383
mini_batch_src_global generation:  0.045976877212524414
r_  generation:  0.4028785228729248
local_output_nid generation:  0.027767419815063477
local_in_edges_tensor generation:  0.02782893180847168
mini_batch_src_global generation:  0.04951739311218262
r_  generation:  0.4017608165740967
local_output_nid generation:  0.027234315872192383
local_in_edges_tensor generation:  0.024747371673583984
mini_batch_src_global generation:  0.04586076736450195
r_  generation:  0.40604209899902344
local_output_nid generation:  0.02793741226196289
local_in_edges_tensor generation:  0.027170419692993164
mini_batch_src_global generation:  0.04944634437561035
r_  generation:  0.4059784412384033
local_output_nid generation:  0.039711713790893555
local_in_edges_tensor generation:  0.02961254119873047
mini_batch_src_global generation:  0.046961307525634766
r_  generation:  0.4119987487792969
local_output_nid generation:  0.02776050567626953
local_in_edges_tensor generation:  0.024557113647460938
mini_batch_src_global generation:  0.047753095626831055
r_  generation:  0.40009641647338867
local_output_nid generation:  0.027598857879638672
local_in_edges_tensor generation:  0.02413463592529297
mini_batch_src_global generation:  0.0469210147857666
r_  generation:  0.40451717376708984
local_output_nid generation:  0.02747797966003418
local_in_edges_tensor generation:  0.024185895919799805
mini_batch_src_global generation:  0.0471339225769043
r_  generation:  0.39667344093322754
----------------------check_connections_block total spend ----------------------------- 19.1502366065979
generate_one_block  0.5461218357086182
generate_one_block  0.5258278846740723
generate_one_block  0.5299148559570312
generate_one_block  0.5305821895599365
generate_one_block  0.6228773593902588
generate_one_block  0.5317826271057129
generate_one_block  0.5364441871643066
generate_one_block  0.5343871116638184
generate_one_block  0.5364158153533936
generate_one_block  0.5409326553344727
generate_one_block  0.5316412448883057
generate_one_block  0.5329082012176514
generate_one_block  0.5349912643432617
generate_one_block  0.538250207901001
generate_one_block  0.5310060977935791
generate_one_block  0.5227198600769043
generate_one_block  0.538973331451416
generate_one_block  0.5333521366119385
generate_one_block  0.5305967330932617
generate_one_block  0.5368902683258057
generate_one_block  0.5322566032409668
generate_one_block  0.5433504581451416
generate_one_block  0.5329093933105469
generate_one_block  0.5395874977111816
generate_one_block  0.5427718162536621
generate_one_block  0.5424160957336426
generate_one_block  0.5330686569213867
generate_one_block  0.5436837673187256
generate_one_block  0.5374314785003662
generate_one_block  0.5327589511871338
generate_one_block  0.5273702144622803
generate_one_block  0.528362512588501
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12165069580078125  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

connection checking time:  25.751147270202637
block generation total time  22.962411880493164
average batch blocks generation time:  0.7175753712654114
block dataloader generation time/epoch 51.38986616134643
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10500907897949219  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.86729907989502  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10274314880371094  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.526514053344727  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10396289825439453  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.644510269165039  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1032261848449707  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.561816692352295  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10277128219604492  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.429203987121582  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10315465927124023  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.632694721221924  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10293006896972656  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.630770683288574  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10295677185058594  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.594491958618164  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10285615921020508  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.677602291107178  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1043844223022461  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.120410442352295  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10388946533203125  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.53223705291748  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10289478302001953  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.698808670043945  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10397005081176758  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.866703033447266  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10296487808227539  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.73910903930664  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10373210906982422  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.355054378509521  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10257673263549805  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.349704265594482  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1050419807434082  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.956839561462402  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10279273986816406  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.522127628326416  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10279417037963867  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.572486877441406  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10316038131713867  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.694681167602539  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1038818359375  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.527841091156006  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1041421890258789  GigaBytes
Max Memory Allocated: 16.250775814056396  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.21894121170044  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10283851623535156  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.48987102508545  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10305452346801758  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.70775556564331  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1028585433959961  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.527506351470947  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10417938232421875  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.877001285552979  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10390853881835938  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.589259624481201  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10419416427612305  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.996653079986572  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10504007339477539  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.950010299682617  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1039581298828125  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.843705654144287  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10291767120361328  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.641515731811523  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1028289794921875  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.614173889160156  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033061012625694275 |0.010961070656776428 |0.2619379013776779 |9.164959192276001e-05 |0.42676540464162827 |0.005834102630615234 |
----------------------------------------------------------pseudo_mini_loss sum 1.278696060180664
Total (block generation + training)time/epoch 75.15198397636414
Training time/epoch 23.506222009658813
Training time without block to device /epoch 23.155467748641968
Training time without total dataloading part /epoch 22.04727268218994
load block tensor time/epoch 1.0579524040222168
block to device time/epoch 0.3507542610168457
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  8577706
Number of first layer input nodes during this epoch:  4654886
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.11973905563354492  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021126270294189453
range selection method range initialization spend 0.013010025024414062
time for parepare:  0.0187833309173584
local_output_nid generation:  0.0009186267852783203
local_in_edges_tensor generation:  0.006462574005126953
mini_batch_src_global generation:  0.0012726783752441406
r_  generation:  0.00901937484741211
local_output_nid generation:  0.0009412765502929688
local_in_edges_tensor generation:  0.0006163120269775391
mini_batch_src_global generation:  0.0011942386627197266
r_  generation:  0.008387565612792969
local_output_nid generation:  0.0009119510650634766
local_in_edges_tensor generation:  0.0005583763122558594
mini_batch_src_global generation:  0.0009267330169677734
r_  generation:  0.007614850997924805
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.0005166530609130859
mini_batch_src_global generation:  0.0008995532989501953
r_  generation:  0.008112668991088867
local_output_nid generation:  0.0008463859558105469
local_in_edges_tensor generation:  0.0005130767822265625
mini_batch_src_global generation:  0.0008714199066162109
r_  generation:  0.007977008819580078
local_output_nid generation:  0.0008203983306884766
local_in_edges_tensor generation:  0.0005090236663818359
mini_batch_src_global generation:  0.0008404254913330078
r_  generation:  0.007881641387939453
local_output_nid generation:  0.0008301734924316406
local_in_edges_tensor generation:  0.0005156993865966797
mini_batch_src_global generation:  0.0008876323699951172
r_  generation:  0.008020162582397461
local_output_nid generation:  0.0008263587951660156
local_in_edges_tensor generation:  0.0004932880401611328
mini_batch_src_global generation:  0.0008563995361328125
r_  generation:  0.008130550384521484
local_output_nid generation:  0.0008130073547363281
local_in_edges_tensor generation:  0.0005068778991699219
mini_batch_src_global generation:  0.0009906291961669922
r_  generation:  0.008234977722167969
local_output_nid generation:  0.0008084774017333984
local_in_edges_tensor generation:  0.0004916191101074219
mini_batch_src_global generation:  0.0008833408355712891
r_  generation:  0.008204460144042969
local_output_nid generation:  0.0008077621459960938
local_in_edges_tensor generation:  0.00048804283142089844
mini_batch_src_global generation:  0.0008876323699951172
r_  generation:  0.008199930191040039
local_output_nid generation:  0.0008151531219482422
local_in_edges_tensor generation:  0.000507354736328125
mini_batch_src_global generation:  0.0009758472442626953
r_  generation:  0.008180856704711914
local_output_nid generation:  0.0007932186126708984
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0008757114410400391
r_  generation:  0.008140325546264648
local_output_nid generation:  0.0007994174957275391
local_in_edges_tensor generation:  0.0005125999450683594
mini_batch_src_global generation:  0.0009789466857910156
r_  generation:  0.009477376937866211
local_output_nid generation:  0.0008118152618408203
local_in_edges_tensor generation:  0.00048232078552246094
mini_batch_src_global generation:  0.0009229183197021484
r_  generation:  0.008327722549438477
local_output_nid generation:  0.0008122920989990234
local_in_edges_tensor generation:  0.0005297660827636719
mini_batch_src_global generation:  0.0009441375732421875
r_  generation:  0.008497238159179688
local_output_nid generation:  0.0008077621459960938
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0009007453918457031
r_  generation:  0.008150577545166016
local_output_nid generation:  0.0008111000061035156
local_in_edges_tensor generation:  0.00048732757568359375
mini_batch_src_global generation:  0.0009012222290039062
r_  generation:  0.008292198181152344
local_output_nid generation:  0.0008039474487304688
local_in_edges_tensor generation:  0.0004906654357910156
mini_batch_src_global generation:  0.0009031295776367188
r_  generation:  0.008161306381225586
local_output_nid generation:  0.0007956027984619141
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.0008900165557861328
r_  generation:  0.008277177810668945
local_output_nid generation:  0.0007951259613037109
local_in_edges_tensor generation:  0.0005106925964355469
mini_batch_src_global generation:  0.0008769035339355469
r_  generation:  0.008293628692626953
local_output_nid generation:  0.0008018016815185547
local_in_edges_tensor generation:  0.0005130767822265625
mini_batch_src_global generation:  0.0009632110595703125
r_  generation:  0.008555412292480469
local_output_nid generation:  0.0007987022399902344
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.0008742809295654297
r_  generation:  0.008206605911254883
local_output_nid generation:  0.0007898807525634766
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0009067058563232422
r_  generation:  0.008382797241210938
local_output_nid generation:  0.0007917881011962891
local_in_edges_tensor generation:  0.0004849433898925781
mini_batch_src_global generation:  0.0008945465087890625
r_  generation:  0.008287191390991211
local_output_nid generation:  0.0007925033569335938
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0008831024169921875
r_  generation:  0.008255243301391602
local_output_nid generation:  0.0007905960083007812
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0009255409240722656
r_  generation:  0.008414030075073242
local_output_nid generation:  0.0008108615875244141
local_in_edges_tensor generation:  0.0004892349243164062
mini_batch_src_global generation:  0.0008928775787353516
r_  generation:  0.00836324691772461
local_output_nid generation:  0.0007815361022949219
local_in_edges_tensor generation:  0.0004947185516357422
mini_batch_src_global generation:  0.0009737014770507812
r_  generation:  0.008200407028198242
local_output_nid generation:  0.0007958412170410156
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0008752346038818359
r_  generation:  0.008158445358276367
local_output_nid generation:  0.0007834434509277344
local_in_edges_tensor generation:  0.0004794597625732422
mini_batch_src_global generation:  0.0008916854858398438
r_  generation:  0.008300304412841797
local_output_nid generation:  0.0008153915405273438
local_in_edges_tensor generation:  0.0004885196685791016
mini_batch_src_global generation:  0.0008797645568847656
r_  generation:  0.008342266082763672
----------------------check_connections_block total spend ----------------------------- 0.43009066581726074
generate_one_block  0.02064347267150879
generate_one_block  0.01671314239501953
generate_one_block  0.014433145523071289
generate_one_block  0.014641046524047852
generate_one_block  0.014546394348144531
generate_one_block  0.014267683029174805
generate_one_block  0.014441251754760742
generate_one_block  0.014546632766723633
generate_one_block  0.014641761779785156
generate_one_block  0.014451265335083008
generate_one_block  0.014491081237792969
generate_one_block  0.01457834243774414
generate_one_block  0.014371156692504883
generate_one_block  0.015267372131347656
generate_one_block  0.014509916305541992
generate_one_block  0.01477956771850586
generate_one_block  0.014260292053222656
generate_one_block  0.014456510543823242
generate_one_block  0.01436161994934082
generate_one_block  0.014498233795166016
generate_one_block  0.014494657516479492
generate_one_block  0.014788150787353516
generate_one_block  0.016611576080322266
generate_one_block  0.014695167541503906
generate_one_block  0.014409065246582031
generate_one_block  0.01437234878540039
generate_one_block  0.014600276947021484
generate_one_block  0.014412164688110352
generate_one_block  0.014121532440185547
generate_one_block  0.014223098754882812
generate_one_block  0.014535665512084961
generate_one_block  0.014265775680541992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03204679489135742
gen group dst list time:  0.019225358963012695
time for parepare:  0.020020723342895508
local_output_nid generation:  0.004674673080444336
local_in_edges_tensor generation:  0.015436410903930664
mini_batch_src_global generation:  0.01218724250793457
r_  generation:  0.12620329856872559
local_output_nid generation:  0.006562232971191406
local_in_edges_tensor generation:  0.008417606353759766
mini_batch_src_global generation:  0.016067981719970703
r_  generation:  0.15887665748596191
local_output_nid generation:  0.0065615177154541016
local_in_edges_tensor generation:  0.029160499572753906
mini_batch_src_global generation:  0.013935089111328125
r_  generation:  0.1257317066192627
local_output_nid generation:  0.006798744201660156
local_in_edges_tensor generation:  0.008768320083618164
mini_batch_src_global generation:  0.015563488006591797
r_  generation:  0.13109397888183594
local_output_nid generation:  0.007292032241821289
local_in_edges_tensor generation:  0.006879091262817383
mini_batch_src_global generation:  0.015243768692016602
r_  generation:  0.13464713096618652
local_output_nid generation:  0.007307529449462891
local_in_edges_tensor generation:  0.006750583648681641
mini_batch_src_global generation:  0.01546788215637207
r_  generation:  0.13437891006469727
local_output_nid generation:  0.0074465274810791016
local_in_edges_tensor generation:  0.00907278060913086
mini_batch_src_global generation:  0.016492843627929688
r_  generation:  0.1387789249420166
local_output_nid generation:  0.008301019668579102
local_in_edges_tensor generation:  0.008383989334106445
mini_batch_src_global generation:  0.01663684844970703
r_  generation:  0.13914799690246582
local_output_nid generation:  0.007388114929199219
local_in_edges_tensor generation:  0.011554718017578125
mini_batch_src_global generation:  0.017658233642578125
r_  generation:  0.14208388328552246
local_output_nid generation:  0.007408618927001953
local_in_edges_tensor generation:  0.008280754089355469
mini_batch_src_global generation:  0.017049312591552734
r_  generation:  0.14083313941955566
local_output_nid generation:  0.008867979049682617
local_in_edges_tensor generation:  0.0088653564453125
mini_batch_src_global generation:  0.016074657440185547
r_  generation:  0.13967585563659668
local_output_nid generation:  0.007809162139892578
local_in_edges_tensor generation:  0.01035618782043457
mini_batch_src_global generation:  0.016313552856445312
r_  generation:  0.13856887817382812
local_output_nid generation:  0.0103607177734375
local_in_edges_tensor generation:  0.008015155792236328
mini_batch_src_global generation:  0.016422748565673828
r_  generation:  0.13868427276611328
local_output_nid generation:  0.008045434951782227
local_in_edges_tensor generation:  0.01213836669921875
mini_batch_src_global generation:  0.017786741256713867
r_  generation:  0.14353084564208984
local_output_nid generation:  0.007888555526733398
local_in_edges_tensor generation:  0.0074770450592041016
mini_batch_src_global generation:  0.02120375633239746
r_  generation:  0.14402270317077637
local_output_nid generation:  0.009396076202392578
local_in_edges_tensor generation:  0.008658170700073242
mini_batch_src_global generation:  0.0223543643951416
r_  generation:  0.1401221752166748
local_output_nid generation:  0.00793766975402832
local_in_edges_tensor generation:  0.008015632629394531
mini_batch_src_global generation:  0.016113758087158203
r_  generation:  0.13376545906066895
local_output_nid generation:  0.008085966110229492
local_in_edges_tensor generation:  0.00751948356628418
mini_batch_src_global generation:  0.016590356826782227
r_  generation:  0.1369781494140625
local_output_nid generation:  0.00803375244140625
local_in_edges_tensor generation:  0.007326841354370117
mini_batch_src_global generation:  0.016423940658569336
r_  generation:  0.13735413551330566
local_output_nid generation:  0.008053779602050781
local_in_edges_tensor generation:  0.007884502410888672
mini_batch_src_global generation:  0.016650676727294922
r_  generation:  0.1765425205230713
local_output_nid generation:  0.012819290161132812
local_in_edges_tensor generation:  0.010221719741821289
mini_batch_src_global generation:  0.02103400230407715
r_  generation:  0.1873486042022705
local_output_nid generation:  0.010815143585205078
local_in_edges_tensor generation:  0.008681297302246094
mini_batch_src_global generation:  0.029801130294799805
r_  generation:  0.1442394256591797
local_output_nid generation:  0.008844375610351562
local_in_edges_tensor generation:  0.007828950881958008
mini_batch_src_global generation:  0.01895618438720703
r_  generation:  0.13837885856628418
local_output_nid generation:  0.00850057601928711
local_in_edges_tensor generation:  0.0077610015869140625
mini_batch_src_global generation:  0.017224550247192383
r_  generation:  0.13930082321166992
local_output_nid generation:  0.008432626724243164
local_in_edges_tensor generation:  0.007405757904052734
mini_batch_src_global generation:  0.01614093780517578
r_  generation:  0.13805866241455078
local_output_nid generation:  0.008229732513427734
local_in_edges_tensor generation:  0.007765293121337891
mini_batch_src_global generation:  0.01644730567932129
r_  generation:  0.13774657249450684
local_output_nid generation:  0.00832056999206543
local_in_edges_tensor generation:  0.008562564849853516
mini_batch_src_global generation:  0.026981830596923828
r_  generation:  0.16527986526489258
local_output_nid generation:  0.012713432312011719
local_in_edges_tensor generation:  0.011232614517211914
mini_batch_src_global generation:  0.020623445510864258
r_  generation:  0.1797783374786377
local_output_nid generation:  0.010309457778930664
local_in_edges_tensor generation:  0.00823068618774414
mini_batch_src_global generation:  0.021171092987060547
r_  generation:  0.14246511459350586
local_output_nid generation:  0.008812904357910156
local_in_edges_tensor generation:  0.007884740829467773
mini_batch_src_global generation:  0.01750779151916504
r_  generation:  0.14014387130737305
local_output_nid generation:  0.00851893424987793
local_in_edges_tensor generation:  0.009231805801391602
mini_batch_src_global generation:  0.02621746063232422
r_  generation:  0.178696870803833
local_output_nid generation:  0.008827447891235352
local_in_edges_tensor generation:  0.00731348991394043
mini_batch_src_global generation:  0.016929149627685547
r_  generation:  0.1374979019165039
----------------------check_connections_block total spend ----------------------------- 6.905967950820923
generate_one_block  0.1912379264831543
generate_one_block  0.17059874534606934
generate_one_block  0.16991162300109863
generate_one_block  0.17712044715881348
generate_one_block  0.18914365768432617
generate_one_block  0.17058539390563965
generate_one_block  0.17708253860473633
generate_one_block  0.17457056045532227
generate_one_block  0.18796086311340332
generate_one_block  0.18258452415466309
generate_one_block  0.1816420555114746
generate_one_block  0.17467880249023438
generate_one_block  0.17918682098388672
generate_one_block  0.19082927703857422
generate_one_block  0.18208098411560059
generate_one_block  0.181898832321167
generate_one_block  0.17573261260986328
generate_one_block  0.20434236526489258
generate_one_block  0.1817796230316162
generate_one_block  0.18017840385437012
generate_one_block  0.17929577827453613
generate_one_block  0.18343687057495117
generate_one_block  0.1743929386138916
generate_one_block  0.1791846752166748
generate_one_block  0.17639374732971191
generate_one_block  0.1758432388305664
generate_one_block  0.1791374683380127
generate_one_block  0.17904925346374512
generate_one_block  0.1770000457763672
generate_one_block  0.17978787422180176
generate_one_block  0.1799459457397461
generate_one_block  0.18885469436645508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033948421478271484
gen group dst list time:  0.108856201171875
time for parepare:  0.020605087280273438
local_output_nid generation:  0.02302265167236328
local_in_edges_tensor generation:  0.03900408744812012
mini_batch_src_global generation:  0.03698134422302246
r_  generation:  0.39155149459838867
local_output_nid generation:  0.027726173400878906
local_in_edges_tensor generation:  0.03101348876953125
mini_batch_src_global generation:  0.04690408706665039
r_  generation:  0.388200044631958
local_output_nid generation:  0.027531862258911133
local_in_edges_tensor generation:  0.02570629119873047
mini_batch_src_global generation:  0.04503202438354492
r_  generation:  0.39662766456604004
local_output_nid generation:  0.02742910385131836
local_in_edges_tensor generation:  0.025701045989990234
mini_batch_src_global generation:  0.050733089447021484
r_  generation:  0.3962125778198242
local_output_nid generation:  0.027895212173461914
local_in_edges_tensor generation:  0.025651931762695312
mini_batch_src_global generation:  0.046508073806762695
r_  generation:  0.4022207260131836
local_output_nid generation:  0.02705240249633789
local_in_edges_tensor generation:  0.025548219680786133
mini_batch_src_global generation:  0.04747366905212402
r_  generation:  0.3928687572479248
local_output_nid generation:  0.025979042053222656
local_in_edges_tensor generation:  0.025546789169311523
mini_batch_src_global generation:  0.04618382453918457
r_  generation:  0.40245914459228516
local_output_nid generation:  0.02633523941040039
local_in_edges_tensor generation:  0.028382062911987305
mini_batch_src_global generation:  0.04778242111206055
r_  generation:  0.39574646949768066
local_output_nid generation:  0.026485204696655273
local_in_edges_tensor generation:  0.026489734649658203
mini_batch_src_global generation:  0.04667329788208008
r_  generation:  0.40720558166503906
local_output_nid generation:  0.02639603614807129
local_in_edges_tensor generation:  0.02635049819946289
mini_batch_src_global generation:  0.047884225845336914
r_  generation:  0.40108656883239746
local_output_nid generation:  0.028493165969848633
local_in_edges_tensor generation:  0.02927398681640625
mini_batch_src_global generation:  0.04663681983947754
r_  generation:  0.4075443744659424
local_output_nid generation:  0.026648998260498047
local_in_edges_tensor generation:  0.02748274803161621
mini_batch_src_global generation:  0.047884225845336914
r_  generation:  0.4039735794067383
local_output_nid generation:  0.027430295944213867
local_in_edges_tensor generation:  0.02788066864013672
mini_batch_src_global generation:  0.04874777793884277
r_  generation:  0.40535593032836914
local_output_nid generation:  0.0266573429107666
local_in_edges_tensor generation:  0.026821613311767578
mini_batch_src_global generation:  0.04861330986022949
r_  generation:  0.4046742916107178
local_output_nid generation:  0.0266568660736084
local_in_edges_tensor generation:  0.028203487396240234
mini_batch_src_global generation:  0.04678702354431152
r_  generation:  0.41679811477661133
local_output_nid generation:  0.029044628143310547
local_in_edges_tensor generation:  0.0282440185546875
mini_batch_src_global generation:  0.04821920394897461
r_  generation:  0.4009881019592285
local_output_nid generation:  0.026875972747802734
local_in_edges_tensor generation:  0.02563619613647461
mini_batch_src_global generation:  0.04613900184631348
r_  generation:  0.39824604988098145
local_output_nid generation:  0.027409076690673828
local_in_edges_tensor generation:  0.02654409408569336
mini_batch_src_global generation:  0.049588680267333984
r_  generation:  0.41101670265197754
local_output_nid generation:  0.027361392974853516
local_in_edges_tensor generation:  0.029718875885009766
mini_batch_src_global generation:  0.046651363372802734
r_  generation:  0.4075582027435303
local_output_nid generation:  0.027403593063354492
local_in_edges_tensor generation:  0.02477431297302246
mini_batch_src_global generation:  0.047774314880371094
r_  generation:  0.4010798931121826
local_output_nid generation:  0.027230262756347656
local_in_edges_tensor generation:  0.028299808502197266
mini_batch_src_global generation:  0.04844379425048828
r_  generation:  0.40584754943847656
local_output_nid generation:  0.02940988540649414
local_in_edges_tensor generation:  0.029417753219604492
mini_batch_src_global generation:  0.04996466636657715
r_  generation:  0.40301012992858887
local_output_nid generation:  0.02733469009399414
local_in_edges_tensor generation:  0.026287078857421875
mini_batch_src_global generation:  0.048007965087890625
r_  generation:  0.4163479804992676
local_output_nid generation:  0.02781510353088379
local_in_edges_tensor generation:  0.02861642837524414
mini_batch_src_global generation:  0.0484619140625
r_  generation:  0.4074993133544922
local_output_nid generation:  0.028266191482543945
local_in_edges_tensor generation:  0.026598453521728516
mini_batch_src_global generation:  0.048837900161743164
r_  generation:  0.40560007095336914
local_output_nid generation:  0.028260231018066406
local_in_edges_tensor generation:  0.026735782623291016
mini_batch_src_global generation:  0.051044464111328125
r_  generation:  0.3997352123260498
local_output_nid generation:  0.0272524356842041
local_in_edges_tensor generation:  0.02827167510986328
mini_batch_src_global generation:  0.04802298545837402
r_  generation:  0.4023890495300293
local_output_nid generation:  0.027149200439453125
local_in_edges_tensor generation:  0.027033567428588867
mini_batch_src_global generation:  0.04912757873535156
r_  generation:  0.401228666305542
local_output_nid generation:  0.02726125717163086
local_in_edges_tensor generation:  0.024662017822265625
mini_batch_src_global generation:  0.04617595672607422
r_  generation:  0.40494823455810547
local_output_nid generation:  0.0273592472076416
local_in_edges_tensor generation:  0.024761438369750977
mini_batch_src_global generation:  0.04771900177001953
r_  generation:  0.411435604095459
local_output_nid generation:  0.029367923736572266
local_in_edges_tensor generation:  0.02741217613220215
mini_batch_src_global generation:  0.04643702507019043
r_  generation:  0.40667295455932617
local_output_nid generation:  0.026994943618774414
local_in_edges_tensor generation:  0.026582956314086914
mini_batch_src_global generation:  0.04774904251098633
r_  generation:  0.40004682540893555
----------------------check_connections_block total spend ----------------------------- 19.073428869247437
generate_one_block  0.5435161590576172
generate_one_block  0.5309934616088867
generate_one_block  0.524604082107544
generate_one_block  0.5347030162811279
generate_one_block  0.6311056613922119
generate_one_block  0.5372068881988525
generate_one_block  0.5315439701080322
generate_one_block  0.5337941646575928
generate_one_block  0.542395830154419
generate_one_block  0.5371716022491455
generate_one_block  0.5325591564178467
generate_one_block  0.5328271389007568
generate_one_block  0.5261895656585693
generate_one_block  0.5429666042327881
generate_one_block  0.5376710891723633
generate_one_block  0.5377576351165771
generate_one_block  0.5279219150543213
generate_one_block  0.5361266136169434
generate_one_block  0.5358567237854004
generate_one_block  0.5358724594116211
generate_one_block  0.5375475883483887
generate_one_block  0.5414836406707764
generate_one_block  0.5275843143463135
generate_one_block  0.5433394908905029
generate_one_block  0.5462992191314697
generate_one_block  0.533944845199585
generate_one_block  0.5294673442840576
generate_one_block  0.5328352451324463
generate_one_block  0.5309209823608398
generate_one_block  0.5390558242797852
generate_one_block  0.5495240688323975
generate_one_block  0.5296010971069336
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.11973905563354492  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

connection checking time:  25.97939682006836
block generation total time  23.00985598564148
average batch blocks generation time:  0.7190579995512962
block dataloader generation time/epoch 51.392411544919014
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10401630401611328  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.915878772735596  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10290813446044922  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.52268934249878  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1037759780883789  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.36414098739624  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10294342041015625  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.693800926208496  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10392093658447266  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.581356048583984  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10274696350097656  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.399136543273926  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10266447067260742  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.647891521453857  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10300779342651367  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.56491994857788  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503673553466797  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.945972919464111  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10294771194458008  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.695112705230713  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10297203063964844  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.699176788330078  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10314321517944336  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.517829895019531  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10392475128173828  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.570942878723145  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10408306121826172  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.09320640563965  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10500860214233398  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.804635047912598  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1041111946105957  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.947199821472168  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10266399383544922  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.359790325164795  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10396957397460938  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.755677223205566  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10499858856201172  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.7787766456604  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10300111770629883  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.70860481262207  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10382509231567383  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.794946670532227  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10403919219970703  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.99474811553955  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10393905639648438  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.597400665283203  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10433340072631836  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.853948593139648  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10393810272216797  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.603535175323486  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10305643081665039  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.65332317352295  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10289764404296875  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.750434875488281  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.102752685546875  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.684577465057373  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10286521911621094  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.557727813720703  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10286808013916016  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.605311870574951  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10402488708496094  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.785905361175537  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1027975082397461  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.51750373840332  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03752346336841583 |0.011540941894054413 |0.261590912938118 |9.053945541381836e-05 |0.42746350914239883 |0.00586247444152832 |
----------------------------------------------------------pseudo_mini_loss sum 1.265032410621643
Total (block generation + training)time/epoch 75.14934323728085
Training time/epoch 23.67888045310974
Training time without block to device /epoch 23.3095703125
Training time without total dataloading part /epoch 22.05850124359131
load block tensor time/epoch 1.2007508277893066
block to device time/epoch 0.3693101406097412
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  8574774
Number of first layer input nodes during this epoch:  4653763
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.11966896057128906  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027765274047851562
range selection method range initialization spend 0.016321897506713867
time for parepare:  0.017700672149658203
local_output_nid generation:  0.0009055137634277344
local_in_edges_tensor generation:  0.006790637969970703
mini_batch_src_global generation:  0.0016674995422363281
r_  generation:  0.0099334716796875
local_output_nid generation:  0.0009465217590332031
local_in_edges_tensor generation:  0.0006067752838134766
mini_batch_src_global generation:  0.0012052059173583984
r_  generation:  0.00850820541381836
local_output_nid generation:  0.0009081363677978516
local_in_edges_tensor generation:  0.0005526542663574219
mini_batch_src_global generation:  0.0010128021240234375
r_  generation:  0.008078575134277344
local_output_nid generation:  0.0008797645568847656
local_in_edges_tensor generation:  0.0005180835723876953
mini_batch_src_global generation:  0.000949859619140625
r_  generation:  0.008390426635742188
local_output_nid generation:  0.0008687973022460938
local_in_edges_tensor generation:  0.0005004405975341797
mini_batch_src_global generation:  0.000949859619140625
r_  generation:  0.007764339447021484
local_output_nid generation:  0.0008618831634521484
local_in_edges_tensor generation:  0.0005068778991699219
mini_batch_src_global generation:  0.0008955001831054688
r_  generation:  0.008199930191040039
local_output_nid generation:  0.0008146762847900391
local_in_edges_tensor generation:  0.0005009174346923828
mini_batch_src_global generation:  0.0009481906890869141
r_  generation:  0.008155345916748047
local_output_nid generation:  0.0008018016815185547
local_in_edges_tensor generation:  0.0004940032958984375
mini_batch_src_global generation:  0.0009527206420898438
r_  generation:  0.008086204528808594
local_output_nid generation:  0.0008120536804199219
local_in_edges_tensor generation:  0.0005097389221191406
mini_batch_src_global generation:  0.0008912086486816406
r_  generation:  0.008237600326538086
local_output_nid generation:  0.0008051395416259766
local_in_edges_tensor generation:  0.0005085468292236328
mini_batch_src_global generation:  0.0009391307830810547
r_  generation:  0.008354902267456055
local_output_nid generation:  0.0008127689361572266
local_in_edges_tensor generation:  0.0004982948303222656
mini_batch_src_global generation:  0.0009093284606933594
r_  generation:  0.008197546005249023
local_output_nid generation:  0.0008180141448974609
local_in_edges_tensor generation:  0.0005068778991699219
mini_batch_src_global generation:  0.0009336471557617188
r_  generation:  0.009294509887695312
local_output_nid generation:  0.0008177757263183594
local_in_edges_tensor generation:  0.0004966259002685547
mini_batch_src_global generation:  0.0009865760803222656
r_  generation:  0.008103132247924805
local_output_nid generation:  0.0008230209350585938
local_in_edges_tensor generation:  0.0004973411560058594
mini_batch_src_global generation:  0.0009222030639648438
r_  generation:  0.007973194122314453
local_output_nid generation:  0.000820159912109375
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0009331703186035156
r_  generation:  0.008232355117797852
local_output_nid generation:  0.0008361339569091797
local_in_edges_tensor generation:  0.0005028247833251953
mini_batch_src_global generation:  0.0009386539459228516
r_  generation:  0.008157014846801758
local_output_nid generation:  0.0008258819580078125
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.0009396076202392578
r_  generation:  0.008205652236938477
local_output_nid generation:  0.0008044242858886719
local_in_edges_tensor generation:  0.00048279762268066406
mini_batch_src_global generation:  0.0009000301361083984
r_  generation:  0.008196830749511719
local_output_nid generation:  0.0008177757263183594
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0008721351623535156
r_  generation:  0.00811004638671875
local_output_nid generation:  0.00081634521484375
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.000911712646484375
r_  generation:  0.008165359497070312
local_output_nid generation:  0.000804901123046875
local_in_edges_tensor generation:  0.0004925727844238281
mini_batch_src_global generation:  0.0009109973907470703
r_  generation:  0.008161306381225586
local_output_nid generation:  0.0008094310760498047
local_in_edges_tensor generation:  0.0005214214324951172
mini_batch_src_global generation:  0.0009675025939941406
r_  generation:  0.008404254913330078
local_output_nid generation:  0.0008053779602050781
local_in_edges_tensor generation:  0.0004830360412597656
mini_batch_src_global generation:  0.0008797645568847656
r_  generation:  0.00824427604675293
local_output_nid generation:  0.0008065700531005859
local_in_edges_tensor generation:  0.000484466552734375
mini_batch_src_global generation:  0.000888824462890625
r_  generation:  0.008208274841308594
local_output_nid generation:  0.0008027553558349609
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.000881195068359375
r_  generation:  0.008123636245727539
local_output_nid generation:  0.0008146762847900391
local_in_edges_tensor generation:  0.0005030632019042969
mini_batch_src_global generation:  0.0008788108825683594
r_  generation:  0.008159399032592773
local_output_nid generation:  0.0007963180541992188
local_in_edges_tensor generation:  0.0004985332489013672
mini_batch_src_global generation:  0.0009465217590332031
r_  generation:  0.008344650268554688
local_output_nid generation:  0.0008111000061035156
local_in_edges_tensor generation:  0.0005023479461669922
mini_batch_src_global generation:  0.0009918212890625
r_  generation:  0.009522199630737305
local_output_nid generation:  0.0008101463317871094
local_in_edges_tensor generation:  0.0004918575286865234
mini_batch_src_global generation:  0.0009794235229492188
r_  generation:  0.008451700210571289
local_output_nid generation:  0.0008056163787841797
local_in_edges_tensor generation:  0.0005035400390625
mini_batch_src_global generation:  0.0009124279022216797
r_  generation:  0.008021116256713867
local_output_nid generation:  0.0008194446563720703
local_in_edges_tensor generation:  0.0005023479461669922
mini_batch_src_global generation:  0.0009045600891113281
r_  generation:  0.00809168815612793
local_output_nid generation:  0.0007984638214111328
local_in_edges_tensor generation:  0.0004894733428955078
mini_batch_src_global generation:  0.0008912086486816406
r_  generation:  0.008144140243530273
----------------------check_connections_block total spend ----------------------------- 0.431560754776001
generate_one_block  0.020929336547851562
generate_one_block  0.016824007034301758
generate_one_block  0.015166282653808594
generate_one_block  0.015143394470214844
generate_one_block  0.014148950576782227
generate_one_block  0.01450037956237793
generate_one_block  0.01444697380065918
generate_one_block  0.014197826385498047
generate_one_block  0.014539957046508789
generate_one_block  0.014685630798339844
generate_one_block  0.014348030090332031
generate_one_block  0.015100479125976562
generate_one_block  0.014257431030273438
generate_one_block  0.014033317565917969
generate_one_block  0.01417231559753418
generate_one_block  0.014122962951660156
generate_one_block  0.014212369918823242
generate_one_block  0.014176130294799805
generate_one_block  0.014317512512207031
generate_one_block  0.01437520980834961
generate_one_block  0.014403104782104492
generate_one_block  0.014576196670532227
generate_one_block  0.01647806167602539
generate_one_block  0.014512300491333008
generate_one_block  0.014122962951660156
generate_one_block  0.014209270477294922
generate_one_block  0.014426946640014648
generate_one_block  0.01503610610961914
generate_one_block  0.014628887176513672
generate_one_block  0.014121770858764648
generate_one_block  0.014156103134155273
generate_one_block  0.014034032821655273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035523414611816406
gen group dst list time:  0.0270843505859375
time for parepare:  0.025520801544189453
local_output_nid generation:  0.004614114761352539
local_in_edges_tensor generation:  0.01856517791748047
mini_batch_src_global generation:  0.014117002487182617
r_  generation:  0.12233638763427734
local_output_nid generation:  0.00648188591003418
local_in_edges_tensor generation:  0.008559226989746094
mini_batch_src_global generation:  0.017279386520385742
r_  generation:  0.1274418830871582
local_output_nid generation:  0.006803989410400391
local_in_edges_tensor generation:  0.029392719268798828
mini_batch_src_global generation:  0.01685023307800293
r_  generation:  0.13277268409729004
local_output_nid generation:  0.007033824920654297
local_in_edges_tensor generation:  0.009190559387207031
mini_batch_src_global generation:  0.016083240509033203
r_  generation:  0.13495564460754395
local_output_nid generation:  0.0071489810943603516
local_in_edges_tensor generation:  0.008750438690185547
mini_batch_src_global generation:  0.015533447265625
r_  generation:  0.13224530220031738
local_output_nid generation:  0.007163524627685547
local_in_edges_tensor generation:  0.006992340087890625
mini_batch_src_global generation:  0.01569962501525879
r_  generation:  0.13387513160705566
local_output_nid generation:  0.009536504745483398
local_in_edges_tensor generation:  0.007804155349731445
mini_batch_src_global generation:  0.016697406768798828
r_  generation:  0.14101433753967285
local_output_nid generation:  0.007531881332397461
local_in_edges_tensor generation:  0.01011514663696289
mini_batch_src_global generation:  0.01599407196044922
r_  generation:  0.1360776424407959
local_output_nid generation:  0.0073244571685791016
local_in_edges_tensor generation:  0.009286642074584961
mini_batch_src_global generation:  0.019075870513916016
r_  generation:  0.1415386199951172
local_output_nid generation:  0.008169174194335938
local_in_edges_tensor generation:  0.011317729949951172
mini_batch_src_global generation:  0.01925802230834961
r_  generation:  0.1722555160522461
local_output_nid generation:  0.017874479293823242
local_in_edges_tensor generation:  0.012594461441040039
mini_batch_src_global generation:  0.022517681121826172
r_  generation:  0.1741790771484375
local_output_nid generation:  0.008597373962402344
local_in_edges_tensor generation:  0.009782791137695312
mini_batch_src_global generation:  0.017716646194458008
r_  generation:  0.1909186840057373
local_output_nid generation:  0.007950782775878906
local_in_edges_tensor generation:  0.01045846939086914
mini_batch_src_global generation:  0.01863241195678711
r_  generation:  0.14078497886657715
local_output_nid generation:  0.00779414176940918
local_in_edges_tensor generation:  0.008579015731811523
mini_batch_src_global generation:  0.018111228942871094
r_  generation:  0.14057087898254395
local_output_nid generation:  0.00959324836730957
local_in_edges_tensor generation:  0.007397174835205078
mini_batch_src_global generation:  0.018276691436767578
r_  generation:  0.14201092720031738
local_output_nid generation:  0.008125066757202148
local_in_edges_tensor generation:  0.009112358093261719
mini_batch_src_global generation:  0.016139984130859375
r_  generation:  0.13332128524780273
local_output_nid generation:  0.008064508438110352
local_in_edges_tensor generation:  0.0074884891510009766
mini_batch_src_global generation:  0.015972375869750977
r_  generation:  0.13636016845703125
local_output_nid generation:  0.007970094680786133
local_in_edges_tensor generation:  0.007265329360961914
mini_batch_src_global generation:  0.016425609588623047
r_  generation:  0.13546490669250488
local_output_nid generation:  0.008065938949584961
local_in_edges_tensor generation:  0.007988452911376953
mini_batch_src_global generation:  0.016069412231445312
r_  generation:  0.1380002498626709
local_output_nid generation:  0.007978677749633789
local_in_edges_tensor generation:  0.007971048355102539
mini_batch_src_global generation:  0.016515016555786133
r_  generation:  0.1370100975036621
local_output_nid generation:  0.008083105087280273
local_in_edges_tensor generation:  0.00795435905456543
mini_batch_src_global generation:  0.016004085540771484
r_  generation:  0.13880300521850586
local_output_nid generation:  0.008257150650024414
local_in_edges_tensor generation:  0.00831913948059082
mini_batch_src_global generation:  0.017041444778442383
r_  generation:  0.14004898071289062
local_output_nid generation:  0.00795125961303711
local_in_edges_tensor generation:  0.00742793083190918
mini_batch_src_global generation:  0.016231775283813477
r_  generation:  0.13812685012817383
local_output_nid generation:  0.007983922958374023
local_in_edges_tensor generation:  0.00738525390625
mini_batch_src_global generation:  0.016295909881591797
r_  generation:  0.14735960960388184
local_output_nid generation:  0.009696006774902344
local_in_edges_tensor generation:  0.007301807403564453
mini_batch_src_global generation:  0.016170978546142578
r_  generation:  0.13671016693115234
local_output_nid generation:  0.008641719818115234
local_in_edges_tensor generation:  0.00730586051940918
mini_batch_src_global generation:  0.016294002532958984
r_  generation:  0.13690876960754395
local_output_nid generation:  0.00842428207397461
local_in_edges_tensor generation:  0.007977485656738281
mini_batch_src_global generation:  0.01648879051208496
r_  generation:  0.14693832397460938
local_output_nid generation:  0.008660316467285156
local_in_edges_tensor generation:  0.009598255157470703
mini_batch_src_global generation:  0.018215179443359375
r_  generation:  0.15104389190673828
local_output_nid generation:  0.008347272872924805
local_in_edges_tensor generation:  0.007517814636230469
mini_batch_src_global generation:  0.017104148864746094
r_  generation:  0.14678215980529785
local_output_nid generation:  0.008053779602050781
local_in_edges_tensor generation:  0.007267951965332031
mini_batch_src_global generation:  0.016602277755737305
r_  generation:  0.1468493938446045
local_output_nid generation:  0.008214473724365234
local_in_edges_tensor generation:  0.007416486740112305
mini_batch_src_global generation:  0.016007184982299805
r_  generation:  0.14119577407836914
local_output_nid generation:  0.010036230087280273
local_in_edges_tensor generation:  0.008127927780151367
mini_batch_src_global generation:  0.016732454299926758
r_  generation:  0.14008569717407227
----------------------check_connections_block total spend ----------------------------- 6.753258228302002
generate_one_block  0.18870210647583008
generate_one_block  0.18034839630126953
generate_one_block  0.18701624870300293
generate_one_block  0.18720126152038574
generate_one_block  0.18857264518737793
generate_one_block  0.1727917194366455
generate_one_block  0.1798257827758789
generate_one_block  0.17277932167053223
generate_one_block  0.17770600318908691
generate_one_block  0.1802670955657959
generate_one_block  0.1763308048248291
generate_one_block  0.18425202369689941
generate_one_block  0.17667698860168457
generate_one_block  0.17444515228271484
generate_one_block  0.17667818069458008
generate_one_block  0.17360925674438477
generate_one_block  0.17948603630065918
generate_one_block  0.17691421508789062
generate_one_block  0.17655634880065918
generate_one_block  0.18197894096374512
generate_one_block  0.17677783966064453
generate_one_block  0.18309473991394043
generate_one_block  0.17469048500061035
generate_one_block  0.17536306381225586
generate_one_block  0.17252039909362793
generate_one_block  0.17508721351623535
generate_one_block  0.18297982215881348
generate_one_block  0.190443754196167
generate_one_block  0.18535947799682617
generate_one_block  0.17840003967285156
generate_one_block  0.1852266788482666
generate_one_block  0.17551207542419434
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0341799259185791
gen group dst list time:  0.10950541496276855
time for parepare:  0.018039226531982422
local_output_nid generation:  0.022407054901123047
local_in_edges_tensor generation:  0.04854154586791992
mini_batch_src_global generation:  0.036998748779296875
r_  generation:  0.3928561210632324
local_output_nid generation:  0.028675317764282227
local_in_edges_tensor generation:  0.031751155853271484
mini_batch_src_global generation:  0.046460628509521484
r_  generation:  0.39693760871887207
local_output_nid generation:  0.02767658233642578
local_in_edges_tensor generation:  0.031223058700561523
mini_batch_src_global generation:  0.04756927490234375
r_  generation:  0.4066784381866455
local_output_nid generation:  0.028603553771972656
local_in_edges_tensor generation:  0.028082847595214844
mini_batch_src_global generation:  0.04748940467834473
r_  generation:  0.4028635025024414
local_output_nid generation:  0.029633760452270508
local_in_edges_tensor generation:  0.030286550521850586
mini_batch_src_global generation:  0.046596527099609375
r_  generation:  0.40587472915649414
local_output_nid generation:  0.0276334285736084
local_in_edges_tensor generation:  0.028627395629882812
mini_batch_src_global generation:  0.05574679374694824
r_  generation:  0.4013528823852539
local_output_nid generation:  0.0290987491607666
local_in_edges_tensor generation:  0.031960248947143555
mini_batch_src_global generation:  0.048581600189208984
r_  generation:  0.40766096115112305
local_output_nid generation:  0.027013778686523438
local_in_edges_tensor generation:  0.024802207946777344
mini_batch_src_global generation:  0.04930233955383301
r_  generation:  0.39522552490234375
local_output_nid generation:  0.027446985244750977
local_in_edges_tensor generation:  0.025548219680786133
mini_batch_src_global generation:  0.0467531681060791
r_  generation:  0.4048445224761963
local_output_nid generation:  0.02741408348083496
local_in_edges_tensor generation:  0.026359081268310547
mini_batch_src_global generation:  0.04816436767578125
r_  generation:  0.4012608528137207
local_output_nid generation:  0.02702021598815918
local_in_edges_tensor generation:  0.025412797927856445
mini_batch_src_global generation:  0.0461428165435791
r_  generation:  0.4022040367126465
local_output_nid generation:  0.02805471420288086
local_in_edges_tensor generation:  0.02506875991821289
mini_batch_src_global generation:  0.04966020584106445
r_  generation:  0.40561604499816895
local_output_nid generation:  0.02762150764465332
local_in_edges_tensor generation:  0.027651071548461914
mini_batch_src_global generation:  0.04653215408325195
r_  generation:  0.4062814712524414
local_output_nid generation:  0.027211427688598633
local_in_edges_tensor generation:  0.02534770965576172
mini_batch_src_global generation:  0.04713797569274902
r_  generation:  0.398287296295166
local_output_nid generation:  0.028415918350219727
local_in_edges_tensor generation:  0.02638721466064453
mini_batch_src_global generation:  0.0476076602935791
r_  generation:  0.40779662132263184
local_output_nid generation:  0.027306079864501953
local_in_edges_tensor generation:  0.02698993682861328
mini_batch_src_global generation:  0.04789853096008301
r_  generation:  0.39604783058166504
local_output_nid generation:  0.027512788772583008
local_in_edges_tensor generation:  0.025904178619384766
mini_batch_src_global generation:  0.04592299461364746
r_  generation:  0.40355587005615234
local_output_nid generation:  0.027566194534301758
local_in_edges_tensor generation:  0.027240514755249023
mini_batch_src_global generation:  0.047087907791137695
r_  generation:  0.40166807174682617
local_output_nid generation:  0.027529239654541016
local_in_edges_tensor generation:  0.030971527099609375
mini_batch_src_global generation:  0.046152591705322266
r_  generation:  0.4074671268463135
local_output_nid generation:  0.027976274490356445
local_in_edges_tensor generation:  0.02646470069885254
mini_batch_src_global generation:  0.048519134521484375
r_  generation:  0.4020426273345947
local_output_nid generation:  0.027713298797607422
local_in_edges_tensor generation:  0.02604365348815918
mini_batch_src_global generation:  0.04770207405090332
r_  generation:  0.40540575981140137
local_output_nid generation:  0.02799391746520996
local_in_edges_tensor generation:  0.028729915618896484
mini_batch_src_global generation:  0.047832489013671875
r_  generation:  0.40430760383605957
local_output_nid generation:  0.02729654312133789
local_in_edges_tensor generation:  0.0310056209564209
mini_batch_src_global generation:  0.04832339286804199
r_  generation:  0.4176478385925293
local_output_nid generation:  0.028838396072387695
local_in_edges_tensor generation:  0.029382705688476562
mini_batch_src_global generation:  0.04915499687194824
r_  generation:  0.40262699127197266
local_output_nid generation:  0.028400421142578125
local_in_edges_tensor generation:  0.026444673538208008
mini_batch_src_global generation:  0.04620718955993652
r_  generation:  0.4018361568450928
local_output_nid generation:  0.027235984802246094
local_in_edges_tensor generation:  0.02557063102722168
mini_batch_src_global generation:  0.04729914665222168
r_  generation:  0.3962821960449219
local_output_nid generation:  0.027479887008666992
local_in_edges_tensor generation:  0.02854156494140625
mini_batch_src_global generation:  0.04753828048706055
r_  generation:  0.40384984016418457
local_output_nid generation:  0.027918100357055664
local_in_edges_tensor generation:  0.029978513717651367
mini_batch_src_global generation:  0.04802060127258301
r_  generation:  0.4071934223175049
local_output_nid generation:  0.02749800682067871
local_in_edges_tensor generation:  0.026968955993652344
mini_batch_src_global generation:  0.04648756980895996
r_  generation:  0.4052155017852783
local_output_nid generation:  0.027506113052368164
local_in_edges_tensor generation:  0.026409626007080078
mini_batch_src_global generation:  0.04991769790649414
r_  generation:  0.39832472801208496
local_output_nid generation:  0.02738785743713379
local_in_edges_tensor generation:  0.024860143661499023
mini_batch_src_global generation:  0.046257734298706055
r_  generation:  0.41278791427612305
local_output_nid generation:  0.027413368225097656
local_in_edges_tensor generation:  0.026385784149169922
mini_batch_src_global generation:  0.04739952087402344
r_  generation:  0.39937734603881836
----------------------check_connections_block total spend ----------------------------- 19.103118419647217
generate_one_block  0.5421168804168701
generate_one_block  0.5424046516418457
generate_one_block  0.5339536666870117
generate_one_block  0.535247802734375
generate_one_block  0.622887372970581
generate_one_block  0.5259685516357422
generate_one_block  0.5477883815765381
generate_one_block  0.5282638072967529
generate_one_block  0.5337395668029785
generate_one_block  0.5375080108642578
generate_one_block  0.5259139537811279
generate_one_block  0.5426983833312988
generate_one_block  0.5366537570953369
generate_one_block  0.5324137210845947
generate_one_block  0.533376932144165
generate_one_block  0.5297551155090332
generate_one_block  0.5305235385894775
generate_one_block  0.5394206047058105
generate_one_block  0.538914680480957
generate_one_block  0.532477617263794
generate_one_block  0.5310547351837158
generate_one_block  0.54787278175354
generate_one_block  0.5325078964233398
generate_one_block  0.534020185470581
generate_one_block  0.5415856838226318
generate_one_block  0.5309643745422363
generate_one_block  0.5436966419219971
generate_one_block  0.5473904609680176
generate_one_block  0.5324001312255859
generate_one_block  0.538562536239624
generate_one_block  0.5316810607910156
generate_one_block  0.5356636047363281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.11966896057128906  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

connection checking time:  25.85637664794922
block generation total time  22.98702120780945
average batch blocks generation time:  0.7183444127440453
block dataloader generation time/epoch 51.38894757102518
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10282039642333984  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.552209854125977  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10282039642333984  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.528431415557861  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10501527786254883  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.803569793701172  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10410737991333008  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.984529972076416  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1027822494506836  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.408742904663086  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10298490524291992  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.509113311767578  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10501623153686523  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.868489265441895  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10265111923217773  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.45993423461914  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10500478744506836  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.812827587127686  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10419988632202148  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.863058090209961  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10279178619384766  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.543229579925537  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10435247421264648  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.108155727386475  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1049957275390625  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.780556678771973  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10279989242553711  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.60142707824707  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10399723052978516  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.74055814743042  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1030282974243164  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.447463035583496  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10389232635498047  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.581653594970703  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10309076309204102  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.598154067993164  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10399532318115234  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.749424934387207  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10300397872924805  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.688342571258545  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10398292541503906  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.67696475982666  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10422945022583008  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.967771053314209  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10264873504638672  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.602428913116455  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1028437614440918  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.583401203155518  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1027822494506836  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.587946891784668  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1026759147644043  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.536497116088867  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10392284393310547  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.911200523376465  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10439682006835938  GigaBytes
Max Memory Allocated: 16.251891136169434  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.260973930358887  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10504674911499023  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.932118892669678  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10295820236206055  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.532166957855225  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10396766662597656  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.697515964508057  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10299968719482422  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.540415287017822  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03658071160316467 |0.011662296950817108 |0.26086345314979553 |8.973479270935059e-05 |0.4299078658223152 |0.006457090377807617 |
----------------------------------------------------------pseudo_mini_loss sum 1.2480615377426147
Total (block generation + training)time/epoch 75.14302204636967
Training time/epoch 23.70810604095459
Training time without block to device /epoch 23.334912538528442
Training time without total dataloading part /epoch 22.11401081085205
load block tensor time/epoch 1.1705827713012695
block to device time/epoch 0.37319350242614746
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  8577718
Number of first layer input nodes during this epoch:  4655066
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12077808380126953  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022777318954467773
range selection method range initialization spend 0.01308441162109375
time for parepare:  0.02114415168762207
local_output_nid generation:  0.001153707504272461
local_in_edges_tensor generation:  0.00626373291015625
mini_batch_src_global generation:  0.0016977787017822266
r_  generation:  0.008499622344970703
local_output_nid generation:  0.0009672641754150391
local_in_edges_tensor generation:  0.000637054443359375
mini_batch_src_global generation:  0.0015783309936523438
r_  generation:  0.008718490600585938
local_output_nid generation:  0.0009534358978271484
local_in_edges_tensor generation:  0.0006093978881835938
mini_batch_src_global generation:  0.0011265277862548828
r_  generation:  0.008198022842407227
local_output_nid generation:  0.0009179115295410156
local_in_edges_tensor generation:  0.0005614757537841797
mini_batch_src_global generation:  0.0010275840759277344
r_  generation:  0.008126020431518555
local_output_nid generation:  0.0009205341339111328
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.0010221004486083984
r_  generation:  0.008353471755981445
local_output_nid generation:  0.0009086132049560547
local_in_edges_tensor generation:  0.0005559921264648438
mini_batch_src_global generation:  0.0011265277862548828
r_  generation:  0.008113622665405273
local_output_nid generation:  0.0009136199951171875
local_in_edges_tensor generation:  0.0005719661712646484
mini_batch_src_global generation:  0.00115966796875
r_  generation:  0.007996797561645508
local_output_nid generation:  0.0009388923645019531
local_in_edges_tensor generation:  0.0005583763122558594
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.007817506790161133
local_output_nid generation:  0.0009398460388183594
local_in_edges_tensor generation:  0.0005295276641845703
mini_batch_src_global generation:  0.0009319782257080078
r_  generation:  0.008082151412963867
local_output_nid generation:  0.0009067058563232422
local_in_edges_tensor generation:  0.0005552768707275391
mini_batch_src_global generation:  0.0009844303131103516
r_  generation:  0.008242607116699219
local_output_nid generation:  0.0009403228759765625
local_in_edges_tensor generation:  0.0005507469177246094
mini_batch_src_global generation:  0.0010254383087158203
r_  generation:  0.008357524871826172
local_output_nid generation:  0.0009322166442871094
local_in_edges_tensor generation:  0.0005693435668945312
mini_batch_src_global generation:  0.000990152359008789
r_  generation:  0.008215665817260742
local_output_nid generation:  0.0009319782257080078
local_in_edges_tensor generation:  0.0005218982696533203
mini_batch_src_global generation:  0.000988006591796875
r_  generation:  0.008236169815063477
local_output_nid generation:  0.000926971435546875
local_in_edges_tensor generation:  0.0005371570587158203
mini_batch_src_global generation:  0.0009584426879882812
r_  generation:  0.008530855178833008
local_output_nid generation:  0.0009248256683349609
local_in_edges_tensor generation:  0.0005667209625244141
mini_batch_src_global generation:  0.0010187625885009766
r_  generation:  0.008463621139526367
local_output_nid generation:  0.00092315673828125
local_in_edges_tensor generation:  0.0005345344543457031
mini_batch_src_global generation:  0.0009508132934570312
r_  generation:  0.00832509994506836
local_output_nid generation:  0.0009372234344482422
local_in_edges_tensor generation:  0.0005435943603515625
mini_batch_src_global generation:  0.0009529590606689453
r_  generation:  0.008411884307861328
local_output_nid generation:  0.0009138584136962891
local_in_edges_tensor generation:  0.0005257129669189453
mini_batch_src_global generation:  0.0009481906890869141
r_  generation:  0.008410215377807617
local_output_nid generation:  0.0009191036224365234
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.0009839534759521484
r_  generation:  0.008182287216186523
local_output_nid generation:  0.0009226799011230469
local_in_edges_tensor generation:  0.0005567073822021484
mini_batch_src_global generation:  0.0009829998016357422
r_  generation:  0.008149147033691406
local_output_nid generation:  0.0009171962738037109
local_in_edges_tensor generation:  0.00054168701171875
mini_batch_src_global generation:  0.0009515285491943359
r_  generation:  0.008344888687133789
local_output_nid generation:  0.0009207725524902344
local_in_edges_tensor generation:  0.0005443096160888672
mini_batch_src_global generation:  0.0009512901306152344
r_  generation:  0.008304119110107422
local_output_nid generation:  0.0009167194366455078
local_in_edges_tensor generation:  0.0005223751068115234
mini_batch_src_global generation:  0.0009508132934570312
r_  generation:  0.008432626724243164
local_output_nid generation:  0.00092315673828125
local_in_edges_tensor generation:  0.0005209445953369141
mini_batch_src_global generation:  0.0009539127349853516
r_  generation:  0.008349418640136719
local_output_nid generation:  0.0009005069732666016
local_in_edges_tensor generation:  0.00054168701171875
mini_batch_src_global generation:  0.0010225772857666016
r_  generation:  0.008489370346069336
local_output_nid generation:  0.0009210109710693359
local_in_edges_tensor generation:  0.0005440711975097656
mini_batch_src_global generation:  0.0010294914245605469
r_  generation:  0.008574962615966797
local_output_nid generation:  0.0008952617645263672
local_in_edges_tensor generation:  0.0006029605865478516
mini_batch_src_global generation:  0.0009715557098388672
r_  generation:  0.008493900299072266
local_output_nid generation:  0.0009253025054931641
local_in_edges_tensor generation:  0.0005156993865966797
mini_batch_src_global generation:  0.0009613037109375
r_  generation:  0.008437871932983398
local_output_nid generation:  0.0009186267852783203
local_in_edges_tensor generation:  0.0005357265472412109
mini_batch_src_global generation:  0.0009632110595703125
r_  generation:  0.008363008499145508
local_output_nid generation:  0.0008962154388427734
local_in_edges_tensor generation:  0.0005376338958740234
mini_batch_src_global generation:  0.0009496212005615234
r_  generation:  0.00831294059753418
local_output_nid generation:  0.0008950233459472656
local_in_edges_tensor generation:  0.0005273818969726562
mini_batch_src_global generation:  0.0012280941009521484
r_  generation:  0.008568048477172852
local_output_nid generation:  0.0008931159973144531
local_in_edges_tensor generation:  0.0005207061767578125
mini_batch_src_global generation:  0.0009715557098388672
r_  generation:  0.00815272331237793
----------------------check_connections_block total spend ----------------------------- 0.4452059268951416
generate_one_block  0.023154735565185547
generate_one_block  0.019346952438354492
generate_one_block  0.016439437866210938
generate_one_block  0.01539158821105957
generate_one_block  0.015618562698364258
generate_one_block  0.015152931213378906
generate_one_block  0.01477670669555664
generate_one_block  0.014584064483642578
generate_one_block  0.015012025833129883
generate_one_block  0.015202999114990234
generate_one_block  0.01530766487121582
generate_one_block  0.015187501907348633
generate_one_block  0.015115022659301758
generate_one_block  0.015413522720336914
generate_one_block  0.015326738357543945
generate_one_block  0.015246391296386719
generate_one_block  0.014912843704223633
generate_one_block  0.015157461166381836
generate_one_block  0.01485896110534668
generate_one_block  0.014903068542480469
generate_one_block  0.015240192413330078
generate_one_block  0.015170097351074219
generate_one_block  0.018800020217895508
generate_one_block  0.015434503555297852
generate_one_block  0.015374183654785156
generate_one_block  0.01543116569519043
generate_one_block  0.015292167663574219
generate_one_block  0.015108108520507812
generate_one_block  0.01498723030090332
generate_one_block  0.014870882034301758
generate_one_block  0.015282869338989258
generate_one_block  0.014838218688964844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05287361145019531
gen group dst list time:  0.0242154598236084
time for parepare:  0.025632381439208984
local_output_nid generation:  0.00657200813293457
local_in_edges_tensor generation:  0.01636815071105957
mini_batch_src_global generation:  0.012941837310791016
r_  generation:  0.12876319885253906
local_output_nid generation:  0.010300159454345703
local_in_edges_tensor generation:  0.011368274688720703
mini_batch_src_global generation:  0.016435861587524414
r_  generation:  0.13222503662109375
local_output_nid generation:  0.011057853698730469
local_in_edges_tensor generation:  0.04117846488952637
mini_batch_src_global generation:  0.01626443862915039
r_  generation:  0.14177227020263672
local_output_nid generation:  0.012120485305786133
local_in_edges_tensor generation:  0.011776447296142578
mini_batch_src_global generation:  0.01669025421142578
r_  generation:  0.13764095306396484
local_output_nid generation:  0.01405954360961914
local_in_edges_tensor generation:  0.011576175689697266
mini_batch_src_global generation:  0.0220339298248291
r_  generation:  0.1428205966949463
local_output_nid generation:  0.009069442749023438
local_in_edges_tensor generation:  0.008536100387573242
mini_batch_src_global generation:  0.0200958251953125
r_  generation:  0.14252281188964844
local_output_nid generation:  0.008252382278442383
local_in_edges_tensor generation:  0.007424592971801758
mini_batch_src_global generation:  0.01973128318786621
r_  generation:  0.1371626853942871
local_output_nid generation:  0.007375240325927734
local_in_edges_tensor generation:  0.008207559585571289
mini_batch_src_global generation:  0.019226789474487305
r_  generation:  0.13651061058044434
local_output_nid generation:  0.007458925247192383
local_in_edges_tensor generation:  0.0070343017578125
mini_batch_src_global generation:  0.01779937744140625
r_  generation:  0.140181303024292
local_output_nid generation:  0.007683515548706055
local_in_edges_tensor generation:  0.007256269454956055
mini_batch_src_global generation:  0.017431020736694336
r_  generation:  0.1421351432800293
local_output_nid generation:  0.008321523666381836
local_in_edges_tensor generation:  0.0074920654296875
mini_batch_src_global generation:  0.01819133758544922
r_  generation:  0.14379239082336426
local_output_nid generation:  0.008148670196533203
local_in_edges_tensor generation:  0.0069658756256103516
mini_batch_src_global generation:  0.01786351203918457
r_  generation:  0.14097213745117188
local_output_nid generation:  0.008186817169189453
local_in_edges_tensor generation:  0.007114887237548828
mini_batch_src_global generation:  0.018136262893676758
r_  generation:  0.14334630966186523
local_output_nid generation:  0.008385419845581055
local_in_edges_tensor generation:  0.007171154022216797
mini_batch_src_global generation:  0.018798112869262695
r_  generation:  0.1499793529510498
local_output_nid generation:  0.008260726928710938
local_in_edges_tensor generation:  0.008318424224853516
mini_batch_src_global generation:  0.01860785484313965
r_  generation:  0.14921975135803223
local_output_nid generation:  0.008267641067504883
local_in_edges_tensor generation:  0.008621931076049805
mini_batch_src_global generation:  0.02079033851623535
r_  generation:  0.14973115921020508
local_output_nid generation:  0.007974624633789062
local_in_edges_tensor generation:  0.00817108154296875
mini_batch_src_global generation:  0.020789623260498047
r_  generation:  0.1410353183746338
local_output_nid generation:  0.008127450942993164
local_in_edges_tensor generation:  0.008458852767944336
mini_batch_src_global generation:  0.021070480346679688
r_  generation:  0.14853167533874512
local_output_nid generation:  0.008143186569213867
local_in_edges_tensor generation:  0.010279655456542969
mini_batch_src_global generation:  0.02049708366394043
r_  generation:  0.1424269676208496
local_output_nid generation:  0.009026765823364258
local_in_edges_tensor generation:  0.007254362106323242
mini_batch_src_global generation:  0.020748138427734375
r_  generation:  0.14552569389343262
local_output_nid generation:  0.008327484130859375
local_in_edges_tensor generation:  0.010253190994262695
mini_batch_src_global generation:  0.01972365379333496
r_  generation:  0.14690423011779785
local_output_nid generation:  0.008381843566894531
local_in_edges_tensor generation:  0.007941246032714844
mini_batch_src_global generation:  0.03643441200256348
r_  generation:  0.13864850997924805
local_output_nid generation:  0.009564638137817383
local_in_edges_tensor generation:  0.008653879165649414
mini_batch_src_global generation:  0.01613163948059082
r_  generation:  0.1368544101715088
local_output_nid generation:  0.008249759674072266
local_in_edges_tensor generation:  0.007485151290893555
mini_batch_src_global generation:  0.016551971435546875
r_  generation:  0.1353442668914795
local_output_nid generation:  0.008726119995117188
local_in_edges_tensor generation:  0.007570028305053711
mini_batch_src_global generation:  0.01696181297302246
r_  generation:  0.13952326774597168
local_output_nid generation:  0.008678436279296875
local_in_edges_tensor generation:  0.008380651473999023
mini_batch_src_global generation:  0.0166165828704834
r_  generation:  0.13786888122558594
local_output_nid generation:  0.008725881576538086
local_in_edges_tensor generation:  0.007845163345336914
mini_batch_src_global generation:  0.016509294509887695
r_  generation:  0.13888883590698242
local_output_nid generation:  0.00867605209350586
local_in_edges_tensor generation:  0.00789952278137207
mini_batch_src_global generation:  0.016368865966796875
r_  generation:  0.1366724967956543
local_output_nid generation:  0.008645057678222656
local_in_edges_tensor generation:  0.007967233657836914
mini_batch_src_global generation:  0.016300678253173828
r_  generation:  0.1390824317932129
local_output_nid generation:  0.008491039276123047
local_in_edges_tensor generation:  0.007951974868774414
mini_batch_src_global generation:  0.016015291213989258
r_  generation:  0.13379645347595215
local_output_nid generation:  0.008794546127319336
local_in_edges_tensor generation:  0.00754237174987793
mini_batch_src_global generation:  0.016513824462890625
r_  generation:  0.14080572128295898
local_output_nid generation:  0.008577823638916016
local_in_edges_tensor generation:  0.008097410202026367
mini_batch_src_global generation:  0.016193628311157227
r_  generation:  0.13562297821044922
----------------------check_connections_block total spend ----------------------------- 6.785992383956909
generate_one_block  0.17682623863220215
generate_one_block  0.18172240257263184
generate_one_block  0.1828937530517578
generate_one_block  0.17892694473266602
generate_one_block  0.1952648162841797
generate_one_block  0.17685484886169434
generate_one_block  0.17064881324768066
generate_one_block  0.16828608512878418
generate_one_block  0.17595911026000977
generate_one_block  0.1751699447631836
generate_one_block  0.18304920196533203
generate_one_block  0.17402887344360352
generate_one_block  0.17871975898742676
generate_one_block  0.18259549140930176
generate_one_block  0.1832869052886963
generate_one_block  0.17742109298706055
generate_one_block  0.16996288299560547
generate_one_block  0.17734599113464355
generate_one_block  0.1724700927734375
generate_one_block  0.1781611442565918
generate_one_block  0.17926454544067383
generate_one_block  0.1774153709411621
generate_one_block  0.17790842056274414
generate_one_block  0.17412662506103516
generate_one_block  0.1811535358428955
generate_one_block  0.17987418174743652
generate_one_block  0.17946338653564453
generate_one_block  0.17790770530700684
generate_one_block  0.18369293212890625
generate_one_block  0.17130661010742188
generate_one_block  0.18070101737976074
generate_one_block  0.17339754104614258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03380703926086426
gen group dst list time:  0.10894203186035156
time for parepare:  0.02054738998413086
local_output_nid generation:  0.022341489791870117
local_in_edges_tensor generation:  0.04120206832885742
mini_batch_src_global generation:  0.03608417510986328
r_  generation:  0.3811333179473877
local_output_nid generation:  0.027320384979248047
local_in_edges_tensor generation:  0.030910730361938477
mini_batch_src_global generation:  0.04770660400390625
r_  generation:  0.38669633865356445
local_output_nid generation:  0.027227163314819336
local_in_edges_tensor generation:  0.029032468795776367
mini_batch_src_global generation:  0.0450892448425293
r_  generation:  0.3993642330169678
local_output_nid generation:  0.027315855026245117
local_in_edges_tensor generation:  0.02354598045349121
mini_batch_src_global generation:  0.04862046241760254
r_  generation:  0.40082764625549316
local_output_nid generation:  0.027687549591064453
local_in_edges_tensor generation:  0.024482250213623047
mini_batch_src_global generation:  0.0474085807800293
r_  generation:  0.40384554862976074
local_output_nid generation:  0.026767730712890625
local_in_edges_tensor generation:  0.024494647979736328
mini_batch_src_global generation:  0.04738497734069824
r_  generation:  0.39731836318969727
local_output_nid generation:  0.026326894760131836
local_in_edges_tensor generation:  0.025600671768188477
mini_batch_src_global generation:  0.04539084434509277
r_  generation:  0.398113489151001
local_output_nid generation:  0.025847196578979492
local_in_edges_tensor generation:  0.03157353401184082
mini_batch_src_global generation:  0.047171592712402344
r_  generation:  0.3969306945800781
local_output_nid generation:  0.027700424194335938
local_in_edges_tensor generation:  0.029141902923583984
mini_batch_src_global generation:  0.045746564865112305
r_  generation:  0.4024317264556885
local_output_nid generation:  0.026428937911987305
local_in_edges_tensor generation:  0.025591611862182617
mini_batch_src_global generation:  0.04742574691772461
r_  generation:  0.39769506454467773
local_output_nid generation:  0.026297330856323242
local_in_edges_tensor generation:  0.026817798614501953
mini_batch_src_global generation:  0.04788565635681152
r_  generation:  0.4085702896118164
local_output_nid generation:  0.026185989379882812
local_in_edges_tensor generation:  0.02585434913635254
mini_batch_src_global generation:  0.04730939865112305
r_  generation:  0.3938412666320801
local_output_nid generation:  0.026357173919677734
local_in_edges_tensor generation:  0.02752852439880371
mini_batch_src_global generation:  0.045387983322143555
r_  generation:  0.40247058868408203
local_output_nid generation:  0.027240276336669922
local_in_edges_tensor generation:  0.02619624137878418
mini_batch_src_global generation:  0.047022104263305664
r_  generation:  0.39536023139953613
local_output_nid generation:  0.026264429092407227
local_in_edges_tensor generation:  0.025999784469604492
mini_batch_src_global generation:  0.04611039161682129
r_  generation:  0.40287303924560547
local_output_nid generation:  0.026569843292236328
local_in_edges_tensor generation:  0.030129671096801758
mini_batch_src_global generation:  0.04776883125305176
r_  generation:  0.4202704429626465
local_output_nid generation:  0.02729487419128418
local_in_edges_tensor generation:  0.025664091110229492
mini_batch_src_global generation:  0.04744219779968262
r_  generation:  0.3996918201446533
local_output_nid generation:  0.028168678283691406
local_in_edges_tensor generation:  0.02834463119506836
mini_batch_src_global generation:  0.049967288970947266
r_  generation:  0.4054732322692871
local_output_nid generation:  0.02722930908203125
local_in_edges_tensor generation:  0.02615666389465332
mini_batch_src_global generation:  0.04654955863952637
r_  generation:  0.3981513977050781
local_output_nid generation:  0.026909589767456055
local_in_edges_tensor generation:  0.023854732513427734
mini_batch_src_global generation:  0.04748964309692383
r_  generation:  0.39061713218688965
local_output_nid generation:  0.027211427688598633
local_in_edges_tensor generation:  0.02578139305114746
mini_batch_src_global generation:  0.048101186752319336
r_  generation:  0.4001328945159912
local_output_nid generation:  0.026768922805786133
local_in_edges_tensor generation:  0.03069472312927246
mini_batch_src_global generation:  0.04823017120361328
r_  generation:  0.3929593563079834
local_output_nid generation:  0.02670884132385254
local_in_edges_tensor generation:  0.026059627532958984
mini_batch_src_global generation:  0.047269582748413086
r_  generation:  0.3996293544769287
local_output_nid generation:  0.0269777774810791
local_in_edges_tensor generation:  0.026000022888183594
mini_batch_src_global generation:  0.04828453063964844
r_  generation:  0.3921992778778076
local_output_nid generation:  0.027489900588989258
local_in_edges_tensor generation:  0.026179790496826172
mini_batch_src_global generation:  0.04774641990661621
r_  generation:  0.4049713611602783
local_output_nid generation:  0.027019500732421875
local_in_edges_tensor generation:  0.024416685104370117
mini_batch_src_global generation:  0.04889321327209473
r_  generation:  0.39734578132629395
local_output_nid generation:  0.02712082862854004
local_in_edges_tensor generation:  0.024507761001586914
mini_batch_src_global generation:  0.04699230194091797
r_  generation:  0.40351033210754395
local_output_nid generation:  0.027224063873291016
local_in_edges_tensor generation:  0.024727344512939453
mini_batch_src_global generation:  0.04868888854980469
r_  generation:  0.39690518379211426
local_output_nid generation:  0.0272982120513916
local_in_edges_tensor generation:  0.024720191955566406
mini_batch_src_global generation:  0.04676461219787598
r_  generation:  0.4028136730194092
local_output_nid generation:  0.02692580223083496
local_in_edges_tensor generation:  0.025658845901489258
mini_batch_src_global generation:  0.0481870174407959
r_  generation:  0.392136812210083
local_output_nid generation:  0.02721548080444336
local_in_edges_tensor generation:  0.027634382247924805
mini_batch_src_global generation:  0.04663228988647461
r_  generation:  0.40468287467956543
local_output_nid generation:  0.02722454071044922
local_in_edges_tensor generation:  0.027147769927978516
mini_batch_src_global generation:  0.04840278625488281
r_  generation:  0.39580607414245605
----------------------check_connections_block total spend ----------------------------- 18.860934495925903
generate_one_block  0.5320608615875244
generate_one_block  0.5250816345214844
generate_one_block  0.5309021472930908
generate_one_block  0.5198109149932861
generate_one_block  0.6198875904083252
generate_one_block  0.5282037258148193
generate_one_block  0.5255141258239746
generate_one_block  0.5191521644592285
generate_one_block  0.5288000106811523
generate_one_block  0.5269591808319092
generate_one_block  0.5347423553466797
generate_one_block  0.5233967304229736
generate_one_block  0.5288102626800537
generate_one_block  0.5335996150970459
generate_one_block  0.5339994430541992
generate_one_block  0.5315663814544678
generate_one_block  0.521064043045044
generate_one_block  0.5365378856658936
generate_one_block  0.5221085548400879
generate_one_block  0.5232250690460205
generate_one_block  0.5325541496276855
generate_one_block  0.5337541103363037
generate_one_block  0.5380165576934814
generate_one_block  0.5234613418579102
generate_one_block  0.5479469299316406
generate_one_block  0.5370416641235352
generate_one_block  0.5316197872161865
generate_one_block  0.5237197875976562
generate_one_block  0.5344667434692383
generate_one_block  0.5256490707397461
generate_one_block  0.5399694442749023
generate_one_block  0.526944637298584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12077808380126953  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

connection checking time:  25.646926879882812
block generation total time  22.73637318611145
average batch blocks generation time:  0.7105116620659828
block dataloader generation time/epoch 51.36272570821974
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.102813720703125  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.496607780456543  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10410833358764648  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.800971984863281  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10392475128173828  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.954880237579346  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10289525985717773  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.581408500671387  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503625869750977  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.91551685333252  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10314559936523438  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.649356365203857  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10278844833374023  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.391775608062744  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10256004333496094  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.288392543792725  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10398292541503906  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.699339866638184  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10310029983520508  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.628324508666992  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10501861572265625  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.886166095733643  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10267114639282227  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.43934965133667  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10399532318115234  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.706736087799072  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10305595397949219  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.816473007202148  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10381317138671875  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.81372594833374  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1042790412902832  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.80597734451294  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10241222381591797  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.311930656433105  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10405111312866211  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.837034225463867  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1038370132446289  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.474554538726807  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10292387008666992  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.467292785644531  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10399150848388672  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.748763084411621  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10406970977783203  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.858492374420166  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10398292541503906  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.844655513763428  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1030879020690918  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.704111576080322  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503673553466797  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.96911334991455  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10419893264770508  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.89906358718872  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503816604614258  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.910271644592285  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10321712493896484  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.750924587249756  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1050267219543457  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.910820960998535  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10275697708129883  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.453108787536621  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10505008697509766  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.986531257629395  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10329103469848633  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.659237384796143  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03796537220478058 |0.011179737746715546 |0.2642904222011566 |9.045004844665527e-05 |0.42893678694963455 |0.005869865417480469 |
----------------------------------------------------------pseudo_mini_loss sum 1.2402448654174805
Total (block generation + training)time/epoch 75.12024272812738
Training time/epoch 23.81578516960144
Training time without block to device /epoch 23.458033561706543
Training time without total dataloading part /epoch 22.19203495979309
load block tensor time/epoch 1.2148919105529785
block to device time/epoch 0.35775160789489746
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  8581100
Number of first layer input nodes during this epoch:  4655623
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12052726745605469  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026060819625854492
range selection method range initialization spend 0.014582633972167969
time for parepare:  0.023052215576171875
local_output_nid generation:  0.0011031627655029297
local_in_edges_tensor generation:  0.004950046539306641
mini_batch_src_global generation:  0.001980304718017578
r_  generation:  0.008532524108886719
local_output_nid generation:  0.0009212493896484375
local_in_edges_tensor generation:  0.0006432533264160156
mini_batch_src_global generation:  0.0017998218536376953
r_  generation:  0.008916378021240234
local_output_nid generation:  0.0009140968322753906
local_in_edges_tensor generation:  0.0005984306335449219
mini_batch_src_global generation:  0.001249551773071289
r_  generation:  0.007979154586791992
local_output_nid generation:  0.0009481906890869141
local_in_edges_tensor generation:  0.0005881786346435547
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.007936477661132812
local_output_nid generation:  0.0009758472442626953
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0010929107666015625
r_  generation:  0.008067131042480469
local_output_nid generation:  0.0009734630584716797
local_in_edges_tensor generation:  0.0005919933319091797
mini_batch_src_global generation:  0.0011534690856933594
r_  generation:  0.008443593978881836
local_output_nid generation:  0.0009083747863769531
local_in_edges_tensor generation:  0.0006010532379150391
mini_batch_src_global generation:  0.0010960102081298828
r_  generation:  0.00817251205444336
local_output_nid generation:  0.0009064674377441406
local_in_edges_tensor generation:  0.0005815029144287109
mini_batch_src_global generation:  0.0010685920715332031
r_  generation:  0.00819253921508789
local_output_nid generation:  0.0009164810180664062
local_in_edges_tensor generation:  0.0005710124969482422
mini_batch_src_global generation:  0.001009225845336914
r_  generation:  0.008216619491577148
local_output_nid generation:  0.0008862018585205078
local_in_edges_tensor generation:  0.0006031990051269531
mini_batch_src_global generation:  0.0010957717895507812
r_  generation:  0.008626222610473633
local_output_nid generation:  0.0009095668792724609
local_in_edges_tensor generation:  0.0005550384521484375
mini_batch_src_global generation:  0.000982522964477539
r_  generation:  0.008327007293701172
local_output_nid generation:  0.0009036064147949219
local_in_edges_tensor generation:  0.0005774497985839844
mini_batch_src_global generation:  0.0009698867797851562
r_  generation:  0.008285760879516602
local_output_nid generation:  0.0009026527404785156
local_in_edges_tensor generation:  0.0005729198455810547
mini_batch_src_global generation:  0.0010449886322021484
r_  generation:  0.00859975814819336
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.0005595684051513672
mini_batch_src_global generation:  0.0010612010955810547
r_  generation:  0.008442163467407227
local_output_nid generation:  0.0009036064147949219
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.0009610652923583984
r_  generation:  0.008359432220458984
local_output_nid generation:  0.0009160041809082031
local_in_edges_tensor generation:  0.0005712509155273438
mini_batch_src_global generation:  0.0009853839874267578
r_  generation:  0.008194208145141602
local_output_nid generation:  0.0009026527404785156
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.0009860992431640625
r_  generation:  0.00845789909362793
local_output_nid generation:  0.0009102821350097656
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.0010318756103515625
r_  generation:  0.008355140686035156
local_output_nid generation:  0.00089263916015625
local_in_edges_tensor generation:  0.0005800724029541016
mini_batch_src_global generation:  0.0010526180267333984
r_  generation:  0.008671045303344727
local_output_nid generation:  0.0009357929229736328
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.0009779930114746094
r_  generation:  0.008254289627075195
local_output_nid generation:  0.0009264945983886719
local_in_edges_tensor generation:  0.0005750656127929688
mini_batch_src_global generation:  0.0010280609130859375
r_  generation:  0.008256673812866211
local_output_nid generation:  0.0009396076202392578
local_in_edges_tensor generation:  0.0005600452423095703
mini_batch_src_global generation:  0.00101470947265625
r_  generation:  0.00856471061706543
local_output_nid generation:  0.0009393692016601562
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0012617111206054688
r_  generation:  0.008545637130737305
local_output_nid generation:  0.0009596347808837891
local_in_edges_tensor generation:  0.0005657672882080078
mini_batch_src_global generation:  0.001068115234375
r_  generation:  0.009918212890625
local_output_nid generation:  0.0009539127349853516
local_in_edges_tensor generation:  0.0005762577056884766
mini_batch_src_global generation:  0.0010612010955810547
r_  generation:  0.008439064025878906
local_output_nid generation:  0.0009510517120361328
local_in_edges_tensor generation:  0.0005891323089599609
mini_batch_src_global generation:  0.0010418891906738281
r_  generation:  0.008136749267578125
local_output_nid generation:  0.0009431838989257812
local_in_edges_tensor generation:  0.0005631446838378906
mini_batch_src_global generation:  0.0010249614715576172
r_  generation:  0.008218050003051758
local_output_nid generation:  0.0009338855743408203
local_in_edges_tensor generation:  0.0005459785461425781
mini_batch_src_global generation:  0.0010182857513427734
r_  generation:  0.00842738151550293
local_output_nid generation:  0.0009214878082275391
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.0010476112365722656
r_  generation:  0.008360624313354492
local_output_nid generation:  0.0009179115295410156
local_in_edges_tensor generation:  0.0005593299865722656
mini_batch_src_global generation:  0.0009834766387939453
r_  generation:  0.008275032043457031
local_output_nid generation:  0.0009229183197021484
local_in_edges_tensor generation:  0.0005412101745605469
mini_batch_src_global generation:  0.0009953975677490234
r_  generation:  0.008439302444458008
local_output_nid generation:  0.0009067058563232422
local_in_edges_tensor generation:  0.0005600452423095703
mini_batch_src_global generation:  0.0010623931884765625
r_  generation:  0.008182525634765625
----------------------check_connections_block total spend ----------------------------- 0.4519317150115967
generate_one_block  0.023146390914916992
generate_one_block  0.01903390884399414
generate_one_block  0.015772342681884766
generate_one_block  0.015065670013427734
generate_one_block  0.015330076217651367
generate_one_block  0.015651464462280273
generate_one_block  0.03044605255126953
generate_one_block  0.015224218368530273
generate_one_block  0.014678001403808594
generate_one_block  0.015170574188232422
generate_one_block  0.014583110809326172
generate_one_block  0.014810800552368164
generate_one_block  0.014861583709716797
generate_one_block  0.014800071716308594
generate_one_block  0.01435542106628418
generate_one_block  0.014295101165771484
generate_one_block  0.014635324478149414
generate_one_block  0.014550209045410156
generate_one_block  0.014919281005859375
generate_one_block  0.014312982559204102
generate_one_block  0.014245748519897461
generate_one_block  0.014746427536010742
generate_one_block  0.017721891403198242
generate_one_block  0.015245914459228516
generate_one_block  0.01460886001586914
generate_one_block  0.014125823974609375
generate_one_block  0.014292240142822266
generate_one_block  0.014460325241088867
generate_one_block  0.014665842056274414
generate_one_block  0.014325141906738281
generate_one_block  0.014687299728393555
generate_one_block  0.01421356201171875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05836677551269531
gen group dst list time:  0.023710966110229492
time for parepare:  0.022499561309814453
local_output_nid generation:  0.004616498947143555
local_in_edges_tensor generation:  0.014843463897705078
mini_batch_src_global generation:  0.01518392562866211
r_  generation:  0.1228785514831543
local_output_nid generation:  0.006655693054199219
local_in_edges_tensor generation:  0.008552789688110352
mini_batch_src_global generation:  0.021363496780395508
r_  generation:  0.13203167915344238
local_output_nid generation:  0.006779193878173828
local_in_edges_tensor generation:  0.028561830520629883
mini_batch_src_global generation:  0.01865696907043457
r_  generation:  0.1310417652130127
local_output_nid generation:  0.0068585872650146484
local_in_edges_tensor generation:  0.008620738983154297
mini_batch_src_global generation:  0.016449689865112305
r_  generation:  0.1555483341217041
local_output_nid generation:  0.011322975158691406
local_in_edges_tensor generation:  0.010453462600708008
mini_batch_src_global generation:  0.018158435821533203
r_  generation:  0.15769267082214355
local_output_nid generation:  0.010657072067260742
local_in_edges_tensor generation:  0.009401798248291016
mini_batch_src_global generation:  0.026169776916503906
r_  generation:  0.13570904731750488
local_output_nid generation:  0.008022308349609375
local_in_edges_tensor generation:  0.007052421569824219
mini_batch_src_global generation:  0.018030405044555664
r_  generation:  0.13292527198791504
local_output_nid generation:  0.007908821105957031
local_in_edges_tensor generation:  0.007319450378417969
mini_batch_src_global generation:  0.02617669105529785
r_  generation:  0.1506500244140625
local_output_nid generation:  0.011132478713989258
local_in_edges_tensor generation:  0.011252641677856445
mini_batch_src_global generation:  0.019392013549804688
r_  generation:  0.15340900421142578
local_output_nid generation:  0.01172327995300293
local_in_edges_tensor generation:  0.012358427047729492
mini_batch_src_global generation:  0.019874095916748047
r_  generation:  0.15515899658203125
local_output_nid generation:  0.012900590896606445
local_in_edges_tensor generation:  0.009271860122680664
mini_batch_src_global generation:  0.026192188262939453
r_  generation:  0.15336394309997559
local_output_nid generation:  0.011927366256713867
local_in_edges_tensor generation:  0.010680913925170898
mini_batch_src_global generation:  0.018478870391845703
r_  generation:  0.1533830165863037
local_output_nid generation:  0.012111186981201172
local_in_edges_tensor generation:  0.012197732925415039
mini_batch_src_global generation:  0.019940614700317383
r_  generation:  0.1775350570678711
local_output_nid generation:  0.010436534881591797
local_in_edges_tensor generation:  0.008703470230102539
mini_batch_src_global generation:  0.026823043823242188
r_  generation:  0.14551329612731934
local_output_nid generation:  0.008592367172241211
local_in_edges_tensor generation:  0.00746464729309082
mini_batch_src_global generation:  0.019118785858154297
r_  generation:  0.14273333549499512
local_output_nid generation:  0.008238792419433594
local_in_edges_tensor generation:  0.007539510726928711
mini_batch_src_global generation:  0.018982648849487305
r_  generation:  0.14351272583007812
local_output_nid generation:  0.008042335510253906
local_in_edges_tensor generation:  0.00833439826965332
mini_batch_src_global generation:  0.019144058227539062
r_  generation:  0.14420437812805176
local_output_nid generation:  0.008832931518554688
local_in_edges_tensor generation:  0.011322975158691406
mini_batch_src_global generation:  0.01947188377380371
r_  generation:  0.1421959400177002
local_output_nid generation:  0.008094310760498047
local_in_edges_tensor generation:  0.009344816207885742
mini_batch_src_global generation:  0.01796889305114746
r_  generation:  0.18666362762451172
local_output_nid generation:  0.007775068283081055
local_in_edges_tensor generation:  0.008046627044677734
mini_batch_src_global generation:  0.03403186798095703
r_  generation:  0.14158058166503906
local_output_nid generation:  0.007782936096191406
local_in_edges_tensor generation:  0.010611295700073242
mini_batch_src_global generation:  0.018304109573364258
r_  generation:  0.13674521446228027
local_output_nid generation:  0.007963418960571289
local_in_edges_tensor generation:  0.00824427604675293
mini_batch_src_global generation:  0.018124818801879883
r_  generation:  0.14247679710388184
local_output_nid generation:  0.008095264434814453
local_in_edges_tensor generation:  0.00859212875366211
mini_batch_src_global generation:  0.017807722091674805
r_  generation:  0.1525259017944336
local_output_nid generation:  0.010451793670654297
local_in_edges_tensor generation:  0.008526325225830078
mini_batch_src_global generation:  0.02178668975830078
r_  generation:  0.1434636116027832
local_output_nid generation:  0.008099079132080078
local_in_edges_tensor generation:  0.007409572601318359
mini_batch_src_global generation:  0.01647019386291504
r_  generation:  0.13887643814086914
local_output_nid generation:  0.007935762405395508
local_in_edges_tensor generation:  0.0076160430908203125
mini_batch_src_global generation:  0.01592230796813965
r_  generation:  0.13613104820251465
local_output_nid generation:  0.007956266403198242
local_in_edges_tensor generation:  0.007071733474731445
mini_batch_src_global generation:  0.016069889068603516
r_  generation:  0.13721752166748047
local_output_nid generation:  0.008011579513549805
local_in_edges_tensor generation:  0.008213520050048828
mini_batch_src_global generation:  0.02429485321044922
r_  generation:  0.1392652988433838
local_output_nid generation:  0.008131265640258789
local_in_edges_tensor generation:  0.008893489837646484
mini_batch_src_global generation:  0.01644730567932129
r_  generation:  0.14251303672790527
local_output_nid generation:  0.008028030395507812
local_in_edges_tensor generation:  0.007689476013183594
mini_batch_src_global generation:  0.016243457794189453
r_  generation:  0.1381974220275879
local_output_nid generation:  0.008202791213989258
local_in_edges_tensor generation:  0.007751941680908203
mini_batch_src_global generation:  0.01701068878173828
r_  generation:  0.1401972770690918
local_output_nid generation:  0.008030176162719727
local_in_edges_tensor generation:  0.0070667266845703125
mini_batch_src_global generation:  0.016457557678222656
r_  generation:  0.13778424263000488
----------------------check_connections_block total spend ----------------------------- 6.987631797790527
generate_one_block  0.18480730056762695
generate_one_block  0.1760120391845703
generate_one_block  0.1720905303955078
generate_one_block  0.168809175491333
generate_one_block  0.19126510620117188
generate_one_block  0.1775195598602295
generate_one_block  0.17059564590454102
generate_one_block  0.17600178718566895
generate_one_block  0.17804598808288574
generate_one_block  0.1831834316253662
generate_one_block  0.17784595489501953
generate_one_block  0.1775662899017334
generate_one_block  0.1837446689605713
generate_one_block  0.1866917610168457
generate_one_block  0.19231152534484863
generate_one_block  0.17771339416503906
generate_one_block  0.17789101600646973
generate_one_block  0.17884373664855957
generate_one_block  0.18708491325378418
generate_one_block  0.1802206039428711
generate_one_block  0.1719977855682373
generate_one_block  0.18343162536621094
generate_one_block  0.18513083457946777
generate_one_block  0.18680310249328613
generate_one_block  0.17969012260437012
generate_one_block  0.1757063865661621
generate_one_block  0.17595386505126953
generate_one_block  0.18201589584350586
generate_one_block  0.18428754806518555
generate_one_block  0.17461824417114258
generate_one_block  0.18108034133911133
generate_one_block  0.17492914199829102
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03606081008911133
gen group dst list time:  0.1314373016357422
time for parepare:  0.02310466766357422
local_output_nid generation:  0.023854494094848633
local_in_edges_tensor generation:  0.04434037208557129
mini_batch_src_global generation:  0.04350161552429199
r_  generation:  0.38930463790893555
local_output_nid generation:  0.029245615005493164
local_in_edges_tensor generation:  0.031513214111328125
mini_batch_src_global generation:  0.04698348045349121
r_  generation:  0.3899800777435303
local_output_nid generation:  0.028811931610107422
local_in_edges_tensor generation:  0.02551436424255371
mini_batch_src_global generation:  0.04520916938781738
r_  generation:  0.40492820739746094
local_output_nid generation:  0.028478622436523438
local_in_edges_tensor generation:  0.02515888214111328
mini_batch_src_global generation:  0.04676985740661621
r_  generation:  0.39406871795654297
local_output_nid generation:  0.029471874237060547
local_in_edges_tensor generation:  0.026441097259521484
mini_batch_src_global generation:  0.048220157623291016
r_  generation:  0.4183809757232666
local_output_nid generation:  0.0281984806060791
local_in_edges_tensor generation:  0.026134014129638672
mini_batch_src_global generation:  0.05005908012390137
r_  generation:  0.40476465225219727
local_output_nid generation:  0.026973724365234375
local_in_edges_tensor generation:  0.028840065002441406
mini_batch_src_global generation:  0.04851698875427246
r_  generation:  0.4057459831237793
local_output_nid generation:  0.02747821807861328
local_in_edges_tensor generation:  0.026041030883789062
mini_batch_src_global generation:  0.04796290397644043
r_  generation:  0.40460729598999023
local_output_nid generation:  0.02733922004699707
local_in_edges_tensor generation:  0.030569076538085938
mini_batch_src_global generation:  0.046808719635009766
r_  generation:  0.40933656692504883
local_output_nid generation:  0.02749490737915039
local_in_edges_tensor generation:  0.02862381935119629
mini_batch_src_global generation:  0.04882478713989258
r_  generation:  0.4082682132720947
local_output_nid generation:  0.028473854064941406
local_in_edges_tensor generation:  0.02571725845336914
mini_batch_src_global generation:  0.04820060729980469
r_  generation:  0.425976037979126
local_output_nid generation:  0.029579877853393555
local_in_edges_tensor generation:  0.026198863983154297
mini_batch_src_global generation:  0.04820656776428223
r_  generation:  0.3993403911590576
local_output_nid generation:  0.02774190902709961
local_in_edges_tensor generation:  0.02686285972595215
mini_batch_src_global generation:  0.04691481590270996
r_  generation:  0.40578722953796387
local_output_nid generation:  0.02759099006652832
local_in_edges_tensor generation:  0.02778768539428711
mini_batch_src_global generation:  0.047751426696777344
r_  generation:  0.4021594524383545
local_output_nid generation:  0.027689695358276367
local_in_edges_tensor generation:  0.025970458984375
mini_batch_src_global generation:  0.04636216163635254
r_  generation:  0.40314722061157227
local_output_nid generation:  0.0276031494140625
local_in_edges_tensor generation:  0.027757883071899414
mini_batch_src_global generation:  0.047672271728515625
r_  generation:  0.40268516540527344
local_output_nid generation:  0.02770233154296875
local_in_edges_tensor generation:  0.02436208724975586
mini_batch_src_global generation:  0.0465238094329834
r_  generation:  0.4031064510345459
local_output_nid generation:  0.027521133422851562
local_in_edges_tensor generation:  0.025031328201293945
mini_batch_src_global generation:  0.047392845153808594
r_  generation:  0.4103658199310303
local_output_nid generation:  0.027674436569213867
local_in_edges_tensor generation:  0.0282437801361084
mini_batch_src_global generation:  0.048310279846191406
r_  generation:  0.4162740707397461
local_output_nid generation:  0.027208328247070312
local_in_edges_tensor generation:  0.025310039520263672
mini_batch_src_global generation:  0.04927182197570801
r_  generation:  0.4048628807067871
local_output_nid generation:  0.02715444564819336
local_in_edges_tensor generation:  0.028971433639526367
mini_batch_src_global generation:  0.04594135284423828
r_  generation:  0.40479230880737305
local_output_nid generation:  0.02768731117248535
local_in_edges_tensor generation:  0.02974414825439453
mini_batch_src_global generation:  0.050002336502075195
r_  generation:  0.4039764404296875
local_output_nid generation:  0.028022050857543945
local_in_edges_tensor generation:  0.02673053741455078
mini_batch_src_global generation:  0.04677891731262207
r_  generation:  0.41299986839294434
local_output_nid generation:  0.027944564819335938
local_in_edges_tensor generation:  0.030192852020263672
mini_batch_src_global generation:  0.04973340034484863
r_  generation:  0.40721559524536133
local_output_nid generation:  0.027689456939697266
local_in_edges_tensor generation:  0.031096458435058594
mini_batch_src_global generation:  0.04697012901306152
r_  generation:  0.408710241317749
local_output_nid generation:  0.027680158615112305
local_in_edges_tensor generation:  0.025383472442626953
mini_batch_src_global generation:  0.04755878448486328
r_  generation:  0.4028174877166748
local_output_nid generation:  0.027567148208618164
local_in_edges_tensor generation:  0.026361703872680664
mini_batch_src_global generation:  0.04882955551147461
r_  generation:  0.4078090190887451
local_output_nid generation:  0.02749323844909668
local_in_edges_tensor generation:  0.027609825134277344
mini_batch_src_global generation:  0.04813361167907715
r_  generation:  0.4008767604827881
local_output_nid generation:  0.028667211532592773
local_in_edges_tensor generation:  0.027851343154907227
mini_batch_src_global generation:  0.048456430435180664
r_  generation:  0.41031742095947266
local_output_nid generation:  0.02748894691467285
local_in_edges_tensor generation:  0.03081345558166504
mini_batch_src_global generation:  0.04833531379699707
r_  generation:  0.4104175567626953
local_output_nid generation:  0.02949833869934082
local_in_edges_tensor generation:  0.026609420776367188
mini_batch_src_global generation:  0.04720711708068848
r_  generation:  0.40732288360595703
local_output_nid generation:  0.02760457992553711
local_in_edges_tensor generation:  0.02669668197631836
mini_batch_src_global generation:  0.048090457916259766
r_  generation:  0.40400123596191406
----------------------check_connections_block total spend ----------------------------- 19.199191093444824
generate_one_block  0.5383212566375732
generate_one_block  0.5285627841949463
generate_one_block  0.5215990543365479
generate_one_block  0.5210561752319336
generate_one_block  0.6383142471313477
generate_one_block  0.525615930557251
generate_one_block  0.5249326229095459
generate_one_block  0.5488858222961426
generate_one_block  0.5425925254821777
generate_one_block  0.5394105911254883
generate_one_block  0.5365931987762451
generate_one_block  0.5292551517486572
generate_one_block  0.5307304859161377
generate_one_block  0.528918981552124
generate_one_block  0.5364949703216553
generate_one_block  0.5358622074127197
generate_one_block  0.5299208164215088
generate_one_block  0.5282917022705078
generate_one_block  0.5524680614471436
generate_one_block  0.5268604755401611
generate_one_block  0.5240626335144043
generate_one_block  0.5379238128662109
generate_one_block  0.5418694019317627
generate_one_block  0.5394227504730225
generate_one_block  0.548210620880127
generate_one_block  0.5297155380249023
generate_one_block  0.5346169471740723
generate_one_block  0.542400598526001
generate_one_block  0.5507888793945312
generate_one_block  0.5308263301849365
generate_one_block  0.5377156734466553
generate_one_block  0.5320086479187012
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.12052726745605469  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

connection checking time:  26.18682289123535
block generation total time  22.968138217926025
average batch blocks generation time:  0.7177543193101883
block dataloader generation time/epoch 51.38148682995846
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10284090042114258  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.547890186309814  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10276269912719727  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.647864818572998  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10271167755126953  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.421176433563232  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10242605209350586  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.307205200195312  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10278558731079102  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.742915630340576  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1030735969543457  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.629302501678467  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10277748107910156  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.385005950927734  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10298776626586914  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.711869716644287  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10500812530517578  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.806822299957275  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10406780242919922  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.987378597259521  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10299205780029297  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.718339920043945  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10276079177856445  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.720623016357422  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10504388809204102  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.915127277374268  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10256195068359375  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.823015213012695  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1029047966003418  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.652382373809814  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1029958724975586  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.580350875854492  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10389328002929688  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.549734592437744  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10283517837524414  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.578870296478271  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.105072021484375  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.127609729766846  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10298013687133789  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.455542087554932  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1037445068359375  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.347872257232666  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10397863388061523  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.862802505493164  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10504674911499023  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.051677703857422  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1042790412902832  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.09018564224243  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1039438247680664  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.745482921600342  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10286331176757812  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.46546745300293  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10395526885986328  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.604509830474854  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10308599472045898  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.724778652191162  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10503625869750977  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.931052684783936  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10282421112060547  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.593280792236328  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10399961471557617  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.832347869873047  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10299015045166016  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.555522918701172  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0366995632648468 |0.01259671151638031 |0.26354796439409256 |9.269267320632935e-05 |0.43013185262680054 |0.005887508392333984 |
----------------------------------------------------------pseudo_mini_loss sum 1.2220277786254883
Total (block generation + training)time/epoch 75.14309075004176
Training time/epoch 23.83489465713501
Training time without block to device /epoch 23.43179988861084
Training time without total dataloading part /epoch 22.206607818603516
load block tensor time/epoch 1.1743860244750977
block to device time/epoch 0.4030947685241699
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  8573499
Number of first layer input nodes during this epoch:  4651330
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.11968135833740234  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023099660873413086
range selection method range initialization spend 0.018819093704223633
time for parepare:  0.01901721954345703
local_output_nid generation:  0.0009286403656005859
local_in_edges_tensor generation:  0.0061304569244384766
mini_batch_src_global generation:  0.0019028186798095703
r_  generation:  0.010196208953857422
local_output_nid generation:  0.0009365081787109375
local_in_edges_tensor generation:  0.0007464885711669922
mini_batch_src_global generation:  0.0014157295227050781
r_  generation:  0.008595943450927734
local_output_nid generation:  0.0008990764617919922
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.0010077953338623047
r_  generation:  0.007994413375854492
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.000858306884765625
r_  generation:  0.007918834686279297
local_output_nid generation:  0.0008366107940673828
local_in_edges_tensor generation:  0.0004951953887939453
mini_batch_src_global generation:  0.0008347034454345703
r_  generation:  0.007971763610839844
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  0.0008499622344970703
r_  generation:  0.008112430572509766
local_output_nid generation:  0.0008199214935302734
local_in_edges_tensor generation:  0.0004973411560058594
mini_batch_src_global generation:  0.0008451938629150391
r_  generation:  0.008156299591064453
local_output_nid generation:  0.0008075237274169922
local_in_edges_tensor generation:  0.0006587505340576172
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.00841069221496582
local_output_nid generation:  0.0008182525634765625
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0008726119995117188
r_  generation:  0.008133649826049805
local_output_nid generation:  0.0008227825164794922
local_in_edges_tensor generation:  0.0004906654357910156
mini_batch_src_global generation:  0.0008380413055419922
r_  generation:  0.008329391479492188
local_output_nid generation:  0.0007982254028320312
local_in_edges_tensor generation:  0.0004975795745849609
mini_batch_src_global generation:  0.0009407997131347656
r_  generation:  0.008384466171264648
local_output_nid generation:  0.0008053779602050781
local_in_edges_tensor generation:  0.0005071163177490234
mini_batch_src_global generation:  0.0009312629699707031
r_  generation:  0.008426666259765625
local_output_nid generation:  0.0008039474487304688
local_in_edges_tensor generation:  0.0005898475646972656
mini_batch_src_global generation:  0.0008623600006103516
r_  generation:  0.00797581672668457
local_output_nid generation:  0.0008068084716796875
local_in_edges_tensor generation:  0.0005908012390136719
mini_batch_src_global generation:  0.003016233444213867
r_  generation:  0.008485078811645508
local_output_nid generation:  0.000820159912109375
local_in_edges_tensor generation:  0.0005059242248535156
mini_batch_src_global generation:  0.0009386539459228516
r_  generation:  0.00810694694519043
local_output_nid generation:  0.0008254051208496094
local_in_edges_tensor generation:  0.0005319118499755859
mini_batch_src_global generation:  0.0008864402770996094
r_  generation:  0.008112668991088867
local_output_nid generation:  0.0008063316345214844
local_in_edges_tensor generation:  0.0004863739013671875
mini_batch_src_global generation:  0.0008828639984130859
r_  generation:  0.008158206939697266
local_output_nid generation:  0.0007963180541992188
local_in_edges_tensor generation:  0.0005440711975097656
mini_batch_src_global generation:  0.0009179115295410156
r_  generation:  0.008453369140625
local_output_nid generation:  0.0008101463317871094
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.0008921623229980469
r_  generation:  0.008331298828125
local_output_nid generation:  0.0008440017700195312
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0008716583251953125
r_  generation:  0.008347272872924805
local_output_nid generation:  0.0008037090301513672
local_in_edges_tensor generation:  0.0006089210510253906
mini_batch_src_global generation:  0.000896453857421875
r_  generation:  0.008122444152832031
local_output_nid generation:  0.0008015632629394531
local_in_edges_tensor generation:  0.00047469139099121094
mini_batch_src_global generation:  0.0008819103240966797
r_  generation:  0.008404016494750977
local_output_nid generation:  0.0007984638214111328
local_in_edges_tensor generation:  0.0006048679351806641
mini_batch_src_global generation:  0.0008709430694580078
r_  generation:  0.007952690124511719
local_output_nid generation:  0.0008308887481689453
local_in_edges_tensor generation:  0.0005102157592773438
mini_batch_src_global generation:  0.0008766651153564453
r_  generation:  0.009513378143310547
local_output_nid generation:  0.0008137226104736328
local_in_edges_tensor generation:  0.0005006790161132812
mini_batch_src_global generation:  0.0009195804595947266
r_  generation:  0.008314371109008789
local_output_nid generation:  0.0008096694946289062
local_in_edges_tensor generation:  0.0005285739898681641
mini_batch_src_global generation:  0.0008947849273681641
r_  generation:  0.008264541625976562
local_output_nid generation:  0.0008120536804199219
local_in_edges_tensor generation:  0.0004994869232177734
mini_batch_src_global generation:  0.0009107589721679688
r_  generation:  0.008098602294921875
local_output_nid generation:  0.0008287429809570312
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0008761882781982422
r_  generation:  0.007945775985717773
local_output_nid generation:  0.0007982254028320312
local_in_edges_tensor generation:  0.0005252361297607422
mini_batch_src_global generation:  0.0008859634399414062
r_  generation:  0.007988929748535156
local_output_nid generation:  0.0008132457733154297
local_in_edges_tensor generation:  0.00048661231994628906
mini_batch_src_global generation:  0.0008821487426757812
r_  generation:  0.010963916778564453
local_output_nid generation:  0.0008535385131835938
local_in_edges_tensor generation:  0.0006468296051025391
mini_batch_src_global generation:  0.0008988380432128906
r_  generation:  0.008285284042358398
local_output_nid generation:  0.00080108642578125
local_in_edges_tensor generation:  0.0005290508270263672
mini_batch_src_global generation:  0.0008814334869384766
r_  generation:  0.008348941802978516
----------------------check_connections_block total spend ----------------------------- 0.43800854682922363
generate_one_block  0.020548343658447266
generate_one_block  0.01739048957824707
generate_one_block  0.015051126480102539
generate_one_block  0.014544010162353516
generate_one_block  0.014605522155761719
generate_one_block  0.014581441879272461
generate_one_block  0.014488458633422852
generate_one_block  0.014964580535888672
generate_one_block  0.01453542709350586
generate_one_block  0.014735221862792969
generate_one_block  0.017128705978393555
generate_one_block  0.014942407608032227
generate_one_block  0.014144182205200195
generate_one_block  0.01497340202331543
generate_one_block  0.014478921890258789
generate_one_block  0.014424800872802734
generate_one_block  0.014580488204956055
generate_one_block  0.015007257461547852
generate_one_block  0.014708757400512695
generate_one_block  0.014833211898803711
generate_one_block  0.014293909072875977
generate_one_block  0.014728546142578125
generate_one_block  0.016513347625732422
generate_one_block  0.015178442001342773
generate_one_block  0.01604938507080078
generate_one_block  0.014467239379882812
generate_one_block  0.014294624328613281
generate_one_block  0.014015674591064453
generate_one_block  0.013949871063232422
generate_one_block  0.014600992202758789
generate_one_block  0.014518022537231445
generate_one_block  0.014583349227905273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03608274459838867
gen group dst list time:  0.02337956428527832
time for parepare:  0.021839380264282227
local_output_nid generation:  0.004823446273803711
local_in_edges_tensor generation:  0.018371105194091797
mini_batch_src_global generation:  0.014991521835327148
r_  generation:  0.12112998962402344
local_output_nid generation:  0.006710529327392578
local_in_edges_tensor generation:  0.008745193481445312
mini_batch_src_global generation:  0.02239847183227539
r_  generation:  0.16654539108276367
local_output_nid generation:  0.007954120635986328
local_in_edges_tensor generation:  0.03429579734802246
mini_batch_src_global generation:  0.017565011978149414
r_  generation:  0.13436627388000488
local_output_nid generation:  0.00726628303527832
local_in_edges_tensor generation:  0.009258747100830078
mini_batch_src_global generation:  0.017889976501464844
r_  generation:  0.13283991813659668
local_output_nid generation:  0.007525920867919922
local_in_edges_tensor generation:  0.009070158004760742
mini_batch_src_global generation:  0.01866888999938965
r_  generation:  0.13638544082641602
local_output_nid generation:  0.0075244903564453125
local_in_edges_tensor generation:  0.00734400749206543
mini_batch_src_global generation:  0.015996217727661133
r_  generation:  0.13295984268188477
local_output_nid generation:  0.007669210433959961
local_in_edges_tensor generation:  0.006863594055175781
mini_batch_src_global generation:  0.01582956314086914
r_  generation:  0.1340494155883789
local_output_nid generation:  0.007493019104003906
local_in_edges_tensor generation:  0.0073053836822509766
mini_batch_src_global generation:  0.030909299850463867
r_  generation:  0.1608893871307373
local_output_nid generation:  0.008510112762451172
local_in_edges_tensor generation:  0.006991386413574219
mini_batch_src_global generation:  0.016735315322875977
r_  generation:  0.1351480484008789
local_output_nid generation:  0.007838249206542969
local_in_edges_tensor generation:  0.00716090202331543
mini_batch_src_global generation:  0.015858888626098633
r_  generation:  0.13399338722229004
local_output_nid generation:  0.008180618286132812
local_in_edges_tensor generation:  0.008053779602050781
mini_batch_src_global generation:  0.02727675437927246
r_  generation:  0.15683555603027344
local_output_nid generation:  0.011255264282226562
local_in_edges_tensor generation:  0.010265827178955078
mini_batch_src_global generation:  0.032152414321899414
r_  generation:  0.1443006992340088
local_output_nid generation:  0.007894515991210938
local_in_edges_tensor generation:  0.009090900421142578
mini_batch_src_global generation:  0.01592397689819336
r_  generation:  0.13543009757995605
local_output_nid generation:  0.008121252059936523
local_in_edges_tensor generation:  0.011148929595947266
mini_batch_src_global generation:  0.017649173736572266
r_  generation:  0.14293289184570312
local_output_nid generation:  0.007888078689575195
local_in_edges_tensor generation:  0.008427143096923828
mini_batch_src_global generation:  0.016062498092651367
r_  generation:  0.1361527442932129
local_output_nid generation:  0.00800633430480957
local_in_edges_tensor generation:  0.007313728332519531
mini_batch_src_global generation:  0.017808198928833008
r_  generation:  0.1378772258758545
local_output_nid generation:  0.007935762405395508
local_in_edges_tensor generation:  0.0071642398834228516
mini_batch_src_global generation:  0.015954256057739258
r_  generation:  0.1391451358795166
local_output_nid generation:  0.007990121841430664
local_in_edges_tensor generation:  0.008007287979125977
mini_batch_src_global generation:  0.01703786849975586
r_  generation:  0.14288735389709473
local_output_nid generation:  0.008141517639160156
local_in_edges_tensor generation:  0.008321523666381836
mini_batch_src_global generation:  0.016837596893310547
r_  generation:  0.14455819129943848
local_output_nid generation:  0.008103132247924805
local_in_edges_tensor generation:  0.007458925247192383
mini_batch_src_global generation:  0.016814470291137695
r_  generation:  0.14389729499816895
local_output_nid generation:  0.00867462158203125
local_in_edges_tensor generation:  0.008295297622680664
mini_batch_src_global generation:  0.016587018966674805
r_  generation:  0.14204668998718262
local_output_nid generation:  0.008216381072998047
local_in_edges_tensor generation:  0.011042356491088867
mini_batch_src_global generation:  0.017096519470214844
r_  generation:  0.14047670364379883
local_output_nid generation:  0.007849454879760742
local_in_edges_tensor generation:  0.009338855743408203
mini_batch_src_global generation:  0.016222715377807617
r_  generation:  0.13659071922302246
local_output_nid generation:  0.008301496505737305
local_in_edges_tensor generation:  0.008082866668701172
mini_batch_src_global generation:  0.017727136611938477
r_  generation:  0.14300870895385742
local_output_nid generation:  0.008039712905883789
local_in_edges_tensor generation:  0.007920026779174805
mini_batch_src_global generation:  0.016857624053955078
r_  generation:  0.1393442153930664
local_output_nid generation:  0.007921218872070312
local_in_edges_tensor generation:  0.008509397506713867
mini_batch_src_global generation:  0.016579866409301758
r_  generation:  0.1370069980621338
local_output_nid generation:  0.008172988891601562
local_in_edges_tensor generation:  0.007410287857055664
mini_batch_src_global generation:  0.016202211380004883
r_  generation:  0.14017844200134277
local_output_nid generation:  0.00795435905456543
local_in_edges_tensor generation:  0.007325172424316406
mini_batch_src_global generation:  0.016472816467285156
r_  generation:  0.13571929931640625
local_output_nid generation:  0.007889270782470703
local_in_edges_tensor generation:  0.007202625274658203
mini_batch_src_global generation:  0.01576852798461914
r_  generation:  0.13454627990722656
local_output_nid generation:  0.008203983306884766
local_in_edges_tensor generation:  0.007566690444946289
mini_batch_src_global generation:  0.016624927520751953
r_  generation:  0.14017629623413086
local_output_nid generation:  0.008184671401977539
local_in_edges_tensor generation:  0.007359027862548828
mini_batch_src_global generation:  0.0181427001953125
r_  generation:  0.14310646057128906
local_output_nid generation:  0.00820612907409668
local_in_edges_tensor generation:  0.008121728897094727
mini_batch_src_global generation:  0.019969940185546875
r_  generation:  0.14206695556640625
----------------------check_connections_block total spend ----------------------------- 6.7161829471588135
generate_one_block  0.18580317497253418
generate_one_block  0.17777633666992188
generate_one_block  0.1743299961090088
generate_one_block  0.1759939193725586
generate_one_block  0.19396162033081055
generate_one_block  0.17597723007202148
generate_one_block  0.1745293140411377
generate_one_block  0.18013858795166016
generate_one_block  0.17628026008605957
generate_one_block  0.17825102806091309
generate_one_block  0.18303179740905762
generate_one_block  0.18177175521850586
generate_one_block  0.16950440406799316
generate_one_block  0.18323349952697754
generate_one_block  0.17164039611816406
generate_one_block  0.17685246467590332
generate_one_block  0.17804503440856934
generate_one_block  0.18170762062072754
generate_one_block  0.17926955223083496
generate_one_block  0.18340063095092773
generate_one_block  0.17595124244689941
generate_one_block  0.18185830116271973
generate_one_block  0.17676949501037598
generate_one_block  0.18613696098327637
generate_one_block  0.17732882499694824
generate_one_block  0.17588233947753906
generate_one_block  0.1776561737060547
generate_one_block  0.1712343692779541
generate_one_block  0.16968345642089844
generate_one_block  0.18166255950927734
generate_one_block  0.1766185760498047
generate_one_block  0.1801435947418213
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03584694862365723
gen group dst list time:  0.10554099082946777
time for parepare:  0.01987743377685547
local_output_nid generation:  0.02240920066833496
local_in_edges_tensor generation:  0.04190397262573242
mini_batch_src_global generation:  0.03672146797180176
r_  generation:  0.395460844039917
local_output_nid generation:  0.027592182159423828
local_in_edges_tensor generation:  0.031505584716796875
mini_batch_src_global generation:  0.04672527313232422
r_  generation:  0.3956451416015625
local_output_nid generation:  0.02774643898010254
local_in_edges_tensor generation:  0.029957294464111328
mini_batch_src_global generation:  0.04495120048522949
r_  generation:  0.40406036376953125
local_output_nid generation:  0.028075456619262695
local_in_edges_tensor generation:  0.027616024017333984
mini_batch_src_global generation:  0.04917573928833008
r_  generation:  0.4008142948150635
local_output_nid generation:  0.028735876083374023
local_in_edges_tensor generation:  0.03173351287841797
mini_batch_src_global generation:  0.04842519760131836
r_  generation:  0.41258978843688965
local_output_nid generation:  0.029120683670043945
local_in_edges_tensor generation:  0.032805681228637695
mini_batch_src_global generation:  0.04860687255859375
r_  generation:  0.4022634029388428
local_output_nid generation:  0.02878260612487793
local_in_edges_tensor generation:  0.029013395309448242
mini_batch_src_global generation:  0.046102285385131836
r_  generation:  0.40767788887023926
local_output_nid generation:  0.026724815368652344
local_in_edges_tensor generation:  0.029703140258789062
mini_batch_src_global generation:  0.05650067329406738
r_  generation:  0.40488100051879883
local_output_nid generation:  0.028725624084472656
local_in_edges_tensor generation:  0.027425050735473633
mini_batch_src_global generation:  0.04640650749206543
r_  generation:  0.40737152099609375
local_output_nid generation:  0.02713775634765625
local_in_edges_tensor generation:  0.02845144271850586
mini_batch_src_global generation:  0.04742288589477539
r_  generation:  0.39801716804504395
local_output_nid generation:  0.027511119842529297
local_in_edges_tensor generation:  0.025057315826416016
mini_batch_src_global generation:  0.048093318939208984
r_  generation:  0.40854787826538086
local_output_nid generation:  0.027581453323364258
local_in_edges_tensor generation:  0.026759624481201172
mini_batch_src_global generation:  0.04974842071533203
r_  generation:  0.4036421775817871
local_output_nid generation:  0.026847362518310547
local_in_edges_tensor generation:  0.027252197265625
mini_batch_src_global generation:  0.04586625099182129
r_  generation:  0.41294217109680176
local_output_nid generation:  0.027418136596679688
local_in_edges_tensor generation:  0.025523662567138672
mini_batch_src_global generation:  0.047701358795166016
r_  generation:  0.40755438804626465
local_output_nid generation:  0.02720475196838379
local_in_edges_tensor generation:  0.025902271270751953
mini_batch_src_global generation:  0.04613947868347168
r_  generation:  0.4073472023010254
local_output_nid generation:  0.027199506759643555
local_in_edges_tensor generation:  0.02649998664855957
mini_batch_src_global generation:  0.0492095947265625
r_  generation:  0.40410542488098145
local_output_nid generation:  0.027443647384643555
local_in_edges_tensor generation:  0.028987407684326172
mini_batch_src_global generation:  0.04678964614868164
r_  generation:  0.4159820079803467
local_output_nid generation:  0.027538299560546875
local_in_edges_tensor generation:  0.028954029083251953
mini_batch_src_global generation:  0.04857993125915527
r_  generation:  0.40524792671203613
local_output_nid generation:  0.02844095230102539
local_in_edges_tensor generation:  0.026085376739501953
mini_batch_src_global generation:  0.047158241271972656
r_  generation:  0.4125680923461914
local_output_nid generation:  0.027601003646850586
local_in_edges_tensor generation:  0.026975393295288086
mini_batch_src_global generation:  0.04837679862976074
r_  generation:  0.4041898250579834
local_output_nid generation:  0.027465343475341797
local_in_edges_tensor generation:  0.030910968780517578
mini_batch_src_global generation:  0.04674887657165527
r_  generation:  0.40985107421875
local_output_nid generation:  0.027766942977905273
local_in_edges_tensor generation:  0.02691173553466797
mini_batch_src_global generation:  0.0485234260559082
r_  generation:  0.40407514572143555
local_output_nid generation:  0.0289156436920166
local_in_edges_tensor generation:  0.031186342239379883
mini_batch_src_global generation:  0.046848297119140625
r_  generation:  0.40369415283203125
local_output_nid generation:  0.027852773666381836
local_in_edges_tensor generation:  0.025113821029663086
mini_batch_src_global generation:  0.05035400390625
r_  generation:  0.41034579277038574
local_output_nid generation:  0.031327009201049805
local_in_edges_tensor generation:  0.0323176383972168
mini_batch_src_global generation:  0.05711555480957031
r_  generation:  0.4115176200866699
local_output_nid generation:  0.028650283813476562
local_in_edges_tensor generation:  0.028169631958007812
mini_batch_src_global generation:  0.048789024353027344
r_  generation:  0.39983296394348145
local_output_nid generation:  0.027476072311401367
local_in_edges_tensor generation:  0.026787281036376953
mini_batch_src_global generation:  0.047210693359375
r_  generation:  0.4078786373138428
local_output_nid generation:  0.027689218521118164
local_in_edges_tensor generation:  0.02501535415649414
mini_batch_src_global generation:  0.04997110366821289
r_  generation:  0.3983640670776367
local_output_nid generation:  0.02737593650817871
local_in_edges_tensor generation:  0.024944067001342773
mini_batch_src_global generation:  0.046976566314697266
r_  generation:  0.40358710289001465
local_output_nid generation:  0.027545452117919922
local_in_edges_tensor generation:  0.025345325469970703
mini_batch_src_global generation:  0.049990177154541016
r_  generation:  0.3985123634338379
local_output_nid generation:  0.02755427360534668
local_in_edges_tensor generation:  0.028253555297851562
mini_batch_src_global generation:  0.04763054847717285
r_  generation:  0.40964579582214355
local_output_nid generation:  0.027787208557128906
local_in_edges_tensor generation:  0.02514934539794922
mini_batch_src_global generation:  0.050187110900878906
r_  generation:  0.4136471748352051
----------------------check_connections_block total spend ----------------------------- 19.226390600204468
generate_one_block  0.5444345474243164
generate_one_block  0.5250146389007568
generate_one_block  0.5263524055480957
generate_one_block  0.5367155075073242
generate_one_block  0.6379735469818115
generate_one_block  0.5310063362121582
generate_one_block  0.5295491218566895
generate_one_block  0.5386161804199219
generate_one_block  0.5402631759643555
generate_one_block  0.5333001613616943
generate_one_block  0.5402095317840576
generate_one_block  0.5426838397979736
generate_one_block  0.5355191230773926
generate_one_block  0.5492086410522461
generate_one_block  0.5307948589324951
generate_one_block  0.5371499061584473
generate_one_block  0.5459229946136475
generate_one_block  0.5402019023895264
generate_one_block  0.5462548732757568
generate_one_block  0.5496103763580322
generate_one_block  0.529897928237915
generate_one_block  0.5368571281433105
generate_one_block  0.5236437320709229
generate_one_block  0.5439662933349609
generate_one_block  0.5509662628173828
generate_one_block  0.5340960025787354
generate_one_block  0.5282433032989502
generate_one_block  0.5410444736480713
generate_one_block  0.5300197601318359
generate_one_block  0.5469045639038086
generate_one_block  0.534203052520752
generate_one_block  0.543137788772583
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.11968135833740234  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

connection checking time:  25.94257354736328
block generation total time  23.016186475753784
average batch blocks generation time:  0.7192558273673058
block dataloader generation time/epoch 51.386640179157254
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10387754440307617  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.523513317108154  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10279464721679688  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.6906099319458  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1038961410522461  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.579690933227539  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10290002822875977  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.625721454620361  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10396289825439453  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.8285231590271  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10281896591186523  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.558413028717041  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10253000259399414  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.58078384399414  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10425424575805664  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.84468126296997  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10283994674682617  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.666853427886963  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10281944274902344  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.503640174865723  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1050267219543457  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.81735372543335  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1041860580444336  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.867800235748291  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10263824462890625  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.304540634155273  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10436105728149414  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.0483078956604  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10382938385009766  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.519908428192139  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10329103469848633  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.728145122528076  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10399532318115234  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.709650993347168  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1040048599243164  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.927292346954346  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10398340225219727  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.833438396453857  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10417842864990234  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.880182266235352  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10273075103759766  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.669427394866943  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10406827926635742  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.83651876449585  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10374832153320312  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.379246234893799  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1042642593383789  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 16.06173610687256  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10397911071777344  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.670174598693848  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10297155380249023  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.710734844207764  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10298728942871094  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.728102684020996  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.1029820442199707  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.542074203491211  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10276412963867188  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.35141658782959  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10379505157470703  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.820035457611084  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10398197174072266  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.698034763336182  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 0.10442304611206055  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4178466796875 GB
    Memory Allocated: 15.877608299255371  GigaBytes
Max Memory Allocated: 16.29273271560669  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.036719754338264465 |0.01070527732372284 |0.2622503340244293 |9.168684482574463e-05 |0.42990894615650177 |0.0055370330810546875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2107683420181274
Total (block generation + training)time/epoch 75.14651194810867
Training time/epoch 23.726721048355103
Training time without block to device /epoch 23.38415217399597
Training time without total dataloading part /epoch 22.157567977905273
load block tensor time/epoch 1.175032138824463
block to device time/epoch 0.34256887435913086
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  8576428
Number of first layer input nodes during this epoch:  4654260
