Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647800200.5932672
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025766849517822266
range selection method range initialization spend 0.013887166976928711
time for parepare:  0.017923355102539062
local_output_nid generation:  0.0006990432739257812
local_in_edges_tensor generation:  0.002946615219116211
mini_batch_src_global generation:  0.0015399456024169922
r_  generation:  0.011185646057128906
local_output_nid generation:  0.0007998943328857422
local_in_edges_tensor generation:  0.0006074905395507812
mini_batch_src_global generation:  0.0015103816986083984
r_  generation:  0.009757041931152344
local_output_nid generation:  0.0008130073547363281
local_in_edges_tensor generation:  0.0005230903625488281
mini_batch_src_global generation:  0.000997781753540039
r_  generation:  0.009278297424316406
local_output_nid generation:  0.0007624626159667969
local_in_edges_tensor generation:  0.0005104541778564453
mini_batch_src_global generation:  0.0008754730224609375
r_  generation:  0.008776664733886719
local_output_nid generation:  0.0007605552673339844
local_in_edges_tensor generation:  0.0004961490631103516
mini_batch_src_global generation:  0.0008785724639892578
r_  generation:  0.00929117202758789
local_output_nid generation:  0.0007572174072265625
local_in_edges_tensor generation:  0.0005104541778564453
mini_batch_src_global generation:  0.0009176731109619141
r_  generation:  0.009451866149902344
local_output_nid generation:  0.0007505416870117188
local_in_edges_tensor generation:  0.00048041343688964844
mini_batch_src_global generation:  0.0009188652038574219
r_  generation:  0.009378433227539062
local_output_nid generation:  0.0007481575012207031
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009443759918212891
r_  generation:  0.010006427764892578
local_output_nid generation:  0.0008037090301513672
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0009417533874511719
r_  generation:  0.009606361389160156
local_output_nid generation:  0.0007662773132324219
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.0009739398956298828
r_  generation:  0.009767293930053711
local_output_nid generation:  0.0007567405700683594
local_in_edges_tensor generation:  0.0004892349243164062
mini_batch_src_global generation:  0.001024484634399414
r_  generation:  0.010082006454467773
local_output_nid generation:  0.0007500648498535156
local_in_edges_tensor generation:  0.0004839897155761719
mini_batch_src_global generation:  0.0010449886322021484
r_  generation:  0.01001429557800293
local_output_nid generation:  0.000762939453125
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0010023117065429688
r_  generation:  0.010086297988891602
local_output_nid generation:  0.0007648468017578125
local_in_edges_tensor generation:  0.0004870891571044922
mini_batch_src_global generation:  0.0010437965393066406
r_  generation:  0.010195255279541016
local_output_nid generation:  0.0007610321044921875
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.0010211467742919922
r_  generation:  0.010545969009399414
local_output_nid generation:  0.0007710456848144531
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.001020193099975586
r_  generation:  0.009943723678588867
local_output_nid generation:  0.0007710456848144531
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0010192394256591797
r_  generation:  0.009613037109375
local_output_nid generation:  0.0007681846618652344
local_in_edges_tensor generation:  0.0004963874816894531
mini_batch_src_global generation:  0.0010578632354736328
r_  generation:  0.010390043258666992
local_output_nid generation:  0.0007719993591308594
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0010235309600830078
r_  generation:  0.009834051132202148
local_output_nid generation:  0.0007627010345458984
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009732246398925781
r_  generation:  0.009816408157348633
local_output_nid generation:  0.0007677078247070312
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0009875297546386719
r_  generation:  0.00988316535949707
local_output_nid generation:  0.0007674694061279297
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.0010190010070800781
r_  generation:  0.010246515274047852
local_output_nid generation:  0.0007479190826416016
local_in_edges_tensor generation:  0.0004894733428955078
mini_batch_src_global generation:  0.0009808540344238281
r_  generation:  0.010013341903686523
local_output_nid generation:  0.00075531005859375
local_in_edges_tensor generation:  0.0004897117614746094
mini_batch_src_global generation:  0.0009572505950927734
r_  generation:  0.009797811508178711
local_output_nid generation:  0.0007748603820800781
local_in_edges_tensor generation:  0.0004754066467285156
mini_batch_src_global generation:  0.0010349750518798828
r_  generation:  0.010167360305786133
local_output_nid generation:  0.0007631778717041016
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.0010216236114501953
r_  generation:  0.010158300399780273
local_output_nid generation:  0.0007562637329101562
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.0010042190551757812
r_  generation:  0.009807348251342773
local_output_nid generation:  0.0007567405700683594
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0010023117065429688
r_  generation:  0.00992894172668457
local_output_nid generation:  0.0007498264312744141
local_in_edges_tensor generation:  0.0004737377166748047
mini_batch_src_global generation:  0.0009870529174804688
r_  generation:  0.010146141052246094
local_output_nid generation:  0.0007529258728027344
local_in_edges_tensor generation:  0.004284858703613281
mini_batch_src_global generation:  0.0011777877807617188
r_  generation:  0.00989222526550293
local_output_nid generation:  0.00081634521484375
local_in_edges_tensor generation:  0.0005011558532714844
mini_batch_src_global generation:  0.0010597705841064453
r_  generation:  0.009679555892944336
local_output_nid generation:  0.0007796287536621094
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0010418891906738281
r_  generation:  0.010312795639038086
----------------------check_connections_block total spend ----------------------------- 0.48792338371276855
generate_one_block  0.015596151351928711
generate_one_block  0.015094995498657227
generate_one_block  0.014704227447509766
generate_one_block  0.013805150985717773
generate_one_block  0.014559030532836914
generate_one_block  0.01444864273071289
generate_one_block  0.014384269714355469
generate_one_block  0.015200376510620117
generate_one_block  0.014486551284790039
generate_one_block  0.015050411224365234
generate_one_block  0.015025615692138672
generate_one_block  0.015162467956542969
generate_one_block  0.014901399612426758
generate_one_block  0.015386581420898438
generate_one_block  0.015461444854736328
generate_one_block  0.014519214630126953
generate_one_block  0.014536857604980469
generate_one_block  0.015535116195678711
generate_one_block  0.014563322067260742
generate_one_block  0.01463770866394043
generate_one_block  0.014885902404785156
generate_one_block  0.015076637268066406
generate_one_block  0.014387845993041992
generate_one_block  0.014106512069702148
generate_one_block  0.014991521835327148
generate_one_block  0.014868974685668945
generate_one_block  0.014669179916381836
generate_one_block  0.01487112045288086
generate_one_block  0.014815092086791992
generate_one_block  0.014304399490356445
generate_one_block  0.014460086822509766
generate_one_block  0.014988422393798828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03809356689453125
gen group dst list time:  0.023715734481811523
time for parepare:  0.019332170486450195
local_output_nid generation:  0.004364013671875
local_in_edges_tensor generation:  0.011064529418945312
mini_batch_src_global generation:  0.013909578323364258
r_  generation:  0.1365499496459961
local_output_nid generation:  0.0075206756591796875
local_in_edges_tensor generation:  0.01229238510131836
mini_batch_src_global generation:  0.016865253448486328
r_  generation:  0.13967084884643555
local_output_nid generation:  0.007812976837158203
local_in_edges_tensor generation:  0.00760340690612793
mini_batch_src_global generation:  0.015811681747436523
r_  generation:  0.14474248886108398
local_output_nid generation:  0.007197380065917969
local_in_edges_tensor generation:  0.007304668426513672
mini_batch_src_global generation:  0.015541791915893555
r_  generation:  0.14150691032409668
local_output_nid generation:  0.007727384567260742
local_in_edges_tensor generation:  0.01051950454711914
mini_batch_src_global generation:  0.017650127410888672
r_  generation:  0.1522965431213379
local_output_nid generation:  0.007717609405517578
local_in_edges_tensor generation:  0.007756233215332031
mini_batch_src_global generation:  0.017737865447998047
r_  generation:  0.1484830379486084
local_output_nid generation:  0.007685184478759766
local_in_edges_tensor generation:  0.007752895355224609
mini_batch_src_global generation:  0.018131494522094727
r_  generation:  0.15043210983276367
local_output_nid generation:  0.008230924606323242
local_in_edges_tensor generation:  0.010522842407226562
mini_batch_src_global generation:  0.018422842025756836
r_  generation:  0.15552520751953125
local_output_nid generation:  0.007889270782470703
local_in_edges_tensor generation:  0.010195255279541016
mini_batch_src_global generation:  0.018521785736083984
r_  generation:  0.15236234664916992
local_output_nid generation:  0.008131027221679688
local_in_edges_tensor generation:  0.009147405624389648
mini_batch_src_global generation:  0.018167734146118164
r_  generation:  0.15805363655090332
local_output_nid generation:  0.009088516235351562
local_in_edges_tensor generation:  0.019844532012939453
mini_batch_src_global generation:  0.026103496551513672
r_  generation:  0.1579422950744629
local_output_nid generation:  0.008990049362182617
local_in_edges_tensor generation:  0.011106491088867188
mini_batch_src_global generation:  0.020044326782226562
r_  generation:  0.15301871299743652
local_output_nid generation:  0.00799870491027832
local_in_edges_tensor generation:  0.008277177810668945
mini_batch_src_global generation:  0.018964529037475586
r_  generation:  0.15387916564941406
local_output_nid generation:  0.00805044174194336
local_in_edges_tensor generation:  0.00883340835571289
mini_batch_src_global generation:  0.019026756286621094
r_  generation:  0.15396380424499512
local_output_nid generation:  0.008394002914428711
local_in_edges_tensor generation:  0.010949373245239258
mini_batch_src_global generation:  0.020622968673706055
r_  generation:  0.15700101852416992
local_output_nid generation:  0.007862567901611328
local_in_edges_tensor generation:  0.008047103881835938
mini_batch_src_global generation:  0.018733501434326172
r_  generation:  0.1485729217529297
local_output_nid generation:  0.007842540740966797
local_in_edges_tensor generation:  0.008719205856323242
mini_batch_src_global generation:  0.018243074417114258
r_  generation:  0.1456897258758545
local_output_nid generation:  0.008352279663085938
local_in_edges_tensor generation:  0.01089620590209961
mini_batch_src_global generation:  0.01913285255432129
r_  generation:  0.1581895351409912
local_output_nid generation:  0.007999658584594727
local_in_edges_tensor generation:  0.010624170303344727
mini_batch_src_global generation:  0.018795490264892578
r_  generation:  0.15243172645568848
local_output_nid generation:  0.007956266403198242
local_in_edges_tensor generation:  0.007892847061157227
mini_batch_src_global generation:  0.01827836036682129
r_  generation:  0.1477797031402588
local_output_nid generation:  0.008051633834838867
local_in_edges_tensor generation:  0.00815582275390625
mini_batch_src_global generation:  0.018633604049682617
r_  generation:  0.15543723106384277
local_output_nid generation:  0.008316516876220703
local_in_edges_tensor generation:  0.012000560760498047
mini_batch_src_global generation:  0.020531177520751953
r_  generation:  0.15783071517944336
local_output_nid generation:  0.007934331893920898
local_in_edges_tensor generation:  0.007956981658935547
mini_batch_src_global generation:  0.01842331886291504
r_  generation:  0.15012168884277344
local_output_nid generation:  0.007817268371582031
local_in_edges_tensor generation:  0.007885217666625977
mini_batch_src_global generation:  0.01784205436706543
r_  generation:  0.14699745178222656
local_output_nid generation:  0.008168935775756836
local_in_edges_tensor generation:  0.010479211807250977
mini_batch_src_global generation:  0.01992630958557129
r_  generation:  0.15581631660461426
local_output_nid generation:  0.008223533630371094
local_in_edges_tensor generation:  0.010526180267333984
mini_batch_src_global generation:  0.01870107650756836
r_  generation:  0.15344691276550293
local_output_nid generation:  0.008088827133178711
local_in_edges_tensor generation:  0.009243965148925781
mini_batch_src_global generation:  0.018423795700073242
r_  generation:  0.1506788730621338
local_output_nid generation:  0.008115053176879883
local_in_edges_tensor generation:  0.009394645690917969
mini_batch_src_global generation:  0.019818782806396484
r_  generation:  0.15385937690734863
local_output_nid generation:  0.008145570755004883
local_in_edges_tensor generation:  0.009404659271240234
mini_batch_src_global generation:  0.03556323051452637
r_  generation:  0.15439987182617188
local_output_nid generation:  0.007942676544189453
local_in_edges_tensor generation:  0.008105039596557617
mini_batch_src_global generation:  0.018312931060791016
r_  generation:  0.149214506149292
local_output_nid generation:  0.007948637008666992
local_in_edges_tensor generation:  0.00823211669921875
mini_batch_src_global generation:  0.01856851577758789
r_  generation:  0.1501307487487793
local_output_nid generation:  0.009077310562133789
local_in_edges_tensor generation:  0.01702260971069336
mini_batch_src_global generation:  0.027753114700317383
r_  generation:  0.15948891639709473
----------------------check_connections_block total spend ----------------------------- 7.203628778457642
generate_one_block  0.20204472541809082
generate_one_block  0.1891932487487793
generate_one_block  0.21678805351257324
generate_one_block  0.1881732940673828
generate_one_block  0.18790388107299805
generate_one_block  0.18812894821166992
generate_one_block  0.2055339813232422
generate_one_block  0.19327974319458008
generate_one_block  0.20581698417663574
generate_one_block  0.20420098304748535
generate_one_block  0.19089508056640625
generate_one_block  0.19500303268432617
generate_one_block  0.18988800048828125
generate_one_block  0.1916487216949463
generate_one_block  0.199629545211792
generate_one_block  0.20691871643066406
generate_one_block  0.1880049705505371
generate_one_block  0.20236420631408691
generate_one_block  0.19128131866455078
generate_one_block  0.18280625343322754
generate_one_block  0.190155029296875
generate_one_block  0.19572710990905762
generate_one_block  0.17918944358825684
generate_one_block  0.17613840103149414
generate_one_block  0.19212889671325684
generate_one_block  0.1903705596923828
generate_one_block  0.18225979804992676
generate_one_block  0.19024348258972168
generate_one_block  0.18741583824157715
generate_one_block  0.17946076393127441
generate_one_block  0.18090415000915527
generate_one_block  0.19637107849121094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.050911664962768555
gen group dst list time:  0.10375761985778809
time for parepare:  0.01875925064086914
local_output_nid generation:  0.02033209800720215
local_in_edges_tensor generation:  0.046159982681274414
mini_batch_src_global generation:  0.04095268249511719
r_  generation:  0.38142919540405273
local_output_nid generation:  0.026799917221069336
local_in_edges_tensor generation:  0.03956484794616699
mini_batch_src_global generation:  0.04701542854309082
r_  generation:  0.396181583404541
local_output_nid generation:  0.02705097198486328
local_in_edges_tensor generation:  0.03302717208862305
mini_batch_src_global generation:  0.0465543270111084
r_  generation:  0.4052093029022217
local_output_nid generation:  0.025393247604370117
local_in_edges_tensor generation:  0.02822136878967285
mini_batch_src_global generation:  0.047215938568115234
r_  generation:  0.39593029022216797
local_output_nid generation:  0.02805471420288086
local_in_edges_tensor generation:  0.02994704246520996
mini_batch_src_global generation:  0.04987692832946777
r_  generation:  0.40745067596435547
local_output_nid generation:  0.02567124366760254
local_in_edges_tensor generation:  0.03270292282104492
mini_batch_src_global generation:  0.04816770553588867
r_  generation:  0.41730761528015137
local_output_nid generation:  0.025483131408691406
local_in_edges_tensor generation:  0.02861309051513672
mini_batch_src_global generation:  0.047763824462890625
r_  generation:  0.40648531913757324
local_output_nid generation:  0.026323556900024414
local_in_edges_tensor generation:  0.033478736877441406
mini_batch_src_global generation:  0.048583984375
r_  generation:  0.4089236259460449
local_output_nid generation:  0.025831937789916992
local_in_edges_tensor generation:  0.031208515167236328
mini_batch_src_global generation:  0.055264949798583984
r_  generation:  0.40355491638183594
local_output_nid generation:  0.025916337966918945
local_in_edges_tensor generation:  0.028973102569580078
mini_batch_src_global generation:  0.04827475547790527
r_  generation:  0.406541109085083
local_output_nid generation:  0.026335477828979492
local_in_edges_tensor generation:  0.029566526412963867
mini_batch_src_global generation:  0.051416873931884766
r_  generation:  0.41323089599609375
local_output_nid generation:  0.02745223045349121
local_in_edges_tensor generation:  0.03552746772766113
mini_batch_src_global generation:  0.051575660705566406
r_  generation:  0.40741491317749023
local_output_nid generation:  0.025912761688232422
local_in_edges_tensor generation:  0.03696155548095703
mini_batch_src_global generation:  0.05863046646118164
r_  generation:  0.40723538398742676
local_output_nid generation:  0.026799678802490234
local_in_edges_tensor generation:  0.033052921295166016
mini_batch_src_global generation:  0.04891633987426758
r_  generation:  0.40783095359802246
local_output_nid generation:  0.029453516006469727
local_in_edges_tensor generation:  0.026499032974243164
mini_batch_src_global generation:  0.050137996673583984
r_  generation:  0.41127872467041016
local_output_nid generation:  0.0267336368560791
local_in_edges_tensor generation:  0.033029794692993164
mini_batch_src_global generation:  0.04829144477844238
r_  generation:  0.40103745460510254
local_output_nid generation:  0.026710987091064453
local_in_edges_tensor generation:  0.03020000457763672
mini_batch_src_global generation:  0.04785442352294922
r_  generation:  0.4048292636871338
local_output_nid generation:  0.027126073837280273
local_in_edges_tensor generation:  0.03320932388305664
mini_batch_src_global generation:  0.048839569091796875
r_  generation:  0.4086277484893799
local_output_nid generation:  0.026998281478881836
local_in_edges_tensor generation:  0.03020000457763672
mini_batch_src_global generation:  0.048639535903930664
r_  generation:  0.4070723056793213
local_output_nid generation:  0.026677370071411133
local_in_edges_tensor generation:  0.026059865951538086
mini_batch_src_global generation:  0.04918646812438965
r_  generation:  0.40259432792663574
local_output_nid generation:  0.026867389678955078
local_in_edges_tensor generation:  0.02924966812133789
mini_batch_src_global generation:  0.06855487823486328
r_  generation:  0.40664076805114746
local_output_nid generation:  0.02728128433227539
local_in_edges_tensor generation:  0.03726387023925781
mini_batch_src_global generation:  0.04969644546508789
r_  generation:  0.4144420623779297
local_output_nid generation:  0.026649951934814453
local_in_edges_tensor generation:  0.03176760673522949
mini_batch_src_global generation:  0.049193382263183594
r_  generation:  0.40521812438964844
local_output_nid generation:  0.026610612869262695
local_in_edges_tensor generation:  0.032215118408203125
mini_batch_src_global generation:  0.04778313636779785
r_  generation:  0.42444539070129395
local_output_nid generation:  0.027858972549438477
local_in_edges_tensor generation:  0.03774690628051758
mini_batch_src_global generation:  0.05128026008605957
r_  generation:  0.40953850746154785
local_output_nid generation:  0.026943683624267578
local_in_edges_tensor generation:  0.03648519515991211
mini_batch_src_global generation:  0.04832625389099121
r_  generation:  0.402510404586792
local_output_nid generation:  0.02676844596862793
local_in_edges_tensor generation:  0.03025341033935547
mini_batch_src_global generation:  0.04794573783874512
r_  generation:  0.41130852699279785
local_output_nid generation:  0.02895331382751465
local_in_edges_tensor generation:  0.029155254364013672
mini_batch_src_global generation:  0.05231451988220215
r_  generation:  0.4078023433685303
local_output_nid generation:  0.0269925594329834
local_in_edges_tensor generation:  0.028746366500854492
mini_batch_src_global generation:  0.0475466251373291
r_  generation:  0.4076046943664551
local_output_nid generation:  0.026582956314086914
local_in_edges_tensor generation:  0.02489781379699707
mini_batch_src_global generation:  0.04895663261413574
r_  generation:  0.400470495223999
local_output_nid generation:  0.026595115661621094
local_in_edges_tensor generation:  0.02785015106201172
mini_batch_src_global generation:  0.04775261878967285
r_  generation:  0.404188871383667
local_output_nid generation:  0.027051925659179688
local_in_edges_tensor generation:  0.03316020965576172
mini_batch_src_global generation:  0.04856157302856445
r_  generation:  0.40937232971191406
----------------------check_connections_block total spend ----------------------------- 19.349406719207764
generate_one_block  0.622107982635498
generate_one_block  0.5252828598022461
generate_one_block  0.5307226181030273
generate_one_block  0.5053236484527588
generate_one_block  0.5409061908721924
generate_one_block  0.5234968662261963
generate_one_block  0.5135035514831543
generate_one_block  0.533076286315918
generate_one_block  0.5608818531036377
generate_one_block  0.6059541702270508
generate_one_block  0.569652795791626
generate_one_block  0.547579288482666
generate_one_block  0.5259637832641602
generate_one_block  0.5297331809997559
generate_one_block  0.5347716808319092
generate_one_block  0.5195944309234619
generate_one_block  0.5235710144042969
generate_one_block  0.5762152671813965
generate_one_block  0.5280933380126953
generate_one_block  0.5348808765411377
generate_one_block  0.5608460903167725
generate_one_block  0.5517487525939941
generate_one_block  0.5282649993896484
generate_one_block  0.5378086566925049
generate_one_block  0.531367301940918
generate_one_block  0.5351471900939941
generate_one_block  0.5455193519592285
generate_one_block  0.5457549095153809
generate_one_block  0.532052755355835
generate_one_block  0.5354986190795898
generate_one_block  0.5292849540710449
generate_one_block  0.541900634765625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  26.553035497665405
block generation total time  23.486374139785767
average batch blocks generation time:  0.7339491918683052
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08873987197875977  GigaBytes
Max Memory Allocated: 0.08873987197875977  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7811279296875 GB
    Memory Allocated: 17.0722017288208  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6483154296875 GB
    Memory Allocated: 0.09433698654174805  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6737060546875 GB
    Memory Allocated: 16.877742290496826  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6756591796875 GB
    Memory Allocated: 0.09478187561035156  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6756591796875 GB
    Memory Allocated: 16.88388442993164  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6756591796875 GB
    Memory Allocated: 0.09384441375732422  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6815185546875 GB
    Memory Allocated: 16.29772138595581  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6834716796875 GB
    Memory Allocated: 0.09479427337646484  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6834716796875 GB
    Memory Allocated: 16.88443422317505  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6834716796875 GB
    Memory Allocated: 0.09438180923461914  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6834716796875 GB
    Memory Allocated: 16.73935079574585  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6834716796875 GB
    Memory Allocated: 0.09475231170654297  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6834716796875 GB
    Memory Allocated: 16.664319038391113  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6854248046875 GB
    Memory Allocated: 0.09473085403442383  GigaBytes
Max Memory Allocated: 17.113101959228516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3045654296875 GB
    Memory Allocated: 17.229581832885742  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3045654296875 GB
    Memory Allocated: 0.09477472305297852  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3045654296875 GB
    Memory Allocated: 16.8939790725708  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3045654296875 GB
    Memory Allocated: 0.094207763671875  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3045654296875 GB
    Memory Allocated: 16.916543006896973  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3045654296875 GB
    Memory Allocated: 0.09484386444091797  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3045654296875 GB
    Memory Allocated: 17.139785766601562  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3045654296875 GB
    Memory Allocated: 0.09435701370239258  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3045654296875 GB
    Memory Allocated: 17.212985515594482  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7362060546875 GB
    Memory Allocated: 0.09482431411743164  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7362060546875 GB
    Memory Allocated: 17.05599594116211  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7362060546875 GB
    Memory Allocated: 0.09458112716674805  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7362060546875 GB
    Memory Allocated: 17.21825885772705  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7362060546875 GB
    Memory Allocated: 0.09488773345947266  GigaBytes
Max Memory Allocated: 17.26458740234375  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7362060546875 GB
    Memory Allocated: 17.28615427017212  GigaBytes
Max Memory Allocated: 17.32172966003418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6151123046875 GB
    Memory Allocated: 0.09417057037353516  GigaBytes
Max Memory Allocated: 17.32172966003418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6717529296875 GB
    Memory Allocated: 16.858816146850586  GigaBytes
Max Memory Allocated: 17.32172966003418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6737060546875 GB
    Memory Allocated: 0.09471273422241211  GigaBytes
Max Memory Allocated: 17.32172966003418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6776123046875 GB
    Memory Allocated: 16.517253875732422  GigaBytes
Max Memory Allocated: 17.32172966003418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6795654296875 GB
    Memory Allocated: 0.09449291229248047  GigaBytes
Max Memory Allocated: 17.32172966003418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 17.371103763580322  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09479379653930664  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.87861394882202  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09425163269042969  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.794270515441895  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09481048583984375  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.96689510345459  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09438848495483398  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 17.263929843902588  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09473705291748047  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.563875675201416  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09389400482177734  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.454914569854736  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09482574462890625  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 17.041863441467285  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09402608871459961  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.898807048797607  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09476184844970703  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.75692129135132  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09436178207397461  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 17.110892295837402  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09479045867919922  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.86204242706299  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09392023086547852  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.581468105316162  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09473514556884766  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.576675415039062  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.09424352645874023  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 17.146522521972656  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03394564241170883 |0.029934115707874298 |0.44592878222465515 |0.000105343759059906 |0.9204410836100578 |0.009839773178100586 |
----------------------------------------------------------pseudo_mini_loss sum 5.399129867553711
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8795313
Number of first layer input nodes during this epoch:  4680189
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.12363624572753906  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024936914443969727
range selection method range initialization spend 0.013595819473266602
time for parepare:  0.018271446228027344
local_output_nid generation:  0.0009186267852783203
local_in_edges_tensor generation:  0.00401616096496582
mini_batch_src_global generation:  0.0017409324645996094
r_  generation:  0.010567426681518555
local_output_nid generation:  0.0009744167327880859
local_in_edges_tensor generation:  0.0007083415985107422
mini_batch_src_global generation:  0.001737833023071289
r_  generation:  0.010434150695800781
local_output_nid generation:  0.0009026527404785156
local_in_edges_tensor generation:  0.0006024837493896484
mini_batch_src_global generation:  0.0012540817260742188
r_  generation:  0.009864568710327148
local_output_nid generation:  0.0009365081787109375
local_in_edges_tensor generation:  0.0006368160247802734
mini_batch_src_global generation:  0.0011467933654785156
r_  generation:  0.009750604629516602
local_output_nid generation:  0.0008592605590820312
local_in_edges_tensor generation:  0.0005960464477539062
mini_batch_src_global generation:  0.0010993480682373047
r_  generation:  0.009577751159667969
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0006024837493896484
mini_batch_src_global generation:  0.0012385845184326172
r_  generation:  0.01065683364868164
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005772113800048828
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.010079145431518555
local_output_nid generation:  0.0008518695831298828
local_in_edges_tensor generation:  0.0006139278411865234
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.00994253158569336
local_output_nid generation:  0.0008575916290283203
local_in_edges_tensor generation:  0.0005955696105957031
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.01007223129272461
local_output_nid generation:  0.0008449554443359375
local_in_edges_tensor generation:  0.0005919933319091797
mini_batch_src_global generation:  0.0012772083282470703
r_  generation:  0.010466575622558594
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0006203651428222656
mini_batch_src_global generation:  0.0012688636779785156
r_  generation:  0.010863304138183594
local_output_nid generation:  0.0008900165557861328
local_in_edges_tensor generation:  0.0006086826324462891
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.010160446166992188
local_output_nid generation:  0.0008344650268554688
local_in_edges_tensor generation:  0.0005791187286376953
mini_batch_src_global generation:  0.0012080669403076172
r_  generation:  0.010690927505493164
local_output_nid generation:  0.0008845329284667969
local_in_edges_tensor generation:  0.0005831718444824219
mini_batch_src_global generation:  0.001146078109741211
r_  generation:  0.010481595993041992
local_output_nid generation:  0.0008454322814941406
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.00122833251953125
r_  generation:  0.01040959358215332
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005555152893066406
mini_batch_src_global generation:  0.0011687278747558594
r_  generation:  0.01008749008178711
local_output_nid generation:  0.0008347034454345703
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.001177072525024414
r_  generation:  0.010164976119995117
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.0011737346649169922
r_  generation:  0.010103702545166016
local_output_nid generation:  0.0008416175842285156
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0011289119720458984
r_  generation:  0.010333538055419922
local_output_nid generation:  0.0008764266967773438
local_in_edges_tensor generation:  0.0005741119384765625
mini_batch_src_global generation:  0.001138925552368164
r_  generation:  0.010155200958251953
local_output_nid generation:  0.0008361339569091797
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0011489391326904297
r_  generation:  0.010463476181030273
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0005514621734619141
mini_batch_src_global generation:  0.0011260509490966797
r_  generation:  0.010212182998657227
local_output_nid generation:  0.0008337497711181641
local_in_edges_tensor generation:  0.0006012916564941406
mini_batch_src_global generation:  0.0012063980102539062
r_  generation:  0.010694026947021484
local_output_nid generation:  0.0008380413055419922
local_in_edges_tensor generation:  0.0005998611450195312
mini_batch_src_global generation:  0.0012524127960205078
r_  generation:  0.010830163955688477
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.010331392288208008
local_output_nid generation:  0.0008411407470703125
local_in_edges_tensor generation:  0.0006055831909179688
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.010183572769165039
local_output_nid generation:  0.0008442401885986328
local_in_edges_tensor generation:  0.0005788803100585938
mini_batch_src_global generation:  0.00128936767578125
r_  generation:  0.0105743408203125
local_output_nid generation:  0.0008244514465332031
local_in_edges_tensor generation:  0.0005731582641601562
mini_batch_src_global generation:  0.0011487007141113281
r_  generation:  0.010282754898071289
local_output_nid generation:  0.0008361339569091797
local_in_edges_tensor generation:  0.00055694580078125
mini_batch_src_global generation:  0.0011990070343017578
r_  generation:  0.010380029678344727
local_output_nid generation:  0.0008306503295898438
local_in_edges_tensor generation:  0.0005612373352050781
mini_batch_src_global generation:  0.0011782646179199219
r_  generation:  0.010281085968017578
local_output_nid generation:  0.0008797645568847656
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.0012536048889160156
r_  generation:  0.010504007339477539
local_output_nid generation:  0.0008351802825927734
local_in_edges_tensor generation:  0.0006103515625
mini_batch_src_global generation:  0.001230478286743164
r_  generation:  0.01051640510559082
----------------------check_connections_block total spend ----------------------------- 0.5172359943389893
generate_one_block  0.02415919303894043
generate_one_block  0.020285844802856445
generate_one_block  0.017942428588867188
generate_one_block  0.017383575439453125
generate_one_block  0.017052650451660156
generate_one_block  0.0185391902923584
generate_one_block  0.017375707626342773
generate_one_block  0.017333269119262695
generate_one_block  0.01747417449951172
generate_one_block  0.018257856369018555
generate_one_block  0.018125295639038086
generate_one_block  0.01781010627746582
generate_one_block  0.018166303634643555
generate_one_block  0.017690658569335938
generate_one_block  0.017242908477783203
generate_one_block  0.017517805099487305
generate_one_block  0.017290830612182617
generate_one_block  0.017240524291992188
generate_one_block  0.01750969886779785
generate_one_block  0.01720881462097168
generate_one_block  0.0202178955078125
generate_one_block  0.017322778701782227
generate_one_block  0.017917394638061523
generate_one_block  0.018239974975585938
generate_one_block  0.017573833465576172
generate_one_block  0.017237186431884766
generate_one_block  0.017622709274291992
generate_one_block  0.017138004302978516
generate_one_block  0.017473459243774414
generate_one_block  0.01737523078918457
generate_one_block  0.017603158950805664
generate_one_block  0.017623424530029297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03285574913024902
gen group dst list time:  0.021959543228149414
time for parepare:  0.019443035125732422
local_output_nid generation:  0.0053822994232177734
local_in_edges_tensor generation:  0.011363983154296875
mini_batch_src_global generation:  0.013187170028686523
r_  generation:  0.13316035270690918
local_output_nid generation:  0.00767064094543457
local_in_edges_tensor generation:  0.011469364166259766
mini_batch_src_global generation:  0.01694202423095703
r_  generation:  0.14026880264282227
local_output_nid generation:  0.00783395767211914
local_in_edges_tensor generation:  0.029691457748413086
mini_batch_src_global generation:  0.015264511108398438
r_  generation:  0.14105463027954102
local_output_nid generation:  0.007993221282958984
local_in_edges_tensor generation:  0.008075475692749023
mini_batch_src_global generation:  0.017673015594482422
r_  generation:  0.1445784568786621
local_output_nid generation:  0.008367776870727539
local_in_edges_tensor generation:  0.008204460144042969
mini_batch_src_global generation:  0.01651620864868164
r_  generation:  0.14512228965759277
local_output_nid generation:  0.008582115173339844
local_in_edges_tensor generation:  0.01125335693359375
mini_batch_src_global generation:  0.018480300903320312
r_  generation:  0.15715312957763672
local_output_nid generation:  0.008611202239990234
local_in_edges_tensor generation:  0.008234500885009766
mini_batch_src_global generation:  0.01787114143371582
r_  generation:  0.14955735206604004
local_output_nid generation:  0.00868678092956543
local_in_edges_tensor generation:  0.008519887924194336
mini_batch_src_global generation:  0.01770949363708496
r_  generation:  0.14936113357543945
local_output_nid generation:  0.008962392807006836
local_in_edges_tensor generation:  0.011837005615234375
mini_batch_src_global generation:  0.018016815185546875
r_  generation:  0.15326595306396484
local_output_nid generation:  0.009224414825439453
local_in_edges_tensor generation:  0.011154890060424805
mini_batch_src_global generation:  0.01879572868347168
r_  generation:  0.1586465835571289
local_output_nid generation:  0.009315967559814453
local_in_edges_tensor generation:  0.008809089660644531
mini_batch_src_global generation:  0.019047975540161133
r_  generation:  0.15843486785888672
local_output_nid generation:  0.00913381576538086
local_in_edges_tensor generation:  0.009453773498535156
mini_batch_src_global generation:  0.018976688385009766
r_  generation:  0.1549360752105713
local_output_nid generation:  0.009219169616699219
local_in_edges_tensor generation:  0.00989842414855957
mini_batch_src_global generation:  0.020412683486938477
r_  generation:  0.16043400764465332
local_output_nid generation:  0.00908660888671875
local_in_edges_tensor generation:  0.008883953094482422
mini_batch_src_global generation:  0.018703937530517578
r_  generation:  0.15320134162902832
local_output_nid generation:  0.008964776992797852
local_in_edges_tensor generation:  0.008575201034545898
mini_batch_src_global generation:  0.01843428611755371
r_  generation:  0.15157532691955566
local_output_nid generation:  0.009207487106323242
local_in_edges_tensor generation:  0.008740425109863281
mini_batch_src_global generation:  0.018547773361206055
r_  generation:  0.15620660781860352
local_output_nid generation:  0.009122610092163086
local_in_edges_tensor generation:  0.009824752807617188
mini_batch_src_global generation:  0.0182192325592041
r_  generation:  0.15259957313537598
local_output_nid generation:  0.009033918380737305
local_in_edges_tensor generation:  0.008699417114257812
mini_batch_src_global generation:  0.018286705017089844
r_  generation:  0.15020966529846191
local_output_nid generation:  0.009112358093261719
local_in_edges_tensor generation:  0.009257793426513672
mini_batch_src_global generation:  0.019431114196777344
r_  generation:  0.15197277069091797
local_output_nid generation:  0.008647441864013672
local_in_edges_tensor generation:  0.008718252182006836
mini_batch_src_global generation:  0.018077850341796875
r_  generation:  0.14925742149353027
local_output_nid generation:  0.008693218231201172
local_in_edges_tensor generation:  0.009435176849365234
mini_batch_src_global generation:  0.019461870193481445
r_  generation:  0.15714550018310547
local_output_nid generation:  0.008875608444213867
local_in_edges_tensor generation:  0.010262727737426758
mini_batch_src_global generation:  0.018715858459472656
r_  generation:  0.1538679599761963
local_output_nid generation:  0.009021997451782227
local_in_edges_tensor generation:  0.012445688247680664
mini_batch_src_global generation:  0.01886153221130371
r_  generation:  0.1571025848388672
local_output_nid generation:  0.009023666381835938
local_in_edges_tensor generation:  0.010284900665283203
mini_batch_src_global generation:  0.019540071487426758
r_  generation:  0.1602318286895752
local_output_nid generation:  0.008805990219116211
local_in_edges_tensor generation:  0.008935928344726562
mini_batch_src_global generation:  0.018694162368774414
r_  generation:  0.1551375389099121
local_output_nid generation:  0.008785724639892578
local_in_edges_tensor generation:  0.009999752044677734
mini_batch_src_global generation:  0.018816471099853516
r_  generation:  0.15413403511047363
local_output_nid generation:  0.008980989456176758
local_in_edges_tensor generation:  0.010283470153808594
mini_batch_src_global generation:  0.019887924194335938
r_  generation:  0.15815186500549316
local_output_nid generation:  0.008690595626831055
local_in_edges_tensor generation:  0.009110450744628906
mini_batch_src_global generation:  0.018512964248657227
r_  generation:  0.15461993217468262
local_output_nid generation:  0.008737802505493164
local_in_edges_tensor generation:  0.00886845588684082
mini_batch_src_global generation:  0.018538475036621094
r_  generation:  0.15392661094665527
local_output_nid generation:  0.008774518966674805
local_in_edges_tensor generation:  0.009081602096557617
mini_batch_src_global generation:  0.018472671508789062
r_  generation:  0.1537787914276123
local_output_nid generation:  0.008949518203735352
local_in_edges_tensor generation:  0.011389017105102539
mini_batch_src_global generation:  0.01971435546875
r_  generation:  0.1562814712524414
local_output_nid generation:  0.008916616439819336
local_in_edges_tensor generation:  0.011436223983764648
mini_batch_src_global generation:  0.019199609756469727
r_  generation:  0.15675115585327148
----------------------check_connections_block total spend ----------------------------- 7.239121913909912
generate_one_block  0.19573450088500977
generate_one_block  0.19804835319519043
generate_one_block  0.19726920127868652
generate_one_block  0.19530129432678223
generate_one_block  0.21960973739624023
generate_one_block  0.21456527709960938
generate_one_block  0.1988072395324707
generate_one_block  0.1973121166229248
generate_one_block  0.19972467422485352
generate_one_block  0.2084507942199707
generate_one_block  0.21306967735290527
generate_one_block  0.20195960998535156
generate_one_block  0.21378421783447266
generate_one_block  0.19724750518798828
generate_one_block  0.19468927383422852
generate_one_block  0.20158958435058594
generate_one_block  0.19860601425170898
generate_one_block  0.19720768928527832
generate_one_block  0.20108652114868164
generate_one_block  0.19787359237670898
generate_one_block  0.1993408203125
generate_one_block  0.20438241958618164
generate_one_block  0.2080836296081543
generate_one_block  0.21189022064208984
generate_one_block  0.2013857364654541
generate_one_block  0.20203399658203125
generate_one_block  0.20819664001464844
generate_one_block  0.19617509841918945
generate_one_block  0.2018442153930664
generate_one_block  0.20149898529052734
generate_one_block  0.20319175720214844
generate_one_block  0.20618677139282227
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04037189483642578
gen group dst list time:  0.09545016288757324
time for parepare:  0.01743769645690918
local_output_nid generation:  0.02214956283569336
local_in_edges_tensor generation:  0.03347945213317871
mini_batch_src_global generation:  0.03590893745422363
r_  generation:  0.4076712131500244
local_output_nid generation:  0.028577566146850586
local_in_edges_tensor generation:  0.03904390335083008
mini_batch_src_global generation:  0.053906917572021484
r_  generation:  0.41292476654052734
local_output_nid generation:  0.0287015438079834
local_in_edges_tensor generation:  0.028974056243896484
mini_batch_src_global generation:  0.04930853843688965
r_  generation:  0.41255998611450195
local_output_nid generation:  0.027785301208496094
local_in_edges_tensor generation:  0.03405022621154785
mini_batch_src_global generation:  0.051900625228881836
r_  generation:  0.40112805366516113
local_output_nid generation:  0.027240514755249023
local_in_edges_tensor generation:  0.03058314323425293
mini_batch_src_global generation:  0.05223894119262695
r_  generation:  0.41187405586242676
local_output_nid generation:  0.027513504028320312
local_in_edges_tensor generation:  0.02940058708190918
mini_batch_src_global generation:  0.050603389739990234
r_  generation:  0.41884684562683105
local_output_nid generation:  0.028336524963378906
local_in_edges_tensor generation:  0.03516840934753418
mini_batch_src_global generation:  0.051149606704711914
r_  generation:  0.41056203842163086
local_output_nid generation:  0.027654647827148438
local_in_edges_tensor generation:  0.0290524959564209
mini_batch_src_global generation:  0.05286526679992676
r_  generation:  0.41109371185302734
local_output_nid generation:  0.027731895446777344
local_in_edges_tensor generation:  0.028576135635375977
mini_batch_src_global generation:  0.05031561851501465
r_  generation:  0.41927242279052734
local_output_nid generation:  0.02829766273498535
local_in_edges_tensor generation:  0.03287363052368164
mini_batch_src_global generation:  0.052362918853759766
r_  generation:  0.4128754138946533
local_output_nid generation:  0.02850341796875
local_in_edges_tensor generation:  0.03537797927856445
mini_batch_src_global generation:  0.0484163761138916
r_  generation:  0.4234485626220703
local_output_nid generation:  0.02951359748840332
local_in_edges_tensor generation:  0.027937889099121094
mini_batch_src_global generation:  0.049483299255371094
r_  generation:  0.40773606300354004
local_output_nid generation:  0.028178691864013672
local_in_edges_tensor generation:  0.025332927703857422
mini_batch_src_global generation:  0.05067586898803711
r_  generation:  0.41385483741760254
local_output_nid generation:  0.028271198272705078
local_in_edges_tensor generation:  0.025153636932373047
mini_batch_src_global generation:  0.049535512924194336
r_  generation:  0.40732502937316895
local_output_nid generation:  0.028402328491210938
local_in_edges_tensor generation:  0.03246188163757324
mini_batch_src_global generation:  0.04778242111206055
r_  generation:  0.4088561534881592
local_output_nid generation:  0.02858281135559082
local_in_edges_tensor generation:  0.033896684646606445
mini_batch_src_global generation:  0.048224687576293945
r_  generation:  0.41535258293151855
local_output_nid generation:  0.028688907623291016
local_in_edges_tensor generation:  0.029361724853515625
mini_batch_src_global generation:  0.04846668243408203
r_  generation:  0.41205859184265137
local_output_nid generation:  0.02859020233154297
local_in_edges_tensor generation:  0.02855539321899414
mini_batch_src_global generation:  0.04830026626586914
r_  generation:  0.41176319122314453
local_output_nid generation:  0.02841353416442871
local_in_edges_tensor generation:  0.028463125228881836
mini_batch_src_global generation:  0.04746723175048828
r_  generation:  0.4108161926269531
local_output_nid generation:  0.02847456932067871
local_in_edges_tensor generation:  0.025455474853515625
mini_batch_src_global generation:  0.04867291450500488
r_  generation:  0.41066908836364746
local_output_nid generation:  0.028720855712890625
local_in_edges_tensor generation:  0.028761863708496094
mini_batch_src_global generation:  0.04830193519592285
r_  generation:  0.41338109970092773
local_output_nid generation:  0.0290524959564209
local_in_edges_tensor generation:  0.029214143753051758
mini_batch_src_global generation:  0.05141448974609375
r_  generation:  0.4167017936706543
local_output_nid generation:  0.02927398681640625
local_in_edges_tensor generation:  0.039518117904663086
mini_batch_src_global generation:  0.048207998275756836
r_  generation:  0.41944146156311035
local_output_nid generation:  0.02886509895324707
local_in_edges_tensor generation:  0.029160499572753906
mini_batch_src_global generation:  0.04894566535949707
r_  generation:  0.4164090156555176
local_output_nid generation:  0.029186248779296875
local_in_edges_tensor generation:  0.02969050407409668
mini_batch_src_global generation:  0.04838275909423828
r_  generation:  0.4191467761993408
local_output_nid generation:  0.028973817825317383
local_in_edges_tensor generation:  0.0296630859375
mini_batch_src_global generation:  0.048932552337646484
r_  generation:  0.41794538497924805
local_output_nid generation:  0.028635501861572266
local_in_edges_tensor generation:  0.025732755661010742
mini_batch_src_global generation:  0.04825234413146973
r_  generation:  0.41367530822753906
local_output_nid generation:  0.02880096435546875
local_in_edges_tensor generation:  0.026320219039916992
mini_batch_src_global generation:  0.04832935333251953
r_  generation:  0.41117167472839355
local_output_nid generation:  0.02871561050415039
local_in_edges_tensor generation:  0.02947711944580078
mini_batch_src_global generation:  0.0510249137878418
r_  generation:  0.4124464988708496
local_output_nid generation:  0.02897930145263672
local_in_edges_tensor generation:  0.03275799751281738
mini_batch_src_global generation:  0.04837179183959961
r_  generation:  0.41229867935180664
local_output_nid generation:  0.028676748275756836
local_in_edges_tensor generation:  0.025380611419677734
mini_batch_src_global generation:  0.04870343208312988
r_  generation:  0.4134855270385742
local_output_nid generation:  0.028750181198120117
local_in_edges_tensor generation:  0.02608489990234375
mini_batch_src_global generation:  0.04838442802429199
r_  generation:  0.4208695888519287
----------------------check_connections_block total spend ----------------------------- 19.602230548858643
generate_one_block  0.5620851516723633
generate_one_block  0.5499897003173828
generate_one_block  0.5463466644287109
generate_one_block  0.5453794002532959
generate_one_block  0.6377995014190674
generate_one_block  0.5617783069610596
generate_one_block  0.5422444343566895
generate_one_block  0.551649808883667
generate_one_block  0.5575258731842041
generate_one_block  0.5610318183898926
generate_one_block  0.5584452152252197
generate_one_block  0.547003984451294
generate_one_block  0.5507428646087646
generate_one_block  0.5357587337493896
generate_one_block  0.5397176742553711
generate_one_block  0.5565619468688965
generate_one_block  0.5539383888244629
generate_one_block  0.5393292903900146
generate_one_block  0.549555778503418
generate_one_block  0.5487082004547119
generate_one_block  0.5469472408294678
generate_one_block  0.5619924068450928
generate_one_block  0.5656454563140869
generate_one_block  0.5549864768981934
generate_one_block  0.569838285446167
generate_one_block  0.5482757091522217
generate_one_block  0.5549969673156738
generate_one_block  0.5512025356292725
generate_one_block  0.5564694404602051
generate_one_block  0.5519700050354004
generate_one_block  0.5494847297668457
generate_one_block  0.5530698299407959
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.12363624572753906  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

connection checking time:  26.841352462768555
block generation total time  24.24661898612976
average batch blocks generation time:  0.757706843316555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.10521411895751953  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.74851942062378  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.10459613800048828  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.9046893119812  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.1051950454711914  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.655413150787354  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.103851318359375  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.640438556671143  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.10516929626464844  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.540937423706055  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.1047525405883789  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 17.35614776611328  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.10520553588867188  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.67458486557007  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.10477209091186523  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 16.715974807739258  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3006591796875 GB
    Memory Allocated: 0.10522794723510742  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3143310546875 GB
    Memory Allocated: 16.85661268234253  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3162841796875 GB
    Memory Allocated: 0.10479402542114258  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3162841796875 GB
    Memory Allocated: 17.270076751708984  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3162841796875 GB
    Memory Allocated: 0.10532140731811523  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3162841796875 GB
    Memory Allocated: 17.26218557357788  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3162841796875 GB
    Memory Allocated: 0.1045217514038086  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3162841796875 GB
    Memory Allocated: 16.973543167114258  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3162841796875 GB
    Memory Allocated: 0.10534048080444336  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3162841796875 GB
    Memory Allocated: 17.273630142211914  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3162841796875 GB
    Memory Allocated: 0.1046910285949707  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3162841796875 GB
    Memory Allocated: 16.73870849609375  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3162841796875 GB
    Memory Allocated: 0.10519981384277344  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3201904296875 GB
    Memory Allocated: 16.64839458465576  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10486268997192383  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.938948154449463  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10521173477172852  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.776232719421387  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10448169708251953  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.69489097595215  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10521650314331055  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.736377239227295  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10469770431518555  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.668999195098877  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.1052236557006836  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.741243839263916  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10494804382324219  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.90428352355957  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10528326034545898  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 17.186298847198486  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10475349426269531  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 17.27600336074829  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10526037216186523  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 17.044418811798096  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10453176498413086  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.97410821914673  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.1053018569946289  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 17.15521478652954  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10475921630859375  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.728615283966064  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10524225234985352  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.97987985610962  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10497856140136719  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.867677688598633  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10525941848754883  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.936992168426514  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.1044626235961914  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 17.03092670440674  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03314082324504852 |0.01722368597984314 |0.4271431788802147 |9.749829769134521e-05 |0.9515788033604622 |0.006347179412841797 |
----------------------------------------------------------pseudo_mini_loss sum 3.9590513706207275
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8794699
Number of first layer input nodes during this epoch:  4681507
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.12309646606445312  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026856422424316406
range selection method range initialization spend 0.0223844051361084
time for parepare:  0.020641565322875977
local_output_nid generation:  0.00102996826171875
local_in_edges_tensor generation:  0.0074007511138916016
mini_batch_src_global generation:  0.0022735595703125
r_  generation:  0.011878252029418945
local_output_nid generation:  0.0010290145874023438
local_in_edges_tensor generation:  0.0007147789001464844
mini_batch_src_global generation:  0.0020813941955566406
r_  generation:  0.01081991195678711
local_output_nid generation:  0.0010204315185546875
local_in_edges_tensor generation:  0.0010135173797607422
mini_batch_src_global generation:  0.0013799667358398438
r_  generation:  0.009812116622924805
local_output_nid generation:  0.0009386539459228516
local_in_edges_tensor generation:  0.0007681846618652344
mini_batch_src_global generation:  0.0014147758483886719
r_  generation:  0.010237693786621094
local_output_nid generation:  0.0009493827819824219
local_in_edges_tensor generation:  0.0008666515350341797
mini_batch_src_global generation:  0.0012977123260498047
r_  generation:  0.009935617446899414
local_output_nid generation:  0.0008957386016845703
local_in_edges_tensor generation:  0.0006563663482666016
mini_batch_src_global generation:  0.0012576580047607422
r_  generation:  0.009963035583496094
local_output_nid generation:  0.0009224414825439453
local_in_edges_tensor generation:  0.000997781753540039
mini_batch_src_global generation:  0.0012845993041992188
r_  generation:  0.010257959365844727
local_output_nid generation:  0.0009164810180664062
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.0013339519500732422
r_  generation:  0.010034799575805664
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.001514434814453125
r_  generation:  0.010666847229003906
local_output_nid generation:  0.0008904933929443359
local_in_edges_tensor generation:  0.0005931854248046875
mini_batch_src_global generation:  0.0013768672943115234
r_  generation:  0.01026773452758789
local_output_nid generation:  0.0008783340454101562
local_in_edges_tensor generation:  0.0007064342498779297
mini_batch_src_global generation:  0.0012791156768798828
r_  generation:  0.010382652282714844
local_output_nid generation:  0.0009367465972900391
local_in_edges_tensor generation:  0.0008029937744140625
mini_batch_src_global generation:  0.001245260238647461
r_  generation:  0.009983062744140625
local_output_nid generation:  0.0008862018585205078
local_in_edges_tensor generation:  0.0005719661712646484
mini_batch_src_global generation:  0.0013086795806884766
r_  generation:  0.010513544082641602
local_output_nid generation:  0.0009167194366455078
local_in_edges_tensor generation:  0.0006825923919677734
mini_batch_src_global generation:  0.001316070556640625
r_  generation:  0.010603666305541992
local_output_nid generation:  0.0008835792541503906
local_in_edges_tensor generation:  0.0007202625274658203
mini_batch_src_global generation:  0.0012972354888916016
r_  generation:  0.010491132736206055
local_output_nid generation:  0.0008947849273681641
local_in_edges_tensor generation:  0.0007121562957763672
mini_batch_src_global generation:  0.0012679100036621094
r_  generation:  0.010347604751586914
local_output_nid generation:  0.0008826255798339844
local_in_edges_tensor generation:  0.0005893707275390625
mini_batch_src_global generation:  0.0012722015380859375
r_  generation:  0.010131597518920898
local_output_nid generation:  0.0008783340454101562
local_in_edges_tensor generation:  0.0008032321929931641
mini_batch_src_global generation:  0.0012755393981933594
r_  generation:  0.010308027267456055
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0006384849548339844
mini_batch_src_global generation:  0.0013699531555175781
r_  generation:  0.01057577133178711
local_output_nid generation:  0.0008878707885742188
local_in_edges_tensor generation:  0.0007963180541992188
mini_batch_src_global generation:  0.0012722015380859375
r_  generation:  0.010092973709106445
local_output_nid generation:  0.0008883476257324219
local_in_edges_tensor generation:  0.0006830692291259766
mini_batch_src_global generation:  0.0014562606811523438
r_  generation:  0.010059356689453125
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.0005486011505126953
mini_batch_src_global generation:  0.0012536048889160156
r_  generation:  0.010057926177978516
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0007150173187255859
mini_batch_src_global generation:  0.0013070106506347656
r_  generation:  0.01037144660949707
local_output_nid generation:  0.0008771419525146484
local_in_edges_tensor generation:  0.0005884170532226562
mini_batch_src_global generation:  0.0012891292572021484
r_  generation:  0.010464191436767578
local_output_nid generation:  0.0009005069732666016
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0012593269348144531
r_  generation:  0.010090827941894531
local_output_nid generation:  0.0008566379547119141
local_in_edges_tensor generation:  0.0007140636444091797
mini_batch_src_global generation:  0.0013077259063720703
r_  generation:  0.010759830474853516
local_output_nid generation:  0.0009062290191650391
local_in_edges_tensor generation:  0.0007715225219726562
mini_batch_src_global generation:  0.0014338493347167969
r_  generation:  0.010938882827758789
local_output_nid generation:  0.0008828639984130859
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.0013775825500488281
r_  generation:  0.010542154312133789
local_output_nid generation:  0.0008838176727294922
local_in_edges_tensor generation:  0.0005376338958740234
mini_batch_src_global generation:  0.0012688636779785156
r_  generation:  0.010007143020629883
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0009469985961914062
mini_batch_src_global generation:  0.0014040470123291016
r_  generation:  0.010084152221679688
local_output_nid generation:  0.0008871555328369141
local_in_edges_tensor generation:  0.0005645751953125
mini_batch_src_global generation:  0.0012507438659667969
r_  generation:  0.010233402252197266
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.0005557537078857422
mini_batch_src_global generation:  0.0015151500701904297
r_  generation:  0.01041269302368164
----------------------check_connections_block total spend ----------------------------- 0.5371735095977783
generate_one_block  0.02424335479736328
generate_one_block  0.019443511962890625
generate_one_block  0.017940998077392578
generate_one_block  0.018114089965820312
generate_one_block  0.017521142959594727
generate_one_block  0.017438173294067383
generate_one_block  0.01765584945678711
generate_one_block  0.017088651657104492
generate_one_block  0.018370628356933594
generate_one_block  0.01766824722290039
generate_one_block  0.017900943756103516
generate_one_block  0.017232656478881836
generate_one_block  0.018016815185546875
generate_one_block  0.018130779266357422
generate_one_block  0.017896413803100586
generate_one_block  0.017481088638305664
generate_one_block  0.017256498336791992
generate_one_block  0.017023801803588867
generate_one_block  0.018119335174560547
generate_one_block  0.016995906829833984
generate_one_block  0.017075777053833008
generate_one_block  0.01688241958618164
generate_one_block  0.017493724822998047
generate_one_block  0.017441749572753906
generate_one_block  0.017224788665771484
generate_one_block  0.01817464828491211
generate_one_block  0.018562793731689453
generate_one_block  0.01754307746887207
generate_one_block  0.016860485076904297
generate_one_block  0.016939163208007812
generate_one_block  0.017274856567382812
generate_one_block  0.01749897003173828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0401453971862793
gen group dst list time:  0.025122404098510742
time for parepare:  0.020154476165771484
local_output_nid generation:  0.005438327789306641
local_in_edges_tensor generation:  0.018180370330810547
mini_batch_src_global generation:  0.016022682189941406
r_  generation:  0.1326436996459961
local_output_nid generation:  0.007349252700805664
local_in_edges_tensor generation:  0.010531902313232422
mini_batch_src_global generation:  0.023459672927856445
r_  generation:  0.14263272285461426
local_output_nid generation:  0.00754237174987793
local_in_edges_tensor generation:  0.031290292739868164
mini_batch_src_global generation:  0.020601987838745117
r_  generation:  0.14769864082336426
local_output_nid generation:  0.008920669555664062
local_in_edges_tensor generation:  0.010049581527709961
mini_batch_src_global generation:  0.023483991622924805
r_  generation:  0.15123558044433594
local_output_nid generation:  0.008311748504638672
local_in_edges_tensor generation:  0.007778644561767578
mini_batch_src_global generation:  0.029851436614990234
r_  generation:  0.17773175239562988
local_output_nid generation:  0.009611129760742188
local_in_edges_tensor generation:  0.008052587509155273
mini_batch_src_global generation:  0.021526813507080078
r_  generation:  0.1633901596069336
local_output_nid generation:  0.010456562042236328
local_in_edges_tensor generation:  0.00844573974609375
mini_batch_src_global generation:  0.021472930908203125
r_  generation:  0.15584611892700195
local_output_nid generation:  0.008376121520996094
local_in_edges_tensor generation:  0.00858616828918457
mini_batch_src_global generation:  0.020795822143554688
r_  generation:  0.17729687690734863
local_output_nid generation:  0.014514684677124023
local_in_edges_tensor generation:  0.011357307434082031
mini_batch_src_global generation:  0.022374629974365234
r_  generation:  0.17738890647888184
local_output_nid generation:  0.014081239700317383
local_in_edges_tensor generation:  0.011167526245117188
mini_batch_src_global generation:  0.021151304244995117
r_  generation:  0.1726365089416504
local_output_nid generation:  0.013312101364135742
local_in_edges_tensor generation:  0.010323047637939453
mini_batch_src_global generation:  0.01948714256286621
r_  generation:  0.15937232971191406
local_output_nid generation:  0.009877681732177734
local_in_edges_tensor generation:  0.011474132537841797
mini_batch_src_global generation:  0.018317461013793945
r_  generation:  0.14612960815429688
local_output_nid generation:  0.009997844696044922
local_in_edges_tensor generation:  0.008405208587646484
mini_batch_src_global generation:  0.019068241119384766
r_  generation:  0.15909051895141602
local_output_nid generation:  0.00946950912475586
local_in_edges_tensor generation:  0.009851455688476562
mini_batch_src_global generation:  0.019273996353149414
r_  generation:  0.1564342975616455
local_output_nid generation:  0.009373188018798828
local_in_edges_tensor generation:  0.009005069732666016
mini_batch_src_global generation:  0.018733739852905273
r_  generation:  0.15548253059387207
local_output_nid generation:  0.0090789794921875
local_in_edges_tensor generation:  0.010568618774414062
mini_batch_src_global generation:  0.02640676498413086
r_  generation:  0.15750479698181152
local_output_nid generation:  0.009041309356689453
local_in_edges_tensor generation:  0.007945537567138672
mini_batch_src_global generation:  0.030526161193847656
r_  generation:  0.1567363739013672
local_output_nid generation:  0.009140968322753906
local_in_edges_tensor generation:  0.007891416549682617
mini_batch_src_global generation:  0.01921844482421875
r_  generation:  0.14969420433044434
local_output_nid generation:  0.009454727172851562
local_in_edges_tensor generation:  0.008837223052978516
mini_batch_src_global generation:  0.02001190185546875
r_  generation:  0.16150283813476562
local_output_nid generation:  0.008892536163330078
local_in_edges_tensor generation:  0.00861215591430664
mini_batch_src_global generation:  0.018613338470458984
r_  generation:  0.15029001235961914
local_output_nid generation:  0.010514259338378906
local_in_edges_tensor generation:  0.008047342300415039
mini_batch_src_global generation:  0.01798868179321289
r_  generation:  0.1600966453552246
local_output_nid generation:  0.009237289428710938
local_in_edges_tensor generation:  0.008639812469482422
mini_batch_src_global generation:  0.018829822540283203
r_  generation:  0.1566925048828125
local_output_nid generation:  0.009353160858154297
local_in_edges_tensor generation:  0.012080907821655273
mini_batch_src_global generation:  0.021234989166259766
r_  generation:  0.19723176956176758
local_output_nid generation:  0.011816978454589844
local_in_edges_tensor generation:  0.008462190628051758
mini_batch_src_global generation:  0.02292180061340332
r_  generation:  0.15766668319702148
local_output_nid generation:  0.009218215942382812
local_in_edges_tensor generation:  0.010165691375732422
mini_batch_src_global generation:  0.018260955810546875
r_  generation:  0.15441298484802246
local_output_nid generation:  0.009254932403564453
local_in_edges_tensor generation:  0.009475469589233398
mini_batch_src_global generation:  0.019365310668945312
r_  generation:  0.1591489315032959
local_output_nid generation:  0.009113788604736328
local_in_edges_tensor generation:  0.009830713272094727
mini_batch_src_global generation:  0.021205902099609375
r_  generation:  0.17124509811401367
local_output_nid generation:  0.009301900863647461
local_in_edges_tensor generation:  0.011721134185791016
mini_batch_src_global generation:  0.020707130432128906
r_  generation:  0.1608443260192871
local_output_nid generation:  0.00866246223449707
local_in_edges_tensor generation:  0.009618282318115234
mini_batch_src_global generation:  0.018204927444458008
r_  generation:  0.15341639518737793
local_output_nid generation:  0.009576559066772461
local_in_edges_tensor generation:  0.00812387466430664
mini_batch_src_global generation:  0.020790576934814453
r_  generation:  0.1512305736541748
local_output_nid generation:  0.008652925491333008
local_in_edges_tensor generation:  0.00833439826965332
mini_batch_src_global generation:  0.018241167068481445
r_  generation:  0.15412354469299316
local_output_nid generation:  0.008818864822387695
local_in_edges_tensor generation:  0.010252714157104492
mini_batch_src_global generation:  0.021175146102905273
r_  generation:  0.1554887294769287
----------------------check_connections_block total spend ----------------------------- 7.585392475128174
generate_one_block  0.21511387825012207
generate_one_block  0.20116281509399414
generate_one_block  0.19811320304870605
generate_one_block  0.206559419631958
generate_one_block  0.2318274974822998
generate_one_block  0.19774460792541504
generate_one_block  0.20559191703796387
generate_one_block  0.20612215995788574
generate_one_block  0.21012020111083984
generate_one_block  0.20352625846862793
generate_one_block  0.2078862190246582
generate_one_block  0.1968069076538086
generate_one_block  0.21027779579162598
generate_one_block  0.20839691162109375
generate_one_block  0.20326924324035645
generate_one_block  0.19996929168701172
generate_one_block  0.19781208038330078
generate_one_block  0.19880414009094238
generate_one_block  0.2132093906402588
generate_one_block  0.19916677474975586
generate_one_block  0.19409680366516113
generate_one_block  0.1939854621887207
generate_one_block  0.2043323516845703
generate_one_block  0.19968152046203613
generate_one_block  0.19766902923583984
generate_one_block  0.20937633514404297
generate_one_block  0.2151036262512207
generate_one_block  0.2048492431640625
generate_one_block  0.19440150260925293
generate_one_block  0.19450712203979492
generate_one_block  0.19816184043884277
generate_one_block  0.20157909393310547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036835670471191406
gen group dst list time:  0.10714459419250488
time for parepare:  0.019049406051635742
local_output_nid generation:  0.024141311645507812
local_in_edges_tensor generation:  0.04705691337585449
mini_batch_src_global generation:  0.05009293556213379
r_  generation:  0.4076194763183594
local_output_nid generation:  0.0286405086517334
local_in_edges_tensor generation:  0.031239748001098633
mini_batch_src_global generation:  0.05061602592468262
r_  generation:  0.40613722801208496
local_output_nid generation:  0.027491092681884766
local_in_edges_tensor generation:  0.02849745750427246
mini_batch_src_global generation:  0.04703044891357422
r_  generation:  0.4111626148223877
local_output_nid generation:  0.027291536331176758
local_in_edges_tensor generation:  0.03049325942993164
mini_batch_src_global generation:  0.0487518310546875
r_  generation:  0.4276416301727295
local_output_nid generation:  0.027184009552001953
local_in_edges_tensor generation:  0.03006601333618164
mini_batch_src_global generation:  0.047707319259643555
r_  generation:  0.4267425537109375
local_output_nid generation:  0.02806997299194336
local_in_edges_tensor generation:  0.03461718559265137
mini_batch_src_global generation:  0.05321502685546875
r_  generation:  0.4214954376220703
local_output_nid generation:  0.02757740020751953
local_in_edges_tensor generation:  0.031157732009887695
mini_batch_src_global generation:  0.05150032043457031
r_  generation:  0.42465639114379883
local_output_nid generation:  0.03063488006591797
local_in_edges_tensor generation:  0.02678227424621582
mini_batch_src_global generation:  0.058534860610961914
r_  generation:  0.41210103034973145
local_output_nid generation:  0.029098033905029297
local_in_edges_tensor generation:  0.027559280395507812
mini_batch_src_global generation:  0.05050539970397949
r_  generation:  0.41787171363830566
local_output_nid generation:  0.028115510940551758
local_in_edges_tensor generation:  0.025331974029541016
mini_batch_src_global generation:  0.04873943328857422
r_  generation:  0.4109995365142822
local_output_nid generation:  0.02854180335998535
local_in_edges_tensor generation:  0.025493860244750977
mini_batch_src_global generation:  0.04815864562988281
r_  generation:  0.4167308807373047
local_output_nid generation:  0.02797675132751465
local_in_edges_tensor generation:  0.02986931800842285
mini_batch_src_global generation:  0.04837346076965332
r_  generation:  0.4075627326965332
local_output_nid generation:  0.028501510620117188
local_in_edges_tensor generation:  0.027477025985717773
mini_batch_src_global generation:  0.048213958740234375
r_  generation:  0.41796302795410156
local_output_nid generation:  0.028272628784179688
local_in_edges_tensor generation:  0.027295351028442383
mini_batch_src_global generation:  0.049535512924194336
r_  generation:  0.42946410179138184
local_output_nid generation:  0.02835845947265625
local_in_edges_tensor generation:  0.027710437774658203
mini_batch_src_global generation:  0.0487673282623291
r_  generation:  0.42386674880981445
local_output_nid generation:  0.029005050659179688
local_in_edges_tensor generation:  0.031996726989746094
mini_batch_src_global generation:  0.056619882583618164
r_  generation:  0.41925048828125
local_output_nid generation:  0.028441905975341797
local_in_edges_tensor generation:  0.037725210189819336
mini_batch_src_global generation:  0.04775571823120117
r_  generation:  0.41884684562683105
local_output_nid generation:  0.02967214584350586
local_in_edges_tensor generation:  0.030443668365478516
mini_batch_src_global generation:  0.04862189292907715
r_  generation:  0.41279101371765137
local_output_nid generation:  0.02874588966369629
local_in_edges_tensor generation:  0.03683042526245117
mini_batch_src_global generation:  0.0487213134765625
r_  generation:  0.4245121479034424
local_output_nid generation:  0.028248310089111328
local_in_edges_tensor generation:  0.030345916748046875
mini_batch_src_global generation:  0.04866909980773926
r_  generation:  0.42678380012512207
local_output_nid generation:  0.03062272071838379
local_in_edges_tensor generation:  0.02902364730834961
mini_batch_src_global generation:  0.049082040786743164
r_  generation:  0.41800522804260254
local_output_nid generation:  0.027677297592163086
local_in_edges_tensor generation:  0.028141260147094727
mini_batch_src_global generation:  0.04824352264404297
r_  generation:  0.403839111328125
local_output_nid generation:  0.02812790870666504
local_in_edges_tensor generation:  0.02570033073425293
mini_batch_src_global generation:  0.04735088348388672
r_  generation:  0.4107856750488281
local_output_nid generation:  0.02821183204650879
local_in_edges_tensor generation:  0.029381513595581055
mini_batch_src_global generation:  0.048476219177246094
r_  generation:  0.41002607345581055
local_output_nid generation:  0.0287630558013916
local_in_edges_tensor generation:  0.025646448135375977
mini_batch_src_global generation:  0.04772019386291504
r_  generation:  0.41669178009033203
local_output_nid generation:  0.02831578254699707
local_in_edges_tensor generation:  0.028701305389404297
mini_batch_src_global generation:  0.049161434173583984
r_  generation:  0.41559863090515137
local_output_nid generation:  0.028671741485595703
local_in_edges_tensor generation:  0.028846263885498047
mini_batch_src_global generation:  0.04839658737182617
r_  generation:  0.41846323013305664
local_output_nid generation:  0.028578758239746094
local_in_edges_tensor generation:  0.02566671371459961
mini_batch_src_global generation:  0.07192015647888184
r_  generation:  0.41484642028808594
local_output_nid generation:  0.02840566635131836
local_in_edges_tensor generation:  0.026193857192993164
mini_batch_src_global generation:  0.04729151725769043
r_  generation:  0.41710972785949707
local_output_nid generation:  0.029125690460205078
local_in_edges_tensor generation:  0.026676177978515625
mini_batch_src_global generation:  0.049701690673828125
r_  generation:  0.41510558128356934
local_output_nid generation:  0.02851581573486328
local_in_edges_tensor generation:  0.03282475471496582
mini_batch_src_global generation:  0.04892086982727051
r_  generation:  0.4236431121826172
local_output_nid generation:  0.028595924377441406
local_in_edges_tensor generation:  0.031931161880493164
mini_batch_src_global generation:  0.04887080192565918
r_  generation:  0.41806936264038086
----------------------check_connections_block total spend ----------------------------- 19.778369903564453
generate_one_block  0.5600833892822266
generate_one_block  0.5533604621887207
generate_one_block  0.5552809238433838
generate_one_block  0.5575690269470215
generate_one_block  0.6537888050079346
generate_one_block  0.5488431453704834
generate_one_block  0.5580649375915527
generate_one_block  0.5570073127746582
generate_one_block  0.5590529441833496
generate_one_block  0.5529465675354004
generate_one_block  0.5523562431335449
generate_one_block  0.5472135543823242
generate_one_block  0.5612843036651611
generate_one_block  0.5723354816436768
generate_one_block  0.5572986602783203
generate_one_block  0.5503106117248535
generate_one_block  0.5487000942230225
generate_one_block  0.5539860725402832
generate_one_block  0.5623636245727539
generate_one_block  0.5484659671783447
generate_one_block  0.5536041259765625
generate_one_block  0.5544319152832031
generate_one_block  0.5561065673828125
generate_one_block  0.5622916221618652
generate_one_block  0.5813770294189453
generate_one_block  0.5683314800262451
generate_one_block  0.5685944557189941
generate_one_block  0.5687265396118164
generate_one_block  0.5495419502258301
generate_one_block  0.5502603054046631
generate_one_block  0.5544538497924805
generate_one_block  0.5589306354522705
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.12309646606445312  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

connection checking time:  27.363762378692627
block generation total time  24.45618724822998
average batch blocks generation time:  0.7642558515071869
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10518646240234375  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.611558437347412  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10476827621459961  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.77363681793213  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10523605346679688  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.88883686065674  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10487985610961914  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 17.206833839416504  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10523748397827148  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.850769519805908  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10465335845947266  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.784799098968506  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10527706146240234  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 17.091111183166504  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10450458526611328  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.961689472198486  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.1053318977355957  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 17.27216339111328  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10462474822998047  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 16.959710121154785  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.1053013801574707  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.128572463989258  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10452079772949219  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.520183563232422  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10531902313232422  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.272149562835693  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10476207733154297  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.116311073303223  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10526609420776367  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.07712745666504  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10465335845947266  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.779932975769043  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10520410537719727  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.705759525299072  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10455036163330078  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.683842658996582  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10531187057495117  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.227617740631104  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10447978973388672  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.5553240776062  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10519695281982422  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.71278667449951  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10427570343017578  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.462343215942383  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.1052560806274414  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.940031051635742  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10447072982788086  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.73469877243042  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10521984100341797  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.80332612991333  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.1045846939086914  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.258198261260986  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.1053471565246582  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.331826210021973  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10491561889648438  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.207642078399658  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10518789291381836  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.639147758483887  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.1045985221862793  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.760498523712158  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.1052236557006836  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.80423879623413  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10471057891845703  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.9263973236084  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025393657386302948 |0.016445569694042206 |0.4202985167503357 |9.638816118240356e-05 |0.9494649767875671 |0.005463123321533203 |
----------------------------------------------------------pseudo_mini_loss sum 3.510920524597168
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  8793140
Number of first layer input nodes during this epoch:  4679936
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.12351417541503906  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025843381881713867
range selection method range initialization spend 0.013301372528076172
time for parepare:  0.020441055297851562
local_output_nid generation:  0.0009257793426513672
local_in_edges_tensor generation:  0.008008956909179688
mini_batch_src_global generation:  0.0016696453094482422
r_  generation:  0.010515928268432617
local_output_nid generation:  0.0009541511535644531
local_in_edges_tensor generation:  0.0006706714630126953
mini_batch_src_global generation:  0.0014615058898925781
r_  generation:  0.010292530059814453
local_output_nid generation:  0.0009000301361083984
local_in_edges_tensor generation:  0.0006353855133056641
mini_batch_src_global generation:  0.0012023448944091797
r_  generation:  0.010051965713500977
local_output_nid generation:  0.0008816719055175781
local_in_edges_tensor generation:  0.0007641315460205078
mini_batch_src_global generation:  0.0010869503021240234
r_  generation:  0.009721755981445312
local_output_nid generation:  0.0008738040924072266
local_in_edges_tensor generation:  0.0005850791931152344
mini_batch_src_global generation:  0.0012083053588867188
r_  generation:  0.010284185409545898
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005998611450195312
mini_batch_src_global generation:  0.0010993480682373047
r_  generation:  0.010345935821533203
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0005652904510498047
mini_batch_src_global generation:  0.0011272430419921875
r_  generation:  0.010095596313476562
local_output_nid generation:  0.0008676052093505859
local_in_edges_tensor generation:  0.0005793571472167969
mini_batch_src_global generation:  0.0010874271392822266
r_  generation:  0.010334491729736328
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0005481243133544922
mini_batch_src_global generation:  0.0010752677917480469
r_  generation:  0.009817361831665039
local_output_nid generation:  0.0009050369262695312
local_in_edges_tensor generation:  0.0005545616149902344
mini_batch_src_global generation:  0.0010540485382080078
r_  generation:  0.01020503044128418
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.0012426376342773438
r_  generation:  0.010897636413574219
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.000553131103515625
mini_batch_src_global generation:  0.0011165142059326172
r_  generation:  0.010113000869750977
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.0011413097381591797
r_  generation:  0.01047658920288086
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0006160736083984375
mini_batch_src_global generation:  0.0011947154998779297
r_  generation:  0.010287046432495117
local_output_nid generation:  0.0008754730224609375
local_in_edges_tensor generation:  0.0005686283111572266
mini_batch_src_global generation:  0.0011229515075683594
r_  generation:  0.010645389556884766
local_output_nid generation:  0.0009109973907470703
local_in_edges_tensor generation:  0.0005815029144287109
mini_batch_src_global generation:  0.0012028217315673828
r_  generation:  0.010098457336425781
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.0005784034729003906
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.010430097579956055
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0005457401275634766
mini_batch_src_global generation:  0.0011899471282958984
r_  generation:  0.010033845901489258
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.0005533695220947266
mini_batch_src_global generation:  0.0011739730834960938
r_  generation:  0.009998798370361328
local_output_nid generation:  0.0008757114410400391
local_in_edges_tensor generation:  0.0005631446838378906
mini_batch_src_global generation:  0.0012793540954589844
r_  generation:  0.010799884796142578
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0005846023559570312
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.010235786437988281
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0005550384521484375
mini_batch_src_global generation:  0.0011515617370605469
r_  generation:  0.010347843170166016
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.0011031627655029297
r_  generation:  0.010144710540771484
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0011143684387207031
r_  generation:  0.01044464111328125
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0005772113800048828
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010350942611694336
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0005598068237304688
mini_batch_src_global generation:  0.001123666763305664
r_  generation:  0.010523557662963867
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0005872249603271484
mini_batch_src_global generation:  0.001230478286743164
r_  generation:  0.01080775260925293
local_output_nid generation:  0.0008828639984130859
local_in_edges_tensor generation:  0.00054931640625
mini_batch_src_global generation:  0.0011408329010009766
r_  generation:  0.010361194610595703
local_output_nid generation:  0.0008904933929443359
local_in_edges_tensor generation:  0.0005555152893066406
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.010459184646606445
local_output_nid generation:  0.0008571147918701172
local_in_edges_tensor generation:  0.0005373954772949219
mini_batch_src_global generation:  0.0011262893676757812
r_  generation:  0.010483980178833008
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0005340576171875
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010489463806152344
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0005314350128173828
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.010284423828125
----------------------check_connections_block total spend ----------------------------- 0.5212292671203613
generate_one_block  0.024204492568969727
generate_one_block  0.018904685974121094
generate_one_block  0.018270254135131836
generate_one_block  0.01710987091064453
generate_one_block  0.018050432205200195
generate_one_block  0.01788187026977539
generate_one_block  0.01727437973022461
generate_one_block  0.017730712890625
generate_one_block  0.016869544982910156
generate_one_block  0.017255067825317383
generate_one_block  0.018275976181030273
generate_one_block  0.0171358585357666
generate_one_block  0.01783466339111328
generate_one_block  0.017320871353149414
generate_one_block  0.020809650421142578
generate_one_block  0.017123699188232422
generate_one_block  0.017228364944458008
generate_one_block  0.016710996627807617
generate_one_block  0.01696324348449707
generate_one_block  0.018166542053222656
generate_one_block  0.017091035842895508
generate_one_block  0.017052173614501953
generate_one_block  0.01714491844177246
generate_one_block  0.017441272735595703
generate_one_block  0.017380475997924805
generate_one_block  0.01745152473449707
generate_one_block  0.01778721809387207
generate_one_block  0.01717686653137207
generate_one_block  0.017198801040649414
generate_one_block  0.01713109016418457
generate_one_block  0.017433881759643555
generate_one_block  0.017019987106323242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03628706932067871
gen group dst list time:  0.02279376983642578
time for parepare:  0.01987004280090332
local_output_nid generation:  0.0049550533294677734
local_in_edges_tensor generation:  0.0255582332611084
mini_batch_src_global generation:  0.013951301574707031
r_  generation:  0.13178086280822754
local_output_nid generation:  0.0069196224212646484
local_in_edges_tensor generation:  0.00951528549194336
mini_batch_src_global generation:  0.015926599502563477
r_  generation:  0.13315439224243164
local_output_nid generation:  0.007564544677734375
local_in_edges_tensor generation:  0.02816462516784668
mini_batch_src_global generation:  0.015725135803222656
r_  generation:  0.14651274681091309
local_output_nid generation:  0.007414102554321289
local_in_edges_tensor generation:  0.00823831558227539
mini_batch_src_global generation:  0.015842437744140625
r_  generation:  0.1409473419189453
local_output_nid generation:  0.008313655853271484
local_in_edges_tensor generation:  0.008602142333984375
mini_batch_src_global generation:  0.018448591232299805
r_  generation:  0.15408062934875488
local_output_nid generation:  0.008501052856445312
local_in_edges_tensor generation:  0.008473873138427734
mini_batch_src_global generation:  0.017951011657714844
r_  generation:  0.15590858459472656
local_output_nid generation:  0.008330583572387695
local_in_edges_tensor generation:  0.010368585586547852
mini_batch_src_global generation:  0.017659902572631836
r_  generation:  0.14754986763000488
local_output_nid generation:  0.008468151092529297
local_in_edges_tensor generation:  0.008711814880371094
mini_batch_src_global generation:  0.01853346824645996
r_  generation:  0.1526176929473877
local_output_nid generation:  0.00798177719116211
local_in_edges_tensor generation:  0.008260011672973633
mini_batch_src_global generation:  0.018336057662963867
r_  generation:  0.14693856239318848
local_output_nid generation:  0.008295059204101562
local_in_edges_tensor generation:  0.007836341857910156
mini_batch_src_global generation:  0.01779794692993164
r_  generation:  0.1494135856628418
local_output_nid generation:  0.008751630783081055
local_in_edges_tensor generation:  0.008423328399658203
mini_batch_src_global generation:  0.01925802230834961
r_  generation:  0.16070151329040527
local_output_nid generation:  0.008404254913330078
local_in_edges_tensor generation:  0.007924318313598633
mini_batch_src_global generation:  0.018609285354614258
r_  generation:  0.14938068389892578
local_output_nid generation:  0.008907079696655273
local_in_edges_tensor generation:  0.008213281631469727
mini_batch_src_global generation:  0.01880931854248047
r_  generation:  0.15622997283935547
local_output_nid generation:  0.008764982223510742
local_in_edges_tensor generation:  0.008811235427856445
mini_batch_src_global generation:  0.019217967987060547
r_  generation:  0.15303611755371094
local_output_nid generation:  0.008881568908691406
local_in_edges_tensor generation:  0.009399175643920898
mini_batch_src_global generation:  0.01899552345275879
r_  generation:  0.15585756301879883
local_output_nid generation:  0.008425235748291016
local_in_edges_tensor generation:  0.007930755615234375
mini_batch_src_global generation:  0.01807379722595215
r_  generation:  0.14825940132141113
local_output_nid generation:  0.00861048698425293
local_in_edges_tensor generation:  0.00817418098449707
mini_batch_src_global generation:  0.01836419105529785
r_  generation:  0.15271711349487305
local_output_nid generation:  0.008448600769042969
local_in_edges_tensor generation:  0.008027076721191406
mini_batch_src_global generation:  0.018027305603027344
r_  generation:  0.14714264869689941
local_output_nid generation:  0.008643150329589844
local_in_edges_tensor generation:  0.008184432983398438
mini_batch_src_global generation:  0.018761873245239258
r_  generation:  0.1512165069580078
local_output_nid generation:  0.009209394454956055
local_in_edges_tensor generation:  0.009570598602294922
mini_batch_src_global generation:  0.019420385360717773
r_  generation:  0.16174054145812988
local_output_nid generation:  0.008619070053100586
local_in_edges_tensor generation:  0.008276939392089844
mini_batch_src_global generation:  0.02095174789428711
r_  generation:  0.1510179042816162
local_output_nid generation:  0.008767366409301758
local_in_edges_tensor generation:  0.008677005767822266
mini_batch_src_global generation:  0.01884937286376953
r_  generation:  0.15276789665222168
local_output_nid generation:  0.008871793746948242
local_in_edges_tensor generation:  0.008734703063964844
mini_batch_src_global generation:  0.019472122192382812
r_  generation:  0.15484619140625
local_output_nid generation:  0.008855581283569336
local_in_edges_tensor generation:  0.009067058563232422
mini_batch_src_global generation:  0.018928050994873047
r_  generation:  0.1585988998413086
local_output_nid generation:  0.00890660285949707
local_in_edges_tensor generation:  0.00826883316040039
mini_batch_src_global generation:  0.018650054931640625
r_  generation:  0.15563750267028809
local_output_nid generation:  0.008953332901000977
local_in_edges_tensor generation:  0.008319377899169922
mini_batch_src_global generation:  0.01891636848449707
r_  generation:  0.1569221019744873
local_output_nid generation:  0.009102821350097656
local_in_edges_tensor generation:  0.009752750396728516
mini_batch_src_global generation:  0.0193328857421875
r_  generation:  0.16312384605407715
local_output_nid generation:  0.008775949478149414
local_in_edges_tensor generation:  0.008437633514404297
mini_batch_src_global generation:  0.019815921783447266
r_  generation:  0.15441322326660156
local_output_nid generation:  0.008879899978637695
local_in_edges_tensor generation:  0.008358955383300781
mini_batch_src_global generation:  0.01857280731201172
r_  generation:  0.15823626518249512
local_output_nid generation:  0.00876760482788086
local_in_edges_tensor generation:  0.008445501327514648
mini_batch_src_global generation:  0.01858687400817871
r_  generation:  0.1565697193145752
local_output_nid generation:  0.008896589279174805
local_in_edges_tensor generation:  0.00890803337097168
mini_batch_src_global generation:  0.020025014877319336
r_  generation:  0.15838360786437988
local_output_nid generation:  0.008414030075073242
local_in_edges_tensor generation:  0.009497404098510742
mini_batch_src_global generation:  0.018482685089111328
r_  generation:  0.15401601791381836
----------------------check_connections_block total spend ----------------------------- 7.194483518600464
generate_one_block  0.2005476951599121
generate_one_block  0.18785452842712402
generate_one_block  0.2019960880279541
generate_one_block  0.19233942031860352
generate_one_block  0.23643827438354492
generate_one_block  0.20206809043884277
generate_one_block  0.1920466423034668
generate_one_block  0.2048509120941162
generate_one_block  0.19311237335205078
generate_one_block  0.19667649269104004
generate_one_block  0.2182009220123291
generate_one_block  0.1976606845855713
generate_one_block  0.20435619354248047
generate_one_block  0.20205092430114746
generate_one_block  0.2059004306793213
generate_one_block  0.19256353378295898
generate_one_block  0.1986703872680664
generate_one_block  0.19529366493225098
generate_one_block  0.19675612449645996
generate_one_block  0.21715235710144043
generate_one_block  0.19718575477600098
generate_one_block  0.19644856452941895
generate_one_block  0.20280933380126953
generate_one_block  0.20659422874450684
generate_one_block  0.2006380558013916
generate_one_block  0.21149349212646484
generate_one_block  0.211578369140625
generate_one_block  0.1993105411529541
generate_one_block  0.20180630683898926
generate_one_block  0.19931364059448242
generate_one_block  0.20742535591125488
generate_one_block  0.1964423656463623
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033896446228027344
gen group dst list time:  0.10282278060913086
time for parepare:  0.01815056800842285
local_output_nid generation:  0.023562908172607422
local_in_edges_tensor generation:  0.051059722900390625
mini_batch_src_global generation:  0.03700661659240723
r_  generation:  0.4021642208099365
local_output_nid generation:  0.028048992156982422
local_in_edges_tensor generation:  0.032701730728149414
mini_batch_src_global generation:  0.04775238037109375
r_  generation:  0.3896782398223877
local_output_nid generation:  0.027823686599731445
local_in_edges_tensor generation:  0.029315948486328125
mini_batch_src_global generation:  0.04614090919494629
r_  generation:  0.4127311706542969
local_output_nid generation:  0.026951074600219727
local_in_edges_tensor generation:  0.03004765510559082
mini_batch_src_global generation:  0.04814410209655762
r_  generation:  0.4031076431274414
local_output_nid generation:  0.027299165725708008
local_in_edges_tensor generation:  0.030364274978637695
mini_batch_src_global generation:  0.04929041862487793
r_  generation:  0.42026758193969727
local_output_nid generation:  0.02740788459777832
local_in_edges_tensor generation:  0.03044414520263672
mini_batch_src_global generation:  0.049243927001953125
r_  generation:  0.41038084030151367
local_output_nid generation:  0.0273282527923584
local_in_edges_tensor generation:  0.026366472244262695
mini_batch_src_global generation:  0.04771137237548828
r_  generation:  0.4159579277038574
local_output_nid generation:  0.0273740291595459
local_in_edges_tensor generation:  0.02745199203491211
mini_batch_src_global generation:  0.048862457275390625
r_  generation:  0.40934276580810547
local_output_nid generation:  0.02712535858154297
local_in_edges_tensor generation:  0.02687358856201172
mini_batch_src_global generation:  0.04746580123901367
r_  generation:  0.41471266746520996
local_output_nid generation:  0.027232885360717773
local_in_edges_tensor generation:  0.028489351272583008
mini_batch_src_global generation:  0.04888153076171875
r_  generation:  0.40508055686950684
local_output_nid generation:  0.027517318725585938
local_in_edges_tensor generation:  0.029875993728637695
mini_batch_src_global generation:  0.049308061599731445
r_  generation:  0.4191861152648926
local_output_nid generation:  0.027234315872192383
local_in_edges_tensor generation:  0.0261538028717041
mini_batch_src_global generation:  0.048797607421875
r_  generation:  0.4035487174987793
local_output_nid generation:  0.027533531188964844
local_in_edges_tensor generation:  0.0260159969329834
mini_batch_src_global generation:  0.049460649490356445
r_  generation:  0.4176981449127197
local_output_nid generation:  0.027317523956298828
local_in_edges_tensor generation:  0.03239870071411133
mini_batch_src_global generation:  0.04984402656555176
r_  generation:  0.4063756465911865
local_output_nid generation:  0.027614593505859375
local_in_edges_tensor generation:  0.02707529067993164
mini_batch_src_global generation:  0.04715752601623535
r_  generation:  0.41816115379333496
local_output_nid generation:  0.027228116989135742
local_in_edges_tensor generation:  0.026175260543823242
mini_batch_src_global generation:  0.04847145080566406
r_  generation:  0.4064149856567383
local_output_nid generation:  0.02727985382080078
local_in_edges_tensor generation:  0.026753664016723633
mini_batch_src_global generation:  0.04697084426879883
r_  generation:  0.4148063659667969
local_output_nid generation:  0.027090787887573242
local_in_edges_tensor generation:  0.0265500545501709
mini_batch_src_global generation:  0.0484004020690918
r_  generation:  0.404538631439209
local_output_nid generation:  0.02761101722717285
local_in_edges_tensor generation:  0.029676198959350586
mini_batch_src_global generation:  0.047324419021606445
r_  generation:  0.41873717308044434
local_output_nid generation:  0.02796006202697754
local_in_edges_tensor generation:  0.03218865394592285
mini_batch_src_global generation:  0.04894733428955078
r_  generation:  0.4129369258880615
local_output_nid generation:  0.027689456939697266
local_in_edges_tensor generation:  0.02752971649169922
mini_batch_src_global generation:  0.047393798828125
r_  generation:  0.42054057121276855
local_output_nid generation:  0.02758932113647461
local_in_edges_tensor generation:  0.02565622329711914
mini_batch_src_global generation:  0.04864978790283203
r_  generation:  0.41109228134155273
local_output_nid generation:  0.02779388427734375
local_in_edges_tensor generation:  0.026484251022338867
mini_batch_src_global generation:  0.04731941223144531
r_  generation:  0.42336487770080566
local_output_nid generation:  0.02765798568725586
local_in_edges_tensor generation:  0.03180193901062012
mini_batch_src_global generation:  0.05060243606567383
r_  generation:  0.41265344619750977
local_output_nid generation:  0.027736902236938477
local_in_edges_tensor generation:  0.026215314865112305
mini_batch_src_global generation:  0.047539472579956055
r_  generation:  0.42049551010131836
local_output_nid generation:  0.02750110626220703
local_in_edges_tensor generation:  0.02620673179626465
mini_batch_src_global generation:  0.048835039138793945
r_  generation:  0.41019773483276367
local_output_nid generation:  0.027559995651245117
local_in_edges_tensor generation:  0.02963113784790039
mini_batch_src_global generation:  0.04768514633178711
r_  generation:  0.4198153018951416
local_output_nid generation:  0.02763509750366211
local_in_edges_tensor generation:  0.026143789291381836
mini_batch_src_global generation:  0.05103302001953125
r_  generation:  0.4087047576904297
local_output_nid generation:  0.027775287628173828
local_in_edges_tensor generation:  0.026998043060302734
mini_batch_src_global generation:  0.04709887504577637
r_  generation:  0.41903257369995117
local_output_nid generation:  0.02760028839111328
local_in_edges_tensor generation:  0.029173612594604492
mini_batch_src_global generation:  0.04918408393859863
r_  generation:  0.40816164016723633
local_output_nid generation:  0.02756476402282715
local_in_edges_tensor generation:  0.02957320213317871
mini_batch_src_global generation:  0.04728841781616211
r_  generation:  0.4203016757965088
local_output_nid generation:  0.02780294418334961
local_in_edges_tensor generation:  0.02732992172241211
mini_batch_src_global generation:  0.048539161682128906
r_  generation:  0.40923309326171875
----------------------check_connections_block total spend ----------------------------- 19.50582194328308
generate_one_block  0.556041955947876
generate_one_block  0.5358481407165527
generate_one_block  0.5459415912628174
generate_one_block  0.5478017330169678
generate_one_block  0.6390049457550049
generate_one_block  0.5615191459655762
generate_one_block  0.5455355644226074
generate_one_block  0.5511424541473389
generate_one_block  0.5450224876403809
generate_one_block  0.5499610900878906
generate_one_block  0.565457820892334
generate_one_block  0.545677661895752
generate_one_block  0.5517773628234863
generate_one_block  0.5487935543060303
generate_one_block  0.558429479598999
generate_one_block  0.543245792388916
generate_one_block  0.5426473617553711
generate_one_block  0.5469334125518799
generate_one_block  0.557286262512207
generate_one_block  0.5609116554260254
generate_one_block  0.5497696399688721
generate_one_block  0.5510551929473877
generate_one_block  0.555877685546875
generate_one_block  0.5574667453765869
generate_one_block  0.5663783550262451
generate_one_block  0.553412675857544
generate_one_block  0.565298318862915
generate_one_block  0.5542337894439697
generate_one_block  0.5553944110870361
generate_one_block  0.5580554008483887
generate_one_block  0.5638015270233154
generate_one_block  0.5500550270080566
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.12351417541503906  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

connection checking time:  26.700305461883545
block generation total time  24.24735999107361
average batch blocks generation time:  0.7577299997210503
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10520792007446289  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.744438648223877  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10419511795043945  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.096088409423828  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10527515411376953  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.06862783432007  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10456466674804688  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.555540084838867  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10531949996948242  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.23611831665039  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10480833053588867  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.17496967315674  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10518217086791992  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.64304256439209  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10473966598510742  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.127521991729736  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.1051936149597168  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.605995655059814  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10459089279174805  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.721631050109863  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10536575317382812  GigaBytes
Max Memory Allocated: 17.41119909286499  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.375662326812744  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10437250137329102  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.81183910369873  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10527896881103516  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.13508176803589  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.104644775390625  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.007216930389404  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10529565811157227  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.16556453704834  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10445499420166016  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.453769207000732  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.1052398681640625  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.92401123046875  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10439157485961914  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.47377109527588  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10521602630615234  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.80044412612915  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10482358932495117  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.34532594680786  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10520315170288086  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.710751056671143  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10468482971191406  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.8035249710083  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10525655746459961  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.017287731170654  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10495233535766602  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.094890117645264  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.1052556037902832  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.942488193511963  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10462760925292969  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.110700607299805  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.1053466796875  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.359911918640137  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10454177856445312  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.88661289215088  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10525846481323242  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 17.079527854919434  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10464096069335938  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 16.852258682250977  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3260498046875 GB
    Memory Allocated: 0.10528993606567383  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3768310546875 GB
    Memory Allocated: 17.131688117980957  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10459756851196289  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.71275043487549  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03442341089248657 |0.016876116394996643 |0.4197798892855644 |9.848922491073608e-05 |0.7681975737214088 |0.005875110626220703 |
----------------------------------------------------------pseudo_mini_loss sum 2.793074131011963
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  8793913
Number of first layer input nodes during this epoch:  4681178
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.12205982208251953  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02504134178161621
range selection method range initialization spend 0.014984607696533203
time for parepare:  0.019368410110473633
local_output_nid generation:  0.0010318756103515625
local_in_edges_tensor generation:  0.006461381912231445
mini_batch_src_global generation:  0.0015063285827636719
r_  generation:  0.010617256164550781
local_output_nid generation:  0.0009834766387939453
local_in_edges_tensor generation:  0.0007722377777099609
mini_batch_src_global generation:  0.001508474349975586
r_  generation:  0.011169195175170898
local_output_nid generation:  0.0009243488311767578
local_in_edges_tensor generation:  0.0006544589996337891
mini_batch_src_global generation:  0.0010833740234375
r_  generation:  0.009432554244995117
local_output_nid generation:  0.0008904933929443359
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.0010912418365478516
r_  generation:  0.00971841812133789
local_output_nid generation:  0.0008764266967773438
local_in_edges_tensor generation:  0.0006966590881347656
mini_batch_src_global generation:  0.0010166168212890625
r_  generation:  0.00954127311706543
local_output_nid generation:  0.0008556842803955078
local_in_edges_tensor generation:  0.0006122589111328125
mini_batch_src_global generation:  0.0010495185852050781
r_  generation:  0.009824991226196289
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0006611347198486328
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.010502099990844727
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0006229877471923828
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.010201454162597656
local_output_nid generation:  0.0008387565612792969
local_in_edges_tensor generation:  0.0006139278411865234
mini_batch_src_global generation:  0.0010983943939208984
r_  generation:  0.010184049606323242
local_output_nid generation:  0.0008497238159179688
local_in_edges_tensor generation:  0.0005712509155273438
mini_batch_src_global generation:  0.0010805130004882812
r_  generation:  0.010006904602050781
local_output_nid generation:  0.0008509159088134766
local_in_edges_tensor generation:  0.0006866455078125
mini_batch_src_global generation:  0.0012371540069580078
r_  generation:  0.010324716567993164
local_output_nid generation:  0.0008399486541748047
local_in_edges_tensor generation:  0.0006051063537597656
mini_batch_src_global generation:  0.0010929107666015625
r_  generation:  0.010020971298217773
local_output_nid generation:  0.0008363723754882812
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0011065006256103516
r_  generation:  0.009864091873168945
local_output_nid generation:  0.0008556842803955078
local_in_edges_tensor generation:  0.0006003379821777344
mini_batch_src_global generation:  0.0011594295501708984
r_  generation:  0.010193109512329102
local_output_nid generation:  0.0008463859558105469
local_in_edges_tensor generation:  0.0006456375122070312
mini_batch_src_global generation:  0.0011272430419921875
r_  generation:  0.010372638702392578
local_output_nid generation:  0.0008728504180908203
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0011196136474609375
r_  generation:  0.010075569152832031
local_output_nid generation:  0.0008523464202880859
local_in_edges_tensor generation:  0.0005497932434082031
mini_batch_src_global generation:  0.0012350082397460938
r_  generation:  0.010452747344970703
local_output_nid generation:  0.0008552074432373047
local_in_edges_tensor generation:  0.0005528926849365234
mini_batch_src_global generation:  0.0010612010955810547
r_  generation:  0.010070085525512695
local_output_nid generation:  0.0008559226989746094
local_in_edges_tensor generation:  0.0006079673767089844
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.009998798370361328
local_output_nid generation:  0.0008530616760253906
local_in_edges_tensor generation:  0.0005679130554199219
mini_batch_src_global generation:  0.0011286735534667969
r_  generation:  0.010217666625976562
local_output_nid generation:  0.0008530616760253906
local_in_edges_tensor generation:  0.0005593299865722656
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.010364532470703125
local_output_nid generation:  0.0008394718170166016
local_in_edges_tensor generation:  0.0006134510040283203
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.010392904281616211
local_output_nid generation:  0.0008471012115478516
local_in_edges_tensor generation:  0.0005662441253662109
mini_batch_src_global generation:  0.001111745834350586
r_  generation:  0.010288000106811523
local_output_nid generation:  0.0008409023284912109
local_in_edges_tensor generation:  0.0005533695220947266
mini_batch_src_global generation:  0.001087188720703125
r_  generation:  0.010235309600830078
local_output_nid generation:  0.000843048095703125
local_in_edges_tensor generation:  0.0005710124969482422
mini_batch_src_global generation:  0.0011951923370361328
r_  generation:  0.010648727416992188
local_output_nid generation:  0.0008385181427001953
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.001134634017944336
r_  generation:  0.010322332382202148
local_output_nid generation:  0.0008516311645507812
local_in_edges_tensor generation:  0.0005614757537841797
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.010172605514526367
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0005507469177246094
mini_batch_src_global generation:  0.0011138916015625
r_  generation:  0.010260343551635742
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0011119842529296875
r_  generation:  0.010097026824951172
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.010128021240234375
local_output_nid generation:  0.0008447170257568359
local_in_edges_tensor generation:  0.0005550384521484375
mini_batch_src_global generation:  0.001210927963256836
r_  generation:  0.010536909103393555
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0005552768707275391
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.010493040084838867
----------------------check_connections_block total spend ----------------------------- 0.5139031410217285
generate_one_block  0.02413344383239746
generate_one_block  0.019327402114868164
generate_one_block  0.017363786697387695
generate_one_block  0.017208576202392578
generate_one_block  0.017093658447265625
generate_one_block  0.01709151268005371
generate_one_block  0.017928361892700195
generate_one_block  0.017344236373901367
generate_one_block  0.017431974411010742
generate_one_block  0.017009496688842773
generate_one_block  0.01757025718688965
generate_one_block  0.017102479934692383
generate_one_block  0.0166933536529541
generate_one_block  0.017226219177246094
generate_one_block  0.01750016212463379
generate_one_block  0.016997814178466797
generate_one_block  0.01743936538696289
generate_one_block  0.01692342758178711
generate_one_block  0.01691126823425293
generate_one_block  0.017188310623168945
generate_one_block  0.017554521560668945
generate_one_block  0.017204761505126953
generate_one_block  0.01733541488647461
generate_one_block  0.017319679260253906
generate_one_block  0.01787734031677246
generate_one_block  0.017607688903808594
generate_one_block  0.017658233642578125
generate_one_block  0.018013954162597656
generate_one_block  0.017176389694213867
generate_one_block  0.0169219970703125
generate_one_block  0.017478227615356445
generate_one_block  0.017439842224121094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036638498306274414
gen group dst list time:  0.022974491119384766
time for parepare:  0.021049976348876953
local_output_nid generation:  0.005341053009033203
local_in_edges_tensor generation:  0.01611495018005371
mini_batch_src_global generation:  0.01398015022277832
r_  generation:  0.1353926658630371
local_output_nid generation:  0.007305622100830078
local_in_edges_tensor generation:  0.009663581848144531
mini_batch_src_global generation:  0.0167238712310791
r_  generation:  0.1672060489654541
local_output_nid generation:  0.008212566375732422
local_in_edges_tensor generation:  0.02892613410949707
mini_batch_src_global generation:  0.018429040908813477
r_  generation:  0.1455702781677246
local_output_nid generation:  0.00774383544921875
local_in_edges_tensor generation:  0.008217334747314453
mini_batch_src_global generation:  0.016754150390625
r_  generation:  0.14669036865234375
local_output_nid generation:  0.00811457633972168
local_in_edges_tensor generation:  0.00868368148803711
mini_batch_src_global generation:  0.016846656799316406
r_  generation:  0.15376067161560059
local_output_nid generation:  0.009953737258911133
local_in_edges_tensor generation:  0.011644363403320312
mini_batch_src_global generation:  0.01859736442565918
r_  generation:  0.1508035659790039
local_output_nid generation:  0.008990287780761719
local_in_edges_tensor generation:  0.008691787719726562
mini_batch_src_global generation:  0.019326210021972656
r_  generation:  0.1547391414642334
local_output_nid generation:  0.00863337516784668
local_in_edges_tensor generation:  0.00812530517578125
mini_batch_src_global generation:  0.01847219467163086
r_  generation:  0.1525261402130127
local_output_nid generation:  0.008596181869506836
local_in_edges_tensor generation:  0.008768558502197266
mini_batch_src_global generation:  0.018416643142700195
r_  generation:  0.15680217742919922
local_output_nid generation:  0.008753538131713867
local_in_edges_tensor generation:  0.00813150405883789
mini_batch_src_global generation:  0.018085956573486328
r_  generation:  0.15099143981933594
local_output_nid generation:  0.009122848510742188
local_in_edges_tensor generation:  0.008244037628173828
mini_batch_src_global generation:  0.019400358200073242
r_  generation:  0.15635108947753906
local_output_nid generation:  0.008775949478149414
local_in_edges_tensor generation:  0.00812840461730957
mini_batch_src_global generation:  0.01834392547607422
r_  generation:  0.15112590789794922
local_output_nid generation:  0.008669376373291016
local_in_edges_tensor generation:  0.009147405624389648
mini_batch_src_global generation:  0.017652273178100586
r_  generation:  0.14653491973876953
local_output_nid generation:  0.008995532989501953
local_in_edges_tensor generation:  0.008128881454467773
mini_batch_src_global generation:  0.018060684204101562
r_  generation:  0.15154266357421875
local_output_nid generation:  0.009089231491088867
local_in_edges_tensor generation:  0.009507894515991211
mini_batch_src_global generation:  0.018920421600341797
r_  generation:  0.15837669372558594
local_output_nid generation:  0.008950233459472656
local_in_edges_tensor generation:  0.008123397827148438
mini_batch_src_global generation:  0.018625497817993164
r_  generation:  0.1506054401397705
local_output_nid generation:  0.009301185607910156
local_in_edges_tensor generation:  0.008857488632202148
mini_batch_src_global generation:  0.01952362060546875
r_  generation:  0.1589658260345459
local_output_nid generation:  0.00897359848022461
local_in_edges_tensor generation:  0.008491039276123047
mini_batch_src_global generation:  0.01871943473815918
r_  generation:  0.153411865234375
local_output_nid generation:  0.008830070495605469
local_in_edges_tensor generation:  0.008013486862182617
mini_batch_src_global generation:  0.018004655838012695
r_  generation:  0.15158605575561523
local_output_nid generation:  0.009019136428833008
local_in_edges_tensor generation:  0.008695125579833984
mini_batch_src_global generation:  0.01837778091430664
r_  generation:  0.15413308143615723
local_output_nid generation:  0.009307384490966797
local_in_edges_tensor generation:  0.008781671524047852
mini_batch_src_global generation:  0.01863884925842285
r_  generation:  0.15806221961975098
local_output_nid generation:  0.008981466293334961
local_in_edges_tensor generation:  0.009268522262573242
mini_batch_src_global generation:  0.018712997436523438
r_  generation:  0.1539764404296875
local_output_nid generation:  0.00917959213256836
local_in_edges_tensor generation:  0.008877038955688477
mini_batch_src_global generation:  0.01908588409423828
r_  generation:  0.1572279930114746
local_output_nid generation:  0.00932931900024414
local_in_edges_tensor generation:  0.008911371231079102
mini_batch_src_global generation:  0.01900339126586914
r_  generation:  0.1581099033355713
local_output_nid generation:  0.009431838989257812
local_in_edges_tensor generation:  0.008790731430053711
mini_batch_src_global generation:  0.019983291625976562
r_  generation:  0.16369342803955078
local_output_nid generation:  0.00943613052368164
local_in_edges_tensor generation:  0.008343696594238281
mini_batch_src_global generation:  0.01921558380126953
r_  generation:  0.16126489639282227
local_output_nid generation:  0.009140491485595703
local_in_edges_tensor generation:  0.008646488189697266
mini_batch_src_global generation:  0.019025087356567383
r_  generation:  0.16025948524475098
local_output_nid generation:  0.009140491485595703
local_in_edges_tensor generation:  0.009374856948852539
mini_batch_src_global generation:  0.018540382385253906
r_  generation:  0.15604710578918457
local_output_nid generation:  0.00912022590637207
local_in_edges_tensor generation:  0.008330345153808594
mini_batch_src_global generation:  0.018045902252197266
r_  generation:  0.15319180488586426
local_output_nid generation:  0.00905466079711914
local_in_edges_tensor generation:  0.008371353149414062
mini_batch_src_global generation:  0.01857781410217285
r_  generation:  0.15582799911499023
local_output_nid generation:  0.009482145309448242
local_in_edges_tensor generation:  0.008858680725097656
mini_batch_src_global generation:  0.020286083221435547
r_  generation:  0.16251325607299805
local_output_nid generation:  0.009257078170776367
local_in_edges_tensor generation:  0.009597539901733398
mini_batch_src_global generation:  0.019706010818481445
r_  generation:  0.1607978343963623
----------------------check_connections_block total spend ----------------------------- 7.2918760776519775
generate_one_block  0.21079730987548828
generate_one_block  0.19667744636535645
generate_one_block  0.1986541748046875
generate_one_block  0.19858431816101074
generate_one_block  0.2250375747680664
generate_one_block  0.20340347290039062
generate_one_block  0.20964741706848145
generate_one_block  0.20527911186218262
generate_one_block  0.21100521087646484
generate_one_block  0.20108890533447266
generate_one_block  0.20961904525756836
generate_one_block  0.19721269607543945
generate_one_block  0.19259905815124512
generate_one_block  0.19985437393188477
generate_one_block  0.21046066284179688
generate_one_block  0.1981494426727295
generate_one_block  0.21459031105041504
generate_one_block  0.20157718658447266
generate_one_block  0.1967003345489502
generate_one_block  0.2041332721710205
generate_one_block  0.205549955368042
generate_one_block  0.20123028755187988
generate_one_block  0.2045285701751709
generate_one_block  0.20663833618164062
generate_one_block  0.21066784858703613
generate_one_block  0.20905065536499023
generate_one_block  0.20250201225280762
generate_one_block  0.2007277011871338
generate_one_block  0.19929766654968262
generate_one_block  0.2043774127960205
generate_one_block  0.2140824794769287
generate_one_block  0.21119046211242676
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03850746154785156
gen group dst list time:  0.12746453285217285
time for parepare:  0.01938939094543457
local_output_nid generation:  0.023975133895874023
local_in_edges_tensor generation:  0.047675132751464844
mini_batch_src_global generation:  0.037109375
r_  generation:  0.40271878242492676
local_output_nid generation:  0.0278165340423584
local_in_edges_tensor generation:  0.029624462127685547
mini_batch_src_global generation:  0.05050063133239746
r_  generation:  0.401761531829834
local_output_nid generation:  0.02827000617980957
local_in_edges_tensor generation:  0.0265352725982666
mini_batch_src_global generation:  0.047789573669433594
r_  generation:  0.40961503982543945
local_output_nid generation:  0.027699947357177734
local_in_edges_tensor generation:  0.024859905242919922
mini_batch_src_global generation:  0.04800891876220703
r_  generation:  0.4019510746002197
local_output_nid generation:  0.027062654495239258
local_in_edges_tensor generation:  0.0264129638671875
mini_batch_src_global generation:  0.048561811447143555
r_  generation:  0.4130535125732422
local_output_nid generation:  0.02702617645263672
local_in_edges_tensor generation:  0.027236223220825195
mini_batch_src_global generation:  0.05173540115356445
r_  generation:  0.4099454879760742
local_output_nid generation:  0.027293682098388672
local_in_edges_tensor generation:  0.035546064376831055
mini_batch_src_global generation:  0.05033540725708008
r_  generation:  0.4168729782104492
local_output_nid generation:  0.027631759643554688
local_in_edges_tensor generation:  0.029140949249267578
mini_batch_src_global generation:  0.05155181884765625
r_  generation:  0.4115943908691406
local_output_nid generation:  0.0279388427734375
local_in_edges_tensor generation:  0.027313232421875
mini_batch_src_global generation:  0.0495147705078125
r_  generation:  0.4197847843170166
local_output_nid generation:  0.02762150764465332
local_in_edges_tensor generation:  0.03126215934753418
mini_batch_src_global generation:  0.053076744079589844
r_  generation:  0.41112780570983887
local_output_nid generation:  0.028776884078979492
local_in_edges_tensor generation:  0.02684760093688965
mini_batch_src_global generation:  0.04904532432556152
r_  generation:  0.4181537628173828
local_output_nid generation:  0.028154611587524414
local_in_edges_tensor generation:  0.025899887084960938
mini_batch_src_global generation:  0.051466941833496094
r_  generation:  0.4099307060241699
local_output_nid generation:  0.027357816696166992
local_in_edges_tensor generation:  0.030146121978759766
mini_batch_src_global generation:  0.04710793495178223
r_  generation:  0.41416025161743164
local_output_nid generation:  0.02721095085144043
local_in_edges_tensor generation:  0.029356718063354492
mini_batch_src_global generation:  0.05147743225097656
r_  generation:  0.4130287170410156
local_output_nid generation:  0.028113365173339844
local_in_edges_tensor generation:  0.03108382225036621
mini_batch_src_global generation:  0.0478055477142334
r_  generation:  0.4306514263153076
local_output_nid generation:  0.02864527702331543
local_in_edges_tensor generation:  0.030406951904296875
mini_batch_src_global generation:  0.05436563491821289
r_  generation:  0.4121274948120117
local_output_nid generation:  0.029242515563964844
local_in_edges_tensor generation:  0.02587151527404785
mini_batch_src_global generation:  0.050701141357421875
r_  generation:  0.41815710067749023
local_output_nid generation:  0.027987957000732422
local_in_edges_tensor generation:  0.027791261672973633
mini_batch_src_global generation:  0.04927539825439453
r_  generation:  0.40752553939819336
local_output_nid generation:  0.027768611907958984
local_in_edges_tensor generation:  0.024950504302978516
mini_batch_src_global generation:  0.047737836837768555
r_  generation:  0.41404294967651367
local_output_nid generation:  0.028327465057373047
local_in_edges_tensor generation:  0.02499103546142578
mini_batch_src_global generation:  0.05143284797668457
r_  generation:  0.40802597999572754
local_output_nid generation:  0.028409957885742188
local_in_edges_tensor generation:  0.029173612594604492
mini_batch_src_global generation:  0.04973578453063965
r_  generation:  0.4186227321624756
local_output_nid generation:  0.02820134162902832
local_in_edges_tensor generation:  0.02792811393737793
mini_batch_src_global generation:  0.0496218204498291
r_  generation:  0.4290151596069336
local_output_nid generation:  0.028153181076049805
local_in_edges_tensor generation:  0.025578975677490234
mini_batch_src_global generation:  0.048043251037597656
r_  generation:  0.41567325592041016
local_output_nid generation:  0.02849864959716797
local_in_edges_tensor generation:  0.02563619613647461
mini_batch_src_global generation:  0.051622867584228516
r_  generation:  0.4090428352355957
local_output_nid generation:  0.028473377227783203
local_in_edges_tensor generation:  0.029408693313598633
mini_batch_src_global generation:  0.04969930648803711
r_  generation:  0.42078232765197754
local_output_nid generation:  0.028527259826660156
local_in_edges_tensor generation:  0.02597522735595703
mini_batch_src_global generation:  0.04982256889343262
r_  generation:  0.4162428379058838
local_output_nid generation:  0.028473377227783203
local_in_edges_tensor generation:  0.029198408126831055
mini_batch_src_global generation:  0.05099606513977051
r_  generation:  0.41994690895080566
local_output_nid generation:  0.028823137283325195
local_in_edges_tensor generation:  0.02684164047241211
mini_batch_src_global generation:  0.049753427505493164
r_  generation:  0.41994500160217285
local_output_nid generation:  0.028613567352294922
local_in_edges_tensor generation:  0.02718663215637207
mini_batch_src_global generation:  0.04757094383239746
r_  generation:  0.4175453186035156
local_output_nid generation:  0.02832937240600586
local_in_edges_tensor generation:  0.024939775466918945
mini_batch_src_global generation:  0.0491640567779541
r_  generation:  0.40937256813049316
local_output_nid generation:  0.028623342514038086
local_in_edges_tensor generation:  0.026269912719726562
mini_batch_src_global generation:  0.04812216758728027
r_  generation:  0.4241464138031006
local_output_nid generation:  0.028757333755493164
local_in_edges_tensor generation:  0.03664040565490723
mini_batch_src_global generation:  0.04985642433166504
r_  generation:  0.41414880752563477
----------------------check_connections_block total spend ----------------------------- 19.63397455215454
generate_one_block  0.5677728652954102
generate_one_block  0.5454323291778564
generate_one_block  0.5473241806030273
generate_one_block  0.5460066795349121
generate_one_block  0.6441681385040283
generate_one_block  0.5587992668151855
generate_one_block  0.5578474998474121
generate_one_block  0.5612325668334961
generate_one_block  0.5661866664886475
generate_one_block  0.5472960472106934
generate_one_block  0.5521962642669678
generate_one_block  0.5493144989013672
generate_one_block  0.5467331409454346
generate_one_block  0.545095682144165
generate_one_block  0.564582347869873
generate_one_block  0.5573468208312988
generate_one_block  0.5585894584655762
generate_one_block  0.5564215183258057
generate_one_block  0.5488603115081787
generate_one_block  0.5498454570770264
generate_one_block  0.5565080642700195
generate_one_block  0.5554256439208984
generate_one_block  0.5533947944641113
generate_one_block  0.5611140727996826
generate_one_block  0.577549934387207
generate_one_block  0.5552976131439209
generate_one_block  0.556039571762085
generate_one_block  0.5541701316833496
generate_one_block  0.554499626159668
generate_one_block  0.5527443885803223
generate_one_block  0.5575132369995117
generate_one_block  0.5613672733306885
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.12205982208251953  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

connection checking time:  26.92585062980652
block generation total time  24.42159080505371
average batch blocks generation time:  0.7631747126579285
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10523319244384766  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.819583892822266  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10474491119384766  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.6273193359375  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10519218444824219  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.625951766967773  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10452842712402344  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.671114921569824  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10519170761108398  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.646027088165283  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10473060607910156  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.994904041290283  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10530567169189453  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.170634746551514  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10478734970092773  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.040050506591797  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10528278350830078  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.129430770874023  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10457134246826172  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.870566368103027  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10529279708862305  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.160353183746338  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10464048385620117  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.696900844573975  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10514545440673828  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.41646718978882  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10464286804199219  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.78023910522461  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10529756546020508  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.147621631622314  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10480260848999023  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.74320411682129  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10530567169189453  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.202513694763184  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.1045522689819336  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.85727071762085  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10520505905151367  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.675330638885498  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10455989837646484  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.810593128204346  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10526752471923828  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.115256309509277  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10480690002441406  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.865131378173828  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10526847839355469  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.981903553009033  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10469198226928711  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.110812187194824  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10532665252685547  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.21501588821411  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10467815399169922  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.2307391166687  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.1052541732788086  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.002068996429443  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10464286804199219  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.861469745635986  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10520267486572266  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.722321033477783  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10455989837646484  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.874103546142578  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10531949996948242  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.238117218017578  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10484600067138672  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.165791034698486  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030163973569869995 |0.016500264406204224 |0.4169446676969528 |9.509921073913574e-05 |0.7599457651376724 |0.005674600601196289 |
----------------------------------------------------------pseudo_mini_loss sum 2.416173219680786
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  8794940
Number of first layer input nodes during this epoch:  4681082
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.1234893798828125  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029918909072875977
range selection method range initialization spend 0.014644145965576172
time for parepare:  0.023157119750976562
local_output_nid generation:  0.0011701583862304688
local_in_edges_tensor generation:  0.005032539367675781
mini_batch_src_global generation:  0.004807949066162109
r_  generation:  0.010318756103515625
local_output_nid generation:  0.0010159015655517578
local_in_edges_tensor generation:  0.0007200241088867188
mini_batch_src_global generation:  0.001912832260131836
r_  generation:  0.011476516723632812
local_output_nid generation:  0.001016378402709961
local_in_edges_tensor generation:  0.0007047653198242188
mini_batch_src_global generation:  0.0014522075653076172
r_  generation:  0.010161638259887695
local_output_nid generation:  0.001010894775390625
local_in_edges_tensor generation:  0.0006902217864990234
mini_batch_src_global generation:  0.001424551010131836
r_  generation:  0.010473489761352539
local_output_nid generation:  0.0010001659393310547
local_in_edges_tensor generation:  0.0006687641143798828
mini_batch_src_global generation:  0.0013554096221923828
r_  generation:  0.009878873825073242
local_output_nid generation:  0.0010080337524414062
local_in_edges_tensor generation:  0.0006566047668457031
mini_batch_src_global generation:  0.0013370513916015625
r_  generation:  0.009912252426147461
local_output_nid generation:  0.0010478496551513672
local_in_edges_tensor generation:  0.0006721019744873047
mini_batch_src_global generation:  0.0013744831085205078
r_  generation:  0.010640859603881836
local_output_nid generation:  0.0010645389556884766
local_in_edges_tensor generation:  0.0006563663482666016
mini_batch_src_global generation:  0.0013132095336914062
r_  generation:  0.01004338264465332
local_output_nid generation:  0.0009884834289550781
local_in_edges_tensor generation:  0.0006873607635498047
mini_batch_src_global generation:  0.0015115737915039062
r_  generation:  0.010758638381958008
local_output_nid generation:  0.0010063648223876953
local_in_edges_tensor generation:  0.0006620883941650391
mini_batch_src_global generation:  0.0014259815216064453
r_  generation:  0.010640382766723633
local_output_nid generation:  0.0010142326354980469
local_in_edges_tensor generation:  0.0006730556488037109
mini_batch_src_global generation:  0.0015363693237304688
r_  generation:  0.010947942733764648
local_output_nid generation:  0.0010173320770263672
local_in_edges_tensor generation:  0.0006625652313232422
mini_batch_src_global generation:  0.0014736652374267578
r_  generation:  0.01026463508605957
local_output_nid generation:  0.0010380744934082031
local_in_edges_tensor generation:  0.0006582736968994141
mini_batch_src_global generation:  0.0013458728790283203
r_  generation:  0.00995779037475586
local_output_nid generation:  0.001041412353515625
local_in_edges_tensor generation:  0.000659942626953125
mini_batch_src_global generation:  0.001407623291015625
r_  generation:  0.01072239875793457
local_output_nid generation:  0.0010385513305664062
local_in_edges_tensor generation:  0.0006606578826904297
mini_batch_src_global generation:  0.0014672279357910156
r_  generation:  0.010012388229370117
local_output_nid generation:  0.0010404586791992188
local_in_edges_tensor generation:  0.0006651878356933594
mini_batch_src_global generation:  0.001397848129272461
r_  generation:  0.010515928268432617
local_output_nid generation:  0.0010297298431396484
local_in_edges_tensor generation:  0.0006656646728515625
mini_batch_src_global generation:  0.0015413761138916016
r_  generation:  0.01066279411315918
local_output_nid generation:  0.001035928726196289
local_in_edges_tensor generation:  0.0006537437438964844
mini_batch_src_global generation:  0.0013594627380371094
r_  generation:  0.01036524772644043
local_output_nid generation:  0.001035928726196289
local_in_edges_tensor generation:  0.0006442070007324219
mini_batch_src_global generation:  0.001336812973022461
r_  generation:  0.01041722297668457
local_output_nid generation:  0.001043081283569336
local_in_edges_tensor generation:  0.0006511211395263672
mini_batch_src_global generation:  0.00133514404296875
r_  generation:  0.010108470916748047
local_output_nid generation:  0.0010647773742675781
local_in_edges_tensor generation:  0.0006554126739501953
mini_batch_src_global generation:  0.0013310909271240234
r_  generation:  0.010176420211791992
local_output_nid generation:  0.0010526180267333984
local_in_edges_tensor generation:  0.0006518363952636719
mini_batch_src_global generation:  0.0013442039489746094
r_  generation:  0.010161638259887695
local_output_nid generation:  0.0010309219360351562
local_in_edges_tensor generation:  0.0006794929504394531
mini_batch_src_global generation:  0.0015764236450195312
r_  generation:  0.010917425155639648
local_output_nid generation:  0.0010573863983154297
local_in_edges_tensor generation:  0.0006558895111083984
mini_batch_src_global generation:  0.0015125274658203125
r_  generation:  0.010703563690185547
local_output_nid generation:  0.0010347366333007812
local_in_edges_tensor generation:  0.0006783008575439453
mini_batch_src_global generation:  0.0014371871948242188
r_  generation:  0.010622739791870117
local_output_nid generation:  0.0010464191436767578
local_in_edges_tensor generation:  0.0006639957427978516
mini_batch_src_global generation:  0.0013833045959472656
r_  generation:  0.01031184196472168
local_output_nid generation:  0.0010576248168945312
local_in_edges_tensor generation:  0.0006704330444335938
mini_batch_src_global generation:  0.0013928413391113281
r_  generation:  0.010692358016967773
local_output_nid generation:  0.0010650157928466797
local_in_edges_tensor generation:  0.0006520748138427734
mini_batch_src_global generation:  0.0014040470123291016
r_  generation:  0.010249137878417969
local_output_nid generation:  0.0010762214660644531
local_in_edges_tensor generation:  0.000659942626953125
mini_batch_src_global generation:  0.001495361328125
r_  generation:  0.010272026062011719
local_output_nid generation:  0.0010671615600585938
local_in_edges_tensor generation:  0.0006487369537353516
mini_batch_src_global generation:  0.0013446807861328125
r_  generation:  0.010153532028198242
local_output_nid generation:  0.0010480880737304688
local_in_edges_tensor generation:  0.0006663799285888672
mini_batch_src_global generation:  0.0013725757598876953
r_  generation:  0.010615825653076172
local_output_nid generation:  0.0010619163513183594
local_in_edges_tensor generation:  0.0006690025329589844
mini_batch_src_global generation:  0.0015141963958740234
r_  generation:  0.010864973068237305
----------------------check_connections_block total spend ----------------------------- 0.5515241622924805
generate_one_block  0.027436256408691406
generate_one_block  0.021361827850341797
generate_one_block  0.019340991973876953
generate_one_block  0.01912379264831543
generate_one_block  0.01801609992980957
generate_one_block  0.017509937286376953
generate_one_block  0.018836259841918945
generate_one_block  0.0176694393157959
generate_one_block  0.01911640167236328
generate_one_block  0.018715620040893555
generate_one_block  0.01899123191833496
generate_one_block  0.018165111541748047
generate_one_block  0.017389297485351562
generate_one_block  0.02123427391052246
generate_one_block  0.017330169677734375
generate_one_block  0.018135786056518555
generate_one_block  0.01840972900390625
generate_one_block  0.018227100372314453
generate_one_block  0.018197059631347656
generate_one_block  0.017565488815307617
generate_one_block  0.017586708068847656
generate_one_block  0.018732547760009766
generate_one_block  0.030204296112060547
generate_one_block  0.01802825927734375
generate_one_block  0.018354415893554688
generate_one_block  0.01760721206665039
generate_one_block  0.017810344696044922
generate_one_block  0.0171964168548584
generate_one_block  0.01708698272705078
generate_one_block  0.016915082931518555
generate_one_block  0.017568349838256836
generate_one_block  0.0177001953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037072181701660156
gen group dst list time:  0.025533676147460938
time for parepare:  0.021363258361816406
local_output_nid generation:  0.0054416656494140625
local_in_edges_tensor generation:  0.015949726104736328
mini_batch_src_global generation:  0.016826152801513672
r_  generation:  0.1378800868988037
local_output_nid generation:  0.007496356964111328
local_in_edges_tensor generation:  0.010792970657348633
mini_batch_src_global generation:  0.019514083862304688
r_  generation:  0.16211152076721191
local_output_nid generation:  0.012080192565917969
local_in_edges_tensor generation:  0.04307365417480469
mini_batch_src_global generation:  0.017698049545288086
r_  generation:  0.1577448844909668
local_output_nid generation:  0.013069868087768555
local_in_edges_tensor generation:  0.0124664306640625
mini_batch_src_global generation:  0.020572423934936523
r_  generation:  0.16376209259033203
local_output_nid generation:  0.013196468353271484
local_in_edges_tensor generation:  0.011449098587036133
mini_batch_src_global generation:  0.019735336303710938
r_  generation:  0.16090011596679688
local_output_nid generation:  0.013056278228759766
local_in_edges_tensor generation:  0.011924982070922852
mini_batch_src_global generation:  0.01940011978149414
r_  generation:  0.15612173080444336
local_output_nid generation:  0.014255762100219727
local_in_edges_tensor generation:  0.011239767074584961
mini_batch_src_global generation:  0.023567914962768555
r_  generation:  0.17743921279907227
local_output_nid generation:  0.014616250991821289
local_in_edges_tensor generation:  0.010906219482421875
mini_batch_src_global generation:  0.037843942642211914
r_  generation:  0.1543431282043457
local_output_nid generation:  0.009782552719116211
local_in_edges_tensor generation:  0.009056806564331055
mini_batch_src_global generation:  0.022370338439941406
r_  generation:  0.16220617294311523
local_output_nid generation:  0.009957075119018555
local_in_edges_tensor generation:  0.014553546905517578
mini_batch_src_global generation:  0.0219118595123291
r_  generation:  0.16697025299072266
local_output_nid generation:  0.009907245635986328
local_in_edges_tensor generation:  0.009376287460327148
mini_batch_src_global generation:  0.022391080856323242
r_  generation:  0.19754672050476074
local_output_nid generation:  0.012144804000854492
local_in_edges_tensor generation:  0.009083032608032227
mini_batch_src_global generation:  0.03743743896484375
r_  generation:  0.15318942070007324
local_output_nid generation:  0.008990049362182617
local_in_edges_tensor generation:  0.009358882904052734
mini_batch_src_global generation:  0.020364761352539062
r_  generation:  0.14959478378295898
local_output_nid generation:  0.009541749954223633
local_in_edges_tensor generation:  0.008191585540771484
mini_batch_src_global generation:  0.029163122177124023
r_  generation:  0.17519855499267578
local_output_nid generation:  0.013195037841796875
local_in_edges_tensor generation:  0.010458230972290039
mini_batch_src_global generation:  0.02150893211364746
r_  generation:  0.1673130989074707
local_output_nid generation:  0.012854576110839844
local_in_edges_tensor generation:  0.00995492935180664
mini_batch_src_global generation:  0.021796703338623047
r_  generation:  0.1591501235961914
local_output_nid generation:  0.01042485237121582
local_in_edges_tensor generation:  0.009181022644042969
mini_batch_src_global generation:  0.021384477615356445
r_  generation:  0.1595001220703125
local_output_nid generation:  0.009888887405395508
local_in_edges_tensor generation:  0.008234262466430664
mini_batch_src_global generation:  0.019430160522460938
r_  generation:  0.15689420700073242
local_output_nid generation:  0.009552955627441406
local_in_edges_tensor generation:  0.009366035461425781
mini_batch_src_global generation:  0.02139568328857422
r_  generation:  0.16530942916870117
local_output_nid generation:  0.009649515151977539
local_in_edges_tensor generation:  0.008834600448608398
mini_batch_src_global generation:  0.022236108779907227
r_  generation:  0.1560039520263672
local_output_nid generation:  0.009353399276733398
local_in_edges_tensor generation:  0.011001348495483398
mini_batch_src_global generation:  0.0182340145111084
r_  generation:  0.15533208847045898
local_output_nid generation:  0.01004481315612793
local_in_edges_tensor generation:  0.008466005325317383
mini_batch_src_global generation:  0.01949787139892578
r_  generation:  0.15438556671142578
local_output_nid generation:  0.00950002670288086
local_in_edges_tensor generation:  0.008336782455444336
mini_batch_src_global generation:  0.02048206329345703
r_  generation:  0.16904973983764648
local_output_nid generation:  0.011238574981689453
local_in_edges_tensor generation:  0.008176803588867188
mini_batch_src_global generation:  0.02408123016357422
r_  generation:  0.1563725471496582
local_output_nid generation:  0.00997018814086914
local_in_edges_tensor generation:  0.009005069732666016
mini_batch_src_global generation:  0.019520282745361328
r_  generation:  0.20867490768432617
local_output_nid generation:  0.009448766708374023
local_in_edges_tensor generation:  0.00881195068359375
mini_batch_src_global generation:  0.019893646240234375
r_  generation:  0.15293669700622559
local_output_nid generation:  0.009817123413085938
local_in_edges_tensor generation:  0.009516239166259766
mini_batch_src_global generation:  0.01958489418029785
r_  generation:  0.16197514533996582
local_output_nid generation:  0.009503841400146484
local_in_edges_tensor generation:  0.008597850799560547
mini_batch_src_global generation:  0.01901721954345703
r_  generation:  0.20014452934265137
local_output_nid generation:  0.009387731552124023
local_in_edges_tensor generation:  0.008003711700439453
mini_batch_src_global generation:  0.019448041915893555
r_  generation:  0.16870546340942383
local_output_nid generation:  0.011305570602416992
local_in_edges_tensor generation:  0.007924556732177734
mini_batch_src_global generation:  0.01857471466064453
r_  generation:  0.15198135375976562
local_output_nid generation:  0.010377168655395508
local_in_edges_tensor generation:  0.00898885726928711
mini_batch_src_global generation:  0.01938796043395996
r_  generation:  0.1575145721435547
local_output_nid generation:  0.009950876235961914
local_in_edges_tensor generation:  0.00902104377746582
mini_batch_src_global generation:  0.019132614135742188
r_  generation:  0.160736083984375
----------------------check_connections_block total spend ----------------------------- 7.86159348487854
generate_one_block  0.21783804893493652
generate_one_block  0.20071649551391602
generate_one_block  0.21693730354309082
generate_one_block  0.21238970756530762
generate_one_block  0.23246312141418457
generate_one_block  0.1936657428741455
generate_one_block  0.21341395378112793
generate_one_block  0.20230579376220703
generate_one_block  0.21514010429382324
generate_one_block  0.2107243537902832
generate_one_block  0.21635198593139648
generate_one_block  0.20257949829101562
generate_one_block  0.19583392143249512
generate_one_block  0.20669770240783691
generate_one_block  0.19432902336120605
generate_one_block  0.20214104652404785
generate_one_block  0.2063124179840088
generate_one_block  0.2047743797302246
generate_one_block  0.20233583450317383
generate_one_block  0.2241072654724121
generate_one_block  0.21549081802368164
generate_one_block  0.19905328750610352
generate_one_block  0.2155599594116211
generate_one_block  0.20155620574951172
generate_one_block  0.20858407020568848
generate_one_block  0.1992800235748291
generate_one_block  0.21258091926574707
generate_one_block  0.19760394096374512
generate_one_block  0.19904208183288574
generate_one_block  0.19542908668518066
generate_one_block  0.21021294593811035
generate_one_block  0.20878386497497559
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.043584346771240234
gen group dst list time:  0.12086272239685059
time for parepare:  0.020324230194091797
local_output_nid generation:  0.02379012107849121
local_in_edges_tensor generation:  0.06487083435058594
mini_batch_src_global generation:  0.03989553451538086
r_  generation:  0.41539669036865234
local_output_nid generation:  0.02983856201171875
local_in_edges_tensor generation:  0.03238558769226074
mini_batch_src_global generation:  0.05231523513793945
r_  generation:  0.409625768661499
local_output_nid generation:  0.0290374755859375
local_in_edges_tensor generation:  0.03095841407775879
mini_batch_src_global generation:  0.05048203468322754
r_  generation:  0.42116212844848633
local_output_nid generation:  0.032041311264038086
local_in_edges_tensor generation:  0.0352632999420166
mini_batch_src_global generation:  0.0617520809173584
r_  generation:  0.41342806816101074
local_output_nid generation:  0.030301332473754883
local_in_edges_tensor generation:  0.0269777774810791
mini_batch_src_global generation:  0.0493321418762207
r_  generation:  0.4193739891052246
local_output_nid generation:  0.030218124389648438
local_in_edges_tensor generation:  0.02681422233581543
mini_batch_src_global generation:  0.05077099800109863
r_  generation:  0.4009571075439453
local_output_nid generation:  0.030911922454833984
local_in_edges_tensor generation:  0.025651931762695312
mini_batch_src_global generation:  0.049767255783081055
r_  generation:  0.42168641090393066
local_output_nid generation:  0.030727386474609375
local_in_edges_tensor generation:  0.0290377140045166
mini_batch_src_global generation:  0.052317142486572266
r_  generation:  0.43645787239074707
local_output_nid generation:  0.03132319450378418
local_in_edges_tensor generation:  0.02692437171936035
mini_batch_src_global generation:  0.0555119514465332
r_  generation:  0.4288442134857178
local_output_nid generation:  0.02837967872619629
local_in_edges_tensor generation:  0.02673053741455078
mini_batch_src_global generation:  0.057389020919799805
r_  generation:  0.42241549491882324
local_output_nid generation:  0.02939581871032715
local_in_edges_tensor generation:  0.030419111251831055
mini_batch_src_global generation:  0.051041364669799805
r_  generation:  0.4376695156097412
local_output_nid generation:  0.02802872657775879
local_in_edges_tensor generation:  0.029240846633911133
mini_batch_src_global generation:  0.0529787540435791
r_  generation:  0.4133627414703369
local_output_nid generation:  0.028116226196289062
local_in_edges_tensor generation:  0.025142431259155273
mini_batch_src_global generation:  0.04945254325866699
r_  generation:  0.42281484603881836
local_output_nid generation:  0.028248071670532227
local_in_edges_tensor generation:  0.035947322845458984
mini_batch_src_global generation:  0.05321907997131348
r_  generation:  0.43670058250427246
local_output_nid generation:  0.028415918350219727
local_in_edges_tensor generation:  0.02927851676940918
mini_batch_src_global generation:  0.053208351135253906
r_  generation:  0.4225609302520752
local_output_nid generation:  0.029143333435058594
local_in_edges_tensor generation:  0.02843308448791504
mini_batch_src_global generation:  0.053797006607055664
r_  generation:  0.4179952144622803
local_output_nid generation:  0.028468608856201172
local_in_edges_tensor generation:  0.02880072593688965
mini_batch_src_global generation:  0.050163984298706055
r_  generation:  0.42658567428588867
local_output_nid generation:  0.028482675552368164
local_in_edges_tensor generation:  0.024810791015625
mini_batch_src_global generation:  0.051555633544921875
r_  generation:  0.4127218723297119
local_output_nid generation:  0.028400421142578125
local_in_edges_tensor generation:  0.025228023529052734
mini_batch_src_global generation:  0.049881696701049805
r_  generation:  0.4212911128997803
local_output_nid generation:  0.028172731399536133
local_in_edges_tensor generation:  0.027147293090820312
mini_batch_src_global generation:  0.05150866508483887
r_  generation:  0.42284464836120605
local_output_nid generation:  0.02807927131652832
local_in_edges_tensor generation:  0.025175809860229492
mini_batch_src_global generation:  0.04729652404785156
r_  generation:  0.4159574508666992
local_output_nid generation:  0.02820730209350586
local_in_edges_tensor generation:  0.026386737823486328
mini_batch_src_global generation:  0.04916667938232422
r_  generation:  0.40937113761901855
local_output_nid generation:  0.02875351905822754
local_in_edges_tensor generation:  0.028892040252685547
mini_batch_src_global generation:  0.05130481719970703
r_  generation:  0.42928171157836914
local_output_nid generation:  0.029137372970581055
local_in_edges_tensor generation:  0.02854776382446289
mini_batch_src_global generation:  0.04968976974487305
r_  generation:  0.4163227081298828
local_output_nid generation:  0.02844858169555664
local_in_edges_tensor generation:  0.025181055068969727
mini_batch_src_global generation:  0.047435760498046875
r_  generation:  0.4231429100036621
local_output_nid generation:  0.029368162155151367
local_in_edges_tensor generation:  0.025296449661254883
mini_batch_src_global generation:  0.049576520919799805
r_  generation:  0.42203259468078613
local_output_nid generation:  0.028560400009155273
local_in_edges_tensor generation:  0.03529524803161621
mini_batch_src_global generation:  0.04949831962585449
r_  generation:  0.4266989231109619
local_output_nid generation:  0.02835702896118164
local_in_edges_tensor generation:  0.027533531188964844
mini_batch_src_global generation:  0.051785945892333984
r_  generation:  0.41704249382019043
local_output_nid generation:  0.02796626091003418
local_in_edges_tensor generation:  0.033051490783691406
mini_batch_src_global generation:  0.04734992980957031
r_  generation:  0.4223673343658447
local_output_nid generation:  0.0280764102935791
local_in_edges_tensor generation:  0.027007102966308594
mini_batch_src_global generation:  0.05095243453979492
r_  generation:  0.4106905460357666
local_output_nid generation:  0.02842855453491211
local_in_edges_tensor generation:  0.025316715240478516
mini_batch_src_global generation:  0.04908394813537598
r_  generation:  0.43623971939086914
local_output_nid generation:  0.02879476547241211
local_in_edges_tensor generation:  0.0314633846282959
mini_batch_src_global generation:  0.05026125907897949
r_  generation:  0.4232363700866699
----------------------check_connections_block total spend ----------------------------- 20.014769315719604
generate_one_block  0.5714521408081055
generate_one_block  0.542917013168335
generate_one_block  0.5564682483673096
generate_one_block  0.56256103515625
generate_one_block  0.6736459732055664
generate_one_block  0.5432884693145752
generate_one_block  0.5664279460906982
generate_one_block  0.5582520961761475
generate_one_block  0.5644180774688721
generate_one_block  0.5672454833984375
generate_one_block  0.5693068504333496
generate_one_block  0.5442984104156494
generate_one_block  0.5467889308929443
generate_one_block  0.5525767803192139
generate_one_block  0.5471093654632568
generate_one_block  0.5584373474121094
generate_one_block  0.5699021816253662
generate_one_block  0.5624852180480957
generate_one_block  0.5558042526245117
generate_one_block  0.5539829730987549
generate_one_block  0.5475857257843018
generate_one_block  0.5515596866607666
generate_one_block  0.562420129776001
generate_one_block  0.5604188442230225
generate_one_block  0.580674409866333
generate_one_block  0.5570211410522461
generate_one_block  0.5673854351043701
generate_one_block  0.5620977878570557
generate_one_block  0.5539710521697998
generate_one_block  0.559312105178833
generate_one_block  0.5658235549926758
generate_one_block  0.5731985569000244
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.1234893798828125  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

connection checking time:  27.876362800598145
block generation total time  24.6430721282959
average batch blocks generation time:  0.7700960040092468
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10527181625366211  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.060118675231934  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10433483123779297  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.525474071502686  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.1052541732788086  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.943935871124268  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10488414764404297  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.279165267944336  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.1052093505859375  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.708839416503906  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10434532165527344  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.360619068145752  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10532665252685547  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.24971914291382  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10461044311523438  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 16.607783794403076  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10532522201538086  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.253172874450684  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10494804382324219  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 17.278263568878174  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3787841796875 GB
    Memory Allocated: 0.10536050796508789  GigaBytes
Max Memory Allocated: 17.411821842193604  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.47672462463379  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10439109802246094  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.63958215713501  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10514307022094727  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.455822944641113  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10473203659057617  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.090016841888428  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10516166687011719  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.485007286071777  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10467243194580078  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.04494619369507  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526132583618164  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.06652021408081  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10468864440917969  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.05823040008545  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525846481323242  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.99859857559204  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10470151901245117  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.534521102905273  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10517692565917969  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.560234546661377  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10420417785644531  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.60360288619995  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1053318977355957  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.285432815551758  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10454034805297852  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.98644733428955  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530328750610352  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.145857334136963  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10481977462768555  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.823797702789307  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10532903671264648  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.262228965759277  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1047372817993164  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.76340913772583  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522603988647461  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.856598377227783  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10465192794799805  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.578461170196533  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052699089050293  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.088879585266113  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10481691360473633  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.93734359741211  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030887216329574585 |0.015332154929637909 |0.415774866938591 |9.653717279434204e-05 |0.7653107568621635 |0.007495880126953125 |
----------------------------------------------------------pseudo_mini_loss sum 2.1913113594055176
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  8793761
Number of first layer input nodes during this epoch:  4680799
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12312555313110352  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02551722526550293
range selection method range initialization spend 0.016809463500976562
time for parepare:  0.01861858367919922
local_output_nid generation:  0.0009486675262451172
local_in_edges_tensor generation:  0.004747152328491211
mini_batch_src_global generation:  0.0032672882080078125
r_  generation:  0.014589309692382812
local_output_nid generation:  0.0013184547424316406
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.002185821533203125
r_  generation:  0.012063264846801758
local_output_nid generation:  0.0011806488037109375
local_in_edges_tensor generation:  0.0007035732269287109
mini_batch_src_global generation:  0.0015101432800292969
r_  generation:  0.010347366333007812
local_output_nid generation:  0.001138448715209961
local_in_edges_tensor generation:  0.00084686279296875
mini_batch_src_global generation:  0.001421213150024414
r_  generation:  0.010097026824951172
local_output_nid generation:  0.0011174678802490234
local_in_edges_tensor generation:  0.0006659030914306641
mini_batch_src_global generation:  0.0013093948364257812
r_  generation:  0.009728431701660156
local_output_nid generation:  0.0011119842529296875
local_in_edges_tensor generation:  0.0006666183471679688
mini_batch_src_global generation:  0.0013434886932373047
r_  generation:  0.010243415832519531
local_output_nid generation:  0.0011148452758789062
local_in_edges_tensor generation:  0.0006978511810302734
mini_batch_src_global generation:  0.0013408660888671875
r_  generation:  0.010306358337402344
local_output_nid generation:  0.0010867118835449219
local_in_edges_tensor generation:  0.0006382465362548828
mini_batch_src_global generation:  0.001251220703125
r_  generation:  0.009766817092895508
local_output_nid generation:  0.0010793209075927734
local_in_edges_tensor generation:  0.0007197856903076172
mini_batch_src_global generation:  0.0013267993927001953
r_  generation:  0.010189056396484375
local_output_nid generation:  0.0010929107666015625
local_in_edges_tensor generation:  0.0007817745208740234
mini_batch_src_global generation:  0.0012674331665039062
r_  generation:  0.01016378402709961
local_output_nid generation:  0.0010750293731689453
local_in_edges_tensor generation:  0.0007069110870361328
mini_batch_src_global generation:  0.0013720989227294922
r_  generation:  0.010490894317626953
local_output_nid generation:  0.0010762214660644531
local_in_edges_tensor generation:  0.0006642341613769531
mini_batch_src_global generation:  0.0013883113861083984
r_  generation:  0.010474920272827148
local_output_nid generation:  0.0010802745819091797
local_in_edges_tensor generation:  0.0007166862487792969
mini_batch_src_global generation:  0.0013425350189208984
r_  generation:  0.010082244873046875
local_output_nid generation:  0.0010712146759033203
local_in_edges_tensor generation:  0.0006477832794189453
mini_batch_src_global generation:  0.0013270378112792969
r_  generation:  0.01018381118774414
local_output_nid generation:  0.0010902881622314453
local_in_edges_tensor generation:  0.000629425048828125
mini_batch_src_global generation:  0.0012750625610351562
r_  generation:  0.010337114334106445
local_output_nid generation:  0.0010995864868164062
local_in_edges_tensor generation:  0.0006625652313232422
mini_batch_src_global generation:  0.0013532638549804688
r_  generation:  0.01077127456665039
local_output_nid generation:  0.001051187515258789
local_in_edges_tensor generation:  0.0006639957427978516
mini_batch_src_global generation:  0.0013527870178222656
r_  generation:  0.010541915893554688
local_output_nid generation:  0.0010612010955810547
local_in_edges_tensor generation:  0.0006363391876220703
mini_batch_src_global generation:  0.0013589859008789062
r_  generation:  0.010455131530761719
local_output_nid generation:  0.0010335445404052734
local_in_edges_tensor generation:  0.0006232261657714844
mini_batch_src_global generation:  0.0012924671173095703
r_  generation:  0.010507345199584961
local_output_nid generation:  0.0010378360748291016
local_in_edges_tensor generation:  0.0007026195526123047
mini_batch_src_global generation:  0.001348733901977539
r_  generation:  0.010300874710083008
local_output_nid generation:  0.0010561943054199219
local_in_edges_tensor generation:  0.0006270408630371094
mini_batch_src_global generation:  0.0013225078582763672
r_  generation:  0.010478496551513672
local_output_nid generation:  0.0010399818420410156
local_in_edges_tensor generation:  0.0006706714630126953
mini_batch_src_global generation:  0.0013442039489746094
r_  generation:  0.010499715805053711
local_output_nid generation:  0.0010373592376708984
local_in_edges_tensor generation:  0.0006279945373535156
mini_batch_src_global generation:  0.0013070106506347656
r_  generation:  0.010251045227050781
local_output_nid generation:  0.0010380744934082031
local_in_edges_tensor generation:  0.0006322860717773438
mini_batch_src_global generation:  0.0013058185577392578
r_  generation:  0.010131597518920898
local_output_nid generation:  0.0010364055633544922
local_in_edges_tensor generation:  0.0006690025329589844
mini_batch_src_global generation:  0.0013780593872070312
r_  generation:  0.010944128036499023
local_output_nid generation:  0.0010306835174560547
local_in_edges_tensor generation:  0.0006456375122070312
mini_batch_src_global generation:  0.001344919204711914
r_  generation:  0.010473251342773438
local_output_nid generation:  0.0010297298431396484
local_in_edges_tensor generation:  0.0006494522094726562
mini_batch_src_global generation:  0.0015277862548828125
r_  generation:  0.01068568229675293
local_output_nid generation:  0.00103759765625
local_in_edges_tensor generation:  0.0006515979766845703
mini_batch_src_global generation:  0.0013210773468017578
r_  generation:  0.010159969329833984
local_output_nid generation:  0.0010480880737304688
local_in_edges_tensor generation:  0.0006251335144042969
mini_batch_src_global generation:  0.0013172626495361328
r_  generation:  0.010619878768920898
local_output_nid generation:  0.0010263919830322266
local_in_edges_tensor generation:  0.0006508827209472656
mini_batch_src_global generation:  0.001409292221069336
r_  generation:  0.010732412338256836
local_output_nid generation:  0.0010709762573242188
local_in_edges_tensor generation:  0.0006449222564697266
mini_batch_src_global generation:  0.0014247894287109375
r_  generation:  0.010287761688232422
local_output_nid generation:  0.00104522705078125
local_in_edges_tensor generation:  0.0006303787231445312
mini_batch_src_global generation:  0.0013506412506103516
r_  generation:  0.010265111923217773
----------------------check_connections_block total spend ----------------------------- 0.5466306209564209
generate_one_block  0.027245283126831055
generate_one_block  0.02336430549621582
generate_one_block  0.01964259147644043
generate_one_block  0.018972396850585938
generate_one_block  0.01792311668395996
generate_one_block  0.01849508285522461
generate_one_block  0.01822519302368164
generate_one_block  0.01764225959777832
generate_one_block  0.018349647521972656
generate_one_block  0.017946720123291016
generate_one_block  0.019500255584716797
generate_one_block  0.030290842056274414
generate_one_block  0.017917871475219727
generate_one_block  0.01758408546447754
generate_one_block  0.01733851432800293
generate_one_block  0.017955780029296875
generate_one_block  0.017873048782348633
generate_one_block  0.017456769943237305
generate_one_block  0.017211437225341797
generate_one_block  0.017180442810058594
generate_one_block  0.017368555068969727
generate_one_block  0.017528533935546875
generate_one_block  0.01713705062866211
generate_one_block  0.016860485076904297
generate_one_block  0.018202543258666992
generate_one_block  0.017348051071166992
generate_one_block  0.01765894889831543
generate_one_block  0.017102479934692383
generate_one_block  0.017441511154174805
generate_one_block  0.01758408546447754
generate_one_block  0.01723623275756836
generate_one_block  0.017012596130371094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06518983840942383
gen group dst list time:  0.02552509307861328
time for parepare:  0.02171158790588379
local_output_nid generation:  0.005477190017700195
local_in_edges_tensor generation:  0.016210556030273438
mini_batch_src_global generation:  0.016553640365600586
r_  generation:  0.13885951042175293
local_output_nid generation:  0.007864236831665039
local_in_edges_tensor generation:  0.009921550750732422
mini_batch_src_global generation:  0.020850419998168945
r_  generation:  0.15126633644104004
local_output_nid generation:  0.007677555084228516
local_in_edges_tensor generation:  0.032239437103271484
mini_batch_src_global generation:  0.018582582473754883
r_  generation:  0.15120267868041992
local_output_nid generation:  0.007879257202148438
local_in_edges_tensor generation:  0.008880138397216797
mini_batch_src_global generation:  0.026983976364135742
r_  generation:  0.1520094871520996
local_output_nid generation:  0.008822202682495117
local_in_edges_tensor generation:  0.009825706481933594
mini_batch_src_global generation:  0.01978754997253418
r_  generation:  0.14714622497558594
local_output_nid generation:  0.008669376373291016
local_in_edges_tensor generation:  0.009926080703735352
mini_batch_src_global generation:  0.020645856857299805
r_  generation:  0.15573501586914062
local_output_nid generation:  0.008530139923095703
local_in_edges_tensor generation:  0.009549856185913086
mini_batch_src_global generation:  0.024355649948120117
r_  generation:  0.15565705299377441
local_output_nid generation:  0.008150339126586914
local_in_edges_tensor generation:  0.010834932327270508
mini_batch_src_global generation:  0.020020246505737305
r_  generation:  0.14871454238891602
local_output_nid generation:  0.010305404663085938
local_in_edges_tensor generation:  0.009305953979492188
mini_batch_src_global generation:  0.021437644958496094
r_  generation:  0.15685319900512695
local_output_nid generation:  0.008363723754882812
local_in_edges_tensor generation:  0.010527372360229492
mini_batch_src_global generation:  0.020747900009155273
r_  generation:  0.15730905532836914
local_output_nid generation:  0.00990438461303711
local_in_edges_tensor generation:  0.008160114288330078
mini_batch_src_global generation:  0.021683216094970703
r_  generation:  0.16844916343688965
local_output_nid generation:  0.010017871856689453
local_in_edges_tensor generation:  0.010149955749511719
mini_batch_src_global generation:  0.02221822738647461
r_  generation:  0.15703272819519043
local_output_nid generation:  0.009012222290039062
local_in_edges_tensor generation:  0.007979869842529297
mini_batch_src_global generation:  0.021159887313842773
r_  generation:  0.15329623222351074
local_output_nid generation:  0.009148836135864258
local_in_edges_tensor generation:  0.008101463317871094
mini_batch_src_global generation:  0.021234989166259766
r_  generation:  0.1562201976776123
local_output_nid generation:  0.009014606475830078
local_in_edges_tensor generation:  0.00801229476928711
mini_batch_src_global generation:  0.021018028259277344
r_  generation:  0.19677329063415527
local_output_nid generation:  0.009136438369750977
local_in_edges_tensor generation:  0.008275985717773438
mini_batch_src_global generation:  0.022258520126342773
r_  generation:  0.1590118408203125
local_output_nid generation:  0.00898122787475586
local_in_edges_tensor generation:  0.008820056915283203
mini_batch_src_global generation:  0.021451950073242188
r_  generation:  0.15712475776672363
local_output_nid generation:  0.009290695190429688
local_in_edges_tensor generation:  0.008655309677124023
mini_batch_src_global generation:  0.021244049072265625
r_  generation:  0.15560507774353027
local_output_nid generation:  0.008977890014648438
local_in_edges_tensor generation:  0.007964372634887695
mini_batch_src_global generation:  0.02070307731628418
r_  generation:  0.19448494911193848
local_output_nid generation:  0.009089231491088867
local_in_edges_tensor generation:  0.007940292358398438
mini_batch_src_global generation:  0.023473262786865234
r_  generation:  0.15597844123840332
local_output_nid generation:  0.009202957153320312
local_in_edges_tensor generation:  0.008694648742675781
mini_batch_src_global generation:  0.02412128448486328
r_  generation:  0.15818047523498535
local_output_nid generation:  0.010707378387451172
local_in_edges_tensor generation:  0.00933980941772461
mini_batch_src_global generation:  0.02140522003173828
r_  generation:  0.1609821319580078
local_output_nid generation:  0.009144306182861328
local_in_edges_tensor generation:  0.008030891418457031
mini_batch_src_global generation:  0.021043777465820312
r_  generation:  0.15571808815002441
local_output_nid generation:  0.008923530578613281
local_in_edges_tensor generation:  0.007819175720214844
mini_batch_src_global generation:  0.020561695098876953
r_  generation:  0.15697264671325684
local_output_nid generation:  0.00965738296508789
local_in_edges_tensor generation:  0.00919198989868164
mini_batch_src_global generation:  0.02259540557861328
r_  generation:  0.1661663055419922
local_output_nid generation:  0.008933544158935547
local_in_edges_tensor generation:  0.011950969696044922
mini_batch_src_global generation:  0.023981571197509766
r_  generation:  0.159775972366333
local_output_nid generation:  0.011782646179199219
local_in_edges_tensor generation:  0.009583234786987305
mini_batch_src_global generation:  0.02254199981689453
r_  generation:  0.16358733177185059
local_output_nid generation:  0.009110689163208008
local_in_edges_tensor generation:  0.008707046508789062
mini_batch_src_global generation:  0.021030187606811523
r_  generation:  0.16118073463439941
local_output_nid generation:  0.009275436401367188
local_in_edges_tensor generation:  0.008170604705810547
mini_batch_src_global generation:  0.03136134147644043
r_  generation:  0.1970806121826172
local_output_nid generation:  0.01016688346862793
local_in_edges_tensor generation:  0.010118961334228516
mini_batch_src_global generation:  0.022379159927368164
r_  generation:  0.16159653663635254
local_output_nid generation:  0.009469032287597656
local_in_edges_tensor generation:  0.009266138076782227
mini_batch_src_global generation:  0.021167755126953125
r_  generation:  0.1578977108001709
local_output_nid generation:  0.009168624877929688
local_in_edges_tensor generation:  0.010566473007202148
mini_batch_src_global generation:  0.021153926849365234
r_  generation:  0.16289663314819336
----------------------check_connections_block total spend ----------------------------- 7.639997482299805
generate_one_block  0.2236330509185791
generate_one_block  0.21303009986877441
generate_one_block  0.20704221725463867
generate_one_block  0.20545721054077148
generate_one_block  0.23187780380249023
generate_one_block  0.20305371284484863
generate_one_block  0.20270228385925293
generate_one_block  0.19533276557922363
generate_one_block  0.20583534240722656
generate_one_block  0.2267448902130127
generate_one_block  0.22968363761901855
generate_one_block  0.21948599815368652
generate_one_block  0.20705080032348633
generate_one_block  0.2134091854095459
generate_one_block  0.2069103717803955
generate_one_block  0.21418547630310059
generate_one_block  0.21763014793395996
generate_one_block  0.2075963020324707
generate_one_block  0.19997596740722656
generate_one_block  0.20755290985107422
generate_one_block  0.2084505558013916
generate_one_block  0.20498394966125488
generate_one_block  0.19725656509399414
generate_one_block  0.19633984565734863
generate_one_block  0.2154712677001953
generate_one_block  0.20160865783691406
generate_one_block  0.21016383171081543
generate_one_block  0.19802021980285645
generate_one_block  0.2061142921447754
generate_one_block  0.20481657981872559
generate_one_block  0.20671892166137695
generate_one_block  0.197357177734375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03333711624145508
gen group dst list time:  0.12744379043579102
time for parepare:  0.025339126586914062
local_output_nid generation:  0.032759904861450195
local_in_edges_tensor generation:  0.05053377151489258
mini_batch_src_global generation:  0.04359316825866699
r_  generation:  0.43808674812316895
local_output_nid generation:  0.03294181823730469
local_in_edges_tensor generation:  0.037714242935180664
mini_batch_src_global generation:  0.05912423133850098
r_  generation:  0.4117758274078369
local_output_nid generation:  0.04302239418029785
local_in_edges_tensor generation:  0.024796485900878906
mini_batch_src_global generation:  0.050547122955322266
r_  generation:  0.4159519672393799
local_output_nid generation:  0.02900075912475586
local_in_edges_tensor generation:  0.026758909225463867
mini_batch_src_global generation:  0.04967689514160156
r_  generation:  0.4112114906311035
local_output_nid generation:  0.029015064239501953
local_in_edges_tensor generation:  0.028656959533691406
mini_batch_src_global generation:  0.047806739807128906
r_  generation:  0.4141662120819092
local_output_nid generation:  0.027837753295898438
local_in_edges_tensor generation:  0.025022029876708984
mini_batch_src_global generation:  0.04973936080932617
r_  generation:  0.4235260486602783
local_output_nid generation:  0.0278167724609375
local_in_edges_tensor generation:  0.029015064239501953
mini_batch_src_global generation:  0.051587581634521484
r_  generation:  0.43247318267822266
local_output_nid generation:  0.030063390731811523
local_in_edges_tensor generation:  0.026419878005981445
mini_batch_src_global generation:  0.04949641227722168
r_  generation:  0.4148578643798828
local_output_nid generation:  0.02762460708618164
local_in_edges_tensor generation:  0.03518414497375488
mini_batch_src_global generation:  0.05393266677856445
r_  generation:  0.4301881790161133
local_output_nid generation:  0.032466888427734375
local_in_edges_tensor generation:  0.02919483184814453
mini_batch_src_global generation:  0.051100730895996094
r_  generation:  0.4084436893463135
local_output_nid generation:  0.031270742416381836
local_in_edges_tensor generation:  0.02817821502685547
mini_batch_src_global generation:  0.04784369468688965
r_  generation:  0.4177417755126953
local_output_nid generation:  0.031174421310424805
local_in_edges_tensor generation:  0.02858757972717285
mini_batch_src_global generation:  0.051253557205200195
r_  generation:  0.42041945457458496
local_output_nid generation:  0.031267404556274414
local_in_edges_tensor generation:  0.029214143753051758
mini_batch_src_global generation:  0.050649166107177734
r_  generation:  0.43155741691589355
local_output_nid generation:  0.03112959861755371
local_in_edges_tensor generation:  0.025416851043701172
mini_batch_src_global generation:  0.050623178482055664
r_  generation:  0.4151904582977295
local_output_nid generation:  0.031020402908325195
local_in_edges_tensor generation:  0.027843475341796875
mini_batch_src_global generation:  0.047647714614868164
r_  generation:  0.4158492088317871
local_output_nid generation:  0.031403541564941406
local_in_edges_tensor generation:  0.02541375160217285
mini_batch_src_global generation:  0.05151820182800293
r_  generation:  0.41280674934387207
local_output_nid generation:  0.03135824203491211
local_in_edges_tensor generation:  0.02770709991455078
mini_batch_src_global generation:  0.04704785346984863
r_  generation:  0.4192819595336914
local_output_nid generation:  0.03328227996826172
local_in_edges_tensor generation:  0.027153491973876953
mini_batch_src_global generation:  0.04941725730895996
r_  generation:  0.41753697395324707
local_output_nid generation:  0.03355693817138672
local_in_edges_tensor generation:  0.031119823455810547
mini_batch_src_global generation:  0.04697871208190918
r_  generation:  0.42329883575439453
local_output_nid generation:  0.03266716003417969
local_in_edges_tensor generation:  0.027802228927612305
mini_batch_src_global generation:  0.05100893974304199
r_  generation:  0.4167027473449707
local_output_nid generation:  0.03265857696533203
local_in_edges_tensor generation:  0.02796626091003418
mini_batch_src_global generation:  0.046858787536621094
r_  generation:  0.42279624938964844
local_output_nid generation:  0.03136897087097168
local_in_edges_tensor generation:  0.03130483627319336
mini_batch_src_global generation:  0.055246591567993164
r_  generation:  0.42629432678222656
local_output_nid generation:  0.03383684158325195
local_in_edges_tensor generation:  0.028130054473876953
mini_batch_src_global generation:  0.04795265197753906
r_  generation:  0.41927552223205566
local_output_nid generation:  0.031295061111450195
local_in_edges_tensor generation:  0.025749683380126953
mini_batch_src_global generation:  0.05073213577270508
r_  generation:  0.413144588470459
local_output_nid generation:  0.03158068656921387
local_in_edges_tensor generation:  0.02752828598022461
mini_batch_src_global generation:  0.04742622375488281
r_  generation:  0.42006921768188477
local_output_nid generation:  0.031218528747558594
local_in_edges_tensor generation:  0.03094649314880371
mini_batch_src_global generation:  0.05203056335449219
r_  generation:  0.4131779670715332
local_output_nid generation:  0.031595706939697266
local_in_edges_tensor generation:  0.027340412139892578
mini_batch_src_global generation:  0.04780411720275879
r_  generation:  0.42128419876098633
local_output_nid generation:  0.031078100204467773
local_in_edges_tensor generation:  0.02510356903076172
mini_batch_src_global generation:  0.0493168830871582
r_  generation:  0.4096488952636719
local_output_nid generation:  0.03128409385681152
local_in_edges_tensor generation:  0.025686025619506836
mini_batch_src_global generation:  0.04915499687194824
r_  generation:  0.43157219886779785
local_output_nid generation:  0.03134012222290039
local_in_edges_tensor generation:  0.0257418155670166
mini_batch_src_global generation:  0.04936718940734863
r_  generation:  0.4195282459259033
local_output_nid generation:  0.03150153160095215
local_in_edges_tensor generation:  0.02548837661743164
mini_batch_src_global generation:  0.047719717025756836
r_  generation:  0.4311840534210205
local_output_nid generation:  0.031106233596801758
local_in_edges_tensor generation:  0.028036117553710938
mini_batch_src_global generation:  0.053871870040893555
r_  generation:  0.41519832611083984
----------------------check_connections_block total spend ----------------------------- 19.97746753692627
generate_one_block  0.5674045085906982
generate_one_block  0.5635545253753662
generate_one_block  0.5479831695556641
generate_one_block  0.550243616104126
generate_one_block  0.6537213325500488
generate_one_block  0.5496418476104736
generate_one_block  0.5477619171142578
generate_one_block  0.5426843166351318
generate_one_block  0.549419641494751
generate_one_block  0.5641152858734131
generate_one_block  0.5561301708221436
generate_one_block  0.5558383464813232
generate_one_block  0.5420982837677002
generate_one_block  0.5507054328918457
generate_one_block  0.542811393737793
generate_one_block  0.5554778575897217
generate_one_block  0.5583653450012207
generate_one_block  0.5681948661804199
generate_one_block  0.541400671005249
generate_one_block  0.5492751598358154
generate_one_block  0.5505049228668213
generate_one_block  0.5550978183746338
generate_one_block  0.5449790954589844
generate_one_block  0.5511384010314941
generate_one_block  0.5790071487426758
generate_one_block  0.5454769134521484
generate_one_block  0.5542199611663818
generate_one_block  0.5505585670471191
generate_one_block  0.5486912727355957
generate_one_block  0.5489382743835449
generate_one_block  0.5474183559417725
generate_one_block  0.5475559234619141
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12312555313110352  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

connection checking time:  27.617465019226074
block generation total time  24.465906381607056
average batch blocks generation time:  0.7645595744252205
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528373718261719  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.129693031311035  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10486888885498047  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.343364238739014  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527467727661133  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.08525323867798  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10483503341674805  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.041393280029297  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10515260696411133  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.462092876434326  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1047053337097168  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.909595489501953  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522079467773438  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.76799201965332  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10462808609008789  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.442816257476807  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524797439575195  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.857229232788086  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1045694351196289  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.76638889312744  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528278350830078  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.08520221710205  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10475683212280273  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.18323278427124  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522317886352539  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.7624831199646  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10477972030639648  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.061686515808105  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520792007446289  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.709524631500244  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1047053337097168  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.13390064239502  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052865982055664  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.10622787475586  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10474920272827148  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.942585468292236  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519599914550781  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.6398663520813  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10479879379272461  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.75554847717285  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052408218383789  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.83528184890747  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046609878540039  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.94740629196167  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520172119140625  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.67565155029297  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10469436645507812  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.64723777770996  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10534286499023438  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.31321907043457  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10459375381469727  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.87303352355957  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1053018569946289  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.166364192962646  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10486507415771484  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.753007411956787  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526561737060547  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.02713632583618  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10477781295776367  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.89018201828003  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523653030395508  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.816516399383545  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046762466430664  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.697229862213135  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030559100210666656 |0.0155540332198143 |0.4150875210762024 |9.482353925704956e-05 |0.7568597719073296 |0.0075685977935791016 |
----------------------------------------------------------pseudo_mini_loss sum 2.0820648670196533
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  8795979
Number of first layer input nodes during this epoch:  4683227
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12260818481445312  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024492502212524414
range selection method range initialization spend 0.016963720321655273
time for parepare:  0.01992011070251465
local_output_nid generation:  0.0009307861328125
local_in_edges_tensor generation:  0.0044574737548828125
mini_batch_src_global generation:  0.0021724700927734375
r_  generation:  0.011909008026123047
local_output_nid generation:  0.000986337661743164
local_in_edges_tensor generation:  0.0007746219635009766
mini_batch_src_global generation:  0.0016849040985107422
r_  generation:  0.0107574462890625
local_output_nid generation:  0.0009310245513916016
local_in_edges_tensor generation:  0.0006499290466308594
mini_batch_src_global generation:  0.0011749267578125
r_  generation:  0.00957942008972168
local_output_nid generation:  0.0009055137634277344
local_in_edges_tensor generation:  0.0005755424499511719
mini_batch_src_global generation:  0.0012199878692626953
r_  generation:  0.009973764419555664
local_output_nid generation:  0.0008778572082519531
local_in_edges_tensor generation:  0.0005679130554199219
mini_batch_src_global generation:  0.001184701919555664
r_  generation:  0.009979009628295898
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.0005588531494140625
mini_batch_src_global generation:  0.0012271404266357422
r_  generation:  0.010463476181030273
local_output_nid generation:  0.0008807182312011719
local_in_edges_tensor generation:  0.0005421638488769531
mini_batch_src_global generation:  0.001157999038696289
r_  generation:  0.010169744491577148
local_output_nid generation:  0.0009055137634277344
local_in_edges_tensor generation:  0.0005519390106201172
mini_batch_src_global generation:  0.001096487045288086
r_  generation:  0.010039329528808594
local_output_nid generation:  0.0008521080017089844
local_in_edges_tensor generation:  0.0006315708160400391
mini_batch_src_global generation:  0.0011022090911865234
r_  generation:  0.009909391403198242
local_output_nid generation:  0.0008447170257568359
local_in_edges_tensor generation:  0.0005311965942382812
mini_batch_src_global generation:  0.0010776519775390625
r_  generation:  0.010537147521972656
local_output_nid generation:  0.0008444786071777344
local_in_edges_tensor generation:  0.0005536079406738281
mini_batch_src_global generation:  0.0010960102081298828
r_  generation:  0.010118961334228516
local_output_nid generation:  0.0008444786071777344
local_in_edges_tensor generation:  0.0005459785461425781
mini_batch_src_global generation:  0.0011112689971923828
r_  generation:  0.010643482208251953
local_output_nid generation:  0.0008473396301269531
local_in_edges_tensor generation:  0.0006394386291503906
mini_batch_src_global generation:  0.0010616779327392578
r_  generation:  0.009731054306030273
local_output_nid generation:  0.0008382797241210938
local_in_edges_tensor generation:  0.0005402565002441406
mini_batch_src_global generation:  0.001184225082397461
r_  generation:  0.010551929473876953
local_output_nid generation:  0.0008370876312255859
local_in_edges_tensor generation:  0.0005476474761962891
mini_batch_src_global generation:  0.0011446475982666016
r_  generation:  0.010144472122192383
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.000545501708984375
mini_batch_src_global generation:  0.0011491775512695312
r_  generation:  0.010160446166992188
local_output_nid generation:  0.0008382797241210938
local_in_edges_tensor generation:  0.0005466938018798828
mini_batch_src_global generation:  0.0011563301086425781
r_  generation:  0.010400533676147461
local_output_nid generation:  0.0008351802825927734
local_in_edges_tensor generation:  0.000637054443359375
mini_batch_src_global generation:  0.001140594482421875
r_  generation:  0.010130167007446289
local_output_nid generation:  0.0008482933044433594
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.0011081695556640625
r_  generation:  0.009879112243652344
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005452632904052734
mini_batch_src_global generation:  0.0011763572692871094
r_  generation:  0.010375738143920898
local_output_nid generation:  0.0008625984191894531
local_in_edges_tensor generation:  0.0005552768707275391
mini_batch_src_global generation:  0.0011000633239746094
r_  generation:  0.010275840759277344
local_output_nid generation:  0.0008440017700195312
local_in_edges_tensor generation:  0.0005576610565185547
mini_batch_src_global generation:  0.0012018680572509766
r_  generation:  0.0105133056640625
local_output_nid generation:  0.0008380413055419922
local_in_edges_tensor generation:  0.0005393028259277344
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.010155439376831055
local_output_nid generation:  0.0008418560028076172
local_in_edges_tensor generation:  0.0005447864532470703
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.010204315185546875
local_output_nid generation:  0.0008428096771240234
local_in_edges_tensor generation:  0.0005435943603515625
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.010033130645751953
local_output_nid generation:  0.0008394718170166016
local_in_edges_tensor generation:  0.0005428791046142578
mini_batch_src_global generation:  0.0011019706726074219
r_  generation:  0.010368585586547852
local_output_nid generation:  0.0008516311645507812
local_in_edges_tensor generation:  0.0005450248718261719
mini_batch_src_global generation:  0.0011425018310546875
r_  generation:  0.010425090789794922
local_output_nid generation:  0.0008394718170166016
local_in_edges_tensor generation:  0.0005443096160888672
mini_batch_src_global generation:  0.001104593276977539
r_  generation:  0.010177135467529297
local_output_nid generation:  0.0008537769317626953
local_in_edges_tensor generation:  0.0005517005920410156
mini_batch_src_global generation:  0.0010895729064941406
r_  generation:  0.009930849075317383
local_output_nid generation:  0.0008444786071777344
local_in_edges_tensor generation:  0.0005478858947753906
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.010496139526367188
local_output_nid generation:  0.0008437633514404297
local_in_edges_tensor generation:  0.0005326271057128906
mini_batch_src_global generation:  0.0011038780212402344
r_  generation:  0.010157108306884766
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0005319118499755859
mini_batch_src_global generation:  0.0011298656463623047
r_  generation:  0.01047205924987793
----------------------check_connections_block total spend ----------------------------- 0.5151712894439697
generate_one_block  0.023535966873168945
generate_one_block  0.020152568817138672
generate_one_block  0.0172579288482666
generate_one_block  0.017489194869995117
generate_one_block  0.01751112937927246
generate_one_block  0.017891407012939453
generate_one_block  0.017415761947631836
generate_one_block  0.017279863357543945
generate_one_block  0.01709771156311035
generate_one_block  0.017514467239379883
generate_one_block  0.017190933227539062
generate_one_block  0.017963409423828125
generate_one_block  0.016452789306640625
generate_one_block  0.017845630645751953
generate_one_block  0.017238616943359375
generate_one_block  0.017243385314941406
generate_one_block  0.017763376235961914
generate_one_block  0.017220497131347656
generate_one_block  0.016876220703125
generate_one_block  0.017362594604492188
generate_one_block  0.017325878143310547
generate_one_block  0.017676591873168945
generate_one_block  0.01730036735534668
generate_one_block  0.017019271850585938
generate_one_block  0.016931533813476562
generate_one_block  0.01717662811279297
generate_one_block  0.01741623878479004
generate_one_block  0.02021169662475586
generate_one_block  0.017308712005615234
generate_one_block  0.017472028732299805
generate_one_block  0.017053842544555664
generate_one_block  0.017452001571655273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035959720611572266
gen group dst list time:  0.025667667388916016
time for parepare:  0.0216066837310791
local_output_nid generation:  0.005488157272338867
local_in_edges_tensor generation:  0.02209305763244629
mini_batch_src_global generation:  0.01756453514099121
r_  generation:  0.13656926155090332
local_output_nid generation:  0.011316299438476562
local_in_edges_tensor generation:  0.01266026496887207
mini_batch_src_global generation:  0.018660306930541992
r_  generation:  0.1473712921142578
local_output_nid generation:  0.011873006820678711
local_in_edges_tensor generation:  0.03997015953063965
mini_batch_src_global generation:  0.01648402214050293
r_  generation:  0.14535236358642578
local_output_nid generation:  0.013109683990478516
local_in_edges_tensor generation:  0.01221776008605957
mini_batch_src_global generation:  0.01746225357055664
r_  generation:  0.15051674842834473
local_output_nid generation:  0.013185501098632812
local_in_edges_tensor generation:  0.011630773544311523
mini_batch_src_global generation:  0.017413616180419922
r_  generation:  0.16584324836730957
local_output_nid generation:  0.012969970703125
local_in_edges_tensor generation:  0.011142253875732422
mini_batch_src_global generation:  0.02356886863708496
r_  generation:  0.16650772094726562
local_output_nid generation:  0.010191679000854492
local_in_edges_tensor generation:  0.008750200271606445
mini_batch_src_global generation:  0.023149490356445312
r_  generation:  0.17027950286865234
local_output_nid generation:  0.008849143981933594
local_in_edges_tensor generation:  0.010778427124023438
mini_batch_src_global generation:  0.021521806716918945
r_  generation:  0.16651034355163574
local_output_nid generation:  0.008445262908935547
local_in_edges_tensor generation:  0.008234024047851562
mini_batch_src_global generation:  0.02144145965576172
r_  generation:  0.16660690307617188
local_output_nid generation:  0.010864019393920898
local_in_edges_tensor generation:  0.008861780166625977
mini_batch_src_global generation:  0.04949641227722168
r_  generation:  0.15360307693481445
local_output_nid generation:  0.00974583625793457
local_in_edges_tensor generation:  0.008453607559204102
mini_batch_src_global generation:  0.01817178726196289
r_  generation:  0.15111351013183594
local_output_nid generation:  0.009654045104980469
local_in_edges_tensor generation:  0.008089303970336914
mini_batch_src_global generation:  0.019766807556152344
r_  generation:  0.15340185165405273
local_output_nid generation:  0.009130001068115234
local_in_edges_tensor generation:  0.00906062126159668
mini_batch_src_global generation:  0.01772618293762207
r_  generation:  0.14634227752685547
local_output_nid generation:  0.009750843048095703
local_in_edges_tensor generation:  0.008196830749511719
mini_batch_src_global generation:  0.01917576789855957
r_  generation:  0.1554114818572998
local_output_nid generation:  0.00937652587890625
local_in_edges_tensor generation:  0.009229898452758789
mini_batch_src_global generation:  0.018259763717651367
r_  generation:  0.14862918853759766
local_output_nid generation:  0.00957345962524414
local_in_edges_tensor generation:  0.008712053298950195
mini_batch_src_global generation:  0.019507884979248047
r_  generation:  0.15358853340148926
local_output_nid generation:  0.009816169738769531
local_in_edges_tensor generation:  0.008786678314208984
mini_batch_src_global generation:  0.01870107650756836
r_  generation:  0.15679025650024414
local_output_nid generation:  0.009415149688720703
local_in_edges_tensor generation:  0.00794076919555664
mini_batch_src_global generation:  0.01848769187927246
r_  generation:  0.14790582656860352
local_output_nid generation:  0.00937342643737793
local_in_edges_tensor generation:  0.00788569450378418
mini_batch_src_global generation:  0.01799607276916504
r_  generation:  0.14919805526733398
local_output_nid generation:  0.009679317474365234
local_in_edges_tensor generation:  0.008313894271850586
mini_batch_src_global generation:  0.01973414421081543
r_  generation:  0.1556529998779297
local_output_nid generation:  0.009619712829589844
local_in_edges_tensor generation:  0.009458303451538086
mini_batch_src_global generation:  0.0187530517578125
r_  generation:  0.1544361114501953
local_output_nid generation:  0.009981155395507812
local_in_edges_tensor generation:  0.008976936340332031
mini_batch_src_global generation:  0.01914501190185547
r_  generation:  0.15773391723632812
local_output_nid generation:  0.009818792343139648
local_in_edges_tensor generation:  0.008782386779785156
mini_batch_src_global generation:  0.018800020217895508
r_  generation:  0.15725183486938477
local_output_nid generation:  0.009453773498535156
local_in_edges_tensor generation:  0.008084297180175781
mini_batch_src_global generation:  0.01865839958190918
r_  generation:  0.15227460861206055
local_output_nid generation:  0.00944662094116211
local_in_edges_tensor generation:  0.008018732070922852
mini_batch_src_global generation:  0.018429279327392578
r_  generation:  0.15292716026306152
local_output_nid generation:  0.009540796279907227
local_in_edges_tensor generation:  0.008180618286132812
mini_batch_src_global generation:  0.019576311111450195
r_  generation:  0.15265274047851562
local_output_nid generation:  0.009839773178100586
local_in_edges_tensor generation:  0.008937835693359375
mini_batch_src_global generation:  0.019544363021850586
r_  generation:  0.15591216087341309
local_output_nid generation:  0.009625911712646484
local_in_edges_tensor generation:  0.008380651473999023
mini_batch_src_global generation:  0.01872706413269043
r_  generation:  0.152022123336792
local_output_nid generation:  0.009428977966308594
local_in_edges_tensor generation:  0.007845878601074219
mini_batch_src_global generation:  0.017972946166992188
r_  generation:  0.15279793739318848
local_output_nid generation:  0.012218952178955078
local_in_edges_tensor generation:  0.009604454040527344
mini_batch_src_global generation:  0.01924920082092285
r_  generation:  0.1598200798034668
local_output_nid generation:  0.00959324836730957
local_in_edges_tensor generation:  0.008245468139648438
mini_batch_src_global generation:  0.018299579620361328
r_  generation:  0.15639948844909668
local_output_nid generation:  0.009784936904907227
local_in_edges_tensor generation:  0.00873708724975586
mini_batch_src_global generation:  0.01929163932800293
r_  generation:  0.15566706657409668
----------------------check_connections_block total spend ----------------------------- 7.4391984939575195
generate_one_block  0.20770478248596191
generate_one_block  0.20540690422058105
generate_one_block  0.19687294960021973
generate_one_block  0.20369601249694824
generate_one_block  0.23172497749328613
generate_one_block  0.20914793014526367
generate_one_block  0.20791888236999512
generate_one_block  0.2028038501739502
generate_one_block  0.1978921890258789
generate_one_block  0.2036137580871582
generate_one_block  0.19876766204833984
generate_one_block  0.20595335960388184
generate_one_block  0.19489812850952148
generate_one_block  0.20929503440856934
generate_one_block  0.1958305835723877
generate_one_block  0.20387911796569824
generate_one_block  0.20717144012451172
generate_one_block  0.1988990306854248
generate_one_block  0.19844555854797363
generate_one_block  0.21415996551513672
generate_one_block  0.20621895790100098
generate_one_block  0.21278738975524902
generate_one_block  0.21023082733154297
generate_one_block  0.20688676834106445
generate_one_block  0.20487070083618164
generate_one_block  0.20299887657165527
generate_one_block  0.20790576934814453
generate_one_block  0.20379352569580078
generate_one_block  0.20042157173156738
generate_one_block  0.20958733558654785
generate_one_block  0.20232772827148438
generate_one_block  0.20685863494873047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033565521240234375
gen group dst list time:  0.11014580726623535
time for parepare:  0.018612146377563477
local_output_nid generation:  0.02383279800415039
local_in_edges_tensor generation:  0.04318976402282715
mini_batch_src_global generation:  0.039992332458496094
r_  generation:  0.40540409088134766
local_output_nid generation:  0.028524398803710938
local_in_edges_tensor generation:  0.033093929290771484
mini_batch_src_global generation:  0.04895758628845215
r_  generation:  0.4051532745361328
local_output_nid generation:  0.028266191482543945
local_in_edges_tensor generation:  0.026782512664794922
mini_batch_src_global generation:  0.04655170440673828
r_  generation:  0.41101980209350586
local_output_nid generation:  0.028871774673461914
local_in_edges_tensor generation:  0.027021169662475586
mini_batch_src_global generation:  0.049060821533203125
r_  generation:  0.40804409980773926
local_output_nid generation:  0.028801441192626953
local_in_edges_tensor generation:  0.028651714324951172
mini_batch_src_global generation:  0.04737043380737305
r_  generation:  0.4201467037200928
local_output_nid generation:  0.027888774871826172
local_in_edges_tensor generation:  0.0281069278717041
mini_batch_src_global generation:  0.04959583282470703
r_  generation:  0.42296361923217773
local_output_nid generation:  0.02712869644165039
local_in_edges_tensor generation:  0.02539992332458496
mini_batch_src_global generation:  0.048287153244018555
r_  generation:  0.41570162773132324
local_output_nid generation:  0.027138948440551758
local_in_edges_tensor generation:  0.02546238899230957
mini_batch_src_global generation:  0.048839569091796875
r_  generation:  0.4166138172149658
local_output_nid generation:  0.027061939239501953
local_in_edges_tensor generation:  0.02671217918395996
mini_batch_src_global generation:  0.04779243469238281
r_  generation:  0.41478967666625977
local_output_nid generation:  0.030342817306518555
local_in_edges_tensor generation:  0.027448415756225586
mini_batch_src_global generation:  0.05214953422546387
r_  generation:  0.41317296028137207
local_output_nid generation:  0.02708125114440918
local_in_edges_tensor generation:  0.028540372848510742
mini_batch_src_global generation:  0.0490107536315918
r_  generation:  0.4237511157989502
local_output_nid generation:  0.02954578399658203
local_in_edges_tensor generation:  0.0307004451751709
mini_batch_src_global generation:  0.051425933837890625
r_  generation:  0.41138124465942383
local_output_nid generation:  0.026704788208007812
local_in_edges_tensor generation:  0.025374412536621094
mini_batch_src_global generation:  0.047037601470947266
r_  generation:  0.4122650623321533
local_output_nid generation:  0.030623674392700195
local_in_edges_tensor generation:  0.0302584171295166
mini_batch_src_global generation:  0.050824880599975586
r_  generation:  0.41614437103271484
local_output_nid generation:  0.027270078659057617
local_in_edges_tensor generation:  0.032697439193725586
mini_batch_src_global generation:  0.04800581932067871
r_  generation:  0.42133164405822754
local_output_nid generation:  0.028690099716186523
local_in_edges_tensor generation:  0.02617359161376953
mini_batch_src_global generation:  0.051496267318725586
r_  generation:  0.4156661033630371
local_output_nid generation:  0.027562379837036133
local_in_edges_tensor generation:  0.030242204666137695
mini_batch_src_global generation:  0.048055171966552734
r_  generation:  0.41979169845581055
local_output_nid generation:  0.027727365493774414
local_in_edges_tensor generation:  0.025600433349609375
mini_batch_src_global generation:  0.049620866775512695
r_  generation:  0.41187024116516113
local_output_nid generation:  0.02738022804260254
local_in_edges_tensor generation:  0.02565741539001465
mini_batch_src_global generation:  0.04760336875915527
r_  generation:  0.41771554946899414
local_output_nid generation:  0.027594327926635742
local_in_edges_tensor generation:  0.03118157386779785
mini_batch_src_global generation:  0.0503237247467041
r_  generation:  0.41053056716918945
local_output_nid generation:  0.02744436264038086
local_in_edges_tensor generation:  0.024843215942382812
mini_batch_src_global generation:  0.04781317710876465
r_  generation:  0.4324629306793213
local_output_nid generation:  0.029143810272216797
local_in_edges_tensor generation:  0.030138015747070312
mini_batch_src_global generation:  0.05120420455932617
r_  generation:  0.4130280017852783
local_output_nid generation:  0.0295412540435791
local_in_edges_tensor generation:  0.028513669967651367
mini_batch_src_global generation:  0.05008339881896973
r_  generation:  0.4180278778076172
local_output_nid generation:  0.027883529663085938
local_in_edges_tensor generation:  0.02533864974975586
mini_batch_src_global generation:  0.04932761192321777
r_  generation:  0.4077901840209961
local_output_nid generation:  0.0281064510345459
local_in_edges_tensor generation:  0.02558279037475586
mini_batch_src_global generation:  0.047643423080444336
r_  generation:  0.4165334701538086
local_output_nid generation:  0.028296947479248047
local_in_edges_tensor generation:  0.028824329376220703
mini_batch_src_global generation:  0.04932832717895508
r_  generation:  0.4115922451019287
local_output_nid generation:  0.028215885162353516
local_in_edges_tensor generation:  0.02552056312561035
mini_batch_src_global generation:  0.04829216003417969
r_  generation:  0.4250969886779785
local_output_nid generation:  0.028278350830078125
local_in_edges_tensor generation:  0.025872468948364258
mini_batch_src_global generation:  0.05022740364074707
r_  generation:  0.41204118728637695
local_output_nid generation:  0.028163909912109375
local_in_edges_tensor generation:  0.02941131591796875
mini_batch_src_global generation:  0.04752802848815918
r_  generation:  0.41750597953796387
local_output_nid generation:  0.028218507766723633
local_in_edges_tensor generation:  0.0274808406829834
mini_batch_src_global generation:  0.049219608306884766
r_  generation:  0.4119758605957031
local_output_nid generation:  0.028074979782104492
local_in_edges_tensor generation:  0.02966451644897461
mini_batch_src_global generation:  0.04794907569885254
r_  generation:  0.4174509048461914
local_output_nid generation:  0.028337955474853516
local_in_edges_tensor generation:  0.02550196647644043
mini_batch_src_global generation:  0.04961419105529785
r_  generation:  0.41263580322265625
----------------------check_connections_block total spend ----------------------------- 19.640817642211914
generate_one_block  0.5688588619232178
generate_one_block  0.5627880096435547
generate_one_block  0.5551519393920898
generate_one_block  0.5536353588104248
generate_one_block  0.6490991115570068
generate_one_block  0.5514812469482422
generate_one_block  0.552966833114624
generate_one_block  0.5499353408813477
generate_one_block  0.5458216667175293
generate_one_block  0.5569469928741455
generate_one_block  0.5519366264343262
generate_one_block  0.5515296459197998
generate_one_block  0.5477211475372314
generate_one_block  0.5628533363342285
generate_one_block  0.5467963218688965
generate_one_block  0.5510849952697754
generate_one_block  0.56150221824646
generate_one_block  0.5509262084960938
generate_one_block  0.5447449684143066
generate_one_block  0.5587332248687744
generate_one_block  0.5478086471557617
generate_one_block  0.5537664890289307
generate_one_block  0.5558295249938965
generate_one_block  0.550403356552124
generate_one_block  0.5707039833068848
generate_one_block  0.550666093826294
generate_one_block  0.5610098838806152
generate_one_block  0.5626199245452881
generate_one_block  0.5521318912506104
generate_one_block  0.5606625080108643
generate_one_block  0.5520510673522949
generate_one_block  0.5486502647399902
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12260818481445312  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

connection checking time:  27.080016136169434
block generation total time  24.409787893295288
average batch blocks generation time:  0.7628058716654778
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521793365478516  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.75633144378662  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10499095916748047  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.193867683410645  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519123077392578  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.595805644989014  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046762466430664  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.02855157852173  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524988174438477  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.0072922706604  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10464763641357422  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.20948839187622  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528373718261719  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.123804569244385  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10463190078735352  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.87877130508423  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.105224609375  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.812530517578125  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10479593276977539  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.09018564224243  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052255630493164  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.807873725891113  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10470104217529297  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.088754177093506  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10395002365112305  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.309251308441162  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10483264923095703  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.209465503692627  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519075393676758  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.614444255828857  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10470199584960938  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.10070276260376  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529088973999023  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.148388862609863  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10478067398071289  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.636627674102783  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1051793098449707  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.606106758117676  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10485315322875977  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.16429328918457  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524368286132812  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.95224618911743  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10495758056640625  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.177831649780273  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526752471923828  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.060119152069092  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10446882247924805  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.906341552734375  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522603988647461  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.825926303863525  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10474777221679688  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.8266658782959  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526180267333984  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.97483253479004  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10484170913696289  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.804119110107422  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519266128540039  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.63804531097412  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10447120666503906  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.081758499145508  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522079467773438  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.75372552871704  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10474014282226562  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.866549491882324  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031017087399959564 |0.014753319323062897 |0.4137484058737755 |9.274482727050781e-05 |0.7578522637486458 |0.008306026458740234 |
----------------------------------------------------------pseudo_mini_loss sum 1.9466536045074463
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  8790243
Number of first layer input nodes during this epoch:  4680075
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12252521514892578  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024786949157714844
range selection method range initialization spend 0.013102054595947266
time for parepare:  0.01755380630493164
local_output_nid generation:  0.0009357929229736328
local_in_edges_tensor generation:  0.007689714431762695
mini_batch_src_global generation:  0.0014917850494384766
r_  generation:  0.011168956756591797
local_output_nid generation:  0.0009982585906982422
local_in_edges_tensor generation:  0.0006666183471679688
mini_batch_src_global generation:  0.0014493465423583984
r_  generation:  0.010747432708740234
local_output_nid generation:  0.000911712646484375
local_in_edges_tensor generation:  0.0006060600280761719
mini_batch_src_global generation:  0.001110076904296875
r_  generation:  0.010009050369262695
local_output_nid generation:  0.0009245872497558594
local_in_edges_tensor generation:  0.0005893707275390625
mini_batch_src_global generation:  0.0010488033294677734
r_  generation:  0.009654521942138672
local_output_nid generation:  0.000885009765625
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.0010776519775390625
r_  generation:  0.009715080261230469
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.000606536865234375
mini_batch_src_global generation:  0.0010957717895507812
r_  generation:  0.010262250900268555
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005495548248291016
mini_batch_src_global generation:  0.0010528564453125
r_  generation:  0.009893655776977539
local_output_nid generation:  0.0008580684661865234
local_in_edges_tensor generation:  0.0005548000335693359
mini_batch_src_global generation:  0.0010883808135986328
r_  generation:  0.009781122207641602
local_output_nid generation:  0.000865936279296875
local_in_edges_tensor generation:  0.0005609989166259766
mini_batch_src_global generation:  0.0010721683502197266
r_  generation:  0.010075569152832031
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0005598068237304688
mini_batch_src_global generation:  0.001058340072631836
r_  generation:  0.009906291961669922
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0011124610900878906
r_  generation:  0.01021122932434082
local_output_nid generation:  0.0008676052093505859
local_in_edges_tensor generation:  0.0005526542663574219
mini_batch_src_global generation:  0.0010762214660644531
r_  generation:  0.010276079177856445
local_output_nid generation:  0.0008535385131835938
local_in_edges_tensor generation:  0.0005667209625244141
mini_batch_src_global generation:  0.0010612010955810547
r_  generation:  0.010115623474121094
local_output_nid generation:  0.0008535385131835938
local_in_edges_tensor generation:  0.0005755424499511719
mini_batch_src_global generation:  0.0011012554168701172
r_  generation:  0.010430335998535156
local_output_nid generation:  0.0008542537689208984
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.001055002212524414
r_  generation:  0.009978771209716797
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.000537872314453125
mini_batch_src_global generation:  0.0011625289916992188
r_  generation:  0.010362386703491211
local_output_nid generation:  0.0008575916290283203
local_in_edges_tensor generation:  0.0005826950073242188
mini_batch_src_global generation:  0.0011210441589355469
r_  generation:  0.010455846786499023
local_output_nid generation:  0.0008649826049804688
local_in_edges_tensor generation:  0.0005395412445068359
mini_batch_src_global generation:  0.0010380744934082031
r_  generation:  0.00966501235961914
local_output_nid generation:  0.0008649826049804688
local_in_edges_tensor generation:  0.0005500316619873047
mini_batch_src_global generation:  0.001062154769897461
r_  generation:  0.01011204719543457
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.00054168701171875
mini_batch_src_global generation:  0.0010476112365722656
r_  generation:  0.00994563102722168
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.0005397796630859375
mini_batch_src_global generation:  0.0010373592376708984
r_  generation:  0.009720563888549805
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0005338191986083984
mini_batch_src_global generation:  0.0010390281677246094
r_  generation:  0.00995016098022461
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.0005741119384765625
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.010025978088378906
local_output_nid generation:  0.0008535385131835938
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.01053476333618164
local_output_nid generation:  0.0008950233459472656
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0011036396026611328
r_  generation:  0.009957313537597656
local_output_nid generation:  0.0009241104125976562
local_in_edges_tensor generation:  0.0005490779876708984
mini_batch_src_global generation:  0.0011606216430664062
r_  generation:  0.010203123092651367
local_output_nid generation:  0.0009191036224365234
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.0011115074157714844
r_  generation:  0.010088205337524414
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0012180805206298828
r_  generation:  0.010647296905517578
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0005548000335693359
mini_batch_src_global generation:  0.001104593276977539
r_  generation:  0.010006904602050781
local_output_nid generation:  0.0008523464202880859
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0011980533599853516
r_  generation:  0.010571956634521484
local_output_nid generation:  0.0009045600891113281
local_in_edges_tensor generation:  0.000553131103515625
mini_batch_src_global generation:  0.0010609626770019531
r_  generation:  0.010044097900390625
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0005431175231933594
mini_batch_src_global generation:  0.0011489391326904297
r_  generation:  0.010308265686035156
----------------------check_connections_block total spend ----------------------------- 0.5093486309051514
generate_one_block  0.024255990982055664
generate_one_block  0.0200192928314209
generate_one_block  0.018174171447753906
generate_one_block  0.017099380493164062
generate_one_block  0.01730966567993164
generate_one_block  0.01781940460205078
generate_one_block  0.017244338989257812
generate_one_block  0.017012834548950195
generate_one_block  0.017647981643676758
generate_one_block  0.016897201538085938
generate_one_block  0.01744842529296875
generate_one_block  0.018031597137451172
generate_one_block  0.017215251922607422
generate_one_block  0.017905473709106445
generate_one_block  0.017132043838500977
generate_one_block  0.017590761184692383
generate_one_block  0.017731904983520508
generate_one_block  0.01635289192199707
generate_one_block  0.017104148864746094
generate_one_block  0.01702260971069336
generate_one_block  0.01656818389892578
generate_one_block  0.016832351684570312
generate_one_block  0.0170133113861084
generate_one_block  0.01736927032470703
generate_one_block  0.01673412322998047
generate_one_block  0.017061710357666016
generate_one_block  0.016915082931518555
generate_one_block  0.0179903507232666
generate_one_block  0.01681351661682129
generate_one_block  0.017708301544189453
generate_one_block  0.016764163970947266
generate_one_block  0.01706075668334961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03522944450378418
gen group dst list time:  0.02014470100402832
time for parepare:  0.019648313522338867
local_output_nid generation:  0.005392313003540039
local_in_edges_tensor generation:  0.019025325775146484
mini_batch_src_global generation:  0.015214681625366211
r_  generation:  0.14133453369140625
local_output_nid generation:  0.007369518280029297
local_in_edges_tensor generation:  0.010041236877441406
mini_batch_src_global generation:  0.018095016479492188
r_  generation:  0.1423814296722412
local_output_nid generation:  0.007669687271118164
local_in_edges_tensor generation:  0.0308837890625
mini_batch_src_global generation:  0.016228914260864258
r_  generation:  0.145979642868042
local_output_nid generation:  0.007715702056884766
local_in_edges_tensor generation:  0.009980440139770508
mini_batch_src_global generation:  0.017084360122680664
r_  generation:  0.14501285552978516
local_output_nid generation:  0.008358478546142578
local_in_edges_tensor generation:  0.010110855102539062
mini_batch_src_global generation:  0.01840806007385254
r_  generation:  0.14628124237060547
local_output_nid generation:  0.008576154708862305
local_in_edges_tensor generation:  0.008036136627197266
mini_batch_src_global generation:  0.01834893226623535
r_  generation:  0.15403008460998535
local_output_nid generation:  0.008440971374511719
local_in_edges_tensor generation:  0.007930994033813477
mini_batch_src_global generation:  0.018470287322998047
r_  generation:  0.15151190757751465
local_output_nid generation:  0.008105754852294922
local_in_edges_tensor generation:  0.00809335708618164
mini_batch_src_global generation:  0.018027067184448242
r_  generation:  0.14766573905944824
local_output_nid generation:  0.008243083953857422
local_in_edges_tensor generation:  0.007976770401000977
mini_batch_src_global generation:  0.018760204315185547
r_  generation:  0.1533217430114746
local_output_nid generation:  0.00821232795715332
local_in_edges_tensor generation:  0.009389877319335938
mini_batch_src_global generation:  0.017853260040283203
r_  generation:  0.14891719818115234
local_output_nid generation:  0.008455514907836914
local_in_edges_tensor generation:  0.008370399475097656
mini_batch_src_global generation:  0.0189669132232666
r_  generation:  0.15288138389587402
local_output_nid generation:  0.008932113647460938
local_in_edges_tensor generation:  0.009429454803466797
mini_batch_src_global generation:  0.019755125045776367
r_  generation:  0.1555767059326172
local_output_nid generation:  0.008718252182006836
local_in_edges_tensor generation:  0.007933616638183594
mini_batch_src_global generation:  0.018563032150268555
r_  generation:  0.15091371536254883
local_output_nid generation:  0.008957624435424805
local_in_edges_tensor generation:  0.00813746452331543
mini_batch_src_global generation:  0.018931150436401367
r_  generation:  0.15529894828796387
local_output_nid generation:  0.008662939071655273
local_in_edges_tensor generation:  0.008087635040283203
mini_batch_src_global generation:  0.018851280212402344
r_  generation:  0.15495586395263672
local_output_nid generation:  0.008778810501098633
local_in_edges_tensor generation:  0.00823974609375
mini_batch_src_global generation:  0.018993377685546875
r_  generation:  0.15610265731811523
local_output_nid generation:  0.008806705474853516
local_in_edges_tensor generation:  0.009416580200195312
mini_batch_src_global generation:  0.018880128860473633
r_  generation:  0.15425610542297363
local_output_nid generation:  0.008444786071777344
local_in_edges_tensor generation:  0.009506940841674805
mini_batch_src_global generation:  0.018309354782104492
r_  generation:  0.14359188079833984
local_output_nid generation:  0.008789300918579102
local_in_edges_tensor generation:  0.008309125900268555
mini_batch_src_global generation:  0.018055200576782227
r_  generation:  0.15123486518859863
local_output_nid generation:  0.008828163146972656
local_in_edges_tensor generation:  0.008787870407104492
mini_batch_src_global generation:  0.018284320831298828
r_  generation:  0.14926505088806152
local_output_nid generation:  0.00862741470336914
local_in_edges_tensor generation:  0.008027791976928711
mini_batch_src_global generation:  0.01793956756591797
r_  generation:  0.14668679237365723
local_output_nid generation:  0.008661270141601562
local_in_edges_tensor generation:  0.007962703704833984
mini_batch_src_global generation:  0.018141508102416992
r_  generation:  0.15379858016967773
local_output_nid generation:  0.008806705474853516
local_in_edges_tensor generation:  0.010720968246459961
mini_batch_src_global generation:  0.018401622772216797
r_  generation:  0.15039706230163574
local_output_nid generation:  0.008936166763305664
local_in_edges_tensor generation:  0.008155107498168945
mini_batch_src_global generation:  0.01896071434020996
r_  generation:  0.15385746955871582
local_output_nid generation:  0.008643150329589844
local_in_edges_tensor generation:  0.00817251205444336
mini_batch_src_global generation:  0.018537044525146484
r_  generation:  0.1508324146270752
local_output_nid generation:  0.008924245834350586
local_in_edges_tensor generation:  0.00824284553527832
mini_batch_src_global generation:  0.018729448318481445
r_  generation:  0.15329694747924805
local_output_nid generation:  0.008588314056396484
local_in_edges_tensor generation:  0.00836634635925293
mini_batch_src_global generation:  0.018668174743652344
r_  generation:  0.1499335765838623
local_output_nid generation:  0.009276390075683594
local_in_edges_tensor generation:  0.008999109268188477
mini_batch_src_global generation:  0.020048141479492188
r_  generation:  0.16251635551452637
local_output_nid generation:  0.00876927375793457
local_in_edges_tensor generation:  0.00819540023803711
mini_batch_src_global generation:  0.018442869186401367
r_  generation:  0.15057086944580078
local_output_nid generation:  0.00921940803527832
local_in_edges_tensor generation:  0.008971214294433594
mini_batch_src_global generation:  0.019449949264526367
r_  generation:  0.15774178504943848
local_output_nid generation:  0.008669853210449219
local_in_edges_tensor generation:  0.008099079132080078
mini_batch_src_global generation:  0.018338441848754883
r_  generation:  0.1496598720550537
local_output_nid generation:  0.008922576904296875
local_in_edges_tensor generation:  0.008236408233642578
mini_batch_src_global generation:  0.0187838077545166
r_  generation:  0.15215444564819336
----------------------check_connections_block total spend ----------------------------- 7.153235197067261
generate_one_block  0.2130281925201416
generate_one_block  0.20457792282104492
generate_one_block  0.20370888710021973
generate_one_block  0.1980915069580078
generate_one_block  0.2285938262939453
generate_one_block  0.20740389823913574
generate_one_block  0.2011122703552246
generate_one_block  0.19693779945373535
generate_one_block  0.20467543601989746
generate_one_block  0.1965959072113037
generate_one_block  0.20422863960266113
generate_one_block  0.2077012062072754
generate_one_block  0.20615100860595703
generate_one_block  0.2059011459350586
generate_one_block  0.20000314712524414
generate_one_block  0.20502877235412598
generate_one_block  0.2062215805053711
generate_one_block  0.19145917892456055
generate_one_block  0.19546079635620117
generate_one_block  0.2936086654663086
generate_one_block  0.19348835945129395
generate_one_block  0.19699907302856445
generate_one_block  0.19867825508117676
generate_one_block  0.20344066619873047
generate_one_block  0.19547629356384277
generate_one_block  0.20220327377319336
generate_one_block  0.19671344757080078
generate_one_block  0.21737241744995117
generate_one_block  0.2010974884033203
generate_one_block  0.20921111106872559
generate_one_block  0.1930859088897705
generate_one_block  0.198378324508667
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02842879295349121
gen group dst list time:  0.09717655181884766
time for parepare:  0.017974138259887695
local_output_nid generation:  0.023410320281982422
local_in_edges_tensor generation:  0.04732108116149902
mini_batch_src_global generation:  0.03823280334472656
r_  generation:  0.4079611301422119
local_output_nid generation:  0.028148412704467773
local_in_edges_tensor generation:  0.030469655990600586
mini_batch_src_global generation:  0.04950523376464844
r_  generation:  0.39617276191711426
local_output_nid generation:  0.02872753143310547
local_in_edges_tensor generation:  0.02573370933532715
mini_batch_src_global generation:  0.04779839515686035
r_  generation:  0.4127507209777832
local_output_nid generation:  0.02835249900817871
local_in_edges_tensor generation:  0.02570056915283203
mini_batch_src_global generation:  0.047933101654052734
r_  generation:  0.4054529666900635
local_output_nid generation:  0.02843022346496582
local_in_edges_tensor generation:  0.031183719635009766
mini_batch_src_global generation:  0.04671216011047363
r_  generation:  0.410963773727417
local_output_nid generation:  0.028368711471557617
local_in_edges_tensor generation:  0.025554418563842773
mini_batch_src_global generation:  0.049037933349609375
r_  generation:  0.41054201126098633
local_output_nid generation:  0.02695488929748535
local_in_edges_tensor generation:  0.03104376792907715
mini_batch_src_global generation:  0.04992938041687012
r_  generation:  0.4133005142211914
local_output_nid generation:  0.026874065399169922
local_in_edges_tensor generation:  0.027504682540893555
mini_batch_src_global generation:  0.04810523986816406
r_  generation:  0.40143728256225586
local_output_nid generation:  0.02721881866455078
local_in_edges_tensor generation:  0.03241682052612305
mini_batch_src_global generation:  0.04933285713195801
r_  generation:  0.42244887351989746
local_output_nid generation:  0.02723217010498047
local_in_edges_tensor generation:  0.025993824005126953
mini_batch_src_global generation:  0.049086570739746094
r_  generation:  0.40329694747924805
local_output_nid generation:  0.02706432342529297
local_in_edges_tensor generation:  0.025476455688476562
mini_batch_src_global generation:  0.04731249809265137
r_  generation:  0.4132983684539795
local_output_nid generation:  0.027326345443725586
local_in_edges_tensor generation:  0.028499603271484375
mini_batch_src_global generation:  0.04873085021972656
r_  generation:  0.4094817638397217
local_output_nid generation:  0.026998519897460938
local_in_edges_tensor generation:  0.028064727783203125
mini_batch_src_global generation:  0.04710960388183594
r_  generation:  0.41088056564331055
local_output_nid generation:  0.027332305908203125
local_in_edges_tensor generation:  0.025975465774536133
mini_batch_src_global generation:  0.05089592933654785
r_  generation:  0.40976667404174805
local_output_nid generation:  0.02714395523071289
local_in_edges_tensor generation:  0.025873422622680664
mini_batch_src_global generation:  0.054180145263671875
r_  generation:  0.4108998775482178
local_output_nid generation:  0.027129411697387695
local_in_edges_tensor generation:  0.0270230770111084
mini_batch_src_global generation:  0.049368858337402344
r_  generation:  0.4067952632904053
local_output_nid generation:  0.027310609817504883
local_in_edges_tensor generation:  0.026876449584960938
mini_batch_src_global generation:  0.04806113243103027
r_  generation:  0.4278218746185303
local_output_nid generation:  0.02850794792175293
local_in_edges_tensor generation:  0.029117822647094727
mini_batch_src_global generation:  0.05029773712158203
r_  generation:  0.4004786014556885
local_output_nid generation:  0.02758955955505371
local_in_edges_tensor generation:  0.02497553825378418
mini_batch_src_global generation:  0.04669046401977539
r_  generation:  0.41031932830810547
local_output_nid generation:  0.02751946449279785
local_in_edges_tensor generation:  0.024963855743408203
mini_batch_src_global generation:  0.04866909980773926
r_  generation:  0.4049849510192871
local_output_nid generation:  0.028809070587158203
local_in_edges_tensor generation:  0.02556896209716797
mini_batch_src_global generation:  0.04686117172241211
r_  generation:  0.41286611557006836
local_output_nid generation:  0.028028011322021484
local_in_edges_tensor generation:  0.02561640739440918
mini_batch_src_global generation:  0.04926943778991699
r_  generation:  0.4065401554107666
local_output_nid generation:  0.027942895889282227
local_in_edges_tensor generation:  0.02506113052368164
mini_batch_src_global generation:  0.04941129684448242
r_  generation:  0.4132390022277832
local_output_nid generation:  0.02785801887512207
local_in_edges_tensor generation:  0.02518606185913086
mini_batch_src_global generation:  0.048933982849121094
r_  generation:  0.4040853977203369
local_output_nid generation:  0.027852535247802734
local_in_edges_tensor generation:  0.026964187622070312
mini_batch_src_global generation:  0.04880094528198242
r_  generation:  0.413224458694458
local_output_nid generation:  0.02806854248046875
local_in_edges_tensor generation:  0.028523683547973633
mini_batch_src_global generation:  0.04932427406311035
r_  generation:  0.4083743095397949
local_output_nid generation:  0.027680397033691406
local_in_edges_tensor generation:  0.025444984436035156
mini_batch_src_global generation:  0.04673266410827637
r_  generation:  0.4115865230560303
local_output_nid generation:  0.028226852416992188
local_in_edges_tensor generation:  0.02920675277709961
mini_batch_src_global generation:  0.04944491386413574
r_  generation:  0.4175267219543457
local_output_nid generation:  0.0277249813079834
local_in_edges_tensor generation:  0.02455759048461914
mini_batch_src_global generation:  0.046916961669921875
r_  generation:  0.41335296630859375
local_output_nid generation:  0.02801656723022461
local_in_edges_tensor generation:  0.026073455810546875
mini_batch_src_global generation:  0.05137205123901367
r_  generation:  0.41234707832336426
local_output_nid generation:  0.027706384658813477
local_in_edges_tensor generation:  0.026103496551513672
mini_batch_src_global generation:  0.046813249588012695
r_  generation:  0.41623735427856445
local_output_nid generation:  0.027994394302368164
local_in_edges_tensor generation:  0.02558612823486328
mini_batch_src_global generation:  0.04859471321105957
r_  generation:  0.40621232986450195
----------------------check_connections_block total spend ----------------------------- 19.37591052055359
generate_one_block  0.650437593460083
generate_one_block  0.5457754135131836
generate_one_block  0.5486016273498535
generate_one_block  0.5443174839019775
generate_one_block  0.5403320789337158
generate_one_block  0.5511295795440674
generate_one_block  0.5484459400177002
generate_one_block  0.5450282096862793
generate_one_block  0.5570685863494873
generate_one_block  0.5454609394073486
generate_one_block  0.5662102699279785
generate_one_block  0.5558774471282959
generate_one_block  0.5501062870025635
generate_one_block  0.5519061088562012
generate_one_block  0.5526440143585205
generate_one_block  0.5498087406158447
generate_one_block  0.5513017177581787
generate_one_block  0.5362539291381836
generate_one_block  0.5395328998565674
generate_one_block  0.543971061706543
generate_one_block  0.5419363975524902
generate_one_block  0.5477726459503174
generate_one_block  0.5486059188842773
generate_one_block  0.5450179576873779
generate_one_block  0.546210765838623
generate_one_block  0.5522580146789551
generate_one_block  0.5390150547027588
generate_one_block  0.5658247470855713
generate_one_block  0.5412380695343018
generate_one_block  0.554546594619751
generate_one_block  0.5410113334655762
generate_one_block  0.5606698989868164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12252521514892578  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

connection checking time:  26.52914571762085
block generation total time  24.234951734542847
average batch blocks generation time:  0.757342241704464
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10536050796508789  GigaBytes
Max Memory Allocated: 17.519874095916748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.500885486602783  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10474205017089844  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.009891986846924  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527610778808594  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.14808177947998  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10476112365722656  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.761898040771484  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522651672363281  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.779550552368164  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10489511489868164  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.197093963623047  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524463653564453  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.976705074310303  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10438776016235352  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.718757152557373  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052861213684082  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.190265655517578  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046304702758789  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.69961452484131  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052846908569336  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.05925178527832  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046438217163086  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.179189205169678  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522747039794922  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.778573513031006  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10487508773803711  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.1877703666687  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524225234985352  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.017108917236328  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10463523864746094  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.049570083618164  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528421401977539  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.13286256790161  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10455036163330078  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.27522850036621  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052083969116211  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.705899238586426  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10461044311523438  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.630760669708252  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10515642166137695  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.48233699798584  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10471582412719727  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.68698024749756  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520458221435547  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.690175533294678  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10444402694702148  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.010272979736328  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520124435424805  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.7017240524292  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.104736328125  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.09432029724121  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520267486572266  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.69433879852295  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1049489974975586  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.468945026397705  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520315170288086  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.680033206939697  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10500383377075195  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.28752088546753  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518026351928711  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.566423892974854  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10460329055786133  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.882816791534424  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0339973121881485 |0.013074278831481934 |0.41220487654209137 |9.129941463470459e-05 |0.7547434568405151 |0.007531166076660156 |
----------------------------------------------------------pseudo_mini_loss sum 1.8538166284561157
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  8797909
Number of first layer input nodes during this epoch:  4682954
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12317609786987305  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025295257568359375
range selection method range initialization spend 0.016798734664916992
time for parepare:  0.017406702041625977
local_output_nid generation:  0.0009453296661376953
local_in_edges_tensor generation:  0.006348609924316406
mini_batch_src_global generation:  0.0017850399017333984
r_  generation:  0.011727333068847656
local_output_nid generation:  0.0009663105010986328
local_in_edges_tensor generation:  0.0006651878356933594
mini_batch_src_global generation:  0.001325845718383789
r_  generation:  0.010208845138549805
local_output_nid generation:  0.0009071826934814453
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.0010297298431396484
r_  generation:  0.009742498397827148
local_output_nid generation:  0.0008988380432128906
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.001031637191772461
r_  generation:  0.009641170501708984
local_output_nid generation:  0.0008852481842041016
local_in_edges_tensor generation:  0.0006105899810791016
mini_batch_src_global generation:  0.0010328292846679688
r_  generation:  0.009832382202148438
local_output_nid generation:  0.0008771419525146484
local_in_edges_tensor generation:  0.0005438327789306641
mini_batch_src_global generation:  0.0010304450988769531
r_  generation:  0.009746074676513672
local_output_nid generation:  0.0009045600891113281
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.001119375228881836
r_  generation:  0.010485410690307617
local_output_nid generation:  0.0009105205535888672
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.009455680847167969
local_output_nid generation:  0.0008792877197265625
local_in_edges_tensor generation:  0.000545501708984375
mini_batch_src_global generation:  0.0010673999786376953
r_  generation:  0.00956416130065918
local_output_nid generation:  0.0008606910705566406
local_in_edges_tensor generation:  0.0005452632904052734
mini_batch_src_global generation:  0.0011212825775146484
r_  generation:  0.009988546371459961
local_output_nid generation:  0.0009281635284423828
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.0010864734649658203
r_  generation:  0.010050535202026367
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005600452423095703
mini_batch_src_global generation:  0.001054525375366211
r_  generation:  0.009792327880859375
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0005402565002441406
mini_batch_src_global generation:  0.0010399818420410156
r_  generation:  0.010111570358276367
local_output_nid generation:  0.0008559226989746094
local_in_edges_tensor generation:  0.0005509853363037109
mini_batch_src_global generation:  0.0010938644409179688
r_  generation:  0.00998234748840332
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.009989738464355469
local_output_nid generation:  0.0008466243743896484
local_in_edges_tensor generation:  0.0005614757537841797
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.010137081146240234
local_output_nid generation:  0.0008418560028076172
local_in_edges_tensor generation:  0.0005328655242919922
mini_batch_src_global generation:  0.001062631607055664
r_  generation:  0.010007619857788086
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0005407333374023438
mini_batch_src_global generation:  0.0010895729064941406
r_  generation:  0.009943246841430664
local_output_nid generation:  0.0008511543273925781
local_in_edges_tensor generation:  0.0005693435668945312
mini_batch_src_global generation:  0.0010793209075927734
r_  generation:  0.009752273559570312
local_output_nid generation:  0.0008440017700195312
local_in_edges_tensor generation:  0.0005524158477783203
mini_batch_src_global generation:  0.0010933876037597656
r_  generation:  0.010131120681762695
local_output_nid generation:  0.0008370876312255859
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.0011281967163085938
r_  generation:  0.010326147079467773
local_output_nid generation:  0.0008618831634521484
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.010430335998535156
local_output_nid generation:  0.0008571147918701172
local_in_edges_tensor generation:  0.0005643367767333984
mini_batch_src_global generation:  0.0012009143829345703
r_  generation:  0.010183572769165039
local_output_nid generation:  0.0008554458618164062
local_in_edges_tensor generation:  0.000553131103515625
mini_batch_src_global generation:  0.0010955333709716797
r_  generation:  0.009906291961669922
local_output_nid generation:  0.0008437633514404297
local_in_edges_tensor generation:  0.0005469322204589844
mini_batch_src_global generation:  0.0011239051818847656
r_  generation:  0.010267257690429688
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0005524158477783203
mini_batch_src_global generation:  0.0011782646179199219
r_  generation:  0.010386466979980469
local_output_nid generation:  0.0008475780487060547
local_in_edges_tensor generation:  0.0005762577056884766
mini_batch_src_global generation:  0.0011434555053710938
r_  generation:  0.010235786437988281
local_output_nid generation:  0.0008544921875
local_in_edges_tensor generation:  0.0005486011505126953
mini_batch_src_global generation:  0.001142263412475586
r_  generation:  0.010368585586547852
local_output_nid generation:  0.0008499622344970703
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.01068425178527832
local_output_nid generation:  0.0008420944213867188
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.010067462921142578
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.0005428791046142578
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.00993657112121582
local_output_nid generation:  0.0008385181427001953
local_in_edges_tensor generation:  0.0005371570587158203
mini_batch_src_global generation:  0.0010628700256347656
r_  generation:  0.009552717208862305
----------------------check_connections_block total spend ----------------------------- 0.5048403739929199
generate_one_block  0.01987934112548828
generate_one_block  0.019245624542236328
generate_one_block  0.017734289169311523
generate_one_block  0.017288923263549805
generate_one_block  0.01755523681640625
generate_one_block  0.017087697982788086
generate_one_block  0.018066883087158203
generate_one_block  0.016379356384277344
generate_one_block  0.016751766204833984
generate_one_block  0.017124176025390625
generate_one_block  0.017082929611206055
generate_one_block  0.016887187957763672
generate_one_block  0.01711893081665039
generate_one_block  0.0170595645904541
generate_one_block  0.01704096794128418
generate_one_block  0.01748490333557129
generate_one_block  0.01709294319152832
generate_one_block  0.016758203506469727
generate_one_block  0.01670694351196289
generate_one_block  0.01741790771484375
generate_one_block  0.017516374588012695
generate_one_block  0.017656803131103516
generate_one_block  0.019484519958496094
generate_one_block  0.01708531379699707
generate_one_block  0.0175783634185791
generate_one_block  0.017659664154052734
generate_one_block  0.01733231544494629
generate_one_block  0.017508745193481445
generate_one_block  0.01740860939025879
generate_one_block  0.016987085342407227
generate_one_block  0.01671600341796875
generate_one_block  0.016321182250976562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03738141059875488
gen group dst list time:  0.022410869598388672
time for parepare:  0.019370079040527344
local_output_nid generation:  0.005357027053833008
local_in_edges_tensor generation:  0.017738819122314453
mini_batch_src_global generation:  0.01649308204650879
r_  generation:  0.13709211349487305
local_output_nid generation:  0.007169008255004883
local_in_edges_tensor generation:  0.009560585021972656
mini_batch_src_global generation:  0.017400264739990234
r_  generation:  0.13709259033203125
local_output_nid generation:  0.008010149002075195
local_in_edges_tensor generation:  0.02983713150024414
mini_batch_src_global generation:  0.017340898513793945
r_  generation:  0.1458425521850586
local_output_nid generation:  0.008103132247924805
local_in_edges_tensor generation:  0.008613109588623047
mini_batch_src_global generation:  0.01732492446899414
r_  generation:  0.14426207542419434
local_output_nid generation:  0.00844430923461914
local_in_edges_tensor generation:  0.010172128677368164
mini_batch_src_global generation:  0.019178390502929688
r_  generation:  0.15231084823608398
local_output_nid generation:  0.008092164993286133
local_in_edges_tensor generation:  0.008551359176635742
mini_batch_src_global generation:  0.017679452896118164
r_  generation:  0.14359331130981445
local_output_nid generation:  0.008427858352661133
local_in_edges_tensor generation:  0.01082921028137207
mini_batch_src_global generation:  0.02046060562133789
r_  generation:  0.1578209400177002
local_output_nid generation:  0.0077970027923583984
local_in_edges_tensor generation:  0.009492874145507812
mini_batch_src_global generation:  0.017900705337524414
r_  generation:  0.1414165496826172
local_output_nid generation:  0.007940292358398438
local_in_edges_tensor generation:  0.007546901702880859
mini_batch_src_global generation:  0.01788187026977539
r_  generation:  0.1452045440673828
local_output_nid generation:  0.008385419845581055
local_in_edges_tensor generation:  0.008171796798706055
mini_batch_src_global generation:  0.018183469772338867
r_  generation:  0.15030813217163086
local_output_nid generation:  0.008339643478393555
local_in_edges_tensor generation:  0.008069992065429688
mini_batch_src_global generation:  0.01849675178527832
r_  generation:  0.14821076393127441
local_output_nid generation:  0.008442878723144531
local_in_edges_tensor generation:  0.0077364444732666016
mini_batch_src_global generation:  0.017951488494873047
r_  generation:  0.14679670333862305
local_output_nid generation:  0.008581399917602539
local_in_edges_tensor generation:  0.008266448974609375
mini_batch_src_global generation:  0.018060684204101562
r_  generation:  0.1486067771911621
local_output_nid generation:  0.008780479431152344
local_in_edges_tensor generation:  0.008165121078491211
mini_batch_src_global generation:  0.018483638763427734
r_  generation:  0.1529064178466797
local_output_nid generation:  0.008808374404907227
local_in_edges_tensor generation:  0.008211135864257812
mini_batch_src_global generation:  0.01863408088684082
r_  generation:  0.15235614776611328
local_output_nid generation:  0.008800745010375977
local_in_edges_tensor generation:  0.009441852569580078
mini_batch_src_global generation:  0.019148588180541992
r_  generation:  0.1562650203704834
local_output_nid generation:  0.008765220642089844
local_in_edges_tensor generation:  0.008310794830322266
mini_batch_src_global generation:  0.01908254623413086
r_  generation:  0.15039396286010742
local_output_nid generation:  0.008676528930664062
local_in_edges_tensor generation:  0.007958173751831055
mini_batch_src_global generation:  0.01846790313720703
r_  generation:  0.14902877807617188
local_output_nid generation:  0.008642196655273438
local_in_edges_tensor generation:  0.008109807968139648
mini_batch_src_global generation:  0.018488168716430664
r_  generation:  0.1479322910308838
local_output_nid generation:  0.008970499038696289
local_in_edges_tensor generation:  0.008384943008422852
mini_batch_src_global generation:  0.019063472747802734
r_  generation:  0.15905356407165527
local_output_nid generation:  0.010567903518676758
local_in_edges_tensor generation:  0.008852958679199219
mini_batch_src_global generation:  0.01924920082092285
r_  generation:  0.15643811225891113
local_output_nid generation:  0.009210586547851562
local_in_edges_tensor generation:  0.009480953216552734
mini_batch_src_global generation:  0.020257234573364258
r_  generation:  0.16097736358642578
local_output_nid generation:  0.009098291397094727
local_in_edges_tensor generation:  0.008594274520874023
mini_batch_src_global generation:  0.01941847801208496
r_  generation:  0.15428686141967773
local_output_nid generation:  0.008865594863891602
local_in_edges_tensor generation:  0.008342742919921875
mini_batch_src_global generation:  0.018657684326171875
r_  generation:  0.15081787109375
local_output_nid generation:  0.009343862533569336
local_in_edges_tensor generation:  0.008334636688232422
mini_batch_src_global generation:  0.019713878631591797
r_  generation:  0.15709733963012695
local_output_nid generation:  0.009179115295410156
local_in_edges_tensor generation:  0.009211540222167969
mini_batch_src_global generation:  0.01927351951599121
r_  generation:  0.156660795211792
local_output_nid generation:  0.00916910171508789
local_in_edges_tensor generation:  0.008899688720703125
mini_batch_src_global generation:  0.019427061080932617
r_  generation:  0.1575782299041748
local_output_nid generation:  0.009181737899780273
local_in_edges_tensor generation:  0.008866310119628906
mini_batch_src_global generation:  0.019301652908325195
r_  generation:  0.1663966178894043
local_output_nid generation:  0.009927511215209961
local_in_edges_tensor generation:  0.008417129516601562
mini_batch_src_global generation:  0.01951885223388672
r_  generation:  0.15831494331359863
local_output_nid generation:  0.008922815322875977
local_in_edges_tensor generation:  0.008330821990966797
mini_batch_src_global generation:  0.01860213279724121
r_  generation:  0.1531517505645752
local_output_nid generation:  0.009086370468139648
local_in_edges_tensor generation:  0.008034229278564453
mini_batch_src_global generation:  0.018337726593017578
r_  generation:  0.149885892868042
local_output_nid generation:  0.008665323257446289
local_in_edges_tensor generation:  0.008060216903686523
mini_batch_src_global generation:  0.01829385757446289
r_  generation:  0.14732861518859863
----------------------check_connections_block total spend ----------------------------- 7.170756101608276
generate_one_block  0.1984272003173828
generate_one_block  0.19181489944458008
generate_one_block  0.20132207870483398
generate_one_block  0.20034146308898926
generate_one_block  0.21883440017700195
generate_one_block  0.19141888618469238
generate_one_block  0.2127671241760254
generate_one_block  0.18838286399841309
generate_one_block  0.19445276260375977
generate_one_block  0.1990370750427246
generate_one_block  0.19726157188415527
generate_one_block  0.19157910346984863
generate_one_block  0.19617986679077148
generate_one_block  0.2019352912902832
generate_one_block  0.19951200485229492
generate_one_block  0.20386242866516113
generate_one_block  0.20040678977966309
generate_one_block  0.1933751106262207
generate_one_block  0.1944575309753418
generate_one_block  0.21229219436645508
generate_one_block  0.20673584938049316
generate_one_block  0.211655855178833
generate_one_block  0.20221590995788574
generate_one_block  0.19685888290405273
generate_one_block  0.2088310718536377
generate_one_block  0.2092125415802002
generate_one_block  0.20675420761108398
generate_one_block  0.20909857749938965
generate_one_block  0.20869064331054688
generate_one_block  0.1999974250793457
generate_one_block  0.19446301460266113
generate_one_block  0.1910393238067627
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03844261169433594
gen group dst list time:  0.09995889663696289
time for parepare:  0.02001023292541504
local_output_nid generation:  0.022516250610351562
local_in_edges_tensor generation:  0.052594900131225586
mini_batch_src_global generation:  0.038718223571777344
r_  generation:  0.4013631343841553
local_output_nid generation:  0.028263330459594727
local_in_edges_tensor generation:  0.032422780990600586
mini_batch_src_global generation:  0.048101186752319336
r_  generation:  0.39704251289367676
local_output_nid generation:  0.028481483459472656
local_in_edges_tensor generation:  0.027603626251220703
mini_batch_src_global generation:  0.0489044189453125
r_  generation:  0.4120957851409912
local_output_nid generation:  0.028544187545776367
local_in_edges_tensor generation:  0.027481555938720703
mini_batch_src_global generation:  0.04856586456298828
r_  generation:  0.40202927589416504
local_output_nid generation:  0.028979778289794922
local_in_edges_tensor generation:  0.028431177139282227
mini_batch_src_global generation:  0.047257423400878906
r_  generation:  0.41510915756225586
local_output_nid generation:  0.028287649154663086
local_in_edges_tensor generation:  0.02501702308654785
mini_batch_src_global generation:  0.04944419860839844
r_  generation:  0.3996891975402832
local_output_nid generation:  0.02727508544921875
local_in_edges_tensor generation:  0.025272369384765625
mini_batch_src_global generation:  0.04949951171875
r_  generation:  0.41398167610168457
local_output_nid generation:  0.02668023109436035
local_in_edges_tensor generation:  0.028831958770751953
mini_batch_src_global generation:  0.048917531967163086
r_  generation:  0.3949239253997803
local_output_nid generation:  0.027045249938964844
local_in_edges_tensor generation:  0.025717496871948242
mini_batch_src_global generation:  0.0469212532043457
r_  generation:  0.4076099395751953
local_output_nid generation:  0.02708911895751953
local_in_edges_tensor generation:  0.025141000747680664
mini_batch_src_global generation:  0.049332618713378906
r_  generation:  0.40194082260131836
local_output_nid generation:  0.027002573013305664
local_in_edges_tensor generation:  0.02683711051940918
mini_batch_src_global generation:  0.049416303634643555
r_  generation:  0.4110555648803711
local_output_nid generation:  0.02695441246032715
local_in_edges_tensor generation:  0.02538442611694336
mini_batch_src_global generation:  0.049152374267578125
r_  generation:  0.40002989768981934
local_output_nid generation:  0.027250051498413086
local_in_edges_tensor generation:  0.025667667388916016
mini_batch_src_global generation:  0.047147512435913086
r_  generation:  0.41053080558776855
local_output_nid generation:  0.02721858024597168
local_in_edges_tensor generation:  0.028687715530395508
mini_batch_src_global generation:  0.04946017265319824
r_  generation:  0.4085712432861328
local_output_nid generation:  0.027230024337768555
local_in_edges_tensor generation:  0.0270233154296875
mini_batch_src_global generation:  0.0474238395690918
r_  generation:  0.4147799015045166
local_output_nid generation:  0.027535200119018555
local_in_edges_tensor generation:  0.02915668487548828
mini_batch_src_global generation:  0.04975128173828125
r_  generation:  0.41460323333740234
local_output_nid generation:  0.027398347854614258
local_in_edges_tensor generation:  0.02570629119873047
mini_batch_src_global generation:  0.04753398895263672
r_  generation:  0.4168403148651123
local_output_nid generation:  0.027102231979370117
local_in_edges_tensor generation:  0.025580167770385742
mini_batch_src_global generation:  0.049375057220458984
r_  generation:  0.40302300453186035
local_output_nid generation:  0.02743053436279297
local_in_edges_tensor generation:  0.025293350219726562
mini_batch_src_global generation:  0.047907352447509766
r_  generation:  0.41507411003112793
local_output_nid generation:  0.027338027954101562
local_in_edges_tensor generation:  0.03288626670837402
mini_batch_src_global generation:  0.05132412910461426
r_  generation:  0.406602144241333
local_output_nid generation:  0.027209758758544922
local_in_edges_tensor generation:  0.02538585662841797
mini_batch_src_global generation:  0.047803640365600586
r_  generation:  0.4121572971343994
local_output_nid generation:  0.02744579315185547
local_in_edges_tensor generation:  0.029402732849121094
mini_batch_src_global generation:  0.049835205078125
r_  generation:  0.41037440299987793
local_output_nid generation:  0.027550935745239258
local_in_edges_tensor generation:  0.028202533721923828
mini_batch_src_global generation:  0.04946112632751465
r_  generation:  0.4156224727630615
local_output_nid generation:  0.027134418487548828
local_in_edges_tensor generation:  0.02626514434814453
mini_batch_src_global generation:  0.04919743537902832
r_  generation:  0.40610289573669434
local_output_nid generation:  0.027742862701416016
local_in_edges_tensor generation:  0.02554941177368164
mini_batch_src_global generation:  0.04966616630554199
r_  generation:  0.418689489364624
local_output_nid generation:  0.02753925323486328
local_in_edges_tensor generation:  0.028504133224487305
mini_batch_src_global generation:  0.05010366439819336
r_  generation:  0.4082503318786621
local_output_nid generation:  0.027745485305786133
local_in_edges_tensor generation:  0.02771592140197754
mini_batch_src_global generation:  0.048424482345581055
r_  generation:  0.4207625389099121
local_output_nid generation:  0.0275728702545166
local_in_edges_tensor generation:  0.025729656219482422
mini_batch_src_global generation:  0.04940915107727051
r_  generation:  0.4094834327697754
local_output_nid generation:  0.02779102325439453
local_in_edges_tensor generation:  0.026211023330688477
mini_batch_src_global generation:  0.04770708084106445
r_  generation:  0.41742777824401855
local_output_nid generation:  0.02767777442932129
local_in_edges_tensor generation:  0.02617669105529785
mini_batch_src_global generation:  0.04990410804748535
r_  generation:  0.4111003875732422
local_output_nid generation:  0.0272216796875
local_in_edges_tensor generation:  0.026067018508911133
mini_batch_src_global generation:  0.047844886779785156
r_  generation:  0.4093770980834961
local_output_nid generation:  0.027025938034057617
local_in_edges_tensor generation:  0.025649309158325195
mini_batch_src_global generation:  0.04871058464050293
r_  generation:  0.40445780754089355
----------------------check_connections_block total spend ----------------------------- 19.351319551467896
generate_one_block  0.5438225269317627
generate_one_block  0.541508674621582
generate_one_block  0.5483734607696533
generate_one_block  0.5466887950897217
generate_one_block  0.6285080909729004
generate_one_block  0.5359375476837158
generate_one_block  0.5560040473937988
generate_one_block  0.5358538627624512
generate_one_block  0.5400402545928955
generate_one_block  0.5454728603363037
generate_one_block  0.5433053970336914
generate_one_block  0.5408437252044678
generate_one_block  0.5402169227600098
generate_one_block  0.5518696308135986
generate_one_block  0.5487117767333984
generate_one_block  0.5521674156188965
generate_one_block  0.5461759567260742
generate_one_block  0.5395126342773438
generate_one_block  0.5467402935028076
generate_one_block  0.5556011199951172
generate_one_block  0.5521624088287354
generate_one_block  0.5581710338592529
generate_one_block  0.5499053001403809
generate_one_block  0.54538893699646
generate_one_block  0.5710909366607666
generate_one_block  0.5477640628814697
generate_one_block  0.557746171951294
generate_one_block  0.5544812679290771
generate_one_block  0.5561091899871826
generate_one_block  0.5529851913452148
generate_one_block  0.5444626808166504
generate_one_block  0.5406267642974854
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12317609786987305  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

connection checking time:  26.522075653076172
block generation total time  24.05146288871765
average batch blocks generation time:  0.7516082152724266
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524368286132812  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.91580820083618  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1045989990234375  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.527129650115967  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.105255126953125  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.03810405731201  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10466909408569336  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.737064361572266  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528850555419922  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.156022548675537  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10433197021484375  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.557527542114258  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10538291931152344  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.466114044189453  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10442256927490234  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.357028484344482  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518074035644531  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.58788824081421  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10472679138183594  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.97270631790161  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521936416625977  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.781253337860107  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10431671142578125  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.53310537338257  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521411895751953  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.72417974472046  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10466337203979492  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.99526023864746  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522699356079102  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.807451248168945  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10482931137084961  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.12206268310547  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521888732910156  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.794006824493408  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10448265075683594  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.626540184020996  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519027709960938  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.659993171691895  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10477781295776367  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.12787628173828  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530233383178711  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.128791332244873  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10485124588012695  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.415802478790283  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052699089050293  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.068145275115967  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10469532012939453  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.70238161087036  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.105316162109375  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.25191640853882  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10477828979492188  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.136545181274414  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530996322631836  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.21835422515869  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10491561889648438  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.22421360015869  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530996322631836  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.202199935913086  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10492324829101562  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.88621997833252  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1051945686340332  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.62943124771118  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10436868667602539  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.435279369354248  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034726016223430634 |0.01577170193195343 |0.4120097830891609 |9.17091965675354e-05 |0.7555891945958138 |0.006681919097900391 |
----------------------------------------------------------pseudo_mini_loss sum 1.7702950239181519
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  8791852
Number of first layer input nodes during this epoch:  4679738
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12167644500732422  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025938987731933594
range selection method range initialization spend 0.013323068618774414
time for parepare:  0.01857900619506836
local_output_nid generation:  0.0009198188781738281
local_in_edges_tensor generation:  0.006285905838012695
mini_batch_src_global generation:  0.0016243457794189453
r_  generation:  0.010270118713378906
local_output_nid generation:  0.0009801387786865234
local_in_edges_tensor generation:  0.0006890296936035156
mini_batch_src_global generation:  0.0013921260833740234
r_  generation:  0.01007986068725586
local_output_nid generation:  0.0008900165557861328
local_in_edges_tensor generation:  0.0005972385406494141
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.00995945930480957
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0005810260772705078
mini_batch_src_global generation:  0.0010380744934082031
r_  generation:  0.009535074234008789
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0005939006805419922
mini_batch_src_global generation:  0.001112222671508789
r_  generation:  0.009668827056884766
local_output_nid generation:  0.0008897781372070312
local_in_edges_tensor generation:  0.0005893707275390625
mini_batch_src_global generation:  0.0010590553283691406
r_  generation:  0.009795188903808594
local_output_nid generation:  0.0008933544158935547
local_in_edges_tensor generation:  0.0005545616149902344
mini_batch_src_global generation:  0.0010793209075927734
r_  generation:  0.009935379028320312
local_output_nid generation:  0.0009229183197021484
local_in_edges_tensor generation:  0.0005686283111572266
mini_batch_src_global generation:  0.0010504722595214844
r_  generation:  0.009959220886230469
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0010557174682617188
r_  generation:  0.009897232055664062
local_output_nid generation:  0.0008475780487060547
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0010530948638916016
r_  generation:  0.009859085083007812
local_output_nid generation:  0.0008575916290283203
local_in_edges_tensor generation:  0.0005433559417724609
mini_batch_src_global generation:  0.001066446304321289
r_  generation:  0.010088205337524414
local_output_nid generation:  0.0008475780487060547
local_in_edges_tensor generation:  0.0005524158477783203
mini_batch_src_global generation:  0.0010533332824707031
r_  generation:  0.009956121444702148
local_output_nid generation:  0.0008494853973388672
local_in_edges_tensor generation:  0.0005519390106201172
mini_batch_src_global generation:  0.0010571479797363281
r_  generation:  0.00984811782836914
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0005452632904052734
mini_batch_src_global generation:  0.0010635852813720703
r_  generation:  0.01001286506652832
local_output_nid generation:  0.0008409023284912109
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.0010814666748046875
r_  generation:  0.010055303573608398
local_output_nid generation:  0.0008492469787597656
local_in_edges_tensor generation:  0.0005559921264648438
mini_batch_src_global generation:  0.0011341571807861328
r_  generation:  0.009871959686279297
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.0005548000335693359
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.010078668594360352
local_output_nid generation:  0.0008459091186523438
local_in_edges_tensor generation:  0.0005693435668945312
mini_batch_src_global generation:  0.0011973381042480469
r_  generation:  0.010305404663085938
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.0005562305450439453
mini_batch_src_global generation:  0.0011146068572998047
r_  generation:  0.010440587997436523
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0005438327789306641
mini_batch_src_global generation:  0.0011920928955078125
r_  generation:  0.010222911834716797
local_output_nid generation:  0.0008492469787597656
local_in_edges_tensor generation:  0.0005500316619873047
mini_batch_src_global generation:  0.0010864734649658203
r_  generation:  0.010054826736450195
local_output_nid generation:  0.0008523464202880859
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0011227130889892578
r_  generation:  0.01019287109375
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0005590915679931641
mini_batch_src_global generation:  0.0010981559753417969
r_  generation:  0.009867668151855469
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0005428791046142578
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.009931564331054688
local_output_nid generation:  0.0008513927459716797
local_in_edges_tensor generation:  0.00054168701171875
mini_batch_src_global generation:  0.001142740249633789
r_  generation:  0.009937763214111328
local_output_nid generation:  0.0008530616760253906
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.0011668205261230469
r_  generation:  0.010289669036865234
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.0005517005920410156
mini_batch_src_global generation:  0.0010886192321777344
r_  generation:  0.010069131851196289
local_output_nid generation:  0.0008480548858642578
local_in_edges_tensor generation:  0.0005502700805664062
mini_batch_src_global generation:  0.001092672348022461
r_  generation:  0.010162115097045898
local_output_nid generation:  0.0008606910705566406
local_in_edges_tensor generation:  0.0005381107330322266
mini_batch_src_global generation:  0.001079559326171875
r_  generation:  0.010125398635864258
local_output_nid generation:  0.0008444786071777344
local_in_edges_tensor generation:  0.000553131103515625
mini_batch_src_global generation:  0.0010635852813720703
r_  generation:  0.009727954864501953
local_output_nid generation:  0.0008444786071777344
local_in_edges_tensor generation:  0.0005202293395996094
mini_batch_src_global generation:  0.001055002212524414
r_  generation:  0.010123014450073242
local_output_nid generation:  0.0008337497711181641
local_in_edges_tensor generation:  0.0005323886871337891
mini_batch_src_global generation:  0.0010404586791992188
r_  generation:  0.009813785552978516
----------------------check_connections_block total spend ----------------------------- 0.5034840106964111
generate_one_block  0.022917985916137695
generate_one_block  0.020514965057373047
generate_one_block  0.018286705017089844
generate_one_block  0.017337322235107422
generate_one_block  0.017346620559692383
generate_one_block  0.017413616180419922
generate_one_block  0.017342329025268555
generate_one_block  0.017487287521362305
generate_one_block  0.01745891571044922
generate_one_block  0.017343759536743164
generate_one_block  0.01740241050720215
generate_one_block  0.017065048217773438
generate_one_block  0.016915559768676758
generate_one_block  0.01744246482849121
generate_one_block  0.01699233055114746
generate_one_block  0.016788005828857422
generate_one_block  0.017057418823242188
generate_one_block  0.017742395401000977
generate_one_block  0.01764202117919922
generate_one_block  0.01766204833984375
generate_one_block  0.017083168029785156
generate_one_block  0.017197370529174805
generate_one_block  0.019315242767333984
generate_one_block  0.017043352127075195
generate_one_block  0.01716160774230957
generate_one_block  0.017606258392333984
generate_one_block  0.017115116119384766
generate_one_block  0.017177581787109375
generate_one_block  0.017101049423217773
generate_one_block  0.016673564910888672
generate_one_block  0.017162561416625977
generate_one_block  0.01666998863220215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03553152084350586
gen group dst list time:  0.022595882415771484
time for parepare:  0.021622896194458008
local_output_nid generation:  0.005063533782958984
local_in_edges_tensor generation:  0.01598525047302246
mini_batch_src_global generation:  0.01441812515258789
r_  generation:  0.13280630111694336
local_output_nid generation:  0.007498264312744141
local_in_edges_tensor generation:  0.010090827941894531
mini_batch_src_global generation:  0.018581390380859375
r_  generation:  0.14272546768188477
local_output_nid generation:  0.007758617401123047
local_in_edges_tensor generation:  0.03207731246948242
mini_batch_src_global generation:  0.017540931701660156
r_  generation:  0.1465449333190918
local_output_nid generation:  0.007809162139892578
local_in_edges_tensor generation:  0.007748603820800781
mini_batch_src_global generation:  0.017324209213256836
r_  generation:  0.1473073959350586
local_output_nid generation:  0.008198976516723633
local_in_edges_tensor generation:  0.00958251953125
mini_batch_src_global generation:  0.01840066909790039
r_  generation:  0.14637279510498047
local_output_nid generation:  0.008474111557006836
local_in_edges_tensor generation:  0.009246587753295898
mini_batch_src_global generation:  0.018073558807373047
r_  generation:  0.14856863021850586
local_output_nid generation:  0.008622169494628906
local_in_edges_tensor generation:  0.0080108642578125
mini_batch_src_global generation:  0.018324613571166992
r_  generation:  0.14949965476989746
local_output_nid generation:  0.00830841064453125
local_in_edges_tensor generation:  0.008057594299316406
mini_batch_src_global generation:  0.018979787826538086
r_  generation:  0.15320134162902832
local_output_nid generation:  0.008261919021606445
local_in_edges_tensor generation:  0.008157491683959961
mini_batch_src_global generation:  0.018465280532836914
r_  generation:  0.14964866638183594
local_output_nid generation:  0.008468389511108398
local_in_edges_tensor generation:  0.008081436157226562
mini_batch_src_global generation:  0.01885986328125
r_  generation:  0.1486208438873291
local_output_nid generation:  0.008463382720947266
local_in_edges_tensor generation:  0.008085012435913086
mini_batch_src_global generation:  0.01879596710205078
r_  generation:  0.15327119827270508
local_output_nid generation:  0.00856471061706543
local_in_edges_tensor generation:  0.007832765579223633
mini_batch_src_global generation:  0.0186464786529541
r_  generation:  0.1483149528503418
local_output_nid generation:  0.00864100456237793
local_in_edges_tensor generation:  0.008006095886230469
mini_batch_src_global generation:  0.01936626434326172
r_  generation:  0.15146875381469727
local_output_nid generation:  0.008862018585205078
local_in_edges_tensor generation:  0.009913444519042969
mini_batch_src_global generation:  0.019183874130249023
r_  generation:  0.15451836585998535
local_output_nid generation:  0.008686065673828125
local_in_edges_tensor generation:  0.008013010025024414
mini_batch_src_global generation:  0.01870870590209961
r_  generation:  0.15033388137817383
local_output_nid generation:  0.008691072463989258
local_in_edges_tensor generation:  0.008190631866455078
mini_batch_src_global generation:  0.01861715316772461
r_  generation:  0.14885759353637695
local_output_nid generation:  0.00870513916015625
local_in_edges_tensor generation:  0.008028984069824219
mini_batch_src_global generation:  0.01857447624206543
r_  generation:  0.14972138404846191
local_output_nid generation:  0.009064197540283203
local_in_edges_tensor generation:  0.009375572204589844
mini_batch_src_global generation:  0.01981806755065918
r_  generation:  0.1566307544708252
local_output_nid generation:  0.009144783020019531
local_in_edges_tensor generation:  0.008994102478027344
mini_batch_src_global generation:  0.01932215690612793
r_  generation:  0.15854978561401367
local_output_nid generation:  0.009058237075805664
local_in_edges_tensor generation:  0.00879216194152832
mini_batch_src_global generation:  0.01944446563720703
r_  generation:  0.1593320369720459
local_output_nid generation:  0.00890207290649414
local_in_edges_tensor generation:  0.008174896240234375
mini_batch_src_global generation:  0.01898646354675293
r_  generation:  0.1548168659210205
local_output_nid generation:  0.008938074111938477
local_in_edges_tensor generation:  0.008797645568847656
mini_batch_src_global generation:  0.019910812377929688
r_  generation:  0.15516400337219238
local_output_nid generation:  0.008924484252929688
local_in_edges_tensor generation:  0.008141756057739258
mini_batch_src_global generation:  0.018603086471557617
r_  generation:  0.1528174877166748
local_output_nid generation:  0.008702754974365234
local_in_edges_tensor generation:  0.008554935455322266
mini_batch_src_global generation:  0.018481731414794922
r_  generation:  0.15018439292907715
local_output_nid generation:  0.008904218673706055
local_in_edges_tensor generation:  0.008831262588500977
mini_batch_src_global generation:  0.019754648208618164
r_  generation:  0.15549731254577637
local_output_nid generation:  0.009044647216796875
local_in_edges_tensor generation:  0.008223772048950195
mini_batch_src_global generation:  0.019411563873291016
r_  generation:  0.1578512191772461
local_output_nid generation:  0.008880615234375
local_in_edges_tensor generation:  0.008251190185546875
mini_batch_src_global generation:  0.01877307891845703
r_  generation:  0.15393400192260742
local_output_nid generation:  0.00886678695678711
local_in_edges_tensor generation:  0.00882720947265625
mini_batch_src_global generation:  0.018944978713989258
r_  generation:  0.15377187728881836
local_output_nid generation:  0.008893966674804688
local_in_edges_tensor generation:  0.008792877197265625
mini_batch_src_global generation:  0.018769025802612305
r_  generation:  0.15691876411437988
local_output_nid generation:  0.008807182312011719
local_in_edges_tensor generation:  0.00811004638671875
mini_batch_src_global generation:  0.018440961837768555
r_  generation:  0.1492772102355957
local_output_nid generation:  0.008928537368774414
local_in_edges_tensor generation:  0.008488655090332031
mini_batch_src_global generation:  0.0196530818939209
r_  generation:  0.156005859375
local_output_nid generation:  0.008726835250854492
local_in_edges_tensor generation:  0.0081024169921875
mini_batch_src_global generation:  0.018327951431274414
r_  generation:  0.15087532997131348
----------------------check_connections_block total spend ----------------------------- 7.1750829219818115
generate_one_block  0.1942591667175293
generate_one_block  0.20552587509155273
generate_one_block  0.2039656639099121
generate_one_block  0.20430302619934082
generate_one_block  0.21174073219299316
generate_one_block  0.20163679122924805
generate_one_block  0.1996455192565918
generate_one_block  0.2050762176513672
generate_one_block  0.19942951202392578
generate_one_block  0.197157621383667
generate_one_block  0.20261287689208984
generate_one_block  0.19602656364440918
generate_one_block  0.198167085647583
generate_one_block  0.20342779159545898
generate_one_block  0.2003493309020996
generate_one_block  0.19402217864990234
generate_one_block  0.1970200538635254
generate_one_block  0.20686078071594238
generate_one_block  0.2078390121459961
generate_one_block  0.21174359321594238
generate_one_block  0.2002427577972412
generate_one_block  0.2042548656463623
generate_one_block  0.20071625709533691
generate_one_block  0.20008492469787598
generate_one_block  0.20413756370544434
generate_one_block  0.20876002311706543
generate_one_block  0.20409250259399414
generate_one_block  0.2018754482269287
generate_one_block  0.20183444023132324
generate_one_block  0.1938929557800293
generate_one_block  0.20243287086486816
generate_one_block  0.19577264785766602
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03665924072265625
gen group dst list time:  0.09911417961120605
time for parepare:  0.01963973045349121
local_output_nid generation:  0.02209019660949707
local_in_edges_tensor generation:  0.03843855857849121
mini_batch_src_global generation:  0.03670978546142578
r_  generation:  0.39836549758911133
local_output_nid generation:  0.028005361557006836
local_in_edges_tensor generation:  0.03213047981262207
mini_batch_src_global generation:  0.04812479019165039
r_  generation:  0.3955729007720947
local_output_nid generation:  0.028275728225708008
local_in_edges_tensor generation:  0.02639317512512207
mini_batch_src_global generation:  0.04672122001647949
r_  generation:  0.41324782371520996
local_output_nid generation:  0.028523683547973633
local_in_edges_tensor generation:  0.0265045166015625
mini_batch_src_global generation:  0.050165653228759766
r_  generation:  0.4028353691101074
local_output_nid generation:  0.02846813201904297
local_in_edges_tensor generation:  0.026301145553588867
mini_batch_src_global generation:  0.047607421875
r_  generation:  0.4092423915863037
local_output_nid generation:  0.028530597686767578
local_in_edges_tensor generation:  0.026885509490966797
mini_batch_src_global generation:  0.05132722854614258
r_  generation:  0.40851759910583496
local_output_nid generation:  0.027428627014160156
local_in_edges_tensor generation:  0.02729034423828125
mini_batch_src_global generation:  0.04824495315551758
r_  generation:  0.41135239601135254
local_output_nid generation:  0.026845216751098633
local_in_edges_tensor generation:  0.027048110961914062
mini_batch_src_global generation:  0.04960012435913086
r_  generation:  0.40474534034729004
local_output_nid generation:  0.02696681022644043
local_in_edges_tensor generation:  0.0249631404876709
mini_batch_src_global generation:  0.04808926582336426
r_  generation:  0.41692638397216797
local_output_nid generation:  0.027173995971679688
local_in_edges_tensor generation:  0.02920079231262207
mini_batch_src_global generation:  0.04932522773742676
r_  generation:  0.4024324417114258
local_output_nid generation:  0.027096986770629883
local_in_edges_tensor generation:  0.028181076049804688
mini_batch_src_global generation:  0.04974007606506348
r_  generation:  0.4159080982208252
local_output_nid generation:  0.027718544006347656
local_in_edges_tensor generation:  0.026497602462768555
mini_batch_src_global generation:  0.04910159111022949
r_  generation:  0.4064934253692627
local_output_nid generation:  0.027512788772583008
local_in_edges_tensor generation:  0.027343273162841797
mini_batch_src_global generation:  0.0475006103515625
r_  generation:  0.41508007049560547
local_output_nid generation:  0.027223825454711914
local_in_edges_tensor generation:  0.030152559280395508
mini_batch_src_global generation:  0.05363798141479492
r_  generation:  0.40630149841308594
local_output_nid generation:  0.02696681022644043
local_in_edges_tensor generation:  0.025825977325439453
mini_batch_src_global generation:  0.04746675491333008
r_  generation:  0.41198110580444336
local_output_nid generation:  0.028139591217041016
local_in_edges_tensor generation:  0.025200366973876953
mini_batch_src_global generation:  0.04968762397766113
r_  generation:  0.40119409561157227
local_output_nid generation:  0.027431011199951172
local_in_edges_tensor generation:  0.025528430938720703
mini_batch_src_global generation:  0.04924178123474121
r_  generation:  0.41231274604797363
local_output_nid generation:  0.027591228485107422
local_in_edges_tensor generation:  0.028194904327392578
mini_batch_src_global generation:  0.05048727989196777
r_  generation:  0.4106018543243408
local_output_nid generation:  0.028468608856201172
local_in_edges_tensor generation:  0.0275418758392334
mini_batch_src_global generation:  0.052083492279052734
r_  generation:  0.4173915386199951
local_output_nid generation:  0.027172088623046875
local_in_edges_tensor generation:  0.025380611419677734
mini_batch_src_global generation:  0.049863576889038086
r_  generation:  0.4061744213104248
local_output_nid generation:  0.027291536331176758
local_in_edges_tensor generation:  0.026807308197021484
mini_batch_src_global generation:  0.04947209358215332
r_  generation:  0.4201810359954834
local_output_nid generation:  0.028204679489135742
local_in_edges_tensor generation:  0.025608301162719727
mini_batch_src_global generation:  0.04949307441711426
r_  generation:  0.40363621711730957
local_output_nid generation:  0.027683734893798828
local_in_edges_tensor generation:  0.02674412727355957
mini_batch_src_global generation:  0.04955935478210449
r_  generation:  0.41367292404174805
local_output_nid generation:  0.02760601043701172
local_in_edges_tensor generation:  0.025938034057617188
mini_batch_src_global generation:  0.05028128623962402
r_  generation:  0.40772056579589844
local_output_nid generation:  0.028259992599487305
local_in_edges_tensor generation:  0.026548385620117188
mini_batch_src_global generation:  0.05153846740722656
r_  generation:  0.41509366035461426
local_output_nid generation:  0.027511119842529297
local_in_edges_tensor generation:  0.025631427764892578
mini_batch_src_global generation:  0.05020475387573242
r_  generation:  0.406524658203125
local_output_nid generation:  0.027393579483032227
local_in_edges_tensor generation:  0.026152849197387695
mini_batch_src_global generation:  0.049660444259643555
r_  generation:  0.41731977462768555
local_output_nid generation:  0.02736830711364746
local_in_edges_tensor generation:  0.026071786880493164
mini_batch_src_global generation:  0.04980826377868652
r_  generation:  0.40675902366638184
local_output_nid generation:  0.02720165252685547
local_in_edges_tensor generation:  0.025007963180541992
mini_batch_src_global generation:  0.047844886779785156
r_  generation:  0.4124462604522705
local_output_nid generation:  0.02703404426574707
local_in_edges_tensor generation:  0.027521133422851562
mini_batch_src_global generation:  0.0498354434967041
r_  generation:  0.4100840091705322
local_output_nid generation:  0.02772998809814453
local_in_edges_tensor generation:  0.029134035110473633
mini_batch_src_global generation:  0.04772162437438965
r_  generation:  0.4164869785308838
local_output_nid generation:  0.026951074600219727
local_in_edges_tensor generation:  0.025728464126586914
mini_batch_src_global generation:  0.04897952079772949
r_  generation:  0.3995704650878906
----------------------check_connections_block total spend ----------------------------- 19.372925758361816
generate_one_block  0.5466420650482178
generate_one_block  0.5520594120025635
generate_one_block  0.5470600128173828
generate_one_block  0.550529956817627
generate_one_block  0.6255142688751221
generate_one_block  0.5487346649169922
generate_one_block  0.5500683784484863
generate_one_block  0.5546960830688477
generate_one_block  0.5427563190460205
generate_one_block  0.5413236618041992
generate_one_block  0.5541837215423584
generate_one_block  0.5429091453552246
generate_one_block  0.5458574295043945
generate_one_block  0.5490536689758301
generate_one_block  0.5519986152648926
generate_one_block  0.5423328876495361
generate_one_block  0.5498719215393066
generate_one_block  0.5668215751647949
generate_one_block  0.5593619346618652
generate_one_block  0.5509486198425293
generate_one_block  0.5495669841766357
generate_one_block  0.5459833145141602
generate_one_block  0.5451092720031738
generate_one_block  0.5446815490722656
generate_one_block  0.5774686336517334
generate_one_block  0.5576877593994141
generate_one_block  0.5457451343536377
generate_one_block  0.5478470325469971
generate_one_block  0.5431289672851562
generate_one_block  0.5397017002105713
generate_one_block  0.5588042736053467
generate_one_block  0.5434932708740234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12167644500732422  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

connection checking time:  26.548008680343628
block generation total time  24.13084888458252
average batch blocks generation time:  0.7540890276432037
block dataloader generation time/epoch 53.61743879318237
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518407821655273  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.64290189743042  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1045980453491211  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.08448600769043  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529136657714844  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.16171360015869  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10469388961791992  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.028271675109863  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052250862121582  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.74953556060791  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10512924194335938  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.890591144561768  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522317886352539  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.83512544631958  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10459423065185547  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.16340446472168  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522842407226562  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.840843200683594  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10461950302124023  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.667998790740967  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526227951049805  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.058218955993652  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10441064834594727  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.67877769470215  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521507263183594  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.77874517440796  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10473442077636719  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.08280658721924  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521316528320312  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.732600212097168  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1047830581665039  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.59588050842285  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520076751708984  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.72164297103882  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1048579216003418  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.219791889190674  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530948638916016  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.286295413970947  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10470199584960938  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.285304069519043  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525274276733398  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.012648582458496  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10468864440917969  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.04143714904785  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524606704711914  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.993266582489014  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10476827621459961  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.685921669006348  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526466369628906  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.121469497680664  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10474920272827148  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.195603847503662  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526514053344727  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.061387538909912  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10483455657958984  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.012934684753418  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052546501159668  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.944687843322754  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10461997985839844  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.604568481445312  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526609420776367  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.06118154525757  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1044626235961914  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.548149585723877  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03481920808553696 |0.013017348945140839 |0.4137195497751236 |9.182840585708618e-05 |0.757296122610569 |0.00557398796081543 |
----------------------------------------------------------pseudo_mini_loss sum 1.712561845779419
Total (block generation + training)time/epoch 92.68301248550415
Training time/epoch 39.065306663513184
Training time without block to device /epoch 38.64875149726868
Training time without total dataloading part /epoch 37.481014013290405
load block tensor time/epoch 1.1142146587371826
block to device time/epoch 0.41655516624450684
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  8796893
Number of first layer input nodes during this epoch:  4681996
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12239789962768555  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03154182434082031
range selection method range initialization spend 0.017597675323486328
time for parepare:  0.023446083068847656
local_output_nid generation:  0.0011909008026123047
local_in_edges_tensor generation:  0.007840633392333984
mini_batch_src_global generation:  0.0024423599243164062
r_  generation:  0.011041641235351562
local_output_nid generation:  0.0010013580322265625
local_in_edges_tensor generation:  0.0007216930389404297
mini_batch_src_global generation:  0.001641988754272461
r_  generation:  0.01135110855102539
local_output_nid generation:  0.0010266304016113281
local_in_edges_tensor generation:  0.0006833076477050781
mini_batch_src_global generation:  0.0013477802276611328
r_  generation:  0.009984970092773438
local_output_nid generation:  0.0010170936584472656
local_in_edges_tensor generation:  0.0007658004760742188
mini_batch_src_global generation:  0.0012958049774169922
r_  generation:  0.010342121124267578
local_output_nid generation:  0.0009982585906982422
local_in_edges_tensor generation:  0.0006585121154785156
mini_batch_src_global generation:  0.0013859272003173828
r_  generation:  0.010236501693725586
local_output_nid generation:  0.001020193099975586
local_in_edges_tensor generation:  0.0006864070892333984
mini_batch_src_global generation:  0.0012943744659423828
r_  generation:  0.010235071182250977
local_output_nid generation:  0.0010137557983398438
local_in_edges_tensor generation:  0.0006768703460693359
mini_batch_src_global generation:  0.0013201236724853516
r_  generation:  0.010781526565551758
local_output_nid generation:  0.0010480880737304688
local_in_edges_tensor generation:  0.0006387233734130859
mini_batch_src_global generation:  0.0012784004211425781
r_  generation:  0.010651111602783203
local_output_nid generation:  0.0010256767272949219
local_in_edges_tensor generation:  0.0006651878356933594
mini_batch_src_global generation:  0.001352548599243164
r_  generation:  0.010256052017211914
local_output_nid generation:  0.0010035037994384766
local_in_edges_tensor generation:  0.0006449222564697266
mini_batch_src_global generation:  0.0014357566833496094
r_  generation:  0.010304927825927734
local_output_nid generation:  0.0010111331939697266
local_in_edges_tensor generation:  0.0006499290466308594
mini_batch_src_global generation:  0.0013315677642822266
r_  generation:  0.010376691818237305
local_output_nid generation:  0.0010421276092529297
local_in_edges_tensor generation:  0.0006597042083740234
mini_batch_src_global generation:  0.0014367103576660156
r_  generation:  0.010389089584350586
local_output_nid generation:  0.001018524169921875
local_in_edges_tensor generation:  0.0006260871887207031
mini_batch_src_global generation:  0.0012657642364501953
r_  generation:  0.010559558868408203
local_output_nid generation:  0.0010137557983398438
local_in_edges_tensor generation:  0.0006499290466308594
mini_batch_src_global generation:  0.0013244152069091797
r_  generation:  0.01031351089477539
local_output_nid generation:  0.0010118484497070312
local_in_edges_tensor generation:  0.0007052421569824219
mini_batch_src_global generation:  0.0014047622680664062
r_  generation:  0.010179281234741211
local_output_nid generation:  0.0010156631469726562
local_in_edges_tensor generation:  0.0006566047668457031
mini_batch_src_global generation:  0.0014369487762451172
r_  generation:  0.010508298873901367
local_output_nid generation:  0.0010156631469726562
local_in_edges_tensor generation:  0.0006437301635742188
mini_batch_src_global generation:  0.0013992786407470703
r_  generation:  0.010780811309814453
local_output_nid generation:  0.0010249614715576172
local_in_edges_tensor generation:  0.0006563663482666016
mini_batch_src_global generation:  0.0013270378112792969
r_  generation:  0.010682821273803711
local_output_nid generation:  0.001020193099975586
local_in_edges_tensor generation:  0.0006964206695556641
mini_batch_src_global generation:  0.0013279914855957031
r_  generation:  0.010288715362548828
local_output_nid generation:  0.0010457038879394531
local_in_edges_tensor generation:  0.000640869140625
mini_batch_src_global generation:  0.0014367103576660156
r_  generation:  0.010139226913452148
local_output_nid generation:  0.0010285377502441406
local_in_edges_tensor generation:  0.0007169246673583984
mini_batch_src_global generation:  0.0013957023620605469
r_  generation:  0.010857343673706055
local_output_nid generation:  0.0010223388671875
local_in_edges_tensor generation:  0.0006418228149414062
mini_batch_src_global generation:  0.0014014244079589844
r_  generation:  0.010422468185424805
local_output_nid generation:  0.001039743423461914
local_in_edges_tensor generation:  0.0006558895111083984
mini_batch_src_global generation:  0.0013179779052734375
r_  generation:  0.010451316833496094
local_output_nid generation:  0.0010349750518798828
local_in_edges_tensor generation:  0.0006270408630371094
mini_batch_src_global generation:  0.0013535022735595703
r_  generation:  0.010731935501098633
local_output_nid generation:  0.0010349750518798828
local_in_edges_tensor generation:  0.0006444454193115234
mini_batch_src_global generation:  0.0013225078582763672
r_  generation:  0.010076522827148438
local_output_nid generation:  0.0010101795196533203
local_in_edges_tensor generation:  0.0006272792816162109
mini_batch_src_global generation:  0.001308441162109375
r_  generation:  0.010628223419189453
local_output_nid generation:  0.0009992122650146484
local_in_edges_tensor generation:  0.0006322860717773438
mini_batch_src_global generation:  0.0013189315795898438
r_  generation:  0.010745763778686523
local_output_nid generation:  0.0010154247283935547
local_in_edges_tensor generation:  0.0006344318389892578
mini_batch_src_global generation:  0.001277923583984375
r_  generation:  0.010704517364501953
local_output_nid generation:  0.0010268688201904297
local_in_edges_tensor generation:  0.0006318092346191406
mini_batch_src_global generation:  0.001302480697631836
r_  generation:  0.010734319686889648
local_output_nid generation:  0.0010077953338623047
local_in_edges_tensor generation:  0.0006241798400878906
mini_batch_src_global generation:  0.0013005733489990234
r_  generation:  0.010381221771240234
local_output_nid generation:  0.0010151863098144531
local_in_edges_tensor generation:  0.0006504058837890625
mini_batch_src_global generation:  0.0012967586517333984
r_  generation:  0.010380983352661133
local_output_nid generation:  0.0010159015655517578
local_in_edges_tensor generation:  0.0006439685821533203
mini_batch_src_global generation:  0.0014390945434570312
r_  generation:  0.010091304779052734
----------------------check_connections_block total spend ----------------------------- 0.54852294921875
generate_one_block  0.023089170455932617
generate_one_block  0.02181077003479004
generate_one_block  0.019194364547729492
generate_one_block  0.019059181213378906
generate_one_block  0.01860785484313965
generate_one_block  0.018573999404907227
generate_one_block  0.018889665603637695
generate_one_block  0.01860785484313965
generate_one_block  0.01849842071533203
generate_one_block  0.018003463745117188
generate_one_block  0.01829075813293457
generate_one_block  0.018183469772338867
generate_one_block  0.0184175968170166
generate_one_block  0.018280744552612305
generate_one_block  0.030631303787231445
generate_one_block  0.01865696907043457
generate_one_block  0.018080711364746094
generate_one_block  0.017863035202026367
generate_one_block  0.017330169677734375
generate_one_block  0.017135143280029297
generate_one_block  0.018129587173461914
generate_one_block  0.01743292808532715
generate_one_block  0.020128726959228516
generate_one_block  0.017780780792236328
generate_one_block  0.016860485076904297
generate_one_block  0.01762557029724121
generate_one_block  0.0175478458404541
generate_one_block  0.01757025718688965
generate_one_block  0.01755070686340332
generate_one_block  0.017069101333618164
generate_one_block  0.01693105697631836
generate_one_block  0.01680135726928711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03623008728027344
gen group dst list time:  0.020562171936035156
time for parepare:  0.021622896194458008
local_output_nid generation:  0.005326271057128906
local_in_edges_tensor generation:  0.017023086547851562
mini_batch_src_global generation:  0.014274835586547852
r_  generation:  0.13428759574890137
local_output_nid generation:  0.0074253082275390625
local_in_edges_tensor generation:  0.009619712829589844
mini_batch_src_global generation:  0.017565488815307617
r_  generation:  0.17052984237670898
local_output_nid generation:  0.007607936859130859
local_in_edges_tensor generation:  0.03163957595825195
mini_batch_src_global generation:  0.016259193420410156
r_  generation:  0.1468348503112793
local_output_nid generation:  0.008539915084838867
local_in_edges_tensor generation:  0.010453462600708008
mini_batch_src_global generation:  0.018209218978881836
r_  generation:  0.1557331085205078
local_output_nid generation:  0.008362054824829102
local_in_edges_tensor generation:  0.009643077850341797
mini_batch_src_global generation:  0.030428647994995117
r_  generation:  0.17812705039978027
local_output_nid generation:  0.013065099716186523
local_in_edges_tensor generation:  0.012088537216186523
mini_batch_src_global generation:  0.027414560317993164
r_  generation:  0.1646442413330078
local_output_nid generation:  0.010589599609375
local_in_edges_tensor generation:  0.01401376724243164
mini_batch_src_global generation:  0.022753238677978516
r_  generation:  0.16377758979797363
local_output_nid generation:  0.008967876434326172
local_in_edges_tensor generation:  0.00955963134765625
mini_batch_src_global generation:  0.021892070770263672
r_  generation:  0.1592845916748047
local_output_nid generation:  0.008580207824707031
local_in_edges_tensor generation:  0.008388042449951172
mini_batch_src_global generation:  0.02216362953186035
r_  generation:  0.1665496826171875
local_output_nid generation:  0.010199546813964844
local_in_edges_tensor generation:  0.01034235954284668
mini_batch_src_global generation:  0.022038936614990234
r_  generation:  0.1552417278289795
local_output_nid generation:  0.008939743041992188
local_in_edges_tensor generation:  0.009040594100952148
mini_batch_src_global generation:  0.019101858139038086
r_  generation:  0.15349316596984863
local_output_nid generation:  0.008927345275878906
local_in_edges_tensor generation:  0.008081912994384766
mini_batch_src_global generation:  0.019936800003051758
r_  generation:  0.15101194381713867
local_output_nid generation:  0.009006023406982422
local_in_edges_tensor generation:  0.00826120376586914
mini_batch_src_global generation:  0.01899123191833496
r_  generation:  0.18763303756713867
local_output_nid generation:  0.008989095687866211
local_in_edges_tensor generation:  0.008254766464233398
mini_batch_src_global generation:  0.019054412841796875
r_  generation:  0.19200634956359863
local_output_nid generation:  0.008671998977661133
local_in_edges_tensor generation:  0.010274171829223633
mini_batch_src_global generation:  0.018978595733642578
r_  generation:  0.18305277824401855
local_output_nid generation:  0.012503385543823242
local_in_edges_tensor generation:  0.00915837287902832
mini_batch_src_global generation:  0.022390365600585938
r_  generation:  0.15454530715942383
local_output_nid generation:  0.009022235870361328
local_in_edges_tensor generation:  0.009540557861328125
mini_batch_src_global generation:  0.019907712936401367
r_  generation:  0.15962696075439453
local_output_nid generation:  0.009020566940307617
local_in_edges_tensor generation:  0.008904695510864258
mini_batch_src_global generation:  0.01948690414428711
r_  generation:  0.16201019287109375
local_output_nid generation:  0.008906126022338867
local_in_edges_tensor generation:  0.008130073547363281
mini_batch_src_global generation:  0.018788814544677734
r_  generation:  0.15763592720031738
local_output_nid generation:  0.00907278060913086
local_in_edges_tensor generation:  0.008874654769897461
mini_batch_src_global generation:  0.018929719924926758
r_  generation:  0.15729904174804688
local_output_nid generation:  0.009378671646118164
local_in_edges_tensor generation:  0.009023189544677734
mini_batch_src_global generation:  0.019436359405517578
r_  generation:  0.16191411018371582
local_output_nid generation:  0.009111404418945312
local_in_edges_tensor generation:  0.008700132369995117
mini_batch_src_global generation:  0.02048349380493164
r_  generation:  0.15603399276733398
local_output_nid generation:  0.011078834533691406
local_in_edges_tensor generation:  0.010156869888305664
mini_batch_src_global generation:  0.01862812042236328
r_  generation:  0.19372272491455078
local_output_nid generation:  0.00920248031616211
local_in_edges_tensor generation:  0.010978937149047852
mini_batch_src_global generation:  0.01988530158996582
r_  generation:  0.1960439682006836
local_output_nid generation:  0.015096902847290039
local_in_edges_tensor generation:  0.012857198715209961
mini_batch_src_global generation:  0.025756120681762695
r_  generation:  0.159698486328125
local_output_nid generation:  0.011254549026489258
local_in_edges_tensor generation:  0.010241270065307617
mini_batch_src_global generation:  0.020874500274658203
r_  generation:  0.16614413261413574
local_output_nid generation:  0.009979724884033203
local_in_edges_tensor generation:  0.011181116104125977
mini_batch_src_global generation:  0.021790266036987305
r_  generation:  0.21088075637817383
local_output_nid generation:  0.009800195693969727
local_in_edges_tensor generation:  0.013273954391479492
mini_batch_src_global generation:  0.020853281021118164
r_  generation:  0.16057372093200684
local_output_nid generation:  0.009427785873413086
local_in_edges_tensor generation:  0.009603500366210938
mini_batch_src_global generation:  0.01926422119140625
r_  generation:  0.15951895713806152
local_output_nid generation:  0.009029865264892578
local_in_edges_tensor generation:  0.008802652359008789
mini_batch_src_global generation:  0.019003629684448242
r_  generation:  0.15407395362854004
local_output_nid generation:  0.009027481079101562
local_in_edges_tensor generation:  0.010886907577514648
mini_batch_src_global generation:  0.019166231155395508
r_  generation:  0.1528611183166504
local_output_nid generation:  0.008879899978637695
local_in_edges_tensor generation:  0.008770227432250977
mini_batch_src_global generation:  0.0182802677154541
r_  generation:  0.15265798568725586
----------------------check_connections_block total spend ----------------------------- 7.809681415557861
generate_one_block  0.213578462600708
generate_one_block  0.19596123695373535
generate_one_block  0.19892001152038574
generate_one_block  0.20740628242492676
generate_one_block  0.22548270225524902
generate_one_block  0.20991158485412598
generate_one_block  0.21023893356323242
generate_one_block  0.20587682723999023
generate_one_block  0.20705938339233398
generate_one_block  0.20507478713989258
generate_one_block  0.19948482513427734
generate_one_block  0.1989748477935791
generate_one_block  0.20376372337341309
generate_one_block  0.20115232467651367
generate_one_block  0.19637155532836914
generate_one_block  0.2032780647277832
generate_one_block  0.21219277381896973
generate_one_block  0.22351717948913574
generate_one_block  0.20346999168395996
generate_one_block  0.20950961112976074
generate_one_block  0.2140052318572998
generate_one_block  0.20533204078674316
generate_one_block  0.20397233963012695
generate_one_block  0.21174335479736328
generate_one_block  0.19971370697021484
generate_one_block  0.21052932739257812
generate_one_block  0.20881342887878418
generate_one_block  0.21347332000732422
generate_one_block  0.20954346656799316
generate_one_block  0.2039656639099121
generate_one_block  0.19919824600219727
generate_one_block  0.19788360595703125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04297208786010742
gen group dst list time:  0.11186814308166504
time for parepare:  0.02068948745727539
local_output_nid generation:  0.024260997772216797
local_in_edges_tensor generation:  0.04970979690551758
mini_batch_src_global generation:  0.0376734733581543
r_  generation:  0.409820556640625
local_output_nid generation:  0.030000686645507812
local_in_edges_tensor generation:  0.032286643981933594
mini_batch_src_global generation:  0.04872846603393555
r_  generation:  0.4033489227294922
local_output_nid generation:  0.029860973358154297
local_in_edges_tensor generation:  0.026682615280151367
mini_batch_src_global generation:  0.04662823677062988
r_  generation:  0.4101552963256836
local_output_nid generation:  0.029972553253173828
local_in_edges_tensor generation:  0.027036428451538086
mini_batch_src_global generation:  0.04938197135925293
r_  generation:  0.4081120491027832
local_output_nid generation:  0.029758214950561523
local_in_edges_tensor generation:  0.027074813842773438
mini_batch_src_global generation:  0.04719972610473633
r_  generation:  0.41593241691589355
local_output_nid generation:  0.02976369857788086
local_in_edges_tensor generation:  0.025302886962890625
mini_batch_src_global generation:  0.05007314682006836
r_  generation:  0.41132044792175293
local_output_nid generation:  0.028480052947998047
local_in_edges_tensor generation:  0.02548527717590332
mini_batch_src_global generation:  0.04756021499633789
r_  generation:  0.4326598644256592
local_output_nid generation:  0.02853250503540039
local_in_edges_tensor generation:  0.028687477111816406
mini_batch_src_global generation:  0.05020928382873535
r_  generation:  0.41287922859191895
local_output_nid generation:  0.028840303421020508
local_in_edges_tensor generation:  0.025190353393554688
mini_batch_src_global generation:  0.048294782638549805
r_  generation:  0.41881775856018066
local_output_nid generation:  0.028365373611450195
local_in_edges_tensor generation:  0.027228832244873047
mini_batch_src_global generation:  0.04979872703552246
r_  generation:  0.411468505859375
local_output_nid generation:  0.028737783432006836
local_in_edges_tensor generation:  0.02975749969482422
mini_batch_src_global generation:  0.050713300704956055
r_  generation:  0.415539026260376
local_output_nid generation:  0.02833867073059082
local_in_edges_tensor generation:  0.027505159378051758
mini_batch_src_global generation:  0.050917863845825195
r_  generation:  0.41065239906311035
local_output_nid generation:  0.029458045959472656
local_in_edges_tensor generation:  0.02534937858581543
mini_batch_src_global generation:  0.04742312431335449
r_  generation:  0.42058467864990234
local_output_nid generation:  0.02866840362548828
local_in_edges_tensor generation:  0.027110576629638672
mini_batch_src_global generation:  0.05182290077209473
r_  generation:  0.4109792709350586
local_output_nid generation:  0.028961896896362305
local_in_edges_tensor generation:  0.029996871948242188
mini_batch_src_global generation:  0.047066450119018555
r_  generation:  0.41588783264160156
local_output_nid generation:  0.02894139289855957
local_in_edges_tensor generation:  0.027596712112426758
mini_batch_src_global generation:  0.05138516426086426
r_  generation:  0.42629528045654297
local_output_nid generation:  0.02868938446044922
local_in_edges_tensor generation:  0.028073787689208984
mini_batch_src_global generation:  0.047736167907714844
r_  generation:  0.42186927795410156
local_output_nid generation:  0.028567790985107422
local_in_edges_tensor generation:  0.026740074157714844
mini_batch_src_global generation:  0.05135798454284668
r_  generation:  0.4136207103729248
local_output_nid generation:  0.028835773468017578
local_in_edges_tensor generation:  0.02755260467529297
mini_batch_src_global generation:  0.04783916473388672
r_  generation:  0.429518461227417
local_output_nid generation:  0.0292208194732666
local_in_edges_tensor generation:  0.026789426803588867
mini_batch_src_global generation:  0.04988431930541992
r_  generation:  0.41326451301574707
local_output_nid generation:  0.029859542846679688
local_in_edges_tensor generation:  0.027972698211669922
mini_batch_src_global generation:  0.04796862602233887
r_  generation:  0.42188382148742676
local_output_nid generation:  0.028491735458374023
local_in_edges_tensor generation:  0.02895188331604004
mini_batch_src_global generation:  0.04932045936584473
r_  generation:  0.4115774631500244
local_output_nid generation:  0.02823805809020996
local_in_edges_tensor generation:  0.027316570281982422
mini_batch_src_global generation:  0.047318220138549805
r_  generation:  0.41394710540771484
local_output_nid generation:  0.028660058975219727
local_in_edges_tensor generation:  0.025455474853515625
mini_batch_src_global generation:  0.050089120864868164
r_  generation:  0.41274166107177734
local_output_nid generation:  0.028148174285888672
local_in_edges_tensor generation:  0.025500059127807617
mini_batch_src_global generation:  0.04686117172241211
r_  generation:  0.4163229465484619
local_output_nid generation:  0.028746604919433594
local_in_edges_tensor generation:  0.026649951934814453
mini_batch_src_global generation:  0.05130720138549805
r_  generation:  0.4135110378265381
local_output_nid generation:  0.028656005859375
local_in_edges_tensor generation:  0.029065370559692383
mini_batch_src_global generation:  0.047430992126464844
r_  generation:  0.419353723526001
local_output_nid generation:  0.028630733489990234
local_in_edges_tensor generation:  0.027180910110473633
mini_batch_src_global generation:  0.0502316951751709
r_  generation:  0.41321897506713867
local_output_nid generation:  0.02874445915222168
local_in_edges_tensor generation:  0.027727127075195312
mini_batch_src_global generation:  0.04788637161254883
r_  generation:  0.43436098098754883
local_output_nid generation:  0.02870488166809082
local_in_edges_tensor generation:  0.025557279586791992
mini_batch_src_global generation:  0.04919552803039551
r_  generation:  0.4108104705810547
local_output_nid generation:  0.028200626373291016
local_in_edges_tensor generation:  0.025034189224243164
mini_batch_src_global generation:  0.046567678451538086
r_  generation:  0.4135141372680664
local_output_nid generation:  0.030278921127319336
local_in_edges_tensor generation:  0.02680206298828125
mini_batch_src_global generation:  0.0486905574798584
r_  generation:  0.4053518772125244
----------------------check_connections_block total spend ----------------------------- 19.666505336761475
generate_one_block  0.5650796890258789
generate_one_block  0.5526418685913086
generate_one_block  0.5454368591308594
generate_one_block  0.5588018894195557
generate_one_block  0.6537675857543945
generate_one_block  0.5555062294006348
generate_one_block  0.5550293922424316
generate_one_block  0.5588521957397461
generate_one_block  0.5541656017303467
generate_one_block  0.5538651943206787
generate_one_block  0.5473253726959229
generate_one_block  0.5518267154693604
generate_one_block  0.5577502250671387
generate_one_block  0.5527911186218262
generate_one_block  0.5510601997375488
generate_one_block  0.5620248317718506
generate_one_block  0.557415246963501
generate_one_block  0.5569536685943604
generate_one_block  0.5520801544189453
generate_one_block  0.5503764152526855
generate_one_block  0.558722734451294
generate_one_block  0.5576522350311279
generate_one_block  0.5483720302581787
generate_one_block  0.5635344982147217
generate_one_block  0.5693011283874512
generate_one_block  0.5653810501098633
generate_one_block  0.5578341484069824
generate_one_block  0.5575253963470459
generate_one_block  0.5542232990264893
generate_one_block  0.5457086563110352
generate_one_block  0.5471363067626953
generate_one_block  0.5423808097839355
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12239789962768555  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

connection checking time:  27.476186752319336
block generation total time  24.469921588897705
average batch blocks generation time:  0.7646850496530533
block dataloader generation time/epoch 54.32306492328644
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522317886352539  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.911636352539062  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10463237762451172  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.639477252960205  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521936416625977  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.74724531173706  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10461759567260742  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.18230152130127  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526895523071289  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.01999282836914  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10478019714355469  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.954610347747803  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10531759262084961  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.221469402313232  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10480928421020508  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.15923547744751  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529088973999023  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.163926601409912  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10455131530761719  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.997102737426758  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521841049194336  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.74444341659546  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1045985221862793  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.897377967834473  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526323318481445  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.031015872955322  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10487842559814453  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.83005666732788  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10515928268432617  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.504897594451904  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10507440567016602  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.983622550964355  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526895523071289  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.035956382751465  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10472631454467773  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.091333866119385  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522317886352539  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.929410934448242  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10453367233276367  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.928696632385254  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10532379150390625  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.28972625732422  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10452556610107422  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.842693328857422  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520696640014648  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.66413688659668  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10469579696655273  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.142457008361816  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519027709960938  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.610610485076904  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10496044158935547  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.13261079788208  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527372360229492  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.11584711074829  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10469198226928711  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.17741346359253  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527229309082031  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.10678243637085  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1042928695678711  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.738642692565918  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519218444824219  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.586782455444336  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1044468879699707  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.512503147125244  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03328399360179901 |0.01616618037223816 |0.4184844270348549 |9.550899267196655e-05 |0.7537971138954163 |0.008817195892333984 |
----------------------------------------------------------pseudo_mini_loss sum 1.6528630256652832
Total (block generation + training)time/epoch 93.43499541282654
Training time/epoch 39.158026933670044
Training time without block to device /epoch 38.64070916175842
Training time without total dataloading part /epoch 37.524882793426514
load block tensor time/epoch 1.0650877952575684
block to device time/epoch 0.5173177719116211
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  8794767
Number of first layer input nodes during this epoch:  4679730
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12269783020019531  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02606487274169922
range selection method range initialization spend 0.016571044921875
time for parepare:  0.019034147262573242
local_output_nid generation:  0.0009450912475585938
local_in_edges_tensor generation:  0.004286527633666992
mini_batch_src_global generation:  0.0030989646911621094
r_  generation:  0.017543554306030273
local_output_nid generation:  0.0013129711151123047
local_in_edges_tensor generation:  0.0007915496826171875
mini_batch_src_global generation:  0.0022678375244140625
r_  generation:  0.011726140975952148
local_output_nid generation:  0.0012471675872802734
local_in_edges_tensor generation:  0.0006868839263916016
mini_batch_src_global generation:  0.0014615058898925781
r_  generation:  0.010395288467407227
local_output_nid generation:  0.001142740249633789
local_in_edges_tensor generation:  0.0006883144378662109
mini_batch_src_global generation:  0.0014836788177490234
r_  generation:  0.010470151901245117
local_output_nid generation:  0.0011167526245117188
local_in_edges_tensor generation:  0.0006558895111083984
mini_batch_src_global generation:  0.0013501644134521484
r_  generation:  0.009893178939819336
local_output_nid generation:  0.001115560531616211
local_in_edges_tensor generation:  0.0006842613220214844
mini_batch_src_global generation:  0.0013725757598876953
r_  generation:  0.010355949401855469
local_output_nid generation:  0.0011415481567382812
local_in_edges_tensor generation:  0.0006616115570068359
mini_batch_src_global generation:  0.0013270378112792969
r_  generation:  0.010256290435791016
local_output_nid generation:  0.0011744499206542969
local_in_edges_tensor generation:  0.0006821155548095703
mini_batch_src_global generation:  0.0014622211456298828
r_  generation:  0.010355234146118164
local_output_nid generation:  0.0011157989501953125
local_in_edges_tensor generation:  0.0006721019744873047
mini_batch_src_global generation:  0.0012998580932617188
r_  generation:  0.010123491287231445
local_output_nid generation:  0.0011429786682128906
local_in_edges_tensor generation:  0.0006515979766845703
mini_batch_src_global generation:  0.001453399658203125
r_  generation:  0.010498046875
local_output_nid generation:  0.002270221710205078
local_in_edges_tensor generation:  0.0013213157653808594
mini_batch_src_global generation:  0.003506898880004883
r_  generation:  0.015671491622924805
local_output_nid generation:  0.0010731220245361328
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.001384735107421875
r_  generation:  0.010098695755004883
local_output_nid generation:  0.0009694099426269531
local_in_edges_tensor generation:  0.0005452632904052734
mini_batch_src_global generation:  0.0012433528900146484
r_  generation:  0.010284662246704102
local_output_nid generation:  0.0009181499481201172
local_in_edges_tensor generation:  0.0005843639373779297
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.010277032852172852
local_output_nid generation:  0.0008985996246337891
local_in_edges_tensor generation:  0.0006060600280761719
mini_batch_src_global generation:  0.0011322498321533203
r_  generation:  0.010157585144042969
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0005543231964111328
mini_batch_src_global generation:  0.0013556480407714844
r_  generation:  0.01004934310913086
local_output_nid generation:  0.000865936279296875
local_in_edges_tensor generation:  0.0005478858947753906
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.010169029235839844
local_output_nid generation:  0.0008552074432373047
local_in_edges_tensor generation:  0.0005886554718017578
mini_batch_src_global generation:  0.0011241436004638672
r_  generation:  0.009898900985717773
local_output_nid generation:  0.0008487701416015625
local_in_edges_tensor generation:  0.0005567073822021484
mini_batch_src_global generation:  0.0010983943939208984
r_  generation:  0.010082721710205078
local_output_nid generation:  0.0008485317230224609
local_in_edges_tensor generation:  0.0005466938018798828
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.010425567626953125
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.0005624294281005859
mini_batch_src_global generation:  0.0014178752899169922
r_  generation:  0.010421276092529297
local_output_nid generation:  0.0008590221405029297
local_in_edges_tensor generation:  0.0005450248718261719
mini_batch_src_global generation:  0.0011446475982666016
r_  generation:  0.009842872619628906
local_output_nid generation:  0.0008604526519775391
local_in_edges_tensor generation:  0.0005466938018798828
mini_batch_src_global generation:  0.0013623237609863281
r_  generation:  0.010071754455566406
local_output_nid generation:  0.0008525848388671875
local_in_edges_tensor generation:  0.0005898475646972656
mini_batch_src_global generation:  0.0011668205261230469
r_  generation:  0.010513782501220703
local_output_nid generation:  0.0008542537689208984
local_in_edges_tensor generation:  0.0005373954772949219
mini_batch_src_global generation:  0.001093149185180664
r_  generation:  0.009787797927856445
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0012407302856445312
r_  generation:  0.010657072067260742
local_output_nid generation:  0.0008447170257568359
local_in_edges_tensor generation:  0.0005481243133544922
mini_batch_src_global generation:  0.0011775493621826172
r_  generation:  0.010104894638061523
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.0005490779876708984
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.010317564010620117
local_output_nid generation:  0.0008413791656494141
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.0011246204376220703
r_  generation:  0.010073661804199219
local_output_nid generation:  0.0008389949798583984
local_in_edges_tensor generation:  0.0005459785461425781
mini_batch_src_global generation:  0.0011029243469238281
r_  generation:  0.010010719299316406
local_output_nid generation:  0.0008530616760253906
local_in_edges_tensor generation:  0.0005331039428710938
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.010542869567871094
local_output_nid generation:  0.0008311271667480469
local_in_edges_tensor generation:  0.0005383491516113281
mini_batch_src_global generation:  0.0011670589447021484
r_  generation:  0.01003718376159668
----------------------check_connections_block total spend ----------------------------- 0.547292947769165
generate_one_block  0.023839235305786133
generate_one_block  0.019870519638061523
generate_one_block  0.022002220153808594
generate_one_block  0.018006563186645508
generate_one_block  0.01704239845275879
generate_one_block  0.017334461212158203
generate_one_block  0.017047405242919922
generate_one_block  0.01739335060119629
generate_one_block  0.022574901580810547
generate_one_block  0.017696142196655273
generate_one_block  0.017478227615356445
generate_one_block  0.01713252067565918
generate_one_block  0.017801284790039062
generate_one_block  0.020430803298950195
generate_one_block  0.018051862716674805
generate_one_block  0.01700305938720703
generate_one_block  0.017737627029418945
generate_one_block  0.016922950744628906
generate_one_block  0.017138004302978516
generate_one_block  0.019614219665527344
generate_one_block  0.017925739288330078
generate_one_block  0.01688981056213379
generate_one_block  0.019567489624023438
generate_one_block  0.018332242965698242
generate_one_block  0.016772747039794922
generate_one_block  0.020339488983154297
generate_one_block  0.016960620880126953
generate_one_block  0.017499923706054688
generate_one_block  0.017284393310546875
generate_one_block  0.017043352127075195
generate_one_block  0.01747584342956543
generate_one_block  0.019504785537719727
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06072545051574707
gen group dst list time:  0.025823116302490234
time for parepare:  0.02669811248779297
local_output_nid generation:  0.005774974822998047
local_in_edges_tensor generation:  0.016370534896850586
mini_batch_src_global generation:  0.01735234260559082
r_  generation:  0.1441195011138916
local_output_nid generation:  0.007709503173828125
local_in_edges_tensor generation:  0.009720087051391602
mini_batch_src_global generation:  0.029336929321289062
r_  generation:  0.17811822891235352
local_output_nid generation:  0.011116266250610352
local_in_edges_tensor generation:  0.03877687454223633
mini_batch_src_global generation:  0.02161121368408203
r_  generation:  0.18993711471557617
local_output_nid generation:  0.008045673370361328
local_in_edges_tensor generation:  0.007963895797729492
mini_batch_src_global generation:  0.04975700378417969
r_  generation:  0.16042518615722656
local_output_nid generation:  0.013192176818847656
local_in_edges_tensor generation:  0.013841390609741211
mini_batch_src_global generation:  0.03502202033996582
r_  generation:  0.14898228645324707
local_output_nid generation:  0.008972406387329102
local_in_edges_tensor generation:  0.008066892623901367
mini_batch_src_global generation:  0.03168129920959473
r_  generation:  0.16725373268127441
local_output_nid generation:  0.01172327995300293
local_in_edges_tensor generation:  0.009443283081054688
mini_batch_src_global generation:  0.024622201919555664
r_  generation:  0.14959073066711426
local_output_nid generation:  0.008517742156982422
local_in_edges_tensor generation:  0.008848190307617188
mini_batch_src_global generation:  0.021068334579467773
r_  generation:  0.15248751640319824
local_output_nid generation:  0.008295059204101562
local_in_edges_tensor generation:  0.00984811782836914
mini_batch_src_global generation:  0.030607938766479492
r_  generation:  0.17706608772277832
local_output_nid generation:  0.01000666618347168
local_in_edges_tensor generation:  0.008305788040161133
mini_batch_src_global generation:  0.01947808265686035
r_  generation:  0.1567692756652832
local_output_nid generation:  0.008954524993896484
local_in_edges_tensor generation:  0.008140802383422852
mini_batch_src_global generation:  0.018865346908569336
r_  generation:  0.15938115119934082
local_output_nid generation:  0.008642911911010742
local_in_edges_tensor generation:  0.007861137390136719
mini_batch_src_global generation:  0.021474599838256836
r_  generation:  0.1491549015045166
local_output_nid generation:  0.009000062942504883
local_in_edges_tensor generation:  0.008173704147338867
mini_batch_src_global generation:  0.020322322845458984
r_  generation:  0.158250093460083
local_output_nid generation:  0.008887767791748047
local_in_edges_tensor generation:  0.011115074157714844
mini_batch_src_global generation:  0.019399404525756836
r_  generation:  0.15644478797912598
local_output_nid generation:  0.008772611618041992
local_in_edges_tensor generation:  0.007914543151855469
mini_batch_src_global generation:  0.018877267837524414
r_  generation:  0.15621018409729004
local_output_nid generation:  0.008668661117553711
local_in_edges_tensor generation:  0.009056806564331055
mini_batch_src_global generation:  0.019308805465698242
r_  generation:  0.15334010124206543
local_output_nid generation:  0.008950471878051758
local_in_edges_tensor generation:  0.010869979858398438
mini_batch_src_global generation:  0.03081989288330078
r_  generation:  0.16175127029418945
local_output_nid generation:  0.008770227432250977
local_in_edges_tensor generation:  0.008699178695678711
mini_batch_src_global generation:  0.022061586380004883
r_  generation:  0.15285921096801758
local_output_nid generation:  0.008819580078125
local_in_edges_tensor generation:  0.008822202682495117
mini_batch_src_global generation:  0.0211334228515625
r_  generation:  0.15716958045959473
local_output_nid generation:  0.011605501174926758
local_in_edges_tensor generation:  0.010981082916259766
mini_batch_src_global generation:  0.019370079040527344
r_  generation:  0.16060137748718262
local_output_nid generation:  0.009250640869140625
local_in_edges_tensor generation:  0.008838653564453125
mini_batch_src_global generation:  0.030694961547851562
r_  generation:  0.16330933570861816
local_output_nid generation:  0.00879812240600586
local_in_edges_tensor generation:  0.013315916061401367
mini_batch_src_global generation:  0.02116990089416504
r_  generation:  0.15143942832946777
local_output_nid generation:  0.008916854858398438
local_in_edges_tensor generation:  0.01016998291015625
mini_batch_src_global generation:  0.01982855796813965
r_  generation:  0.15817856788635254
local_output_nid generation:  0.013336658477783203
local_in_edges_tensor generation:  0.008857250213623047
mini_batch_src_global generation:  0.027669906616210938
r_  generation:  0.1584489345550537
local_output_nid generation:  0.008766412734985352
local_in_edges_tensor generation:  0.008899211883544922
mini_batch_src_global generation:  0.01797199249267578
r_  generation:  0.1463758945465088
local_output_nid generation:  0.009718894958496094
local_in_edges_tensor generation:  0.008814334869384766
mini_batch_src_global generation:  0.01947808265686035
r_  generation:  0.16057825088500977
local_output_nid generation:  0.008838176727294922
local_in_edges_tensor generation:  0.008828878402709961
mini_batch_src_global generation:  0.018598556518554688
r_  generation:  0.2021336555480957
local_output_nid generation:  0.009162664413452148
local_in_edges_tensor generation:  0.008479118347167969
mini_batch_src_global generation:  0.020251035690307617
r_  generation:  0.15606093406677246
local_output_nid generation:  0.009282112121582031
local_in_edges_tensor generation:  0.010846138000488281
mini_batch_src_global generation:  0.018794536590576172
r_  generation:  0.1559288501739502
local_output_nid generation:  0.009011268615722656
local_in_edges_tensor generation:  0.008060693740844727
mini_batch_src_global generation:  0.019075632095336914
r_  generation:  0.1541595458984375
local_output_nid generation:  0.009154796600341797
local_in_edges_tensor generation:  0.008353948593139648
mini_batch_src_global generation:  0.019436120986938477
r_  generation:  0.1556406021118164
local_output_nid generation:  0.009068965911865234
local_in_edges_tensor generation:  0.008405208587646484
mini_batch_src_global generation:  0.018804311752319336
r_  generation:  0.15113329887390137
----------------------check_connections_block total spend ----------------------------- 7.7192909717559814
generate_one_block  0.2178971767425537
generate_one_block  0.2032794952392578
generate_one_block  0.20884490013122559
generate_one_block  0.20225167274475098
generate_one_block  0.20975637435913086
generate_one_block  0.20141148567199707
generate_one_block  0.1944901943206787
generate_one_block  0.20461463928222656
generate_one_block  0.20038414001464844
generate_one_block  0.2020740509033203
generate_one_block  0.2081444263458252
generate_one_block  0.21696877479553223
generate_one_block  0.20998454093933105
generate_one_block  0.2116711139678955
generate_one_block  0.20460224151611328
generate_one_block  0.19969725608825684
generate_one_block  0.21408486366271973
generate_one_block  0.2032909393310547
generate_one_block  0.208204984664917
generate_one_block  0.21504521369934082
generate_one_block  0.21145939826965332
generate_one_block  0.19491910934448242
generate_one_block  0.19967341423034668
generate_one_block  0.20964980125427246
generate_one_block  0.1925978660583496
generate_one_block  0.21390604972839355
generate_one_block  0.19637656211853027
generate_one_block  0.20685553550720215
generate_one_block  0.20433378219604492
generate_one_block  0.19942498207092285
generate_one_block  0.20392203330993652
generate_one_block  0.20318174362182617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03585410118103027
gen group dst list time:  0.10762667655944824
time for parepare:  0.01986861228942871
local_output_nid generation:  0.02392125129699707
local_in_edges_tensor generation:  0.0527348518371582
mini_batch_src_global generation:  0.03754377365112305
r_  generation:  0.40967512130737305
local_output_nid generation:  0.028229475021362305
local_in_edges_tensor generation:  0.03417658805847168
mini_batch_src_global generation:  0.0488588809967041
r_  generation:  0.4124338626861572
local_output_nid generation:  0.028737306594848633
local_in_edges_tensor generation:  0.02869105339050293
mini_batch_src_global generation:  0.048445701599121094
r_  generation:  0.41812658309936523
local_output_nid generation:  0.028759479522705078
local_in_edges_tensor generation:  0.035891056060791016
mini_batch_src_global generation:  0.05066275596618652
r_  generation:  0.4122130870819092
local_output_nid generation:  0.028820037841796875
local_in_edges_tensor generation:  0.02549266815185547
mini_batch_src_global generation:  0.05100440979003906
r_  generation:  0.41889119148254395
local_output_nid generation:  0.028682231903076172
local_in_edges_tensor generation:  0.02444314956665039
mini_batch_src_global generation:  0.050750732421875
r_  generation:  0.41051506996154785
local_output_nid generation:  0.028115034103393555
local_in_edges_tensor generation:  0.0300140380859375
mini_batch_src_global generation:  0.05728793144226074
r_  generation:  0.4228212833404541
local_output_nid generation:  0.02962660789489746
local_in_edges_tensor generation:  0.03003406524658203
mini_batch_src_global generation:  0.051210880279541016
r_  generation:  0.4145841598510742
local_output_nid generation:  0.028080224990844727
local_in_edges_tensor generation:  0.026612281799316406
mini_batch_src_global generation:  0.04751133918762207
r_  generation:  0.4148118495941162
local_output_nid generation:  0.028186798095703125
local_in_edges_tensor generation:  0.0274045467376709
mini_batch_src_global generation:  0.04962515830993652
r_  generation:  0.4075498580932617
local_output_nid generation:  0.028389692306518555
local_in_edges_tensor generation:  0.027460575103759766
mini_batch_src_global generation:  0.047286033630371094
r_  generation:  0.4226090908050537
local_output_nid generation:  0.028156757354736328
local_in_edges_tensor generation:  0.02587437629699707
mini_batch_src_global generation:  0.04922842979431152
r_  generation:  0.40480852127075195
local_output_nid generation:  0.028215408325195312
local_in_edges_tensor generation:  0.02561473846435547
mini_batch_src_global generation:  0.04842805862426758
r_  generation:  0.41561460494995117
local_output_nid generation:  0.02820563316345215
local_in_edges_tensor generation:  0.028353452682495117
mini_batch_src_global generation:  0.04935050010681152
r_  generation:  0.4152085781097412
local_output_nid generation:  0.028089523315429688
local_in_edges_tensor generation:  0.026146888732910156
mini_batch_src_global generation:  0.04763007164001465
r_  generation:  0.41546201705932617
local_output_nid generation:  0.030617475509643555
local_in_edges_tensor generation:  0.0251467227935791
mini_batch_src_global generation:  0.04874467849731445
r_  generation:  0.4208099842071533
local_output_nid generation:  0.028217554092407227
local_in_edges_tensor generation:  0.028418302536010742
mini_batch_src_global generation:  0.04653596878051758
r_  generation:  0.4250209331512451
local_output_nid generation:  0.028153657913208008
local_in_edges_tensor generation:  0.028934717178344727
mini_batch_src_global generation:  0.04869866371154785
r_  generation:  0.4110245704650879
local_output_nid generation:  0.02789020538330078
local_in_edges_tensor generation:  0.025598764419555664
mini_batch_src_global generation:  0.046805381774902344
r_  generation:  0.41533493995666504
local_output_nid generation:  0.028124332427978516
local_in_edges_tensor generation:  0.025294780731201172
mini_batch_src_global generation:  0.050913095474243164
r_  generation:  0.41846156120300293
local_output_nid generation:  0.02822089195251465
local_in_edges_tensor generation:  0.027310848236083984
mini_batch_src_global generation:  0.0472414493560791
r_  generation:  0.42045092582702637
local_output_nid generation:  0.028243541717529297
local_in_edges_tensor generation:  0.02726888656616211
mini_batch_src_global generation:  0.04853534698486328
r_  generation:  0.4074399471282959
local_output_nid generation:  0.02800273895263672
local_in_edges_tensor generation:  0.02714085578918457
mini_batch_src_global generation:  0.046662092208862305
r_  generation:  0.4197869300842285
local_output_nid generation:  0.028588533401489258
local_in_edges_tensor generation:  0.029344558715820312
mini_batch_src_global generation:  0.05125784873962402
r_  generation:  0.4135098457336426
local_output_nid generation:  0.027940988540649414
local_in_edges_tensor generation:  0.02781844139099121
mini_batch_src_global generation:  0.04879498481750488
r_  generation:  0.4140901565551758
local_output_nid generation:  0.028493881225585938
local_in_edges_tensor generation:  0.026387453079223633
mini_batch_src_global generation:  0.04932570457458496
r_  generation:  0.42148423194885254
local_output_nid generation:  0.028045654296875
local_in_edges_tensor generation:  0.027906417846679688
mini_batch_src_global generation:  0.047400712966918945
r_  generation:  0.4146428108215332
local_output_nid generation:  0.028038740158081055
local_in_edges_tensor generation:  0.02742314338684082
mini_batch_src_global generation:  0.049551963806152344
r_  generation:  0.4109203815460205
local_output_nid generation:  0.0281832218170166
local_in_edges_tensor generation:  0.02990269660949707
mini_batch_src_global generation:  0.04789376258850098
r_  generation:  0.42624807357788086
local_output_nid generation:  0.028449296951293945
local_in_edges_tensor generation:  0.025856494903564453
mini_batch_src_global generation:  0.051787376403808594
r_  generation:  0.41092824935913086
local_output_nid generation:  0.02818155288696289
local_in_edges_tensor generation:  0.02734518051147461
mini_batch_src_global generation:  0.04754781723022461
r_  generation:  0.4196045398712158
local_output_nid generation:  0.028105735778808594
local_in_edges_tensor generation:  0.02599048614501953
mini_batch_src_global generation:  0.049881696701049805
r_  generation:  0.41240668296813965
----------------------check_connections_block total spend ----------------------------- 19.645668983459473
generate_one_block  0.5760772228240967
generate_one_block  0.5533454418182373
generate_one_block  0.5572726726531982
generate_one_block  0.5555014610290527
generate_one_block  0.6506783962249756
generate_one_block  0.5491559505462646
generate_one_block  0.546576738357544
generate_one_block  0.5576691627502441
generate_one_block  0.5594322681427002
generate_one_block  0.5559606552124023
generate_one_block  0.572495698928833
generate_one_block  0.5449090003967285
generate_one_block  0.5487828254699707
generate_one_block  0.5574493408203125
generate_one_block  0.5488982200622559
generate_one_block  0.5464420318603516
generate_one_block  0.554419755935669
generate_one_block  0.5578529834747314
generate_one_block  0.5459485054016113
generate_one_block  0.5556762218475342
generate_one_block  0.5554769039154053
generate_one_block  0.5412213802337646
generate_one_block  0.5507142543792725
generate_one_block  0.56894850730896
generate_one_block  0.5593786239624023
generate_one_block  0.5723164081573486
generate_one_block  0.5460195541381836
generate_one_block  0.557293176651001
generate_one_block  0.5577137470245361
generate_one_block  0.5494575500488281
generate_one_block  0.55641770362854
generate_one_block  0.5460853576660156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12269783020019531  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

connection checking time:  27.364959955215454
block generation total time  24.42858648300171
average batch blocks generation time:  0.7633933275938034
block dataloader generation time/epoch 54.49946308135986
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052999496459961  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.180037021636963  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10486364364624023  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.029143810272217  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10532283782958984  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.251760005950928  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10479545593261719  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.901747226715088  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518598556518555  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.59449052810669  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10461854934692383  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.98665952682495  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10517740249633789  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.584434986114502  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10437583923339844  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.063441276550293  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523509979248047  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.846763610839844  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10451412200927734  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.067378520965576  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525655746459961  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.085978984832764  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10471725463867188  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.54537057876587  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052703857421875  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.047324180603027  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10471439361572266  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.135581016540527  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052250862121582  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.77815818786621  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1045989990234375  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.643234729766846  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526895523071289  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.030338764190674  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10463285446166992  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.895785808563232  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525369644165039  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.833953857421875  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10462474822998047  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.076565265655518  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527420043945312  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.997783660888672  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10466575622558594  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.503879070281982  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523176193237305  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.7878680229187  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10500764846801758  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.324517726898193  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1051335334777832  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.35953712463379  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10488128662109375  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.42651605606079  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518932342529297  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.57627248764038  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10476398468017578  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.068720817565918  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525655746459961  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.91407537460327  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10444498062133789  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.832429885864258  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525655746459961  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.99377202987671  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046762466430664  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.68128252029419  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031200334429740906 |0.016108520328998566 |0.41350121051073074 |9.404122829437256e-05 |0.7558546587824821 |0.007521867752075195 |
----------------------------------------------------------pseudo_mini_loss sum 1.600770115852356
Total (block generation + training)time/epoch 93.57212408383687
Training time/epoch 38.9938702583313
Training time without block to device /epoch 38.478397607803345
Training time without total dataloading part /epoch 37.42991900444031
load block tensor time/epoch 0.998410701751709
block to device time/epoch 0.5154726505279541
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  8788929
Number of first layer input nodes during this epoch:  4680562
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12202978134155273  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0302886962890625
range selection method range initialization spend 0.01630544662475586
time for parepare:  0.02080059051513672
local_output_nid generation:  0.0010600090026855469
local_in_edges_tensor generation:  0.0066890716552734375
mini_batch_src_global generation:  0.0016713142395019531
r_  generation:  0.010707855224609375
local_output_nid generation:  0.0009946823120117188
local_in_edges_tensor generation:  0.0006480216979980469
mini_batch_src_global generation:  0.0015430450439453125
r_  generation:  0.010370492935180664
local_output_nid generation:  0.0009398460388183594
local_in_edges_tensor generation:  0.0005979537963867188
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.009914875030517578
local_output_nid generation:  0.0009162425994873047
local_in_edges_tensor generation:  0.0005731582641601562
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.010043144226074219
local_output_nid generation:  0.0008842945098876953
local_in_edges_tensor generation:  0.0005548000335693359
mini_batch_src_global generation:  0.0010395050048828125
r_  generation:  0.009789228439331055
local_output_nid generation:  0.0008862018585205078
local_in_edges_tensor generation:  0.0005476474761962891
mini_batch_src_global generation:  0.0010063648223876953
r_  generation:  0.009648561477661133
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0005505084991455078
mini_batch_src_global generation:  0.001092672348022461
r_  generation:  0.01007986068725586
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.0005495548248291016
mini_batch_src_global generation:  0.001073598861694336
r_  generation:  0.010503053665161133
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0005829334259033203
mini_batch_src_global generation:  0.001127004623413086
r_  generation:  0.01009368896484375
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.0010805130004882812
r_  generation:  0.01013040542602539
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0005767345428466797
mini_batch_src_global generation:  0.0011229515075683594
r_  generation:  0.010103702545166016
local_output_nid generation:  0.0008544921875
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0010385513305664062
r_  generation:  0.010032415390014648
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.0005552768707275391
mini_batch_src_global generation:  0.0010752677917480469
r_  generation:  0.010318994522094727
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005388259887695312
mini_batch_src_global generation:  0.001085042953491211
r_  generation:  0.01002645492553711
local_output_nid generation:  0.0008604526519775391
local_in_edges_tensor generation:  0.0005452632904052734
mini_batch_src_global generation:  0.0011582374572753906
r_  generation:  0.010387659072875977
local_output_nid generation:  0.0008633136749267578
local_in_edges_tensor generation:  0.0005650520324707031
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.010652542114257812
local_output_nid generation:  0.0008571147918701172
local_in_edges_tensor generation:  0.0005402565002441406
mini_batch_src_global generation:  0.001089334487915039
r_  generation:  0.009988546371459961
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.00054168701171875
mini_batch_src_global generation:  0.0010294914245605469
r_  generation:  0.009721755981445312
local_output_nid generation:  0.0008752346038818359
local_in_edges_tensor generation:  0.0005478858947753906
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.010351896286010742
local_output_nid generation:  0.0008544921875
local_in_edges_tensor generation:  0.0005354881286621094
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.009913921356201172
local_output_nid generation:  0.0008578300476074219
local_in_edges_tensor generation:  0.0005309581756591797
mini_batch_src_global generation:  0.0010917186737060547
r_  generation:  0.009578227996826172
local_output_nid generation:  0.0008637905120849609
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0011017322540283203
r_  generation:  0.010387420654296875
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0005462169647216797
mini_batch_src_global generation:  0.0010640621185302734
r_  generation:  0.00977945327758789
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.0005457401275634766
mini_batch_src_global generation:  0.0010890960693359375
r_  generation:  0.010410308837890625
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.0005488395690917969
mini_batch_src_global generation:  0.0010983943939208984
r_  generation:  0.010223150253295898
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0005464553833007812
mini_batch_src_global generation:  0.0010859966278076172
r_  generation:  0.010343551635742188
local_output_nid generation:  0.0008568763732910156
local_in_edges_tensor generation:  0.000545501708984375
mini_batch_src_global generation:  0.001073598861694336
r_  generation:  0.009972810745239258
local_output_nid generation:  0.0008485317230224609
local_in_edges_tensor generation:  0.0005497932434082031
mini_batch_src_global generation:  0.00103759765625
r_  generation:  0.009725093841552734
local_output_nid generation:  0.0008563995361328125
local_in_edges_tensor generation:  0.0005409717559814453
mini_batch_src_global generation:  0.0010685920715332031
r_  generation:  0.010509729385375977
local_output_nid generation:  0.0008444786071777344
local_in_edges_tensor generation:  0.0005495548248291016
mini_batch_src_global generation:  0.001178741455078125
r_  generation:  0.010306119918823242
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0005502700805664062
mini_batch_src_global generation:  0.0011224746704101562
r_  generation:  0.010344266891479492
local_output_nid generation:  0.0008571147918701172
local_in_edges_tensor generation:  0.0005309581756591797
mini_batch_src_global generation:  0.0012443065643310547
r_  generation:  0.009526252746582031
----------------------check_connections_block total spend ----------------------------- 0.5106232166290283
generate_one_block  0.022847414016723633
generate_one_block  0.01954340934753418
generate_one_block  0.017734766006469727
generate_one_block  0.0176239013671875
generate_one_block  0.017141342163085938
generate_one_block  0.016655445098876953
generate_one_block  0.01731562614440918
generate_one_block  0.017431020736694336
generate_one_block  0.017107486724853516
generate_one_block  0.017297983169555664
generate_one_block  0.01715373992919922
generate_one_block  0.017277956008911133
generate_one_block  0.01755356788635254
generate_one_block  0.01709723472595215
generate_one_block  0.017478227615356445
generate_one_block  0.018055438995361328
generate_one_block  0.016791820526123047
generate_one_block  0.01640033721923828
generate_one_block  0.01751852035522461
generate_one_block  0.01673436164855957
generate_one_block  0.016202688217163086
generate_one_block  0.017777681350708008
generate_one_block  0.018756628036499023
generate_one_block  0.01786494255065918
generate_one_block  0.017292499542236328
generate_one_block  0.017522573471069336
generate_one_block  0.016731739044189453
generate_one_block  0.01666259765625
generate_one_block  0.017725467681884766
generate_one_block  0.017193078994750977
generate_one_block  0.017230510711669922
generate_one_block  0.016081571578979492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036933183670043945
gen group dst list time:  0.022486209869384766
time for parepare:  0.021656274795532227
local_output_nid generation:  0.005145549774169922
local_in_edges_tensor generation:  0.01663827896118164
mini_batch_src_global generation:  0.014367818832397461
r_  generation:  0.1321887969970703
local_output_nid generation:  0.0073397159576416016
local_in_edges_tensor generation:  0.009560108184814453
mini_batch_src_global generation:  0.016750574111938477
r_  generation:  0.1721956729888916
local_output_nid generation:  0.01225137710571289
local_in_edges_tensor generation:  0.04426121711730957
mini_batch_src_global generation:  0.022481679916381836
r_  generation:  0.14972925186157227
local_output_nid generation:  0.009666919708251953
local_in_edges_tensor generation:  0.012022018432617188
mini_batch_src_global generation:  0.02013087272644043
r_  generation:  0.1553659439086914
local_output_nid generation:  0.008976459503173828
local_in_edges_tensor generation:  0.008803844451904297
mini_batch_src_global generation:  0.021009206771850586
r_  generation:  0.15526819229125977
local_output_nid generation:  0.008610010147094727
local_in_edges_tensor generation:  0.009829282760620117
mini_batch_src_global generation:  0.020168542861938477
r_  generation:  0.15130257606506348
local_output_nid generation:  0.008643150329589844
local_in_edges_tensor generation:  0.011492490768432617
mini_batch_src_global generation:  0.018748760223388672
r_  generation:  0.21183562278747559
local_output_nid generation:  0.008341073989868164
local_in_edges_tensor generation:  0.015565872192382812
mini_batch_src_global generation:  0.01939988136291504
r_  generation:  0.16132426261901855
local_output_nid generation:  0.008199214935302734
local_in_edges_tensor generation:  0.010034322738647461
mini_batch_src_global generation:  0.01983356475830078
r_  generation:  0.15666961669921875
local_output_nid generation:  0.008574724197387695
local_in_edges_tensor generation:  0.009274005889892578
mini_batch_src_global generation:  0.03116774559020996
r_  generation:  0.1609330177307129
local_output_nid generation:  0.009352684020996094
local_in_edges_tensor generation:  0.008432626724243164
mini_batch_src_global generation:  0.019418716430664062
r_  generation:  0.15471768379211426
local_output_nid generation:  0.008721590042114258
local_in_edges_tensor generation:  0.00881814956665039
mini_batch_src_global generation:  0.018320083618164062
r_  generation:  0.1558237075805664
local_output_nid generation:  0.00880742073059082
local_in_edges_tensor generation:  0.00946497917175293
mini_batch_src_global generation:  0.01918935775756836
r_  generation:  0.15691709518432617
local_output_nid generation:  0.008783340454101562
local_in_edges_tensor generation:  0.008307456970214844
mini_batch_src_global generation:  0.018622398376464844
r_  generation:  0.15689945220947266
local_output_nid generation:  0.00876474380493164
local_in_edges_tensor generation:  0.00880885124206543
mini_batch_src_global generation:  0.02032780647277832
r_  generation:  0.2091200351715088
local_output_nid generation:  0.00904703140258789
local_in_edges_tensor generation:  0.008968114852905273
mini_batch_src_global generation:  0.02016162872314453
r_  generation:  0.16395783424377441
local_output_nid generation:  0.008527755737304688
local_in_edges_tensor generation:  0.010471582412719727
mini_batch_src_global generation:  0.019586801528930664
r_  generation:  0.15056967735290527
local_output_nid generation:  0.008531332015991211
local_in_edges_tensor generation:  0.009079933166503906
mini_batch_src_global generation:  0.018151283264160156
r_  generation:  0.15012383460998535
local_output_nid generation:  0.009068012237548828
local_in_edges_tensor generation:  0.008256912231445312
mini_batch_src_global generation:  0.0192108154296875
r_  generation:  0.16728949546813965
local_output_nid generation:  0.010352134704589844
local_in_edges_tensor generation:  0.008063554763793945
mini_batch_src_global generation:  0.023247718811035156
r_  generation:  0.15448689460754395
local_output_nid generation:  0.00861811637878418
local_in_edges_tensor generation:  0.009812593460083008
mini_batch_src_global generation:  0.018045902252197266
r_  generation:  0.14569973945617676
local_output_nid generation:  0.009356260299682617
local_in_edges_tensor generation:  0.008383035659790039
mini_batch_src_global generation:  0.01898026466369629
r_  generation:  0.1602180004119873
local_output_nid generation:  0.008821487426757812
local_in_edges_tensor generation:  0.008017778396606445
mini_batch_src_global generation:  0.01885676383972168
r_  generation:  0.14981889724731445
local_output_nid generation:  0.009154081344604492
local_in_edges_tensor generation:  0.00841975212097168
mini_batch_src_global generation:  0.01919841766357422
r_  generation:  0.16039299964904785
local_output_nid generation:  0.009035587310791016
local_in_edges_tensor generation:  0.009986639022827148
mini_batch_src_global generation:  0.01923680305480957
r_  generation:  0.15429186820983887
local_output_nid generation:  0.009370565414428711
local_in_edges_tensor generation:  0.008936405181884766
mini_batch_src_global generation:  0.020058155059814453
r_  generation:  0.15867400169372559
local_output_nid generation:  0.008830070495605469
local_in_edges_tensor generation:  0.00797128677368164
mini_batch_src_global generation:  0.01895308494567871
r_  generation:  0.15171527862548828
local_output_nid generation:  0.008715391159057617
local_in_edges_tensor generation:  0.008033275604248047
mini_batch_src_global generation:  0.018419504165649414
r_  generation:  0.1529381275177002
local_output_nid generation:  0.009351253509521484
local_in_edges_tensor generation:  0.009410858154296875
mini_batch_src_global generation:  0.019402503967285156
r_  generation:  0.15996909141540527
local_output_nid generation:  0.00910329818725586
local_in_edges_tensor generation:  0.008844852447509766
mini_batch_src_global generation:  0.018925905227661133
r_  generation:  0.15854167938232422
local_output_nid generation:  0.009197473526000977
local_in_edges_tensor generation:  0.009032726287841797
mini_batch_src_global generation:  0.01934981346130371
r_  generation:  0.15755319595336914
local_output_nid generation:  0.00873708724975586
local_in_edges_tensor generation:  0.007832765579223633
mini_batch_src_global generation:  0.017764806747436523
r_  generation:  0.14809632301330566
----------------------check_connections_block total spend ----------------------------- 7.5212109088897705
generate_one_block  0.20099472999572754
generate_one_block  0.19775748252868652
generate_one_block  0.20341181755065918
generate_one_block  0.20668363571166992
generate_one_block  0.21359610557556152
generate_one_block  0.19111275672912598
generate_one_block  0.20586442947387695
generate_one_block  0.20672965049743652
generate_one_block  0.20320940017700195
generate_one_block  0.20406389236450195
generate_one_block  0.207200288772583
generate_one_block  0.2068636417388916
generate_one_block  0.20983099937438965
generate_one_block  0.20554804801940918
generate_one_block  0.20672607421875
generate_one_block  0.2151174545288086
generate_one_block  0.19966959953308105
generate_one_block  0.19858121871948242
generate_one_block  0.2064826488494873
generate_one_block  0.20606064796447754
generate_one_block  0.1923832893371582
generate_one_block  0.21213603019714355
generate_one_block  0.20066595077514648
generate_one_block  0.21138596534729004
generate_one_block  0.20651602745056152
generate_one_block  0.21140599250793457
generate_one_block  0.20115184783935547
generate_one_block  0.20262622833251953
generate_one_block  0.21630620956420898
generate_one_block  0.20527911186218262
generate_one_block  0.2097468376159668
generate_one_block  0.19656658172607422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033005475997924805
gen group dst list time:  0.11513328552246094
time for parepare:  0.020981788635253906
local_output_nid generation:  0.02563643455505371
local_in_edges_tensor generation:  0.04256463050842285
mini_batch_src_global generation:  0.036649465560913086
r_  generation:  0.4157226085662842
local_output_nid generation:  0.031487464904785156
local_in_edges_tensor generation:  0.03198814392089844
mini_batch_src_global generation:  0.04802250862121582
r_  generation:  0.40436625480651855
local_output_nid generation:  0.02960371971130371
local_in_edges_tensor generation:  0.027152538299560547
mini_batch_src_global generation:  0.046563148498535156
r_  generation:  0.41285014152526855
local_output_nid generation:  0.029584407806396484
local_in_edges_tensor generation:  0.02971053123474121
mini_batch_src_global generation:  0.04864025115966797
r_  generation:  0.40802669525146484
local_output_nid generation:  0.029609203338623047
local_in_edges_tensor generation:  0.024829387664794922
mini_batch_src_global generation:  0.04668593406677246
r_  generation:  0.42896127700805664
local_output_nid generation:  0.029464006423950195
local_in_edges_tensor generation:  0.025305986404418945
mini_batch_src_global generation:  0.048668622970581055
r_  generation:  0.4107365608215332
local_output_nid generation:  0.028245210647583008
local_in_edges_tensor generation:  0.029440879821777344
mini_batch_src_global generation:  0.04775547981262207
r_  generation:  0.4203610420227051
local_output_nid generation:  0.029059648513793945
local_in_edges_tensor generation:  0.03399229049682617
mini_batch_src_global generation:  0.04962348937988281
r_  generation:  0.41613221168518066
local_output_nid generation:  0.02830815315246582
local_in_edges_tensor generation:  0.02541661262512207
mini_batch_src_global generation:  0.047309160232543945
r_  generation:  0.41996002197265625
local_output_nid generation:  0.028432607650756836
local_in_edges_tensor generation:  0.030358314514160156
mini_batch_src_global generation:  0.05195212364196777
r_  generation:  0.41729259490966797
local_output_nid generation:  0.028270959854125977
local_in_edges_tensor generation:  0.027822494506835938
mini_batch_src_global generation:  0.047603607177734375
r_  generation:  0.44376635551452637
local_output_nid generation:  0.02990126609802246
local_in_edges_tensor generation:  0.03068852424621582
mini_batch_src_global generation:  0.051384687423706055
r_  generation:  0.41301512718200684
local_output_nid generation:  0.02874755859375
local_in_edges_tensor generation:  0.028104066848754883
mini_batch_src_global generation:  0.057797908782958984
r_  generation:  0.4133739471435547
local_output_nid generation:  0.028200387954711914
local_in_edges_tensor generation:  0.029216766357421875
mini_batch_src_global generation:  0.049627065658569336
r_  generation:  0.41025733947753906
local_output_nid generation:  0.028338193893432617
local_in_edges_tensor generation:  0.02535247802734375
mini_batch_src_global generation:  0.047455787658691406
r_  generation:  0.4252350330352783
local_output_nid generation:  0.0284576416015625
local_in_edges_tensor generation:  0.02919793128967285
mini_batch_src_global generation:  0.051110029220581055
r_  generation:  0.41387200355529785
local_output_nid generation:  0.028242111206054688
local_in_edges_tensor generation:  0.0277254581451416
mini_batch_src_global generation:  0.04700183868408203
r_  generation:  0.40944504737854004
local_output_nid generation:  0.02798175811767578
local_in_edges_tensor generation:  0.025583982467651367
mini_batch_src_global generation:  0.0490880012512207
r_  generation:  0.40609073638916016
local_output_nid generation:  0.028432130813598633
local_in_edges_tensor generation:  0.027707815170288086
mini_batch_src_global generation:  0.062015533447265625
r_  generation:  0.42719459533691406
local_output_nid generation:  0.02806854248046875
local_in_edges_tensor generation:  0.025344133377075195
mini_batch_src_global generation:  0.050186872482299805
r_  generation:  0.4121079444885254
local_output_nid generation:  0.028640031814575195
local_in_edges_tensor generation:  0.034705162048339844
mini_batch_src_global generation:  0.048547983169555664
r_  generation:  0.4116787910461426
local_output_nid generation:  0.028286218643188477
local_in_edges_tensor generation:  0.0275270938873291
mini_batch_src_global generation:  0.04872393608093262
r_  generation:  0.4207735061645508
local_output_nid generation:  0.0279386043548584
local_in_edges_tensor generation:  0.028290510177612305
mini_batch_src_global generation:  0.04727959632873535
r_  generation:  0.41622495651245117
local_output_nid generation:  0.02823805809020996
local_in_edges_tensor generation:  0.02712392807006836
mini_batch_src_global generation:  0.05132150650024414
r_  generation:  0.4152867794036865
local_output_nid generation:  0.028063058853149414
local_in_edges_tensor generation:  0.03271198272705078
mini_batch_src_global generation:  0.04685091972351074
r_  generation:  0.4244396686553955
local_output_nid generation:  0.030560970306396484
local_in_edges_tensor generation:  0.0272214412689209
mini_batch_src_global generation:  0.051525115966796875
r_  generation:  0.41528844833374023
local_output_nid generation:  0.028090238571166992
local_in_edges_tensor generation:  0.026633501052856445
mini_batch_src_global generation:  0.04840278625488281
r_  generation:  0.41207361221313477
local_output_nid generation:  0.02801799774169922
local_in_edges_tensor generation:  0.02509927749633789
mini_batch_src_global generation:  0.04903411865234375
r_  generation:  0.40917372703552246
local_output_nid generation:  0.028583765029907227
local_in_edges_tensor generation:  0.02916431427001953
mini_batch_src_global generation:  0.0471804141998291
r_  generation:  0.417675256729126
local_output_nid generation:  0.028985261917114258
local_in_edges_tensor generation:  0.027091503143310547
mini_batch_src_global generation:  0.04951620101928711
r_  generation:  0.4119079113006592
local_output_nid generation:  0.02829289436340332
local_in_edges_tensor generation:  0.027037382125854492
mini_batch_src_global generation:  0.047364234924316406
r_  generation:  0.41481637954711914
local_output_nid generation:  0.02799701690673828
local_in_edges_tensor generation:  0.027338266372680664
mini_batch_src_global generation:  0.050617218017578125
r_  generation:  0.404355525970459
----------------------check_connections_block total spend ----------------------------- 19.69793462753296
generate_one_block  0.5554909706115723
generate_one_block  0.5433735847473145
generate_one_block  0.5523509979248047
generate_one_block  0.5480248928070068
generate_one_block  0.6435599327087402
generate_one_block  0.5468945503234863
generate_one_block  0.5560886859893799
generate_one_block  0.5596146583557129
generate_one_block  0.545335054397583
generate_one_block  0.5574729442596436
generate_one_block  0.5653605461120605
generate_one_block  0.5551307201385498
generate_one_block  0.5578444004058838
generate_one_block  0.5600728988647461
generate_one_block  0.5522201061248779
generate_one_block  0.5625028610229492
generate_one_block  0.5518345832824707
generate_one_block  0.5431957244873047
generate_one_block  0.5558910369873047
generate_one_block  0.5445623397827148
generate_one_block  0.5460319519042969
generate_one_block  0.5616257190704346
generate_one_block  0.5451748371124268
generate_one_block  0.572767972946167
generate_one_block  0.557422399520874
generate_one_block  0.5639898777008057
generate_one_block  0.545569658279419
generate_one_block  0.5451085567474365
generate_one_block  0.560173511505127
generate_one_block  0.5583124160766602
generate_one_block  0.5478088855743408
generate_one_block  0.5431287288665771
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12202978134155273  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

connection checking time:  27.21914553642273
block generation total time  24.365610599517822
average batch blocks generation time:  0.761425331234932
block dataloader generation time/epoch 54.504501938819885
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519170761108398  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.608555793762207  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10427045822143555  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.719045639038086  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524940490722656  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.895357131958008  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10473966598510742  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.068970203399658  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522890090942383  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.766855716705322  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10473489761352539  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.43782329559326  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526895523071289  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.97560691833496  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10445880889892578  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.087273597717285  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525226593017578  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.98212432861328  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10478973388671875  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.080843925476074  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524368286132812  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.89203405380249  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10480165481567383  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.919339656829834  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529184341430664  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.102248191833496  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10477113723754883  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.039925575256348  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528993606567383  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.09441900253296  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.105072021484375  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.44892978668213  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519838333129883  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.661789894104004  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10455894470214844  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.537086486816406  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052846908569336  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.16096305847168  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10430765151977539  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.813157558441162  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1051173210144043  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.266305923461914  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10468912124633789  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.225223064422607  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10517406463623047  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.544029712677002  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10464668273925781  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.144840717315674  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052398681640625  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.80934429168701  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10498237609863281  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.252976894378662  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1051950454711914  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.659943103790283  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10446500778198242  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.710269927978516  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1053171157836914  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.24521827697754  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10509347915649414  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.969882011413574  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527944564819336  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.09535789489746  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10451889038085938  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.34709644317627  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03346594423055649 |0.015033110976219177 |0.4124836325645447 |9.153783321380615e-05 |0.7542912736535072 |0.006257295608520508 |
----------------------------------------------------------pseudo_mini_loss sum 1.5594098567962646
Total (block generation + training)time/epoch 93.54608076810837
Training time/epoch 38.94807410240173
Training time without block to device /epoch 38.46701455116272
Training time without total dataloading part /epoch 37.34598350524902
load block tensor time/epoch 1.0709102153778076
block to device time/epoch 0.48105955123901367
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  8787966
Number of first layer input nodes during this epoch:  4678901
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12269735336303711  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03728151321411133
range selection method range initialization spend 0.01699519157409668
time for parepare:  0.018441438674926758
local_output_nid generation:  0.0009405612945556641
local_in_edges_tensor generation:  0.003803730010986328
mini_batch_src_global generation:  0.0021474361419677734
r_  generation:  0.0121002197265625
local_output_nid generation:  0.0009641647338867188
local_in_edges_tensor generation:  0.0006999969482421875
mini_batch_src_global generation:  0.0016160011291503906
r_  generation:  0.010783910751342773
local_output_nid generation:  0.0009105205535888672
local_in_edges_tensor generation:  0.0005898475646972656
mini_batch_src_global generation:  0.0011081695556640625
r_  generation:  0.010106325149536133
local_output_nid generation:  0.0009152889251708984
local_in_edges_tensor generation:  0.0005924701690673828
mini_batch_src_global generation:  0.0011630058288574219
r_  generation:  0.010200738906860352
local_output_nid generation:  0.0008835792541503906
local_in_edges_tensor generation:  0.0005657672882080078
mini_batch_src_global generation:  0.0010597705841064453
r_  generation:  0.009682416915893555
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.0010960102081298828
r_  generation:  0.010115623474121094
local_output_nid generation:  0.0009057521820068359
local_in_edges_tensor generation:  0.0005650520324707031
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.010202884674072266
local_output_nid generation:  0.0009014606475830078
local_in_edges_tensor generation:  0.0005624294281005859
mini_batch_src_global generation:  0.0011713504791259766
r_  generation:  0.010009527206420898
local_output_nid generation:  0.0008795261383056641
local_in_edges_tensor generation:  0.0005686283111572266
mini_batch_src_global generation:  0.001071929931640625
r_  generation:  0.010017871856689453
local_output_nid generation:  0.0008633136749267578
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0011868476867675781
r_  generation:  0.01047205924987793
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0005557537078857422
mini_batch_src_global generation:  0.0010633468627929688
r_  generation:  0.009703874588012695
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.0005605220794677734
mini_batch_src_global generation:  0.0010809898376464844
r_  generation:  0.009905099868774414
local_output_nid generation:  0.0008487701416015625
local_in_edges_tensor generation:  0.0005457401275634766
mini_batch_src_global generation:  0.0010890960693359375
r_  generation:  0.010144233703613281
local_output_nid generation:  0.0008590221405029297
local_in_edges_tensor generation:  0.0005650520324707031
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.010324478149414062
local_output_nid generation:  0.0008544921875
local_in_edges_tensor generation:  0.0005712509155273438
mini_batch_src_global generation:  0.001192331314086914
r_  generation:  0.010825634002685547
local_output_nid generation:  0.0008459091186523438
local_in_edges_tensor generation:  0.0005505084991455078
mini_batch_src_global generation:  0.0011320114135742188
r_  generation:  0.010445356369018555
local_output_nid generation:  0.0008509159088134766
local_in_edges_tensor generation:  0.0005605220794677734
mini_batch_src_global generation:  0.0011293888092041016
r_  generation:  0.010376930236816406
local_output_nid generation:  0.0008463859558105469
local_in_edges_tensor generation:  0.0005471706390380859
mini_batch_src_global generation:  0.0011518001556396484
r_  generation:  0.012512683868408203
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0007627010345458984
mini_batch_src_global generation:  0.001079559326171875
r_  generation:  0.009658098220825195
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0005512237548828125
mini_batch_src_global generation:  0.0010890960693359375
r_  generation:  0.010260343551635742
local_output_nid generation:  0.0008480548858642578
local_in_edges_tensor generation:  0.0005521774291992188
mini_batch_src_global generation:  0.0010824203491210938
r_  generation:  0.00983119010925293
local_output_nid generation:  0.0008461475372314453
local_in_edges_tensor generation:  0.0005671977996826172
mini_batch_src_global generation:  0.0011327266693115234
r_  generation:  0.010103702545166016
local_output_nid generation:  0.0008440017700195312
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0011022090911865234
r_  generation:  0.010439395904541016
local_output_nid generation:  0.0008404254913330078
local_in_edges_tensor generation:  0.0005345344543457031
mini_batch_src_global generation:  0.001079559326171875
r_  generation:  0.010289192199707031
local_output_nid generation:  0.0008437633514404297
local_in_edges_tensor generation:  0.0005412101745605469
mini_batch_src_global generation:  0.0011005401611328125
r_  generation:  0.010204076766967773
local_output_nid generation:  0.0008454322814941406
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.0010905265808105469
r_  generation:  0.010129451751708984
local_output_nid generation:  0.0008416175842285156
local_in_edges_tensor generation:  0.0005409717559814453
mini_batch_src_global generation:  0.0010914802551269531
r_  generation:  0.010188817977905273
local_output_nid generation:  0.0008409023284912109
local_in_edges_tensor generation:  0.0005676746368408203
mini_batch_src_global generation:  0.001190185546875
r_  generation:  0.010706663131713867
local_output_nid generation:  0.0008411407470703125
local_in_edges_tensor generation:  0.0005631446838378906
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.010675430297851562
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0005488395690917969
mini_batch_src_global generation:  0.0011339187622070312
r_  generation:  0.010289430618286133
local_output_nid generation:  0.0008492469787597656
local_in_edges_tensor generation:  0.0005447864532470703
mini_batch_src_global generation:  0.0011761188507080078
r_  generation:  0.010206460952758789
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0005643367767333984
mini_batch_src_global generation:  0.0011522769927978516
r_  generation:  0.010561704635620117
----------------------check_connections_block total spend ----------------------------- 0.5158042907714844
generate_one_block  0.021155834197998047
generate_one_block  0.020076274871826172
generate_one_block  0.018238067626953125
generate_one_block  0.018082857131958008
generate_one_block  0.01714468002319336
generate_one_block  0.017614364624023438
generate_one_block  0.017316579818725586
generate_one_block  0.017263412475585938
generate_one_block  0.017132282257080078
generate_one_block  0.017894744873046875
generate_one_block  0.01651310920715332
generate_one_block  0.017205238342285156
generate_one_block  0.017203092575073242
generate_one_block  0.017510652542114258
generate_one_block  0.01825881004333496
generate_one_block  0.01751995086669922
generate_one_block  0.0175628662109375
generate_one_block  0.017388582229614258
generate_one_block  0.016350746154785156
generate_one_block  0.01722240447998047
generate_one_block  0.016697406768798828
generate_one_block  0.01710796356201172
generate_one_block  0.01994037628173828
generate_one_block  0.017282485961914062
generate_one_block  0.017338275909423828
generate_one_block  0.017000436782836914
generate_one_block  0.017140865325927734
generate_one_block  0.01781010627746582
generate_one_block  0.017633914947509766
generate_one_block  0.01713705062866211
generate_one_block  0.017060041427612305
generate_one_block  0.017925739288330078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03642630577087402
gen group dst list time:  0.025302886962890625
time for parepare:  0.022441625595092773
local_output_nid generation:  0.005287647247314453
local_in_edges_tensor generation:  0.017937421798706055
mini_batch_src_global generation:  0.01671457290649414
r_  generation:  0.13890600204467773
local_output_nid generation:  0.007415056228637695
local_in_edges_tensor generation:  0.009811639785766602
mini_batch_src_global generation:  0.018367290496826172
r_  generation:  0.1756601333618164
local_output_nid generation:  0.007683515548706055
local_in_edges_tensor generation:  0.031359195709228516
mini_batch_src_global generation:  0.01787734031677246
r_  generation:  0.1493539810180664
local_output_nid generation:  0.008090019226074219
local_in_edges_tensor generation:  0.010328531265258789
mini_batch_src_global generation:  0.018207073211669922
r_  generation:  0.1513824462890625
local_output_nid generation:  0.008206367492675781
local_in_edges_tensor generation:  0.010100126266479492
mini_batch_src_global generation:  0.0296478271484375
r_  generation:  0.1473090648651123
local_output_nid generation:  0.008518695831298828
local_in_edges_tensor generation:  0.00926971435546875
mini_batch_src_global generation:  0.018080711364746094
r_  generation:  0.1512622833251953
local_output_nid generation:  0.008522272109985352
local_in_edges_tensor generation:  0.009364128112792969
mini_batch_src_global generation:  0.018661022186279297
r_  generation:  0.1523151397705078
local_output_nid generation:  0.008226394653320312
local_in_edges_tensor generation:  0.007889986038208008
mini_batch_src_global generation:  0.018526315689086914
r_  generation:  0.20467424392700195
local_output_nid generation:  0.008081436157226562
local_in_edges_tensor generation:  0.0077817440032958984
mini_batch_src_global generation:  0.019822120666503906
r_  generation:  0.15061378479003906
local_output_nid generation:  0.008502721786499023
local_in_edges_tensor generation:  0.008047819137573242
mini_batch_src_global generation:  0.019165515899658203
r_  generation:  0.15849089622497559
local_output_nid generation:  0.008249759674072266
local_in_edges_tensor generation:  0.009973287582397461
mini_batch_src_global generation:  0.018566608428955078
r_  generation:  0.14762473106384277
local_output_nid generation:  0.008501291275024414
local_in_edges_tensor generation:  0.008134603500366211
mini_batch_src_global generation:  0.02041339874267578
r_  generation:  0.15109777450561523
local_output_nid generation:  0.00869297981262207
local_in_edges_tensor generation:  0.00808095932006836
mini_batch_src_global generation:  0.019693374633789062
r_  generation:  0.15534090995788574
local_output_nid generation:  0.008909940719604492
local_in_edges_tensor generation:  0.00822901725769043
mini_batch_src_global generation:  0.020275592803955078
r_  generation:  0.1564464569091797
local_output_nid generation:  0.011789321899414062
local_in_edges_tensor generation:  0.00916290283203125
mini_batch_src_global generation:  0.021437406539916992
r_  generation:  0.1683979034423828
local_output_nid generation:  0.008919477462768555
local_in_edges_tensor generation:  0.008469820022583008
mini_batch_src_global generation:  0.020259857177734375
r_  generation:  0.16108131408691406
local_output_nid generation:  0.009756326675415039
local_in_edges_tensor generation:  0.012463808059692383
mini_batch_src_global generation:  0.020453929901123047
r_  generation:  0.16251349449157715
local_output_nid generation:  0.008922338485717773
local_in_edges_tensor generation:  0.008996009826660156
mini_batch_src_global generation:  0.022330284118652344
r_  generation:  0.16107869148254395
local_output_nid generation:  0.00862574577331543
local_in_edges_tensor generation:  0.01540827751159668
mini_batch_src_global generation:  0.019357681274414062
r_  generation:  0.15157151222229004
local_output_nid generation:  0.008982419967651367
local_in_edges_tensor generation:  0.010801315307617188
mini_batch_src_global generation:  0.019434213638305664
r_  generation:  0.15593528747558594
local_output_nid generation:  0.008868217468261719
local_in_edges_tensor generation:  0.008248567581176758
mini_batch_src_global generation:  0.018398284912109375
r_  generation:  0.15237903594970703
local_output_nid generation:  0.010313987731933594
local_in_edges_tensor generation:  0.009093046188354492
mini_batch_src_global generation:  0.018703460693359375
r_  generation:  0.1640613079071045
local_output_nid generation:  0.010155916213989258
local_in_edges_tensor generation:  0.008702516555786133
mini_batch_src_global generation:  0.019405603408813477
r_  generation:  0.15684103965759277
local_output_nid generation:  0.009107828140258789
local_in_edges_tensor generation:  0.008365392684936523
mini_batch_src_global generation:  0.01847362518310547
r_  generation:  0.15161466598510742
local_output_nid generation:  0.009360551834106445
local_in_edges_tensor generation:  0.008487701416015625
mini_batch_src_global generation:  0.0257265567779541
r_  generation:  0.16583657264709473
local_output_nid generation:  0.010744094848632812
local_in_edges_tensor generation:  0.0084075927734375
mini_batch_src_global generation:  0.01870584487915039
r_  generation:  0.14954757690429688
local_output_nid generation:  0.009784936904907227
local_in_edges_tensor generation:  0.00867605209350586
mini_batch_src_global generation:  0.01927971839904785
r_  generation:  0.15607786178588867
local_output_nid generation:  0.009890556335449219
local_in_edges_tensor generation:  0.009041786193847656
mini_batch_src_global generation:  0.019177675247192383
r_  generation:  0.1595442295074463
local_output_nid generation:  0.009743928909301758
local_in_edges_tensor generation:  0.009023189544677734
mini_batch_src_global generation:  0.019025802612304688
r_  generation:  0.1563723087310791
local_output_nid generation:  0.009227514266967773
local_in_edges_tensor generation:  0.008653879165649414
mini_batch_src_global generation:  0.01869797706604004
r_  generation:  0.1555321216583252
local_output_nid generation:  0.009192466735839844
local_in_edges_tensor generation:  0.008359432220458984
mini_batch_src_global generation:  0.0184786319732666
r_  generation:  0.15191936492919922
local_output_nid generation:  0.009562492370605469
local_in_edges_tensor generation:  0.009123802185058594
mini_batch_src_global generation:  0.0197145938873291
r_  generation:  0.1584155559539795
----------------------check_connections_block total spend ----------------------------- 7.458050727844238
generate_one_block  0.21848464012145996
generate_one_block  0.20342612266540527
generate_one_block  0.2066645622253418
generate_one_block  0.2086811065673828
generate_one_block  0.21238422393798828
generate_one_block  0.20423555374145508
generate_one_block  0.2059483528137207
generate_one_block  0.22333121299743652
generate_one_block  0.20259833335876465
generate_one_block  0.21335983276367188
generate_one_block  0.19830965995788574
generate_one_block  0.2038722038269043
generate_one_block  0.2097327709197998
generate_one_block  0.20987391471862793
generate_one_block  0.2144920825958252
generate_one_block  0.21016144752502441
generate_one_block  0.21311283111572266
generate_one_block  0.20703768730163574
generate_one_block  0.19405817985534668
generate_one_block  0.20560026168823242
generate_one_block  0.19434714317321777
generate_one_block  0.20381474494934082
generate_one_block  0.20644879341125488
generate_one_block  0.1986708641052246
generate_one_block  0.20200681686401367
generate_one_block  0.1961519718170166
generate_one_block  0.20242786407470703
generate_one_block  0.21309924125671387
generate_one_block  0.21135377883911133
generate_one_block  0.2172245979309082
generate_one_block  0.19916725158691406
generate_one_block  0.20893645286560059
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.047418832778930664
gen group dst list time:  0.10790896415710449
time for parepare:  0.019960880279541016
local_output_nid generation:  0.023864269256591797
local_in_edges_tensor generation:  0.050612688064575195
mini_batch_src_global generation:  0.0375521183013916
r_  generation:  0.4025580883026123
local_output_nid generation:  0.028874635696411133
local_in_edges_tensor generation:  0.03291630744934082
mini_batch_src_global generation:  0.05032157897949219
r_  generation:  0.40233302116394043
local_output_nid generation:  0.029353857040405273
local_in_edges_tensor generation:  0.027320384979248047
mini_batch_src_global generation:  0.04685664176940918
r_  generation:  0.41558074951171875
local_output_nid generation:  0.02872467041015625
local_in_edges_tensor generation:  0.03093266487121582
mini_batch_src_global generation:  0.049150943756103516
r_  generation:  0.40688562393188477
local_output_nid generation:  0.028632164001464844
local_in_edges_tensor generation:  0.028459787368774414
mini_batch_src_global generation:  0.04738283157348633
r_  generation:  0.4108743667602539
local_output_nid generation:  0.02915477752685547
local_in_edges_tensor generation:  0.028590679168701172
mini_batch_src_global generation:  0.05129837989807129
r_  generation:  0.41414642333984375
local_output_nid generation:  0.027795791625976562
local_in_edges_tensor generation:  0.033231258392333984
mini_batch_src_global generation:  0.047620534896850586
r_  generation:  0.41878604888916016
local_output_nid generation:  0.02803802490234375
local_in_edges_tensor generation:  0.0301816463470459
mini_batch_src_global generation:  0.05024552345275879
r_  generation:  0.4136030673980713
local_output_nid generation:  0.02778339385986328
local_in_edges_tensor generation:  0.028136491775512695
mini_batch_src_global generation:  0.04800534248352051
r_  generation:  0.4132270812988281
local_output_nid generation:  0.02994990348815918
local_in_edges_tensor generation:  0.02873539924621582
mini_batch_src_global generation:  0.04908132553100586
r_  generation:  0.414531946182251
local_output_nid generation:  0.028580188751220703
local_in_edges_tensor generation:  0.03166079521179199
mini_batch_src_global generation:  0.04703354835510254
r_  generation:  0.42707085609436035
local_output_nid generation:  0.031375885009765625
local_in_edges_tensor generation:  0.030424833297729492
mini_batch_src_global generation:  0.05275297164916992
r_  generation:  0.4086582660675049
local_output_nid generation:  0.027986764907836914
local_in_edges_tensor generation:  0.029378414154052734
mini_batch_src_global generation:  0.04687213897705078
r_  generation:  0.4124300479888916
local_output_nid generation:  0.02827310562133789
local_in_edges_tensor generation:  0.028048038482666016
mini_batch_src_global generation:  0.0492548942565918
r_  generation:  0.40759825706481934
local_output_nid generation:  0.028417587280273438
local_in_edges_tensor generation:  0.029988765716552734
mini_batch_src_global generation:  0.04772591590881348
r_  generation:  0.4212825298309326
local_output_nid generation:  0.028625965118408203
local_in_edges_tensor generation:  0.02855086326599121
mini_batch_src_global generation:  0.04971146583557129
r_  generation:  0.4194614887237549
local_output_nid generation:  0.028393268585205078
local_in_edges_tensor generation:  0.028313159942626953
mini_batch_src_global generation:  0.04777693748474121
r_  generation:  0.42050719261169434
local_output_nid generation:  0.028706073760986328
local_in_edges_tensor generation:  0.02842092514038086
mini_batch_src_global generation:  0.048966169357299805
r_  generation:  0.41510438919067383
local_output_nid generation:  0.02799701690673828
local_in_edges_tensor generation:  0.030231475830078125
mini_batch_src_global generation:  0.04730725288391113
r_  generation:  0.4270205497741699
local_output_nid generation:  0.028237581253051758
local_in_edges_tensor generation:  0.028156757354736328
mini_batch_src_global generation:  0.05050063133239746
r_  generation:  0.4119410514831543
local_output_nid generation:  0.028192758560180664
local_in_edges_tensor generation:  0.026670455932617188
mini_batch_src_global generation:  0.04719805717468262
r_  generation:  0.41742897033691406
local_output_nid generation:  0.02827596664428711
local_in_edges_tensor generation:  0.026586055755615234
mini_batch_src_global generation:  0.04884004592895508
r_  generation:  0.41313672065734863
local_output_nid generation:  0.0287630558013916
local_in_edges_tensor generation:  0.039794206619262695
mini_batch_src_global generation:  0.04736518859863281
r_  generation:  0.42165613174438477
local_output_nid generation:  0.02797675132751465
local_in_edges_tensor generation:  0.029947519302368164
mini_batch_src_global generation:  0.04940938949584961
r_  generation:  0.4106149673461914
local_output_nid generation:  0.028385400772094727
local_in_edges_tensor generation:  0.02574443817138672
mini_batch_src_global generation:  0.04777836799621582
r_  generation:  0.42057061195373535
local_output_nid generation:  0.02805638313293457
local_in_edges_tensor generation:  0.025534629821777344
mini_batch_src_global generation:  0.05302095413208008
r_  generation:  0.41179633140563965
local_output_nid generation:  0.029250621795654297
local_in_edges_tensor generation:  0.028545141220092773
mini_batch_src_global generation:  0.0479583740234375
r_  generation:  0.4213728904724121
local_output_nid generation:  0.02859020233154297
local_in_edges_tensor generation:  0.03122854232788086
mini_batch_src_global generation:  0.051621437072753906
r_  generation:  0.419710636138916
local_output_nid generation:  0.02854442596435547
local_in_edges_tensor generation:  0.030003070831298828
mini_batch_src_global generation:  0.04881024360656738
r_  generation:  0.4205653667449951
local_output_nid generation:  0.028388023376464844
local_in_edges_tensor generation:  0.026128768920898438
mini_batch_src_global generation:  0.0513911247253418
r_  generation:  0.4116225242614746
local_output_nid generation:  0.027954816818237305
local_in_edges_tensor generation:  0.02725958824157715
mini_batch_src_global generation:  0.04793739318847656
r_  generation:  0.4194197654724121
local_output_nid generation:  0.028380870819091797
local_in_edges_tensor generation:  0.027256488800048828
mini_batch_src_global generation:  0.05385398864746094
r_  generation:  0.4138329029083252
----------------------check_connections_block total spend ----------------------------- 19.680049419403076
generate_one_block  0.5656986236572266
generate_one_block  0.5464985370635986
generate_one_block  0.5554749965667725
generate_one_block  0.552659273147583
generate_one_block  0.6612021923065186
generate_one_block  0.5560908317565918
generate_one_block  0.5481958389282227
generate_one_block  0.5517044067382812
generate_one_block  0.5447657108306885
generate_one_block  0.5544278621673584
generate_one_block  0.5445506572723389
generate_one_block  0.557485818862915
generate_one_block  0.5623862743377686
generate_one_block  0.5543184280395508
generate_one_block  0.5613462924957275
generate_one_block  0.5592756271362305
generate_one_block  0.5557916164398193
generate_one_block  0.5562732219696045
generate_one_block  0.5468766689300537
generate_one_block  0.5538952350616455
generate_one_block  0.5456433296203613
generate_one_block  0.555365800857544
generate_one_block  0.5608923435211182
generate_one_block  0.5506749153137207
generate_one_block  0.5648610591888428
generate_one_block  0.5445742607116699
generate_one_block  0.5582168102264404
generate_one_block  0.5644769668579102
generate_one_block  0.5601961612701416
generate_one_block  0.5534465312957764
generate_one_block  0.553034782409668
generate_one_block  0.557819128036499
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12269735336303711  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

connection checking time:  27.138100147247314
block generation total time  24.477134704589844
average batch blocks generation time:  0.7649104595184326
block dataloader generation time/epoch 54.535431718826295
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052861213684082  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.072227478027344  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10455989837646484  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.971173763275146  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530710220336914  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.185237407684326  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10492897033691406  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.20686626434326  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520362854003906  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.708088397979736  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1049046516418457  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.969520568847656  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526227951049805  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.996859550476074  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10442113876342773  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.948434352874756  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.105194091796875  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.579705238342285  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10449981689453125  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.196327209472656  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10512876510620117  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.32753896713257  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1047825813293457  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.74551010131836  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522174835205078  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.769795894622803  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10482406616210938  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.93979787826538  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10533857345581055  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.31078052520752  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10488033294677734  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.146350383758545  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529708862304688  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.085383415222168  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046743392944336  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.103938102722168  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10515594482421875  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.49468994140625  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10447406768798828  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.840331077575684  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10515737533569336  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.507733821868896  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10469865798950195  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.8945050239563  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526323318481445  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.04245948791504  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10419368743896484  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.657442569732666  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524225234985352  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.901284217834473  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1045541763305664  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.55229091644287  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523700714111328  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.90996265411377  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1049351692199707  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.210193634033203  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525751113891602  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.94856309890747  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10459756851196289  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.840463638305664  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519838333129883  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.678894519805908  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10483598709106445  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.132628440856934  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03486374765634537 |0.015698671340942383 |0.414816290140152 |9.410828351974487e-05 |0.756234347820282 |0.006657600402832031 |
----------------------------------------------------------pseudo_mini_loss sum 1.5282039642333984
Total (block generation + training)time/epoch 93.59895224571228
Training time/epoch 39.15102195739746
Training time without block to device /epoch 38.648664474487305
Training time without total dataloading part /epoch 37.48328948020935
load block tensor time/epoch 1.1156399250030518
block to device time/epoch 0.5023574829101562
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  8789463
Number of first layer input nodes during this epoch:  4678367
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12359905242919922  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023681640625
range selection method range initialization spend 0.01329350471496582
time for parepare:  0.018450021743774414
local_output_nid generation:  0.0009436607360839844
local_in_edges_tensor generation:  0.007102012634277344
mini_batch_src_global generation:  0.0015058517456054688
r_  generation:  0.010410308837890625
local_output_nid generation:  0.0009882450103759766
local_in_edges_tensor generation:  0.0006661415100097656
mini_batch_src_global generation:  0.0015528202056884766
r_  generation:  0.010623931884765625
local_output_nid generation:  0.0009284019470214844
local_in_edges_tensor generation:  0.0005979537963867188
mini_batch_src_global generation:  0.0011119842529296875
r_  generation:  0.009871959686279297
local_output_nid generation:  0.0009245872497558594
local_in_edges_tensor generation:  0.0005545616149902344
mini_batch_src_global generation:  0.00102996826171875
r_  generation:  0.009560346603393555
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.0011169910430908203
r_  generation:  0.010128974914550781
local_output_nid generation:  0.0008902549743652344
local_in_edges_tensor generation:  0.0005791187286376953
mini_batch_src_global generation:  0.0011487007141113281
r_  generation:  0.01003408432006836
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.0005512237548828125
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.010123252868652344
local_output_nid generation:  0.0008718967437744141
local_in_edges_tensor generation:  0.0005671977996826172
mini_batch_src_global generation:  0.0011677742004394531
r_  generation:  0.010329246520996094
local_output_nid generation:  0.0008764266967773438
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0010480880737304688
r_  generation:  0.010022401809692383
local_output_nid generation:  0.0008783340454101562
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0010423660278320312
r_  generation:  0.009893417358398438
local_output_nid generation:  0.0008590221405029297
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.0011203289031982422
r_  generation:  0.010069847106933594
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005638599395751953
mini_batch_src_global generation:  0.0010862350463867188
r_  generation:  0.01021885871887207
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.0010802745819091797
r_  generation:  0.0102386474609375
local_output_nid generation:  0.0008521080017089844
local_in_edges_tensor generation:  0.0005619525909423828
mini_batch_src_global generation:  0.0011696815490722656
r_  generation:  0.01031351089477539
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0005474090576171875
mini_batch_src_global generation:  0.0010902881622314453
r_  generation:  0.010360956192016602
local_output_nid generation:  0.0008471012115478516
local_in_edges_tensor generation:  0.0005409717559814453
mini_batch_src_global generation:  0.001087188720703125
r_  generation:  0.010175228118896484
local_output_nid generation:  0.0008618831634521484
local_in_edges_tensor generation:  0.0005474090576171875
mini_batch_src_global generation:  0.0011034011840820312
r_  generation:  0.010389089584350586
local_output_nid generation:  0.0008523464202880859
local_in_edges_tensor generation:  0.0005464553833007812
mini_batch_src_global generation:  0.0011050701141357422
r_  generation:  0.010304927825927734
local_output_nid generation:  0.0008542537689208984
local_in_edges_tensor generation:  0.0005676746368408203
mini_batch_src_global generation:  0.0011513233184814453
r_  generation:  0.010753870010375977
local_output_nid generation:  0.0008502006530761719
local_in_edges_tensor generation:  0.0005867481231689453
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.010572433471679688
local_output_nid generation:  0.0008502006530761719
local_in_edges_tensor generation:  0.0005500316619873047
mini_batch_src_global generation:  0.0010807514190673828
r_  generation:  0.010025262832641602
local_output_nid generation:  0.0008518695831298828
local_in_edges_tensor generation:  0.0005631446838378906
mini_batch_src_global generation:  0.0012006759643554688
r_  generation:  0.010412454605102539
local_output_nid generation:  0.0008568763732910156
local_in_edges_tensor generation:  0.0005693435668945312
mini_batch_src_global generation:  0.0010797977447509766
r_  generation:  0.010133028030395508
local_output_nid generation:  0.0008563995361328125
local_in_edges_tensor generation:  0.0005595684051513672
mini_batch_src_global generation:  0.0010561943054199219
r_  generation:  0.010041952133178711
local_output_nid generation:  0.0008625984191894531
local_in_edges_tensor generation:  0.0005753040313720703
mini_batch_src_global generation:  0.0010950565338134766
r_  generation:  0.010414600372314453
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005652904510498047
mini_batch_src_global generation:  0.001096487045288086
r_  generation:  0.010407209396362305
local_output_nid generation:  0.0009243488311767578
local_in_edges_tensor generation:  0.0005860328674316406
mini_batch_src_global generation:  0.001085042953491211
r_  generation:  0.010066747665405273
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.0005369186401367188
mini_batch_src_global generation:  0.0010797977447509766
r_  generation:  0.009986400604248047
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.000537872314453125
mini_batch_src_global generation:  0.0010693073272705078
r_  generation:  0.010152816772460938
local_output_nid generation:  0.0008447170257568359
local_in_edges_tensor generation:  0.0005443096160888672
mini_batch_src_global generation:  0.001092672348022461
r_  generation:  0.010224342346191406
local_output_nid generation:  0.0008473396301269531
local_in_edges_tensor generation:  0.0005223751068115234
mini_batch_src_global generation:  0.0010607242584228516
r_  generation:  0.010054588317871094
local_output_nid generation:  0.0008406639099121094
local_in_edges_tensor generation:  0.000537872314453125
mini_batch_src_global generation:  0.0010695457458496094
r_  generation:  0.009975433349609375
----------------------check_connections_block total spend ----------------------------- 0.5114078521728516
generate_one_block  0.02319955825805664
generate_one_block  0.020117521286010742
generate_one_block  0.01772165298461914
generate_one_block  0.016939878463745117
generate_one_block  0.017735958099365234
generate_one_block  0.017210006713867188
generate_one_block  0.01725172996520996
generate_one_block  0.017884492874145508
generate_one_block  0.017364501953125
generate_one_block  0.01679682731628418
generate_one_block  0.017076969146728516
generate_one_block  0.017589092254638672
generate_one_block  0.017240285873413086
generate_one_block  0.01734161376953125
generate_one_block  0.017154216766357422
generate_one_block  0.017214298248291016
generate_one_block  0.01735234260559082
generate_one_block  0.017223119735717773
generate_one_block  0.01797318458557129
generate_one_block  0.01778125762939453
generate_one_block  0.016685962677001953
generate_one_block  0.01768636703491211
generate_one_block  0.01928114891052246
generate_one_block  0.016880273818969727
generate_one_block  0.017556190490722656
generate_one_block  0.017075061798095703
generate_one_block  0.01676487922668457
generate_one_block  0.016714811325073242
generate_one_block  0.016913890838623047
generate_one_block  0.016971826553344727
generate_one_block  0.01680135726928711
generate_one_block  0.016747474670410156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039342641830444336
gen group dst list time:  0.02286505699157715
time for parepare:  0.02180027961730957
local_output_nid generation:  0.0051708221435546875
local_in_edges_tensor generation:  0.016155004501342773
mini_batch_src_global generation:  0.014605283737182617
r_  generation:  0.1338973045349121
local_output_nid generation:  0.007623434066772461
local_in_edges_tensor generation:  0.010067224502563477
mini_batch_src_global generation:  0.018762826919555664
r_  generation:  0.14296460151672363
local_output_nid generation:  0.007676124572753906
local_in_edges_tensor generation:  0.03034186363220215
mini_batch_src_global generation:  0.017040491104125977
r_  generation:  0.14383339881896973
local_output_nid generation:  0.007891178131103516
local_in_edges_tensor generation:  0.009289741516113281
mini_batch_src_global generation:  0.01654219627380371
r_  generation:  0.1429765224456787
local_output_nid generation:  0.008535146713256836
local_in_edges_tensor generation:  0.008960962295532227
mini_batch_src_global generation:  0.018832683563232422
r_  generation:  0.15114235877990723
local_output_nid generation:  0.008375406265258789
local_in_edges_tensor generation:  0.007803201675415039
mini_batch_src_global generation:  0.01909470558166504
r_  generation:  0.15040850639343262
local_output_nid generation:  0.008421659469604492
local_in_edges_tensor generation:  0.00867915153503418
mini_batch_src_global generation:  0.01821589469909668
r_  generation:  0.15182948112487793
local_output_nid generation:  0.008409738540649414
local_in_edges_tensor generation:  0.00966191291809082
mini_batch_src_global generation:  0.02012467384338379
r_  generation:  0.15538358688354492
local_output_nid generation:  0.008348226547241211
local_in_edges_tensor generation:  0.008243799209594727
mini_batch_src_global generation:  0.019135236740112305
r_  generation:  0.15446138381958008
local_output_nid generation:  0.008186101913452148
local_in_edges_tensor generation:  0.008026123046875
mini_batch_src_global generation:  0.018540382385253906
r_  generation:  0.1466996669769287
local_output_nid generation:  0.0085601806640625
local_in_edges_tensor generation:  0.008154869079589844
mini_batch_src_global generation:  0.018540382385253906
r_  generation:  0.1516869068145752
local_output_nid generation:  0.008835554122924805
local_in_edges_tensor generation:  0.008188247680664062
mini_batch_src_global generation:  0.018870115280151367
r_  generation:  0.1544952392578125
local_output_nid generation:  0.008829593658447266
local_in_edges_tensor generation:  0.008135557174682617
mini_batch_src_global generation:  0.018969058990478516
r_  generation:  0.15244770050048828
local_output_nid generation:  0.008896112442016602
local_in_edges_tensor generation:  0.008338451385498047
mini_batch_src_global generation:  0.019340991973876953
r_  generation:  0.15584897994995117
local_output_nid generation:  0.00876760482788086
local_in_edges_tensor generation:  0.008304834365844727
mini_batch_src_global generation:  0.018983840942382812
r_  generation:  0.15377545356750488
local_output_nid generation:  0.008894205093383789
local_in_edges_tensor generation:  0.008703231811523438
mini_batch_src_global generation:  0.01919722557067871
r_  generation:  0.15334033966064453
local_output_nid generation:  0.008975744247436523
local_in_edges_tensor generation:  0.009447336196899414
mini_batch_src_global generation:  0.019129514694213867
r_  generation:  0.15610384941101074
local_output_nid generation:  0.00892782211303711
local_in_edges_tensor generation:  0.009497642517089844
mini_batch_src_global generation:  0.019261598587036133
r_  generation:  0.15539908409118652
local_output_nid generation:  0.009328842163085938
local_in_edges_tensor generation:  0.010304689407348633
mini_batch_src_global generation:  0.01955556869506836
r_  generation:  0.15880417823791504
local_output_nid generation:  0.009345531463623047
local_in_edges_tensor generation:  0.009070634841918945
mini_batch_src_global generation:  0.019757986068725586
r_  generation:  0.15802931785583496
local_output_nid generation:  0.00865936279296875
local_in_edges_tensor generation:  0.008722305297851562
mini_batch_src_global generation:  0.018418550491333008
r_  generation:  0.15004920959472656
local_output_nid generation:  0.009264707565307617
local_in_edges_tensor generation:  0.008479595184326172
mini_batch_src_global generation:  0.019359827041625977
r_  generation:  0.1574249267578125
local_output_nid generation:  0.008953571319580078
local_in_edges_tensor generation:  0.007910728454589844
mini_batch_src_global generation:  0.018835783004760742
r_  generation:  0.15058231353759766
local_output_nid generation:  0.00875711441040039
local_in_edges_tensor generation:  0.008165836334228516
mini_batch_src_global generation:  0.018137454986572266
r_  generation:  0.15099430084228516
local_output_nid generation:  0.009091377258300781
local_in_edges_tensor generation:  0.008969783782958984
mini_batch_src_global generation:  0.020148038864135742
r_  generation:  0.15836882591247559
local_output_nid generation:  0.009005069732666016
local_in_edges_tensor generation:  0.008249282836914062
mini_batch_src_global generation:  0.02113199234008789
r_  generation:  0.1541121006011963
local_output_nid generation:  0.008916854858398438
local_in_edges_tensor generation:  0.008057117462158203
mini_batch_src_global generation:  0.018099069595336914
r_  generation:  0.1521437168121338
local_output_nid generation:  0.008885622024536133
local_in_edges_tensor generation:  0.008160114288330078
mini_batch_src_global generation:  0.01816558837890625
r_  generation:  0.14885663986206055
local_output_nid generation:  0.009009361267089844
local_in_edges_tensor generation:  0.008714675903320312
mini_batch_src_global generation:  0.01903820037841797
r_  generation:  0.1517951488494873
local_output_nid generation:  0.009140253067016602
local_in_edges_tensor generation:  0.00870966911315918
mini_batch_src_global generation:  0.01902031898498535
r_  generation:  0.15648126602172852
local_output_nid generation:  0.008921384811401367
local_in_edges_tensor generation:  0.00815439224243164
mini_batch_src_global generation:  0.018598556518554688
r_  generation:  0.15349030494689941
local_output_nid generation:  0.008898258209228516
local_in_edges_tensor generation:  0.008043766021728516
mini_batch_src_global generation:  0.018442153930664062
r_  generation:  0.15245342254638672
----------------------check_connections_block total spend ----------------------------- 7.2063000202178955
generate_one_block  0.19873595237731934
generate_one_block  0.20331430435180664
generate_one_block  0.19837665557861328
generate_one_block  0.19559359550476074
generate_one_block  0.22063374519348145
generate_one_block  0.20110225677490234
generate_one_block  0.20061182975769043
generate_one_block  0.2090435028076172
generate_one_block  0.20519351959228516
generate_one_block  0.19608712196350098
generate_one_block  0.19924521446228027
generate_one_block  0.2035672664642334
generate_one_block  0.20210719108581543
generate_one_block  0.20668482780456543
generate_one_block  0.19930410385131836
generate_one_block  0.20850729942321777
generate_one_block  0.20585012435913086
generate_one_block  0.2055361270904541
generate_one_block  0.20889830589294434
generate_one_block  0.21506953239440918
generate_one_block  0.19503378868103027
generate_one_block  0.20691299438476562
generate_one_block  0.19688940048217773
generate_one_block  0.19806122779846191
generate_one_block  0.21249675750732422
generate_one_block  0.2017667293548584
generate_one_block  0.19578838348388672
generate_one_block  0.1937408447265625
generate_one_block  0.19884610176086426
generate_one_block  0.20141315460205078
generate_one_block  0.19992446899414062
generate_one_block  0.20237231254577637
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03403663635253906
gen group dst list time:  0.09964251518249512
time for parepare:  0.018323659896850586
local_output_nid generation:  0.022274017333984375
local_in_edges_tensor generation:  0.03629803657531738
mini_batch_src_global generation:  0.03744220733642578
r_  generation:  0.402606725692749
local_output_nid generation:  0.028594493865966797
local_in_edges_tensor generation:  0.03153181076049805
mini_batch_src_global generation:  0.04970669746398926
r_  generation:  0.4019193649291992
local_output_nid generation:  0.028327226638793945
local_in_edges_tensor generation:  0.02514481544494629
mini_batch_src_global generation:  0.04542279243469238
r_  generation:  0.41148972511291504
local_output_nid generation:  0.029298067092895508
local_in_edges_tensor generation:  0.02684926986694336
mini_batch_src_global generation:  0.048384904861450195
r_  generation:  0.4040508270263672
local_output_nid generation:  0.02875804901123047
local_in_edges_tensor generation:  0.026752948760986328
mini_batch_src_global generation:  0.04693007469177246
r_  generation:  0.4168887138366699
local_output_nid generation:  0.028554677963256836
local_in_edges_tensor generation:  0.026953458786010742
mini_batch_src_global generation:  0.04915809631347656
r_  generation:  0.4081106185913086
local_output_nid generation:  0.027070999145507812
local_in_edges_tensor generation:  0.02746748924255371
mini_batch_src_global generation:  0.04860830307006836
r_  generation:  0.41566038131713867
local_output_nid generation:  0.0270998477935791
local_in_edges_tensor generation:  0.027970075607299805
mini_batch_src_global generation:  0.049298763275146484
r_  generation:  0.4172372817993164
local_output_nid generation:  0.027113914489746094
local_in_edges_tensor generation:  0.02706456184387207
mini_batch_src_global generation:  0.04716086387634277
r_  generation:  0.4180727005004883
local_output_nid generation:  0.026964187622070312
local_in_edges_tensor generation:  0.025882959365844727
mini_batch_src_global generation:  0.04869270324707031
r_  generation:  0.4074695110321045
local_output_nid generation:  0.027274608612060547
local_in_edges_tensor generation:  0.026800870895385742
mini_batch_src_global generation:  0.04845309257507324
r_  generation:  0.4160270690917969
local_output_nid generation:  0.02715897560119629
local_in_edges_tensor generation:  0.02573418617248535
mini_batch_src_global generation:  0.048822879791259766
r_  generation:  0.41035938262939453
local_output_nid generation:  0.02720046043395996
local_in_edges_tensor generation:  0.028512001037597656
mini_batch_src_global generation:  0.04860186576843262
r_  generation:  0.4205162525177002
local_output_nid generation:  0.027512550354003906
local_in_edges_tensor generation:  0.026227712631225586
mini_batch_src_global generation:  0.04877781867980957
r_  generation:  0.41156435012817383
local_output_nid generation:  0.027362823486328125
local_in_edges_tensor generation:  0.028455495834350586
mini_batch_src_global generation:  0.04737114906311035
r_  generation:  0.41730785369873047
local_output_nid generation:  0.02740168571472168
local_in_edges_tensor generation:  0.02737259864807129
mini_batch_src_global generation:  0.04896044731140137
r_  generation:  0.4112093448638916
local_output_nid generation:  0.02727222442626953
local_in_edges_tensor generation:  0.02768397331237793
mini_batch_src_global generation:  0.04745292663574219
r_  generation:  0.41808533668518066
local_output_nid generation:  0.027230024337768555
local_in_edges_tensor generation:  0.025813579559326172
mini_batch_src_global generation:  0.04863572120666504
r_  generation:  0.41307544708251953
local_output_nid generation:  0.0277097225189209
local_in_edges_tensor generation:  0.028272628784179688
mini_batch_src_global generation:  0.049716949462890625
r_  generation:  0.42090821266174316
local_output_nid generation:  0.027356624603271484
local_in_edges_tensor generation:  0.025650739669799805
mini_batch_src_global generation:  0.049208879470825195
r_  generation:  0.41355276107788086
local_output_nid generation:  0.02691364288330078
local_in_edges_tensor generation:  0.02963852882385254
mini_batch_src_global generation:  0.046422719955444336
r_  generation:  0.41298532485961914
local_output_nid generation:  0.027655601501464844
local_in_edges_tensor generation:  0.027040719985961914
mini_batch_src_global generation:  0.05062699317932129
r_  generation:  0.4133782386779785
local_output_nid generation:  0.027395009994506836
local_in_edges_tensor generation:  0.028017520904541016
mini_batch_src_global generation:  0.04766225814819336
r_  generation:  0.4162752628326416
local_output_nid generation:  0.027346372604370117
local_in_edges_tensor generation:  0.025103330612182617
mini_batch_src_global generation:  0.048958778381347656
r_  generation:  0.41224241256713867
local_output_nid generation:  0.02771782875061035
local_in_edges_tensor generation:  0.030064105987548828
mini_batch_src_global generation:  0.04695272445678711
r_  generation:  0.4195685386657715
local_output_nid generation:  0.027653217315673828
local_in_edges_tensor generation:  0.029942989349365234
mini_batch_src_global generation:  0.049077510833740234
r_  generation:  0.41315412521362305
local_output_nid generation:  0.029740333557128906
local_in_edges_tensor generation:  0.027532100677490234
mini_batch_src_global generation:  0.04914236068725586
r_  generation:  0.419513463973999
local_output_nid generation:  0.027497053146362305
local_in_edges_tensor generation:  0.027140378952026367
mini_batch_src_global generation:  0.0504908561706543
r_  generation:  0.4127347469329834
local_output_nid generation:  0.027163028717041016
local_in_edges_tensor generation:  0.025669097900390625
mini_batch_src_global generation:  0.04666543006896973
r_  generation:  0.41885805130004883
local_output_nid generation:  0.02777409553527832
local_in_edges_tensor generation:  0.027445316314697266
mini_batch_src_global generation:  0.04879260063171387
r_  generation:  0.4131801128387451
local_output_nid generation:  0.02768254280090332
local_in_edges_tensor generation:  0.027601242065429688
mini_batch_src_global generation:  0.04702115058898926
r_  generation:  0.41959309577941895
local_output_nid generation:  0.027190446853637695
local_in_edges_tensor generation:  0.027485370635986328
mini_batch_src_global generation:  0.0505068302154541
r_  generation:  0.4242119789123535
----------------------check_connections_block total spend ----------------------------- 19.506391286849976
generate_one_block  0.5521290302276611
generate_one_block  0.553647518157959
generate_one_block  0.5523662567138672
generate_one_block  0.5435974597930908
generate_one_block  0.6541292667388916
generate_one_block  0.5470080375671387
generate_one_block  0.5634427070617676
generate_one_block  0.560150146484375
generate_one_block  0.5499482154846191
generate_one_block  0.5460968017578125
generate_one_block  0.5458531379699707
generate_one_block  0.5520529747009277
generate_one_block  0.5465788841247559
generate_one_block  0.5543615818023682
generate_one_block  0.5527541637420654
generate_one_block  0.555750846862793
generate_one_block  0.5610692501068115
generate_one_block  0.5540993213653564
generate_one_block  0.5678672790527344
generate_one_block  0.550182580947876
generate_one_block  0.5417025089263916
generate_one_block  0.5512678623199463
generate_one_block  0.5470836162567139
generate_one_block  0.5471420288085938
generate_one_block  0.5793724060058594
generate_one_block  0.5487864017486572
generate_one_block  0.5433900356292725
generate_one_block  0.5419166088104248
generate_one_block  0.5462033748626709
generate_one_block  0.5503404140472412
generate_one_block  0.5564680099487305
generate_one_block  0.5492401123046875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12359905242919922  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

connection checking time:  26.71269130706787
block generation total time  24.252707481384277
average batch blocks generation time:  0.7578971087932587
block dataloader generation time/epoch 54.41417066256205
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520458221435547  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.715765953063965  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10490179061889648  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.043367385864258  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522174835205078  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.77357816696167  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1045231819152832  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.65999937057495  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528230667114258  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.100393772125244  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1047205924987793  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.83733606338501  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524129867553711  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.871819496154785  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10490655899047852  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.249751091003418  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526514053344727  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.056227684020996  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10458660125732422  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.59087371826172  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522699356079102  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.91148042678833  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10472440719604492  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.03520107269287  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524320602416992  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.884647846221924  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10472440719604492  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.125091552734375  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522651672363281  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.81415605545044  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10488224029541016  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.99938678741455  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528182983398438  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.152493476867676  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10449647903442383  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.071560382843018  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10532760620117188  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.38264751434326  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10498571395874023  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.254809379577637  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10416603088378906  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.42652177810669  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10481405258178711  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.219836711883545  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520267486572266  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.738370895385742  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10456657409667969  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.595932960510254  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10532569885253906  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.266976833343506  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10456275939941406  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.839637279510498  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519170761108398  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.645674228668213  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10468482971191406  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.512732982635498  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052088737487793  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.681775093078613  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10489416122436523  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.88301706314087  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521507263183594  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.776562690734863  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10474491119384766  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.796342372894287  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031203508377075195 |0.012444838881492615 |0.41385554522275925 |9.340792894363403e-05 |0.7560027465224266 |0.006089925765991211 |
----------------------------------------------------------pseudo_mini_loss sum 1.4925508499145508
Total (block generation + training)time/epoch 93.4487950404485
Training time/epoch 38.88988471031189
Training time without block to device /epoch 38.491649866104126
Training time without total dataloading part /epoch 37.444544315338135
load block tensor time/epoch 0.9985122680664062
block to device time/epoch 0.39823484420776367
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  8790430
Number of first layer input nodes during this epoch:  4680018
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12293672561645508  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026023149490356445
range selection method range initialization spend 0.01634836196899414
time for parepare:  0.017137765884399414
local_output_nid generation:  0.0009548664093017578
local_in_edges_tensor generation:  0.006728649139404297
mini_batch_src_global generation:  0.0014357566833496094
r_  generation:  0.011003255844116211
local_output_nid generation:  0.0009644031524658203
local_in_edges_tensor generation:  0.0006451606750488281
mini_batch_src_global generation:  0.001439809799194336
r_  generation:  0.010744810104370117
local_output_nid generation:  0.0009257793426513672
local_in_edges_tensor generation:  0.0006034374237060547
mini_batch_src_global generation:  0.0011057853698730469
r_  generation:  0.009905099868774414
local_output_nid generation:  0.0009164810180664062
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0011246204376220703
r_  generation:  0.01005697250366211
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.001074075698852539
r_  generation:  0.010090827941894531
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.0005621910095214844
mini_batch_src_global generation:  0.0010695457458496094
r_  generation:  0.010071039199829102
local_output_nid generation:  0.0008497238159179688
local_in_edges_tensor generation:  0.0005517005920410156
mini_batch_src_global generation:  0.001069784164428711
r_  generation:  0.01009988784790039
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0005869865417480469
mini_batch_src_global generation:  0.0010743141174316406
r_  generation:  0.010269403457641602
local_output_nid generation:  0.0008375644683837891
local_in_edges_tensor generation:  0.0005481243133544922
mini_batch_src_global generation:  0.0010533332824707031
r_  generation:  0.009607315063476562
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.0011298656463623047
r_  generation:  0.009943246841430664
local_output_nid generation:  0.0008366107940673828
local_in_edges_tensor generation:  0.0005729198455810547
mini_batch_src_global generation:  0.001142740249633789
r_  generation:  0.010119915008544922
local_output_nid generation:  0.0008456707000732422
local_in_edges_tensor generation:  0.0005631446838378906
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.01044607162475586
local_output_nid generation:  0.0008482933044433594
local_in_edges_tensor generation:  0.0005605220794677734
mini_batch_src_global generation:  0.001096963882446289
r_  generation:  0.01003122329711914
local_output_nid generation:  0.0008399486541748047
local_in_edges_tensor generation:  0.0005450248718261719
mini_batch_src_global generation:  0.0010864734649658203
r_  generation:  0.010311603546142578
local_output_nid generation:  0.0008480548858642578
local_in_edges_tensor generation:  0.0005490779876708984
mini_batch_src_global generation:  0.0010459423065185547
r_  generation:  0.009837150573730469
local_output_nid generation:  0.0008363723754882812
local_in_edges_tensor generation:  0.0005507469177246094
mini_batch_src_global generation:  0.0011320114135742188
r_  generation:  0.010536432266235352
local_output_nid generation:  0.0008387565612792969
local_in_edges_tensor generation:  0.0005450248718261719
mini_batch_src_global generation:  0.0010595321655273438
r_  generation:  0.010103702545166016
local_output_nid generation:  0.0008273124694824219
local_in_edges_tensor generation:  0.0005478858947753906
mini_batch_src_global generation:  0.0011081695556640625
r_  generation:  0.010757207870483398
local_output_nid generation:  0.000858306884765625
local_in_edges_tensor generation:  0.0005304813385009766
mini_batch_src_global generation:  0.0011792182922363281
r_  generation:  0.010352134704589844
local_output_nid generation:  0.0008447170257568359
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0011165142059326172
r_  generation:  0.010803937911987305
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0005495548248291016
mini_batch_src_global generation:  0.0010766983032226562
r_  generation:  0.009834527969360352
local_output_nid generation:  0.0008728504180908203
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.010332345962524414
local_output_nid generation:  0.0008432865142822266
local_in_edges_tensor generation:  0.0005755424499511719
mini_batch_src_global generation:  0.0010917186737060547
r_  generation:  0.010444164276123047
local_output_nid generation:  0.0008435249328613281
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.010452985763549805
local_output_nid generation:  0.00083160400390625
local_in_edges_tensor generation:  0.0005238056182861328
mini_batch_src_global generation:  0.001085519790649414
r_  generation:  0.010482549667358398
local_output_nid generation:  0.0008397102355957031
local_in_edges_tensor generation:  0.0005426406860351562
mini_batch_src_global generation:  0.0011093616485595703
r_  generation:  0.010586261749267578
local_output_nid generation:  0.0008327960968017578
local_in_edges_tensor generation:  0.0005350112915039062
mini_batch_src_global generation:  0.0011119842529296875
r_  generation:  0.010401248931884766
local_output_nid generation:  0.0008335113525390625
local_in_edges_tensor generation:  0.0005469322204589844
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.010009765625
local_output_nid generation:  0.0008502006530761719
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.0010669231414794922
r_  generation:  0.010350704193115234
local_output_nid generation:  0.000835418701171875
local_in_edges_tensor generation:  0.0005495548248291016
mini_batch_src_global generation:  0.0010478496551513672
r_  generation:  0.010060787200927734
local_output_nid generation:  0.0008342266082763672
local_in_edges_tensor generation:  0.0005431175231933594
mini_batch_src_global generation:  0.0010941028594970703
r_  generation:  0.010466337203979492
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.0005393028259277344
mini_batch_src_global generation:  0.0010714530944824219
r_  generation:  0.009875297546386719
----------------------check_connections_block total spend ----------------------------- 0.5106284618377686
generate_one_block  0.02021193504333496
generate_one_block  0.01975727081298828
generate_one_block  0.017937898635864258
generate_one_block  0.017627716064453125
generate_one_block  0.01765275001525879
generate_one_block  0.017434358596801758
generate_one_block  0.017499446868896484
generate_one_block  0.017488479614257812
generate_one_block  0.016510725021362305
generate_one_block  0.016970396041870117
generate_one_block  0.01723170280456543
generate_one_block  0.01778101921081543
generate_one_block  0.017101526260375977
generate_one_block  0.017395973205566406
generate_one_block  0.016583919525146484
generate_one_block  0.017801761627197266
generate_one_block  0.017179012298583984
generate_one_block  0.021309375762939453
generate_one_block  0.017641782760620117
generate_one_block  0.018010377883911133
generate_one_block  0.01663494110107422
generate_one_block  0.0174105167388916
generate_one_block  0.019957304000854492
generate_one_block  0.017786502838134766
generate_one_block  0.01753854751586914
generate_one_block  0.017732858657836914
generate_one_block  0.017659902572631836
generate_one_block  0.0169985294342041
generate_one_block  0.017542600631713867
generate_one_block  0.016675472259521484
generate_one_block  0.017541170120239258
generate_one_block  0.016492843627929688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03597545623779297
gen group dst list time:  0.020774364471435547
time for parepare:  0.01966071128845215
local_output_nid generation:  0.0055544376373291016
local_in_edges_tensor generation:  0.017323970794677734
mini_batch_src_global generation:  0.01482248306274414
r_  generation:  0.1388254165649414
local_output_nid generation:  0.0074923038482666016
local_in_edges_tensor generation:  0.00979471206665039
mini_batch_src_global generation:  0.01844310760498047
r_  generation:  0.1403942108154297
local_output_nid generation:  0.007784605026245117
local_in_edges_tensor generation:  0.03185915946960449
mini_batch_src_global generation:  0.016953468322753906
r_  generation:  0.14355921745300293
local_output_nid generation:  0.00795292854309082
local_in_edges_tensor generation:  0.010347843170166016
mini_batch_src_global generation:  0.017362117767333984
r_  generation:  0.1470637321472168
local_output_nid generation:  0.008397102355957031
local_in_edges_tensor generation:  0.009068965911865234
mini_batch_src_global generation:  0.019301176071166992
r_  generation:  0.15247225761413574
local_output_nid generation:  0.008399248123168945
local_in_edges_tensor generation:  0.008956670761108398
mini_batch_src_global generation:  0.018538951873779297
r_  generation:  0.1493687629699707
local_output_nid generation:  0.008539438247680664
local_in_edges_tensor generation:  0.008272171020507812
mini_batch_src_global generation:  0.019174575805664062
r_  generation:  0.1571052074432373
local_output_nid generation:  0.00905299186706543
local_in_edges_tensor generation:  0.009464025497436523
mini_batch_src_global generation:  0.019067764282226562
r_  generation:  0.15255475044250488
local_output_nid generation:  0.007901191711425781
local_in_edges_tensor generation:  0.010180950164794922
mini_batch_src_global generation:  0.01863384246826172
r_  generation:  0.1444411277770996
local_output_nid generation:  0.008398294448852539
local_in_edges_tensor generation:  0.008762121200561523
mini_batch_src_global generation:  0.01849198341369629
r_  generation:  0.14823126792907715
local_output_nid generation:  0.008678913116455078
local_in_edges_tensor generation:  0.008950233459472656
mini_batch_src_global generation:  0.018141984939575195
r_  generation:  0.1502242088317871
local_output_nid generation:  0.008873939514160156
local_in_edges_tensor generation:  0.008116483688354492
mini_batch_src_global generation:  0.01988697052001953
r_  generation:  0.1521904468536377
local_output_nid generation:  0.008889198303222656
local_in_edges_tensor generation:  0.007986307144165039
mini_batch_src_global generation:  0.01874709129333496
r_  generation:  0.1526346206665039
local_output_nid generation:  0.008905172348022461
local_in_edges_tensor generation:  0.008728265762329102
mini_batch_src_global generation:  0.019031524658203125
r_  generation:  0.15382742881774902
local_output_nid generation:  0.00852513313293457
local_in_edges_tensor generation:  0.00792074203491211
mini_batch_src_global generation:  0.018621206283569336
r_  generation:  0.14858651161193848
local_output_nid generation:  0.009530067443847656
local_in_edges_tensor generation:  0.008388280868530273
mini_batch_src_global generation:  0.020170927047729492
r_  generation:  0.1588757038116455
local_output_nid generation:  0.008905410766601562
local_in_edges_tensor generation:  0.008706331253051758
mini_batch_src_global generation:  0.01925063133239746
r_  generation:  0.15523862838745117
local_output_nid generation:  0.009120464324951172
local_in_edges_tensor generation:  0.008888483047485352
mini_batch_src_global generation:  0.020417213439941406
r_  generation:  0.15623855590820312
local_output_nid generation:  0.008894920349121094
local_in_edges_tensor generation:  0.00818014144897461
mini_batch_src_global generation:  0.01895761489868164
r_  generation:  0.1543292999267578
local_output_nid generation:  0.00923466682434082
local_in_edges_tensor generation:  0.008832216262817383
mini_batch_src_global generation:  0.02039170265197754
r_  generation:  0.15691590309143066
local_output_nid generation:  0.008689165115356445
local_in_edges_tensor generation:  0.007994413375854492
mini_batch_src_global generation:  0.018507957458496094
r_  generation:  0.14928817749023438
local_output_nid generation:  0.008977413177490234
local_in_edges_tensor generation:  0.008313417434692383
mini_batch_src_global generation:  0.019582271575927734
r_  generation:  0.15458369255065918
local_output_nid generation:  0.008973836898803711
local_in_edges_tensor generation:  0.009017467498779297
mini_batch_src_global generation:  0.019069671630859375
r_  generation:  0.15633773803710938
local_output_nid generation:  0.009001493453979492
local_in_edges_tensor generation:  0.009305238723754883
mini_batch_src_global generation:  0.019033193588256836
r_  generation:  0.15581822395324707
local_output_nid generation:  0.009120464324951172
local_in_edges_tensor generation:  0.009032726287841797
mini_batch_src_global generation:  0.0191652774810791
r_  generation:  0.15761852264404297
local_output_nid generation:  0.00909423828125
local_in_edges_tensor generation:  0.009064435958862305
mini_batch_src_global generation:  0.020853281021118164
r_  generation:  0.1578528881072998
local_output_nid generation:  0.009084701538085938
local_in_edges_tensor generation:  0.008922338485717773
mini_batch_src_global generation:  0.019028663635253906
r_  generation:  0.1566941738128662
local_output_nid generation:  0.008791208267211914
local_in_edges_tensor generation:  0.007975101470947266
mini_batch_src_global generation:  0.018590688705444336
r_  generation:  0.15038299560546875
local_output_nid generation:  0.009042739868164062
local_in_edges_tensor generation:  0.00881505012512207
mini_batch_src_global generation:  0.0191195011138916
r_  generation:  0.15893054008483887
local_output_nid generation:  0.008778095245361328
local_in_edges_tensor generation:  0.00830078125
mini_batch_src_global generation:  0.018387794494628906
r_  generation:  0.14671874046325684
local_output_nid generation:  0.009144783020019531
local_in_edges_tensor generation:  0.00847005844116211
mini_batch_src_global generation:  0.018885374069213867
r_  generation:  0.1604623794555664
local_output_nid generation:  0.008777141571044922
local_in_edges_tensor generation:  0.007916927337646484
mini_batch_src_global generation:  0.019275188446044922
r_  generation:  0.14917778968811035
----------------------check_connections_block total spend ----------------------------- 7.231418132781982
generate_one_block  0.20779156684875488
generate_one_block  0.20020580291748047
generate_one_block  0.19994902610778809
generate_one_block  0.20260834693908691
generate_one_block  0.2227950096130371
generate_one_block  0.20105886459350586
generate_one_block  0.2037975788116455
generate_one_block  0.20649003982543945
generate_one_block  0.19306492805480957
generate_one_block  0.19605159759521484
generate_one_block  0.19705843925476074
generate_one_block  0.20193243026733398
generate_one_block  0.20295381546020508
generate_one_block  0.2024681568145752
generate_one_block  0.19004297256469727
generate_one_block  0.2071068286895752
generate_one_block  0.20780682563781738
generate_one_block  0.20818400382995605
generate_one_block  0.2013406753540039
generate_one_block  0.21100807189941406
generate_one_block  0.19286799430847168
generate_one_block  0.2024829387664795
generate_one_block  0.20246481895446777
generate_one_block  0.20418071746826172
generate_one_block  0.20476412773132324
generate_one_block  0.20937275886535645
generate_one_block  0.20418214797973633
generate_one_block  0.19634747505187988
generate_one_block  0.20834684371948242
generate_one_block  0.19082260131835938
generate_one_block  0.2070605754852295
generate_one_block  0.19365549087524414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03143882751464844
gen group dst list time:  0.09897971153259277
time for parepare:  0.019778013229370117
local_output_nid generation:  0.022819995880126953
local_in_edges_tensor generation:  0.03952598571777344
mini_batch_src_global generation:  0.03903651237487793
r_  generation:  0.4075026512145996
local_output_nid generation:  0.028348445892333984
local_in_edges_tensor generation:  0.031373023986816406
mini_batch_src_global generation:  0.051122188568115234
r_  generation:  0.3977999687194824
local_output_nid generation:  0.028489351272583008
local_in_edges_tensor generation:  0.030352115631103516
mini_batch_src_global generation:  0.047299861907958984
r_  generation:  0.41233325004577637
local_output_nid generation:  0.02852320671081543
local_in_edges_tensor generation:  0.025085926055908203
mini_batch_src_global generation:  0.0492856502532959
r_  generation:  0.41586899757385254
local_output_nid generation:  0.029915332794189453
local_in_edges_tensor generation:  0.027927875518798828
mini_batch_src_global generation:  0.04828619956970215
r_  generation:  0.4158611297607422
local_output_nid generation:  0.028689861297607422
local_in_edges_tensor generation:  0.02716231346130371
mini_batch_src_global generation:  0.049649953842163086
r_  generation:  0.40641307830810547
local_output_nid generation:  0.02698659896850586
local_in_edges_tensor generation:  0.027280330657958984
mini_batch_src_global generation:  0.05016756057739258
r_  generation:  0.4261012077331543
local_output_nid generation:  0.0279848575592041
local_in_edges_tensor generation:  0.026532411575317383
mini_batch_src_global generation:  0.0497899055480957
r_  generation:  0.40366053581237793
local_output_nid generation:  0.027760744094848633
local_in_edges_tensor generation:  0.02737569808959961
mini_batch_src_global generation:  0.047600507736206055
r_  generation:  0.4078667163848877
local_output_nid generation:  0.028033018112182617
local_in_edges_tensor generation:  0.025922298431396484
mini_batch_src_global generation:  0.051203250885009766
r_  generation:  0.4085702896118164
local_output_nid generation:  0.029257774353027344
local_in_edges_tensor generation:  0.026665210723876953
mini_batch_src_global generation:  0.04790854454040527
r_  generation:  0.4144470691680908
local_output_nid generation:  0.028180599212646484
local_in_edges_tensor generation:  0.02733755111694336
mini_batch_src_global generation:  0.049974679946899414
r_  generation:  0.4093475341796875
local_output_nid generation:  0.028165578842163086
local_in_edges_tensor generation:  0.02721261978149414
mini_batch_src_global generation:  0.04768252372741699
r_  generation:  0.41658926010131836
local_output_nid generation:  0.028149127960205078
local_in_edges_tensor generation:  0.027683019638061523
mini_batch_src_global generation:  0.050142765045166016
r_  generation:  0.40981197357177734
local_output_nid generation:  0.027487516403198242
local_in_edges_tensor generation:  0.025055646896362305
mini_batch_src_global generation:  0.046968698501586914
r_  generation:  0.4090611934661865
local_output_nid generation:  0.02833247184753418
local_in_edges_tensor generation:  0.027698278427124023
mini_batch_src_global generation:  0.05147218704223633
r_  generation:  0.4115917682647705
local_output_nid generation:  0.028110742568969727
local_in_edges_tensor generation:  0.026726722717285156
mini_batch_src_global generation:  0.04769325256347656
r_  generation:  0.4146270751953125
local_output_nid generation:  0.027968168258666992
local_in_edges_tensor generation:  0.027121305465698242
mini_batch_src_global generation:  0.051108360290527344
r_  generation:  0.4063708782196045
local_output_nid generation:  0.0279543399810791
local_in_edges_tensor generation:  0.025188684463500977
mini_batch_src_global generation:  0.04762005805969238
r_  generation:  0.414156436920166
local_output_nid generation:  0.0281829833984375
local_in_edges_tensor generation:  0.029135704040527344
mini_batch_src_global generation:  0.051911115646362305
r_  generation:  0.4086952209472656
local_output_nid generation:  0.028014421463012695
local_in_edges_tensor generation:  0.025558948516845703
mini_batch_src_global generation:  0.051596641540527344
r_  generation:  0.4189484119415283
local_output_nid generation:  0.028075218200683594
local_in_edges_tensor generation:  0.025206804275512695
mini_batch_src_global generation:  0.050354957580566406
r_  generation:  0.4076418876647949
local_output_nid generation:  0.027938365936279297
local_in_edges_tensor generation:  0.025424480438232422
mini_batch_src_global generation:  0.047760009765625
r_  generation:  0.41657543182373047
local_output_nid generation:  0.02814006805419922
local_in_edges_tensor generation:  0.0254213809967041
mini_batch_src_global generation:  0.04988551139831543
r_  generation:  0.40802597999572754
local_output_nid generation:  0.02821040153503418
local_in_edges_tensor generation:  0.03069472312927246
mini_batch_src_global generation:  0.047811031341552734
r_  generation:  0.4200749397277832
local_output_nid generation:  0.028201818466186523
local_in_edges_tensor generation:  0.027401447296142578
mini_batch_src_global generation:  0.051552772521972656
r_  generation:  0.4113130569458008
local_output_nid generation:  0.02859354019165039
local_in_edges_tensor generation:  0.025237321853637695
mini_batch_src_global generation:  0.048360586166381836
r_  generation:  0.4187967777252197
local_output_nid generation:  0.02806568145751953
local_in_edges_tensor generation:  0.028446435928344727
mini_batch_src_global generation:  0.049546003341674805
r_  generation:  0.40800023078918457
local_output_nid generation:  0.028122425079345703
local_in_edges_tensor generation:  0.02565479278564453
mini_batch_src_global generation:  0.04960966110229492
r_  generation:  0.4257650375366211
local_output_nid generation:  0.028124570846557617
local_in_edges_tensor generation:  0.027449607849121094
mini_batch_src_global generation:  0.049820661544799805
r_  generation:  0.4033684730529785
local_output_nid generation:  0.028581619262695312
local_in_edges_tensor generation:  0.025325298309326172
mini_batch_src_global generation:  0.04774212837219238
r_  generation:  0.417741060256958
local_output_nid generation:  0.02813100814819336
local_in_edges_tensor generation:  0.0254361629486084
mini_batch_src_global generation:  0.04926037788391113
r_  generation:  0.40598535537719727
----------------------check_connections_block total spend ----------------------------- 19.485316038131714
generate_one_block  0.5613808631896973
generate_one_block  0.5420944690704346
generate_one_block  0.5491847991943359
generate_one_block  0.5457124710083008
generate_one_block  0.6372883319854736
generate_one_block  0.5525238513946533
generate_one_block  0.5517470836639404
generate_one_block  0.5474972724914551
generate_one_block  0.5424504280090332
generate_one_block  0.5484764575958252
generate_one_block  0.5531442165374756
generate_one_block  0.5505521297454834
generate_one_block  0.5499792098999023
generate_one_block  0.555687665939331
generate_one_block  0.5395989418029785
generate_one_block  0.5574698448181152
generate_one_block  0.551091194152832
generate_one_block  0.5488240718841553
generate_one_block  0.54927659034729
generate_one_block  0.5575277805328369
generate_one_block  0.5440475940704346
generate_one_block  0.5532991886138916
generate_one_block  0.5466687679290771
generate_one_block  0.5560152530670166
generate_one_block  0.5705604553222656
generate_one_block  0.55287766456604
generate_one_block  0.5550367832183838
generate_one_block  0.5455672740936279
generate_one_block  0.5525381565093994
generate_one_block  0.5439846515655518
generate_one_block  0.554919958114624
generate_one_block  0.5424060821533203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12293672561645508  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

connection checking time:  26.716734170913696
block generation total time  24.189692974090576
average batch blocks generation time:  0.7559279054403305
block dataloader generation time/epoch 54.3305949143001
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529136657714844  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.199283123016357  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10460710525512695  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.759601593017578  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052403450012207  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.862003326416016  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10468864440917969  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.904921531677246  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530662536621094  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.156505584716797  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10451030731201172  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.00105571746826  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527801513671875  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.148921489715576  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10458755493164062  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.008272647857666  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10515022277832031  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.46648406982422  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10492849349975586  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.719526290893555  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052098274230957  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.757758617401123  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10450220108032227  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.965784549713135  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524415969848633  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.967199325561523  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10464334487915039  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.06297206878662  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10514307022094727  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.35170316696167  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10480070114135742  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.28529691696167  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524702072143555  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.925620555877686  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10449647903442383  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.094019889831543  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524988174438477  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.90149688720703  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10482120513916016  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.20078182220459  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10515546798706055  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.51628541946411  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10473155975341797  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.00106191635132  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525846481323242  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.98851203918457  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10463237762451172  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.088491439819336  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526895523071289  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.098389148712158  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10468101501464844  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.13251304626465  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526847839355469  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.08909034729004  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10462188720703125  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.641955852508545  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530233383178711  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.134263038635254  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1047983169555664  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.425352096557617  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528564453125  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.15650510787964  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.104522705078125  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.52847719192505  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.036756135523319244 |0.015266545116901398 |0.41480904072523117 |9.15825366973877e-05 |0.7583098262548447 |0.006112575531005859 |
----------------------------------------------------------pseudo_mini_loss sum 1.4677033424377441
Total (block generation + training)time/epoch 93.39786812237331
Training time/epoch 39.262922048568726
Training time without block to device /epoch 38.77439260482788
Training time without total dataloading part /epoch 37.54884696006775
load block tensor time/epoch 1.1761963367462158
block to device time/epoch 0.4885294437408447
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  8793680
Number of first layer input nodes during this epoch:  4680429
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12180852890014648  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02384352684020996
range selection method range initialization spend 0.016443729400634766
time for parepare:  0.01855778694152832
local_output_nid generation:  0.0009276866912841797
local_in_edges_tensor generation:  0.005494594573974609
mini_batch_src_global generation:  0.0020728111267089844
r_  generation:  0.012163639068603516
local_output_nid generation:  0.0009827613830566406
local_in_edges_tensor generation:  0.0006558895111083984
mini_batch_src_global generation:  0.0016605854034423828
r_  generation:  0.010210990905761719
local_output_nid generation:  0.0009357929229736328
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.009483575820922852
local_output_nid generation:  0.0009152889251708984
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0011203289031982422
r_  generation:  0.00984501838684082
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005357265472412109
mini_batch_src_global generation:  0.0010018348693847656
r_  generation:  0.009555578231811523
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0005486011505126953
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.009537458419799805
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.0010974407196044922
r_  generation:  0.010308027267456055
local_output_nid generation:  0.00089263916015625
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0010874271392822266
r_  generation:  0.01009511947631836
local_output_nid generation:  0.0008766651153564453
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.001062631607055664
r_  generation:  0.010028600692749023
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0005583763122558594
mini_batch_src_global generation:  0.0011260509490966797
r_  generation:  0.010297536849975586
local_output_nid generation:  0.0008475780487060547
local_in_edges_tensor generation:  0.0005507469177246094
mini_batch_src_global generation:  0.0010676383972167969
r_  generation:  0.010038137435913086
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0005562305450439453
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.010454177856445312
local_output_nid generation:  0.0008537769317626953
local_in_edges_tensor generation:  0.0005452632904052734
mini_batch_src_global generation:  0.001081228256225586
r_  generation:  0.01014852523803711
local_output_nid generation:  0.0008456707000732422
local_in_edges_tensor generation:  0.0005576610565185547
mini_batch_src_global generation:  0.0010881423950195312
r_  generation:  0.009955406188964844
local_output_nid generation:  0.0008559226989746094
local_in_edges_tensor generation:  0.00054931640625
mini_batch_src_global generation:  0.0010824203491210938
r_  generation:  0.00995635986328125
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.0005412101745605469
mini_batch_src_global generation:  0.0010349750518798828
r_  generation:  0.010028600692749023
local_output_nid generation:  0.0008556842803955078
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.0010941028594970703
r_  generation:  0.010008573532104492
local_output_nid generation:  0.0008451938629150391
local_in_edges_tensor generation:  0.0005290508270263672
mini_batch_src_global generation:  0.0010752677917480469
r_  generation:  0.009974241256713867
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0005471706390380859
mini_batch_src_global generation:  0.001094818115234375
r_  generation:  0.010057210922241211
local_output_nid generation:  0.000843048095703125
local_in_edges_tensor generation:  0.000537872314453125
mini_batch_src_global generation:  0.0011479854583740234
r_  generation:  0.010086536407470703
local_output_nid generation:  0.0008459091186523438
local_in_edges_tensor generation:  0.0005297660827636719
mini_batch_src_global generation:  0.0010421276092529297
r_  generation:  0.009989500045776367
local_output_nid generation:  0.0008423328399658203
local_in_edges_tensor generation:  0.0005435943603515625
mini_batch_src_global generation:  0.001119375228881836
r_  generation:  0.010183334350585938
local_output_nid generation:  0.0008397102355957031
local_in_edges_tensor generation:  0.0005338191986083984
mini_batch_src_global generation:  0.0011518001556396484
r_  generation:  0.0101318359375
local_output_nid generation:  0.0008425712585449219
local_in_edges_tensor generation:  0.0005528926849365234
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.009717464447021484
local_output_nid generation:  0.0008394718170166016
local_in_edges_tensor generation:  0.0005483627319335938
mini_batch_src_global generation:  0.0010592937469482422
r_  generation:  0.009857892990112305
local_output_nid generation:  0.0008425712585449219
local_in_edges_tensor generation:  0.0005409717559814453
mini_batch_src_global generation:  0.001085042953491211
r_  generation:  0.010039567947387695
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.0005395412445068359
mini_batch_src_global generation:  0.0011420249938964844
r_  generation:  0.010319232940673828
local_output_nid generation:  0.0008490085601806641
local_in_edges_tensor generation:  0.0005700588226318359
mini_batch_src_global generation:  0.0011293888092041016
r_  generation:  0.010348081588745117
local_output_nid generation:  0.0008573532104492188
local_in_edges_tensor generation:  0.0005345344543457031
mini_batch_src_global generation:  0.001071929931640625
r_  generation:  0.009855985641479492
local_output_nid generation:  0.0008535385131835938
local_in_edges_tensor generation:  0.0005390644073486328
mini_batch_src_global generation:  0.0010733604431152344
r_  generation:  0.009965658187866211
local_output_nid generation:  0.0008475780487060547
local_in_edges_tensor generation:  0.0005400180816650391
mini_batch_src_global generation:  0.0010914802551269531
r_  generation:  0.00988316535949707
local_output_nid generation:  0.0008370876312255859
local_in_edges_tensor generation:  0.0005271434783935547
mini_batch_src_global generation:  0.0010516643524169922
r_  generation:  0.010020971298217773
----------------------check_connections_block total spend ----------------------------- 0.5055718421936035
generate_one_block  0.020517349243164062
generate_one_block  0.019662857055664062
generate_one_block  0.017282485961914062
generate_one_block  0.017591238021850586
generate_one_block  0.016813278198242188
generate_one_block  0.01672673225402832
generate_one_block  0.017935991287231445
generate_one_block  0.01743793487548828
generate_one_block  0.01727747917175293
generate_one_block  0.01777505874633789
generate_one_block  0.016913175582885742
generate_one_block  0.018155336380004883
generate_one_block  0.017141342163085938
generate_one_block  0.016963958740234375
generate_one_block  0.016756772994995117
generate_one_block  0.016988754272460938
generate_one_block  0.016846418380737305
generate_one_block  0.016908645629882812
generate_one_block  0.01683664321899414
generate_one_block  0.017096757888793945
generate_one_block  0.016936779022216797
generate_one_block  0.017401456832885742
generate_one_block  0.019353389739990234
generate_one_block  0.01675128936767578
generate_one_block  0.016816377639770508
generate_one_block  0.0171506404876709
generate_one_block  0.017405033111572266
generate_one_block  0.017424583435058594
generate_one_block  0.016550540924072266
generate_one_block  0.01683497428894043
generate_one_block  0.016666650772094727
generate_one_block  0.016742706298828125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03630208969116211
gen group dst list time:  0.025443315505981445
time for parepare:  0.021512508392333984
local_output_nid generation:  0.00534820556640625
local_in_edges_tensor generation:  0.016190528869628906
mini_batch_src_global generation:  0.02156376838684082
r_  generation:  0.17675352096557617
local_output_nid generation:  0.007331132888793945
local_in_edges_tensor generation:  0.009982824325561523
mini_batch_src_global generation:  0.02137160301208496
r_  generation:  0.14872360229492188
local_output_nid generation:  0.0075588226318359375
local_in_edges_tensor generation:  0.03200888633728027
mini_batch_src_global generation:  0.019649028778076172
r_  generation:  0.14530515670776367
local_output_nid generation:  0.007859230041503906
local_in_edges_tensor generation:  0.007659435272216797
mini_batch_src_global generation:  0.02051067352294922
r_  generation:  0.15282821655273438
local_output_nid generation:  0.008162975311279297
local_in_edges_tensor generation:  0.010099411010742188
mini_batch_src_global generation:  0.018884658813476562
r_  generation:  0.1498119831085205
local_output_nid generation:  0.008204221725463867
local_in_edges_tensor generation:  0.0076446533203125
mini_batch_src_global generation:  0.019321203231811523
r_  generation:  0.14811992645263672
local_output_nid generation:  0.008852005004882812
local_in_edges_tensor generation:  0.009235858917236328
mini_batch_src_global generation:  0.02053976058959961
r_  generation:  0.1604292392730713
local_output_nid generation:  0.008387088775634766
local_in_edges_tensor generation:  0.007996559143066406
mini_batch_src_global generation:  0.020081043243408203
r_  generation:  0.15623235702514648
local_output_nid generation:  0.008383512496948242
local_in_edges_tensor generation:  0.008670330047607422
mini_batch_src_global generation:  0.019617319107055664
r_  generation:  0.1575155258178711
local_output_nid generation:  0.00871419906616211
local_in_edges_tensor generation:  0.008729219436645508
mini_batch_src_global generation:  0.03024744987487793
r_  generation:  0.17533636093139648
local_output_nid generation:  0.013228178024291992
local_in_edges_tensor generation:  0.010596275329589844
mini_batch_src_global generation:  0.021723031997680664
r_  generation:  0.16827940940856934
local_output_nid generation:  0.014758110046386719
local_in_edges_tensor generation:  0.011065959930419922
mini_batch_src_global generation:  0.023043155670166016
r_  generation:  0.1756608486175537
local_output_nid generation:  0.01492929458618164
local_in_edges_tensor generation:  0.011857271194458008
mini_batch_src_global generation:  0.024456024169921875
r_  generation:  0.15650701522827148
local_output_nid generation:  0.009614706039428711
local_in_edges_tensor generation:  0.011123418807983398
mini_batch_src_global generation:  0.02076125144958496
r_  generation:  0.1548922061920166
local_output_nid generation:  0.00899505615234375
local_in_edges_tensor generation:  0.008634567260742188
mini_batch_src_global generation:  0.019433021545410156
r_  generation:  0.1531529426574707
local_output_nid generation:  0.008984088897705078
local_in_edges_tensor generation:  0.00822138786315918
mini_batch_src_global generation:  0.019936323165893555
r_  generation:  0.15735864639282227
local_output_nid generation:  0.008778095245361328
local_in_edges_tensor generation:  0.00870823860168457
mini_batch_src_global generation:  0.019461393356323242
r_  generation:  0.15706205368041992
local_output_nid generation:  0.008869647979736328
local_in_edges_tensor generation:  0.007970094680786133
mini_batch_src_global generation:  0.022686481475830078
r_  generation:  0.15850257873535156
local_output_nid generation:  0.008822202682495117
local_in_edges_tensor generation:  0.009748697280883789
mini_batch_src_global generation:  0.019589662551879883
r_  generation:  0.1924598217010498
local_output_nid generation:  0.014145851135253906
local_in_edges_tensor generation:  0.012205839157104492
mini_batch_src_global generation:  0.027521133422851562
r_  generation:  0.16025161743164062
local_output_nid generation:  0.011103630065917969
local_in_edges_tensor generation:  0.008517265319824219
mini_batch_src_global generation:  0.019666671752929688
r_  generation:  0.15868234634399414
local_output_nid generation:  0.009749889373779297
local_in_edges_tensor generation:  0.008006572723388672
mini_batch_src_global generation:  0.01964402198791504
r_  generation:  0.1579418182373047
local_output_nid generation:  0.009250640869140625
local_in_edges_tensor generation:  0.00797891616821289
mini_batch_src_global generation:  0.01945185661315918
r_  generation:  0.15788865089416504
local_output_nid generation:  0.008773565292358398
local_in_edges_tensor generation:  0.008336782455444336
mini_batch_src_global generation:  0.019209623336791992
r_  generation:  0.15113234519958496
local_output_nid generation:  0.008845090866088867
local_in_edges_tensor generation:  0.008078575134277344
mini_batch_src_global generation:  0.027385473251342773
r_  generation:  0.15848827362060547
local_output_nid generation:  0.008904695510864258
local_in_edges_tensor generation:  0.008500099182128906
mini_batch_src_global generation:  0.020764827728271484
r_  generation:  0.1596391201019287
local_output_nid generation:  0.008951187133789062
local_in_edges_tensor generation:  0.009567975997924805
mini_batch_src_global generation:  0.019683361053466797
r_  generation:  0.16170024871826172
local_output_nid generation:  0.008951902389526367
local_in_edges_tensor generation:  0.008797168731689453
mini_batch_src_global generation:  0.020110130310058594
r_  generation:  0.1630561351776123
local_output_nid generation:  0.008625507354736328
local_in_edges_tensor generation:  0.007848501205444336
mini_batch_src_global generation:  0.01919698715209961
r_  generation:  0.1561582088470459
local_output_nid generation:  0.008786916732788086
local_in_edges_tensor generation:  0.011841535568237305
mini_batch_src_global generation:  0.019741058349609375
r_  generation:  0.1554100513458252
local_output_nid generation:  0.008664846420288086
local_in_edges_tensor generation:  0.008021831512451172
mini_batch_src_global generation:  0.019031286239624023
r_  generation:  0.15616202354431152
local_output_nid generation:  0.008549928665161133
local_in_edges_tensor generation:  0.007964372634887695
mini_batch_src_global generation:  0.019363880157470703
r_  generation:  0.15488362312316895
----------------------check_connections_block total spend ----------------------------- 7.6194353103637695
generate_one_block  0.21746420860290527
generate_one_block  0.20474934577941895
generate_one_block  0.19508719444274902
generate_one_block  0.20295500755310059
generate_one_block  0.21607685089111328
generate_one_block  0.19923853874206543
generate_one_block  0.21185755729675293
generate_one_block  0.20543980598449707
generate_one_block  0.20616841316223145
generate_one_block  0.20890283584594727
generate_one_block  0.1967310905456543
generate_one_block  0.21004867553710938
generate_one_block  0.2016282081604004
generate_one_block  0.2063131332397461
generate_one_block  0.19887018203735352
generate_one_block  0.20520710945129395
generate_one_block  0.21080970764160156
generate_one_block  0.2124471664428711
generate_one_block  0.2080683708190918
generate_one_block  0.2133641242980957
generate_one_block  0.21079206466674805
generate_one_block  0.20771574974060059
generate_one_block  0.20241117477416992
generate_one_block  0.19635510444641113
generate_one_block  0.20032024383544922
generate_one_block  0.20626378059387207
generate_one_block  0.20693087577819824
generate_one_block  0.20864105224609375
generate_one_block  0.19584894180297852
generate_one_block  0.1988811492919922
generate_one_block  0.20053720474243164
generate_one_block  0.2037205696105957
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03322768211364746
gen group dst list time:  0.10782480239868164
time for parepare:  0.01854395866394043
local_output_nid generation:  0.023561716079711914
local_in_edges_tensor generation:  0.04620218276977539
mini_batch_src_global generation:  0.03782296180725098
r_  generation:  0.4046757221221924
local_output_nid generation:  0.028183698654174805
local_in_edges_tensor generation:  0.031868934631347656
mini_batch_src_global generation:  0.04853987693786621
r_  generation:  0.40175318717956543
local_output_nid generation:  0.028510332107543945
local_in_edges_tensor generation:  0.033760786056518555
mini_batch_src_global generation:  0.04636049270629883
r_  generation:  0.4095947742462158
local_output_nid generation:  0.028618574142456055
local_in_edges_tensor generation:  0.024725914001464844
mini_batch_src_global generation:  0.050835609436035156
r_  generation:  0.41484975814819336
local_output_nid generation:  0.028556346893310547
local_in_edges_tensor generation:  0.026558637619018555
mini_batch_src_global generation:  0.047023773193359375
r_  generation:  0.41642069816589355
local_output_nid generation:  0.028536558151245117
local_in_edges_tensor generation:  0.0316920280456543
mini_batch_src_global generation:  0.04918384552001953
r_  generation:  0.41119813919067383
local_output_nid generation:  0.028002023696899414
local_in_edges_tensor generation:  0.03130531311035156
mini_batch_src_global generation:  0.04950857162475586
r_  generation:  0.42712998390197754
local_output_nid generation:  0.02773451805114746
local_in_edges_tensor generation:  0.028514623641967773
mini_batch_src_global generation:  0.05005693435668945
r_  generation:  0.41906237602233887
local_output_nid generation:  0.02753591537475586
local_in_edges_tensor generation:  0.029341459274291992
mini_batch_src_global generation:  0.04816293716430664
r_  generation:  0.42142820358276367
local_output_nid generation:  0.02771902084350586
local_in_edges_tensor generation:  0.03087615966796875
mini_batch_src_global generation:  0.0524744987487793
r_  generation:  0.43024492263793945
local_output_nid generation:  0.03034234046936035
local_in_edges_tensor generation:  0.031019210815429688
mini_batch_src_global generation:  0.04797482490539551
r_  generation:  0.4107704162597656
local_output_nid generation:  0.02865743637084961
local_in_edges_tensor generation:  0.025712013244628906
mini_batch_src_global generation:  0.049375057220458984
r_  generation:  0.41393446922302246
local_output_nid generation:  0.02818751335144043
local_in_edges_tensor generation:  0.02615809440612793
mini_batch_src_global generation:  0.04908871650695801
r_  generation:  0.4107048511505127
local_output_nid generation:  0.027944087982177734
local_in_edges_tensor generation:  0.026073932647705078
mini_batch_src_global generation:  0.049654245376586914
r_  generation:  0.40993547439575195
local_output_nid generation:  0.02789759635925293
local_in_edges_tensor generation:  0.025763988494873047
mini_batch_src_global generation:  0.047541141510009766
r_  generation:  0.41458821296691895
local_output_nid generation:  0.02816462516784668
local_in_edges_tensor generation:  0.02547311782836914
mini_batch_src_global generation:  0.04985404014587402
r_  generation:  0.4342191219329834
local_output_nid generation:  0.027834177017211914
local_in_edges_tensor generation:  0.025639772415161133
mini_batch_src_global generation:  0.05180025100708008
r_  generation:  0.4134194850921631
local_output_nid generation:  0.02809309959411621
local_in_edges_tensor generation:  0.026931285858154297
mini_batch_src_global generation:  0.04984545707702637
r_  generation:  0.41054511070251465
local_output_nid generation:  0.028097867965698242
local_in_edges_tensor generation:  0.028206825256347656
mini_batch_src_global generation:  0.04798555374145508
r_  generation:  0.4144868850708008
local_output_nid generation:  0.028090238571166992
local_in_edges_tensor generation:  0.027468442916870117
mini_batch_src_global generation:  0.053173065185546875
r_  generation:  0.41106104850769043
local_output_nid generation:  0.02821516990661621
local_in_edges_tensor generation:  0.02501368522644043
mini_batch_src_global generation:  0.048802852630615234
r_  generation:  0.4161379337310791
local_output_nid generation:  0.027814388275146484
local_in_edges_tensor generation:  0.030574798583984375
mini_batch_src_global generation:  0.049553632736206055
r_  generation:  0.41019773483276367
local_output_nid generation:  0.028326034545898438
local_in_edges_tensor generation:  0.027175426483154297
mini_batch_src_global generation:  0.0508580207824707
r_  generation:  0.4197957515716553
local_output_nid generation:  0.02895331382751465
local_in_edges_tensor generation:  0.0305936336517334
mini_batch_src_global generation:  0.04963111877441406
r_  generation:  0.41121411323547363
local_output_nid generation:  0.028258800506591797
local_in_edges_tensor generation:  0.025440692901611328
mini_batch_src_global generation:  0.04958605766296387
r_  generation:  0.4190988540649414
local_output_nid generation:  0.02841925621032715
local_in_edges_tensor generation:  0.02683234214782715
mini_batch_src_global generation:  0.051230430603027344
r_  generation:  0.4210824966430664
local_output_nid generation:  0.028368234634399414
local_in_edges_tensor generation:  0.033865928649902344
mini_batch_src_global generation:  0.04891562461853027
r_  generation:  0.42372775077819824
local_output_nid generation:  0.028255701065063477
local_in_edges_tensor generation:  0.02677750587463379
mini_batch_src_global generation:  0.051941871643066406
r_  generation:  0.41997742652893066
local_output_nid generation:  0.029836654663085938
local_in_edges_tensor generation:  0.028005599975585938
mini_batch_src_global generation:  0.04778027534484863
r_  generation:  0.4158353805541992
local_output_nid generation:  0.028214454650878906
local_in_edges_tensor generation:  0.02719712257385254
mini_batch_src_global generation:  0.05279111862182617
r_  generation:  0.415024995803833
local_output_nid generation:  0.03038191795349121
local_in_edges_tensor generation:  0.024890661239624023
mini_batch_src_global generation:  0.05886363983154297
r_  generation:  0.4221377372741699
local_output_nid generation:  0.028862476348876953
local_in_edges_tensor generation:  0.029440641403198242
mini_batch_src_global generation:  0.05014777183532715
r_  generation:  0.4116373062133789
----------------------check_connections_block total spend ----------------------------- 19.7199969291687
generate_one_block  0.5648272037506104
generate_one_block  0.5505132675170898
generate_one_block  0.5430378913879395
generate_one_block  0.5531501770019531
generate_one_block  0.6571164131164551
generate_one_block  0.5457978248596191
generate_one_block  0.5572538375854492
generate_one_block  0.5556411743164062
generate_one_block  0.5499558448791504
generate_one_block  0.5751056671142578
generate_one_block  0.5438475608825684
generate_one_block  0.5576181411743164
generate_one_block  0.5512783527374268
generate_one_block  0.5496976375579834
generate_one_block  0.5535986423492432
generate_one_block  0.5538585186004639
generate_one_block  0.5475032329559326
generate_one_block  0.5534932613372803
generate_one_block  0.5560715198516846
generate_one_block  0.5536766052246094
generate_one_block  0.5509884357452393
generate_one_block  0.5456631183624268
generate_one_block  0.557363748550415
generate_one_block  0.5426068305969238
generate_one_block  0.5683290958404541
generate_one_block  0.5635442733764648
generate_one_block  0.5597748756408691
generate_one_block  0.5581283569335938
generate_one_block  0.5478990077972412
generate_one_block  0.5496132373809814
generate_one_block  0.5527870655059814
generate_one_block  0.55857253074646
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12180852890014648  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

connection checking time:  27.33943223953247
block generation total time  24.39815878868103
average batch blocks generation time:  0.7624424621462822
block dataloader generation time/epoch 54.37291330099106
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10533380508422852  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.275174617767334  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10473775863647461  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.03261089324951  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1051793098449707  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.57881259918213  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10487174987792969  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.10446071624756  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520553588867188  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.740241527557373  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10469627380371094  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.603947639465332  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10533952713012695  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.358080863952637  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10476922988891602  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.123252391815186  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528135299682617  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.0960431098938  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10494136810302734  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.259068489074707  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520172119140625  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.688968181610107  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10488080978393555  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.30794620513916  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523176193237305  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.819103240966797  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10451793670654297  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.96892023086548  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520458221435547  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.704753398895264  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10465145111083984  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.821308135986328  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523223876953125  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.798502922058105  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10467767715454102  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.031163215637207  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524654388427734  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.916690826416016  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10477066040039062  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.029454231262207  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525703430175781  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.966102123260498  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1044468879699707  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.93234348297119  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524463653564453  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.94558620452881  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10435724258422852  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.48546600341797  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522031784057617  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.78385829925537  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10473203659057617  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.046152114868164  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526847839355469  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.043228149414062  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10473871231079102  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.152642250061035  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518121719360352  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.595276832580566  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10467672348022461  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.745944499969482  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521745681762695  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.77160882949829  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10465431213378906  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.86718511581421  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034540072083473206 |0.01600012183189392 |0.41489430516958237 |9.390711784362793e-05 |0.7567526251077652 |0.004514932632446289 |
----------------------------------------------------------pseudo_mini_loss sum 1.4401123523712158
Total (block generation + training)time/epoch 93.45358151197433
Training time/epoch 39.1742103099823
Training time without block to device /epoch 38.662206411361694
Training time without total dataloading part /epoch 37.500221729278564
load block tensor time/epoch 1.1052823066711426
block to device time/epoch 0.5120038986206055
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  8796418
Number of first layer input nodes during this epoch:  4680890
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12326192855834961  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028979063034057617
range selection method range initialization spend 0.014166116714477539
time for parepare:  0.022125720977783203
local_output_nid generation:  0.0012013912200927734
local_in_edges_tensor generation:  0.004973649978637695
mini_batch_src_global generation:  0.0021300315856933594
r_  generation:  0.010347366333007812
local_output_nid generation:  0.0009877681732177734
local_in_edges_tensor generation:  0.000705718994140625
mini_batch_src_global generation:  0.0019404888153076172
r_  generation:  0.01107168197631836
local_output_nid generation:  0.0010192394256591797
local_in_edges_tensor generation:  0.0006825923919677734
mini_batch_src_global generation:  0.0014836788177490234
r_  generation:  0.0104522705078125
local_output_nid generation:  0.0010237693786621094
local_in_edges_tensor generation:  0.0006444454193115234
mini_batch_src_global generation:  0.0013294219970703125
r_  generation:  0.009987115859985352
local_output_nid generation:  0.0010051727294921875
local_in_edges_tensor generation:  0.0006556510925292969
mini_batch_src_global generation:  0.0013484954833984375
r_  generation:  0.010222673416137695
local_output_nid generation:  0.0010137557983398438
local_in_edges_tensor generation:  0.0006687641143798828
mini_batch_src_global generation:  0.0013687610626220703
r_  generation:  0.010584592819213867
local_output_nid generation:  0.0010640621185302734
local_in_edges_tensor generation:  0.0006561279296875
mini_batch_src_global generation:  0.0013651847839355469
r_  generation:  0.010303258895874023
local_output_nid generation:  0.0011034011840820312
local_in_edges_tensor generation:  0.0006608963012695312
mini_batch_src_global generation:  0.0013599395751953125
r_  generation:  0.01055288314819336
local_output_nid generation:  0.0010275840759277344
local_in_edges_tensor generation:  0.0006566047668457031
mini_batch_src_global generation:  0.0013234615325927734
r_  generation:  0.010126590728759766
local_output_nid generation:  0.0009970664978027344
local_in_edges_tensor generation:  0.0006306171417236328
mini_batch_src_global generation:  0.0013446807861328125
r_  generation:  0.010313749313354492
local_output_nid generation:  0.0010101795196533203
local_in_edges_tensor generation:  0.000640869140625
mini_batch_src_global generation:  0.001291036605834961
r_  generation:  0.010312080383300781
local_output_nid generation:  0.0010221004486083984
local_in_edges_tensor generation:  0.0006566047668457031
mini_batch_src_global generation:  0.0013365745544433594
r_  generation:  0.010378360748291016
local_output_nid generation:  0.001016855239868164
local_in_edges_tensor generation:  0.0006504058837890625
mini_batch_src_global generation:  0.0013148784637451172
r_  generation:  0.010484457015991211
local_output_nid generation:  0.0010023117065429688
local_in_edges_tensor generation:  0.0006325244903564453
mini_batch_src_global generation:  0.0014445781707763672
r_  generation:  0.010147809982299805
local_output_nid generation:  0.0010077953338623047
local_in_edges_tensor generation:  0.0006208419799804688
mini_batch_src_global generation:  0.0013241767883300781
r_  generation:  0.010472536087036133
local_output_nid generation:  0.0010309219360351562
local_in_edges_tensor generation:  0.0006506443023681641
mini_batch_src_global generation:  0.0015106201171875
r_  generation:  0.010933160781860352
local_output_nid generation:  0.0010464191436767578
local_in_edges_tensor generation:  0.0006492137908935547
mini_batch_src_global generation:  0.0013201236724853516
r_  generation:  0.01028752326965332
local_output_nid generation:  0.0010395050048828125
local_in_edges_tensor generation:  0.0006527900695800781
mini_batch_src_global generation:  0.0013163089752197266
r_  generation:  0.010278701782226562
local_output_nid generation:  0.0010323524475097656
local_in_edges_tensor generation:  0.0006406307220458984
mini_batch_src_global generation:  0.0013492107391357422
r_  generation:  0.021968364715576172
local_output_nid generation:  0.0013689994812011719
local_in_edges_tensor generation:  0.0007839202880859375
mini_batch_src_global generation:  0.002000093460083008
r_  generation:  0.011048078536987305
local_output_nid generation:  0.0010662078857421875
local_in_edges_tensor generation:  0.0005934238433837891
mini_batch_src_global generation:  0.0015516281127929688
r_  generation:  0.010823965072631836
local_output_nid generation:  0.0010149478912353516
local_in_edges_tensor generation:  0.0005629062652587891
mini_batch_src_global generation:  0.0012383460998535156
r_  generation:  0.010347843170166016
local_output_nid generation:  0.0009329319000244141
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.010362386703491211
local_output_nid generation:  0.0009281635284423828
local_in_edges_tensor generation:  0.0005927085876464844
mini_batch_src_global generation:  0.0013546943664550781
r_  generation:  0.010199308395385742
local_output_nid generation:  0.0009038448333740234
local_in_edges_tensor generation:  0.0005555152893066406
mini_batch_src_global generation:  0.0011327266693115234
r_  generation:  0.01050877571105957
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.0005552768707275391
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.00979924201965332
local_output_nid generation:  0.0009393692016601562
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.001161813735961914
r_  generation:  0.010526895523071289
local_output_nid generation:  0.0009315013885498047
local_in_edges_tensor generation:  0.0006029605865478516
mini_batch_src_global generation:  0.0011162757873535156
r_  generation:  0.010151147842407227
local_output_nid generation:  0.0009262561798095703
local_in_edges_tensor generation:  0.0005488395690917969
mini_batch_src_global generation:  0.0010976791381835938
r_  generation:  0.010275602340698242
local_output_nid generation:  0.0009195804595947266
local_in_edges_tensor generation:  0.0005505084991455078
mini_batch_src_global generation:  0.001142263412475586
r_  generation:  0.009912967681884766
local_output_nid generation:  0.0009255409240722656
local_in_edges_tensor generation:  0.0005292892456054688
mini_batch_src_global generation:  0.0011723041534423828
r_  generation:  0.010985136032104492
local_output_nid generation:  0.0009171962738037109
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.0012297630310058594
r_  generation:  0.012273311614990234
----------------------check_connections_block total spend ----------------------------- 0.5557308197021484
generate_one_block  0.023428916931152344
generate_one_block  0.020008325576782227
generate_one_block  0.018542051315307617
generate_one_block  0.017117977142333984
generate_one_block  0.01929306983947754
generate_one_block  0.017790555953979492
generate_one_block  0.017451047897338867
generate_one_block  0.017613887786865234
generate_one_block  0.016996383666992188
generate_one_block  0.017627954483032227
generate_one_block  0.019206523895263672
generate_one_block  0.017609834671020508
generate_one_block  0.017771482467651367
generate_one_block  0.017023801803588867
generate_one_block  0.017622947692871094
generate_one_block  0.017932415008544922
generate_one_block  0.01926136016845703
generate_one_block  0.017237424850463867
generate_one_block  0.017667770385742188
generate_one_block  0.01769876480102539
generate_one_block  0.018332719802856445
generate_one_block  0.01743149757385254
generate_one_block  0.02234339714050293
generate_one_block  0.01725029945373535
generate_one_block  0.01732611656188965
generate_one_block  0.016576766967773438
generate_one_block  0.01771688461303711
generate_one_block  0.017196178436279297
generate_one_block  0.018175840377807617
generate_one_block  0.01690363883972168
generate_one_block  0.018535852432250977
generate_one_block  0.018256664276123047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04596543312072754
gen group dst list time:  0.026391029357910156
time for parepare:  0.023284435272216797
local_output_nid generation:  0.0054776668548583984
local_in_edges_tensor generation:  0.015087127685546875
mini_batch_src_global generation:  0.016620874404907227
r_  generation:  0.13785767555236816
local_output_nid generation:  0.007463932037353516
local_in_edges_tensor generation:  0.009656429290771484
mini_batch_src_global generation:  0.018513917922973633
r_  generation:  0.1497488021850586
local_output_nid generation:  0.00787806510925293
local_in_edges_tensor generation:  0.03303933143615723
mini_batch_src_global generation:  0.02047252655029297
r_  generation:  0.15794157981872559
local_output_nid generation:  0.007831811904907227
local_in_edges_tensor generation:  0.011188983917236328
mini_batch_src_global generation:  0.01793980598449707
r_  generation:  0.15088820457458496
local_output_nid generation:  0.011109590530395508
local_in_edges_tensor generation:  0.010396480560302734
mini_batch_src_global generation:  0.018704652786254883
r_  generation:  0.15767502784729004
local_output_nid generation:  0.009220123291015625
local_in_edges_tensor generation:  0.01134037971496582
mini_batch_src_global generation:  0.019100189208984375
r_  generation:  0.16084861755371094
local_output_nid generation:  0.009636878967285156
local_in_edges_tensor generation:  0.008719921112060547
mini_batch_src_global generation:  0.019246339797973633
r_  generation:  0.1645526885986328
local_output_nid generation:  0.00967717170715332
local_in_edges_tensor generation:  0.00849771499633789
mini_batch_src_global generation:  0.019761323928833008
r_  generation:  0.15417861938476562
local_output_nid generation:  0.008411407470703125
local_in_edges_tensor generation:  0.009069204330444336
mini_batch_src_global generation:  0.018411636352539062
r_  generation:  0.1509535312652588
local_output_nid generation:  0.008855819702148438
local_in_edges_tensor generation:  0.008141279220581055
mini_batch_src_global generation:  0.01948714256286621
r_  generation:  0.15337014198303223
local_output_nid generation:  0.009027481079101562
local_in_edges_tensor generation:  0.009203910827636719
mini_batch_src_global generation:  0.018798112869262695
r_  generation:  0.18641233444213867
local_output_nid generation:  0.009007930755615234
local_in_edges_tensor generation:  0.00870823860168457
mini_batch_src_global generation:  0.02202463150024414
r_  generation:  0.19787287712097168
local_output_nid generation:  0.008992433547973633
local_in_edges_tensor generation:  0.009447813034057617
mini_batch_src_global generation:  0.02050614356994629
r_  generation:  0.15738439559936523
local_output_nid generation:  0.008980989456176758
local_in_edges_tensor generation:  0.008495092391967773
mini_batch_src_global generation:  0.018922805786132812
r_  generation:  0.14966607093811035
local_output_nid generation:  0.009165763854980469
local_in_edges_tensor generation:  0.008362293243408203
mini_batch_src_global generation:  0.04232454299926758
r_  generation:  0.19745421409606934
local_output_nid generation:  0.009470701217651367
local_in_edges_tensor generation:  0.009517669677734375
mini_batch_src_global generation:  0.023406267166137695
r_  generation:  0.16240167617797852
local_output_nid generation:  0.008734464645385742
local_in_edges_tensor generation:  0.00980067253112793
mini_batch_src_global generation:  0.02109813690185547
r_  generation:  0.15166854858398438
local_output_nid generation:  0.009168863296508789
local_in_edges_tensor generation:  0.008226156234741211
mini_batch_src_global generation:  0.021753311157226562
r_  generation:  0.15548253059387207
local_output_nid generation:  0.009200096130371094
local_in_edges_tensor generation:  0.008536815643310547
mini_batch_src_global generation:  0.021552324295043945
r_  generation:  0.16071224212646484
local_output_nid generation:  0.009366512298583984
local_in_edges_tensor generation:  0.008421659469604492
mini_batch_src_global generation:  0.021776199340820312
r_  generation:  0.15850329399108887
local_output_nid generation:  0.00962972640991211
local_in_edges_tensor generation:  0.009611368179321289
mini_batch_src_global generation:  0.020836830139160156
r_  generation:  0.16398930549621582
local_output_nid generation:  0.009206295013427734
local_in_edges_tensor generation:  0.008287906646728516
mini_batch_src_global generation:  0.01983046531677246
r_  generation:  0.15796422958374023
local_output_nid generation:  0.009218215942382812
local_in_edges_tensor generation:  0.008419275283813477
mini_batch_src_global generation:  0.01885247230529785
r_  generation:  0.15438032150268555
local_output_nid generation:  0.009134769439697266
local_in_edges_tensor generation:  0.00802922248840332
mini_batch_src_global generation:  0.01861095428466797
r_  generation:  0.15263128280639648
local_output_nid generation:  0.010916948318481445
local_in_edges_tensor generation:  0.008278608322143555
mini_batch_src_global generation:  0.018514156341552734
r_  generation:  0.15796828269958496
local_output_nid generation:  0.008913993835449219
local_in_edges_tensor generation:  0.007902860641479492
mini_batch_src_global generation:  0.018468379974365234
r_  generation:  0.15503835678100586
local_output_nid generation:  0.009427547454833984
local_in_edges_tensor generation:  0.008241891860961914
mini_batch_src_global generation:  0.019270658493041992
r_  generation:  0.16706514358520508
local_output_nid generation:  0.009055614471435547
local_in_edges_tensor generation:  0.011341571807861328
mini_batch_src_global generation:  0.019193410873413086
r_  generation:  0.1568441390991211
local_output_nid generation:  0.009281396865844727
local_in_edges_tensor generation:  0.008649826049804688
mini_batch_src_global generation:  0.019510746002197266
r_  generation:  0.1574420928955078
local_output_nid generation:  0.009148597717285156
local_in_edges_tensor generation:  0.008876562118530273
mini_batch_src_global generation:  0.020346403121948242
r_  generation:  0.15543222427368164
local_output_nid generation:  0.011671781539916992
local_in_edges_tensor generation:  0.011390209197998047
mini_batch_src_global generation:  0.02066659927368164
r_  generation:  0.17288756370544434
local_output_nid generation:  0.009630441665649414
local_in_edges_tensor generation:  0.009053945541381836
mini_batch_src_global generation:  0.020955324172973633
r_  generation:  0.16618919372558594
----------------------check_connections_block total spend ----------------------------- 7.623718500137329
generate_one_block  0.21814823150634766
generate_one_block  0.20716404914855957
generate_one_block  0.21225571632385254
generate_one_block  0.19864487648010254
generate_one_block  0.22225284576416016
generate_one_block  0.20887184143066406
generate_one_block  0.20006322860717773
generate_one_block  0.20513105392456055
generate_one_block  0.1960761547088623
generate_one_block  0.20269083976745605
generate_one_block  0.20127201080322266
generate_one_block  0.20224809646606445
generate_one_block  0.2090439796447754
generate_one_block  0.2021946907043457
generate_one_block  0.22499346733093262
generate_one_block  0.2149367332458496
generate_one_block  0.19701123237609863
generate_one_block  0.20479059219360352
generate_one_block  0.20928120613098145
generate_one_block  0.21269536018371582
generate_one_block  0.2163689136505127
generate_one_block  0.20981407165527344
generate_one_block  0.2014782428741455
generate_one_block  0.20041394233703613
generate_one_block  0.20739459991455078
generate_one_block  0.1972346305847168
generate_one_block  0.21020913124084473
generate_one_block  0.20024347305297852
generate_one_block  0.20358729362487793
generate_one_block  0.2004685401916504
generate_one_block  0.2203822135925293
generate_one_block  0.21118402481079102
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035002946853637695
gen group dst list time:  0.11191153526306152
time for parepare:  0.020596027374267578
local_output_nid generation:  0.024689197540283203
local_in_edges_tensor generation:  0.04781603813171387
mini_batch_src_global generation:  0.03950667381286621
r_  generation:  0.40987420082092285
local_output_nid generation:  0.030294179916381836
local_in_edges_tensor generation:  0.031935930252075195
mini_batch_src_global generation:  0.04872560501098633
r_  generation:  0.40317225456237793
local_output_nid generation:  0.029648542404174805
local_in_edges_tensor generation:  0.028163433074951172
mini_batch_src_global generation:  0.04674553871154785
r_  generation:  0.42325639724731445
local_output_nid generation:  0.029568910598754883
local_in_edges_tensor generation:  0.029166460037231445
mini_batch_src_global generation:  0.050003767013549805
r_  generation:  0.4075589179992676
local_output_nid generation:  0.030363798141479492
local_in_edges_tensor generation:  0.02537393569946289
mini_batch_src_global generation:  0.04780912399291992
r_  generation:  0.42400145530700684
local_output_nid generation:  0.030078887939453125
local_in_edges_tensor generation:  0.02869725227355957
mini_batch_src_global generation:  0.050222158432006836
r_  generation:  0.4133310317993164
local_output_nid generation:  0.02841019630432129
local_in_edges_tensor generation:  0.0258634090423584
mini_batch_src_global generation:  0.04739785194396973
r_  generation:  0.4203305244445801
local_output_nid generation:  0.028688669204711914
local_in_edges_tensor generation:  0.025299549102783203
mini_batch_src_global generation:  0.051679372787475586
r_  generation:  0.4125828742980957
local_output_nid generation:  0.028779268264770508
local_in_edges_tensor generation:  0.025568485260009766
mini_batch_src_global generation:  0.047223567962646484
r_  generation:  0.43277525901794434
local_output_nid generation:  0.029011011123657227
local_in_edges_tensor generation:  0.027356624603271484
mini_batch_src_global generation:  0.051613569259643555
r_  generation:  0.4167816638946533
local_output_nid generation:  0.02874016761779785
local_in_edges_tensor generation:  0.025762557983398438
mini_batch_src_global generation:  0.04738187789916992
r_  generation:  0.42264342308044434
local_output_nid generation:  0.028412818908691406
local_in_edges_tensor generation:  0.0252377986907959
mini_batch_src_global generation:  0.05038595199584961
r_  generation:  0.41056323051452637
local_output_nid generation:  0.028774023056030273
local_in_edges_tensor generation:  0.030819177627563477
mini_batch_src_global generation:  0.047850847244262695
r_  generation:  0.4254312515258789
local_output_nid generation:  0.028421401977539062
local_in_edges_tensor generation:  0.028706789016723633
mini_batch_src_global generation:  0.04935002326965332
r_  generation:  0.40851545333862305
local_output_nid generation:  0.028653383255004883
local_in_edges_tensor generation:  0.025252342224121094
mini_batch_src_global generation:  0.047449588775634766
r_  generation:  0.42403173446655273
local_output_nid generation:  0.02897191047668457
local_in_edges_tensor generation:  0.03087759017944336
mini_batch_src_global generation:  0.05044245719909668
r_  generation:  0.4163339138031006
local_output_nid generation:  0.028472423553466797
local_in_edges_tensor generation:  0.030794620513916016
mini_batch_src_global generation:  0.049475908279418945
r_  generation:  0.4225475788116455
local_output_nid generation:  0.030135154724121094
local_in_edges_tensor generation:  0.029250621795654297
mini_batch_src_global generation:  0.05117464065551758
r_  generation:  0.4161367416381836
local_output_nid generation:  0.029127120971679688
local_in_edges_tensor generation:  0.030734777450561523
mini_batch_src_global generation:  0.05019211769104004
r_  generation:  0.430905818939209
local_output_nid generation:  0.02921009063720703
local_in_edges_tensor generation:  0.02709221839904785
mini_batch_src_global generation:  0.04979300498962402
r_  generation:  0.42273831367492676
local_output_nid generation:  0.02938699722290039
local_in_edges_tensor generation:  0.0286257266998291
mini_batch_src_global generation:  0.04796409606933594
r_  generation:  0.4372262954711914
local_output_nid generation:  0.029537677764892578
local_in_edges_tensor generation:  0.032787322998046875
mini_batch_src_global generation:  0.05068254470825195
r_  generation:  0.4241502285003662
local_output_nid generation:  0.032199859619140625
local_in_edges_tensor generation:  0.02982187271118164
mini_batch_src_global generation:  0.04876089096069336
r_  generation:  0.4248948097229004
local_output_nid generation:  0.02858710289001465
local_in_edges_tensor generation:  0.026079416275024414
mini_batch_src_global generation:  0.04955267906188965
r_  generation:  0.41190671920776367
local_output_nid generation:  0.028615951538085938
local_in_edges_tensor generation:  0.02594733238220215
mini_batch_src_global generation:  0.0470423698425293
r_  generation:  0.42331767082214355
local_output_nid generation:  0.02823662757873535
local_in_edges_tensor generation:  0.02797555923461914
mini_batch_src_global generation:  0.04924297332763672
r_  generation:  0.4093003273010254
local_output_nid generation:  0.028630495071411133
local_in_edges_tensor generation:  0.025487184524536133
mini_batch_src_global generation:  0.04982709884643555
r_  generation:  0.4239959716796875
local_output_nid generation:  0.028325557708740234
local_in_edges_tensor generation:  0.0273129940032959
mini_batch_src_global generation:  0.04844546318054199
r_  generation:  0.41028690338134766
local_output_nid generation:  0.02867722511291504
local_in_edges_tensor generation:  0.025749921798706055
mini_batch_src_global generation:  0.04796910285949707
r_  generation:  0.41947126388549805
local_output_nid generation:  0.028532981872558594
local_in_edges_tensor generation:  0.027088165283203125
mini_batch_src_global generation:  0.04895663261413574
r_  generation:  0.4122140407562256
local_output_nid generation:  0.02877211570739746
local_in_edges_tensor generation:  0.028438329696655273
mini_batch_src_global generation:  0.04937028884887695
r_  generation:  0.43201589584350586
local_output_nid generation:  0.028592824935913086
local_in_edges_tensor generation:  0.027501344680786133
mini_batch_src_global generation:  0.050354957580566406
r_  generation:  0.4168517589569092
----------------------check_connections_block total spend ----------------------------- 19.80605912208557
generate_one_block  0.5654354095458984
generate_one_block  0.5502853393554688
generate_one_block  0.5595517158508301
generate_one_block  0.5534722805023193
generate_one_block  0.6596279144287109
generate_one_block  0.5616176128387451
generate_one_block  0.5536434650421143
generate_one_block  0.5540900230407715
generate_one_block  0.5518374443054199
generate_one_block  0.5576441287994385
generate_one_block  0.547762393951416
generate_one_block  0.5511322021484375
generate_one_block  0.5646662712097168
generate_one_block  0.5509848594665527
generate_one_block  0.5543034076690674
generate_one_block  0.558845043182373
generate_one_block  0.5477650165557861
generate_one_block  0.5524077415466309
generate_one_block  0.5697066783905029
generate_one_block  0.558783769607544
generate_one_block  0.5689470767974854
generate_one_block  0.5607619285583496
generate_one_block  0.5523667335510254
generate_one_block  0.5568959712982178
generate_one_block  0.5673861503601074
generate_one_block  0.5532591342926025
generate_one_block  0.5596084594726562
generate_one_block  0.5458061695098877
generate_one_block  0.5543868541717529
generate_one_block  0.5500080585479736
generate_one_block  0.5680141448974609
generate_one_block  0.5655741691589355
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12326192855834961  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

connection checking time:  27.4297776222229
block generation total time  24.55512285232544
average batch blocks generation time:  0.76734758913517
block dataloader generation time/epoch 54.442922592163086
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519075393676758  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.70862102508545  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10458517074584961  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.944854259490967  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530471801757812  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.246315956115723  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10440206527709961  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.714981079101562  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526609420776367  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.032599449157715  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10473012924194336  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.136635303497314  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522890090942383  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.77724838256836  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046609878540039  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.064585208892822  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518884658813477  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.631848335266113  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1050262451171875  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.88374948501587  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052083969116211  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.675829887390137  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10434150695800781  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.765007495880127  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527944564819336  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.09183979034424  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10463762283325195  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.55511474609375  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052851676940918  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.116053104400635  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10470199584960938  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.245554447174072  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10514402389526367  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.436984539031982  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10486412048339844  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.905064582824707  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527229309082031  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.084152221679688  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10489082336425781  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.08513116836548  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10534906387329102  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.328859329223633  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10489749908447266  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.1204776763916  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521697998046875  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.742144107818604  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10445117950439453  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.584497451782227  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521793365478516  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.7675199508667  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10426092147827148  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.422194957733154  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529947280883789  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.169387340545654  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10451221466064453  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.651545524597168  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523033142089844  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.83293914794922  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10444927215576172  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.664238452911377  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10539436340332031  GigaBytes
Max Memory Allocated: 17.538124084472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.580644130706787  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10469675064086914  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.241614818572998  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03442550450563431 |0.014133535325527191 |0.4168125167489052 |9.381771087646484e-05 |0.760858803987503 |0.006401777267456055 |
----------------------------------------------------------pseudo_mini_loss sum 1.4111766815185547
Total (block generation + training)time/epoch 93.54773256513808
Training time/epoch 39.297704458236694
Training time without block to device /epoch 38.845431327819824
Training time without total dataloading part /epoch 37.694886207580566
load block tensor time/epoch 1.1016161441802979
block to device time/epoch 0.4522731304168701
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  8793987
Number of first layer input nodes during this epoch:  4680059
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12295675277709961  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025229454040527344
range selection method range initialization spend 0.017019033432006836
time for parepare:  0.018019914627075195
local_output_nid generation:  0.0009734630584716797
local_in_edges_tensor generation:  0.005909442901611328
mini_batch_src_global generation:  0.0025484561920166016
r_  generation:  0.014535665512084961
local_output_nid generation:  0.0012805461883544922
local_in_edges_tensor generation:  0.0008051395416259766
mini_batch_src_global generation:  0.0016789436340332031
r_  generation:  0.011187314987182617
local_output_nid generation:  0.0011746883392333984
local_in_edges_tensor generation:  0.0006809234619140625
mini_batch_src_global generation:  0.0013759136199951172
r_  generation:  0.010339021682739258
local_output_nid generation:  0.0011577606201171875
local_in_edges_tensor generation:  0.0006771087646484375
mini_batch_src_global generation:  0.0012350082397460938
r_  generation:  0.010087728500366211
local_output_nid generation:  0.0011358261108398438
local_in_edges_tensor generation:  0.0006749629974365234
mini_batch_src_global generation:  0.0012328624725341797
r_  generation:  0.010075092315673828
local_output_nid generation:  0.0011310577392578125
local_in_edges_tensor generation:  0.0006647109985351562
mini_batch_src_global generation:  0.001293182373046875
r_  generation:  0.010541200637817383
local_output_nid generation:  0.0013120174407958984
local_in_edges_tensor generation:  0.0017135143280029297
mini_batch_src_global generation:  0.004389524459838867
r_  generation:  0.015418767929077148
local_output_nid generation:  0.0013561248779296875
local_in_edges_tensor generation:  0.0006287097930908203
mini_batch_src_global generation:  0.0014421939849853516
r_  generation:  0.011000871658325195
local_output_nid generation:  0.0010046958923339844
local_in_edges_tensor generation:  0.0005624294281005859
mini_batch_src_global generation:  0.0011930465698242188
r_  generation:  0.010181427001953125
local_output_nid generation:  0.000957489013671875
local_in_edges_tensor generation:  0.0005791187286376953
mini_batch_src_global generation:  0.0011286735534667969
r_  generation:  0.010390996932983398
local_output_nid generation:  0.0009109973907470703
local_in_edges_tensor generation:  0.00055694580078125
mini_batch_src_global generation:  0.0010962486267089844
r_  generation:  0.010000467300415039
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0005471706390380859
mini_batch_src_global generation:  0.0011057853698730469
r_  generation:  0.010310173034667969
local_output_nid generation:  0.0008785724639892578
local_in_edges_tensor generation:  0.000591278076171875
mini_batch_src_global generation:  0.0014183521270751953
r_  generation:  0.010270118713378906
local_output_nid generation:  0.0009107589721679688
local_in_edges_tensor generation:  0.0006134510040283203
mini_batch_src_global generation:  0.001127481460571289
r_  generation:  0.010067462921142578
local_output_nid generation:  0.00087738037109375
local_in_edges_tensor generation:  0.0005571842193603516
mini_batch_src_global generation:  0.0011348724365234375
r_  generation:  0.010339021682739258
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0005719661712646484
mini_batch_src_global generation:  0.001130819320678711
r_  generation:  0.010475397109985352
local_output_nid generation:  0.0008552074432373047
local_in_edges_tensor generation:  0.0005376338958740234
mini_batch_src_global generation:  0.0011320114135742188
r_  generation:  0.010277748107910156
local_output_nid generation:  0.0008571147918701172
local_in_edges_tensor generation:  0.0005502700805664062
mini_batch_src_global generation:  0.0010824203491210938
r_  generation:  0.009785890579223633
local_output_nid generation:  0.0008463859558105469
local_in_edges_tensor generation:  0.0005369186401367188
mini_batch_src_global generation:  0.0010495185852050781
r_  generation:  0.009857177734375
local_output_nid generation:  0.0008563995361328125
local_in_edges_tensor generation:  0.0005891323089599609
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.010228872299194336
local_output_nid generation:  0.0008454322814941406
local_in_edges_tensor generation:  0.0005490779876708984
mini_batch_src_global generation:  0.0011706352233886719
r_  generation:  0.010116100311279297
local_output_nid generation:  0.0008454322814941406
local_in_edges_tensor generation:  0.0005998611450195312
mini_batch_src_global generation:  0.0011768341064453125
r_  generation:  0.010423421859741211
local_output_nid generation:  0.0008521080017089844
local_in_edges_tensor generation:  0.0005314350128173828
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.010020256042480469
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.00055694580078125
mini_batch_src_global generation:  0.0011096000671386719
r_  generation:  0.010387420654296875
local_output_nid generation:  0.0008566379547119141
local_in_edges_tensor generation:  0.0005400180816650391
mini_batch_src_global generation:  0.0010905265808105469
r_  generation:  0.009962320327758789
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0005629062652587891
mini_batch_src_global generation:  0.0010840892791748047
r_  generation:  0.010312080383300781
local_output_nid generation:  0.0008413791656494141
local_in_edges_tensor generation:  0.0005369186401367188
mini_batch_src_global generation:  0.0010635852813720703
r_  generation:  0.009838581085205078
local_output_nid generation:  0.0008630752563476562
local_in_edges_tensor generation:  0.0005533695220947266
mini_batch_src_global generation:  0.0011038780212402344
r_  generation:  0.010219573974609375
local_output_nid generation:  0.0008313655853271484
local_in_edges_tensor generation:  0.0005381107330322266
mini_batch_src_global generation:  0.0011451244354248047
r_  generation:  0.009910821914672852
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0005643367767333984
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.010257959365844727
local_output_nid generation:  0.0008394718170166016
local_in_edges_tensor generation:  0.0005586147308349609
mini_batch_src_global generation:  0.0011341571807861328
r_  generation:  0.010416746139526367
local_output_nid generation:  0.0008869171142578125
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.0013155937194824219
r_  generation:  0.010028839111328125
----------------------check_connections_block total spend ----------------------------- 0.5386428833007812
generate_one_block  0.02048802375793457
generate_one_block  0.01991868019104004
generate_one_block  0.018390893936157227
generate_one_block  0.017702817916870117
generate_one_block  0.017494916915893555
generate_one_block  0.017784833908081055
generate_one_block  0.017714977264404297
generate_one_block  0.018404483795166016
generate_one_block  0.017597436904907227
generate_one_block  0.01789236068725586
generate_one_block  0.016945838928222656
generate_one_block  0.01806330680847168
generate_one_block  0.017605304718017578
generate_one_block  0.01729726791381836
generate_one_block  0.017963647842407227
generate_one_block  0.017828941345214844
generate_one_block  0.01760101318359375
generate_one_block  0.016803741455078125
generate_one_block  0.016688108444213867
generate_one_block  0.017435073852539062
generate_one_block  0.01707291603088379
generate_one_block  0.01763296127319336
generate_one_block  0.01922130584716797
generate_one_block  0.01784372329711914
generate_one_block  0.016818761825561523
generate_one_block  0.01728677749633789
generate_one_block  0.016602039337158203
generate_one_block  0.017542600631713867
generate_one_block  0.016625404357910156
generate_one_block  0.01739025115966797
generate_one_block  0.017460107803344727
generate_one_block  0.017078399658203125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03513288497924805
gen group dst list time:  0.020464658737182617
time for parepare:  0.019726276397705078
local_output_nid generation:  0.0054624080657958984
local_in_edges_tensor generation:  0.016081571578979492
mini_batch_src_global generation:  0.014193534851074219
r_  generation:  0.14159727096557617
local_output_nid generation:  0.007436037063598633
local_in_edges_tensor generation:  0.0094757080078125
mini_batch_src_global generation:  0.018257617950439453
r_  generation:  0.1797170639038086
local_output_nid generation:  0.0076999664306640625
local_in_edges_tensor generation:  0.10397958755493164
mini_batch_src_global generation:  0.01755213737487793
r_  generation:  0.15264463424682617
local_output_nid generation:  0.008540868759155273
local_in_edges_tensor generation:  0.010440587997436523
mini_batch_src_global generation:  0.019038677215576172
r_  generation:  0.15221500396728516
local_output_nid generation:  0.008310794830322266
local_in_edges_tensor generation:  0.010420083999633789
mini_batch_src_global generation:  0.020516157150268555
r_  generation:  0.15490388870239258
local_output_nid generation:  0.008582592010498047
local_in_edges_tensor generation:  0.012250185012817383
mini_batch_src_global generation:  0.019433975219726562
r_  generation:  0.15975236892700195
local_output_nid generation:  0.008768558502197266
local_in_edges_tensor generation:  0.00943613052368164
mini_batch_src_global generation:  0.019642114639282227
r_  generation:  0.15671682357788086
local_output_nid generation:  0.008910655975341797
local_in_edges_tensor generation:  0.01043701171875
mini_batch_src_global generation:  0.020175695419311523
r_  generation:  0.16317391395568848
local_output_nid generation:  0.009673595428466797
local_in_edges_tensor generation:  0.008363008499145508
mini_batch_src_global generation:  0.03141021728515625
r_  generation:  0.20059728622436523
local_output_nid generation:  0.010360479354858398
local_in_edges_tensor generation:  0.008352279663085938
mini_batch_src_global generation:  0.028649091720581055
r_  generation:  0.15670394897460938
local_output_nid generation:  0.008933782577514648
local_in_edges_tensor generation:  0.010315418243408203
mini_batch_src_global generation:  0.019154071807861328
r_  generation:  0.14969587326049805
local_output_nid generation:  0.009256601333618164
local_in_edges_tensor generation:  0.008205175399780273
mini_batch_src_global generation:  0.018988370895385742
r_  generation:  0.20198678970336914
local_output_nid generation:  0.008984088897705078
local_in_edges_tensor generation:  0.008251667022705078
mini_batch_src_global generation:  0.02071237564086914
r_  generation:  0.15533828735351562
local_output_nid generation:  0.009019613265991211
local_in_edges_tensor generation:  0.010004997253417969
mini_batch_src_global generation:  0.0189516544342041
r_  generation:  0.15161514282226562
local_output_nid generation:  0.00909423828125
local_in_edges_tensor generation:  0.008247613906860352
mini_batch_src_global generation:  0.020777463912963867
r_  generation:  0.15845918655395508
local_output_nid generation:  0.009278535842895508
local_in_edges_tensor generation:  0.008581161499023438
mini_batch_src_global generation:  0.01927804946899414
r_  generation:  0.15430903434753418
local_output_nid generation:  0.009088993072509766
local_in_edges_tensor generation:  0.008849620819091797
mini_batch_src_global generation:  0.019980907440185547
r_  generation:  0.1558682918548584
local_output_nid generation:  0.00894618034362793
local_in_edges_tensor generation:  0.007935047149658203
mini_batch_src_global generation:  0.019266128540039062
r_  generation:  0.15021514892578125
local_output_nid generation:  0.008836030960083008
local_in_edges_tensor generation:  0.010393619537353516
mini_batch_src_global generation:  0.018654823303222656
r_  generation:  0.14678645133972168
local_output_nid generation:  0.00917506217956543
local_in_edges_tensor generation:  0.009498357772827148
mini_batch_src_global generation:  0.018724918365478516
r_  generation:  0.1525120735168457
local_output_nid generation:  0.009123086929321289
local_in_edges_tensor generation:  0.00867772102355957
mini_batch_src_global generation:  0.03253364562988281
r_  generation:  0.1524951457977295
local_output_nid generation:  0.009217023849487305
local_in_edges_tensor generation:  0.008281946182250977
mini_batch_src_global generation:  0.03695368766784668
r_  generation:  0.15675139427185059
local_output_nid generation:  0.009066343307495117
local_in_edges_tensor generation:  0.008034229278564453
mini_batch_src_global generation:  0.020407676696777344
r_  generation:  0.14969086647033691
local_output_nid generation:  0.009203672409057617
local_in_edges_tensor generation:  0.00844120979309082
mini_batch_src_global generation:  0.019353151321411133
r_  generation:  0.15632367134094238
local_output_nid generation:  0.00901484489440918
local_in_edges_tensor generation:  0.008060216903686523
mini_batch_src_global generation:  0.018312931060791016
r_  generation:  0.1489121913909912
local_output_nid generation:  0.009080171585083008
local_in_edges_tensor generation:  0.008291959762573242
mini_batch_src_global generation:  0.019075632095336914
r_  generation:  0.15634703636169434
local_output_nid generation:  0.008867740631103516
local_in_edges_tensor generation:  0.008482933044433594
mini_batch_src_global generation:  0.0182344913482666
r_  generation:  0.1533493995666504
local_output_nid generation:  0.009486198425292969
local_in_edges_tensor generation:  0.008975744247436523
mini_batch_src_global generation:  0.02010202407836914
r_  generation:  0.16137027740478516
local_output_nid generation:  0.008934497833251953
local_in_edges_tensor generation:  0.009402275085449219
mini_batch_src_global generation:  0.018235206604003906
r_  generation:  0.15109634399414062
local_output_nid generation:  0.010621786117553711
local_in_edges_tensor generation:  0.008353233337402344
mini_batch_src_global generation:  0.01895761489868164
r_  generation:  0.15864801406860352
local_output_nid generation:  0.009494304656982422
local_in_edges_tensor generation:  0.010252714157104492
mini_batch_src_global generation:  0.019713640213012695
r_  generation:  0.15718364715576172
local_output_nid generation:  0.009288311004638672
local_in_edges_tensor generation:  0.008369922637939453
mini_batch_src_global generation:  0.01989912986755371
r_  generation:  0.15353012084960938
----------------------check_connections_block total spend ----------------------------- 7.593433856964111
generate_one_block  0.21693158149719238
generate_one_block  0.20124173164367676
generate_one_block  0.21902108192443848
generate_one_block  0.20274853706359863
generate_one_block  0.20189380645751953
generate_one_block  0.2053837776184082
generate_one_block  0.20421576499938965
generate_one_block  0.2183218002319336
generate_one_block  0.21276450157165527
generate_one_block  0.21219420433044434
generate_one_block  0.20367908477783203
generate_one_block  0.21008753776550293
generate_one_block  0.21638226509094238
generate_one_block  0.20747685432434082
generate_one_block  0.21497869491577148
generate_one_block  0.21106839179992676
generate_one_block  0.2083301544189453
generate_one_block  0.19913649559020996
generate_one_block  0.1961991786956787
generate_one_block  0.20128488540649414
generate_one_block  0.1955094337463379
generate_one_block  0.20862841606140137
generate_one_block  0.19725680351257324
generate_one_block  0.20833134651184082
generate_one_block  0.19465923309326172
generate_one_block  0.20510244369506836
generate_one_block  0.20047354698181152
generate_one_block  0.21232962608337402
generate_one_block  0.1961650848388672
generate_one_block  0.20494866371154785
generate_one_block  0.20965147018432617
generate_one_block  0.20421624183654785
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03311896324157715
gen group dst list time:  0.10672426223754883
time for parepare:  0.020738601684570312
local_output_nid generation:  0.024680376052856445
local_in_edges_tensor generation:  0.044663190841674805
mini_batch_src_global generation:  0.03772735595703125
r_  generation:  0.42159342765808105
local_output_nid generation:  0.028432369232177734
local_in_edges_tensor generation:  0.031807899475097656
mini_batch_src_global generation:  0.0507810115814209
r_  generation:  0.40540003776550293
local_output_nid generation:  0.0288999080657959
local_in_edges_tensor generation:  0.028497695922851562
mini_batch_src_global generation:  0.04884958267211914
r_  generation:  0.4182240962982178
local_output_nid generation:  0.02922654151916504
local_in_edges_tensor generation:  0.029109477996826172
mini_batch_src_global generation:  0.05067157745361328
r_  generation:  0.41219282150268555
local_output_nid generation:  0.02895045280456543
local_in_edges_tensor generation:  0.02872633934020996
mini_batch_src_global generation:  0.047437191009521484
r_  generation:  0.4181506633758545
local_output_nid generation:  0.028896093368530273
local_in_edges_tensor generation:  0.02876138687133789
mini_batch_src_global generation:  0.04990887641906738
r_  generation:  0.409574031829834
local_output_nid generation:  0.02832174301147461
local_in_edges_tensor generation:  0.02928447723388672
mini_batch_src_global generation:  0.04961967468261719
r_  generation:  0.42566442489624023
local_output_nid generation:  0.028179645538330078
local_in_edges_tensor generation:  0.03046703338623047
mini_batch_src_global generation:  0.050019025802612305
r_  generation:  0.418290376663208
local_output_nid generation:  0.03015589714050293
local_in_edges_tensor generation:  0.02904033660888672
mini_batch_src_global generation:  0.04842019081115723
r_  generation:  0.4191877841949463
local_output_nid generation:  0.028520822525024414
local_in_edges_tensor generation:  0.11091279983520508
mini_batch_src_global generation:  0.04973793029785156
r_  generation:  0.41141748428344727
local_output_nid generation:  0.027608633041381836
local_in_edges_tensor generation:  0.028557777404785156
mini_batch_src_global generation:  0.047250986099243164
r_  generation:  0.41231679916381836
local_output_nid generation:  0.030215740203857422
local_in_edges_tensor generation:  0.025867462158203125
mini_batch_src_global generation:  0.04953885078430176
r_  generation:  0.4240293502807617
local_output_nid generation:  0.027950286865234375
local_in_edges_tensor generation:  0.026915550231933594
mini_batch_src_global generation:  0.04796648025512695
r_  generation:  0.4303603172302246
local_output_nid generation:  0.02830982208251953
local_in_edges_tensor generation:  0.02724742889404297
mini_batch_src_global generation:  0.04963064193725586
r_  generation:  0.41274046897888184
local_output_nid generation:  0.02803826332092285
local_in_edges_tensor generation:  0.02621769905090332
mini_batch_src_global generation:  0.04749608039855957
r_  generation:  0.42200493812561035
local_output_nid generation:  0.028044700622558594
local_in_edges_tensor generation:  0.032041072845458984
mini_batch_src_global generation:  0.04961228370666504
r_  generation:  0.4151616096496582
local_output_nid generation:  0.027748823165893555
local_in_edges_tensor generation:  0.0270538330078125
mini_batch_src_global generation:  0.04941368103027344
r_  generation:  0.4189732074737549
local_output_nid generation:  0.027753114700317383
local_in_edges_tensor generation:  0.027523040771484375
mini_batch_src_global generation:  0.048743247985839844
r_  generation:  0.4080538749694824
local_output_nid generation:  0.027812719345092773
local_in_edges_tensor generation:  0.025557994842529297
mini_batch_src_global generation:  0.04704403877258301
r_  generation:  0.4158484935760498
local_output_nid generation:  0.027869701385498047
local_in_edges_tensor generation:  0.02641749382019043
mini_batch_src_global generation:  0.051259517669677734
r_  generation:  0.41288185119628906
local_output_nid generation:  0.027733802795410156
local_in_edges_tensor generation:  0.025707244873046875
mini_batch_src_global generation:  0.04713940620422363
r_  generation:  0.4120917320251465
local_output_nid generation:  0.027704954147338867
local_in_edges_tensor generation:  0.025355815887451172
mini_batch_src_global generation:  0.04857635498046875
r_  generation:  0.4130244255065918
local_output_nid generation:  0.02763652801513672
local_in_edges_tensor generation:  0.026736974716186523
mini_batch_src_global generation:  0.046942949295043945
r_  generation:  0.4149620532989502
local_output_nid generation:  0.029230356216430664
local_in_edges_tensor generation:  0.03107619285583496
mini_batch_src_global generation:  0.049835205078125
r_  generation:  0.4157571792602539
local_output_nid generation:  0.027860164642333984
local_in_edges_tensor generation:  0.03021979331970215
mini_batch_src_global generation:  0.04863882064819336
r_  generation:  0.42285847663879395
local_output_nid generation:  0.028274059295654297
local_in_edges_tensor generation:  0.02559351921081543
mini_batch_src_global generation:  0.04921579360961914
r_  generation:  0.4135782718658447
local_output_nid generation:  0.028059959411621094
local_in_edges_tensor generation:  0.028466463088989258
mini_batch_src_global generation:  0.04744672775268555
r_  generation:  0.4285273551940918
local_output_nid generation:  0.03016042709350586
local_in_edges_tensor generation:  0.02901148796081543
mini_batch_src_global generation:  0.05204319953918457
r_  generation:  0.41993212699890137
local_output_nid generation:  0.029371261596679688
local_in_edges_tensor generation:  0.02883601188659668
mini_batch_src_global generation:  0.0478518009185791
r_  generation:  0.4151642322540283
local_output_nid generation:  0.028978824615478516
local_in_edges_tensor generation:  0.027992725372314453
mini_batch_src_global generation:  0.0493929386138916
r_  generation:  0.4109079837799072
local_output_nid generation:  0.028576135635375977
local_in_edges_tensor generation:  0.029582500457763672
mini_batch_src_global generation:  0.04942655563354492
r_  generation:  0.42516636848449707
local_output_nid generation:  0.02862238883972168
local_in_edges_tensor generation:  0.02828240394592285
mini_batch_src_global generation:  0.04943108558654785
r_  generation:  0.40946531295776367
----------------------check_connections_block total spend ----------------------------- 19.797932863235474
generate_one_block  0.5664169788360596
generate_one_block  0.5483651161193848
generate_one_block  0.552462100982666
generate_one_block  0.5526702404022217
generate_one_block  0.5502889156341553
generate_one_block  0.5661144256591797
generate_one_block  0.5764503479003906
generate_one_block  0.5631520748138428
generate_one_block  0.557776927947998
generate_one_block  0.5532040596008301
generate_one_block  0.5461916923522949
generate_one_block  0.555532693862915
generate_one_block  0.5625014305114746
generate_one_block  0.5570402145385742
generate_one_block  0.5690348148345947
generate_one_block  0.5551166534423828
generate_one_block  0.5540831089019775
generate_one_block  0.5515186786651611
generate_one_block  0.5482289791107178
generate_one_block  0.5561628341674805
generate_one_block  0.5525929927825928
generate_one_block  0.5593092441558838
generate_one_block  0.555020809173584
generate_one_block  0.56424880027771
generate_one_block  0.5467424392700195
generate_one_block  0.5547816753387451
generate_one_block  0.551020622253418
generate_one_block  0.5662243366241455
generate_one_block  0.5504143238067627
generate_one_block  0.5541117191314697
generate_one_block  0.5690863132476807
generate_one_block  0.5702316761016846
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12295675277709961  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

connection checking time:  27.391366720199585
block generation total time  24.436709880828857
average batch blocks generation time:  0.7636471837759018
block dataloader generation time/epoch 54.47611575126648
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527992248535156  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.155447006225586  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10468864440917969  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.95289134979248  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525703430175781  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.00084400177002  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10495328903198242  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.014626502990723  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523748397827148  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.828862190246582  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10434913635253906  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.038064002990723  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526609420776367  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.044020652770996  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10511922836303711  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.36169672012329  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529327392578125  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.166914463043213  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10481643676757812  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.148993968963623  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518026351928711  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.556610107421875  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10496902465820312  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.968070030212402  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528087615966797  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.0825457572937  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10463571548461914  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.970674991607666  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529279708862305  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.161386966705322  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10440635681152344  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.025498867034912  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528182983398438  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.09719944000244  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10456562042236328  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.598742961883545  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10514259338378906  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.433536052703857  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10474920272827148  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.794761180877686  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10516881942749023  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.550381183624268  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10474920272827148  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.025657653808594  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10517454147338867  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.551531314849854  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10497808456420898  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.121323585510254  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10515642166137695  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.50461196899414  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10480976104736328  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.962257862091064  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10516977310180664  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.543972492218018  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10480356216430664  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.16126585006714  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10516738891601562  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.539852619171143  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10424661636352539  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.898749351501465  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528039932250977  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.167327404022217  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10459327697753906  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.97510051727295  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034337036311626434 |0.015177592635154724 |0.41697239875793457 |9.473413228988647e-05 |0.760327510535717 |0.006421804428100586 |
----------------------------------------------------------pseudo_mini_loss sum 1.3912699222564697
Total (block generation + training)time/epoch 93.60226006507874
Training time/epoch 39.31788945198059
Training time without block to device /epoch 38.83220648765564
Training time without total dataloading part /epoch 37.68305039405823
load block tensor time/epoch 1.098785161972046
block to device time/epoch 0.48568296432495117
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  8791434
Number of first layer input nodes during this epoch:  4680476
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1229867935180664  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025278091430664062
range selection method range initialization spend 0.016595125198364258
time for parepare:  0.018206357955932617
local_output_nid generation:  0.0009343624114990234
local_in_edges_tensor generation:  0.004507780075073242
mini_batch_src_global generation:  0.0028753280639648438
r_  generation:  0.015170574188232422
local_output_nid generation:  0.0015423297882080078
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.0021893978118896484
r_  generation:  0.011590957641601562
local_output_nid generation:  0.001222372055053711
local_in_edges_tensor generation:  0.0007088184356689453
mini_batch_src_global generation:  0.0014863014221191406
r_  generation:  0.01015782356262207
local_output_nid generation:  0.0011739730834960938
local_in_edges_tensor generation:  0.0007393360137939453
mini_batch_src_global generation:  0.0014052391052246094
r_  generation:  0.010184764862060547
local_output_nid generation:  0.0011489391326904297
local_in_edges_tensor generation:  0.0006587505340576172
mini_batch_src_global generation:  0.0013856887817382812
r_  generation:  0.01549386978149414
local_output_nid generation:  0.002254962921142578
local_in_edges_tensor generation:  0.0012774467468261719
mini_batch_src_global generation:  0.003018617630004883
r_  generation:  0.014016151428222656
local_output_nid generation:  0.0011103153228759766
local_in_edges_tensor generation:  0.0007052421569824219
mini_batch_src_global generation:  0.0015468597412109375
r_  generation:  0.010207414627075195
local_output_nid generation:  0.0009872913360595703
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0013456344604492188
r_  generation:  0.010026693344116211
local_output_nid generation:  0.0009398460388183594
local_in_edges_tensor generation:  0.0006244182586669922
mini_batch_src_global generation:  0.0012278556823730469
r_  generation:  0.010381937026977539
local_output_nid generation:  0.0009131431579589844
local_in_edges_tensor generation:  0.0005788803100585938
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.010674476623535156
local_output_nid generation:  0.0009052753448486328
local_in_edges_tensor generation:  0.0005605220794677734
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.010396718978881836
local_output_nid generation:  0.0008974075317382812
local_in_edges_tensor generation:  0.0006194114685058594
mini_batch_src_global generation:  0.0011327266693115234
r_  generation:  0.01045536994934082
local_output_nid generation:  0.0008983612060546875
local_in_edges_tensor generation:  0.0005931854248046875
mini_batch_src_global generation:  0.0012025833129882812
r_  generation:  0.010382652282714844
local_output_nid generation:  0.0009052753448486328
local_in_edges_tensor generation:  0.0005521774291992188
mini_batch_src_global generation:  0.0011584758758544922
r_  generation:  0.010253667831420898
local_output_nid generation:  0.00087738037109375
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.0011057853698730469
r_  generation:  0.010039091110229492
local_output_nid generation:  0.0008873939514160156
local_in_edges_tensor generation:  0.0005419254302978516
mini_batch_src_global generation:  0.0011074542999267578
r_  generation:  0.010182380676269531
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0005412101745605469
mini_batch_src_global generation:  0.0011734962463378906
r_  generation:  0.010125875473022461
local_output_nid generation:  0.0008966922760009766
local_in_edges_tensor generation:  0.0006136894226074219
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.009513616561889648
local_output_nid generation:  0.0008873939514160156
local_in_edges_tensor generation:  0.0005598068237304688
mini_batch_src_global generation:  0.0010921955108642578
r_  generation:  0.010153770446777344
local_output_nid generation:  0.0008802413940429688
local_in_edges_tensor generation:  0.0005652904510498047
mini_batch_src_global generation:  0.0011477470397949219
r_  generation:  0.010599374771118164
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0005645751953125
mini_batch_src_global generation:  0.0011565685272216797
r_  generation:  0.010667800903320312
local_output_nid generation:  0.0008780956268310547
local_in_edges_tensor generation:  0.0005435943603515625
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.010151147842407227
local_output_nid generation:  0.0009102821350097656
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.001096487045288086
r_  generation:  0.010096073150634766
local_output_nid generation:  0.0008764266967773438
local_in_edges_tensor generation:  0.0005524158477783203
mini_batch_src_global generation:  0.0011057853698730469
r_  generation:  0.010239839553833008
local_output_nid generation:  0.0008857250213623047
local_in_edges_tensor generation:  0.0005557537078857422
mini_batch_src_global generation:  0.0011105537414550781
r_  generation:  0.010135650634765625
local_output_nid generation:  0.0008764266967773438
local_in_edges_tensor generation:  0.0005788803100585938
mini_batch_src_global generation:  0.0011017322540283203
r_  generation:  0.010361671447753906
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.0005869865417480469
mini_batch_src_global generation:  0.0011982917785644531
r_  generation:  0.010318279266357422
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0005419254302978516
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.010188102722167969
local_output_nid generation:  0.0008819103240966797
local_in_edges_tensor generation:  0.0005462169647216797
mini_batch_src_global generation:  0.0010936260223388672
r_  generation:  0.010092496871948242
local_output_nid generation:  0.0008687973022460938
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0011568069458007812
r_  generation:  0.010117053985595703
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0005414485931396484
mini_batch_src_global generation:  0.0011744499206542969
r_  generation:  0.010295391082763672
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0005369186401367188
mini_batch_src_global generation:  0.0010986328125
r_  generation:  0.01002359390258789
----------------------check_connections_block total spend ----------------------------- 0.5441112518310547
generate_one_block  0.02331995964050293
generate_one_block  0.0205078125
generate_one_block  0.017679929733276367
generate_one_block  0.01765298843383789
generate_one_block  0.01711559295654297
generate_one_block  0.01754903793334961
generate_one_block  0.017107725143432617
generate_one_block  0.016938447952270508
generate_one_block  0.017894744873046875
generate_one_block  0.01809835433959961
generate_one_block  0.017284870147705078
generate_one_block  0.019891738891601562
generate_one_block  0.01794910430908203
generate_one_block  0.017366409301757812
generate_one_block  0.016987323760986328
generate_one_block  0.01715850830078125
generate_one_block  0.01700878143310547
generate_one_block  0.01608872413635254
generate_one_block  0.017040252685546875
generate_one_block  0.017995357513427734
generate_one_block  0.017834186553955078
generate_one_block  0.017187118530273438
generate_one_block  0.017049312591552734
generate_one_block  0.017180919647216797
generate_one_block  0.016888141632080078
generate_one_block  0.017310142517089844
generate_one_block  0.01735067367553711
generate_one_block  0.016852855682373047
generate_one_block  0.01685810089111328
generate_one_block  0.017136096954345703
generate_one_block  0.0171816349029541
generate_one_block  0.01688694953918457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03636431694030762
gen group dst list time:  0.024123668670654297
time for parepare:  0.021114349365234375
local_output_nid generation:  0.0051496028900146484
local_in_edges_tensor generation:  0.015508651733398438
mini_batch_src_global generation:  0.01684880256652832
r_  generation:  0.13563776016235352
local_output_nid generation:  0.007639169692993164
local_in_edges_tensor generation:  0.010123729705810547
mini_batch_src_global generation:  0.021181821823120117
r_  generation:  0.17014384269714355
local_output_nid generation:  0.011804819107055664
local_in_edges_tensor generation:  0.04461979866027832
mini_batch_src_global generation:  0.01897430419921875
r_  generation:  0.1582353115081787
local_output_nid generation:  0.01646900177001953
local_in_edges_tensor generation:  0.011596202850341797
mini_batch_src_global generation:  0.018910884857177734
r_  generation:  0.16507840156555176
local_output_nid generation:  0.011694908142089844
local_in_edges_tensor generation:  0.011105775833129883
mini_batch_src_global generation:  0.02104973793029785
r_  generation:  0.14794611930847168
local_output_nid generation:  0.010136127471923828
local_in_edges_tensor generation:  0.00928497314453125
mini_batch_src_global generation:  0.020913362503051758
r_  generation:  0.15293478965759277
local_output_nid generation:  0.009789228439331055
local_in_edges_tensor generation:  0.009654045104980469
mini_batch_src_global generation:  0.02086806297302246
r_  generation:  0.15336084365844727
local_output_nid generation:  0.008769512176513672
local_in_edges_tensor generation:  0.010528087615966797
mini_batch_src_global generation:  0.021500110626220703
r_  generation:  0.1520860195159912
local_output_nid generation:  0.008751869201660156
local_in_edges_tensor generation:  0.008148431777954102
mini_batch_src_global generation:  0.02171921730041504
r_  generation:  0.15800738334655762
local_output_nid generation:  0.009335517883300781
local_in_edges_tensor generation:  0.010901451110839844
mini_batch_src_global generation:  0.02310490608215332
r_  generation:  0.16025567054748535
local_output_nid generation:  0.008795738220214844
local_in_edges_tensor generation:  0.007939577102661133
mini_batch_src_global generation:  0.021692276000976562
r_  generation:  0.1556224822998047
local_output_nid generation:  0.009296178817749023
local_in_edges_tensor generation:  0.008175134658813477
mini_batch_src_global generation:  0.029599428176879883
r_  generation:  0.20551204681396484
local_output_nid generation:  0.010191679000854492
local_in_edges_tensor generation:  0.011601448059082031
mini_batch_src_global generation:  0.03797197341918945
r_  generation:  0.15928435325622559
local_output_nid generation:  0.009595394134521484
local_in_edges_tensor generation:  0.008985042572021484
mini_batch_src_global generation:  0.025826215744018555
r_  generation:  0.1662578582763672
local_output_nid generation:  0.009734869003295898
local_in_edges_tensor generation:  0.010275125503540039
mini_batch_src_global generation:  0.021477460861206055
r_  generation:  0.15691590309143066
local_output_nid generation:  0.009325981140136719
local_in_edges_tensor generation:  0.01067209243774414
mini_batch_src_global generation:  0.022086381912231445
r_  generation:  0.15707135200500488
local_output_nid generation:  0.009005308151245117
local_in_edges_tensor generation:  0.011204242706298828
mini_batch_src_global generation:  0.019093990325927734
r_  generation:  0.1565859317779541
local_output_nid generation:  0.008956670761108398
local_in_edges_tensor generation:  0.009784221649169922
mini_batch_src_global generation:  0.017747879028320312
r_  generation:  0.15184950828552246
local_output_nid generation:  0.011218786239624023
local_in_edges_tensor generation:  0.008963584899902344
mini_batch_src_global generation:  0.02336907386779785
r_  generation:  0.15300226211547852
local_output_nid generation:  0.0101318359375
local_in_edges_tensor generation:  0.008550882339477539
mini_batch_src_global generation:  0.020428895950317383
r_  generation:  0.16037631034851074
local_output_nid generation:  0.009968757629394531
local_in_edges_tensor generation:  0.010296106338500977
mini_batch_src_global generation:  0.019767284393310547
r_  generation:  0.15925049781799316
local_output_nid generation:  0.00967860221862793
local_in_edges_tensor generation:  0.01079416275024414
mini_batch_src_global generation:  0.020112276077270508
r_  generation:  0.15462088584899902
local_output_nid generation:  0.009679317474365234
local_in_edges_tensor generation:  0.008223295211791992
mini_batch_src_global generation:  0.019336700439453125
r_  generation:  0.15334296226501465
local_output_nid generation:  0.0097503662109375
local_in_edges_tensor generation:  0.008165121078491211
mini_batch_src_global generation:  0.019800662994384766
r_  generation:  0.15485763549804688
local_output_nid generation:  0.009556293487548828
local_in_edges_tensor generation:  0.008711576461791992
mini_batch_src_global generation:  0.018665075302124023
r_  generation:  0.15107131004333496
local_output_nid generation:  0.00974726676940918
local_in_edges_tensor generation:  0.008517980575561523
mini_batch_src_global generation:  0.020483732223510742
r_  generation:  0.159592866897583
local_output_nid generation:  0.009697437286376953
local_in_edges_tensor generation:  0.009603023529052734
mini_batch_src_global generation:  0.019087553024291992
r_  generation:  0.1564633846282959
local_output_nid generation:  0.00951528549194336
local_in_edges_tensor generation:  0.00813436508178711
mini_batch_src_global generation:  0.019044876098632812
r_  generation:  0.1516590118408203
local_output_nid generation:  0.009427547454833984
local_in_edges_tensor generation:  0.008249044418334961
mini_batch_src_global generation:  0.0191190242767334
r_  generation:  0.15478181838989258
local_output_nid generation:  0.009778738021850586
local_in_edges_tensor generation:  0.008337259292602539
mini_batch_src_global generation:  0.01871347427368164
r_  generation:  0.15216684341430664
local_output_nid generation:  0.009732723236083984
local_in_edges_tensor generation:  0.008292198181152344
mini_batch_src_global generation:  0.018766164779663086
r_  generation:  0.15340781211853027
local_output_nid generation:  0.009657621383666992
local_in_edges_tensor generation:  0.008176088333129883
mini_batch_src_global generation:  0.019170045852661133
r_  generation:  0.15581488609313965
----------------------check_connections_block total spend ----------------------------- 7.590265989303589
generate_one_block  0.20897245407104492
generate_one_block  0.20670866966247559
generate_one_block  0.202195405960083
generate_one_block  0.2067422866821289
generate_one_block  0.21431589126586914
generate_one_block  0.20325469970703125
generate_one_block  0.20541954040527344
generate_one_block  0.19906258583068848
generate_one_block  0.21077513694763184
generate_one_block  0.21451473236083984
generate_one_block  0.20278596878051758
generate_one_block  0.2117762565612793
generate_one_block  0.20466375350952148
generate_one_block  0.20570063591003418
generate_one_block  0.20108556747436523
generate_one_block  0.20342350006103516
generate_one_block  0.20510411262512207
generate_one_block  0.19275736808776855
generate_one_block  0.2063596248626709
generate_one_block  0.21635866165161133
generate_one_block  0.21399259567260742
generate_one_block  0.20340561866760254
generate_one_block  0.20299625396728516
generate_one_block  0.20771336555480957
generate_one_block  0.20117807388305664
generate_one_block  0.20923900604248047
generate_one_block  0.2087230682373047
generate_one_block  0.19888901710510254
generate_one_block  0.201629638671875
generate_one_block  0.2020878791809082
generate_one_block  0.20549345016479492
generate_one_block  0.20723605155944824
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03331804275512695
gen group dst list time:  0.11136341094970703
time for parepare:  0.019402503967285156
local_output_nid generation:  0.024007797241210938
local_in_edges_tensor generation:  0.042632102966308594
mini_batch_src_global generation:  0.037328481674194336
r_  generation:  0.4005768299102783
local_output_nid generation:  0.028844118118286133
local_in_edges_tensor generation:  0.03326082229614258
mini_batch_src_global generation:  0.048685550689697266
r_  generation:  0.40328049659729004
local_output_nid generation:  0.02859330177307129
local_in_edges_tensor generation:  0.02662968635559082
mini_batch_src_global generation:  0.04688882827758789
r_  generation:  0.41053056716918945
local_output_nid generation:  0.0287322998046875
local_in_edges_tensor generation:  0.02670431137084961
mini_batch_src_global generation:  0.04851961135864258
r_  generation:  0.40593576431274414
local_output_nid generation:  0.028500080108642578
local_in_edges_tensor generation:  0.02670574188232422
mini_batch_src_global generation:  0.04689288139343262
r_  generation:  0.4124889373779297
local_output_nid generation:  0.028766155242919922
local_in_edges_tensor generation:  0.02697920799255371
mini_batch_src_global generation:  0.04939723014831543
r_  generation:  0.4160892963409424
local_output_nid generation:  0.027598857879638672
local_in_edges_tensor generation:  0.028462886810302734
mini_batch_src_global generation:  0.04783177375793457
r_  generation:  0.4247245788574219
local_output_nid generation:  0.02743816375732422
local_in_edges_tensor generation:  0.027118682861328125
mini_batch_src_global generation:  0.04930233955383301
r_  generation:  0.41962456703186035
local_output_nid generation:  0.027520418167114258
local_in_edges_tensor generation:  0.02915334701538086
mini_batch_src_global generation:  0.049594879150390625
r_  generation:  0.42337584495544434
local_output_nid generation:  0.02782416343688965
local_in_edges_tensor generation:  0.028991222381591797
mini_batch_src_global generation:  0.04953956604003906
r_  generation:  0.4273989200592041
local_output_nid generation:  0.027213335037231445
local_in_edges_tensor generation:  0.02734661102294922
mini_batch_src_global generation:  0.051299095153808594
r_  generation:  0.4204714298248291
local_output_nid generation:  0.02847766876220703
local_in_edges_tensor generation:  0.027524232864379883
mini_batch_src_global generation:  0.053345441818237305
r_  generation:  0.41728973388671875
local_output_nid generation:  0.027814149856567383
local_in_edges_tensor generation:  0.029531478881835938
mini_batch_src_global generation:  0.05003547668457031
r_  generation:  0.4218325614929199
local_output_nid generation:  0.02762317657470703
local_in_edges_tensor generation:  0.031293392181396484
mini_batch_src_global generation:  0.053659915924072266
r_  generation:  0.4099090099334717
local_output_nid generation:  0.02736067771911621
local_in_edges_tensor generation:  0.02553081512451172
mini_batch_src_global generation:  0.04891562461853027
r_  generation:  0.4154045581817627
local_output_nid generation:  0.02742624282836914
local_in_edges_tensor generation:  0.025267839431762695
mini_batch_src_global generation:  0.051184654235839844
r_  generation:  0.40909862518310547
local_output_nid generation:  0.02760767936706543
local_in_edges_tensor generation:  0.027480363845825195
mini_batch_src_global generation:  0.050087928771972656
r_  generation:  0.4174060821533203
local_output_nid generation:  0.026955604553222656
local_in_edges_tensor generation:  0.02713179588317871
mini_batch_src_global generation:  0.05194568634033203
r_  generation:  0.4050273895263672
local_output_nid generation:  0.027382850646972656
local_in_edges_tensor generation:  0.025928020477294922
mini_batch_src_global generation:  0.049723148345947266
r_  generation:  0.4145925045013428
local_output_nid generation:  0.028183698654174805
local_in_edges_tensor generation:  0.03293013572692871
mini_batch_src_global generation:  0.05532693862915039
r_  generation:  0.41752123832702637
local_output_nid generation:  0.027948856353759766
local_in_edges_tensor generation:  0.030694246292114258
mini_batch_src_global generation:  0.05328512191772461
r_  generation:  0.42559170722961426
local_output_nid generation:  0.028302669525146484
local_in_edges_tensor generation:  0.033132314682006836
mini_batch_src_global generation:  0.05381369590759277
r_  generation:  0.42163658142089844
local_output_nid generation:  0.02838277816772461
local_in_edges_tensor generation:  0.030332565307617188
mini_batch_src_global generation:  0.05048632621765137
r_  generation:  0.43073129653930664
local_output_nid generation:  0.03148317337036133
local_in_edges_tensor generation:  0.027390718460083008
mini_batch_src_global generation:  0.051363229751586914
r_  generation:  0.41036462783813477
local_output_nid generation:  0.028023719787597656
local_in_edges_tensor generation:  0.025270700454711914
mini_batch_src_global generation:  0.04677772521972656
r_  generation:  0.41723060607910156
local_output_nid generation:  0.028696537017822266
local_in_edges_tensor generation:  0.02722764015197754
mini_batch_src_global generation:  0.04973244667053223
r_  generation:  0.41024136543273926
local_output_nid generation:  0.028351545333862305
local_in_edges_tensor generation:  0.025089502334594727
mini_batch_src_global generation:  0.047296762466430664
r_  generation:  0.4151630401611328
local_output_nid generation:  0.02826690673828125
local_in_edges_tensor generation:  0.025461435317993164
mini_batch_src_global generation:  0.049340009689331055
r_  generation:  0.40711379051208496
local_output_nid generation:  0.02807903289794922
local_in_edges_tensor generation:  0.024875402450561523
mini_batch_src_global generation:  0.04784083366394043
r_  generation:  0.41689229011535645
local_output_nid generation:  0.0282900333404541
local_in_edges_tensor generation:  0.025340557098388672
mini_batch_src_global generation:  0.04991888999938965
r_  generation:  0.4111907482147217
local_output_nid generation:  0.02816939353942871
local_in_edges_tensor generation:  0.02715158462524414
mini_batch_src_global generation:  0.047448158264160156
r_  generation:  0.4172041416168213
local_output_nid generation:  0.027894973754882812
local_in_edges_tensor generation:  0.026594161987304688
mini_batch_src_global generation:  0.04898214340209961
r_  generation:  0.4102823734283447
----------------------check_connections_block total spend ----------------------------- 19.658308267593384
generate_one_block  0.5596015453338623
generate_one_block  0.5503332614898682
generate_one_block  0.5502326488494873
generate_one_block  0.5489957332611084
generate_one_block  0.6462478637695312
generate_one_block  0.5577640533447266
generate_one_block  0.5556211471557617
generate_one_block  0.5538425445556641
generate_one_block  0.5550704002380371
generate_one_block  0.5598180294036865
generate_one_block  0.5472915172576904
generate_one_block  0.5569119453430176
generate_one_block  0.5571370124816895
generate_one_block  0.5464150905609131
generate_one_block  0.5418543815612793
generate_one_block  0.5504143238067627
generate_one_block  0.5521130561828613
generate_one_block  0.5358419418334961
generate_one_block  0.5538699626922607
generate_one_block  0.5580589771270752
generate_one_block  0.5597867965698242
generate_one_block  0.5462615489959717
generate_one_block  0.5471286773681641
generate_one_block  0.554539680480957
generate_one_block  0.5639331340789795
generate_one_block  0.5595366954803467
generate_one_block  0.5512657165527344
generate_one_block  0.5470635890960693
generate_one_block  0.5490615367889404
generate_one_block  0.5490057468414307
generate_one_block  0.5502161979675293
generate_one_block  0.5459558963775635
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1229867935180664  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

connection checking time:  27.248574256896973
block generation total time  24.345751523971558
average batch blocks generation time:  0.7608047351241112
block dataloader generation time/epoch 54.48896197839217
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052389144897461  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.897758960723877  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10480260848999023  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.226699829101562  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524797439575195  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.964397430419922  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10466575622558594  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.020569324493408  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10516500473022461  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.52538776397705  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10478973388671875  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.92873239517212  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525083541870117  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.962685108184814  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10457324981689453  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.782620906829834  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10531282424926758  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.196447372436523  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10480499267578125  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.316422939300537  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524415969848633  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.85097646713257  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10476255416870117  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.249032020568848  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526657104492188  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.054001808166504  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10442686080932617  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.9346022605896  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520696640014648  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.695229053497314  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10437488555908203  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.805161476135254  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523557662963867  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.93656826019287  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10419750213623047  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.099853515625  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052403450012207  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.934682369232178  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10531187057495117  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.25706720352173  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10532522201538086  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.324307441711426  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10494852066040039  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.80084800720215  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520553588867188  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.71447992324829  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1043848991394043  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.816097736358643  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519742965698242  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.66865062713623  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10498857498168945  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.13707208633423  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526657104492188  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.07948923110962  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10445308685302734  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.598665714263916  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521650314331055  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.760913848876953  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10480213165283203  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.751132488250732  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523366928100586  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.914073944091797  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10449552536010742  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.868757247924805  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03510322421789169 |0.014249317348003387 |0.41364483535289764 |9.223073720932007e-05 |0.756408117711544 |0.00544285774230957 |
----------------------------------------------------------pseudo_mini_loss sum 1.3668906688690186
Total (block generation + training)time/epoch 93.61130664565347
Training time/epoch 39.08409094810486
Training time without block to device /epoch 38.62811279296875
Training time without total dataloading part /epoch 37.45008873939514
load block tensor time/epoch 1.1233031749725342
block to device time/epoch 0.4559781551361084
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  8790904
Number of first layer input nodes during this epoch:  4680265
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12221336364746094  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024430274963378906
range selection method range initialization spend 0.013436555862426758
time for parepare:  0.017325401306152344
local_output_nid generation:  0.0009248256683349609
local_in_edges_tensor generation:  0.007896661758422852
mini_batch_src_global generation:  0.0014317035675048828
r_  generation:  0.010379314422607422
local_output_nid generation:  0.0009484291076660156
local_in_edges_tensor generation:  0.0006723403930664062
mini_batch_src_global generation:  0.0013856887817382812
r_  generation:  0.010133981704711914
local_output_nid generation:  0.000904083251953125
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.001119375228881836
r_  generation:  0.009600162506103516
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.00058746337890625
mini_batch_src_global generation:  0.0010716915130615234
r_  generation:  0.010103702545166016
local_output_nid generation:  0.000850677490234375
local_in_edges_tensor generation:  0.0005755424499511719
mini_batch_src_global generation:  0.0011091232299804688
r_  generation:  0.010323286056518555
local_output_nid generation:  0.0008525848388671875
local_in_edges_tensor generation:  0.0005719661712646484
mini_batch_src_global generation:  0.0010919570922851562
r_  generation:  0.010023355484008789
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0011568069458007812
r_  generation:  0.010072469711303711
local_output_nid generation:  0.0008902549743652344
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.0010592937469482422
r_  generation:  0.00984644889831543
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0005576610565185547
mini_batch_src_global generation:  0.0011539459228515625
r_  generation:  0.010143041610717773
local_output_nid generation:  0.0008406639099121094
local_in_edges_tensor generation:  0.0005612373352050781
mini_batch_src_global generation:  0.001050710678100586
r_  generation:  0.009906291961669922
local_output_nid generation:  0.0008771419525146484
local_in_edges_tensor generation:  0.0005853176116943359
mini_batch_src_global generation:  0.0010437965393066406
r_  generation:  0.009856700897216797
local_output_nid generation:  0.0008494853973388672
local_in_edges_tensor generation:  0.0006060600280761719
mini_batch_src_global generation:  0.0010883808135986328
r_  generation:  0.010132789611816406
local_output_nid generation:  0.0008404254913330078
local_in_edges_tensor generation:  0.0006043910980224609
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.010137557983398438
local_output_nid generation:  0.0008478164672851562
local_in_edges_tensor generation:  0.0005562305450439453
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.009887218475341797
local_output_nid generation:  0.0008406639099121094
local_in_edges_tensor generation:  0.0005459785461425781
mini_batch_src_global generation:  0.0011196136474609375
r_  generation:  0.010048151016235352
local_output_nid generation:  0.0008404254913330078
local_in_edges_tensor generation:  0.0005469322204589844
mini_batch_src_global generation:  0.0010972023010253906
r_  generation:  0.010114192962646484
local_output_nid generation:  0.0008342266082763672
local_in_edges_tensor generation:  0.0005505084991455078
mini_batch_src_global generation:  0.001064300537109375
r_  generation:  0.010113000869750977
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0011835098266601562
r_  generation:  0.010296344757080078
local_output_nid generation:  0.0008411407470703125
local_in_edges_tensor generation:  0.000576019287109375
mini_batch_src_global generation:  0.0010313987731933594
r_  generation:  0.011884212493896484
local_output_nid generation:  0.0009095668792724609
local_in_edges_tensor generation:  0.0005831718444824219
mini_batch_src_global generation:  0.001192331314086914
r_  generation:  0.010370254516601562
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.000576019287109375
mini_batch_src_global generation:  0.0012171268463134766
r_  generation:  0.010290145874023438
local_output_nid generation:  0.0008344650268554688
local_in_edges_tensor generation:  0.0005588531494140625
mini_batch_src_global generation:  0.0010898113250732422
r_  generation:  0.009877681732177734
local_output_nid generation:  0.0008330345153808594
local_in_edges_tensor generation:  0.0006034374237060547
mini_batch_src_global generation:  0.0010907649993896484
r_  generation:  0.010225296020507812
local_output_nid generation:  0.0008409023284912109
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.0010924339294433594
r_  generation:  0.010021686553955078
local_output_nid generation:  0.0008347034454345703
local_in_edges_tensor generation:  0.000629425048828125
mini_batch_src_global generation:  0.0011715888977050781
r_  generation:  0.009995460510253906
local_output_nid generation:  0.0008273124694824219
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.0010824203491210938
r_  generation:  0.010083198547363281
local_output_nid generation:  0.0008356571197509766
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.009910345077514648
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0005311965942382812
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.010094404220581055
local_output_nid generation:  0.0008294582366943359
local_in_edges_tensor generation:  0.0005440711975097656
mini_batch_src_global generation:  0.0012302398681640625
r_  generation:  0.010344743728637695
local_output_nid generation:  0.0008292198181152344
local_in_edges_tensor generation:  0.0005540847778320312
mini_batch_src_global generation:  0.001169443130493164
r_  generation:  0.01054692268371582
local_output_nid generation:  0.0008411407470703125
local_in_edges_tensor generation:  0.0005519390106201172
mini_batch_src_global generation:  0.0011987686157226562
r_  generation:  0.009902238845825195
local_output_nid generation:  0.0008335113525390625
local_in_edges_tensor generation:  0.0005652904510498047
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.010173559188842773
----------------------check_connections_block total spend ----------------------------- 0.5098531246185303
generate_one_block  0.023276329040527344
generate_one_block  0.019612789154052734
generate_one_block  0.017464876174926758
generate_one_block  0.01817917823791504
generate_one_block  0.018129825592041016
generate_one_block  0.017653942108154297
generate_one_block  0.017417430877685547
generate_one_block  0.017021894454956055
generate_one_block  0.01760244369506836
generate_one_block  0.016908884048461914
generate_one_block  0.01685190200805664
generate_one_block  0.01944279670715332
generate_one_block  0.01774311065673828
generate_one_block  0.0169677734375
generate_one_block  0.017162561416625977
generate_one_block  0.017243146896362305
generate_one_block  0.017328977584838867
generate_one_block  0.017446517944335938
generate_one_block  0.018383264541625977
generate_one_block  0.01802539825439453
generate_one_block  0.01805901527404785
generate_one_block  0.016843080520629883
generate_one_block  0.0177309513092041
generate_one_block  0.016851186752319336
generate_one_block  0.01706671714782715
generate_one_block  0.017289400100708008
generate_one_block  0.016932249069213867
generate_one_block  0.017118453979492188
generate_one_block  0.017507076263427734
generate_one_block  0.01798868179321289
generate_one_block  0.0167999267578125
generate_one_block  0.01734161376953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034697771072387695
gen group dst list time:  0.020487546920776367
time for parepare:  0.020174026489257812
local_output_nid generation:  0.005166530609130859
local_in_edges_tensor generation:  0.01863694190979004
mini_batch_src_global generation:  0.013535022735595703
r_  generation:  0.1323850154876709
local_output_nid generation:  0.007433652877807617
local_in_edges_tensor generation:  0.00969552993774414
mini_batch_src_global generation:  0.01826930046081543
r_  generation:  0.14243316650390625
local_output_nid generation:  0.007539510726928711
local_in_edges_tensor generation:  0.03080439567565918
mini_batch_src_global generation:  0.016527175903320312
r_  generation:  0.14416813850402832
local_output_nid generation:  0.008015632629394531
local_in_edges_tensor generation:  0.010116100311279297
mini_batch_src_global generation:  0.018536090850830078
r_  generation:  0.15455293655395508
local_output_nid generation:  0.008510828018188477
local_in_edges_tensor generation:  0.01036381721496582
mini_batch_src_global generation:  0.018567323684692383
r_  generation:  0.1547086238861084
local_output_nid generation:  0.008468866348266602
local_in_edges_tensor generation:  0.010353565216064453
mini_batch_src_global generation:  0.019170284271240234
r_  generation:  0.15495967864990234
local_output_nid generation:  0.008550643920898438
local_in_edges_tensor generation:  0.009792566299438477
mini_batch_src_global generation:  0.019587993621826172
r_  generation:  0.15320897102355957
local_output_nid generation:  0.008241891860961914
local_in_edges_tensor generation:  0.007976293563842773
mini_batch_src_global generation:  0.018430709838867188
r_  generation:  0.15184736251831055
local_output_nid generation:  0.008228540420532227
local_in_edges_tensor generation:  0.008810997009277344
mini_batch_src_global generation:  0.019203901290893555
r_  generation:  0.15505647659301758
local_output_nid generation:  0.008442878723144531
local_in_edges_tensor generation:  0.008124351501464844
mini_batch_src_global generation:  0.018437862396240234
r_  generation:  0.1508769989013672
local_output_nid generation:  0.008515119552612305
local_in_edges_tensor generation:  0.008015632629394531
mini_batch_src_global generation:  0.018273353576660156
r_  generation:  0.1470646858215332
local_output_nid generation:  0.008902788162231445
local_in_edges_tensor generation:  0.008416891098022461
mini_batch_src_global generation:  0.01914811134338379
r_  generation:  0.15473651885986328
local_output_nid generation:  0.008841276168823242
local_in_edges_tensor generation:  0.008042335510253906
mini_batch_src_global generation:  0.019233226776123047
r_  generation:  0.15503215789794922
local_output_nid generation:  0.008652687072753906
local_in_edges_tensor generation:  0.00811457633972168
mini_batch_src_global generation:  0.019115686416625977
r_  generation:  0.15306520462036133
local_output_nid generation:  0.008809566497802734
local_in_edges_tensor generation:  0.008118867874145508
mini_batch_src_global generation:  0.01894402503967285
r_  generation:  0.15588593482971191
local_output_nid generation:  0.008633852005004883
local_in_edges_tensor generation:  0.011253118515014648
mini_batch_src_global generation:  0.018753528594970703
r_  generation:  0.15464067459106445
local_output_nid generation:  0.008816242218017578
local_in_edges_tensor generation:  0.009454011917114258
mini_batch_src_global generation:  0.019029617309570312
r_  generation:  0.15304327011108398
local_output_nid generation:  0.008949518203735352
local_in_edges_tensor generation:  0.00839376449584961
mini_batch_src_global generation:  0.01895904541015625
r_  generation:  0.15947866439819336
local_output_nid generation:  0.009356975555419922
local_in_edges_tensor generation:  0.009777545928955078
mini_batch_src_global generation:  0.020865201950073242
r_  generation:  0.16271400451660156
local_output_nid generation:  0.008655548095703125
local_in_edges_tensor generation:  0.010210752487182617
mini_batch_src_global generation:  0.01907205581665039
r_  generation:  0.14907431602478027
local_output_nid generation:  0.009091854095458984
local_in_edges_tensor generation:  0.008439302444458008
mini_batch_src_global generation:  0.019346237182617188
r_  generation:  0.15621018409729004
local_output_nid generation:  0.00875997543334961
local_in_edges_tensor generation:  0.008124351501464844
mini_batch_src_global generation:  0.01843094825744629
r_  generation:  0.15454435348510742
local_output_nid generation:  0.010019540786743164
local_in_edges_tensor generation:  0.008986949920654297
mini_batch_src_global generation:  0.020036697387695312
r_  generation:  0.15714621543884277
local_output_nid generation:  0.008856773376464844
local_in_edges_tensor generation:  0.00826716423034668
mini_batch_src_global generation:  0.018682003021240234
r_  generation:  0.15293598175048828
local_output_nid generation:  0.008896589279174805
local_in_edges_tensor generation:  0.008701562881469727
mini_batch_src_global generation:  0.01856708526611328
r_  generation:  0.1499621868133545
local_output_nid generation:  0.008986711502075195
local_in_edges_tensor generation:  0.008799552917480469
mini_batch_src_global generation:  0.018555641174316406
r_  generation:  0.15501666069030762
local_output_nid generation:  0.008840560913085938
local_in_edges_tensor generation:  0.008819580078125
mini_batch_src_global generation:  0.018456459045410156
r_  generation:  0.15067601203918457
local_output_nid generation:  0.009021282196044922
local_in_edges_tensor generation:  0.008800983428955078
mini_batch_src_global generation:  0.018810749053955078
r_  generation:  0.15587210655212402
local_output_nid generation:  0.009092092514038086
local_in_edges_tensor generation:  0.009001016616821289
mini_batch_src_global generation:  0.019513607025146484
r_  generation:  0.16005849838256836
local_output_nid generation:  0.009414434432983398
local_in_edges_tensor generation:  0.01177978515625
mini_batch_src_global generation:  0.019751548767089844
r_  generation:  0.16409921646118164
local_output_nid generation:  0.008863449096679688
local_in_edges_tensor generation:  0.008581161499023438
mini_batch_src_global generation:  0.018903017044067383
r_  generation:  0.151503324508667
local_output_nid generation:  0.009027481079101562
local_in_edges_tensor generation:  0.00889444351196289
mini_batch_src_global generation:  0.018708229064941406
r_  generation:  0.15709328651428223
----------------------check_connections_block total spend ----------------------------- 7.276183366775513
generate_one_block  0.19734668731689453
generate_one_block  0.19884371757507324
generate_one_block  0.20186305046081543
generate_one_block  0.21232271194458008
generate_one_block  0.22556757926940918
generate_one_block  0.20762038230895996
generate_one_block  0.2057628631591797
generate_one_block  0.19783663749694824
generate_one_block  0.20396637916564941
generate_one_block  0.19814157485961914
generate_one_block  0.19494318962097168
generate_one_block  0.2080078125
generate_one_block  0.20770645141601562
generate_one_block  0.19992446899414062
generate_one_block  0.20160722732543945
generate_one_block  0.1993870735168457
generate_one_block  0.20284080505371094
generate_one_block  0.20573210716247559
generate_one_block  0.21536803245544434
generate_one_block  0.20549488067626953
generate_one_block  0.20700764656066895
generate_one_block  0.19627022743225098
generate_one_block  0.20627164840698242
generate_one_block  0.19932222366333008
generate_one_block  0.19763827323913574
generate_one_block  0.200148344039917
generate_one_block  0.19846272468566895
generate_one_block  0.20646214485168457
generate_one_block  0.2064530849456787
generate_one_block  0.2146000862121582
generate_one_block  0.19815349578857422
generate_one_block  0.20214104652404785
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031418800354003906
gen group dst list time:  0.10045862197875977
time for parepare:  0.02054619789123535
local_output_nid generation:  0.02343440055847168
local_in_edges_tensor generation:  0.04272747039794922
mini_batch_src_global generation:  0.037499427795410156
r_  generation:  0.4068117141723633
local_output_nid generation:  0.02860426902770996
local_in_edges_tensor generation:  0.03219866752624512
mini_batch_src_global generation:  0.048763275146484375
r_  generation:  0.3994481563568115
local_output_nid generation:  0.028569936752319336
local_in_edges_tensor generation:  0.025128841400146484
mini_batch_src_global generation:  0.04630780220031738
r_  generation:  0.4116380214691162
local_output_nid generation:  0.029134750366210938
local_in_edges_tensor generation:  0.028827667236328125
mini_batch_src_global generation:  0.04938340187072754
r_  generation:  0.4132976531982422
local_output_nid generation:  0.029066801071166992
local_in_edges_tensor generation:  0.02908921241760254
mini_batch_src_global generation:  0.04809236526489258
r_  generation:  0.41895580291748047
local_output_nid generation:  0.028947114944458008
local_in_edges_tensor generation:  0.027673959732055664
mini_batch_src_global generation:  0.0492551326751709
r_  generation:  0.40966367721557617
local_output_nid generation:  0.027266502380371094
local_in_edges_tensor generation:  0.029468059539794922
mini_batch_src_global generation:  0.04945945739746094
r_  generation:  0.41629815101623535
local_output_nid generation:  0.027158260345458984
local_in_edges_tensor generation:  0.027506351470947266
mini_batch_src_global generation:  0.05059456825256348
r_  generation:  0.4044358730316162
local_output_nid generation:  0.027348995208740234
local_in_edges_tensor generation:  0.025670766830444336
mini_batch_src_global generation:  0.04758644104003906
r_  generation:  0.4169502258300781
local_output_nid generation:  0.026966333389282227
local_in_edges_tensor generation:  0.02706313133239746
mini_batch_src_global generation:  0.0489041805267334
r_  generation:  0.40370965003967285
local_output_nid generation:  0.02701282501220703
local_in_edges_tensor generation:  0.025490522384643555
mini_batch_src_global generation:  0.04718589782714844
r_  generation:  0.4144129753112793
local_output_nid generation:  0.027617216110229492
local_in_edges_tensor generation:  0.027451038360595703
mini_batch_src_global generation:  0.04989790916442871
r_  generation:  0.4086318016052246
local_output_nid generation:  0.02732086181640625
local_in_edges_tensor generation:  0.030418872833251953
mini_batch_src_global generation:  0.04730367660522461
r_  generation:  0.41623473167419434
local_output_nid generation:  0.027190208435058594
local_in_edges_tensor generation:  0.025826454162597656
mini_batch_src_global generation:  0.04871225357055664
r_  generation:  0.4066886901855469
local_output_nid generation:  0.027383089065551758
local_in_edges_tensor generation:  0.027536630630493164
mini_batch_src_global generation:  0.04874444007873535
r_  generation:  0.4170694351196289
local_output_nid generation:  0.02754807472229004
local_in_edges_tensor generation:  0.02608776092529297
mini_batch_src_global generation:  0.048804521560668945
r_  generation:  0.4068763256072998
local_output_nid generation:  0.027365684509277344
local_in_edges_tensor generation:  0.028885602951049805
mini_batch_src_global generation:  0.04714560508728027
r_  generation:  0.4249694347381592
local_output_nid generation:  0.02758002281188965
local_in_edges_tensor generation:  0.02799081802368164
mini_batch_src_global generation:  0.049840688705444336
r_  generation:  0.4105265140533447
local_output_nid generation:  0.028487443923950195
local_in_edges_tensor generation:  0.033150672912597656
mini_batch_src_global generation:  0.04959440231323242
r_  generation:  0.42505908012390137
local_output_nid generation:  0.02741217613220215
local_in_edges_tensor generation:  0.02597355842590332
mini_batch_src_global generation:  0.04837369918823242
r_  generation:  0.40897345542907715
local_output_nid generation:  0.02893686294555664
local_in_edges_tensor generation:  0.025941133499145508
mini_batch_src_global generation:  0.04693961143493652
r_  generation:  0.4206690788269043
local_output_nid generation:  0.028194189071655273
local_in_edges_tensor generation:  0.025508642196655273
mini_batch_src_global generation:  0.048590898513793945
r_  generation:  0.41211628913879395
local_output_nid generation:  0.029143095016479492
local_in_edges_tensor generation:  0.027791738510131836
mini_batch_src_global generation:  0.0496518611907959
r_  generation:  0.4229612350463867
local_output_nid generation:  0.028411388397216797
local_in_edges_tensor generation:  0.026392459869384766
mini_batch_src_global generation:  0.04877901077270508
r_  generation:  0.4103527069091797
local_output_nid generation:  0.02831864356994629
local_in_edges_tensor generation:  0.02714061737060547
mini_batch_src_global generation:  0.04853415489196777
r_  generation:  0.41968512535095215
local_output_nid generation:  0.028267383575439453
local_in_edges_tensor generation:  0.026534318923950195
mini_batch_src_global generation:  0.048459768295288086
r_  generation:  0.4092233180999756
local_output_nid generation:  0.028043746948242188
local_in_edges_tensor generation:  0.030898571014404297
mini_batch_src_global generation:  0.048722267150878906
r_  generation:  0.41680288314819336
local_output_nid generation:  0.02815413475036621
local_in_edges_tensor generation:  0.026285886764526367
mini_batch_src_global generation:  0.04855799674987793
r_  generation:  0.4097921848297119
local_output_nid generation:  0.027857542037963867
local_in_edges_tensor generation:  0.02925252914428711
mini_batch_src_global generation:  0.04767632484436035
r_  generation:  0.4204874038696289
local_output_nid generation:  0.028445005416870117
local_in_edges_tensor generation:  0.027616262435913086
mini_batch_src_global generation:  0.051167964935302734
r_  generation:  0.4173705577850342
local_output_nid generation:  0.027970552444458008
local_in_edges_tensor generation:  0.026198863983154297
mini_batch_src_global generation:  0.047144174575805664
r_  generation:  0.41774964332580566
local_output_nid generation:  0.028496980667114258
local_in_edges_tensor generation:  0.026985645294189453
mini_batch_src_global generation:  0.05308032035827637
r_  generation:  0.4147360324859619
----------------------check_connections_block total spend ----------------------------- 19.546897172927856
generate_one_block  0.557326078414917
generate_one_block  0.5442743301391602
generate_one_block  0.5463464260101318
generate_one_block  0.5578229427337646
generate_one_block  0.6470270156860352
generate_one_block  0.551177978515625
generate_one_block  0.547558069229126
generate_one_block  0.547081708908081
generate_one_block  0.5486550331115723
generate_one_block  0.541731595993042
generate_one_block  0.5380802154541016
generate_one_block  0.5563364028930664
generate_one_block  0.5537338256835938
generate_one_block  0.5439891815185547
generate_one_block  0.5441033840179443
generate_one_block  0.5411195755004883
generate_one_block  0.5546300411224365
generate_one_block  0.5542564392089844
generate_one_block  0.5603914260864258
generate_one_block  0.5410721302032471
generate_one_block  0.5534892082214355
generate_one_block  0.5463986396789551
generate_one_block  0.5545282363891602
generate_one_block  0.5568370819091797
generate_one_block  0.5609047412872314
generate_one_block  0.5482761859893799
generate_one_block  0.554088830947876
generate_one_block  0.5543134212493896
generate_one_block  0.5579946041107178
generate_one_block  0.568291187286377
generate_one_block  0.5457720756530762
generate_one_block  0.5484576225280762
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12221336364746094  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

connection checking time:  26.82308053970337
block generation total time  24.249280214309692
average batch blocks generation time:  0.7577900066971779
block dataloader generation time/epoch 54.44535986582438
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10517692565917969  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.56627321243286  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10469770431518555  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.744338035583496  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521936416625977  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.725659370422363  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10486078262329102  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.326438903808594  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10532283782958984  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.207046508789062  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10478401184082031  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.182674407958984  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526800155639648  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.017893314361572  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10462188720703125  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.73194932937622  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527515411376953  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.053966522216797  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10442447662353516  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.66986608505249  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518026351928711  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.548551082611084  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10486268997192383  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.094901084899902  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052708625793457  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.048091888427734  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10459375381469727  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.762722492218018  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052389144897461  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.889873504638672  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10463666915893555  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.759450435638428  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524559020996094  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.928551197052002  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10477352142333984  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.090827465057373  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10538196563720703  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.50835084915161  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10436582565307617  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.435542583465576  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528993606567383  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.137985706329346  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10472679138183594  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.664418697357178  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052846908569336  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.155873775482178  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1049041748046875  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.756149768829346  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518789291381836  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.630889892578125  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10471963882446289  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.813290119171143  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518932342529297  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.6474609375  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10465621948242188  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.9574933052063  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528373718261719  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.077168941497803  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10517120361328125  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.42808961868286  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520505905151367  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.685000896453857  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10471630096435547  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.898005962371826  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03446540981531143 |0.014981038868427277 |0.41536572575569153 |9.368360042572021e-05 |0.7608474567532539 |0.005527973175048828 |
----------------------------------------------------------pseudo_mini_loss sum 1.3444387912750244
Total (block generation + training)time/epoch 93.58082632223766
Training time/epoch 39.27954411506653
Training time without block to device /epoch 38.800150871276855
Training time without total dataloading part /epoch 37.64734768867493
load block tensor time/epoch 1.1028931140899658
block to device time/epoch 0.47939324378967285
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  8792849
Number of first layer input nodes during this epoch:  4680428
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12342500686645508  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02524733543395996
range selection method range initialization spend 0.01376795768737793
time for parepare:  0.01904010772705078
local_output_nid generation:  0.0010066032409667969
local_in_edges_tensor generation:  0.005065202713012695
mini_batch_src_global generation:  0.0017254352569580078
r_  generation:  0.010708332061767578
local_output_nid generation:  0.0009911060333251953
local_in_edges_tensor generation:  0.0006673336029052734
mini_batch_src_global generation:  0.0015590190887451172
r_  generation:  0.010419130325317383
local_output_nid generation:  0.0008938312530517578
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0010807514190673828
r_  generation:  0.009767532348632812
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0005536079406738281
mini_batch_src_global generation:  0.0010421276092529297
r_  generation:  0.009679794311523438
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0010771751403808594
r_  generation:  0.010030269622802734
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.0005800724029541016
mini_batch_src_global generation:  0.001102447509765625
r_  generation:  0.01024174690246582
local_output_nid generation:  0.0008883476257324219
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.001096963882446289
r_  generation:  0.010296821594238281
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.0005483627319335938
mini_batch_src_global generation:  0.0010495185852050781
r_  generation:  0.00999140739440918
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.0005595684051513672
mini_batch_src_global generation:  0.0010905265808105469
r_  generation:  0.010184764862060547
local_output_nid generation:  0.0008521080017089844
local_in_edges_tensor generation:  0.0005438327789306641
mini_batch_src_global generation:  0.0011167526245117188
r_  generation:  0.010221242904663086
local_output_nid generation:  0.0008437633514404297
local_in_edges_tensor generation:  0.0005555152893066406
mini_batch_src_global generation:  0.0011110305786132812
r_  generation:  0.009998083114624023
local_output_nid generation:  0.0008440017700195312
local_in_edges_tensor generation:  0.0005855560302734375
mini_batch_src_global generation:  0.0012025833129882812
r_  generation:  0.010539531707763672
local_output_nid generation:  0.0008592605590820312
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0012362003326416016
r_  generation:  0.010746955871582031
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0005576610565185547
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.009938955307006836
local_output_nid generation:  0.0008523464202880859
local_in_edges_tensor generation:  0.0005521774291992188
mini_batch_src_global generation:  0.0011990070343017578
r_  generation:  0.010263442993164062
local_output_nid generation:  0.000843048095703125
local_in_edges_tensor generation:  0.0005545616149902344
mini_batch_src_global generation:  0.001110076904296875
r_  generation:  0.01019430160522461
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.0005512237548828125
mini_batch_src_global generation:  0.0010821819305419922
r_  generation:  0.009924173355102539
local_output_nid generation:  0.0008554458618164062
local_in_edges_tensor generation:  0.0005466938018798828
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.01013040542602539
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0011343955993652344
r_  generation:  0.010539531707763672
local_output_nid generation:  0.0008447170257568359
local_in_edges_tensor generation:  0.000545501708984375
mini_batch_src_global generation:  0.001074075698852539
r_  generation:  0.009694337844848633
local_output_nid generation:  0.0008487701416015625
local_in_edges_tensor generation:  0.0005402565002441406
mini_batch_src_global generation:  0.0010824203491210938
r_  generation:  0.010288000106811523
local_output_nid generation:  0.0008466243743896484
local_in_edges_tensor generation:  0.002256631851196289
mini_batch_src_global generation:  0.0011112689971923828
r_  generation:  0.010177373886108398
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0005650520324707031
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.01000070571899414
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.001186370849609375
r_  generation:  0.010438919067382812
local_output_nid generation:  0.0008480548858642578
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.010143280029296875
local_output_nid generation:  0.0008494853973388672
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.0012183189392089844
r_  generation:  0.010645866394042969
local_output_nid generation:  0.0008416175842285156
local_in_edges_tensor generation:  0.0005650520324707031
mini_batch_src_global generation:  0.001188516616821289
r_  generation:  0.010284900665283203
local_output_nid generation:  0.0008432865142822266
local_in_edges_tensor generation:  0.0005638599395751953
mini_batch_src_global generation:  0.0010700225830078125
r_  generation:  0.010047197341918945
local_output_nid generation:  0.0008575916290283203
local_in_edges_tensor generation:  0.002081155776977539
mini_batch_src_global generation:  0.0011260509490966797
r_  generation:  0.010266542434692383
local_output_nid generation:  0.0008432865142822266
local_in_edges_tensor generation:  0.0005395412445068359
mini_batch_src_global generation:  0.0010821819305419922
r_  generation:  0.010058879852294922
local_output_nid generation:  0.0008485317230224609
local_in_edges_tensor generation:  0.0005548000335693359
mini_batch_src_global generation:  0.001073598861694336
r_  generation:  0.01007390022277832
local_output_nid generation:  0.0008373260498046875
local_in_edges_tensor generation:  0.0005323886871337891
mini_batch_src_global generation:  0.0010790824890136719
r_  generation:  0.010112762451171875
----------------------check_connections_block total spend ----------------------------- 0.5141279697418213
generate_one_block  0.023446083068847656
generate_one_block  0.01983356475830078
generate_one_block  0.019303321838378906
generate_one_block  0.017238855361938477
generate_one_block  0.017828702926635742
generate_one_block  0.017686843872070312
generate_one_block  0.01755523681640625
generate_one_block  0.018871784210205078
generate_one_block  0.01751399040222168
generate_one_block  0.01758861541748047
generate_one_block  0.017181873321533203
generate_one_block  0.020086050033569336
generate_one_block  0.018790483474731445
generate_one_block  0.018331527709960938
generate_one_block  0.017733335494995117
generate_one_block  0.017348527908325195
generate_one_block  0.017331838607788086
generate_one_block  0.01729440689086914
generate_one_block  0.018052339553833008
generate_one_block  0.01866912841796875
generate_one_block  0.0174558162689209
generate_one_block  0.017229318618774414
generate_one_block  0.017281055450439453
generate_one_block  0.017635822296142578
generate_one_block  0.017294883728027344
generate_one_block  0.02062821388244629
generate_one_block  0.01757073402404785
generate_one_block  0.016978740692138672
generate_one_block  0.017383813858032227
generate_one_block  0.016887903213500977
generate_one_block  0.016936302185058594
generate_one_block  0.01994180679321289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04153323173522949
gen group dst list time:  0.024037599563598633
time for parepare:  0.022312164306640625
local_output_nid generation:  0.0078122615814208984
local_in_edges_tensor generation:  0.016880273818969727
mini_batch_src_global generation:  0.0157623291015625
r_  generation:  0.14202475547790527
local_output_nid generation:  0.010438203811645508
local_in_edges_tensor generation:  0.011593103408813477
mini_batch_src_global generation:  0.018597841262817383
r_  generation:  0.1753709316253662
local_output_nid generation:  0.007737159729003906
local_in_edges_tensor generation:  0.032006025314331055
mini_batch_src_global generation:  0.016576290130615234
r_  generation:  0.14946269989013672
local_output_nid generation:  0.007990360260009766
local_in_edges_tensor generation:  0.010370492935180664
mini_batch_src_global generation:  0.018013477325439453
r_  generation:  0.14852309226989746
local_output_nid generation:  0.008426666259765625
local_in_edges_tensor generation:  0.009438753128051758
mini_batch_src_global generation:  0.018955230712890625
r_  generation:  0.1563434600830078
local_output_nid generation:  0.008627176284790039
local_in_edges_tensor generation:  0.009592056274414062
mini_batch_src_global generation:  0.022627592086791992
r_  generation:  0.15508079528808594
local_output_nid generation:  0.008753538131713867
local_in_edges_tensor generation:  0.01009821891784668
mini_batch_src_global generation:  0.018578529357910156
r_  generation:  0.15642642974853516
local_output_nid generation:  0.0092315673828125
local_in_edges_tensor generation:  0.009786367416381836
mini_batch_src_global generation:  0.019290685653686523
r_  generation:  0.15029263496398926
local_output_nid generation:  0.008580207824707031
local_in_edges_tensor generation:  0.00840616226196289
mini_batch_src_global generation:  0.021752119064331055
r_  generation:  0.15275049209594727
local_output_nid generation:  0.008811473846435547
local_in_edges_tensor generation:  0.010841608047485352
mini_batch_src_global generation:  0.019256591796875
r_  generation:  0.15520000457763672
local_output_nid generation:  0.008753061294555664
local_in_edges_tensor generation:  0.008871316909790039
mini_batch_src_global generation:  0.018736600875854492
r_  generation:  0.15071940422058105
local_output_nid generation:  0.009254217147827148
local_in_edges_tensor generation:  0.008290767669677734
mini_batch_src_global generation:  0.020337581634521484
r_  generation:  0.15747976303100586
local_output_nid generation:  0.0093536376953125
local_in_edges_tensor generation:  0.011234760284423828
mini_batch_src_global generation:  0.020693063735961914
r_  generation:  0.16060090065002441
local_output_nid generation:  0.008689165115356445
local_in_edges_tensor generation:  0.010317802429199219
mini_batch_src_global generation:  0.018979310989379883
r_  generation:  0.14582395553588867
local_output_nid generation:  0.009014606475830078
local_in_edges_tensor generation:  0.008837223052978516
mini_batch_src_global generation:  0.018855810165405273
r_  generation:  0.15717577934265137
local_output_nid generation:  0.00875234603881836
local_in_edges_tensor generation:  0.008543252944946289
mini_batch_src_global generation:  0.01940774917602539
r_  generation:  0.15317034721374512
local_output_nid generation:  0.008733510971069336
local_in_edges_tensor generation:  0.008337736129760742
mini_batch_src_global generation:  0.01868748664855957
r_  generation:  0.15820074081420898
local_output_nid generation:  0.010223627090454102
local_in_edges_tensor generation:  0.008667469024658203
mini_batch_src_global generation:  0.019603967666625977
r_  generation:  0.15272760391235352
local_output_nid generation:  0.009604930877685547
local_in_edges_tensor generation:  0.008460760116577148
mini_batch_src_global generation:  0.01954960823059082
r_  generation:  0.15781807899475098
local_output_nid generation:  0.008749723434448242
local_in_edges_tensor generation:  0.008079767227172852
mini_batch_src_global generation:  0.01865863800048828
r_  generation:  0.14525175094604492
local_output_nid generation:  0.009196996688842773
local_in_edges_tensor generation:  0.008871078491210938
mini_batch_src_global generation:  0.01878833770751953
r_  generation:  0.15397095680236816
local_output_nid generation:  0.009086847305297852
local_in_edges_tensor generation:  0.008437871932983398
mini_batch_src_global generation:  0.018726825714111328
r_  generation:  0.1547224521636963
local_output_nid generation:  0.009063005447387695
local_in_edges_tensor generation:  0.008405923843383789
mini_batch_src_global generation:  0.018574953079223633
r_  generation:  0.15271353721618652
local_output_nid generation:  0.009415149688720703
local_in_edges_tensor generation:  0.00857090950012207
mini_batch_src_global generation:  0.019216060638427734
r_  generation:  0.15655040740966797
local_output_nid generation:  0.00931239128112793
local_in_edges_tensor generation:  0.010225534439086914
mini_batch_src_global generation:  0.01887679100036621
r_  generation:  0.1559276580810547
local_output_nid generation:  0.009448051452636719
local_in_edges_tensor generation:  0.009231328964233398
mini_batch_src_global generation:  0.019608020782470703
r_  generation:  0.15904927253723145
local_output_nid generation:  0.009557008743286133
local_in_edges_tensor generation:  0.008922576904296875
mini_batch_src_global generation:  0.019164085388183594
r_  generation:  0.15805459022521973
local_output_nid generation:  0.009075641632080078
local_in_edges_tensor generation:  0.008848190307617188
mini_batch_src_global generation:  0.018847942352294922
r_  generation:  0.15477585792541504
local_output_nid generation:  0.009340763092041016
local_in_edges_tensor generation:  0.009014606475830078
mini_batch_src_global generation:  0.01898932456970215
r_  generation:  0.1586010456085205
local_output_nid generation:  0.009068965911865234
local_in_edges_tensor generation:  0.008293867111206055
mini_batch_src_global generation:  0.01897907257080078
r_  generation:  0.15412592887878418
local_output_nid generation:  0.009069442749023438
local_in_edges_tensor generation:  0.008365154266357422
mini_batch_src_global generation:  0.01833820343017578
r_  generation:  0.1645057201385498
local_output_nid generation:  0.009316682815551758
local_in_edges_tensor generation:  0.009018182754516602
mini_batch_src_global generation:  0.019453763961791992
r_  generation:  0.15514421463012695
----------------------check_connections_block total spend ----------------------------- 7.375658273696899
generate_one_block  0.22198176383972168
generate_one_block  0.20483016967773438
generate_one_block  0.2016608715057373
generate_one_block  0.19830322265625
generate_one_block  0.21901941299438477
generate_one_block  0.2061014175415039
generate_one_block  0.20532464981079102
generate_one_block  0.19614529609680176
generate_one_block  0.20194268226623535
generate_one_block  0.20710396766662598
generate_one_block  0.1984407901763916
generate_one_block  0.21075010299682617
generate_one_block  0.21893310546875
generate_one_block  0.19704580307006836
generate_one_block  0.20837998390197754
generate_one_block  0.20668911933898926
generate_one_block  0.2074136734008789
generate_one_block  0.20603728294372559
generate_one_block  0.2088925838470459
generate_one_block  0.1991891860961914
generate_one_block  0.2050914764404297
generate_one_block  0.20743680000305176
generate_one_block  0.20271539688110352
generate_one_block  0.21933960914611816
generate_one_block  0.20958209037780762
generate_one_block  0.2173447608947754
generate_one_block  0.20898151397705078
generate_one_block  0.20276641845703125
generate_one_block  0.20835447311401367
generate_one_block  0.2019340991973877
generate_one_block  0.19939231872558594
generate_one_block  0.20390629768371582
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03337574005126953
gen group dst list time:  0.10900735855102539
time for parepare:  0.01977372169494629
local_output_nid generation:  0.024163484573364258
local_in_edges_tensor generation:  0.049219608306884766
mini_batch_src_global generation:  0.03800773620605469
r_  generation:  0.40250420570373535
local_output_nid generation:  0.02826976776123047
local_in_edges_tensor generation:  0.03230023384094238
mini_batch_src_global generation:  0.0507962703704834
r_  generation:  0.4072299003601074
local_output_nid generation:  0.028838634490966797
local_in_edges_tensor generation:  0.026399612426757812
mini_batch_src_global generation:  0.048383235931396484
r_  generation:  0.4256596565246582
local_output_nid generation:  0.02901935577392578
local_in_edges_tensor generation:  0.026263952255249023
mini_batch_src_global generation:  0.05269026756286621
r_  generation:  0.41216230392456055
local_output_nid generation:  0.028986454010009766
local_in_edges_tensor generation:  0.02602696418762207
mini_batch_src_global generation:  0.04936933517456055
r_  generation:  0.4201819896697998
local_output_nid generation:  0.02903890609741211
local_in_edges_tensor generation:  0.03443312644958496
mini_batch_src_global generation:  0.0492095947265625
r_  generation:  0.41884660720825195
local_output_nid generation:  0.027155399322509766
local_in_edges_tensor generation:  0.030054330825805664
mini_batch_src_global generation:  0.04813098907470703
r_  generation:  0.42136216163635254
local_output_nid generation:  0.027523279190063477
local_in_edges_tensor generation:  0.029539108276367188
mini_batch_src_global generation:  0.05183529853820801
r_  generation:  0.423175573348999
local_output_nid generation:  0.027414560317993164
local_in_edges_tensor generation:  0.028636455535888672
mini_batch_src_global generation:  0.047968387603759766
r_  generation:  0.4233250617980957
local_output_nid generation:  0.029410123825073242
local_in_edges_tensor generation:  0.02914881706237793
mini_batch_src_global generation:  0.04932594299316406
r_  generation:  0.42306065559387207
local_output_nid generation:  0.02754497528076172
local_in_edges_tensor generation:  0.02785468101501465
mini_batch_src_global generation:  0.047840118408203125
r_  generation:  0.41799449920654297
local_output_nid generation:  0.029398441314697266
local_in_edges_tensor generation:  0.03113269805908203
mini_batch_src_global generation:  0.05159258842468262
r_  generation:  0.4234280586242676
local_output_nid generation:  0.02888011932373047
local_in_edges_tensor generation:  0.032553911209106445
mini_batch_src_global generation:  0.04785490036010742
r_  generation:  0.4237329959869385
local_output_nid generation:  0.027536392211914062
local_in_edges_tensor generation:  0.030669689178466797
mini_batch_src_global generation:  0.04917430877685547
r_  generation:  0.4103395938873291
local_output_nid generation:  0.02762913703918457
local_in_edges_tensor generation:  0.029555082321166992
mini_batch_src_global generation:  0.047486305236816406
r_  generation:  0.4212796688079834
local_output_nid generation:  0.027988672256469727
local_in_edges_tensor generation:  0.026549577713012695
mini_batch_src_global generation:  0.04906415939331055
r_  generation:  0.41824936866760254
local_output_nid generation:  0.027743101119995117
local_in_edges_tensor generation:  0.02999734878540039
mini_batch_src_global generation:  0.048223018646240234
r_  generation:  0.43459415435791016
local_output_nid generation:  0.029559612274169922
local_in_edges_tensor generation:  0.028648853302001953
mini_batch_src_global generation:  0.05214214324951172
r_  generation:  0.41763734817504883
local_output_nid generation:  0.02956986427307129
local_in_edges_tensor generation:  0.027751684188842773
mini_batch_src_global generation:  0.05011463165283203
r_  generation:  0.42096447944641113
local_output_nid generation:  0.027997970581054688
local_in_edges_tensor generation:  0.026584863662719727
mini_batch_src_global generation:  0.04860353469848633
r_  generation:  0.41524529457092285
local_output_nid generation:  0.028278827667236328
local_in_edges_tensor generation:  0.02625274658203125
mini_batch_src_global generation:  0.04783225059509277
r_  generation:  0.41533780097961426
local_output_nid generation:  0.028138399124145508
local_in_edges_tensor generation:  0.026990413665771484
mini_batch_src_global generation:  0.04909348487854004
r_  generation:  0.42032599449157715
local_output_nid generation:  0.028319835662841797
local_in_edges_tensor generation:  0.0275728702545166
mini_batch_src_global generation:  0.04712176322937012
r_  generation:  0.4170527458190918
local_output_nid generation:  0.02891397476196289
local_in_edges_tensor generation:  0.02936840057373047
mini_batch_src_global generation:  0.05426931381225586
r_  generation:  0.4201021194458008
local_output_nid generation:  0.028592348098754883
local_in_edges_tensor generation:  0.02819991111755371
mini_batch_src_global generation:  0.04774141311645508
r_  generation:  0.4261021614074707
local_output_nid generation:  0.028596162796020508
local_in_edges_tensor generation:  0.02661919593811035
mini_batch_src_global generation:  0.05171823501586914
r_  generation:  0.4301755428314209
local_output_nid generation:  0.028808116912841797
local_in_edges_tensor generation:  0.027988433837890625
mini_batch_src_global generation:  0.04883527755737305
r_  generation:  0.42478084564208984
local_output_nid generation:  0.028247356414794922
local_in_edges_tensor generation:  0.026615619659423828
mini_batch_src_global generation:  0.049947500228881836
r_  generation:  0.41904616355895996
local_output_nid generation:  0.0286407470703125
local_in_edges_tensor generation:  0.026334762573242188
mini_batch_src_global generation:  0.04773831367492676
r_  generation:  0.42665648460388184
local_output_nid generation:  0.02842426300048828
local_in_edges_tensor generation:  0.025948524475097656
mini_batch_src_global generation:  0.04955768585205078
r_  generation:  0.4206366539001465
local_output_nid generation:  0.02828073501586914
local_in_edges_tensor generation:  0.026196718215942383
mini_batch_src_global generation:  0.04739093780517578
r_  generation:  0.41675543785095215
local_output_nid generation:  0.028438806533813477
local_in_edges_tensor generation:  0.026202917098999023
mini_batch_src_global generation:  0.0496675968170166
r_  generation:  0.41840195655822754
----------------------check_connections_block total spend ----------------------------- 19.82785391807556
generate_one_block  0.5649516582489014
generate_one_block  0.5535027980804443
generate_one_block  0.557551383972168
generate_one_block  0.5494828224182129
generate_one_block  0.655226469039917
generate_one_block  0.5576112270355225
generate_one_block  0.5577480792999268
generate_one_block  0.5484304428100586
generate_one_block  0.561227560043335
generate_one_block  0.5595488548278809
generate_one_block  0.557347297668457
generate_one_block  0.5619852542877197
generate_one_block  0.5656106472015381
generate_one_block  0.5475151538848877
generate_one_block  0.5613696575164795
generate_one_block  0.560100793838501
generate_one_block  0.555495023727417
generate_one_block  0.5537989139556885
generate_one_block  0.556312084197998
generate_one_block  0.5519430637359619
generate_one_block  0.5590260028839111
generate_one_block  0.5652585029602051
generate_one_block  0.5561277866363525
generate_one_block  0.5658814907073975
generate_one_block  0.5849175453186035
generate_one_block  0.5655159950256348
generate_one_block  0.5621440410614014
generate_one_block  0.5507326126098633
generate_one_block  0.5586543083190918
generate_one_block  0.5641586780548096
generate_one_block  0.5499746799468994
generate_one_block  0.5576705932617188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12342500686645508  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

connection checking time:  27.20351219177246
block generation total time  24.587851762771606
average batch blocks generation time:  0.7683703675866127
block dataloader generation time/epoch 54.47179737457862
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526561737060547  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.056137084960938  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10474967956542969  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.770994663238525  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523033142089844  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.859266757965088  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10449600219726562  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.67079734802246  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526227951049805  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.06049919128418  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046605110168457  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.119735717773438  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527420043945312  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.05863666534424  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10467910766601562  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.696592330932617  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524606704711914  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.903390407562256  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10442304611206055  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.08134365081787  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052083969116211  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.74397087097168  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1048274040222168  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.23290729522705  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1053476333618164  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.391146659851074  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10445022583007812  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.385207176208496  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528373718261719  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.081109046936035  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10469436645507812  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.913888931274414  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523319244384766  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.899049758911133  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046295166015625  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.825124740600586  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529232025146484  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.182536602020264  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10439586639404297  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.304152011871338  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523509979248047  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.799950122833252  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10427427291870117  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.921742916107178  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520458221435547  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.709341526031494  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10483074188232422  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.118968963623047  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526180267333984  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.046656608581543  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10478925704956055  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.30143451690674  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527610778808594  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.08114004135132  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10451269149780273  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.777774810791016  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527563095092773  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.12323236465454  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10476064682006836  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.869033336639404  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052093505859375  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.648008346557617  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10480785369873047  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.895554542541504  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03526797890663147 |0.014420494437217712 |0.4157613143324852 |9.444355964660645e-05 |0.7555947825312614 |0.0066378116607666016 |
----------------------------------------------------------pseudo_mini_loss sum 1.320854902267456
Total (block generation + training)time/epoch 93.60728194163396
Training time/epoch 39.13546276092529
Training time without block to device /epoch 38.674006938934326
Training time without total dataloading part /epoch 37.49305510520935
load block tensor time/epoch 1.128575325012207
block to device time/epoch 0.4614558219909668
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  8794660
Number of first layer input nodes during this epoch:  4680372
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12367486953735352  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02446746826171875
range selection method range initialization spend 0.016745328903198242
time for parepare:  0.017522096633911133
local_output_nid generation:  0.0009455680847167969
local_in_edges_tensor generation:  0.004012346267700195
mini_batch_src_global generation:  0.0020492076873779297
r_  generation:  0.012193679809570312
local_output_nid generation:  0.0009784698486328125
local_in_edges_tensor generation:  0.0006706714630126953
mini_batch_src_global generation:  0.0014820098876953125
r_  generation:  0.010357856750488281
local_output_nid generation:  0.0009303092956542969
local_in_edges_tensor generation:  0.0006105899810791016
mini_batch_src_global generation:  0.0012001991271972656
r_  generation:  0.009793996810913086
local_output_nid generation:  0.0009036064147949219
local_in_edges_tensor generation:  0.0005829334259033203
mini_batch_src_global generation:  0.0011606216430664062
r_  generation:  0.009923458099365234
local_output_nid generation:  0.0008685588836669922
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.010111331939697266
local_output_nid generation:  0.0008559226989746094
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0011470317840576172
r_  generation:  0.010031461715698242
local_output_nid generation:  0.0008783340454101562
local_in_edges_tensor generation:  0.0005548000335693359
mini_batch_src_global generation:  0.0011169910430908203
r_  generation:  0.009967327117919922
local_output_nid generation:  0.0008835792541503906
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0011756420135498047
r_  generation:  0.010180234909057617
local_output_nid generation:  0.0008451938629150391
local_in_edges_tensor generation:  0.0005741119384765625
mini_batch_src_global generation:  0.0011782646179199219
r_  generation:  0.010666131973266602
local_output_nid generation:  0.0008420944213867188
local_in_edges_tensor generation:  0.0005743503570556641
mini_batch_src_global generation:  0.0012288093566894531
r_  generation:  0.010384798049926758
local_output_nid generation:  0.0008530616760253906
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.010061025619506836
local_output_nid generation:  0.0008709430694580078
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.0010938644409179688
r_  generation:  0.00996541976928711
local_output_nid generation:  0.0008416175842285156
local_in_edges_tensor generation:  0.0005598068237304688
mini_batch_src_global generation:  0.0012040138244628906
r_  generation:  0.010243415832519531
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0005514621734619141
mini_batch_src_global generation:  0.001226186752319336
r_  generation:  0.010393381118774414
local_output_nid generation:  0.0008518695831298828
local_in_edges_tensor generation:  0.0005800724029541016
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.010305166244506836
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.0011479854583740234
r_  generation:  0.010444402694702148
local_output_nid generation:  0.0008676052093505859
local_in_edges_tensor generation:  0.0005483627319335938
mini_batch_src_global generation:  0.0010776519775390625
r_  generation:  0.009799480438232422
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.0011670589447021484
r_  generation:  0.010056734085083008
local_output_nid generation:  0.0008509159088134766
local_in_edges_tensor generation:  0.0005443096160888672
mini_batch_src_global generation:  0.0010755062103271484
r_  generation:  0.009898662567138672
local_output_nid generation:  0.0008459091186523438
local_in_edges_tensor generation:  0.0005521774291992188
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.010250568389892578
local_output_nid generation:  0.0008523464202880859
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.010125160217285156
local_output_nid generation:  0.0008511543273925781
local_in_edges_tensor generation:  0.0005614757537841797
mini_batch_src_global generation:  0.0011372566223144531
r_  generation:  0.010375738143920898
local_output_nid generation:  0.0008373260498046875
local_in_edges_tensor generation:  0.0005393028259277344
mini_batch_src_global generation:  0.001119852066040039
r_  generation:  0.010059595108032227
local_output_nid generation:  0.0008392333984375
local_in_edges_tensor generation:  0.0005424022674560547
mini_batch_src_global generation:  0.0010716915130615234
r_  generation:  0.009900808334350586
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0005288124084472656
mini_batch_src_global generation:  0.0011928081512451172
r_  generation:  0.010090827941894531
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.00054168701171875
mini_batch_src_global generation:  0.0011196136474609375
r_  generation:  0.01007080078125
local_output_nid generation:  0.0008487701416015625
local_in_edges_tensor generation:  0.0005526542663574219
mini_batch_src_global generation:  0.0011489391326904297
r_  generation:  0.01029348373413086
local_output_nid generation:  0.0008518695831298828
local_in_edges_tensor generation:  0.0005509853363037109
mini_batch_src_global generation:  0.001191854476928711
r_  generation:  0.010169506072998047
local_output_nid generation:  0.0008487701416015625
local_in_edges_tensor generation:  0.0005621910095214844
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.010134458541870117
local_output_nid generation:  0.0008509159088134766
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.0011937618255615234
r_  generation:  0.010631799697875977
local_output_nid generation:  0.0008523464202880859
local_in_edges_tensor generation:  0.00054168701171875
mini_batch_src_global generation:  0.001188039779663086
r_  generation:  0.010227441787719727
local_output_nid generation:  0.0008356571197509766
local_in_edges_tensor generation:  0.000553131103515625
mini_batch_src_global generation:  0.0012085437774658203
r_  generation:  0.010408401489257812
----------------------check_connections_block total spend ----------------------------- 0.5114965438842773
generate_one_block  0.02363419532775879
generate_one_block  0.01982879638671875
generate_one_block  0.017792463302612305
generate_one_block  0.01748943328857422
generate_one_block  0.01790332794189453
generate_one_block  0.017540454864501953
generate_one_block  0.01715540885925293
generate_one_block  0.017563581466674805
generate_one_block  0.018141984939575195
generate_one_block  0.017693519592285156
generate_one_block  0.01706981658935547
generate_one_block  0.019124507904052734
generate_one_block  0.018095016479492188
generate_one_block  0.017708539962768555
generate_one_block  0.017331361770629883
generate_one_block  0.017751455307006836
generate_one_block  0.016727924346923828
generate_one_block  0.017164945602416992
generate_one_block  0.01672983169555664
generate_one_block  0.0173795223236084
generate_one_block  0.017186403274536133
generate_one_block  0.017459869384765625
generate_one_block  0.017132043838500977
generate_one_block  0.01657390594482422
generate_one_block  0.01707148551940918
generate_one_block  0.01686239242553711
generate_one_block  0.017467498779296875
generate_one_block  0.017088651657104492
generate_one_block  0.01725172996520996
generate_one_block  0.017787933349609375
generate_one_block  0.01706242561340332
generate_one_block  0.017414331436157227
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03643441200256348
gen group dst list time:  0.02238178253173828
time for parepare:  0.019635915756225586
local_output_nid generation:  0.005344390869140625
local_in_edges_tensor generation:  0.015843629837036133
mini_batch_src_global generation:  0.01638650894165039
r_  generation:  0.1416642665863037
local_output_nid generation:  0.007478952407836914
local_in_edges_tensor generation:  0.009635686874389648
mini_batch_src_global generation:  0.02044677734375
r_  generation:  0.14409756660461426
local_output_nid generation:  0.007648944854736328
local_in_edges_tensor generation:  0.030120849609375
mini_batch_src_global generation:  0.022991418838500977
r_  generation:  0.14797186851501465
local_output_nid generation:  0.007744789123535156
local_in_edges_tensor generation:  0.009612798690795898
mini_batch_src_global generation:  0.019835472106933594
r_  generation:  0.15018844604492188
local_output_nid generation:  0.008517742156982422
local_in_edges_tensor generation:  0.011040687561035156
mini_batch_src_global generation:  0.025052309036254883
r_  generation:  0.15337514877319336
local_output_nid generation:  0.008456230163574219
local_in_edges_tensor generation:  0.010119438171386719
mini_batch_src_global generation:  0.022557497024536133
r_  generation:  0.20287156105041504
local_output_nid generation:  0.008428812026977539
local_in_edges_tensor generation:  0.00808262825012207
mini_batch_src_global generation:  0.021602392196655273
r_  generation:  0.15940642356872559
local_output_nid generation:  0.01268148422241211
local_in_edges_tensor generation:  0.008444786071777344
mini_batch_src_global generation:  0.0214383602142334
r_  generation:  0.15361690521240234
local_output_nid generation:  0.008888721466064453
local_in_edges_tensor generation:  0.011014223098754883
mini_batch_src_global generation:  0.02279210090637207
r_  generation:  0.15704941749572754
local_output_nid generation:  0.00869607925415039
local_in_edges_tensor generation:  0.008116006851196289
mini_batch_src_global generation:  0.019260168075561523
r_  generation:  0.1559889316558838
local_output_nid generation:  0.008574247360229492
local_in_edges_tensor generation:  0.010435819625854492
mini_batch_src_global generation:  0.019431591033935547
r_  generation:  0.14891529083251953
local_output_nid generation:  0.008927106857299805
local_in_edges_tensor generation:  0.009119510650634766
mini_batch_src_global generation:  0.01824498176574707
r_  generation:  0.14714360237121582
local_output_nid generation:  0.009181499481201172
local_in_edges_tensor generation:  0.00815582275390625
mini_batch_src_global generation:  0.019255638122558594
r_  generation:  0.1540820598602295
local_output_nid generation:  0.009083747863769531
local_in_edges_tensor generation:  0.008124589920043945
mini_batch_src_global generation:  0.019047260284423828
r_  generation:  0.1543431282043457
local_output_nid generation:  0.009182929992675781
local_in_edges_tensor generation:  0.008706808090209961
mini_batch_src_global generation:  0.019263029098510742
r_  generation:  0.1540210247039795
local_output_nid generation:  0.009165287017822266
local_in_edges_tensor generation:  0.008872509002685547
mini_batch_src_global generation:  0.020328283309936523
r_  generation:  0.15975666046142578
local_output_nid generation:  0.008613348007202148
local_in_edges_tensor generation:  0.00796651840209961
mini_batch_src_global generation:  0.0185854434967041
r_  generation:  0.18279099464416504
local_output_nid generation:  0.012578964233398438
local_in_edges_tensor generation:  0.009081125259399414
mini_batch_src_global generation:  0.022205352783203125
r_  generation:  0.1560966968536377
local_output_nid generation:  0.008825063705444336
local_in_edges_tensor generation:  0.007925271987915039
mini_batch_src_global generation:  0.018604516983032227
r_  generation:  0.15165352821350098
local_output_nid generation:  0.009185791015625
local_in_edges_tensor generation:  0.00829458236694336
mini_batch_src_global generation:  0.018859386444091797
r_  generation:  0.15872406959533691
local_output_nid generation:  0.009127616882324219
local_in_edges_tensor generation:  0.008877277374267578
mini_batch_src_global generation:  0.01940774917602539
r_  generation:  0.15975069999694824
local_output_nid generation:  0.009132146835327148
local_in_edges_tensor generation:  0.009718894958496094
mini_batch_src_global generation:  0.019013643264770508
r_  generation:  0.15935468673706055
local_output_nid generation:  0.00926661491394043
local_in_edges_tensor generation:  0.008206367492675781
mini_batch_src_global generation:  0.01933574676513672
r_  generation:  0.15642619132995605
local_output_nid generation:  0.008912324905395508
local_in_edges_tensor generation:  0.010741472244262695
mini_batch_src_global generation:  0.018200159072875977
r_  generation:  0.15422272682189941
local_output_nid generation:  0.012448787689208984
local_in_edges_tensor generation:  0.00858306884765625
mini_batch_src_global generation:  0.01920008659362793
r_  generation:  0.16176652908325195
local_output_nid generation:  0.009305238723754883
local_in_edges_tensor generation:  0.009352922439575195
mini_batch_src_global generation:  0.019183874130249023
r_  generation:  0.159257173538208
local_output_nid generation:  0.009265661239624023
local_in_edges_tensor generation:  0.009770870208740234
mini_batch_src_global generation:  0.020264625549316406
r_  generation:  0.16248440742492676
local_output_nid generation:  0.009200811386108398
local_in_edges_tensor generation:  0.0102996826171875
mini_batch_src_global generation:  0.018646955490112305
r_  generation:  0.1576976776123047
local_output_nid generation:  0.009330987930297852
local_in_edges_tensor generation:  0.009090423583984375
mini_batch_src_global generation:  0.021084308624267578
r_  generation:  0.1817948818206787
local_output_nid generation:  0.009561538696289062
local_in_edges_tensor generation:  0.014502525329589844
mini_batch_src_global generation:  0.019613981246948242
r_  generation:  0.16363072395324707
local_output_nid generation:  0.00926661491394043
local_in_edges_tensor generation:  0.00857853889465332
mini_batch_src_global generation:  0.019176721572875977
r_  generation:  0.17193150520324707
local_output_nid generation:  0.010469913482666016
local_in_edges_tensor generation:  0.009334564208984375
mini_batch_src_global generation:  0.02007317543029785
r_  generation:  0.1575162410736084
----------------------check_connections_block total spend ----------------------------- 7.527257919311523
generate_one_block  0.21973443031311035
generate_one_block  0.2029709815979004
generate_one_block  0.20308899879455566
generate_one_block  0.20575380325317383
generate_one_block  0.22320938110351562
generate_one_block  0.20565271377563477
generate_one_block  0.2020244598388672
generate_one_block  0.20549988746643066
generate_one_block  0.2118515968322754
generate_one_block  0.20902800559997559
generate_one_block  0.2045116424560547
generate_one_block  0.21498918533325195
generate_one_block  0.20943427085876465
generate_one_block  0.21048903465270996
generate_one_block  0.2067110538482666
generate_one_block  0.21370983123779297
generate_one_block  0.2033519744873047
generate_one_block  0.20471906661987305
generate_one_block  0.1985933780670166
generate_one_block  0.21410918235778809
generate_one_block  0.2106459140777588
generate_one_block  0.21246838569641113
generate_one_block  0.2095179557800293
generate_one_block  0.20179200172424316
generate_one_block  0.20615363121032715
generate_one_block  0.20700860023498535
generate_one_block  0.21008515357971191
generate_one_block  0.20473551750183105
generate_one_block  0.2076244354248047
generate_one_block  0.2133781909942627
generate_one_block  0.20816516876220703
generate_one_block  0.2102816104888916
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03708982467651367
gen group dst list time:  0.11121368408203125
time for parepare:  0.020340442657470703
local_output_nid generation:  0.024200916290283203
local_in_edges_tensor generation:  0.04658627510070801
mini_batch_src_global generation:  0.03801083564758301
r_  generation:  0.4048123359680176
local_output_nid generation:  0.028429508209228516
local_in_edges_tensor generation:  0.03204178810119629
mini_batch_src_global generation:  0.05139327049255371
r_  generation:  0.4039599895477295
local_output_nid generation:  0.02864813804626465
local_in_edges_tensor generation:  0.02787327766418457
mini_batch_src_global generation:  0.07106995582580566
r_  generation:  0.412860631942749
local_output_nid generation:  0.028776168823242188
local_in_edges_tensor generation:  0.029111623764038086
mini_batch_src_global generation:  0.04893350601196289
r_  generation:  0.40868663787841797
local_output_nid generation:  0.0288541316986084
local_in_edges_tensor generation:  0.027292490005493164
mini_batch_src_global generation:  0.047575950622558594
r_  generation:  0.42386889457702637
local_output_nid generation:  0.029267549514770508
local_in_edges_tensor generation:  0.027848482131958008
mini_batch_src_global generation:  0.0537111759185791
r_  generation:  0.41074395179748535
local_output_nid generation:  0.02719259262084961
local_in_edges_tensor generation:  0.028914690017700195
mini_batch_src_global generation:  0.047658443450927734
r_  generation:  0.419231653213501
local_output_nid generation:  0.027588844299316406
local_in_edges_tensor generation:  0.027118921279907227
mini_batch_src_global generation:  0.0519869327545166
r_  generation:  0.413346529006958
local_output_nid generation:  0.027449607849121094
local_in_edges_tensor generation:  0.03142428398132324
mini_batch_src_global generation:  0.04832124710083008
r_  generation:  0.4235250949859619
local_output_nid generation:  0.027621984481811523
local_in_edges_tensor generation:  0.03188014030456543
mini_batch_src_global generation:  0.05144643783569336
r_  generation:  0.41286158561706543
local_output_nid generation:  0.028725624084472656
local_in_edges_tensor generation:  0.03101944923400879
mini_batch_src_global generation:  0.0474705696105957
r_  generation:  0.4140200614929199
local_output_nid generation:  0.02741551399230957
local_in_edges_tensor generation:  0.025319337844848633
mini_batch_src_global generation:  0.04925274848937988
r_  generation:  0.40825653076171875
local_output_nid generation:  0.02794504165649414
local_in_edges_tensor generation:  0.027666091918945312
mini_batch_src_global generation:  0.04753303527832031
r_  generation:  0.4198157787322998
local_output_nid generation:  0.02866506576538086
local_in_edges_tensor generation:  0.029994964599609375
mini_batch_src_global generation:  0.05324292182922363
r_  generation:  0.4100341796875
local_output_nid generation:  0.02764892578125
local_in_edges_tensor generation:  0.02734541893005371
mini_batch_src_global generation:  0.047842979431152344
r_  generation:  0.427950382232666
local_output_nid generation:  0.027817249298095703
local_in_edges_tensor generation:  0.028167247772216797
mini_batch_src_global generation:  0.05168414115905762
r_  generation:  0.41356801986694336
local_output_nid generation:  0.029161691665649414
local_in_edges_tensor generation:  0.02762460708618164
mini_batch_src_global generation:  0.04948163032531738
r_  generation:  0.41474080085754395
local_output_nid generation:  0.027592897415161133
local_in_edges_tensor generation:  0.02908182144165039
mini_batch_src_global generation:  0.04939460754394531
r_  generation:  0.4248924255371094
local_output_nid generation:  0.03172659873962402
local_in_edges_tensor generation:  0.025378942489624023
mini_batch_src_global generation:  0.0491480827331543
r_  generation:  0.413585901260376
local_output_nid generation:  0.028577566146850586
local_in_edges_tensor generation:  0.026433229446411133
mini_batch_src_global generation:  0.04963350296020508
r_  generation:  0.41580677032470703
local_output_nid generation:  0.0282745361328125
local_in_edges_tensor generation:  0.02947092056274414
mini_batch_src_global generation:  0.047698974609375
r_  generation:  0.42508792877197266
local_output_nid generation:  0.028542518615722656
local_in_edges_tensor generation:  0.02731776237487793
mini_batch_src_global generation:  0.05175518989562988
r_  generation:  0.4155771732330322
local_output_nid generation:  0.028359651565551758
local_in_edges_tensor generation:  0.025784730911254883
mini_batch_src_global generation:  0.04759049415588379
r_  generation:  0.4191722869873047
local_output_nid generation:  0.028202533721923828
local_in_edges_tensor generation:  0.027182340621948242
mini_batch_src_global generation:  0.049243927001953125
r_  generation:  0.42966532707214355
local_output_nid generation:  0.028677940368652344
local_in_edges_tensor generation:  0.02541375160217285
mini_batch_src_global generation:  0.04788923263549805
r_  generation:  0.4253041744232178
local_output_nid generation:  0.0284576416015625
local_in_edges_tensor generation:  0.031320810317993164
mini_batch_src_global generation:  0.04960370063781738
r_  generation:  0.4152989387512207
local_output_nid generation:  0.028498411178588867
local_in_edges_tensor generation:  0.027242660522460938
mini_batch_src_global generation:  0.04771089553833008
r_  generation:  0.42145466804504395
local_output_nid generation:  0.028241634368896484
local_in_edges_tensor generation:  0.02936244010925293
mini_batch_src_global generation:  0.04954385757446289
r_  generation:  0.42020344734191895
local_output_nid generation:  0.0285947322845459
local_in_edges_tensor generation:  0.027321338653564453
mini_batch_src_global generation:  0.04858994483947754
r_  generation:  0.4209458827972412
local_output_nid generation:  0.0284421443939209
local_in_edges_tensor generation:  0.027194738388061523
mini_batch_src_global generation:  0.0503237247467041
r_  generation:  0.410555362701416
local_output_nid generation:  0.028474807739257812
local_in_edges_tensor generation:  0.02543473243713379
mini_batch_src_global generation:  0.04774880409240723
r_  generation:  0.41811347007751465
local_output_nid generation:  0.02858710289001465
local_in_edges_tensor generation:  0.025815963745117188
mini_batch_src_global generation:  0.05099821090698242
r_  generation:  0.41805529594421387
----------------------check_connections_block total spend ----------------------------- 19.729839324951172
generate_one_block  0.5667445659637451
generate_one_block  0.5489482879638672
generate_one_block  0.5498206615447998
generate_one_block  0.5568480491638184
generate_one_block  0.6521885395050049
generate_one_block  0.5598413944244385
generate_one_block  0.5568218231201172
generate_one_block  0.5591676235198975
generate_one_block  0.5647017955780029
generate_one_block  0.5596728324890137
generate_one_block  0.5486795902252197
generate_one_block  0.5474660396575928
generate_one_block  0.5599789619445801
generate_one_block  0.5637526512145996
generate_one_block  0.5534930229187012
generate_one_block  0.56951904296875
generate_one_block  0.550283670425415
generate_one_block  0.5481178760528564
generate_one_block  0.5443642139434814
generate_one_block  0.5651226043701172
generate_one_block  0.5648508071899414
generate_one_block  0.5611386299133301
generate_one_block  0.5550427436828613
generate_one_block  0.5470461845397949
generate_one_block  0.5800821781158447
generate_one_block  0.5582811832427979
generate_one_block  0.5547051429748535
generate_one_block  0.5608835220336914
generate_one_block  0.5576117038726807
generate_one_block  0.563148021697998
generate_one_block  0.5528092384338379
generate_one_block  0.5581579208374023
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12367486953735352  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

connection checking time:  27.257097244262695
block generation total time  24.61057996749878
average batch blocks generation time:  0.7690806239843369
block dataloader generation time/epoch 54.49941783291953
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526752471923828  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.978538990020752  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10473489761352539  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.88603639602661  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523366928100586  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.83338451385498  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10476446151733398  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.061504364013672  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528087615966797  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.0371036529541  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10487985610961914  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.005995273590088  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523080825805664  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.9382061958313  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10507059097290039  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.96833848953247  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10532855987548828  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.29941463470459  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10473299026489258  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.094511032104492  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518598556518555  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.551406383514404  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10431194305419922  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.5751314163208  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525846481323242  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.04761838912964  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1047968864440918  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.015877723693848  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525846481323242  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.990105628967285  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10492181777954102  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.229206085205078  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10517692565917969  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.56696605682373  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10460853576660156  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.881781101226807  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10516643524169922  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.46021032333374  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1049046516418457  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.933692455291748  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527610778808594  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.055408477783203  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10489892959594727  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.09630823135376  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524702072143555  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.011174201965332  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10454511642456055  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.544525623321533  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525131225585938  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.948848247528076  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10484838485717773  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.78713369369507  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527706146240234  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.10187578201294  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10449981689453125  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.82170581817627  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524940490722656  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.020025730133057  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10489082336425781  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.266600131988525  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522890090942383  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.83053731918335  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10459089279174805  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.15008020401001  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03381400555372238 |0.013352461159229279 |0.4156554043292999 |9.384751319885254e-05 |0.7586354687809944 |0.008932113647460938 |
----------------------------------------------------------pseudo_mini_loss sum 1.3074289560317993
Total (block generation + training)time/epoch 93.63571769850594
Training time/epoch 39.146642446517944
Training time without block to device /epoch 38.71936368942261
Training time without total dataloading part /epoch 37.58924317359924
load block tensor time/epoch 1.0820481777191162
block to device time/epoch 0.4272787570953369
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  8801220
Number of first layer input nodes during this epoch:  4682792
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12296867370605469  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025565147399902344
range selection method range initialization spend 0.014797449111938477
time for parepare:  0.02092909812927246
local_output_nid generation:  0.0011856555938720703
local_in_edges_tensor generation:  0.0051805973052978516
mini_batch_src_global generation:  0.00199127197265625
r_  generation:  0.010478734970092773
local_output_nid generation:  0.001013040542602539
local_in_edges_tensor generation:  0.0007030963897705078
mini_batch_src_global generation:  0.0017764568328857422
r_  generation:  0.011197328567504883
local_output_nid generation:  0.0010237693786621094
local_in_edges_tensor generation:  0.0006477832794189453
mini_batch_src_global generation:  0.0014643669128417969
r_  generation:  0.010080099105834961
local_output_nid generation:  0.0010135173797607422
local_in_edges_tensor generation:  0.0006623268127441406
mini_batch_src_global generation:  0.001386880874633789
r_  generation:  0.009940147399902344
local_output_nid generation:  0.00099945068359375
local_in_edges_tensor generation:  0.0007035732269287109
mini_batch_src_global generation:  0.0013267993927001953
r_  generation:  0.009970903396606445
local_output_nid generation:  0.0010271072387695312
local_in_edges_tensor generation:  0.0006644725799560547
mini_batch_src_global generation:  0.0013446807861328125
r_  generation:  0.010397195816040039
local_output_nid generation:  0.0010361671447753906
local_in_edges_tensor generation:  0.0006530284881591797
mini_batch_src_global generation:  0.0013453960418701172
r_  generation:  0.010350227355957031
local_output_nid generation:  0.0011129379272460938
local_in_edges_tensor generation:  0.0006496906280517578
mini_batch_src_global generation:  0.0012738704681396484
r_  generation:  0.010138511657714844
local_output_nid generation:  0.0010635852813720703
local_in_edges_tensor generation:  0.0006392002105712891
mini_batch_src_global generation:  0.0013341903686523438
r_  generation:  0.010397195816040039
local_output_nid generation:  0.0010178089141845703
local_in_edges_tensor generation:  0.0006659030914306641
mini_batch_src_global generation:  0.0015363693237304688
r_  generation:  0.01093602180480957
local_output_nid generation:  0.0010249614715576172
local_in_edges_tensor generation:  0.000644683837890625
mini_batch_src_global generation:  0.0013036727905273438
r_  generation:  0.010189533233642578
local_output_nid generation:  0.0010221004486083984
local_in_edges_tensor generation:  0.0006632804870605469
mini_batch_src_global generation:  0.0013508796691894531
r_  generation:  0.010768651962280273
local_output_nid generation:  0.001024007797241211
local_in_edges_tensor generation:  0.0006721019744873047
mini_batch_src_global generation:  0.0014226436614990234
r_  generation:  0.010539531707763672
local_output_nid generation:  0.001020669937133789
local_in_edges_tensor generation:  0.0006546974182128906
mini_batch_src_global generation:  0.0013556480407714844
r_  generation:  0.010546445846557617
local_output_nid generation:  0.0010368824005126953
local_in_edges_tensor generation:  0.0006582736968994141
mini_batch_src_global generation:  0.0012814998626708984
r_  generation:  0.010218620300292969
local_output_nid generation:  0.0010247230529785156
local_in_edges_tensor generation:  0.0006308555603027344
mini_batch_src_global generation:  0.004644155502319336
r_  generation:  0.010895252227783203
local_output_nid generation:  0.0010759830474853516
local_in_edges_tensor generation:  0.0006501674652099609
mini_batch_src_global generation:  0.0013692378997802734
r_  generation:  0.010742425918579102
local_output_nid generation:  0.0010418891906738281
local_in_edges_tensor generation:  0.0006527900695800781
mini_batch_src_global generation:  0.0014619827270507812
r_  generation:  0.01038217544555664
local_output_nid generation:  0.0010471343994140625
local_in_edges_tensor generation:  0.0007092952728271484
mini_batch_src_global generation:  0.0013682842254638672
r_  generation:  0.010854005813598633
local_output_nid generation:  0.0010645389556884766
local_in_edges_tensor generation:  0.0007188320159912109
mini_batch_src_global generation:  0.0015943050384521484
r_  generation:  0.01096653938293457
local_output_nid generation:  0.0010669231414794922
local_in_edges_tensor generation:  0.0006844997406005859
mini_batch_src_global generation:  0.0013668537139892578
r_  generation:  0.010346651077270508
local_output_nid generation:  0.0010504722595214844
local_in_edges_tensor generation:  0.0006542205810546875
mini_batch_src_global generation:  0.0011458396911621094
r_  generation:  0.011304616928100586
local_output_nid generation:  0.001065969467163086
local_in_edges_tensor generation:  0.0006191730499267578
mini_batch_src_global generation:  0.0014748573303222656
r_  generation:  0.010256767272949219
local_output_nid generation:  0.0010347366333007812
local_in_edges_tensor generation:  0.0006396770477294922
mini_batch_src_global generation:  0.0013058185577392578
r_  generation:  0.010601043701171875
local_output_nid generation:  0.001043081283569336
local_in_edges_tensor generation:  0.0006482601165771484
mini_batch_src_global generation:  0.0014393329620361328
r_  generation:  0.010150671005249023
local_output_nid generation:  0.0010449886322021484
local_in_edges_tensor generation:  0.0006616115570068359
mini_batch_src_global generation:  0.0012927055358886719
r_  generation:  0.010802268981933594
local_output_nid generation:  0.001031637191772461
local_in_edges_tensor generation:  0.0006427764892578125
mini_batch_src_global generation:  0.0012497901916503906
r_  generation:  0.010537862777709961
local_output_nid generation:  0.0010361671447753906
local_in_edges_tensor generation:  0.0007040500640869141
mini_batch_src_global generation:  0.0014886856079101562
r_  generation:  0.010841131210327148
local_output_nid generation:  0.001079559326171875
local_in_edges_tensor generation:  0.0006401538848876953
mini_batch_src_global generation:  0.0013036727905273438
r_  generation:  0.010909080505371094
local_output_nid generation:  0.001028299331665039
local_in_edges_tensor generation:  0.0006668567657470703
mini_batch_src_global generation:  0.0012943744659423828
r_  generation:  0.010597705841064453
local_output_nid generation:  0.0010330677032470703
local_in_edges_tensor generation:  0.0006535053253173828
mini_batch_src_global generation:  0.0014908313751220703
r_  generation:  0.010525941848754883
local_output_nid generation:  0.0010459423065185547
local_in_edges_tensor generation:  0.0006492137908935547
mini_batch_src_global generation:  0.001341104507446289
r_  generation:  0.01054692268371582
----------------------check_connections_block total spend ----------------------------- 0.5490663051605225
generate_one_block  0.023520469665527344
generate_one_block  0.021802425384521484
generate_one_block  0.01899123191833496
generate_one_block  0.018053293228149414
generate_one_block  0.01779031753540039
generate_one_block  0.018307209014892578
generate_one_block  0.018122196197509766
generate_one_block  0.01773834228515625
generate_one_block  0.01824188232421875
generate_one_block  0.01912665367126465
generate_one_block  0.01786351203918457
generate_one_block  0.025934219360351562
generate_one_block  0.02621316909790039
generate_one_block  0.01752948760986328
generate_one_block  0.016824960708618164
generate_one_block  0.017072200775146484
generate_one_block  0.017725467681884766
generate_one_block  0.01682281494140625
generate_one_block  0.017203569412231445
generate_one_block  0.017508983612060547
generate_one_block  0.016943931579589844
generate_one_block  0.018467187881469727
generate_one_block  0.027942895889282227
generate_one_block  0.01712346076965332
generate_one_block  0.016857624053955078
generate_one_block  0.01736903190612793
generate_one_block  0.01685166358947754
generate_one_block  0.01735234260559082
generate_one_block  0.017315387725830078
generate_one_block  0.017148733139038086
generate_one_block  0.017020702362060547
generate_one_block  0.01688241958618164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03593015670776367
gen group dst list time:  0.022576570510864258
time for parepare:  0.01986551284790039
local_output_nid generation:  0.005253791809082031
local_in_edges_tensor generation:  0.015393972396850586
mini_batch_src_global generation:  0.016000986099243164
r_  generation:  0.1379861831665039
local_output_nid generation:  0.0073430538177490234
local_in_edges_tensor generation:  0.00963735580444336
mini_batch_src_global generation:  0.01994013786315918
r_  generation:  0.1431884765625
local_output_nid generation:  0.007513523101806641
local_in_edges_tensor generation:  0.031546831130981445
mini_batch_src_global generation:  0.019663095474243164
r_  generation:  0.1502971649169922
local_output_nid generation:  0.007585763931274414
local_in_edges_tensor generation:  0.008142471313476562
mini_batch_src_global generation:  0.02814006805419922
r_  generation:  0.1638481616973877
local_output_nid generation:  0.012252092361450195
local_in_edges_tensor generation:  0.010038375854492188
mini_batch_src_global generation:  0.02035355567932129
r_  generation:  0.1688532829284668
local_output_nid generation:  0.011363506317138672
local_in_edges_tensor generation:  0.011034727096557617
mini_batch_src_global generation:  0.03309464454650879
r_  generation:  0.1859290599822998
local_output_nid generation:  0.008968114852905273
local_in_edges_tensor generation:  0.009185791015625
mini_batch_src_global generation:  0.021351099014282227
r_  generation:  0.15422987937927246
local_output_nid generation:  0.008468389511108398
local_in_edges_tensor generation:  0.008167743682861328
mini_batch_src_global generation:  0.021044015884399414
r_  generation:  0.14981412887573242
local_output_nid generation:  0.008291959762573242
local_in_edges_tensor generation:  0.008065223693847656
mini_batch_src_global generation:  0.021502017974853516
r_  generation:  0.15492033958435059
local_output_nid generation:  0.00876760482788086
local_in_edges_tensor generation:  0.01068425178527832
mini_batch_src_global generation:  0.02314591407775879
r_  generation:  0.16234064102172852
local_output_nid generation:  0.008359193801879883
local_in_edges_tensor generation:  0.007904052734375
mini_batch_src_global generation:  0.021520376205444336
r_  generation:  0.15341687202453613
local_output_nid generation:  0.008642196655273438
local_in_edges_tensor generation:  0.008594512939453125
mini_batch_src_global generation:  0.02223801612854004
r_  generation:  0.15807890892028809
local_output_nid generation:  0.00883173942565918
local_in_edges_tensor generation:  0.010712623596191406
mini_batch_src_global generation:  0.025892972946166992
r_  generation:  0.16321802139282227
local_output_nid generation:  0.010635614395141602
local_in_edges_tensor generation:  0.008030176162719727
mini_batch_src_global generation:  0.02209305763244629
r_  generation:  0.16083192825317383
local_output_nid generation:  0.00935673713684082
local_in_edges_tensor generation:  0.011971712112426758
mini_batch_src_global generation:  0.04155778884887695
r_  generation:  0.1514744758605957
local_output_nid generation:  0.008507966995239258
local_in_edges_tensor generation:  0.008671045303344727
mini_batch_src_global generation:  0.02086925506591797
r_  generation:  0.15981578826904297
local_output_nid generation:  0.010818958282470703
local_in_edges_tensor generation:  0.008838891983032227
mini_batch_src_global generation:  0.033525943756103516
r_  generation:  0.1795201301574707
local_output_nid generation:  0.013476371765136719
local_in_edges_tensor generation:  0.010863542556762695
mini_batch_src_global generation:  0.022187471389770508
r_  generation:  0.16660284996032715
local_output_nid generation:  0.013781309127807617
local_in_edges_tensor generation:  0.012756586074829102
mini_batch_src_global generation:  0.02271723747253418
r_  generation:  0.1910231113433838
local_output_nid generation:  0.01182699203491211
local_in_edges_tensor generation:  0.009702920913696289
mini_batch_src_global generation:  0.03992891311645508
r_  generation:  0.15584468841552734
local_output_nid generation:  0.009797096252441406
local_in_edges_tensor generation:  0.008480310440063477
mini_batch_src_global generation:  0.021303176879882812
r_  generation:  0.1544945240020752
local_output_nid generation:  0.009974002838134766
local_in_edges_tensor generation:  0.010629653930664062
mini_batch_src_global generation:  0.023850440979003906
r_  generation:  0.16733241081237793
local_output_nid generation:  0.009067773818969727
local_in_edges_tensor generation:  0.008037090301513672
mini_batch_src_global generation:  0.035970449447631836
r_  generation:  0.15390348434448242
local_output_nid generation:  0.00908041000366211
local_in_edges_tensor generation:  0.008255720138549805
mini_batch_src_global generation:  0.021739959716796875
r_  generation:  0.15485882759094238
local_output_nid generation:  0.008877992630004883
local_in_edges_tensor generation:  0.00800180435180664
mini_batch_src_global generation:  0.031011343002319336
r_  generation:  0.19471216201782227
local_output_nid generation:  0.009814739227294922
local_in_edges_tensor generation:  0.009142398834228516
mini_batch_src_global generation:  0.04168391227722168
r_  generation:  0.16472625732421875
local_output_nid generation:  0.00929713249206543
local_in_edges_tensor generation:  0.008957624435424805
mini_batch_src_global generation:  0.021360397338867188
r_  generation:  0.1625068187713623
local_output_nid generation:  0.009430408477783203
local_in_edges_tensor generation:  0.008216381072998047
mini_batch_src_global generation:  0.0314640998840332
r_  generation:  0.18269705772399902
local_output_nid generation:  0.012956857681274414
local_in_edges_tensor generation:  0.008552074432373047
mini_batch_src_global generation:  0.022846221923828125
r_  generation:  0.16775846481323242
local_output_nid generation:  0.009721994400024414
local_in_edges_tensor generation:  0.008309125900268555
mini_batch_src_global generation:  0.020130395889282227
r_  generation:  0.20817208290100098
local_output_nid generation:  0.009173870086669922
local_in_edges_tensor generation:  0.010466575622558594
mini_batch_src_global generation:  0.019476890563964844
r_  generation:  0.1643235683441162
local_output_nid generation:  0.009392738342285156
local_in_edges_tensor generation:  0.011899232864379883
mini_batch_src_global generation:  0.019307851791381836
r_  generation:  0.16066527366638184
----------------------check_connections_block total spend ----------------------------- 7.948307514190674
generate_one_block  0.22050118446350098
generate_one_block  0.20095038414001465
generate_one_block  0.20305705070495605
generate_one_block  0.22452759742736816
generate_one_block  0.2447214126586914
generate_one_block  0.23042082786560059
generate_one_block  0.20926451683044434
generate_one_block  0.2008991241455078
generate_one_block  0.20443081855773926
generate_one_block  0.2473151683807373
generate_one_block  0.2359027862548828
generate_one_block  0.24201536178588867
generate_one_block  0.2201519012451172
generate_one_block  0.21289467811584473
generate_one_block  0.20495223999023438
generate_one_block  0.200486421585083
generate_one_block  0.21317434310913086
generate_one_block  0.20262932777404785
generate_one_block  0.2067108154296875
generate_one_block  0.2137749195098877
generate_one_block  0.2026374340057373
generate_one_block  0.22259283065795898
generate_one_block  0.19798564910888672
generate_one_block  0.2028331756591797
generate_one_block  0.20369815826416016
generate_one_block  0.21735739707946777
generate_one_block  0.2252652645111084
generate_one_block  0.21993613243103027
generate_one_block  0.2136397361755371
generate_one_block  0.21111774444580078
generate_one_block  0.20721125602722168
generate_one_block  0.2047269344329834
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034148216247558594
gen group dst list time:  0.11013197898864746
time for parepare:  0.019774913787841797
local_output_nid generation:  0.024557828903198242
local_in_edges_tensor generation:  0.04642772674560547
mini_batch_src_global generation:  0.03779768943786621
r_  generation:  0.41411280632019043
local_output_nid generation:  0.03145289421081543
local_in_edges_tensor generation:  0.032488346099853516
mini_batch_src_global generation:  0.04875802993774414
r_  generation:  0.41381311416625977
local_output_nid generation:  0.02905750274658203
local_in_edges_tensor generation:  0.031066417694091797
mini_batch_src_global generation:  0.046973466873168945
r_  generation:  0.42109155654907227
local_output_nid generation:  0.028978586196899414
local_in_edges_tensor generation:  0.030361413955688477
mini_batch_src_global generation:  0.04909968376159668
r_  generation:  0.4216499328613281
local_output_nid generation:  0.02957940101623535
local_in_edges_tensor generation:  0.034638404846191406
mini_batch_src_global generation:  0.05725598335266113
r_  generation:  0.4193260669708252
local_output_nid generation:  0.03139066696166992
local_in_edges_tensor generation:  0.026686668395996094
mini_batch_src_global generation:  0.04932117462158203
r_  generation:  0.4129776954650879
local_output_nid generation:  0.028131484985351562
local_in_edges_tensor generation:  0.028225421905517578
mini_batch_src_global generation:  0.04732823371887207
r_  generation:  0.418243408203125
local_output_nid generation:  0.028128862380981445
local_in_edges_tensor generation:  0.027289628982543945
mini_batch_src_global generation:  0.049329280853271484
r_  generation:  0.41598939895629883
local_output_nid generation:  0.027998924255371094
local_in_edges_tensor generation:  0.0307466983795166
mini_batch_src_global generation:  0.04773116111755371
r_  generation:  0.4223155975341797
local_output_nid generation:  0.028594970703125
local_in_edges_tensor generation:  0.029191255569458008
mini_batch_src_global generation:  0.04999279975891113
r_  generation:  0.4259614944458008
local_output_nid generation:  0.028516769409179688
local_in_edges_tensor generation:  0.027068376541137695
mini_batch_src_global generation:  0.047722816467285156
r_  generation:  0.4200754165649414
local_output_nid generation:  0.02818918228149414
local_in_edges_tensor generation:  0.02521681785583496
mini_batch_src_global generation:  0.04912519454956055
r_  generation:  0.41857123374938965
local_output_nid generation:  0.02882552146911621
local_in_edges_tensor generation:  0.02548503875732422
mini_batch_src_global generation:  0.04981493949890137
r_  generation:  0.42697620391845703
local_output_nid generation:  0.028648853302001953
local_in_edges_tensor generation:  0.0331265926361084
mini_batch_src_global generation:  0.049251556396484375
r_  generation:  0.42601442337036133
local_output_nid generation:  0.028057098388671875
local_in_edges_tensor generation:  0.030158042907714844
mini_batch_src_global generation:  0.047600507736206055
r_  generation:  0.4179050922393799
local_output_nid generation:  0.028296232223510742
local_in_edges_tensor generation:  0.026769399642944336
mini_batch_src_global generation:  0.04951643943786621
r_  generation:  0.4221794605255127
local_output_nid generation:  0.028531789779663086
local_in_edges_tensor generation:  0.026961803436279297
mini_batch_src_global generation:  0.04796290397644043
r_  generation:  0.4274895191192627
local_output_nid generation:  0.028070926666259766
local_in_edges_tensor generation:  0.025064706802368164
mini_batch_src_global generation:  0.05012798309326172
r_  generation:  0.41832947731018066
local_output_nid generation:  0.02827596664428711
local_in_edges_tensor generation:  0.027142047882080078
mini_batch_src_global generation:  0.04728960990905762
r_  generation:  0.42298245429992676
local_output_nid generation:  0.028453588485717773
local_in_edges_tensor generation:  0.02681422233581543
mini_batch_src_global generation:  0.051108598709106445
r_  generation:  0.42110300064086914
local_output_nid generation:  0.029215335845947266
local_in_edges_tensor generation:  0.027637481689453125
mini_batch_src_global generation:  0.047154903411865234
r_  generation:  0.42214083671569824
local_output_nid generation:  0.028822660446166992
local_in_edges_tensor generation:  0.029186248779296875
mini_batch_src_global generation:  0.05288124084472656
r_  generation:  0.4404759407043457
local_output_nid generation:  0.02996993064880371
local_in_edges_tensor generation:  0.0251009464263916
mini_batch_src_global generation:  0.04891490936279297
r_  generation:  0.42093825340270996
local_output_nid generation:  0.02948737144470215
local_in_edges_tensor generation:  0.028179407119750977
mini_batch_src_global generation:  0.04970979690551758
r_  generation:  0.4172236919403076
local_output_nid generation:  0.028314828872680664
local_in_edges_tensor generation:  0.029144287109375
mini_batch_src_global generation:  0.0475924015045166
r_  generation:  0.4196779727935791
local_output_nid generation:  0.02842998504638672
local_in_edges_tensor generation:  0.026780128479003906
mini_batch_src_global generation:  0.049536705017089844
r_  generation:  0.4186983108520508
local_output_nid generation:  0.028208255767822266
local_in_edges_tensor generation:  0.02534317970275879
mini_batch_src_global generation:  0.04724431037902832
r_  generation:  0.4209895133972168
local_output_nid generation:  0.02888631820678711
local_in_edges_tensor generation:  0.027749300003051758
mini_batch_src_global generation:  0.05013155937194824
r_  generation:  0.4219210147857666
local_output_nid generation:  0.028784751892089844
local_in_edges_tensor generation:  0.03100728988647461
mini_batch_src_global generation:  0.048877716064453125
r_  generation:  0.42983126640319824
local_output_nid generation:  0.029134273529052734
local_in_edges_tensor generation:  0.027814388275146484
mini_batch_src_global generation:  0.05004310607910156
r_  generation:  0.4342772960662842
local_output_nid generation:  0.028309106826782227
local_in_edges_tensor generation:  0.025578737258911133
mini_batch_src_global generation:  0.04726076126098633
r_  generation:  0.42685842514038086
local_output_nid generation:  0.028400897979736328
local_in_edges_tensor generation:  0.025375843048095703
mini_batch_src_global generation:  0.05106639862060547
r_  generation:  0.41445112228393555
----------------------check_connections_block total spend ----------------------------- 19.8993878364563
generate_one_block  0.5685288906097412
generate_one_block  0.5464992523193359
generate_one_block  0.5571746826171875
generate_one_block  0.5489630699157715
generate_one_block  0.6526675224304199
generate_one_block  0.5522656440734863
generate_one_block  0.5486183166503906
generate_one_block  0.552372932434082
generate_one_block  0.5558254718780518
generate_one_block  0.5650615692138672
generate_one_block  0.5492074489593506
generate_one_block  0.5470616817474365
generate_one_block  0.5570406913757324
generate_one_block  0.5572972297668457
generate_one_block  0.5507962703704834
generate_one_block  0.5488789081573486
generate_one_block  0.5616357326507568
generate_one_block  0.5544586181640625
generate_one_block  0.5550892353057861
generate_one_block  0.5493819713592529
generate_one_block  0.5505497455596924
generate_one_block  0.564328670501709
generate_one_block  0.544625997543335
generate_one_block  0.5499207973480225
generate_one_block  0.564345121383667
generate_one_block  0.5637004375457764
generate_one_block  0.5485043525695801
generate_one_block  0.5708262920379639
generate_one_block  0.5627665519714355
generate_one_block  0.553051233291626
generate_one_block  0.5522036552429199
generate_one_block  0.5489311218261719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12296867370605469  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

connection checking time:  27.847695350646973
block generation total time  24.720361709594727
average batch blocks generation time:  0.7725113034248352
block dataloader generation time/epoch 54.57717040379842
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521602630615234  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.784657955169678  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10447883605957031  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.691003799438477  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523271560668945  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.883244514465332  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10497760772705078  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.711729526519775  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520601272583008  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.679136753082275  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10494279861450195  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.84836435317993  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522890090942383  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.767356395721436  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046147346496582  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.739190578460693  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524463653564453  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.876631259918213  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10502290725708008  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.402909755706787  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052098274230957  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.766799926757812  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10457706451416016  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.954508304595947  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529422760009766  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.120962142944336  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10468530654907227  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.944772720336914  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10514068603515625  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.39622402191162  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10443449020385742  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.510196685791016  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529518127441406  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.187882900238037  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10451221466064453  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.65168333053589  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523176193237305  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.864393711090088  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10477685928344727  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.875012397766113  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520076751708984  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.699077606201172  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10486173629760742  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.454362392425537  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518360137939453  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.62054204940796  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10465860366821289  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.838446617126465  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521221160888672  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.72151756286621  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10486698150634766  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.087703227996826  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052389144897461  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.944724082946777  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1049952507019043  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.349767684936523  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529851913452148  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.190027713775635  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10450506210327148  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.103830814361572  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523605346679688  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.81806516647339  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10452747344970703  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.752593994140625  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03452242910861969 |0.013849228620529175 |0.41410714387893677 |9.378045797348022e-05 |0.7532208263874054 |0.006930112838745117 |
----------------------------------------------------------pseudo_mini_loss sum 1.2932517528533936
Total (block generation + training)time/epoch 93.70181740125021
Training time/epoch 38.961246967315674
Training time without block to device /epoch 38.51807165145874
Training time without total dataloading part /epoch 37.364426136016846
load block tensor time/epoch 1.10471773147583
block to device time/epoch 0.4431753158569336
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  8796546
Number of first layer input nodes during this epoch:  4683829
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12245845794677734  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024122238159179688
range selection method range initialization spend 0.016656160354614258
time for parepare:  0.01683640480041504
local_output_nid generation:  0.0009546279907226562
local_in_edges_tensor generation:  0.00351715087890625
mini_batch_src_global generation:  0.0018782615661621094
r_  generation:  0.011928558349609375
local_output_nid generation:  0.0009818077087402344
local_in_edges_tensor generation:  0.0006623268127441406
mini_batch_src_global generation:  0.0014734268188476562
r_  generation:  0.010523080825805664
local_output_nid generation:  0.0009710788726806641
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.0011715888977050781
r_  generation:  0.009489297866821289
local_output_nid generation:  0.00091552734375
local_in_edges_tensor generation:  0.0005793571472167969
mini_batch_src_global generation:  0.0011775493621826172
r_  generation:  0.009631872177124023
local_output_nid generation:  0.0008819103240966797
local_in_edges_tensor generation:  0.0006003379821777344
mini_batch_src_global generation:  0.0011723041534423828
r_  generation:  0.009899616241455078
local_output_nid generation:  0.0008633136749267578
local_in_edges_tensor generation:  0.0005464553833007812
mini_batch_src_global generation:  0.0011110305786132812
r_  generation:  0.009646415710449219
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005543231964111328
mini_batch_src_global generation:  0.0011191368103027344
r_  generation:  0.010178327560424805
local_output_nid generation:  0.0008528232574462891
local_in_edges_tensor generation:  0.0005421638488769531
mini_batch_src_global generation:  0.0011219978332519531
r_  generation:  0.0099029541015625
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0005595684051513672
mini_batch_src_global generation:  0.0011322498321533203
r_  generation:  0.010249137878417969
local_output_nid generation:  0.0008547306060791016
local_in_edges_tensor generation:  0.0005643367767333984
mini_batch_src_global generation:  0.001134634017944336
r_  generation:  0.01045536994934082
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.001102447509765625
r_  generation:  0.010276317596435547
local_output_nid generation:  0.000858306884765625
local_in_edges_tensor generation:  0.0006034374237060547
mini_batch_src_global generation:  0.0011513233184814453
r_  generation:  0.010038137435913086
local_output_nid generation:  0.0008537769317626953
local_in_edges_tensor generation:  0.0005536079406738281
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.010128021240234375
local_output_nid generation:  0.0008685588836669922
local_in_edges_tensor generation:  0.0006256103515625
mini_batch_src_global generation:  0.0011911392211914062
r_  generation:  0.010771512985229492
local_output_nid generation:  0.0008523464202880859
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.0011563301086425781
r_  generation:  0.010384321212768555
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0012211799621582031
r_  generation:  0.010564088821411133
local_output_nid generation:  0.0008535385131835938
local_in_edges_tensor generation:  0.0005483627319335938
mini_batch_src_global generation:  0.0011355876922607422
r_  generation:  0.009995222091674805
local_output_nid generation:  0.0008497238159179688
local_in_edges_tensor generation:  0.0005540847778320312
mini_batch_src_global generation:  0.0011317729949951172
r_  generation:  0.010166168212890625
local_output_nid generation:  0.0008459091186523438
local_in_edges_tensor generation:  0.0005478858947753906
mini_batch_src_global generation:  0.0012047290802001953
r_  generation:  0.010414361953735352
local_output_nid generation:  0.0008521080017089844
local_in_edges_tensor generation:  0.0005512237548828125
mini_batch_src_global generation:  0.0011131763458251953
r_  generation:  0.01002049446105957
local_output_nid generation:  0.0008625984191894531
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.0011322498321533203
r_  generation:  0.010442733764648438
local_output_nid generation:  0.0008459091186523438
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.0011589527130126953
r_  generation:  0.01058053970336914
local_output_nid generation:  0.0008554458618164062
local_in_edges_tensor generation:  0.0005490779876708984
mini_batch_src_global generation:  0.0011949539184570312
r_  generation:  0.010091543197631836
local_output_nid generation:  0.0008466243743896484
local_in_edges_tensor generation:  0.0005431175231933594
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.010339736938476562
local_output_nid generation:  0.0008449554443359375
local_in_edges_tensor generation:  0.0005335807800292969
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.010246992111206055
local_output_nid generation:  0.0008478164672851562
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.010146617889404297
local_output_nid generation:  0.0008442401885986328
local_in_edges_tensor generation:  0.0005621910095214844
mini_batch_src_global generation:  0.0011663436889648438
r_  generation:  0.010443687438964844
local_output_nid generation:  0.0008392333984375
local_in_edges_tensor generation:  0.0005533695220947266
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.010504484176635742
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0005459785461425781
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.009992361068725586
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0005404949188232422
mini_batch_src_global generation:  0.0011191368103027344
r_  generation:  0.009967565536499023
local_output_nid generation:  0.0008399486541748047
local_in_edges_tensor generation:  0.00054931640625
mini_batch_src_global generation:  0.0012385845184326172
r_  generation:  0.010258913040161133
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0005469322204589844
mini_batch_src_global generation:  0.0011281967163085938
r_  generation:  0.010154008865356445
----------------------check_connections_block total spend ----------------------------- 0.5099246501922607
generate_one_block  0.023746013641357422
generate_one_block  0.019437551498413086
generate_one_block  0.017384767532348633
generate_one_block  0.017252206802368164
generate_one_block  0.01765751838684082
generate_one_block  0.017338991165161133
generate_one_block  0.017462730407714844
generate_one_block  0.017134428024291992
generate_one_block  0.017795085906982422
generate_one_block  0.017643213272094727
generate_one_block  0.0174562931060791
generate_one_block  0.019244909286499023
generate_one_block  0.017845869064331055
generate_one_block  0.018379926681518555
generate_one_block  0.017607450485229492
generate_one_block  0.01798391342163086
generate_one_block  0.016946077346801758
generate_one_block  0.018016576766967773
generate_one_block  0.018016815185546875
generate_one_block  0.017467498779296875
generate_one_block  0.017760753631591797
generate_one_block  0.01796579360961914
generate_one_block  0.017336130142211914
generate_one_block  0.01732921600341797
generate_one_block  0.017238378524780273
generate_one_block  0.017183303833007812
generate_one_block  0.017576217651367188
generate_one_block  0.017559051513671875
generate_one_block  0.016820907592773438
generate_one_block  0.016974210739135742
generate_one_block  0.017310619354248047
generate_one_block  0.01708698272705078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03753185272216797
gen group dst list time:  0.0228879451751709
time for parepare:  0.01986098289489746
local_output_nid generation:  0.00552058219909668
local_in_edges_tensor generation:  0.01624131202697754
mini_batch_src_global generation:  0.016373395919799805
r_  generation:  0.14378809928894043
local_output_nid generation:  0.007441282272338867
local_in_edges_tensor generation:  0.00972890853881836
mini_batch_src_global generation:  0.02069687843322754
r_  generation:  0.16798615455627441
local_output_nid generation:  0.011987447738647461
local_in_edges_tensor generation:  0.045841217041015625
mini_batch_src_global generation:  0.017912864685058594
r_  generation:  0.15935659408569336
local_output_nid generation:  0.012739181518554688
local_in_edges_tensor generation:  0.011295795440673828
mini_batch_src_global generation:  0.019382476806640625
r_  generation:  0.1576385498046875
local_output_nid generation:  0.01381230354309082
local_in_edges_tensor generation:  0.011536359786987305
mini_batch_src_global generation:  0.019246816635131836
r_  generation:  0.16742968559265137
local_output_nid generation:  0.013739585876464844
local_in_edges_tensor generation:  0.011510848999023438
mini_batch_src_global generation:  0.020392179489135742
r_  generation:  0.16123199462890625
local_output_nid generation:  0.014035463333129883
local_in_edges_tensor generation:  0.013931989669799805
mini_batch_src_global generation:  0.022000551223754883
r_  generation:  0.16855931282043457
local_output_nid generation:  0.013625621795654297
local_in_edges_tensor generation:  0.01101541519165039
mini_batch_src_global generation:  0.02319788932800293
r_  generation:  0.16309547424316406
local_output_nid generation:  0.013750076293945312
local_in_edges_tensor generation:  0.015284061431884766
mini_batch_src_global generation:  0.023526668548583984
r_  generation:  0.17643141746520996
local_output_nid generation:  0.0141448974609375
local_in_edges_tensor generation:  0.014295339584350586
mini_batch_src_global generation:  0.02313995361328125
r_  generation:  0.17054486274719238
local_output_nid generation:  0.014124870300292969
local_in_edges_tensor generation:  0.01660442352294922
mini_batch_src_global generation:  0.027736663818359375
r_  generation:  0.15628647804260254
local_output_nid generation:  0.012813329696655273
local_in_edges_tensor generation:  0.009437799453735352
mini_batch_src_global generation:  0.018938302993774414
r_  generation:  0.1488630771636963
local_output_nid generation:  0.010651111602783203
local_in_edges_tensor generation:  0.008625984191894531
mini_batch_src_global generation:  0.019147872924804688
r_  generation:  0.15424823760986328
local_output_nid generation:  0.010228872299194336
local_in_edges_tensor generation:  0.010077476501464844
mini_batch_src_global generation:  0.020814895629882812
r_  generation:  0.15848851203918457
local_output_nid generation:  0.009525299072265625
local_in_edges_tensor generation:  0.008892059326171875
mini_batch_src_global generation:  0.019732952117919922
r_  generation:  0.16098284721374512
local_output_nid generation:  0.012485742568969727
local_in_edges_tensor generation:  0.008457660675048828
mini_batch_src_global generation:  0.020912885665893555
r_  generation:  0.16394734382629395
local_output_nid generation:  0.009257793426513672
local_in_edges_tensor generation:  0.012329339981079102
mini_batch_src_global generation:  0.019282102584838867
r_  generation:  0.15505456924438477
local_output_nid generation:  0.009208917617797852
local_in_edges_tensor generation:  0.00969696044921875
mini_batch_src_global generation:  0.01949310302734375
r_  generation:  0.15520334243774414
local_output_nid generation:  0.010295629501342773
local_in_edges_tensor generation:  0.009965181350708008
mini_batch_src_global generation:  0.01960301399230957
r_  generation:  0.16060614585876465
local_output_nid generation:  0.00917196273803711
local_in_edges_tensor generation:  0.008832454681396484
mini_batch_src_global generation:  0.021240234375
r_  generation:  0.16312646865844727
local_output_nid generation:  0.012738704681396484
local_in_edges_tensor generation:  0.008431673049926758
mini_batch_src_global generation:  0.019902467727661133
r_  generation:  0.1597130298614502
local_output_nid generation:  0.009785652160644531
local_in_edges_tensor generation:  0.011255979537963867
mini_batch_src_global generation:  0.020455121994018555
r_  generation:  0.15853619575500488
local_output_nid generation:  0.009410619735717773
local_in_edges_tensor generation:  0.008412599563598633
mini_batch_src_global generation:  0.019068002700805664
r_  generation:  0.20837855339050293
local_output_nid generation:  0.009388208389282227
local_in_edges_tensor generation:  0.009061098098754883
mini_batch_src_global generation:  0.019768238067626953
r_  generation:  0.15468072891235352
local_output_nid generation:  0.009561300277709961
local_in_edges_tensor generation:  0.008337020874023438
mini_batch_src_global generation:  0.018697023391723633
r_  generation:  0.15346145629882812
local_output_nid generation:  0.009427547454833984
local_in_edges_tensor generation:  0.008153676986694336
mini_batch_src_global generation:  0.018386125564575195
r_  generation:  0.15282773971557617
local_output_nid generation:  0.009531974792480469
local_in_edges_tensor generation:  0.008369207382202148
mini_batch_src_global generation:  0.018931865692138672
r_  generation:  0.15604686737060547
local_output_nid generation:  0.009629011154174805
local_in_edges_tensor generation:  0.008521080017089844
mini_batch_src_global generation:  0.019460439682006836
r_  generation:  0.15695905685424805
local_output_nid generation:  0.009252309799194336
local_in_edges_tensor generation:  0.008150100708007812
mini_batch_src_global generation:  0.018666982650756836
r_  generation:  0.15308141708374023
local_output_nid generation:  0.009436607360839844
local_in_edges_tensor generation:  0.008101463317871094
mini_batch_src_global generation:  0.018534421920776367
r_  generation:  0.1530158519744873
local_output_nid generation:  0.009525299072265625
local_in_edges_tensor generation:  0.008280515670776367
mini_batch_src_global generation:  0.0184633731842041
r_  generation:  0.15570735931396484
local_output_nid generation:  0.009388208389282227
local_in_edges_tensor generation:  0.008108377456665039
mini_batch_src_global generation:  0.018577098846435547
r_  generation:  0.15401959419250488
----------------------check_connections_block total spend ----------------------------- 7.719663381576538
generate_one_block  0.21300530433654785
generate_one_block  0.1980278491973877
generate_one_block  0.19553470611572266
generate_one_block  0.1979670524597168
generate_one_block  0.2187206745147705
generate_one_block  0.19643449783325195
generate_one_block  0.20529937744140625
generate_one_block  0.19514775276184082
generate_one_block  0.2098982334136963
generate_one_block  0.20731806755065918
generate_one_block  0.20852017402648926
generate_one_block  0.2040872573852539
generate_one_block  0.20593595504760742
generate_one_block  0.21483898162841797
generate_one_block  0.21011042594909668
generate_one_block  0.21525287628173828
generate_one_block  0.2007756233215332
generate_one_block  0.20995640754699707
generate_one_block  0.2131977081298828
generate_one_block  0.2122201919555664
generate_one_block  0.21616268157958984
generate_one_block  0.2148299217224121
generate_one_block  0.2078840732574463
generate_one_block  0.2085435390472412
generate_one_block  0.20876741409301758
generate_one_block  0.20166516304016113
generate_one_block  0.20740485191345215
generate_one_block  0.20864272117614746
generate_one_block  0.19941473007202148
generate_one_block  0.20130419731140137
generate_one_block  0.20277810096740723
generate_one_block  0.20031189918518066
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030767202377319336
gen group dst list time:  0.11017060279846191
time for parepare:  0.02093648910522461
local_output_nid generation:  0.024220705032348633
local_in_edges_tensor generation:  0.04169416427612305
mini_batch_src_global generation:  0.03734564781188965
r_  generation:  0.4080061912536621
local_output_nid generation:  0.02823948860168457
local_in_edges_tensor generation:  0.032030582427978516
mini_batch_src_global generation:  0.047899484634399414
r_  generation:  0.4053189754486084
local_output_nid generation:  0.02861309051513672
local_in_edges_tensor generation:  0.026820659637451172
mini_batch_src_global generation:  0.045722007751464844
r_  generation:  0.4158909320831299
local_output_nid generation:  0.030138492584228516
local_in_edges_tensor generation:  0.03108811378479004
mini_batch_src_global generation:  0.0501248836517334
r_  generation:  0.41007065773010254
local_output_nid generation:  0.029168367385864258
local_in_edges_tensor generation:  0.03128862380981445
mini_batch_src_global generation:  0.047414541244506836
r_  generation:  0.42531895637512207
local_output_nid generation:  0.0296785831451416
local_in_edges_tensor generation:  0.025753259658813477
mini_batch_src_global generation:  0.04832911491394043
r_  generation:  0.4072422981262207
local_output_nid generation:  0.027029752731323242
local_in_edges_tensor generation:  0.026965856552124023
mini_batch_src_global generation:  0.0485844612121582
r_  generation:  0.41819167137145996
local_output_nid generation:  0.029081106185913086
local_in_edges_tensor generation:  0.0317234992980957
mini_batch_src_global generation:  0.049863338470458984
r_  generation:  0.4298415184020996
local_output_nid generation:  0.030875205993652344
local_in_edges_tensor generation:  0.033229827880859375
mini_batch_src_global generation:  0.049977779388427734
r_  generation:  0.4279289245605469
local_output_nid generation:  0.028664112091064453
local_in_edges_tensor generation:  0.02650308609008789
mini_batch_src_global generation:  0.049455881118774414
r_  generation:  0.41779303550720215
local_output_nid generation:  0.028403520584106445
local_in_edges_tensor generation:  0.02591085433959961
mini_batch_src_global generation:  0.048844337463378906
r_  generation:  0.42204713821411133
local_output_nid generation:  0.02872323989868164
local_in_edges_tensor generation:  0.026062965393066406
mini_batch_src_global generation:  0.048958778381347656
r_  generation:  0.4115481376647949
local_output_nid generation:  0.028290510177612305
local_in_edges_tensor generation:  0.02749943733215332
mini_batch_src_global generation:  0.046851396560668945
r_  generation:  0.4154360294342041
local_output_nid generation:  0.028378963470458984
local_in_edges_tensor generation:  0.02837514877319336
mini_batch_src_global generation:  0.04922747611999512
r_  generation:  0.41260695457458496
local_output_nid generation:  0.028351306915283203
local_in_edges_tensor generation:  0.03166794776916504
mini_batch_src_global generation:  0.04891490936279297
r_  generation:  0.41439247131347656
local_output_nid generation:  0.02856731414794922
local_in_edges_tensor generation:  0.02578258514404297
mini_batch_src_global generation:  0.04926800727844238
r_  generation:  0.40816378593444824
local_output_nid generation:  0.027968168258666992
local_in_edges_tensor generation:  0.02554607391357422
mini_batch_src_global generation:  0.04693317413330078
r_  generation:  0.4086341857910156
local_output_nid generation:  0.02844691276550293
local_in_edges_tensor generation:  0.02620720863342285
mini_batch_src_global generation:  0.049063920974731445
r_  generation:  0.4220294952392578
local_output_nid generation:  0.02849602699279785
local_in_edges_tensor generation:  0.0284574031829834
mini_batch_src_global generation:  0.047838687896728516
r_  generation:  0.4169623851776123
local_output_nid generation:  0.028156518936157227
local_in_edges_tensor generation:  0.02504730224609375
mini_batch_src_global generation:  0.04933428764343262
r_  generation:  0.40827131271362305
local_output_nid generation:  0.028084516525268555
local_in_edges_tensor generation:  0.025402307510375977
mini_batch_src_global generation:  0.04675912857055664
r_  generation:  0.41634464263916016
local_output_nid generation:  0.0287017822265625
local_in_edges_tensor generation:  0.027976512908935547
mini_batch_src_global generation:  0.05110478401184082
r_  generation:  0.4160780906677246
local_output_nid generation:  0.028771162033081055
local_in_edges_tensor generation:  0.027149677276611328
mini_batch_src_global generation:  0.04894590377807617
r_  generation:  0.41658854484558105
local_output_nid generation:  0.02835536003112793
local_in_edges_tensor generation:  0.025188684463500977
mini_batch_src_global generation:  0.049638986587524414
r_  generation:  0.41162776947021484
local_output_nid generation:  0.02838897705078125
local_in_edges_tensor generation:  0.026378631591796875
mini_batch_src_global generation:  0.046614646911621094
r_  generation:  0.41601014137268066
local_output_nid generation:  0.028209686279296875
local_in_edges_tensor generation:  0.02560710906982422
mini_batch_src_global generation:  0.05094623565673828
r_  generation:  0.40868043899536133
local_output_nid generation:  0.029116153717041016
local_in_edges_tensor generation:  0.027458667755126953
mini_batch_src_global generation:  0.0475919246673584
r_  generation:  0.4160807132720947
local_output_nid generation:  0.028397083282470703
local_in_edges_tensor generation:  0.027358055114746094
mini_batch_src_global generation:  0.05137753486633301
r_  generation:  0.4116678237915039
local_output_nid generation:  0.030450820922851562
local_in_edges_tensor generation:  0.027751684188842773
mini_batch_src_global generation:  0.04810070991516113
r_  generation:  0.4169728755950928
local_output_nid generation:  0.02825760841369629
local_in_edges_tensor generation:  0.025112390518188477
mini_batch_src_global generation:  0.05147147178649902
r_  generation:  0.412477970123291
local_output_nid generation:  0.030259132385253906
local_in_edges_tensor generation:  0.03161025047302246
mini_batch_src_global generation:  0.04783821105957031
r_  generation:  0.4185357093811035
local_output_nid generation:  0.028304576873779297
local_in_edges_tensor generation:  0.026529788970947266
mini_batch_src_global generation:  0.049398183822631836
r_  generation:  0.4113585948944092
----------------------check_connections_block total spend ----------------------------- 19.64018225669861
generate_one_block  0.5666303634643555
generate_one_block  0.5536708831787109
generate_one_block  0.553358793258667
generate_one_block  0.5508255958557129
generate_one_block  0.6545002460479736
generate_one_block  0.5484998226165771
generate_one_block  0.554628849029541
generate_one_block  0.548309326171875
generate_one_block  0.5650634765625
generate_one_block  0.5570776462554932
generate_one_block  0.5525612831115723
generate_one_block  0.5482196807861328
generate_one_block  0.5483381748199463
generate_one_block  0.5569627285003662
generate_one_block  0.5595781803131104
generate_one_block  0.5571315288543701
generate_one_block  0.5418233871459961
generate_one_block  0.5682520866394043
generate_one_block  0.5636966228485107
generate_one_block  0.5500307083129883
generate_one_block  0.5507082939147949
generate_one_block  0.5555758476257324
generate_one_block  0.558445930480957
generate_one_block  0.559056282043457
generate_one_block  0.5734779834747314
generate_one_block  0.5566010475158691
generate_one_block  0.5564603805541992
generate_one_block  0.5572159290313721
generate_one_block  0.5472431182861328
generate_one_block  0.5563623905181885
generate_one_block  0.5586249828338623
generate_one_block  0.5507662296295166
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12245845794677734  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

connection checking time:  27.359845638275146
block generation total time  24.48965620994568
average batch blocks generation time:  0.7653017565608025
block dataloader generation time/epoch 54.59215199947357
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529184341430664  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.104623317718506  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10452985763549805  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.6763014793396  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518074035644531  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.589559078216553  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10444355010986328  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.67621660232544  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052236557006836  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.79834794998169  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10455751419067383  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.541277408599854  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525751113891602  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.98081111907959  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10454273223876953  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.52694034576416  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530853271484375  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.262773036956787  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10456371307373047  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.09648084640503  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525274276733398  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.010456085205078  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1048436164855957  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.695530891418457  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524463653564453  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.941950798034668  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046762466430664  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.27357053756714  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528802871704102  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.14060688018799  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10481023788452148  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.205936908721924  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10517024993896484  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.476896286010742  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10466766357421875  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.906978130340576  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528421401977539  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.1435489654541  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1045374870300293  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.769543647766113  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529422760009766  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.08915901184082  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10470962524414062  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.189980506896973  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523843765258789  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.990532875061035  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1049652099609375  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.063908576965332  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522270202636719  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.77788209915161  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10465764999389648  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.80594539642334  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10527896881103516  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.055855751037598  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10455942153930664  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.067124366760254  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520601272583008  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.698143005371094  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10455846786499023  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.726091384887695  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523366928100586  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.832631587982178  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10446596145629883  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.71008586883545  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03532565385103226 |0.01633729785680771 |0.41521378606557846 |9.479373693466187e-05 |0.7543500736355782 |0.005602598190307617 |
----------------------------------------------------------pseudo_mini_loss sum 1.2868210077285767
Total (block generation + training)time/epoch 93.71801196038723
Training time/epoch 39.143800258636475
Training time without block to device /epoch 38.62100672721863
Training time without total dataloading part /epoch 37.43467950820923
load block tensor time/epoch 1.1304209232330322
block to device time/epoch 0.5227935314178467
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  8791026
Number of first layer input nodes during this epoch:  4679962
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1220235824584961  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02601766586303711
range selection method range initialization spend 0.016645431518554688
time for parepare:  0.01897573471069336
local_output_nid generation:  0.0010254383087158203
local_in_edges_tensor generation:  0.009267568588256836
mini_batch_src_global generation:  0.0019271373748779297
r_  generation:  0.010585784912109375
local_output_nid generation:  0.0009708404541015625
local_in_edges_tensor generation:  0.0006694793701171875
mini_batch_src_global generation:  0.0015935897827148438
r_  generation:  0.010825872421264648
local_output_nid generation:  0.0009217262268066406
local_in_edges_tensor generation:  0.0006058216094970703
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.010016918182373047
local_output_nid generation:  0.000911712646484375
local_in_edges_tensor generation:  0.0005965232849121094
mini_batch_src_global generation:  0.0011858940124511719
r_  generation:  0.01047658920288086
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0005576610565185547
mini_batch_src_global generation:  0.0010585784912109375
r_  generation:  0.009731054306030273
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0011782646179199219
r_  generation:  0.01001119613647461
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0006189346313476562
mini_batch_src_global generation:  0.0011298656463623047
r_  generation:  0.01032114028930664
local_output_nid generation:  0.0008606910705566406
local_in_edges_tensor generation:  0.0005774497985839844
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.010065793991088867
local_output_nid generation:  0.0008792877197265625
local_in_edges_tensor generation:  0.0005767345428466797
mini_batch_src_global generation:  0.0011861324310302734
r_  generation:  0.010660886764526367
local_output_nid generation:  0.0008952617645263672
local_in_edges_tensor generation:  0.0006718635559082031
mini_batch_src_global generation:  0.0011951923370361328
r_  generation:  0.01085352897644043
local_output_nid generation:  0.0009138584136962891
local_in_edges_tensor generation:  0.0005447864532470703
mini_batch_src_global generation:  0.0011210441589355469
r_  generation:  0.01053619384765625
local_output_nid generation:  0.0009284019470214844
local_in_edges_tensor generation:  0.00058746337890625
mini_batch_src_global generation:  0.0012178421020507812
r_  generation:  0.010867118835449219
local_output_nid generation:  0.0008966922760009766
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.01024174690246582
local_output_nid generation:  0.0009286403656005859
local_in_edges_tensor generation:  0.0005731582641601562
mini_batch_src_global generation:  0.001070261001586914
r_  generation:  0.009896278381347656
local_output_nid generation:  0.0008661746978759766
local_in_edges_tensor generation:  0.0005462169647216797
mini_batch_src_global generation:  0.0010652542114257812
r_  generation:  0.010236740112304688
local_output_nid generation:  0.0009050369262695312
local_in_edges_tensor generation:  0.0005869865417480469
mini_batch_src_global generation:  0.0011138916015625
r_  generation:  0.010190725326538086
local_output_nid generation:  0.0008814334869384766
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.0010867118835449219
r_  generation:  0.01040196418762207
local_output_nid generation:  0.0008871555328369141
local_in_edges_tensor generation:  0.0005846023559570312
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.01015329360961914
local_output_nid generation:  0.0008871555328369141
local_in_edges_tensor generation:  0.0005612373352050781
mini_batch_src_global generation:  0.0010523796081542969
r_  generation:  0.010239601135253906
local_output_nid generation:  0.0009012222290039062
local_in_edges_tensor generation:  0.0006029605865478516
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.010337352752685547
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.00055694580078125
mini_batch_src_global generation:  0.0011000633239746094
r_  generation:  0.010390043258666992
local_output_nid generation:  0.0008976459503173828
local_in_edges_tensor generation:  0.0006082057952880859
mini_batch_src_global generation:  0.0011682510375976562
r_  generation:  0.01058340072631836
local_output_nid generation:  0.0008604526519775391
local_in_edges_tensor generation:  0.00054168701171875
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.010303497314453125
local_output_nid generation:  0.0009293556213378906
local_in_edges_tensor generation:  0.000579833984375
mini_batch_src_global generation:  0.0011067390441894531
r_  generation:  0.010310649871826172
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0010769367218017578
r_  generation:  0.010208606719970703
local_output_nid generation:  0.0009081363677978516
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0010843276977539062
r_  generation:  0.010267496109008789
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0005562305450439453
mini_batch_src_global generation:  0.0010962486267089844
r_  generation:  0.010545730590820312
local_output_nid generation:  0.00090789794921875
local_in_edges_tensor generation:  0.0005791187286376953
mini_batch_src_global generation:  0.0011966228485107422
r_  generation:  0.011157512664794922
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0005590915679931641
mini_batch_src_global generation:  0.0011625289916992188
r_  generation:  0.010740995407104492
local_output_nid generation:  0.0008533000946044922
local_in_edges_tensor generation:  0.0005550384521484375
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.010059833526611328
local_output_nid generation:  0.00087738037109375
local_in_edges_tensor generation:  0.0005414485931396484
mini_batch_src_global generation:  0.0011327266693115234
r_  generation:  0.010184764862060547
local_output_nid generation:  0.0008585453033447266
local_in_edges_tensor generation:  0.0005462169647216797
mini_batch_src_global generation:  0.0011096000671386719
r_  generation:  0.010256528854370117
----------------------check_connections_block total spend ----------------------------- 0.5232877731323242
generate_one_block  0.02334427833557129
generate_one_block  0.019699811935424805
generate_one_block  0.018090009689331055
generate_one_block  0.01848745346069336
generate_one_block  0.017012596130371094
generate_one_block  0.017515182495117188
generate_one_block  0.018007755279541016
generate_one_block  0.017353534698486328
generate_one_block  0.017769336700439453
generate_one_block  0.018071889877319336
generate_one_block  0.017798185348510742
generate_one_block  0.0208284854888916
generate_one_block  0.017846345901489258
generate_one_block  0.017071008682250977
generate_one_block  0.018256664276123047
generate_one_block  0.017210721969604492
generate_one_block  0.017548084259033203
generate_one_block  0.017341136932373047
generate_one_block  0.01741766929626465
generate_one_block  0.017503976821899414
generate_one_block  0.017444372177124023
generate_one_block  0.017812013626098633
generate_one_block  0.017414569854736328
generate_one_block  0.017473697662353516
generate_one_block  0.017243146896362305
generate_one_block  0.017551183700561523
generate_one_block  0.017717599868774414
generate_one_block  0.01868581771850586
generate_one_block  0.01807403564453125
generate_one_block  0.017123937606811523
generate_one_block  0.017220020294189453
generate_one_block  0.017316341400146484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037534475326538086
gen group dst list time:  0.02361130714416504
time for parepare:  0.02231621742248535
local_output_nid generation:  0.005292415618896484
local_in_edges_tensor generation:  0.019340038299560547
mini_batch_src_global generation:  0.014907360076904297
r_  generation:  0.1380469799041748
local_output_nid generation:  0.007534503936767578
local_in_edges_tensor generation:  0.009885549545288086
mini_batch_src_global generation:  0.017139196395874023
r_  generation:  0.14206171035766602
local_output_nid generation:  0.007715463638305664
local_in_edges_tensor generation:  0.03243613243103027
mini_batch_src_global generation:  0.017254114151000977
r_  generation:  0.14590764045715332
local_output_nid generation:  0.008151531219482422
local_in_edges_tensor generation:  0.010159492492675781
mini_batch_src_global generation:  0.018622636795043945
r_  generation:  0.15335750579833984
local_output_nid generation:  0.008263826370239258
local_in_edges_tensor generation:  0.009294509887695312
mini_batch_src_global generation:  0.01840806007385254
r_  generation:  0.14418983459472656
local_output_nid generation:  0.008427858352661133
local_in_edges_tensor generation:  0.008021831512451172
mini_batch_src_global generation:  0.01828145980834961
r_  generation:  0.1497972011566162
local_output_nid generation:  0.008784055709838867
local_in_edges_tensor generation:  0.010704755783081055
mini_batch_src_global generation:  0.019852876663208008
r_  generation:  0.15491104125976562
local_output_nid generation:  0.008307933807373047
local_in_edges_tensor generation:  0.009076356887817383
mini_batch_src_global generation:  0.017996788024902344
r_  generation:  0.14789748191833496
local_output_nid generation:  0.008452415466308594
local_in_edges_tensor generation:  0.00912618637084961
mini_batch_src_global generation:  0.01958465576171875
r_  generation:  0.15381717681884766
local_output_nid generation:  0.008882999420166016
local_in_edges_tensor generation:  0.008307933807373047
mini_batch_src_global generation:  0.01951909065246582
r_  generation:  0.15613365173339844
local_output_nid generation:  0.008764505386352539
local_in_edges_tensor generation:  0.008310079574584961
mini_batch_src_global generation:  0.019661426544189453
r_  generation:  0.1546015739440918
local_output_nid generation:  0.009319543838500977
local_in_edges_tensor generation:  0.009024620056152344
mini_batch_src_global generation:  0.02037835121154785
r_  generation:  0.1612377166748047
local_output_nid generation:  0.00885915756225586
local_in_edges_tensor generation:  0.008620977401733398
mini_batch_src_global generation:  0.019698381423950195
r_  generation:  0.15519499778747559
local_output_nid generation:  0.008634805679321289
local_in_edges_tensor generation:  0.008130311965942383
mini_batch_src_global generation:  0.01869821548461914
r_  generation:  0.15150856971740723
local_output_nid generation:  0.008920669555664062
local_in_edges_tensor generation:  0.008837461471557617
mini_batch_src_global generation:  0.01906728744506836
r_  generation:  0.154191255569458
local_output_nid generation:  0.008912801742553711
local_in_edges_tensor generation:  0.008317947387695312
mini_batch_src_global generation:  0.01835012435913086
r_  generation:  0.14899802207946777
local_output_nid generation:  0.008981704711914062
local_in_edges_tensor generation:  0.008358955383300781
mini_batch_src_global generation:  0.01882314682006836
r_  generation:  0.15225815773010254
local_output_nid generation:  0.008860111236572266
local_in_edges_tensor generation:  0.008104562759399414
mini_batch_src_global generation:  0.018508434295654297
r_  generation:  0.1511368751525879
local_output_nid generation:  0.008996725082397461
local_in_edges_tensor generation:  0.008338451385498047
mini_batch_src_global generation:  0.018622159957885742
r_  generation:  0.15200161933898926
local_output_nid generation:  0.00899815559387207
local_in_edges_tensor generation:  0.008105993270874023
mini_batch_src_global generation:  0.018981456756591797
r_  generation:  0.1557471752166748
local_output_nid generation:  0.008980274200439453
local_in_edges_tensor generation:  0.010727405548095703
mini_batch_src_global generation:  0.01897263526916504
r_  generation:  0.1534252166748047
local_output_nid generation:  0.009252309799194336
local_in_edges_tensor generation:  0.008963584899902344
mini_batch_src_global generation:  0.01954936981201172
r_  generation:  0.15787887573242188
local_output_nid generation:  0.008933782577514648
local_in_edges_tensor generation:  0.008394241333007812
mini_batch_src_global generation:  0.01886153221130371
r_  generation:  0.15334820747375488
local_output_nid generation:  0.00891423225402832
local_in_edges_tensor generation:  0.008134126663208008
mini_batch_src_global generation:  0.018692970275878906
r_  generation:  0.15275144577026367
local_output_nid generation:  0.009116411209106445
local_in_edges_tensor generation:  0.008322715759277344
mini_batch_src_global generation:  0.018345355987548828
r_  generation:  0.15363788604736328
local_output_nid generation:  0.0089874267578125
local_in_edges_tensor generation:  0.008852481842041016
mini_batch_src_global generation:  0.01868128776550293
r_  generation:  0.15439414978027344
local_output_nid generation:  0.009220600128173828
local_in_edges_tensor generation:  0.008286714553833008
mini_batch_src_global generation:  0.019289255142211914
r_  generation:  0.1611499786376953
local_output_nid generation:  0.009519815444946289
local_in_edges_tensor generation:  0.010877132415771484
mini_batch_src_global generation:  0.02072930335998535
r_  generation:  0.1640920639038086
local_output_nid generation:  0.009152650833129883
local_in_edges_tensor generation:  0.008674144744873047
mini_batch_src_global generation:  0.01968073844909668
r_  generation:  0.16012263298034668
local_output_nid generation:  0.008831977844238281
local_in_edges_tensor generation:  0.008307456970214844
mini_batch_src_global generation:  0.01868724822998047
r_  generation:  0.151472806930542
local_output_nid generation:  0.008959531784057617
local_in_edges_tensor generation:  0.008178949356079102
mini_batch_src_global generation:  0.018546104431152344
r_  generation:  0.15378737449645996
local_output_nid generation:  0.008992910385131836
local_in_edges_tensor generation:  0.008773565292358398
mini_batch_src_global generation:  0.018574953079223633
r_  generation:  0.1532421112060547
----------------------check_connections_block total spend ----------------------------- 7.255795955657959
generate_one_block  0.20000910758972168
generate_one_block  0.20285964012145996
generate_one_block  0.20279812812805176
generate_one_block  0.21036124229431152
generate_one_block  0.20795083045959473
generate_one_block  0.19647741317749023
generate_one_block  0.2081010341644287
generate_one_block  0.19789457321166992
generate_one_block  0.20384526252746582
generate_one_block  0.21149754524230957
generate_one_block  0.2060868740081787
generate_one_block  0.21282052993774414
generate_one_block  0.20003676414489746
generate_one_block  0.20002436637878418
generate_one_block  0.20305275917053223
generate_one_block  0.19558286666870117
generate_one_block  0.20152592658996582
generate_one_block  0.20482301712036133
generate_one_block  0.20192623138427734
generate_one_block  0.2069993019104004
generate_one_block  0.20176315307617188
generate_one_block  0.20988225936889648
generate_one_block  0.20111799240112305
generate_one_block  0.20212912559509277
generate_one_block  0.201340913772583
generate_one_block  0.20490002632141113
generate_one_block  0.20915603637695312
generate_one_block  0.21996545791625977
generate_one_block  0.21004438400268555
generate_one_block  0.19619393348693848
generate_one_block  0.20037031173706055
generate_one_block  0.2005453109741211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03635907173156738
gen group dst list time:  0.10172057151794434
time for parepare:  0.01995229721069336
local_output_nid generation:  0.026820659637451172
local_in_edges_tensor generation:  0.038208961486816406
mini_batch_src_global generation:  0.03713417053222656
r_  generation:  0.40248918533325195
local_output_nid generation:  0.028861522674560547
local_in_edges_tensor generation:  0.031831979751586914
mini_batch_src_global generation:  0.048069000244140625
r_  generation:  0.4035336971282959
local_output_nid generation:  0.028823375701904297
local_in_edges_tensor generation:  0.02689528465270996
mini_batch_src_global generation:  0.046124935150146484
r_  generation:  0.4185769557952881
local_output_nid generation:  0.028992652893066406
local_in_edges_tensor generation:  0.028759479522705078
mini_batch_src_global generation:  0.04989767074584961
r_  generation:  0.4091346263885498
local_output_nid generation:  0.028691530227661133
local_in_edges_tensor generation:  0.028249502182006836
mini_batch_src_global generation:  0.04666590690612793
r_  generation:  0.4142775535583496
local_output_nid generation:  0.02880692481994629
local_in_edges_tensor generation:  0.027660369873046875
mini_batch_src_global generation:  0.048516273498535156
r_  generation:  0.4075357913970947
local_output_nid generation:  0.027570724487304688
local_in_edges_tensor generation:  0.02936100959777832
mini_batch_src_global generation:  0.04726552963256836
r_  generation:  0.42015647888183594
local_output_nid generation:  0.026981115341186523
local_in_edges_tensor generation:  0.027337074279785156
mini_batch_src_global generation:  0.04855036735534668
r_  generation:  0.40287160873413086
local_output_nid generation:  0.027382373809814453
local_in_edges_tensor generation:  0.028018951416015625
mini_batch_src_global generation:  0.047661781311035156
r_  generation:  0.4167923927307129
local_output_nid generation:  0.02777719497680664
local_in_edges_tensor generation:  0.025644302368164062
mini_batch_src_global generation:  0.049097299575805664
r_  generation:  0.40837907791137695
local_output_nid generation:  0.027205228805541992
local_in_edges_tensor generation:  0.029081106185913086
mini_batch_src_global generation:  0.0469515323638916
r_  generation:  0.4188258647918701
local_output_nid generation:  0.02797675132751465
local_in_edges_tensor generation:  0.027919292449951172
mini_batch_src_global generation:  0.04925036430358887
r_  generation:  0.41338634490966797
local_output_nid generation:  0.027556896209716797
local_in_edges_tensor generation:  0.027454614639282227
mini_batch_src_global generation:  0.04719376564025879
r_  generation:  0.41413021087646484
local_output_nid generation:  0.027420759201049805
local_in_edges_tensor generation:  0.02568674087524414
mini_batch_src_global generation:  0.050621747970581055
r_  generation:  0.4129030704498291
local_output_nid generation:  0.02809929847717285
local_in_edges_tensor generation:  0.026123523712158203
mini_batch_src_global generation:  0.047590017318725586
r_  generation:  0.4198729991912842
local_output_nid generation:  0.02760171890258789
local_in_edges_tensor generation:  0.025504589080810547
mini_batch_src_global generation:  0.048638105392456055
r_  generation:  0.4103527069091797
local_output_nid generation:  0.029028654098510742
local_in_edges_tensor generation:  0.028673887252807617
mini_batch_src_global generation:  0.0473780632019043
r_  generation:  0.41788268089294434
local_output_nid generation:  0.028203964233398438
local_in_edges_tensor generation:  0.027484416961669922
mini_batch_src_global generation:  0.0489199161529541
r_  generation:  0.4109323024749756
local_output_nid generation:  0.028310298919677734
local_in_edges_tensor generation:  0.027853012084960938
mini_batch_src_global generation:  0.047118186950683594
r_  generation:  0.41855716705322266
local_output_nid generation:  0.028374671936035156
local_in_edges_tensor generation:  0.028919696807861328
mini_batch_src_global generation:  0.050701141357421875
r_  generation:  0.41234922409057617
local_output_nid generation:  0.02800726890563965
local_in_edges_tensor generation:  0.027917146682739258
mini_batch_src_global generation:  0.046709537506103516
r_  generation:  0.41646552085876465
local_output_nid generation:  0.028374195098876953
local_in_edges_tensor generation:  0.026047706604003906
mini_batch_src_global generation:  0.05436587333679199
r_  generation:  0.4115407466888428
local_output_nid generation:  0.027855634689331055
local_in_edges_tensor generation:  0.02642536163330078
mini_batch_src_global generation:  0.046999216079711914
r_  generation:  0.41111183166503906
local_output_nid generation:  0.028046131134033203
local_in_edges_tensor generation:  0.025298595428466797
mini_batch_src_global generation:  0.0506134033203125
r_  generation:  0.40606260299682617
local_output_nid generation:  0.028192996978759766
local_in_edges_tensor generation:  0.0256195068359375
mini_batch_src_global generation:  0.046506404876708984
r_  generation:  0.415813684463501
local_output_nid generation:  0.027976274490356445
local_in_edges_tensor generation:  0.025391340255737305
mini_batch_src_global generation:  0.049262046813964844
r_  generation:  0.404726505279541
local_output_nid generation:  0.028344154357910156
local_in_edges_tensor generation:  0.0260162353515625
mini_batch_src_global generation:  0.047226905822753906
r_  generation:  0.4308962821960449
local_output_nid generation:  0.029109954833984375
local_in_edges_tensor generation:  0.0338594913482666
mini_batch_src_global generation:  0.05339932441711426
r_  generation:  0.42366909980773926
local_output_nid generation:  0.028296709060668945
local_in_edges_tensor generation:  0.0314486026763916
mini_batch_src_global generation:  0.04738736152648926
r_  generation:  0.4177227020263672
local_output_nid generation:  0.02812957763671875
local_in_edges_tensor generation:  0.02580404281616211
mini_batch_src_global generation:  0.051467180252075195
r_  generation:  0.4076881408691406
local_output_nid generation:  0.028038978576660156
local_in_edges_tensor generation:  0.02764129638671875
mini_batch_src_global generation:  0.048465728759765625
r_  generation:  0.4175548553466797
local_output_nid generation:  0.028377056121826172
local_in_edges_tensor generation:  0.025772571563720703
mini_batch_src_global generation:  0.04892396926879883
r_  generation:  0.4095895290374756
----------------------check_connections_block total spend ----------------------------- 19.5276517868042
generate_one_block  0.5595414638519287
generate_one_block  0.5448722839355469
generate_one_block  0.5502669811248779
generate_one_block  0.5528542995452881
generate_one_block  0.6343436241149902
generate_one_block  0.5471560955047607
generate_one_block  0.5606582164764404
generate_one_block  0.5471067428588867
generate_one_block  0.5552911758422852
generate_one_block  0.558574914932251
generate_one_block  0.5470952987670898
generate_one_block  0.5616357326507568
generate_one_block  0.5508534908294678
generate_one_block  0.5489485263824463
generate_one_block  0.5518710613250732
generate_one_block  0.542057991027832
generate_one_block  0.5526409149169922
generate_one_block  0.552865743637085
generate_one_block  0.5486969947814941
generate_one_block  0.5571649074554443
generate_one_block  0.5508937835693359
generate_one_block  0.5590171813964844
generate_one_block  0.5430572032928467
generate_one_block  0.547325611114502
generate_one_block  0.5673654079437256
generate_one_block  0.5478007793426514
generate_one_block  0.5581767559051514
generate_one_block  0.5642385482788086
generate_one_block  0.5486180782318115
generate_one_block  0.5509190559387207
generate_one_block  0.5484395027160645
generate_one_block  0.5544242858886719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1220235824584961  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

connection checking time:  26.783447742462158
block generation total time  24.296854972839355
average batch blocks generation time:  0.7592767179012299
block dataloader generation time/epoch 54.55889316166149
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520744323730469  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.724894523620605  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10449647903442383  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.710543155670166  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523557662963867  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.856966972351074  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10479736328125  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.233603954315186  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10515880584716797  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.507210731506348  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10467863082885742  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.65517234802246  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528755187988281  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.1984281539917  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10441160202026367  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.584458351135254  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525703430175781  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.054789543151855  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10486268997192383  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.184133052825928  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525703430175781  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.88082504272461  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10513162612915039  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.440648078918457  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522079467773438  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.791791915893555  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10442733764648438  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.71859836578369  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525083541870117  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.991884231567383  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10485267639160156  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.623120307922363  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052250862121582  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.790382862091064  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10476303100585938  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.739575386047363  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522127151489258  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.755892753601074  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10471439361572266  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.846843242645264  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522937774658203  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.810327529907227  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10489606857299805  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.214297771453857  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10522603988647461  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.837802410125732  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10456132888793945  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.761754989624023  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521697998046875  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.747840881347656  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10450983047485352  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.801998138427734  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530233383178711  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.138535022735596  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10504531860351562  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.524691581726074  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10531187057495117  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.196927070617676  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10468530654907227  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.65839958190918  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052250862121582  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.905272006988525  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10478734970092773  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.81556272506714  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037289999425411224 |0.015820607542991638 |0.4174465462565422 |9.445846080780029e-05 |0.7578878849744797 |0.005738496780395508 |
----------------------------------------------------------pseudo_mini_loss sum 1.2661356925964355
Total (block generation + training)time/epoch 93.6995950867148
Training time/epoch 39.37793731689453
Training time without block to device /epoch 38.8716778755188
Training time without total dataloading part /epoch 37.619462966918945
load block tensor time/epoch 1.1932799816131592
block to device time/epoch 0.5062594413757324
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  8794521
Number of first layer input nodes during this epoch:  4681743
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12277412414550781  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02628803253173828
range selection method range initialization spend 0.01705169677734375
time for parepare:  0.02017068862915039
local_output_nid generation:  0.0009641647338867188
local_in_edges_tensor generation:  0.0066318511962890625
mini_batch_src_global generation:  0.003049612045288086
r_  generation:  0.015599727630615234
local_output_nid generation:  0.0014286041259765625
local_in_edges_tensor generation:  0.0010068416595458984
mini_batch_src_global generation:  0.002184629440307617
r_  generation:  0.01164388656616211
local_output_nid generation:  0.0011799335479736328
local_in_edges_tensor generation:  0.0007231235504150391
mini_batch_src_global generation:  0.0014431476593017578
r_  generation:  0.010480165481567383
local_output_nid generation:  0.001142263412475586
local_in_edges_tensor generation:  0.0007753372192382812
mini_batch_src_global generation:  0.0014317035675048828
r_  generation:  0.009994268417358398
local_output_nid generation:  0.0011217594146728516
local_in_edges_tensor generation:  0.0007274150848388672
mini_batch_src_global generation:  0.0013573169708251953
r_  generation:  0.010437250137329102
local_output_nid generation:  0.0011146068572998047
local_in_edges_tensor generation:  0.0007927417755126953
mini_batch_src_global generation:  0.0014925003051757812
r_  generation:  0.009924888610839844
local_output_nid generation:  0.001111745834350586
local_in_edges_tensor generation:  0.0008265972137451172
mini_batch_src_global generation:  0.0013206005096435547
r_  generation:  0.009922504425048828
local_output_nid generation:  0.0011749267578125
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.0012812614440917969
r_  generation:  0.009747982025146484
local_output_nid generation:  0.0010974407196044922
local_in_edges_tensor generation:  0.0006511211395263672
mini_batch_src_global generation:  0.0012905597686767578
r_  generation:  0.012856245040893555
local_output_nid generation:  0.0011224746704101562
local_in_edges_tensor generation:  0.000659942626953125
mini_batch_src_global generation:  0.0014486312866210938
r_  generation:  0.010223150253295898
local_output_nid generation:  0.0010862350463867188
local_in_edges_tensor generation:  0.0006678104400634766
mini_batch_src_global generation:  0.0013267993927001953
r_  generation:  0.010474681854248047
local_output_nid generation:  0.0010876655578613281
local_in_edges_tensor generation:  0.0007882118225097656
mini_batch_src_global generation:  0.0014889240264892578
r_  generation:  0.01001882553100586
local_output_nid generation:  0.0010695457458496094
local_in_edges_tensor generation:  0.0006449222564697266
mini_batch_src_global generation:  0.001352071762084961
r_  generation:  0.010116100311279297
local_output_nid generation:  0.001085519790649414
local_in_edges_tensor generation:  0.0007462501525878906
mini_batch_src_global generation:  0.0013508796691894531
r_  generation:  0.010628938674926758
local_output_nid generation:  0.0010569095611572266
local_in_edges_tensor generation:  0.0007138252258300781
mini_batch_src_global generation:  0.0014750957489013672
r_  generation:  0.010555267333984375
local_output_nid generation:  0.001062154769897461
local_in_edges_tensor generation:  0.000659942626953125
mini_batch_src_global generation:  0.0014789104461669922
r_  generation:  0.010254859924316406
local_output_nid generation:  0.001069784164428711
local_in_edges_tensor generation:  0.0007116794586181641
mini_batch_src_global generation:  0.0014493465423583984
r_  generation:  0.010210514068603516
local_output_nid generation:  0.0010685920715332031
local_in_edges_tensor generation:  0.0007138252258300781
mini_batch_src_global generation:  0.0013377666473388672
r_  generation:  0.010374307632446289
local_output_nid generation:  0.0010459423065185547
local_in_edges_tensor generation:  0.0007076263427734375
mini_batch_src_global generation:  0.0012798309326171875
r_  generation:  0.0103759765625
local_output_nid generation:  0.0010445117950439453
local_in_edges_tensor generation:  0.0008208751678466797
mini_batch_src_global generation:  0.0013418197631835938
r_  generation:  0.01024007797241211
local_output_nid generation:  0.0010385513305664062
local_in_edges_tensor generation:  0.00066375732421875
mini_batch_src_global generation:  0.0013625621795654297
r_  generation:  0.010281085968017578
local_output_nid generation:  0.001054525375366211
local_in_edges_tensor generation:  0.000705718994140625
mini_batch_src_global generation:  0.0013730525970458984
r_  generation:  0.013552665710449219
local_output_nid generation:  0.0010941028594970703
local_in_edges_tensor generation:  0.0006606578826904297
mini_batch_src_global generation:  0.0014111995697021484
r_  generation:  0.010413169860839844
local_output_nid generation:  0.001071929931640625
local_in_edges_tensor generation:  0.0006425380706787109
mini_batch_src_global generation:  0.0013310909271240234
r_  generation:  0.010239839553833008
local_output_nid generation:  0.0010380744934082031
local_in_edges_tensor generation:  0.0006380081176757812
mini_batch_src_global generation:  0.001344442367553711
r_  generation:  0.010365724563598633
local_output_nid generation:  0.00104522705078125
local_in_edges_tensor generation:  0.0006682872772216797
mini_batch_src_global generation:  0.0013570785522460938
r_  generation:  0.010892391204833984
local_output_nid generation:  0.0010404586791992188
local_in_edges_tensor generation:  0.0006818771362304688
mini_batch_src_global generation:  0.0013170242309570312
r_  generation:  0.010482549667358398
local_output_nid generation:  0.001047372817993164
local_in_edges_tensor generation:  0.0006363391876220703
mini_batch_src_global generation:  0.0013191699981689453
r_  generation:  0.010835409164428711
local_output_nid generation:  0.0010516643524169922
local_in_edges_tensor generation:  0.0006916522979736328
mini_batch_src_global generation:  0.0013887882232666016
r_  generation:  0.010521411895751953
local_output_nid generation:  0.0010342597961425781
local_in_edges_tensor generation:  0.0006618499755859375
mini_batch_src_global generation:  0.0013384819030761719
r_  generation:  0.010457754135131836
local_output_nid generation:  0.0010409355163574219
local_in_edges_tensor generation:  0.0007140636444091797
mini_batch_src_global generation:  0.0014200210571289062
r_  generation:  0.011046171188354492
local_output_nid generation:  0.001055002212524414
local_in_edges_tensor generation:  0.0006754398345947266
mini_batch_src_global generation:  0.0013580322265625
r_  generation:  0.010165929794311523
----------------------check_connections_block total spend ----------------------------- 0.5591294765472412
generate_one_block  0.026754379272460938
generate_one_block  0.025342464447021484
generate_one_block  0.0201261043548584
generate_one_block  0.018587589263916016
generate_one_block  0.019086122512817383
generate_one_block  0.018360137939453125
generate_one_block  0.01780414581298828
generate_one_block  0.017746448516845703
generate_one_block  0.018148422241210938
generate_one_block  0.018241405487060547
generate_one_block  0.018340349197387695
generate_one_block  0.023819923400878906
generate_one_block  0.01904749870300293
generate_one_block  0.018917560577392578
generate_one_block  0.018924951553344727
generate_one_block  0.01830911636352539
generate_one_block  0.017995357513427734
generate_one_block  0.0186004638671875
generate_one_block  0.017810344696044922
generate_one_block  0.017748594284057617
generate_one_block  0.018062829971313477
generate_one_block  0.01869511604309082
generate_one_block  0.020948171615600586
generate_one_block  0.017911911010742188
generate_one_block  0.018514394760131836
generate_one_block  0.018864870071411133
generate_one_block  0.018583059310913086
generate_one_block  0.018679380416870117
generate_one_block  0.018312692642211914
generate_one_block  0.017848968505859375
generate_one_block  0.019201993942260742
generate_one_block  0.017877578735351562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04061436653137207
gen group dst list time:  0.032308101654052734
time for parepare:  0.028366565704345703
local_output_nid generation:  0.007922172546386719
local_in_edges_tensor generation:  0.018477916717529297
mini_batch_src_global generation:  0.015807390213012695
r_  generation:  0.17439532279968262
local_output_nid generation:  0.009041309356689453
local_in_edges_tensor generation:  0.010962963104248047
mini_batch_src_global generation:  0.03847789764404297
r_  generation:  0.15076303482055664
local_output_nid generation:  0.007941007614135742
local_in_edges_tensor generation:  0.03718709945678711
mini_batch_src_global generation:  0.020793914794921875
r_  generation:  0.15608739852905273
local_output_nid generation:  0.00782632827758789
local_in_edges_tensor generation:  0.008462667465209961
mini_batch_src_global generation:  0.020461559295654297
r_  generation:  0.15351057052612305
local_output_nid generation:  0.008398294448852539
local_in_edges_tensor generation:  0.009883880615234375
mini_batch_src_global generation:  0.021409273147583008
r_  generation:  0.16033625602722168
local_output_nid generation:  0.008312702178955078
local_in_edges_tensor generation:  0.0085906982421875
mini_batch_src_global generation:  0.02204155921936035
r_  generation:  0.1562509536743164
local_output_nid generation:  0.008213996887207031
local_in_edges_tensor generation:  0.009028434753417969
mini_batch_src_global generation:  0.021474123001098633
r_  generation:  0.15370655059814453
local_output_nid generation:  0.008059978485107422
local_in_edges_tensor generation:  0.009533882141113281
mini_batch_src_global generation:  0.021049976348876953
r_  generation:  0.15066289901733398
local_output_nid generation:  0.008018016815185547
local_in_edges_tensor generation:  0.009888648986816406
mini_batch_src_global generation:  0.019270896911621094
r_  generation:  0.1559460163116455
local_output_nid generation:  0.008326530456542969
local_in_edges_tensor generation:  0.008728265762329102
mini_batch_src_global generation:  0.020090103149414062
r_  generation:  0.15772533416748047
local_output_nid generation:  0.008391857147216797
local_in_edges_tensor generation:  0.01101231575012207
mini_batch_src_global generation:  0.020386219024658203
r_  generation:  0.16155457496643066
local_output_nid generation:  0.008666276931762695
local_in_edges_tensor generation:  0.008026123046875
mini_batch_src_global generation:  0.02070307731628418
r_  generation:  0.15874719619750977
local_output_nid generation:  0.008764982223510742
local_in_edges_tensor generation:  0.008260011672973633
mini_batch_src_global generation:  0.019438982009887695
r_  generation:  0.16237354278564453
local_output_nid generation:  0.008994817733764648
local_in_edges_tensor generation:  0.009466171264648438
mini_batch_src_global generation:  0.02313709259033203
r_  generation:  0.19401788711547852
local_output_nid generation:  0.014554738998413086
local_in_edges_tensor generation:  0.011741161346435547
mini_batch_src_global generation:  0.0226132869720459
r_  generation:  0.18969035148620605
local_output_nid generation:  0.012367486953735352
local_in_edges_tensor generation:  0.00959634780883789
mini_batch_src_global generation:  0.0375523567199707
r_  generation:  0.1681218147277832
local_output_nid generation:  0.009487390518188477
local_in_edges_tensor generation:  0.008536577224731445
mini_batch_src_global generation:  0.019962787628173828
r_  generation:  0.15876197814941406
local_output_nid generation:  0.009341001510620117
local_in_edges_tensor generation:  0.008701324462890625
mini_batch_src_global generation:  0.022835969924926758
r_  generation:  0.16491913795471191
local_output_nid generation:  0.009891033172607422
local_in_edges_tensor generation:  0.01200413703918457
mini_batch_src_global generation:  0.019785404205322266
r_  generation:  0.1655721664428711
local_output_nid generation:  0.008918523788452148
local_in_edges_tensor generation:  0.00967860221862793
mini_batch_src_global generation:  0.01962137222290039
r_  generation:  0.15858078002929688
local_output_nid generation:  0.008969545364379883
local_in_edges_tensor generation:  0.014968633651733398
mini_batch_src_global generation:  0.02044391632080078
r_  generation:  0.15957999229431152
local_output_nid generation:  0.01107025146484375
local_in_edges_tensor generation:  0.01168370246887207
mini_batch_src_global generation:  0.021483898162841797
r_  generation:  0.17192435264587402
local_output_nid generation:  0.009152650833129883
local_in_edges_tensor generation:  0.009686470031738281
mini_batch_src_global generation:  0.021087646484375
r_  generation:  0.16777896881103516
local_output_nid generation:  0.009037971496582031
local_in_edges_tensor generation:  0.009299755096435547
mini_batch_src_global generation:  0.02254772186279297
r_  generation:  0.16315293312072754
local_output_nid generation:  0.009200572967529297
local_in_edges_tensor generation:  0.011858701705932617
mini_batch_src_global generation:  0.02165961265563965
r_  generation:  0.16571259498596191
local_output_nid generation:  0.00927734375
local_in_edges_tensor generation:  0.011183500289916992
mini_batch_src_global generation:  0.020651817321777344
r_  generation:  0.1642146110534668
local_output_nid generation:  0.009153127670288086
local_in_edges_tensor generation:  0.008577585220336914
mini_batch_src_global generation:  0.020554304122924805
r_  generation:  0.16480588912963867
local_output_nid generation:  0.009196996688842773
local_in_edges_tensor generation:  0.009272575378417969
mini_batch_src_global generation:  0.021703243255615234
r_  generation:  0.17022323608398438
local_output_nid generation:  0.009035110473632812
local_in_edges_tensor generation:  0.009035825729370117
mini_batch_src_global generation:  0.02025437355041504
r_  generation:  0.16897201538085938
local_output_nid generation:  0.009971857070922852
local_in_edges_tensor generation:  0.009025812149047852
mini_batch_src_global generation:  0.030371904373168945
r_  generation:  0.15818285942077637
local_output_nid generation:  0.010213136672973633
local_in_edges_tensor generation:  0.009150505065917969
mini_batch_src_global generation:  0.020882606506347656
r_  generation:  0.16748714447021484
local_output_nid generation:  0.009072542190551758
local_in_edges_tensor generation:  0.008996725082397461
mini_batch_src_global generation:  0.019879817962646484
r_  generation:  0.15665149688720703
----------------------check_connections_block total spend ----------------------------- 7.827084541320801
generate_one_block  0.21341753005981445
generate_one_block  0.20386815071105957
generate_one_block  0.21013379096984863
generate_one_block  0.2027432918548584
generate_one_block  0.22769761085510254
generate_one_block  0.20326519012451172
generate_one_block  0.1989152431488037
generate_one_block  0.19459843635559082
generate_one_block  0.20461630821228027
generate_one_block  0.2051534652709961
generate_one_block  0.21517062187194824
generate_one_block  0.2202765941619873
generate_one_block  0.2076864242553711
generate_one_block  0.2117931842803955
generate_one_block  0.21352934837341309
generate_one_block  0.21113967895507812
generate_one_block  0.2048497200012207
generate_one_block  0.21123838424682617
generate_one_block  0.2059640884399414
generate_one_block  0.20764589309692383
generate_one_block  0.2068772315979004
generate_one_block  0.22005820274353027
generate_one_block  0.21489834785461426
generate_one_block  0.2036736011505127
generate_one_block  0.21166014671325684
generate_one_block  0.2121732234954834
generate_one_block  0.21171283721923828
generate_one_block  0.2128279209136963
generate_one_block  0.21279096603393555
generate_one_block  0.2005448341369629
generate_one_block  0.2175748348236084
generate_one_block  0.20099782943725586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036377668380737305
gen group dst list time:  0.10920405387878418
time for parepare:  0.018653154373168945
local_output_nid generation:  0.023840904235839844
local_in_edges_tensor generation:  0.04368329048156738
mini_batch_src_global generation:  0.03705644607543945
r_  generation:  0.40395307540893555
local_output_nid generation:  0.02959156036376953
local_in_edges_tensor generation:  0.0323178768157959
mini_batch_src_global generation:  0.05017232894897461
r_  generation:  0.40636229515075684
local_output_nid generation:  0.028928756713867188
local_in_edges_tensor generation:  0.028314828872680664
mini_batch_src_global generation:  0.04666852951049805
r_  generation:  0.41622042655944824
local_output_nid generation:  0.029039859771728516
local_in_edges_tensor generation:  0.025603532791137695
mini_batch_src_global generation:  0.04836463928222656
r_  generation:  0.4044382572174072
local_output_nid generation:  0.029292821884155273
local_in_edges_tensor generation:  0.02726292610168457
mini_batch_src_global generation:  0.04885077476501465
r_  generation:  0.4194965362548828
local_output_nid generation:  0.02944159507751465
local_in_edges_tensor generation:  0.0253450870513916
mini_batch_src_global generation:  0.05092787742614746
r_  generation:  0.4126265048980713
local_output_nid generation:  0.027735233306884766
local_in_edges_tensor generation:  0.027010440826416016
mini_batch_src_global generation:  0.04674577713012695
r_  generation:  0.4291555881500244
local_output_nid generation:  0.029747962951660156
local_in_edges_tensor generation:  0.026632070541381836
mini_batch_src_global generation:  0.049687862396240234
r_  generation:  0.4036078453063965
local_output_nid generation:  0.0279386043548584
local_in_edges_tensor generation:  0.025907516479492188
mini_batch_src_global generation:  0.04668068885803223
r_  generation:  0.41533970832824707
local_output_nid generation:  0.02811717987060547
local_in_edges_tensor generation:  0.026907920837402344
mini_batch_src_global generation:  0.04924201965332031
r_  generation:  0.4084751605987549
local_output_nid generation:  0.02834463119506836
local_in_edges_tensor generation:  0.027138471603393555
mini_batch_src_global generation:  0.048354148864746094
r_  generation:  0.4240431785583496
local_output_nid generation:  0.02814960479736328
local_in_edges_tensor generation:  0.02666950225830078
mini_batch_src_global generation:  0.05030226707458496
r_  generation:  0.4056835174560547
local_output_nid generation:  0.02835822105407715
local_in_edges_tensor generation:  0.02558159828186035
mini_batch_src_global generation:  0.04793739318847656
r_  generation:  0.41658830642700195
local_output_nid generation:  0.028088092803955078
local_in_edges_tensor generation:  0.029509305953979492
mini_batch_src_global generation:  0.050162553787231445
r_  generation:  0.4125645160675049
local_output_nid generation:  0.028473854064941406
local_in_edges_tensor generation:  0.02684187889099121
mini_batch_src_global generation:  0.04841899871826172
r_  generation:  0.4162254333496094
local_output_nid generation:  0.028310537338256836
local_in_edges_tensor generation:  0.02544689178466797
mini_batch_src_global generation:  0.0501866340637207
r_  generation:  0.41433238983154297
local_output_nid generation:  0.027750492095947266
local_in_edges_tensor generation:  0.024776220321655273
mini_batch_src_global generation:  0.046622514724731445
r_  generation:  0.41332459449768066
local_output_nid generation:  0.028263330459594727
local_in_edges_tensor generation:  0.026822566986083984
mini_batch_src_global generation:  0.0494389533996582
r_  generation:  0.4184110164642334
local_output_nid generation:  0.028437376022338867
local_in_edges_tensor generation:  0.028313875198364258
mini_batch_src_global generation:  0.047466278076171875
r_  generation:  0.43192291259765625
local_output_nid generation:  0.03171086311340332
local_in_edges_tensor generation:  0.025328636169433594
mini_batch_src_global generation:  0.04984402656555176
r_  generation:  0.4112863540649414
local_output_nid generation:  0.028343915939331055
local_in_edges_tensor generation:  0.02731609344482422
mini_batch_src_global generation:  0.04723834991455078
r_  generation:  0.4260869026184082
local_output_nid generation:  0.03094005584716797
local_in_edges_tensor generation:  0.029511213302612305
mini_batch_src_global generation:  0.05220150947570801
r_  generation:  0.4178745746612549
local_output_nid generation:  0.028603076934814453
local_in_edges_tensor generation:  0.027622461318969727
mini_batch_src_global generation:  0.04714512825012207
r_  generation:  0.43067073822021484
local_output_nid generation:  0.02861642837524414
local_in_edges_tensor generation:  0.028252124786376953
mini_batch_src_global generation:  0.04912424087524414
r_  generation:  0.41143250465393066
local_output_nid generation:  0.028766870498657227
local_in_edges_tensor generation:  0.029900789260864258
mini_batch_src_global generation:  0.04706931114196777
r_  generation:  0.42500925064086914
local_output_nid generation:  0.029818058013916016
local_in_edges_tensor generation:  0.02850198745727539
mini_batch_src_global generation:  0.0491940975189209
r_  generation:  0.4183204174041748
local_output_nid generation:  0.028318166732788086
local_in_edges_tensor generation:  0.025699138641357422
mini_batch_src_global generation:  0.046938180923461914
r_  generation:  0.42558979988098145
local_output_nid generation:  0.029735565185546875
local_in_edges_tensor generation:  0.03114771842956543
mini_batch_src_global generation:  0.05123639106750488
r_  generation:  0.4170527458190918
local_output_nid generation:  0.028657197952270508
local_in_edges_tensor generation:  0.02798318862915039
mini_batch_src_global generation:  0.04739046096801758
r_  generation:  0.42255377769470215
local_output_nid generation:  0.02842545509338379
local_in_edges_tensor generation:  0.027381420135498047
mini_batch_src_global generation:  0.04979276657104492
r_  generation:  0.41500377655029297
local_output_nid generation:  0.028739213943481445
local_in_edges_tensor generation:  0.027711868286132812
mini_batch_src_global generation:  0.047902584075927734
r_  generation:  0.43458056449890137
local_output_nid generation:  0.029469728469848633
local_in_edges_tensor generation:  0.028857946395874023
mini_batch_src_global generation:  0.05063581466674805
r_  generation:  0.4143028259277344
----------------------check_connections_block total spend ----------------------------- 19.697300910949707
generate_one_block  0.5673511028289795
generate_one_block  0.5479996204376221
generate_one_block  0.5538473129272461
generate_one_block  0.5470385551452637
generate_one_block  0.6596822738647461
generate_one_block  0.5576589107513428
generate_one_block  0.5510671138763428
generate_one_block  0.5539448261260986
generate_one_block  0.5586166381835938
generate_one_block  0.558732271194458
generate_one_block  0.5577075481414795
generate_one_block  0.549677848815918
generate_one_block  0.5555646419525146
generate_one_block  0.5590848922729492
generate_one_block  0.5543091297149658
generate_one_block  0.5611426830291748
generate_one_block  0.5475521087646484
generate_one_block  0.5608336925506592
generate_one_block  0.5549571514129639
generate_one_block  0.5474772453308105
generate_one_block  0.5617163181304932
generate_one_block  0.5670382976531982
generate_one_block  0.5684018135070801
generate_one_block  0.5503504276275635
generate_one_block  0.5723659992218018
generate_one_block  0.5616464614868164
generate_one_block  0.5500321388244629
generate_one_block  0.5587654113769531
generate_one_block  0.5627944469451904
generate_one_block  0.5546941757202148
generate_one_block  0.5642292499542236
generate_one_block  0.5578165054321289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12277412414550781  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

connection checking time:  27.524385452270508
block generation total time  24.63358974456787
average batch blocks generation time:  0.769799679517746
block dataloader generation time/epoch 54.59759875138601
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518980026245117  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.575117111206055  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10478878021240234  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.91832685470581  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530710220336914  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.12450647354126  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10457181930541992  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.784863471984863  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1053018569946289  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.147048473358154  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10478782653808594  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.785341262817383  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10517692565917969  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.616060733795166  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10434865951538086  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.37174892425537  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521793365478516  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.868098258972168  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10473966598510742  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.748544692993164  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052541732788086  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.021599292755127  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10438680648803711  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.66506004333496  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523128509521484  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.82582998275757  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10467004776000977  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.082786560058594  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529422760009766  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.080440521240234  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1049041748046875  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.071163654327393  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519838333129883  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.61772108078003  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10475301742553711  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.068321228027344  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10519886016845703  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.663768768310547  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046905517578125  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.645709991455078  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520696640014648  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.761008262634277  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10482263565063477  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.169135093688965  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1052713394165039  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.123231887817383  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10474777221679688  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.7571382522583  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529136657714844  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.152217864990234  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10492134094238281  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.158255577087402  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528278350830078  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.07225275039673  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10496234893798828  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.17969560623169  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10529756546020508  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.16300678253174  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1045999526977539  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.683048248291016  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1053457260131836  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.35424566268921  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10483884811401367  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.714949131011963  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03534329682588577 |0.016431093215942383 |0.4189745932817459 |9.578466415405273e-05 |0.7538371905684471 |0.008336067199707031 |
----------------------------------------------------------pseudo_mini_loss sum 1.2488600015640259
Total (block generation + training)time/epoch 93.74406961599986
Training time/epoch 39.24428629875183
Training time without block to device /epoch 38.718491315841675
Training time without total dataloading part /epoch 37.54137825965881
load block tensor time/epoch 1.1309854984283447
block to device time/epoch 0.5257949829101562
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  8797028
Number of first layer input nodes during this epoch:  4682388
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12304401397705078  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025364398956298828
range selection method range initialization spend 0.016704559326171875
time for parepare:  0.020641803741455078
local_output_nid generation:  0.0009887218475341797
local_in_edges_tensor generation:  0.004571199417114258
mini_batch_src_global generation:  0.0030350685119628906
r_  generation:  0.017770051956176758
local_output_nid generation:  0.001524209976196289
local_in_edges_tensor generation:  0.000789642333984375
mini_batch_src_global generation:  0.001589059829711914
r_  generation:  0.011283159255981445
local_output_nid generation:  0.001180410385131836
local_in_edges_tensor generation:  0.0006513595581054688
mini_batch_src_global generation:  0.0011930465698242188
r_  generation:  0.009952068328857422
local_output_nid generation:  0.001140594482421875
local_in_edges_tensor generation:  0.0006415843963623047
mini_batch_src_global generation:  0.00115966796875
r_  generation:  0.00961923599243164
local_output_nid generation:  0.0011339187622070312
local_in_edges_tensor generation:  0.0006432533264160156
mini_batch_src_global generation:  0.0011849403381347656
r_  generation:  0.010121583938598633
local_output_nid generation:  0.0011320114135742188
local_in_edges_tensor generation:  0.0006501674652099609
mini_batch_src_global generation:  0.0012307167053222656
r_  generation:  0.010334491729736328
local_output_nid generation:  0.0010895729064941406
local_in_edges_tensor generation:  0.0006396770477294922
mini_batch_src_global generation:  0.0012497901916503906
r_  generation:  0.010213613510131836
local_output_nid generation:  0.0011072158813476562
local_in_edges_tensor generation:  0.0006399154663085938
mini_batch_src_global generation:  0.0012025833129882812
r_  generation:  0.010032892227172852
local_output_nid generation:  0.0010614395141601562
local_in_edges_tensor generation:  0.0006439685821533203
mini_batch_src_global generation:  0.0012717247009277344
r_  generation:  0.010654926300048828
local_output_nid generation:  0.0010845661163330078
local_in_edges_tensor generation:  0.0006420612335205078
mini_batch_src_global generation:  0.0013785362243652344
r_  generation:  0.010773658752441406
local_output_nid generation:  0.0010957717895507812
local_in_edges_tensor generation:  0.0006353855133056641
mini_batch_src_global generation:  0.001378774642944336
r_  generation:  0.010636568069458008
local_output_nid generation:  0.0010657310485839844
local_in_edges_tensor generation:  0.0006346702575683594
mini_batch_src_global generation:  0.0012798309326171875
r_  generation:  0.010301589965820312
local_output_nid generation:  0.0010581016540527344
local_in_edges_tensor generation:  0.0006098747253417969
mini_batch_src_global generation:  0.0013027191162109375
r_  generation:  0.010692834854125977
local_output_nid generation:  0.0010771751403808594
local_in_edges_tensor generation:  0.000640869140625
mini_batch_src_global generation:  0.0013165473937988281
r_  generation:  0.01080632209777832
local_output_nid generation:  0.0010728836059570312
local_in_edges_tensor generation:  0.0006301403045654297
mini_batch_src_global generation:  0.0012619495391845703
r_  generation:  0.010612249374389648
local_output_nid generation:  0.0010559558868408203
local_in_edges_tensor generation:  0.0006413459777832031
mini_batch_src_global generation:  0.001298666000366211
r_  generation:  0.010471105575561523
local_output_nid generation:  0.0010437965393066406
local_in_edges_tensor generation:  0.0006382465362548828
mini_batch_src_global generation:  0.0012793540954589844
r_  generation:  0.010592222213745117
local_output_nid generation:  0.0010426044464111328
local_in_edges_tensor generation:  0.0006234645843505859
mini_batch_src_global generation:  0.0013141632080078125
r_  generation:  0.010531187057495117
local_output_nid generation:  0.0010509490966796875
local_in_edges_tensor generation:  0.0006422996520996094
mini_batch_src_global generation:  0.0013916492462158203
r_  generation:  0.016303300857543945
local_output_nid generation:  0.0023431777954101562
local_in_edges_tensor generation:  0.0010814666748046875
mini_batch_src_global generation:  0.002250194549560547
r_  generation:  0.013936281204223633
local_output_nid generation:  0.0010759830474853516
local_in_edges_tensor generation:  0.0005815029144287109
mini_batch_src_global generation:  0.0013000965118408203
r_  generation:  0.010304450988769531
local_output_nid generation:  0.0009565353393554688
local_in_edges_tensor generation:  0.0006108283996582031
mini_batch_src_global generation:  0.0012547969818115234
r_  generation:  0.010584831237792969
local_output_nid generation:  0.0009229183197021484
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0011892318725585938
r_  generation:  0.010749578475952148
local_output_nid generation:  0.000911712646484375
local_in_edges_tensor generation:  0.0005776882171630859
mini_batch_src_global generation:  0.0011703968048095703
r_  generation:  0.010752439498901367
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0005881786346435547
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.010408163070678711
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0005660057067871094
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.009995460510253906
local_output_nid generation:  0.0008544921875
local_in_edges_tensor generation:  0.0005857944488525391
mini_batch_src_global generation:  0.001148223876953125
r_  generation:  0.010309934616088867
local_output_nid generation:  0.0008478164672851562
local_in_edges_tensor generation:  0.0005593299865722656
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.010352373123168945
local_output_nid generation:  0.0008497238159179688
local_in_edges_tensor generation:  0.0005550384521484375
mini_batch_src_global generation:  0.0011930465698242188
r_  generation:  0.010634899139404297
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0005478858947753906
mini_batch_src_global generation:  0.0014181137084960938
r_  generation:  0.010338306427001953
local_output_nid generation:  0.0008461475372314453
local_in_edges_tensor generation:  0.0005481243133544922
mini_batch_src_global generation:  0.0011019706726074219
r_  generation:  0.01050567626953125
local_output_nid generation:  0.0008425712585449219
local_in_edges_tensor generation:  0.0005693435668945312
mini_batch_src_global generation:  0.0011286735534667969
r_  generation:  0.010112762451171875
----------------------check_connections_block total spend ----------------------------- 0.5578591823577881
generate_one_block  0.023764610290527344
generate_one_block  0.020000696182250977
generate_one_block  0.01729893684387207
generate_one_block  0.016849517822265625
generate_one_block  0.0173037052154541
generate_one_block  0.01761937141418457
generate_one_block  0.017145633697509766
generate_one_block  0.017243385314941406
generate_one_block  0.017750024795532227
generate_one_block  0.018018722534179688
generate_one_block  0.017354488372802734
generate_one_block  0.019687175750732422
generate_one_block  0.01814579963684082
generate_one_block  0.0180056095123291
generate_one_block  0.017511844635009766
generate_one_block  0.017382144927978516
generate_one_block  0.017525911331176758
generate_one_block  0.017414331436157227
generate_one_block  0.01842355728149414
generate_one_block  0.017169952392578125
generate_one_block  0.01698017120361328
generate_one_block  0.01770615577697754
generate_one_block  0.01808333396911621
generate_one_block  0.017995595932006836
generate_one_block  0.017485857009887695
generate_one_block  0.016732215881347656
generate_one_block  0.017127275466918945
generate_one_block  0.01739978790283203
generate_one_block  0.01750802993774414
generate_one_block  0.017083406448364258
generate_one_block  0.017606258392333984
generate_one_block  0.016973495483398438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035843849182128906
gen group dst list time:  0.025211811065673828
time for parepare:  0.022415637969970703
local_output_nid generation:  0.005331277847290039
local_in_edges_tensor generation:  0.015958786010742188
mini_batch_src_global generation:  0.016828060150146484
r_  generation:  0.13888096809387207
local_output_nid generation:  0.007485628128051758
local_in_edges_tensor generation:  0.009803295135498047
mini_batch_src_global generation:  0.01758575439453125
r_  generation:  0.14515995979309082
local_output_nid generation:  0.00753474235534668
local_in_edges_tensor generation:  0.03470110893249512
mini_batch_src_global generation:  0.016846895217895508
r_  generation:  0.14537525177001953
local_output_nid generation:  0.009971857070922852
local_in_edges_tensor generation:  0.009756803512573242
mini_batch_src_global generation:  0.01615118980407715
r_  generation:  0.1416323184967041
local_output_nid generation:  0.008278131484985352
local_in_edges_tensor generation:  0.009224414825439453
mini_batch_src_global generation:  0.029798269271850586
r_  generation:  0.1726090908050537
local_output_nid generation:  0.012926101684570312
local_in_edges_tensor generation:  0.011878252029418945
mini_batch_src_global generation:  0.021103858947753906
r_  generation:  0.168046236038208
local_output_nid generation:  0.013153553009033203
local_in_edges_tensor generation:  0.010727882385253906
mini_batch_src_global generation:  0.0230562686920166
r_  generation:  0.1840684413909912
local_output_nid generation:  0.011605978012084961
local_in_edges_tensor generation:  0.010616540908813477
mini_batch_src_global generation:  0.021595478057861328
r_  generation:  0.15154170989990234
local_output_nid generation:  0.009028196334838867
local_in_edges_tensor generation:  0.011137008666992188
mini_batch_src_global generation:  0.02013373374938965
r_  generation:  0.15807843208312988
local_output_nid generation:  0.008989095687866211
local_in_edges_tensor generation:  0.009394168853759766
mini_batch_src_global generation:  0.01965808868408203
r_  generation:  0.15626764297485352
local_output_nid generation:  0.008437395095825195
local_in_edges_tensor generation:  0.008020639419555664
mini_batch_src_global generation:  0.01865243911743164
r_  generation:  0.15377449989318848
local_output_nid generation:  0.008847951889038086
local_in_edges_tensor generation:  0.008159399032592773
mini_batch_src_global generation:  0.019250869750976562
r_  generation:  0.18634462356567383
local_output_nid generation:  0.012143850326538086
local_in_edges_tensor generation:  0.009678840637207031
mini_batch_src_global generation:  0.02262711524963379
r_  generation:  0.15731024742126465
local_output_nid generation:  0.008980751037597656
local_in_edges_tensor generation:  0.00887441635131836
mini_batch_src_global generation:  0.020534992218017578
r_  generation:  0.1570298671722412
local_output_nid generation:  0.008615493774414062
local_in_edges_tensor generation:  0.007918119430541992
mini_batch_src_global generation:  0.031074047088623047
r_  generation:  0.17694759368896484
local_output_nid generation:  0.013519525527954102
local_in_edges_tensor generation:  0.011480331420898438
mini_batch_src_global generation:  0.02228260040283203
r_  generation:  0.17767834663391113
local_output_nid generation:  0.019594192504882812
local_in_edges_tensor generation:  0.018073558807373047
mini_batch_src_global generation:  0.03641915321350098
r_  generation:  0.1610732078552246
local_output_nid generation:  0.009582757949829102
local_in_edges_tensor generation:  0.01061248779296875
mini_batch_src_global generation:  0.018954038619995117
r_  generation:  0.15855669975280762
local_output_nid generation:  0.00959920883178711
local_in_edges_tensor generation:  0.010027647018432617
mini_batch_src_global generation:  0.022806406021118164
r_  generation:  0.16879844665527344
local_output_nid generation:  0.008893251419067383
local_in_edges_tensor generation:  0.012674093246459961
mini_batch_src_global generation:  0.020940542221069336
r_  generation:  0.15420818328857422
local_output_nid generation:  0.00886988639831543
local_in_edges_tensor generation:  0.008154630661010742
mini_batch_src_global generation:  0.018265962600708008
r_  generation:  0.18362140655517578
local_output_nid generation:  0.008947372436523438
local_in_edges_tensor generation:  0.009596824645996094
mini_batch_src_global generation:  0.02214837074279785
r_  generation:  0.1642897129058838
local_output_nid generation:  0.01253652572631836
local_in_edges_tensor generation:  0.009555578231811523
mini_batch_src_global generation:  0.019723892211914062
r_  generation:  0.16101670265197754
local_output_nid generation:  0.00942230224609375
local_in_edges_tensor generation:  0.008936166763305664
mini_batch_src_global generation:  0.019954442977905273
r_  generation:  0.1960313320159912
local_output_nid generation:  0.009150266647338867
local_in_edges_tensor generation:  0.008800029754638672
mini_batch_src_global generation:  0.019182443618774414
r_  generation:  0.1556868553161621
local_output_nid generation:  0.008872747421264648
local_in_edges_tensor generation:  0.008552789688110352
mini_batch_src_global generation:  0.018683195114135742
r_  generation:  0.15077471733093262
local_output_nid generation:  0.009006977081298828
local_in_edges_tensor generation:  0.008232593536376953
mini_batch_src_global generation:  0.018590927124023438
r_  generation:  0.15602827072143555
local_output_nid generation:  0.009202718734741211
local_in_edges_tensor generation:  0.00827479362487793
mini_batch_src_global generation:  0.02021050453186035
r_  generation:  0.15668702125549316
local_output_nid generation:  0.009180545806884766
local_in_edges_tensor generation:  0.00890660285949707
mini_batch_src_global generation:  0.019510746002197266
r_  generation:  0.15981674194335938
local_output_nid generation:  0.008992910385131836
local_in_edges_tensor generation:  0.008867502212524414
mini_batch_src_global generation:  0.01950669288635254
r_  generation:  0.15642380714416504
local_output_nid generation:  0.009135246276855469
local_in_edges_tensor generation:  0.00886845588684082
mini_batch_src_global generation:  0.020856618881225586
r_  generation:  0.1829073429107666
local_output_nid generation:  0.009134769439697266
local_in_edges_tensor generation:  0.008052825927734375
mini_batch_src_global generation:  0.019036531448364258
r_  generation:  0.1578528881072998
----------------------check_connections_block total spend ----------------------------- 7.781724691390991
generate_one_block  0.2230844497680664
generate_one_block  0.2078549861907959
generate_one_block  0.19911575317382812
generate_one_block  0.19788575172424316
generate_one_block  0.22480392456054688
generate_one_block  0.20435333251953125
generate_one_block  0.19979476928710938
generate_one_block  0.21052289009094238
generate_one_block  0.21057677268981934
generate_one_block  0.207930326461792
generate_one_block  0.20389652252197266
generate_one_block  0.2054760456085205
generate_one_block  0.2066957950592041
generate_one_block  0.20907926559448242
generate_one_block  0.20386171340942383
generate_one_block  0.20334672927856445
generate_one_block  0.20152926445007324
generate_one_block  0.1992042064666748
generate_one_block  0.21887803077697754
generate_one_block  0.22671866416931152
generate_one_block  0.20186638832092285
generate_one_block  0.20496535301208496
generate_one_block  0.212327241897583
generate_one_block  0.21117162704467773
generate_one_block  0.20500850677490234
generate_one_block  0.19745898246765137
generate_one_block  0.2008047103881836
generate_one_block  0.2059338092803955
generate_one_block  0.2102973461151123
generate_one_block  0.20441532135009766
generate_one_block  0.20706558227539062
generate_one_block  0.20135998725891113
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0328516960144043
gen group dst list time:  0.12959980964660645
time for parepare:  0.020489215850830078
local_output_nid generation:  0.024021148681640625
local_in_edges_tensor generation:  0.05072665214538574
mini_batch_src_global generation:  0.04171919822692871
r_  generation:  0.41504907608032227
local_output_nid generation:  0.03175020217895508
local_in_edges_tensor generation:  0.03350424766540527
mini_batch_src_global generation:  0.0562894344329834
r_  generation:  0.40591883659362793
local_output_nid generation:  0.029056787490844727
local_in_edges_tensor generation:  0.0292513370513916
mini_batch_src_global generation:  0.04809141159057617
r_  generation:  0.4105839729309082
local_output_nid generation:  0.028984785079956055
local_in_edges_tensor generation:  0.026185274124145508
mini_batch_src_global generation:  0.050865888595581055
r_  generation:  0.402691125869751
local_output_nid generation:  0.02938365936279297
local_in_edges_tensor generation:  0.02538275718688965
mini_batch_src_global generation:  0.051209449768066406
r_  generation:  0.4207315444946289
local_output_nid generation:  0.029430150985717773
local_in_edges_tensor generation:  0.026997089385986328
mini_batch_src_global generation:  0.06514239311218262
r_  generation:  0.4147679805755615
local_output_nid generation:  0.02784276008605957
local_in_edges_tensor generation:  0.025632619857788086
mini_batch_src_global generation:  0.049646615982055664
r_  generation:  0.42809486389160156
local_output_nid generation:  0.028126239776611328
local_in_edges_tensor generation:  0.03076958656311035
mini_batch_src_global generation:  0.05142545700073242
r_  generation:  0.4075901508331299
local_output_nid generation:  0.02814316749572754
local_in_edges_tensor generation:  0.0261077880859375
mini_batch_src_global generation:  0.04943704605102539
r_  generation:  0.4212527275085449
local_output_nid generation:  0.02845144271850586
local_in_edges_tensor generation:  0.03258323669433594
mini_batch_src_global generation:  0.05026078224182129
r_  generation:  0.4187607765197754
local_output_nid generation:  0.027981281280517578
local_in_edges_tensor generation:  0.02896738052368164
mini_batch_src_global generation:  0.04772686958312988
r_  generation:  0.420581579208374
local_output_nid generation:  0.028148174285888672
local_in_edges_tensor generation:  0.029015302658081055
mini_batch_src_global generation:  0.051070451736450195
r_  generation:  0.4155082702636719
local_output_nid generation:  0.0283963680267334
local_in_edges_tensor generation:  0.027544736862182617
mini_batch_src_global generation:  0.04781961441040039
r_  generation:  0.42807650566101074
local_output_nid generation:  0.029088497161865234
local_in_edges_tensor generation:  0.029382705688476562
mini_batch_src_global generation:  0.05198240280151367
r_  generation:  0.4212770462036133
local_output_nid generation:  0.02836155891418457
local_in_edges_tensor generation:  0.03208494186401367
mini_batch_src_global generation:  0.05061769485473633
r_  generation:  0.4175868034362793
local_output_nid generation:  0.02935338020324707
local_in_edges_tensor generation:  0.029367446899414062
mini_batch_src_global generation:  0.04968690872192383
r_  generation:  0.40744805335998535
local_output_nid generation:  0.02812933921813965
local_in_edges_tensor generation:  0.028080224990844727
mini_batch_src_global generation:  0.0475621223449707
r_  generation:  0.4163494110107422
local_output_nid generation:  0.028067827224731445
local_in_edges_tensor generation:  0.026941537857055664
mini_batch_src_global generation:  0.04959917068481445
r_  generation:  0.4090414047241211
local_output_nid generation:  0.028561830520629883
local_in_edges_tensor generation:  0.030426979064941406
mini_batch_src_global generation:  0.04780268669128418
r_  generation:  0.43669819831848145
local_output_nid generation:  0.02826523780822754
local_in_edges_tensor generation:  0.02744746208190918
mini_batch_src_global generation:  0.04920625686645508
r_  generation:  0.40956568717956543
local_output_nid generation:  0.029941082000732422
local_in_edges_tensor generation:  0.027724504470825195
mini_batch_src_global generation:  0.0489039421081543
r_  generation:  0.4165482521057129
local_output_nid generation:  0.0282137393951416
local_in_edges_tensor generation:  0.031130075454711914
mini_batch_src_global generation:  0.05150556564331055
r_  generation:  0.41070008277893066
local_output_nid generation:  0.030744314193725586
local_in_edges_tensor generation:  0.030670642852783203
mini_batch_src_global generation:  0.0478518009185791
r_  generation:  0.42530035972595215
local_output_nid generation:  0.028827190399169922
local_in_edges_tensor generation:  0.03312540054321289
mini_batch_src_global generation:  0.05138826370239258
r_  generation:  0.4123079776763916
local_output_nid generation:  0.028786659240722656
local_in_edges_tensor generation:  0.02706003189086914
mini_batch_src_global generation:  0.04933929443359375
r_  generation:  0.4249382019042969
local_output_nid generation:  0.028324604034423828
local_in_edges_tensor generation:  0.025446414947509766
mini_batch_src_global generation:  0.04969000816345215
r_  generation:  0.4128098487854004
local_output_nid generation:  0.02894878387451172
local_in_edges_tensor generation:  0.02555084228515625
mini_batch_src_global generation:  0.04803061485290527
r_  generation:  0.42335939407348633
local_output_nid generation:  0.028344392776489258
local_in_edges_tensor generation:  0.02796006202697754
mini_batch_src_global generation:  0.04975104331970215
r_  generation:  0.41359663009643555
local_output_nid generation:  0.028583765029907227
local_in_edges_tensor generation:  0.02814030647277832
mini_batch_src_global generation:  0.04859495162963867
r_  generation:  0.42241811752319336
local_output_nid generation:  0.029061317443847656
local_in_edges_tensor generation:  0.027827024459838867
mini_batch_src_global generation:  0.04916715621948242
r_  generation:  0.4115731716156006
local_output_nid generation:  0.028552770614624023
local_in_edges_tensor generation:  0.02961564064025879
mini_batch_src_global generation:  0.047318458557128906
r_  generation:  0.4302959442138672
local_output_nid generation:  0.028302669525146484
local_in_edges_tensor generation:  0.028627634048461914
mini_batch_src_global generation:  0.05163002014160156
r_  generation:  0.41356945037841797
----------------------check_connections_block total spend ----------------------------- 19.81422710418701
generate_one_block  0.5665225982666016
generate_one_block  0.5433430671691895
generate_one_block  0.5461528301239014
generate_one_block  0.5453004837036133
generate_one_block  0.6673715114593506
generate_one_block  0.555452823638916
generate_one_block  0.5468606948852539
generate_one_block  0.5739543437957764
generate_one_block  0.5642209053039551
generate_one_block  0.5584163665771484
generate_one_block  0.5497493743896484
generate_one_block  0.551734447479248
generate_one_block  0.5569596290588379
generate_one_block  0.553410530090332
generate_one_block  0.5569624900817871
generate_one_block  0.5569496154785156
generate_one_block  0.5526690483093262
generate_one_block  0.5567655563354492
generate_one_block  0.5707049369812012
generate_one_block  0.5470037460327148
generate_one_block  0.54972243309021
generate_one_block  0.5603101253509521
generate_one_block  0.5683073997497559
generate_one_block  0.5602588653564453
generate_one_block  0.5791816711425781
generate_one_block  0.5497679710388184
generate_one_block  0.5604069232940674
generate_one_block  0.5601813793182373
generate_one_block  0.5622444152832031
generate_one_block  0.5514428615570068
generate_one_block  0.5539774894714355
generate_one_block  0.5650901794433594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12304401397705078  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

connection checking time:  27.595951795578003
block generation total time  24.56868076324463
average batch blocks generation time:  0.7677712738513947
block dataloader generation time/epoch 54.6300317864669
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523319244384766  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.82303810119629  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10454702377319336  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.791316032409668  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10517358779907227  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.49333095550537  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10425567626953125  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.33524990081787  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523509979248047  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.844752311706543  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10480260848999023  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.767677307128906  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10517644882202148  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.545998573303223  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10467910766601562  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.981593132019043  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528326034545898  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.170247554779053  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10487651824951172  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.219460487365723  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10524606704711914  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.926335334777832  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10453987121582031  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.959527492523193  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10528326034545898  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.167236804962158  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10433149337768555  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.14306354522705  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525083541870117  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.000633716583252  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10478687286376953  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.88535499572754  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10523080825805664  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.831153869628906  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10464143753051758  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.783589363098145  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10537385940551758  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.490661144256592  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10472631454467773  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.669923782348633  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10518503189086914  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.609636783599854  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10467720031738281  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.05595350265503  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10532093048095703  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.291670322418213  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10502862930297852  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.271507740020752  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10525083541870117  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.957639694213867  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10459518432617188  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.554893493652344  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10521793365478516  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.80861473083496  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10481739044189453  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.99742078781128  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10530233383178711  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.167309761047363  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.1046147346496582  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.95941925048828  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10526800155639648  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 17.04072141647339  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10470962524414062  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 16.76695203781128  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04009919613599777 |0.015819460153579712 |0.41771531105041504 |9.433180093765259e-05 |0.7548282146453857 |0.005510091781616211 |
----------------------------------------------------------pseudo_mini_loss sum 1.2423607110977173
Total (block generation + training)time/epoch 93.78858368020309
Training time/epoch 39.37575316429138
Training time without block to device /epoch 38.86953043937683
Training time without total dataloading part /epoch 37.529921531677246
load block tensor time/epoch 1.2831742763519287
block to device time/epoch 0.5062227249145508
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  8796961
Number of first layer input nodes during this epoch:  4682434
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12355899810791016  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024005651473999023
range selection method range initialization spend 0.017107248306274414
time for parepare:  0.019111156463623047
local_output_nid generation:  0.0009634494781494141
local_in_edges_tensor generation:  0.0040912628173828125
mini_batch_src_global generation:  0.0020623207092285156
r_  generation:  0.011831521987915039
local_output_nid generation:  0.0009996891021728516
local_in_edges_tensor generation:  0.0007698535919189453
mini_batch_src_global generation:  0.0014760494232177734
r_  generation:  0.010813713073730469
local_output_nid generation:  0.0009729862213134766
local_in_edges_tensor generation:  0.0006740093231201172
mini_batch_src_global generation:  0.0012118816375732422
r_  generation:  0.009839773178100586
local_output_nid generation:  0.001058816909790039
local_in_edges_tensor generation:  0.0006046295166015625
mini_batch_src_global generation:  0.001088857650756836
r_  generation:  0.009618997573852539
local_output_nid generation:  0.0009105205535888672
local_in_edges_tensor generation:  0.000545501708984375
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.00986790657043457
local_output_nid generation:  0.0008919239044189453
local_in_edges_tensor generation:  0.0007290840148925781
mini_batch_src_global generation:  0.0010619163513183594
r_  generation:  0.009975433349609375
local_output_nid generation:  0.0008966922760009766
local_in_edges_tensor generation:  0.0006453990936279297
mini_batch_src_global generation:  0.001062631607055664
r_  generation:  0.009942293167114258
local_output_nid generation:  0.0009295940399169922
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.0011525154113769531
r_  generation:  0.010422468185424805
local_output_nid generation:  0.0009098052978515625
local_in_edges_tensor generation:  0.0007162094116210938
mini_batch_src_global generation:  0.0010519027709960938
r_  generation:  0.009781122207641602
local_output_nid generation:  0.0008800029754638672
local_in_edges_tensor generation:  0.0005934238433837891
mini_batch_src_global generation:  0.0010890960693359375
r_  generation:  0.01217341423034668
local_output_nid generation:  0.0009043216705322266
local_in_edges_tensor generation:  0.0005562305450439453
mini_batch_src_global generation:  0.0012362003326416016
r_  generation:  0.01034998893737793
local_output_nid generation:  0.0008950233459472656
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0011706352233886719
r_  generation:  0.010433673858642578
local_output_nid generation:  0.0008897781372070312
local_in_edges_tensor generation:  0.0005900859832763672
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.0097503662109375
local_output_nid generation:  0.0008761882781982422
local_in_edges_tensor generation:  0.0006568431854248047
mini_batch_src_global generation:  0.0012285709381103516
r_  generation:  0.01057887077331543
local_output_nid generation:  0.0008807182312011719
local_in_edges_tensor generation:  0.0006258487701416016
mini_batch_src_global generation:  0.001087188720703125
r_  generation:  0.009975671768188477
local_output_nid generation:  0.0008962154388427734
local_in_edges_tensor generation:  0.0005559921264648438
mini_batch_src_global generation:  0.001134634017944336
r_  generation:  0.010079622268676758
local_output_nid generation:  0.0008900165557861328
local_in_edges_tensor generation:  0.0006165504455566406
mini_batch_src_global generation:  0.0011110305786132812
r_  generation:  0.012825727462768555
local_output_nid generation:  0.0009615421295166016
local_in_edges_tensor generation:  0.0007143020629882812
mini_batch_src_global generation:  0.001260519027709961
r_  generation:  0.010468244552612305
local_output_nid generation:  0.0009295940399169922
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.0011143684387207031
r_  generation:  0.010180234909057617
local_output_nid generation:  0.0009357929229736328
local_in_edges_tensor generation:  0.000553131103515625
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.010312080383300781
local_output_nid generation:  0.0009450912475585938
local_in_edges_tensor generation:  0.0005941390991210938
mini_batch_src_global generation:  0.0010831356048583984
r_  generation:  0.009996652603149414
local_output_nid generation:  0.0009293556213378906
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.0011277198791503906
r_  generation:  0.010563373565673828
local_output_nid generation:  0.0009362697601318359
local_in_edges_tensor generation:  0.0006682872772216797
mini_batch_src_global generation:  0.0010986328125
r_  generation:  0.009917497634887695
local_output_nid generation:  0.000926971435546875
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.010791778564453125
local_output_nid generation:  0.0009522438049316406
local_in_edges_tensor generation:  0.0007789134979248047
mini_batch_src_global generation:  0.0011239051818847656
r_  generation:  0.010308027267456055
local_output_nid generation:  0.0009222030639648438
local_in_edges_tensor generation:  0.0005497932434082031
mini_batch_src_global generation:  0.0011506080627441406
r_  generation:  0.010146856307983398
local_output_nid generation:  0.0009660720825195312
local_in_edges_tensor generation:  0.00058746337890625
mini_batch_src_global generation:  0.0011157989501953125
r_  generation:  0.010121822357177734
local_output_nid generation:  0.0009233951568603516
local_in_edges_tensor generation:  0.0005884170532226562
mini_batch_src_global generation:  0.0010898113250732422
r_  generation:  0.009721040725708008
local_output_nid generation:  0.0009365081787109375
local_in_edges_tensor generation:  0.0006151199340820312
mini_batch_src_global generation:  0.0011513233184814453
r_  generation:  0.0098419189453125
local_output_nid generation:  0.0009236335754394531
local_in_edges_tensor generation:  0.0005261898040771484
mini_batch_src_global generation:  0.0010869503021240234
r_  generation:  0.010219097137451172
local_output_nid generation:  0.0009162425994873047
local_in_edges_tensor generation:  0.0005967617034912109
mini_batch_src_global generation:  0.001154184341430664
r_  generation:  0.010060787200927734
local_output_nid generation:  0.0009176731109619141
local_in_edges_tensor generation:  0.0005371570587158203
mini_batch_src_global generation:  0.001088857650756836
r_  generation:  0.010214805603027344
----------------------check_connections_block total spend ----------------------------- 0.5259811878204346
generate_one_block  0.023752450942993164
generate_one_block  0.020051002502441406
generate_one_block  0.017683744430541992
generate_one_block  0.017271995544433594
generate_one_block  0.017458677291870117
generate_one_block  0.01725625991821289
generate_one_block  0.017158031463623047
generate_one_block  0.017830610275268555
generate_one_block  0.016795635223388672
generate_one_block  0.0173490047454834
generate_one_block  0.017541170120239258
generate_one_block  0.019910812377929688
generate_one_block  0.016953468322753906
generate_one_block  0.018273115158081055
generate_one_block  0.016960620880126953
generate_one_block  0.017107248306274414
generate_one_block  0.017263174057006836
generate_one_block  0.017820358276367188
generate_one_block  0.017363548278808594
generate_one_block  0.017523527145385742
generate_one_block  0.01687455177307129
generate_one_block  0.017751455307006836
generate_one_block  0.016706466674804688
generate_one_block  0.017994403839111328
generate_one_block  0.017279624938964844
generate_one_block  0.017101764678955078
generate_one_block  0.01732158660888672
generate_one_block  0.016358137130737305
generate_one_block  0.0166318416595459
generate_one_block  0.0172882080078125
generate_one_block  0.016957521438598633
generate_one_block  0.01720738410949707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05098152160644531
gen group dst list time:  0.02564859390258789
time for parepare:  0.022663354873657227
local_output_nid generation:  0.005446910858154297
local_in_edges_tensor generation:  0.01850128173828125
mini_batch_src_global generation:  0.014666318893432617
r_  generation:  0.1355135440826416
local_output_nid generation:  0.007481575012207031
local_in_edges_tensor generation:  0.009816169738769531
mini_batch_src_global generation:  0.031580209732055664
r_  generation:  0.1508159637451172
local_output_nid generation:  0.0077097415924072266
local_in_edges_tensor generation:  0.03408956527709961
mini_batch_src_global generation:  0.018970251083374023
r_  generation:  0.15182709693908691
local_output_nid generation:  0.007753610610961914
local_in_edges_tensor generation:  0.008950471878051758
mini_batch_src_global generation:  0.02008342742919922
r_  generation:  0.16132640838623047
local_output_nid generation:  0.013197898864746094
local_in_edges_tensor generation:  0.013494491577148438
mini_batch_src_global generation:  0.021289825439453125
r_  generation:  0.16764521598815918
local_output_nid generation:  0.013536214828491211
local_in_edges_tensor generation:  0.012886762619018555
mini_batch_src_global generation:  0.021070241928100586
r_  generation:  0.160813570022583
local_output_nid generation:  0.01355743408203125
local_in_edges_tensor generation:  0.011539697647094727
mini_batch_src_global generation:  0.02099776268005371
r_  generation:  0.16567492485046387
local_output_nid generation:  0.013742685317993164
local_in_edges_tensor generation:  0.013012886047363281
mini_batch_src_global generation:  0.029593944549560547
r_  generation:  0.1674818992614746
local_output_nid generation:  0.011245250701904297
local_in_edges_tensor generation:  0.009947776794433594
mini_batch_src_global generation:  0.01955103874206543
r_  generation:  0.15685343742370605
local_output_nid generation:  0.009664297103881836
local_in_edges_tensor generation:  0.008762359619140625
mini_batch_src_global generation:  0.02187037467956543
r_  generation:  0.1591787338256836
local_output_nid generation:  0.009171485900878906
local_in_edges_tensor generation:  0.009837150573730469
mini_batch_src_global generation:  0.020851850509643555
r_  generation:  0.163985013961792
local_output_nid generation:  0.009119033813476562
local_in_edges_tensor generation:  0.010819673538208008
mini_batch_src_global generation:  0.021477699279785156
r_  generation:  0.1650228500366211
local_output_nid generation:  0.008518457412719727
local_in_edges_tensor generation:  0.00914907455444336
mini_batch_src_global generation:  0.01950240135192871
r_  generation:  0.1551961898803711
local_output_nid generation:  0.008955240249633789
local_in_edges_tensor generation:  0.008938789367675781
mini_batch_src_global generation:  0.021745681762695312
r_  generation:  0.1704545021057129
local_output_nid generation:  0.008668184280395508
local_in_edges_tensor generation:  0.014168500900268555
mini_batch_src_global generation:  0.01985621452331543
r_  generation:  0.15899157524108887
local_output_nid generation:  0.00882411003112793
local_in_edges_tensor generation:  0.009598731994628906
mini_batch_src_global generation:  0.020943403244018555
r_  generation:  0.19566559791564941
local_output_nid generation:  0.008710622787475586
local_in_edges_tensor generation:  0.010056018829345703
mini_batch_src_global generation:  0.021056652069091797
r_  generation:  0.1968858242034912
local_output_nid generation:  0.009083747863769531
local_in_edges_tensor generation:  0.009735107421875
mini_batch_src_global generation:  0.020894527435302734
r_  generation:  0.18036890029907227
local_output_nid generation:  0.008860588073730469
local_in_edges_tensor generation:  0.011043548583984375
mini_batch_src_global generation:  0.034159183502197266
r_  generation:  0.16033315658569336
local_output_nid generation:  0.008898735046386719
local_in_edges_tensor generation:  0.008963823318481445
mini_batch_src_global generation:  0.02075052261352539
r_  generation:  0.16068744659423828
local_output_nid generation:  0.00861215591430664
local_in_edges_tensor generation:  0.0087890625
mini_batch_src_global generation:  0.019907712936401367
r_  generation:  0.1580522060394287
local_output_nid generation:  0.00903630256652832
local_in_edges_tensor generation:  0.008338689804077148
mini_batch_src_global generation:  0.021367549896240234
r_  generation:  0.16123247146606445
local_output_nid generation:  0.008597135543823242
local_in_edges_tensor generation:  0.008543729782104492
mini_batch_src_global generation:  0.019975900650024414
r_  generation:  0.15440821647644043
local_output_nid generation:  0.009175300598144531
local_in_edges_tensor generation:  0.00858759880065918
mini_batch_src_global generation:  0.021504640579223633
r_  generation:  0.16559505462646484
local_output_nid generation:  0.008818864822387695
local_in_edges_tensor generation:  0.010171890258789062
mini_batch_src_global generation:  0.020201683044433594
r_  generation:  0.1603562831878662
local_output_nid generation:  0.008739948272705078
local_in_edges_tensor generation:  0.008208990097045898
mini_batch_src_global generation:  0.020496368408203125
r_  generation:  0.1590278148651123
local_output_nid generation:  0.008913755416870117
local_in_edges_tensor generation:  0.00848698616027832
mini_batch_src_global generation:  0.020920276641845703
r_  generation:  0.16389775276184082
local_output_nid generation:  0.009325504302978516
local_in_edges_tensor generation:  0.010048389434814453
mini_batch_src_global generation:  0.02131175994873047
r_  generation:  0.16429781913757324
local_output_nid generation:  0.010784149169921875
local_in_edges_tensor generation:  0.009504318237304688
mini_batch_src_global generation:  0.0181429386138916
r_  generation:  0.15140700340270996
local_output_nid generation:  0.008986949920654297
local_in_edges_tensor generation:  0.008494377136230469
mini_batch_src_global generation:  0.01871657371520996
r_  generation:  0.15368103981018066
local_output_nid generation:  0.00894474983215332
local_in_edges_tensor generation:  0.008512258529663086
mini_batch_src_global generation:  0.018683195114135742
r_  generation:  0.15364670753479004
local_output_nid generation:  0.00906991958618164
local_in_edges_tensor generation:  0.008487224578857422
mini_batch_src_global generation:  0.019496440887451172
r_  generation:  0.15517354011535645
----------------------check_connections_block total spend ----------------------------- 7.773837566375732
generate_one_block  0.2112889289855957
generate_one_block  0.20062708854675293
generate_one_block  0.2033524513244629
generate_one_block  0.1994640827178955
generate_one_block  0.22287416458129883
generate_one_block  0.20093727111816406
generate_one_block  0.20692801475524902
generate_one_block  0.22440862655639648
generate_one_block  0.19910573959350586
generate_one_block  0.20345258712768555
generate_one_block  0.21046757698059082
generate_one_block  0.21101713180541992
generate_one_block  0.19563841819763184
generate_one_block  0.2132551670074463
generate_one_block  0.19234347343444824
generate_one_block  0.2063305377960205
generate_one_block  0.20593953132629395
generate_one_block  0.20810937881469727
generate_one_block  0.20504474639892578
generate_one_block  0.20891356468200684
generate_one_block  0.20059585571289062
generate_one_block  0.20716381072998047
generate_one_block  0.19312000274658203
generate_one_block  0.21021461486816406
generate_one_block  0.20608067512512207
generate_one_block  0.20634675025939941
generate_one_block  0.20911121368408203
generate_one_block  0.19485020637512207
generate_one_block  0.19582843780517578
generate_one_block  0.20450949668884277
generate_one_block  0.19879841804504395
generate_one_block  0.20607399940490723
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03377223014831543
gen group dst list time:  0.1073157787322998
time for parepare:  0.020140647888183594
local_output_nid generation:  0.02389979362487793
local_in_edges_tensor generation:  0.04392600059509277
mini_batch_src_global generation:  0.0377962589263916
r_  generation:  0.4047253131866455
local_output_nid generation:  0.027930259704589844
local_in_edges_tensor generation:  0.03114771842956543
mini_batch_src_global generation:  0.048244476318359375
r_  generation:  0.399627685546875
local_output_nid generation:  0.029245615005493164
local_in_edges_tensor generation:  0.02672886848449707
mini_batch_src_global generation:  0.04589200019836426
r_  generation:  0.4181668758392334
local_output_nid generation:  0.028078317642211914
local_in_edges_tensor generation:  0.0305936336517334
mini_batch_src_global generation:  0.05036807060241699
r_  generation:  0.4070751667022705
local_output_nid generation:  0.030768871307373047
local_in_edges_tensor generation:  0.02722311019897461
mini_batch_src_global generation:  0.04912614822387695
r_  generation:  0.4152061939239502
local_output_nid generation:  0.0294497013092041
local_in_edges_tensor generation:  0.02718067169189453
mini_batch_src_global generation:  0.04908275604248047
r_  generation:  0.40532588958740234
local_output_nid generation:  0.02741551399230957
local_in_edges_tensor generation:  0.025290727615356445
mini_batch_src_global generation:  0.04711627960205078
r_  generation:  0.4109525680541992
local_output_nid generation:  0.027865886688232422
local_in_edges_tensor generation:  0.026978731155395508
mini_batch_src_global generation:  0.05136847496032715
r_  generation:  0.41061854362487793
local_output_nid generation:  0.027507305145263672
local_in_edges_tensor generation:  0.026453256607055664
mini_batch_src_global generation:  0.047290802001953125
r_  generation:  0.4244050979614258
local_output_nid generation:  0.02749347686767578
local_in_edges_tensor generation:  0.02710556983947754
mini_batch_src_global generation:  0.048612356185913086
r_  generation:  0.405458927154541
local_output_nid generation:  0.028090715408325195
local_in_edges_tensor generation:  0.026880979537963867
mini_batch_src_global generation:  0.04761028289794922
r_  generation:  0.4179415702819824
local_output_nid generation:  0.027951955795288086
local_in_edges_tensor generation:  0.028613805770874023
mini_batch_src_global generation:  0.04999184608459473
r_  generation:  0.4133574962615967
local_output_nid generation:  0.027925729751586914
local_in_edges_tensor generation:  0.03182697296142578
mini_batch_src_global generation:  0.04742622375488281
r_  generation:  0.41144776344299316
local_output_nid generation:  0.02801346778869629
local_in_edges_tensor generation:  0.031039953231811523
mini_batch_src_global generation:  0.05174612998962402
r_  generation:  0.42346644401550293
local_output_nid generation:  0.028012514114379883
local_in_edges_tensor generation:  0.029546022415161133
mini_batch_src_global generation:  0.04745602607727051
r_  generation:  0.41286563873291016
local_output_nid generation:  0.028229475021362305
local_in_edges_tensor generation:  0.02510809898376465
mini_batch_src_global generation:  0.051396846771240234
r_  generation:  0.40868568420410156
local_output_nid generation:  0.028687000274658203
local_in_edges_tensor generation:  0.0274045467376709
mini_batch_src_global generation:  0.047530174255371094
r_  generation:  0.4127542972564697
local_output_nid generation:  0.0282289981842041
local_in_edges_tensor generation:  0.028023242950439453
mini_batch_src_global generation:  0.05166006088256836
r_  generation:  0.4073948860168457
local_output_nid generation:  0.029012680053710938
local_in_edges_tensor generation:  0.027414798736572266
mini_batch_src_global generation:  0.04735279083251953
r_  generation:  0.41622304916381836
local_output_nid generation:  0.027942895889282227
local_in_edges_tensor generation:  0.02546977996826172
mini_batch_src_global generation:  0.04953598976135254
r_  generation:  0.42716050148010254
local_output_nid generation:  0.027954816818237305
local_in_edges_tensor generation:  0.028795242309570312
mini_batch_src_global generation:  0.04953432083129883
r_  generation:  0.42404937744140625
local_output_nid generation:  0.027905702590942383
local_in_edges_tensor generation:  0.02911663055419922
mini_batch_src_global generation:  0.05162477493286133
r_  generation:  0.4166560173034668
local_output_nid generation:  0.02938055992126465
local_in_edges_tensor generation:  0.025625944137573242
mini_batch_src_global generation:  0.04753398895263672
r_  generation:  0.40941691398620605
local_output_nid generation:  0.02812814712524414
local_in_edges_tensor generation:  0.025864839553833008
mini_batch_src_global generation:  0.050037384033203125
r_  generation:  0.4158773422241211
local_output_nid generation:  0.028187036514282227
local_in_edges_tensor generation:  0.02819967269897461
mini_batch_src_global generation:  0.04795527458190918
r_  generation:  0.4191155433654785
local_output_nid generation:  0.02793121337890625
local_in_edges_tensor generation:  0.02667689323425293
mini_batch_src_global generation:  0.049550533294677734
r_  generation:  0.40782785415649414
local_output_nid generation:  0.02799510955810547
local_in_edges_tensor generation:  0.027422666549682617
mini_batch_src_global generation:  0.04760098457336426
r_  generation:  0.4189324378967285
local_output_nid generation:  0.028141260147094727
local_in_edges_tensor generation:  0.02700042724609375
mini_batch_src_global generation:  0.04911160469055176
r_  generation:  0.4274749755859375
local_output_nid generation:  0.028039932250976562
local_in_edges_tensor generation:  0.025316238403320312
mini_batch_src_global generation:  0.04757094383239746
r_  generation:  0.41338276863098145
local_output_nid generation:  0.027980327606201172
local_in_edges_tensor generation:  0.027162551879882812
mini_batch_src_global generation:  0.05530071258544922
r_  generation:  0.40686750411987305
local_output_nid generation:  0.0280301570892334
local_in_edges_tensor generation:  0.0269927978515625
mini_batch_src_global generation:  0.04756307601928711
r_  generation:  0.4199073314666748
local_output_nid generation:  0.02834033966064453
local_in_edges_tensor generation:  0.03133034706115723
mini_batch_src_global generation:  0.05044221878051758
r_  generation:  0.4190945625305176
----------------------check_connections_block total spend ----------------------------- 19.60859203338623
generate_one_block  0.5636541843414307
generate_one_block  0.5421276092529297
generate_one_block  0.5435116291046143
generate_one_block  0.5443148612976074
generate_one_block  0.6522698402404785
generate_one_block  0.5467002391815186
generate_one_block  0.5434889793395996
generate_one_block  0.5535764694213867
generate_one_block  0.5423471927642822
generate_one_block  0.5423109531402588
generate_one_block  0.5556745529174805
generate_one_block  0.5535414218902588
generate_one_block  0.5411474704742432
generate_one_block  0.5510721206665039
generate_one_block  0.544072151184082
generate_one_block  0.5584714412689209
generate_one_block  0.5559391975402832
generate_one_block  0.5494625568389893
generate_one_block  0.5533480644226074
generate_one_block  0.5522580146789551
generate_one_block  0.5472071170806885
generate_one_block  0.5521693229675293
generate_one_block  0.5464191436767578
generate_one_block  0.5502505302429199
generate_one_block  0.5699560642242432
generate_one_block  0.5443713665008545
generate_one_block  0.5465641021728516
generate_one_block  0.5439543724060059
generate_one_block  0.5398759841918945
generate_one_block  0.5505106449127197
generate_one_block  0.5524497032165527
generate_one_block  0.551170825958252
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.12355899810791016  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

connection checking time:  27.382429599761963
block generation total time  24.2463800907135
average batch blocks generation time:  0.7576993778347969
block dataloader generation time/epoch 54.63375920057297
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0018310546875 GB
    Memory Allocated: 0.10520267486572266  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0252685546875 GB
    Memory Allocated: 16.7258038520813  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.1044621467590332  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.810601711273193  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10523271560668945  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.788723468780518  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10455513000488281  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.74532127380371  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10528039932250977  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.09247398376465  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10462045669555664  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.771431922912598  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10523223876953125  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.871863842010498  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10497808456420898  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.16869878768921  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10519027709960938  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.64824342727661  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10456037521362305  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.805763244628906  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10528230667114258  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.085272312164307  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10494327545166016  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.211668014526367  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10515594482421875  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.459805011749268  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10504388809204102  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.345115661621094  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10515546798706055  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.461727619171143  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10493040084838867  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.902080535888672  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10525178909301758  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.90132427215576  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10467958450317383  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.13877010345459  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10527229309082031  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.04358720779419  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.1048135757446289  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.10197162628174  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10522937774658203  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.903794765472412  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10473775863647461  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.119028091430664  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10515546798706055  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.42129421234131  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10489463806152344  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.30056619644165  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.1052708625793457  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.099453926086426  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10458898544311523  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.900904178619385  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10528278350830078  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.095725536346436  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10458087921142578  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.54025173187256  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10518550872802734  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.634058952331543  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10439634323120117  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.905123710632324  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10521554946899414  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 16.789886951446533  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 0.10504627227783203  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0272216796875 GB
    Memory Allocated: 17.02975034713745  GigaBytes
Max Memory Allocated: 17.621997833251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03608688712120056 |0.01448734849691391 |0.4198302924633026 |9.297579526901245e-05 |0.7593874037265778 |0.0058536529541015625 |
----------------------------------------------------------pseudo_mini_loss sum 1.2309995889663696
Total (block generation + training)time/epoch 93.80526075363159
Training time/epoch 39.417290925979614
Training time without block to device /epoch 38.95369577407837
Training time without total dataloading part /epoch 37.74379515647888
load block tensor time/epoch 1.154780387878418
block to device time/epoch 0.4635951519012451
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  8794071
Number of first layer input nodes during this epoch:  4681372
