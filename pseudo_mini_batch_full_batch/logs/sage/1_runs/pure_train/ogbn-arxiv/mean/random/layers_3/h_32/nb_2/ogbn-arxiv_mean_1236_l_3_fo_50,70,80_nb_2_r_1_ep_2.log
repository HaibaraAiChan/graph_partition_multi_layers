Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648354561.5383563
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02696847915649414
random selection method range initialization spend 0.006098508834838867
time for parepare:  0.018520116806030273
local_output_nid generation:  0.016537904739379883
local_in_edges_tensor generation:  0.014780759811401367
mini_batch_src_global generation:  0.014965057373046875
r_  generation:  0.18593406677246094
local_output_nid generation:  0.02147650718688965
local_in_edges_tensor generation:  0.016015291213989258
mini_batch_src_global generation:  0.019188880920410156
r_  generation:  0.1971416473388672
----------------------check_connections_block total spend ----------------------------- 0.5904841423034668
generate_one_block  0.22697734832763672
generate_one_block  0.2226266860961914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044107913970947266
gen group dst list time:  0.007723569869995117
time for parepare:  0.01926255226135254
local_output_nid generation:  0.025016069412231445
local_in_edges_tensor generation:  0.05397915840148926
mini_batch_src_global generation:  0.056375741958618164
r_  generation:  0.5498263835906982
local_output_nid generation:  0.03254508972167969
local_in_edges_tensor generation:  0.05686616897583008
mini_batch_src_global generation:  0.06428933143615723
r_  generation:  0.5584096908569336
----------------------check_connections_block total spend ----------------------------- 1.6716279983520508
generate_one_block  0.7151403427124023
generate_one_block  0.7635304927825928
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036957502365112305
gen group dst list time:  0.011950016021728516
time for parepare:  0.01879143714904785
local_output_nid generation:  0.030491352081298828
local_in_edges_tensor generation:  0.050362586975097656
mini_batch_src_global generation:  0.05362558364868164
r_  generation:  0.5789601802825928
local_output_nid generation:  0.03806447982788086
local_in_edges_tensor generation:  0.05819272994995117
mini_batch_src_global generation:  0.06604743003845215
r_  generation:  0.585416316986084
----------------------check_connections_block total spend ----------------------------- 1.7581164836883545
generate_one_block  0.7720067501068115
generate_one_block  0.752586841583252
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  3.4297444820404053
block generation total time  3.0032644271850586
average batch blocks generation time:  1.5016322135925293
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11104345321655273  GigaBytes
Max Memory Allocated: 0.11104345321655273  GigaBytes

torch.Size([167418, 128])
torch.Size([164274, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.30154991149902344  GigaBytes
Max Memory Allocated: 0.30832576751708984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.1180109977722168  GigaBytes
Max Memory Allocated: 0.328094482421875  GigaBytes

torch.Size([167452, 128])
torch.Size([164316, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.3000192642211914  GigaBytes
Max Memory Allocated: 0.328094482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03719067573547363 |0.16292846202850342 |0.35547900199890137 |0.00013744831085205078 |0.01898205280303955 |0.004004001617431641 |
----------------------------------------------------------pseudo_mini_loss sum 4.963210105895996
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  942117
Number of first layer input nodes during this epoch:  334870
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.1834850311279297  GigaBytes
Max Memory Allocated: 0.328094482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024040937423706055
random selection method range initialization spend 0.00619816780090332
time for parepare:  0.019732952117919922
local_output_nid generation:  0.01624774932861328
local_in_edges_tensor generation:  0.014624834060668945
mini_batch_src_global generation:  0.01521611213684082
r_  generation:  0.18868684768676758
local_output_nid generation:  0.02451491355895996
local_in_edges_tensor generation:  0.020730018615722656
mini_batch_src_global generation:  0.018603801727294922
r_  generation:  0.21096563339233398
----------------------check_connections_block total spend ----------------------------- 0.6162910461425781
generate_one_block  0.23112916946411133
generate_one_block  0.23572087287902832
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.051465749740600586
gen group dst list time:  0.009760379791259766
time for parepare:  0.02037978172302246
local_output_nid generation:  0.030255556106567383
local_in_edges_tensor generation:  0.05660700798034668
mini_batch_src_global generation:  0.05914187431335449
r_  generation:  0.5897164344787598
local_output_nid generation:  0.04382205009460449
local_in_edges_tensor generation:  0.05879378318786621
mini_batch_src_global generation:  0.07620525360107422
r_  generation:  0.5749530792236328
----------------------check_connections_block total spend ----------------------------- 1.79439115524292
generate_one_block  0.7656502723693848
generate_one_block  0.7844302654266357
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0416562557220459
gen group dst list time:  0.014805793762207031
time for parepare:  0.020063400268554688
local_output_nid generation:  0.032178640365600586
local_in_edges_tensor generation:  0.09820008277893066
mini_batch_src_global generation:  0.055399179458618164
r_  generation:  0.579035758972168
local_output_nid generation:  0.03816938400268555
local_in_edges_tensor generation:  0.05850505828857422
mini_batch_src_global generation:  0.06843066215515137
r_  generation:  0.5970313549041748
----------------------check_connections_block total spend ----------------------------- 1.824906349182129
generate_one_block  0.7454938888549805
generate_one_block  0.76007080078125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.1834850311279297  GigaBytes
Max Memory Allocated: 0.328094482421875  GigaBytes

connection checking time:  3.619297504425049
block generation total time  3.055645227432251
average batch blocks generation time:  1.5278226137161255
block dataloader generation time/epoch 8.625268459320068
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.11811161041259766  GigaBytes
Max Memory Allocated: 0.328094482421875  GigaBytes

torch.Size([167426, 128])
torch.Size([164207, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.29797935485839844  GigaBytes
Max Memory Allocated: 0.328094482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.11814403533935547  GigaBytes
Max Memory Allocated: 0.328094482421875  GigaBytes

torch.Size([167481, 128])
torch.Size([164391, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.30022287368774414  GigaBytes
Max Memory Allocated: 0.328094482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.045082807540893555 |0.02370893955230713 |0.0044956207275390625 |0.00011277198791503906 |0.019832968711853027 |0.0021386146545410156 |
----------------------------------------------------------pseudo_mini_loss sum 4.269583702087402
Total (block generation + training)time/epoch 8.816803216934204
Training time/epoch 0.1912374496459961
Training time without block to device /epoch 0.14381957054138184
Training time without total dataloading part /epoch 0.05102133750915527
load block tensor time/epoch 0.09016561508178711
block to device time/epoch 0.04741787910461426
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  941971
Number of first layer input nodes during this epoch:  334907
