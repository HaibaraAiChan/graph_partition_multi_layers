Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648356600.1980329
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02929973602294922
random selection method range initialization spend 0.0061473846435546875
time for parepare:  0.019353151321411133
local_output_nid generation:  0.009539604187011719
local_in_edges_tensor generation:  0.009465456008911133
mini_batch_src_global generation:  0.008407354354858398
r_  generation:  0.09131288528442383
local_output_nid generation:  0.011556863784790039
local_in_edges_tensor generation:  0.0062177181243896484
mini_batch_src_global generation:  0.009920120239257812
r_  generation:  0.09617805480957031
local_output_nid generation:  0.01179051399230957
local_in_edges_tensor generation:  0.006489753723144531
mini_batch_src_global generation:  0.0076999664306640625
r_  generation:  0.10144662857055664
local_output_nid generation:  0.011821985244750977
local_in_edges_tensor generation:  0.006257772445678711
mini_batch_src_global generation:  0.00841665267944336
r_  generation:  0.10299134254455566
----------------------check_connections_block total spend ----------------------------- 0.6086206436157227
generate_one_block  0.11544036865234375
generate_one_block  0.11403059959411621
generate_one_block  0.11625862121582031
generate_one_block  0.11513519287109375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04411053657531738
gen group dst list time:  0.011857986450195312
time for parepare:  0.01960158348083496
local_output_nid generation:  0.02087259292602539
local_in_edges_tensor generation:  0.046495676040649414
mini_batch_src_global generation:  0.0502934455871582
r_  generation:  0.47819995880126953
local_output_nid generation:  0.030679941177368164
local_in_edges_tensor generation:  0.04426980018615723
mini_batch_src_global generation:  0.05600380897521973
r_  generation:  0.4745371341705322
local_output_nid generation:  0.0314793586730957
local_in_edges_tensor generation:  0.040282249450683594
mini_batch_src_global generation:  0.05539274215698242
r_  generation:  0.48668408393859863
local_output_nid generation:  0.030993938446044922
local_in_edges_tensor generation:  0.031908273696899414
mini_batch_src_global generation:  0.05651092529296875
r_  generation:  0.48761582374572754
----------------------check_connections_block total spend ----------------------------- 2.8625948429107666
generate_one_block  0.6769204139709473
generate_one_block  0.641258716583252
generate_one_block  0.6376080513000488
generate_one_block  0.6341373920440674
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036768198013305664
gen group dst list time:  0.021245479583740234
time for parepare:  0.018692970275878906
local_output_nid generation:  0.03000187873840332
local_in_edges_tensor generation:  0.04857897758483887
mini_batch_src_global generation:  0.05772089958190918
r_  generation:  0.5611836910247803
local_output_nid generation:  0.036875009536743164
local_in_edges_tensor generation:  0.058707237243652344
mini_batch_src_global generation:  0.06510472297668457
r_  generation:  0.5659856796264648
local_output_nid generation:  0.03689265251159668
local_in_edges_tensor generation:  0.04323172569274902
mini_batch_src_global generation:  0.06935667991638184
r_  generation:  0.5696423053741455
local_output_nid generation:  0.03681182861328125
local_in_edges_tensor generation:  0.038666725158691406
mini_batch_src_global generation:  0.06420683860778809
r_  generation:  0.577326774597168
----------------------check_connections_block total spend ----------------------------- 3.3873982429504395
generate_one_block  0.7288773059844971
generate_one_block  0.7346010208129883
generate_one_block  0.7527525424957275
generate_one_block  0.720189094543457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  6.249993085861206
block generation total time  5.526344537734985
average batch blocks generation time:  1.3815861344337463
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10654115676879883  GigaBytes
Max Memory Allocated: 0.10654115676879883  GigaBytes

torch.Size([165758, 128])
torch.Size([157455, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7420654296875 GB
    Memory Allocated: 0.3750481605529785  GigaBytes
Max Memory Allocated: 0.3945794105529785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.10999441146850586  GigaBytes
Max Memory Allocated: 0.42439794540405273  GigaBytes

torch.Size([165799, 128])
torch.Size([157327, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.3739748001098633  GigaBytes
Max Memory Allocated: 0.42439794540405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.1109623908996582  GigaBytes
Max Memory Allocated: 0.42439794540405273  GigaBytes

torch.Size([165782, 128])
torch.Size([157493, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.37395668029785156  GigaBytes
Max Memory Allocated: 0.42439794540405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.1099705696105957  GigaBytes
Max Memory Allocated: 0.42439794540405273  GigaBytes

torch.Size([165654, 128])
torch.Size([157338, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.37363100051879883  GigaBytes
Max Memory Allocated: 0.42439794540405273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04035353660583496 |0.08486247062683105 |0.18287301063537598 |0.00010967254638671875 |0.019991755485534668 |0.0034685134887695312 |
----------------------------------------------------------pseudo_mini_loss sum 5.279738426208496
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1722320
Number of first layer input nodes during this epoch:  662993
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.16804742813110352  GigaBytes
Max Memory Allocated: 0.42439794540405273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02103900909423828
random selection method range initialization spend 0.005600929260253906
time for parepare:  0.01871323585510254
local_output_nid generation:  0.008505582809448242
local_in_edges_tensor generation:  0.009147882461547852
mini_batch_src_global generation:  0.007225751876831055
r_  generation:  0.0879971981048584
local_output_nid generation:  0.011763811111450195
local_in_edges_tensor generation:  0.008490324020385742
mini_batch_src_global generation:  0.009881258010864258
r_  generation:  0.09834957122802734
local_output_nid generation:  0.01186513900756836
local_in_edges_tensor generation:  0.006359577178955078
mini_batch_src_global generation:  0.007848501205444336
r_  generation:  0.10138416290283203
local_output_nid generation:  0.011819601058959961
local_in_edges_tensor generation:  0.006590127944946289
mini_batch_src_global generation:  0.008693695068359375
r_  generation:  0.10336565971374512
----------------------check_connections_block total spend ----------------------------- 0.6080582141876221
generate_one_block  0.1132962703704834
generate_one_block  0.11587858200073242
generate_one_block  0.11848926544189453
generate_one_block  0.11684727668762207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04483175277709961
gen group dst list time:  0.011732339859008789
time for parepare:  0.019106149673461914
local_output_nid generation:  0.020059585571289062
local_in_edges_tensor generation:  0.04720282554626465
mini_batch_src_global generation:  0.049249887466430664
r_  generation:  0.47000598907470703
local_output_nid generation:  0.026726722717285156
local_in_edges_tensor generation:  0.04504227638244629
mini_batch_src_global generation:  0.05608105659484863
r_  generation:  0.48532652854919434
local_output_nid generation:  0.02710890769958496
local_in_edges_tensor generation:  0.038196563720703125
mini_batch_src_global generation:  0.05576682090759277
r_  generation:  0.49051332473754883
local_output_nid generation:  0.027295827865600586
local_in_edges_tensor generation:  0.03214550018310547
mini_batch_src_global generation:  0.05806374549865723
r_  generation:  0.4931142330169678
----------------------check_connections_block total spend ----------------------------- 2.8594539165496826
generate_one_block  0.626629114151001
generate_one_block  0.6291203498840332
generate_one_block  0.6651897430419922
generate_one_block  0.6346156597137451
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03153371810913086
gen group dst list time:  0.021377086639404297
time for parepare:  0.0195465087890625
local_output_nid generation:  0.03041386604309082
local_in_edges_tensor generation:  0.049668312072753906
mini_batch_src_global generation:  0.05382657051086426
r_  generation:  0.5735092163085938
local_output_nid generation:  0.038186073303222656
local_in_edges_tensor generation:  0.056329965591430664
mini_batch_src_global generation:  0.069671630859375
r_  generation:  0.5864269733428955
local_output_nid generation:  0.03817391395568848
local_in_edges_tensor generation:  0.0518498420715332
mini_batch_src_global generation:  0.06504201889038086
r_  generation:  0.5857064723968506
local_output_nid generation:  0.03814125061035156
local_in_edges_tensor generation:  0.04182028770446777
mini_batch_src_global generation:  0.06504631042480469
r_  generation:  0.5997860431671143
----------------------check_connections_block total spend ----------------------------- 3.473551034927368
generate_one_block  0.7268722057342529
generate_one_block  0.728510856628418
generate_one_block  0.7274963855743408
generate_one_block  0.7246789932250977
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.16804742813110352  GigaBytes
Max Memory Allocated: 0.42439794540405273  GigaBytes

connection checking time:  6.333004951477051
block generation total time  5.463113307952881
average batch blocks generation time:  1.3657783269882202
block dataloader generation time/epoch 13.754078388214111
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.11104249954223633  GigaBytes
Max Memory Allocated: 0.42439794540405273  GigaBytes

torch.Size([165767, 128])
torch.Size([157369, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.3731107711791992  GigaBytes
Max Memory Allocated: 0.42439794540405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.11065053939819336  GigaBytes
Max Memory Allocated: 0.42439794540405273  GigaBytes

torch.Size([165846, 128])
torch.Size([157611, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.3749823570251465  GigaBytes
Max Memory Allocated: 0.42439794540405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.11116504669189453  GigaBytes
Max Memory Allocated: 0.4250211715698242  GigaBytes

torch.Size([165685, 128])
torch.Size([157270, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.37401342391967773  GigaBytes
Max Memory Allocated: 0.4250211715698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.11039924621582031  GigaBytes
Max Memory Allocated: 0.4250211715698242  GigaBytes

torch.Size([165781, 128])
torch.Size([157484, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.37494468688964844  GigaBytes
Max Memory Allocated: 0.4250211715698242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03979307413101196 |0.016198337078094482 |0.003964424133300781 |8.571147918701172e-05 |0.011873364448547363 |0.0013968944549560547 |
----------------------------------------------------------pseudo_mini_loss sum 4.065000534057617
Total (block generation + training)time/epoch 14.071491003036499
Training time/epoch 0.31719088554382324
Training time without block to device /epoch 0.2523975372314453
Training time without total dataloading part /epoch 0.06509089469909668
load block tensor time/epoch 0.15917229652404785
block to device time/epoch 0.06479334831237793
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1722650
Number of first layer input nodes during this epoch:  663079
