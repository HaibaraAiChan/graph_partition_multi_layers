Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648357190.92533
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0238645076751709
random selection method range initialization spend 0.006421566009521484
time for parepare:  0.018377065658569336
local_output_nid generation:  0.004250764846801758
local_in_edges_tensor generation:  0.0070307254791259766
mini_batch_src_global generation:  0.0031936168670654297
r_  generation:  0.03652691841125488
local_output_nid generation:  0.005485057830810547
local_in_edges_tensor generation:  0.003566741943359375
mini_batch_src_global generation:  0.003923177719116211
r_  generation:  0.03672194480895996
local_output_nid generation:  0.005892276763916016
local_in_edges_tensor generation:  0.003482818603515625
mini_batch_src_global generation:  0.002724885940551758
r_  generation:  0.03939652442932129
local_output_nid generation:  0.005959987640380859
local_in_edges_tensor generation:  0.003603696823120117
mini_batch_src_global generation:  0.0029256343841552734
r_  generation:  0.0406641960144043
local_output_nid generation:  0.006051540374755859
local_in_edges_tensor generation:  0.0036911964416503906
mini_batch_src_global generation:  0.0031096935272216797
r_  generation:  0.040313720703125
local_output_nid generation:  0.005990505218505859
local_in_edges_tensor generation:  0.0036246776580810547
mini_batch_src_global generation:  0.003187894821166992
r_  generation:  0.040498971939086914
local_output_nid generation:  0.0059661865234375
local_in_edges_tensor generation:  0.0036041736602783203
mini_batch_src_global generation:  0.0033524036407470703
r_  generation:  0.04114031791687012
local_output_nid generation:  0.006005525588989258
local_in_edges_tensor generation:  0.0036003589630126953
mini_batch_src_global generation:  0.003388643264770508
r_  generation:  0.04136013984680176
----------------------check_connections_block total spend ----------------------------- 0.5140049457550049
generate_one_block  0.05398416519165039
generate_one_block  0.05387282371520996
generate_one_block  0.054938554763793945
generate_one_block  0.05603432655334473
generate_one_block  0.05768227577209473
generate_one_block  0.05439567565917969
generate_one_block  0.05426478385925293
generate_one_block  0.05471682548522949
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04079270362854004
gen group dst list time:  0.015674829483032227
time for parepare:  0.018856048583984375
local_output_nid generation:  0.013005495071411133
local_in_edges_tensor generation:  0.033273935317993164
mini_batch_src_global generation:  0.027429819107055664
r_  generation:  0.2811143398284912
local_output_nid generation:  0.018379688262939453
local_in_edges_tensor generation:  0.02863454818725586
mini_batch_src_global generation:  0.03465008735656738
r_  generation:  0.28900814056396484
local_output_nid generation:  0.018040180206298828
local_in_edges_tensor generation:  0.026864051818847656
mini_batch_src_global generation:  0.0341339111328125
r_  generation:  0.30299878120422363
local_output_nid generation:  0.01810741424560547
local_in_edges_tensor generation:  0.024684906005859375
mini_batch_src_global generation:  0.035883188247680664
r_  generation:  0.30805230140686035
local_output_nid generation:  0.017908096313476562
local_in_edges_tensor generation:  0.01903080940246582
mini_batch_src_global generation:  0.03665661811828613
r_  generation:  0.30640506744384766
local_output_nid generation:  0.018090248107910156
local_in_edges_tensor generation:  0.022167444229125977
mini_batch_src_global generation:  0.03953695297241211
r_  generation:  0.3140370845794678
local_output_nid generation:  0.01796245574951172
local_in_edges_tensor generation:  0.02241802215576172
mini_batch_src_global generation:  0.036827802658081055
r_  generation:  0.3082308769226074
local_output_nid generation:  0.01801586151123047
local_in_edges_tensor generation:  0.021237850189208984
mini_batch_src_global generation:  0.03983330726623535
r_  generation:  0.30931854248046875
----------------------check_connections_block total spend ----------------------------- 3.5802597999572754
generate_one_block  0.3934309482574463
generate_one_block  0.38265061378479004
generate_one_block  0.3962998390197754
generate_one_block  0.40331220626831055
generate_one_block  0.38907289505004883
generate_one_block  0.4108397960662842
generate_one_block  0.38716864585876465
generate_one_block  0.40177154541015625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032367706298828125
gen group dst list time:  0.037038326263427734
time for parepare:  0.01919078826904297
local_output_nid generation:  0.02902078628540039
local_in_edges_tensor generation:  0.043474674224853516
mini_batch_src_global generation:  0.0464482307434082
r_  generation:  0.47699928283691406
local_output_nid generation:  0.034451961517333984
local_in_edges_tensor generation:  0.04956173896789551
mini_batch_src_global generation:  0.053102970123291016
r_  generation:  0.47566986083984375
local_output_nid generation:  0.03443717956542969
local_in_edges_tensor generation:  0.041665077209472656
mini_batch_src_global generation:  0.05263066291809082
r_  generation:  0.5001444816589355
local_output_nid generation:  0.034676313400268555
local_in_edges_tensor generation:  0.03837466239929199
mini_batch_src_global generation:  0.05356025695800781
r_  generation:  0.4896421432495117
local_output_nid generation:  0.03432416915893555
local_in_edges_tensor generation:  0.03737020492553711
mini_batch_src_global generation:  0.052672624588012695
r_  generation:  0.4969034194946289
local_output_nid generation:  0.035004615783691406
local_in_edges_tensor generation:  0.04333019256591797
mini_batch_src_global generation:  0.055403709411621094
r_  generation:  0.4885518550872803
local_output_nid generation:  0.03608846664428711
local_in_edges_tensor generation:  0.044622182846069336
mini_batch_src_global generation:  0.05391836166381836
r_  generation:  0.49843478202819824
local_output_nid generation:  0.0348200798034668
local_in_edges_tensor generation:  0.034806013107299805
mini_batch_src_global generation:  0.06017947196960449
r_  generation:  0.4886174201965332
----------------------check_connections_block total spend ----------------------------- 5.820706367492676
generate_one_block  0.624687671661377
generate_one_block  0.6185414791107178
generate_one_block  0.6214275360107422
generate_one_block  0.6207151412963867
generate_one_block  0.6149964332580566
generate_one_block  0.6289055347442627
generate_one_block  0.6542923450469971
generate_one_block  0.632131814956665
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  9.400966167449951
block generation total time  8.180244445800781
average batch blocks generation time:  1.0225305557250977
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09587526321411133  GigaBytes
Max Memory Allocated: 0.09587526321411133  GigaBytes

torch.Size([160707, 128])
torch.Size([141398, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.5494379997253418  GigaBytes
Max Memory Allocated: 0.5783867835998535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2596435546875 GB
    Memory Allocated: 0.09818363189697266  GigaBytes
Max Memory Allocated: 0.6151800155639648  GigaBytes

torch.Size([160305, 128])
torch.Size([140527, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5402469635009766  GigaBytes
Max Memory Allocated: 0.6151800155639648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09895753860473633  GigaBytes
Max Memory Allocated: 0.6151800155639648  GigaBytes

torch.Size([160610, 128])
torch.Size([141307, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5470037460327148  GigaBytes
Max Memory Allocated: 0.6151800155639648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09854364395141602  GigaBytes
Max Memory Allocated: 0.6151800155639648  GigaBytes

torch.Size([160404, 128])
torch.Size([141443, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5529918670654297  GigaBytes
Max Memory Allocated: 0.6151800155639648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09830236434936523  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

torch.Size([160316, 128])
torch.Size([140759, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5425300598144531  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09924173355102539  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

torch.Size([160482, 128])
torch.Size([141447, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5519042015075684  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09946632385253906  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

torch.Size([160694, 128])
torch.Size([141552, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5513291358947754  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0986318588256836  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

torch.Size([160735, 128])
torch.Size([141708, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.551607608795166  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04647603631019592 |0.052376747131347656 |0.09825935959815979 |0.00010114908218383789 |0.012612849473953247 |0.003996610641479492 |
----------------------------------------------------------pseudo_mini_loss sum 5.551002025604248
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2957461
Number of first layer input nodes during this epoch:  1284253
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1287527084350586  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024222612380981445
random selection method range initialization spend 0.005345821380615234
time for parepare:  0.017529010772705078
local_output_nid generation:  0.00446772575378418
local_in_edges_tensor generation:  0.010110139846801758
mini_batch_src_global generation:  0.0033369064331054688
r_  generation:  0.03956460952758789
local_output_nid generation:  0.006085395812988281
local_in_edges_tensor generation:  0.0032444000244140625
mini_batch_src_global generation:  0.004359722137451172
r_  generation:  0.03969717025756836
local_output_nid generation:  0.006052255630493164
local_in_edges_tensor generation:  0.0033147335052490234
mini_batch_src_global generation:  0.002863645553588867
r_  generation:  0.03863787651062012
local_output_nid generation:  0.006189823150634766
local_in_edges_tensor generation:  0.0033445358276367188
mini_batch_src_global generation:  0.003135204315185547
r_  generation:  0.041730642318725586
local_output_nid generation:  0.006190061569213867
local_in_edges_tensor generation:  0.0047512054443359375
mini_batch_src_global generation:  0.0030794143676757812
r_  generation:  0.042119503021240234
local_output_nid generation:  0.006243705749511719
local_in_edges_tensor generation:  0.0034761428833007812
mini_batch_src_global generation:  0.0033788681030273438
r_  generation:  0.04349827766418457
local_output_nid generation:  0.006252288818359375
local_in_edges_tensor generation:  0.0033965110778808594
mini_batch_src_global generation:  0.003387451171875
r_  generation:  0.04274559020996094
local_output_nid generation:  0.0061185359954833984
local_in_edges_tensor generation:  0.0033817291259765625
mini_batch_src_global generation:  0.003481626510620117
r_  generation:  0.041990041732788086
----------------------check_connections_block total spend ----------------------------- 0.5354318618774414
generate_one_block  0.057967185974121094
generate_one_block  0.05658102035522461
generate_one_block  0.05531144142150879
generate_one_block  0.055808067321777344
generate_one_block  0.05715036392211914
generate_one_block  0.0555117130279541
generate_one_block  0.06123542785644531
generate_one_block  0.05594038963317871
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04265952110290527
gen group dst list time:  0.01582169532775879
time for parepare:  0.019136428833007812
local_output_nid generation:  0.013945579528808594
local_in_edges_tensor generation:  0.03583240509033203
mini_batch_src_global generation:  0.030369043350219727
r_  generation:  0.313230037689209
local_output_nid generation:  0.022032737731933594
local_in_edges_tensor generation:  0.02817082405090332
mini_batch_src_global generation:  0.03598523139953613
r_  generation:  0.3329906463623047
local_output_nid generation:  0.021883487701416016
local_in_edges_tensor generation:  0.032240867614746094
mini_batch_src_global generation:  0.037992000579833984
r_  generation:  0.3021104335784912
local_output_nid generation:  0.019117116928100586
local_in_edges_tensor generation:  0.027660608291625977
mini_batch_src_global generation:  0.03651022911071777
r_  generation:  0.31203126907348633
local_output_nid generation:  0.018700599670410156
local_in_edges_tensor generation:  0.017602205276489258
mini_batch_src_global generation:  0.03722500801086426
r_  generation:  0.3069303035736084
local_output_nid generation:  0.018820762634277344
local_in_edges_tensor generation:  0.017887353897094727
mini_batch_src_global generation:  0.03687310218811035
r_  generation:  0.3054690361022949
local_output_nid generation:  0.01891303062438965
local_in_edges_tensor generation:  0.020079851150512695
mini_batch_src_global generation:  0.03980565071105957
r_  generation:  0.312330961227417
local_output_nid generation:  0.01884150505065918
local_in_edges_tensor generation:  0.0178985595703125
mini_batch_src_global generation:  0.03741931915283203
r_  generation:  0.30829668045043945
----------------------check_connections_block total spend ----------------------------- 3.691797971725464
generate_one_block  0.39682507514953613
generate_one_block  0.4413614273071289
generate_one_block  0.3900275230407715
generate_one_block  0.4002377986907959
generate_one_block  0.41391587257385254
generate_one_block  0.39749646186828613
generate_one_block  0.40726518630981445
generate_one_block  0.4384596347808838
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08390188217163086
gen group dst list time:  0.04757356643676758
time for parepare:  0.01936650276184082
local_output_nid generation:  0.028317689895629883
local_in_edges_tensor generation:  0.05562758445739746
mini_batch_src_global generation:  0.044564247131347656
r_  generation:  0.4767172336578369
local_output_nid generation:  0.03442549705505371
local_in_edges_tensor generation:  0.05001521110534668
mini_batch_src_global generation:  0.053583383560180664
r_  generation:  0.4828662872314453
local_output_nid generation:  0.034653425216674805
local_in_edges_tensor generation:  0.05014348030090332
mini_batch_src_global generation:  0.05051112174987793
r_  generation:  0.500723123550415
local_output_nid generation:  0.0363314151763916
local_in_edges_tensor generation:  0.04416918754577637
mini_batch_src_global generation:  0.05418586730957031
r_  generation:  0.506171464920044
local_output_nid generation:  0.038110971450805664
local_in_edges_tensor generation:  0.03993391990661621
mini_batch_src_global generation:  0.05687737464904785
r_  generation:  0.508342981338501
local_output_nid generation:  0.03618121147155762
local_in_edges_tensor generation:  0.04851794242858887
mini_batch_src_global generation:  0.05429887771606445
r_  generation:  0.49153566360473633
local_output_nid generation:  0.03623151779174805
local_in_edges_tensor generation:  0.042029380798339844
mini_batch_src_global generation:  0.05228447914123535
r_  generation:  0.504037618637085
local_output_nid generation:  0.03618788719177246
local_in_edges_tensor generation:  0.033097028732299805
mini_batch_src_global generation:  0.05479073524475098
r_  generation:  0.49893760681152344
----------------------check_connections_block total spend ----------------------------- 5.909488677978516
generate_one_block  0.6091263294219971
generate_one_block  0.6214053630828857
generate_one_block  0.6157596111297607
generate_one_block  0.6131172180175781
generate_one_block  0.602348804473877
generate_one_block  0.6146483421325684
generate_one_block  0.6259386539459229
generate_one_block  0.6656160354614258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1287527084350586  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

connection checking time:  9.60128664970398
block generation total time  8.253549337387085
average batch blocks generation time:  1.0316936671733856
block dataloader generation time/epoch 19.913649797439575
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09997797012329102  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

torch.Size([160562, 128])
torch.Size([141178, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5478954315185547  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09902620315551758  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

torch.Size([160362, 128])
torch.Size([141285, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5467734336853027  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09900140762329102  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

torch.Size([160682, 128])
torch.Size([141431, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5486373901367188  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.0990452766418457  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

torch.Size([160454, 128])
torch.Size([140919, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5459704399108887  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09890985488891602  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

torch.Size([160412, 128])
torch.Size([140813, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.542332649230957  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09896707534790039  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

torch.Size([160644, 128])
torch.Size([141204, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5474996566772461  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09906816482543945  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

torch.Size([160502, 128])
torch.Size([141488, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5507040023803711  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09929180145263672  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

torch.Size([160591, 128])
torch.Size([141185, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5468630790710449  GigaBytes
Max Memory Allocated: 0.6177730560302734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04589071869850159 |0.019928276538848877 |0.003659963607788086 |9.238719940185547e-05 |0.0036897659301757812 |0.002819061279296875 |
----------------------------------------------------------pseudo_mini_loss sum 3.5591063499450684
Total (block generation + training)time/epoch 20.53411340713501
Training time/epoch 0.6201777458190918
Training time without block to device /epoch 0.4607515335083008
Training time without total dataloading part /epoch 0.062355995178222656
load block tensor time/epoch 0.3671257495880127
block to device time/epoch 0.15942621231079102
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2956195
Number of first layer input nodes during this epoch:  1284209
