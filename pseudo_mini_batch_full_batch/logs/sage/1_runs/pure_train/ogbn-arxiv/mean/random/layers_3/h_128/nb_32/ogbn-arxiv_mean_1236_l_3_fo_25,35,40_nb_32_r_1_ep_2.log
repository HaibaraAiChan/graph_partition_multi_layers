Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648357313.641566
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02370166778564453
random selection method range initialization spend 0.006207704544067383
time for parepare:  0.0189666748046875
local_output_nid generation:  0.0011699199676513672
local_in_edges_tensor generation:  0.003101348876953125
mini_batch_src_global generation:  0.0014278888702392578
r_  generation:  0.00906825065612793
local_output_nid generation:  0.0014147758483886719
local_in_edges_tensor generation:  0.0009322166442871094
mini_batch_src_global generation:  0.0014579296112060547
r_  generation:  0.007695198059082031
local_output_nid generation:  0.0014450550079345703
local_in_edges_tensor generation:  0.0008032321929931641
mini_batch_src_global generation:  0.0009114742279052734
r_  generation:  0.008927106857299805
local_output_nid generation:  0.0014498233795166016
local_in_edges_tensor generation:  0.0007841587066650391
mini_batch_src_global generation:  0.0008327960968017578
r_  generation:  0.0076024532318115234
local_output_nid generation:  0.0014269351959228516
local_in_edges_tensor generation:  0.0007746219635009766
mini_batch_src_global generation:  0.0008153915405273438
r_  generation:  0.007448434829711914
local_output_nid generation:  0.001405954360961914
local_in_edges_tensor generation:  0.0007512569427490234
mini_batch_src_global generation:  0.0008299350738525391
r_  generation:  0.007709026336669922
local_output_nid generation:  0.0014026165008544922
local_in_edges_tensor generation:  0.0007328987121582031
mini_batch_src_global generation:  0.0008053779602050781
r_  generation:  0.007806062698364258
local_output_nid generation:  0.0014069080352783203
local_in_edges_tensor generation:  0.0007266998291015625
mini_batch_src_global generation:  0.0008089542388916016
r_  generation:  0.007636070251464844
local_output_nid generation:  0.0013718605041503906
local_in_edges_tensor generation:  0.0007164478302001953
mini_batch_src_global generation:  0.00081634521484375
r_  generation:  0.00793313980102539
local_output_nid generation:  0.0013842582702636719
local_in_edges_tensor generation:  0.0007517337799072266
mini_batch_src_global generation:  0.0008907318115234375
r_  generation:  0.007901191711425781
local_output_nid generation:  0.001386404037475586
local_in_edges_tensor generation:  0.0007114410400390625
mini_batch_src_global generation:  0.0008444786071777344
r_  generation:  0.008153200149536133
local_output_nid generation:  0.0013778209686279297
local_in_edges_tensor generation:  0.0007197856903076172
mini_batch_src_global generation:  0.0008342266082763672
r_  generation:  0.007972240447998047
local_output_nid generation:  0.0013763904571533203
local_in_edges_tensor generation:  0.0007143020629882812
mini_batch_src_global generation:  0.0008392333984375
r_  generation:  0.008118391036987305
local_output_nid generation:  0.001390695571899414
local_in_edges_tensor generation:  0.0007305145263671875
mini_batch_src_global generation:  0.0008707046508789062
r_  generation:  0.008300542831420898
local_output_nid generation:  0.0013911724090576172
local_in_edges_tensor generation:  0.0007102489471435547
mini_batch_src_global generation:  0.000885009765625
r_  generation:  0.008349180221557617
local_output_nid generation:  0.001375436782836914
local_in_edges_tensor generation:  0.0007257461547851562
mini_batch_src_global generation:  0.0008857250213623047
r_  generation:  0.008556842803955078
local_output_nid generation:  0.001402139663696289
local_in_edges_tensor generation:  0.0007154941558837891
mini_batch_src_global generation:  0.0008707046508789062
r_  generation:  0.008103132247924805
local_output_nid generation:  0.0013840198516845703
local_in_edges_tensor generation:  0.0007150173187255859
mini_batch_src_global generation:  0.0008635520935058594
r_  generation:  0.007971525192260742
local_output_nid generation:  0.001384735107421875
local_in_edges_tensor generation:  0.0007185935974121094
mini_batch_src_global generation:  0.0008511543273925781
r_  generation:  0.008095741271972656
local_output_nid generation:  0.0013651847839355469
local_in_edges_tensor generation:  0.00070953369140625
mini_batch_src_global generation:  0.0008492469787597656
r_  generation:  0.008045196533203125
local_output_nid generation:  0.0013742446899414062
local_in_edges_tensor generation:  0.0007493495941162109
mini_batch_src_global generation:  0.0008630752563476562
r_  generation:  0.00813603401184082
local_output_nid generation:  0.0013895034790039062
local_in_edges_tensor generation:  0.0007085800170898438
mini_batch_src_global generation:  0.0008959770202636719
r_  generation:  0.00828409194946289
local_output_nid generation:  0.0013833045959472656
local_in_edges_tensor generation:  0.0007405281066894531
mini_batch_src_global generation:  0.0009136199951171875
r_  generation:  0.008298397064208984
local_output_nid generation:  0.0013604164123535156
local_in_edges_tensor generation:  0.0007030963897705078
mini_batch_src_global generation:  0.0008332729339599609
r_  generation:  0.007949352264404297
local_output_nid generation:  0.001386880874633789
local_in_edges_tensor generation:  0.0007066726684570312
mini_batch_src_global generation:  0.0008487701416015625
r_  generation:  0.008039236068725586
local_output_nid generation:  0.0013680458068847656
local_in_edges_tensor generation:  0.0007126331329345703
mini_batch_src_global generation:  0.0008563995361328125
r_  generation:  0.008285045623779297
local_output_nid generation:  0.0013747215270996094
local_in_edges_tensor generation:  0.0007016658782958984
mini_batch_src_global generation:  0.0008358955383300781
r_  generation:  0.008090496063232422
local_output_nid generation:  0.0013811588287353516
local_in_edges_tensor generation:  0.0007054805755615234
mini_batch_src_global generation:  0.0008380413055419922
r_  generation:  0.008034229278564453
local_output_nid generation:  0.0013837814331054688
local_in_edges_tensor generation:  0.0007040500640869141
mini_batch_src_global generation:  0.0008544921875
r_  generation:  0.008148193359375
local_output_nid generation:  0.0013761520385742188
local_in_edges_tensor generation:  0.005107879638671875
mini_batch_src_global generation:  0.0011038780212402344
r_  generation:  0.00829458236694336
local_output_nid generation:  0.0012426376342773438
local_in_edges_tensor generation:  0.0007805824279785156
mini_batch_src_global generation:  0.0010173320770263672
r_  generation:  0.008234739303588867
local_output_nid generation:  0.001283407211303711
local_in_edges_tensor generation:  0.0007162094116210938
mini_batch_src_global generation:  0.0009350776672363281
r_  generation:  0.008111953735351562
----------------------check_connections_block total spend ----------------------------- 0.46190905570983887
generate_one_block  0.013457059860229492
generate_one_block  0.013050556182861328
generate_one_block  0.012986898422241211
generate_one_block  0.012829303741455078
generate_one_block  0.012653112411499023
generate_one_block  0.013064384460449219
generate_one_block  0.012634515762329102
generate_one_block  0.012618780136108398
generate_one_block  0.013139724731445312
generate_one_block  0.013218164443969727
generate_one_block  0.01309823989868164
generate_one_block  0.012830257415771484
generate_one_block  0.012858867645263672
generate_one_block  0.01326131820678711
generate_one_block  0.013205289840698242
generate_one_block  0.01335000991821289
generate_one_block  0.01288151741027832
generate_one_block  0.012798786163330078
generate_one_block  0.012984514236450195
generate_one_block  0.012780427932739258
generate_one_block  0.012913942337036133
generate_one_block  0.013477802276611328
generate_one_block  0.013336181640625
generate_one_block  0.012548685073852539
generate_one_block  0.012939214706420898
generate_one_block  0.013097286224365234
generate_one_block  0.012707710266113281
generate_one_block  0.012674331665039062
generate_one_block  0.013030529022216797
generate_one_block  0.013086080551147461
generate_one_block  0.013346672058105469
generate_one_block  0.012863397598266602
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039752960205078125
gen group dst list time:  0.021298885345458984
time for parepare:  0.019112110137939453
local_output_nid generation:  0.004685640335083008
local_in_edges_tensor generation:  0.010393857955932617
mini_batch_src_global generation:  0.01131892204284668
r_  generation:  0.11412429809570312
local_output_nid generation:  0.008212804794311523
local_in_edges_tensor generation:  0.011572122573852539
mini_batch_src_global generation:  0.014481782913208008
r_  generation:  0.12187409400939941
local_output_nid generation:  0.008016109466552734
local_in_edges_tensor generation:  0.008649110794067383
mini_batch_src_global generation:  0.014470100402832031
r_  generation:  0.12644457817077637
local_output_nid generation:  0.007824182510375977
local_in_edges_tensor generation:  0.0074040889739990234
mini_batch_src_global generation:  0.013895273208618164
r_  generation:  0.12264895439147949
local_output_nid generation:  0.0076885223388671875
local_in_edges_tensor generation:  0.008121252059936523
mini_batch_src_global generation:  0.014363288879394531
r_  generation:  0.1247401237487793
local_output_nid generation:  0.007863998413085938
local_in_edges_tensor generation:  0.008747100830078125
mini_batch_src_global generation:  0.016123294830322266
r_  generation:  0.13387417793273926
local_output_nid generation:  0.007778644561767578
local_in_edges_tensor generation:  0.0075681209564208984
mini_batch_src_global generation:  0.015255928039550781
r_  generation:  0.12951350212097168
local_output_nid generation:  0.007878541946411133
local_in_edges_tensor generation:  0.0076978206634521484
mini_batch_src_global generation:  0.016461610794067383
r_  generation:  0.13187360763549805
local_output_nid generation:  0.008054733276367188
local_in_edges_tensor generation:  0.009914636611938477
mini_batch_src_global generation:  0.016074657440185547
r_  generation:  0.1324005126953125
local_output_nid generation:  0.007995367050170898
local_in_edges_tensor generation:  0.009809732437133789
mini_batch_src_global generation:  0.01586294174194336
r_  generation:  0.1346447467803955
local_output_nid generation:  0.008031368255615234
local_in_edges_tensor generation:  0.007652759552001953
mini_batch_src_global generation:  0.0159609317779541
r_  generation:  0.13636565208435059
local_output_nid generation:  0.008029937744140625
local_in_edges_tensor generation:  0.00773167610168457
mini_batch_src_global generation:  0.018971920013427734
r_  generation:  0.1338818073272705
local_output_nid generation:  0.007927179336547852
local_in_edges_tensor generation:  0.007678508758544922
mini_batch_src_global generation:  0.01592850685119629
r_  generation:  0.1326296329498291
local_output_nid generation:  0.00799703598022461
local_in_edges_tensor generation:  0.008256912231445312
mini_batch_src_global generation:  0.017313718795776367
r_  generation:  0.1391458511352539
local_output_nid generation:  0.008025407791137695
local_in_edges_tensor generation:  0.009877204895019531
mini_batch_src_global generation:  0.016524553298950195
r_  generation:  0.1341547966003418
local_output_nid generation:  0.008133649826049805
local_in_edges_tensor generation:  0.01020359992980957
mini_batch_src_global generation:  0.017437219619750977
r_  generation:  0.14178156852722168
local_output_nid generation:  0.008047103881835938
local_in_edges_tensor generation:  0.007827997207641602
mini_batch_src_global generation:  0.016095876693725586
r_  generation:  0.13221049308776855
local_output_nid generation:  0.008010387420654297
local_in_edges_tensor generation:  0.0077915191650390625
mini_batch_src_global generation:  0.016078472137451172
r_  generation:  0.13251876831054688
local_output_nid generation:  0.007937431335449219
local_in_edges_tensor generation:  0.008447885513305664
mini_batch_src_global generation:  0.015970468521118164
r_  generation:  0.13297462463378906
local_output_nid generation:  0.00793910026550293
local_in_edges_tensor generation:  0.009721755981445312
mini_batch_src_global generation:  0.016245126724243164
r_  generation:  0.13573479652404785
local_output_nid generation:  0.007989168167114258
local_in_edges_tensor generation:  0.010938644409179688
mini_batch_src_global generation:  0.0174252986907959
r_  generation:  0.13483595848083496
local_output_nid generation:  0.008002042770385742
local_in_edges_tensor generation:  0.0078008174896240234
mini_batch_src_global generation:  0.016289472579956055
r_  generation:  0.13433456420898438
local_output_nid generation:  0.008084535598754883
local_in_edges_tensor generation:  0.008613109588623047
mini_batch_src_global generation:  0.017632246017456055
r_  generation:  0.13725852966308594
local_output_nid generation:  0.007841110229492188
local_in_edges_tensor generation:  0.007627248764038086
mini_batch_src_global generation:  0.01580667495727539
r_  generation:  0.13236784934997559
local_output_nid generation:  0.007960796356201172
local_in_edges_tensor generation:  0.0076596736907958984
mini_batch_src_global generation:  0.016208410263061523
r_  generation:  0.13661479949951172
local_output_nid generation:  0.007990598678588867
local_in_edges_tensor generation:  0.009820938110351562
mini_batch_src_global generation:  0.016506671905517578
r_  generation:  0.13753437995910645
local_output_nid generation:  0.008028507232666016
local_in_edges_tensor generation:  0.007801055908203125
mini_batch_src_global generation:  0.016386032104492188
r_  generation:  0.13202929496765137
local_output_nid generation:  0.007891416549682617
local_in_edges_tensor generation:  0.00791621208190918
mini_batch_src_global generation:  0.015529155731201172
r_  generation:  0.13270020484924316
local_output_nid generation:  0.008071184158325195
local_in_edges_tensor generation:  0.008804082870483398
mini_batch_src_global generation:  0.016838550567626953
r_  generation:  0.13258576393127441
local_output_nid generation:  0.00802922248840332
local_in_edges_tensor generation:  0.008915185928344727
mini_batch_src_global generation:  0.016000747680664062
r_  generation:  0.13948464393615723
local_output_nid generation:  0.008064746856689453
local_in_edges_tensor generation:  0.007748126983642578
mini_batch_src_global generation:  0.016420841217041016
r_  generation:  0.14067792892456055
local_output_nid generation:  0.008196353912353516
local_in_edges_tensor generation:  0.009776830673217773
mini_batch_src_global generation:  0.01627659797668457
r_  generation:  0.1341564655303955
----------------------check_connections_block total spend ----------------------------- 6.294646501541138
generate_one_block  0.16265606880187988
generate_one_block  0.1590883731842041
generate_one_block  0.186784029006958
generate_one_block  0.15871071815490723
generate_one_block  0.15932035446166992
generate_one_block  0.16262054443359375
generate_one_block  0.1588881015777588
generate_one_block  0.1645185947418213
generate_one_block  0.16770386695861816
generate_one_block  0.16304969787597656
generate_one_block  0.166243314743042
generate_one_block  0.1622774600982666
generate_one_block  0.16205692291259766
generate_one_block  0.17189359664916992
generate_one_block  0.16754937171936035
generate_one_block  0.19082188606262207
generate_one_block  0.1629166603088379
generate_one_block  0.16490483283996582
generate_one_block  0.16772842407226562
generate_one_block  0.16556406021118164
generate_one_block  0.16717529296875
generate_one_block  0.16894173622131348
generate_one_block  0.1730942726135254
generate_one_block  0.16369986534118652
generate_one_block  0.1665055751800537
generate_one_block  0.17302393913269043
generate_one_block  0.16235637664794922
generate_one_block  0.16063547134399414
generate_one_block  0.1710655689239502
generate_one_block  0.1747150421142578
generate_one_block  0.17413997650146484
generate_one_block  0.1628272533416748
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05220341682434082
gen group dst list time:  0.09792661666870117
time for parepare:  0.01934671401977539
local_output_nid generation:  0.020993709564208984
local_in_edges_tensor generation:  0.04407691955566406
mini_batch_src_global generation:  0.036200761795043945
r_  generation:  0.3784646987915039
local_output_nid generation:  0.0291898250579834
local_in_edges_tensor generation:  0.04013323783874512
mini_batch_src_global generation:  0.04542660713195801
r_  generation:  0.38979220390319824
local_output_nid generation:  0.02847433090209961
local_in_edges_tensor generation:  0.03700399398803711
mini_batch_src_global generation:  0.04508090019226074
r_  generation:  0.38991880416870117
local_output_nid generation:  0.026705026626586914
local_in_edges_tensor generation:  0.026332855224609375
mini_batch_src_global generation:  0.04647326469421387
r_  generation:  0.39215540885925293
local_output_nid generation:  0.02590203285217285
local_in_edges_tensor generation:  0.0290985107421875
mini_batch_src_global generation:  0.046181440353393555
r_  generation:  0.39474058151245117
local_output_nid generation:  0.02637648582458496
local_in_edges_tensor generation:  0.036804914474487305
mini_batch_src_global generation:  0.04982495307922363
r_  generation:  0.3958916664123535
local_output_nid generation:  0.02630138397216797
local_in_edges_tensor generation:  0.02564382553100586
mini_batch_src_global generation:  0.04632759094238281
r_  generation:  0.3981614112854004
local_output_nid generation:  0.02666950225830078
local_in_edges_tensor generation:  0.026093482971191406
mini_batch_src_global generation:  0.05039334297180176
r_  generation:  0.39859604835510254
local_output_nid generation:  0.026847124099731445
local_in_edges_tensor generation:  0.03313612937927246
mini_batch_src_global generation:  0.04967761039733887
r_  generation:  0.4038255214691162
local_output_nid generation:  0.026643753051757812
local_in_edges_tensor generation:  0.03341245651245117
mini_batch_src_global generation:  0.047333478927612305
r_  generation:  0.39816832542419434
local_output_nid generation:  0.026697397232055664
local_in_edges_tensor generation:  0.041779518127441406
mini_batch_src_global generation:  0.04702329635620117
r_  generation:  0.40419983863830566
local_output_nid generation:  0.026696443557739258
local_in_edges_tensor generation:  0.026647329330444336
mini_batch_src_global generation:  0.04745316505432129
r_  generation:  0.39987683296203613
local_output_nid generation:  0.02661728858947754
local_in_edges_tensor generation:  0.025908470153808594
mini_batch_src_global generation:  0.04783296585083008
r_  generation:  0.3997352123260498
local_output_nid generation:  0.026725292205810547
local_in_edges_tensor generation:  0.03281831741333008
mini_batch_src_global generation:  0.050309181213378906
r_  generation:  0.4041469097137451
local_output_nid generation:  0.026955604553222656
local_in_edges_tensor generation:  0.03994250297546387
mini_batch_src_global generation:  0.04665732383728027
r_  generation:  0.4039788246154785
local_output_nid generation:  0.026764631271362305
local_in_edges_tensor generation:  0.03196263313293457
mini_batch_src_global generation:  0.050779104232788086
r_  generation:  0.40364909172058105
local_output_nid generation:  0.027388811111450195
local_in_edges_tensor generation:  0.028328895568847656
mini_batch_src_global generation:  0.04649758338928223
r_  generation:  0.4035823345184326
local_output_nid generation:  0.026680469512939453
local_in_edges_tensor generation:  0.028371810913085938
mini_batch_src_global generation:  0.04852771759033203
r_  generation:  0.394575834274292
local_output_nid generation:  0.026804208755493164
local_in_edges_tensor generation:  0.02811408042907715
mini_batch_src_global generation:  0.04623699188232422
r_  generation:  0.41805195808410645
local_output_nid generation:  0.026555776596069336
local_in_edges_tensor generation:  0.03296089172363281
mini_batch_src_global generation:  0.047518253326416016
r_  generation:  0.3927755355834961
local_output_nid generation:  0.026628732681274414
local_in_edges_tensor generation:  0.03877830505371094
mini_batch_src_global generation:  0.051839351654052734
r_  generation:  0.40801548957824707
local_output_nid generation:  0.027966737747192383
local_in_edges_tensor generation:  0.02603459358215332
mini_batch_src_global generation:  0.04759383201599121
r_  generation:  0.3961634635925293
local_output_nid generation:  0.026890039443969727
local_in_edges_tensor generation:  0.03348708152770996
mini_batch_src_global generation:  0.04654860496520996
r_  generation:  0.40645861625671387
local_output_nid generation:  0.0264585018157959
local_in_edges_tensor generation:  0.02599930763244629
mini_batch_src_global generation:  0.0480036735534668
r_  generation:  0.40064072608947754
local_output_nid generation:  0.026543140411376953
local_in_edges_tensor generation:  0.026428937911987305
mini_batch_src_global generation:  0.04898643493652344
r_  generation:  0.4080808162689209
local_output_nid generation:  0.026668548583984375
local_in_edges_tensor generation:  0.04019355773925781
mini_batch_src_global generation:  0.04708743095397949
r_  generation:  0.41410112380981445
local_output_nid generation:  0.02692580223083496
local_in_edges_tensor generation:  0.02965545654296875
mini_batch_src_global generation:  0.0465848445892334
r_  generation:  0.4004526138305664
local_output_nid generation:  0.02655482292175293
local_in_edges_tensor generation:  0.02665400505065918
mini_batch_src_global generation:  0.04658007621765137
r_  generation:  0.3991677761077881
local_output_nid generation:  0.02663588523864746
local_in_edges_tensor generation:  0.025600671768188477
mini_batch_src_global generation:  0.04680132865905762
r_  generation:  0.4018833637237549
local_output_nid generation:  0.027339696884155273
local_in_edges_tensor generation:  0.03425192832946777
mini_batch_src_global generation:  0.047039031982421875
r_  generation:  0.40709400177001953
local_output_nid generation:  0.02705073356628418
local_in_edges_tensor generation:  0.041405677795410156
mini_batch_src_global generation:  0.04984879493713379
r_  generation:  0.4110715389251709
local_output_nid generation:  0.02686762809753418
local_in_edges_tensor generation:  0.026121139526367188
mini_batch_src_global generation:  0.047185420989990234
r_  generation:  0.4007689952850342
----------------------check_connections_block total spend ----------------------------- 19.00745940208435
generate_one_block  0.6031603813171387
generate_one_block  0.5134520530700684
generate_one_block  0.5121414661407471
generate_one_block  0.5099530220031738
generate_one_block  0.5177478790283203
generate_one_block  0.5193819999694824
generate_one_block  0.509941577911377
generate_one_block  0.5098881721496582
generate_one_block  0.5240130424499512
generate_one_block  0.5180690288543701
generate_one_block  0.5127990245819092
generate_one_block  0.512427806854248
generate_one_block  0.5128858089447021
generate_one_block  0.5281729698181152
generate_one_block  0.5397074222564697
generate_one_block  0.5249979496002197
generate_one_block  0.5064206123352051
generate_one_block  0.5077915191650391
generate_one_block  0.5007603168487549
generate_one_block  0.5194261074066162
generate_one_block  0.522071361541748
generate_one_block  0.5205731391906738
generate_one_block  0.5288758277893066
generate_one_block  0.5042352676391602
generate_one_block  0.5122659206390381
generate_one_block  0.5300889015197754
generate_one_block  0.5126838684082031
generate_one_block  0.501833438873291
generate_one_block  0.5006036758422852
generate_one_block  0.5209119319915771
generate_one_block  0.5289239883422852
generate_one_block  0.5081193447113037
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  25.30210590362549
block generation total time  21.93780207633972
average batch blocks generation time:  0.6855563148856163
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08282041549682617  GigaBytes
Max Memory Allocated: 0.08282041549682617  GigaBytes

torch.Size([145443, 128])
torch.Size([98700, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.3451542854309082  GigaBytes
Max Memory Allocated: 0.35523366928100586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08359432220458984  GigaBytes
Max Memory Allocated: 0.39516353607177734  GigaBytes

torch.Size([145510, 128])
torch.Size([99069, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34659624099731445  GigaBytes
Max Memory Allocated: 0.39516353607177734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08251667022705078  GigaBytes
Max Memory Allocated: 0.3967585563659668  GigaBytes

torch.Size([145074, 128])
torch.Size([98946, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3466038703918457  GigaBytes
Max Memory Allocated: 0.3967585563659668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08246898651123047  GigaBytes
Max Memory Allocated: 0.3967585563659668  GigaBytes

torch.Size([145314, 128])
torch.Size([98887, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.343289852142334  GigaBytes
Max Memory Allocated: 0.3967585563659668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08207464218139648  GigaBytes
Max Memory Allocated: 0.3967585563659668  GigaBytes

torch.Size([144436, 128])
torch.Size([97527, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3410177230834961  GigaBytes
Max Memory Allocated: 0.3967585563659668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08365440368652344  GigaBytes
Max Memory Allocated: 0.3967585563659668  GigaBytes

torch.Size([145768, 128])
torch.Size([99584, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34682273864746094  GigaBytes
Max Memory Allocated: 0.3967585563659668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08243179321289062  GigaBytes
Max Memory Allocated: 0.39756059646606445  GigaBytes

torch.Size([145250, 128])
torch.Size([98291, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34259891510009766  GigaBytes
Max Memory Allocated: 0.39756059646606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08250904083251953  GigaBytes
Max Memory Allocated: 0.39756059646606445  GigaBytes

torch.Size([145252, 128])
torch.Size([98485, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34308862686157227  GigaBytes
Max Memory Allocated: 0.39756059646606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08370256423950195  GigaBytes
Max Memory Allocated: 0.39756059646606445  GigaBytes

torch.Size([145388, 128])
torch.Size([99190, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3479928970336914  GigaBytes
Max Memory Allocated: 0.39756059646606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08365440368652344  GigaBytes
Max Memory Allocated: 0.39756059646606445  GigaBytes

torch.Size([145735, 128])
torch.Size([99538, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34840822219848633  GigaBytes
Max Memory Allocated: 0.39756059646606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08367538452148438  GigaBytes
Max Memory Allocated: 0.3982381820678711  GigaBytes

torch.Size([145603, 128])
torch.Size([99306, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34813499450683594  GigaBytes
Max Memory Allocated: 0.3982381820678711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08356285095214844  GigaBytes
Max Memory Allocated: 0.3982381820678711  GigaBytes

torch.Size([145456, 128])
torch.Size([98791, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3449978828430176  GigaBytes
Max Memory Allocated: 0.3982381820678711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08247089385986328  GigaBytes
Max Memory Allocated: 0.3982381820678711  GigaBytes

torch.Size([145218, 128])
torch.Size([98373, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3434267044067383  GigaBytes
Max Memory Allocated: 0.3982381820678711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08368396759033203  GigaBytes
Max Memory Allocated: 0.3982381820678711  GigaBytes

torch.Size([145285, 128])
torch.Size([99316, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34812355041503906  GigaBytes
Max Memory Allocated: 0.3982381820678711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08468866348266602  GigaBytes
Max Memory Allocated: 0.3982381820678711  GigaBytes

torch.Size([145435, 128])
torch.Size([99837, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.35010194778442383  GigaBytes
Max Memory Allocated: 0.3982381820678711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08472776412963867  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

torch.Size([145602, 128])
torch.Size([99616, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3497314453125  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08358097076416016  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

torch.Size([145524, 128])
torch.Size([98780, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3447446823120117  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08362770080566406  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

torch.Size([145466, 128])
torch.Size([98837, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3454604148864746  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08250045776367188  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

torch.Size([145198, 128])
torch.Size([98822, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34409666061401367  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08223390579223633  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

torch.Size([144591, 128])
torch.Size([98026, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.342836856842041  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08250761032104492  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

torch.Size([144989, 128])
torch.Size([98708, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34528160095214844  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0826873779296875  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

torch.Size([145390, 128])
torch.Size([98882, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34549617767333984  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08470821380615234  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

torch.Size([145636, 128])
torch.Size([99986, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.35043811798095703  GigaBytes
Max Memory Allocated: 0.4000663757324219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08244609832763672  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

torch.Size([145158, 128])
torch.Size([98557, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3437066078186035  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08231067657470703  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

torch.Size([144654, 128])
torch.Size([98624, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3447880744934082  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08469343185424805  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

torch.Size([145545, 128])
torch.Size([99717, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3498530387878418  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08360862731933594  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

torch.Size([145822, 128])
torch.Size([99499, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34688711166381836  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08243417739868164  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

torch.Size([145319, 128])
torch.Size([98466, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3428683280944824  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08354759216308594  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

torch.Size([145593, 128])
torch.Size([98909, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3453946113586426  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08469772338867188  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

torch.Size([145744, 128])
torch.Size([100071, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.35058164596557617  GigaBytes
Max Memory Allocated: 0.4001002311706543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08470726013183594  GigaBytes
Max Memory Allocated: 0.40076732635498047  GigaBytes

torch.Size([145502, 128])
torch.Size([100049, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.35052061080932617  GigaBytes
Max Memory Allocated: 0.40076732635498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08360862731933594  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

torch.Size([145485, 128])
torch.Size([99279, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34804582595825195  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03157276660203934 |0.02322712540626526 |0.026730194687843323 |9.35867428779602e-05 |0.00511479377746582 |0.001970052719116211 |
----------------------------------------------------------pseudo_mini_loss sum 5.603936672210693
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8571375
Number of first layer input nodes during this epoch:  4651385
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10169839859008789  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02267909049987793
random selection method range initialization spend 0.005211830139160156
time for parepare:  0.017749786376953125
local_output_nid generation:  0.0012555122375488281
local_in_edges_tensor generation:  0.007910013198852539
mini_batch_src_global generation:  0.0018837451934814453
r_  generation:  0.008772850036621094
local_output_nid generation:  0.0014486312866210938
local_in_edges_tensor generation:  0.0009541511535644531
mini_batch_src_global generation:  0.0016405582427978516
r_  generation:  0.008083581924438477
local_output_nid generation:  0.0014274120330810547
local_in_edges_tensor generation:  0.0008523464202880859
mini_batch_src_global generation:  0.0010781288146972656
r_  generation:  0.007886171340942383
local_output_nid generation:  0.0014336109161376953
local_in_edges_tensor generation:  0.0008273124694824219
mini_batch_src_global generation:  0.0009739398956298828
r_  generation:  0.008063316345214844
local_output_nid generation:  0.0013859272003173828
local_in_edges_tensor generation:  0.0007877349853515625
mini_batch_src_global generation:  0.0009207725524902344
r_  generation:  0.010629892349243164
local_output_nid generation:  0.001399993896484375
local_in_edges_tensor generation:  0.0008175373077392578
mini_batch_src_global generation:  0.0009377002716064453
r_  generation:  0.00830698013305664
local_output_nid generation:  0.0013844966888427734
local_in_edges_tensor generation:  0.0007643699645996094
mini_batch_src_global generation:  0.0009009838104248047
r_  generation:  0.008082866668701172
local_output_nid generation:  0.0013687610626220703
local_in_edges_tensor generation:  0.0007596015930175781
mini_batch_src_global generation:  0.0008900165557861328
r_  generation:  0.008124589920043945
local_output_nid generation:  0.0014035701751708984
local_in_edges_tensor generation:  0.000774383544921875
mini_batch_src_global generation:  0.0008649826049804688
r_  generation:  0.0080413818359375
local_output_nid generation:  0.001363992691040039
local_in_edges_tensor generation:  0.0007476806640625
mini_batch_src_global generation:  0.0008649826049804688
r_  generation:  0.008049964904785156
local_output_nid generation:  0.001360177993774414
local_in_edges_tensor generation:  0.0007505416870117188
mini_batch_src_global generation:  0.0008482933044433594
r_  generation:  0.007747173309326172
local_output_nid generation:  0.0013723373413085938
local_in_edges_tensor generation:  0.0007932186126708984
mini_batch_src_global generation:  0.0008952617645263672
r_  generation:  0.00818014144897461
local_output_nid generation:  0.0014090538024902344
local_in_edges_tensor generation:  0.0007445812225341797
mini_batch_src_global generation:  0.0008959770202636719
r_  generation:  0.008171558380126953
local_output_nid generation:  0.0013854503631591797
local_in_edges_tensor generation:  0.0007863044738769531
mini_batch_src_global generation:  0.0009424686431884766
r_  generation:  0.008424997329711914
local_output_nid generation:  0.0013737678527832031
local_in_edges_tensor generation:  0.0008029937744140625
mini_batch_src_global generation:  0.000881195068359375
r_  generation:  0.008467912673950195
local_output_nid generation:  0.0013892650604248047
local_in_edges_tensor generation:  0.0007381439208984375
mini_batch_src_global generation:  0.0008809566497802734
r_  generation:  0.008368253707885742
local_output_nid generation:  0.0014333724975585938
local_in_edges_tensor generation:  0.0007491111755371094
mini_batch_src_global generation:  0.0008876323699951172
r_  generation:  0.008055686950683594
local_output_nid generation:  0.0013852119445800781
local_in_edges_tensor generation:  0.0007631778717041016
mini_batch_src_global generation:  0.0008876323699951172
r_  generation:  0.008123159408569336
local_output_nid generation:  0.0013599395751953125
local_in_edges_tensor generation:  0.0007483959197998047
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.008561134338378906
local_output_nid generation:  0.0014216899871826172
local_in_edges_tensor generation:  0.0007612705230712891
mini_batch_src_global generation:  0.0009379386901855469
r_  generation:  0.01115274429321289
local_output_nid generation:  0.0013911724090576172
local_in_edges_tensor generation:  0.0007746219635009766
mini_batch_src_global generation:  0.0009329319000244141
r_  generation:  0.008381366729736328
local_output_nid generation:  0.0014147758483886719
local_in_edges_tensor generation:  0.0007617473602294922
mini_batch_src_global generation:  0.0009138584136962891
r_  generation:  0.0081024169921875
local_output_nid generation:  0.0013763904571533203
local_in_edges_tensor generation:  0.0007450580596923828
mini_batch_src_global generation:  0.0009050369262695312
r_  generation:  0.008041858673095703
local_output_nid generation:  0.0013811588287353516
local_in_edges_tensor generation:  0.0007555484771728516
mini_batch_src_global generation:  0.0009677410125732422
r_  generation:  0.008109092712402344
local_output_nid generation:  0.0013806819915771484
local_in_edges_tensor generation:  0.0007605552673339844
mini_batch_src_global generation:  0.0009098052978515625
r_  generation:  0.008725166320800781
local_output_nid generation:  0.0013551712036132812
local_in_edges_tensor generation:  0.0007359981536865234
mini_batch_src_global generation:  0.0009379386901855469
r_  generation:  0.008305788040161133
local_output_nid generation:  0.0013804435729980469
local_in_edges_tensor generation:  0.0007841587066650391
mini_batch_src_global generation:  0.0009210109710693359
r_  generation:  0.008027315139770508
local_output_nid generation:  0.0013952255249023438
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.0009481906890869141
r_  generation:  0.011185169219970703
local_output_nid generation:  0.0013828277587890625
local_in_edges_tensor generation:  0.0007677078247070312
mini_batch_src_global generation:  0.0009188652038574219
r_  generation:  0.00792694091796875
local_output_nid generation:  0.0013921260833740234
local_in_edges_tensor generation:  0.0007672309875488281
mini_batch_src_global generation:  0.0009267330169677734
r_  generation:  0.008347749710083008
local_output_nid generation:  0.001377105712890625
local_in_edges_tensor generation:  0.0007457733154296875
mini_batch_src_global generation:  0.0009272098541259766
r_  generation:  0.008333206176757812
local_output_nid generation:  0.0014159679412841797
local_in_edges_tensor generation:  0.0007710456848144531
mini_batch_src_global generation:  0.0009396076202392578
r_  generation:  0.008467674255371094
----------------------check_connections_block total spend ----------------------------- 0.4800710678100586
generate_one_block  0.017851829528808594
generate_one_block  0.015790224075317383
generate_one_block  0.01577615737915039
generate_one_block  0.013275384902954102
generate_one_block  0.01305246353149414
generate_one_block  0.013272762298583984
generate_one_block  0.012963056564331055
generate_one_block  0.013185262680053711
generate_one_block  0.013016462326049805
generate_one_block  0.013058185577392578
generate_one_block  0.015270233154296875
generate_one_block  0.013241767883300781
generate_one_block  0.013036489486694336
generate_one_block  0.013493537902832031
generate_one_block  0.013228178024291992
generate_one_block  0.013134479522705078
generate_one_block  0.012880802154541016
generate_one_block  0.012910842895507812
generate_one_block  0.01593780517578125
generate_one_block  0.01319742202758789
generate_one_block  0.01313328742980957
generate_one_block  0.01297903060913086
generate_one_block  0.01296377182006836
generate_one_block  0.013097524642944336
generate_one_block  0.013283967971801758
generate_one_block  0.0174715518951416
generate_one_block  0.013378143310546875
generate_one_block  0.013826131820678711
generate_one_block  0.012587785720825195
generate_one_block  0.013455390930175781
generate_one_block  0.013378143310546875
generate_one_block  0.01364278793334961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05320096015930176
gen group dst list time:  0.04042482376098633
time for parepare:  0.024052143096923828
local_output_nid generation:  0.0051729679107666016
local_in_edges_tensor generation:  0.027988195419311523
mini_batch_src_global generation:  0.012090921401977539
r_  generation:  0.12218356132507324
local_output_nid generation:  0.007465839385986328
local_in_edges_tensor generation:  0.011628150939941406
mini_batch_src_global generation:  0.018621206283569336
r_  generation:  0.1292414665222168
local_output_nid generation:  0.0077974796295166016
local_in_edges_tensor generation:  0.026012659072875977
mini_batch_src_global generation:  0.013222932815551758
r_  generation:  0.12739872932434082
local_output_nid generation:  0.007826805114746094
local_in_edges_tensor generation:  0.010421037673950195
mini_batch_src_global generation:  0.016434669494628906
r_  generation:  0.13176298141479492
local_output_nid generation:  0.007842302322387695
local_in_edges_tensor generation:  0.010562896728515625
mini_batch_src_global generation:  0.015245199203491211
r_  generation:  0.1363389492034912
local_output_nid generation:  0.007619142532348633
local_in_edges_tensor generation:  0.010749101638793945
mini_batch_src_global generation:  0.015722036361694336
r_  generation:  0.1357126235961914
local_output_nid generation:  0.0074214935302734375
local_in_edges_tensor generation:  0.009509086608886719
mini_batch_src_global generation:  0.01584601402282715
r_  generation:  0.14071226119995117
local_output_nid generation:  0.0075223445892333984
local_in_edges_tensor generation:  0.010644912719726562
mini_batch_src_global generation:  0.015964746475219727
r_  generation:  0.13666963577270508
local_output_nid generation:  0.007410287857055664
local_in_edges_tensor generation:  0.008447885513305664
mini_batch_src_global generation:  0.01722574234008789
r_  generation:  0.13407611846923828
local_output_nid generation:  0.007386445999145508
local_in_edges_tensor generation:  0.009715080261230469
mini_batch_src_global generation:  0.015788793563842773
r_  generation:  0.1397237777709961
local_output_nid generation:  0.011113643646240234
local_in_edges_tensor generation:  0.00806427001953125
mini_batch_src_global generation:  0.015435934066772461
r_  generation:  0.1281452178955078
local_output_nid generation:  0.007544279098510742
local_in_edges_tensor generation:  0.008695840835571289
mini_batch_src_global generation:  0.01689743995666504
r_  generation:  0.15244507789611816
local_output_nid generation:  0.010850191116333008
local_in_edges_tensor generation:  0.019634246826171875
mini_batch_src_global generation:  0.02037668228149414
r_  generation:  0.14085769653320312
local_output_nid generation:  0.008173465728759766
local_in_edges_tensor generation:  0.014961481094360352
mini_batch_src_global generation:  0.018121957778930664
r_  generation:  0.15039610862731934
local_output_nid generation:  0.008219003677368164
local_in_edges_tensor generation:  0.008535623550415039
mini_batch_src_global generation:  0.01612997055053711
r_  generation:  0.13503336906433105
local_output_nid generation:  0.00794529914855957
local_in_edges_tensor generation:  0.008729934692382812
mini_batch_src_global generation:  0.016178369522094727
r_  generation:  0.1422405242919922
local_output_nid generation:  0.007962942123413086
local_in_edges_tensor generation:  0.009084224700927734
mini_batch_src_global generation:  0.015824556350708008
r_  generation:  0.13405799865722656
local_output_nid generation:  0.013549327850341797
local_in_edges_tensor generation:  0.02027726173400879
mini_batch_src_global generation:  0.022373676300048828
r_  generation:  0.1381239891052246
local_output_nid generation:  0.0079803466796875
local_in_edges_tensor generation:  0.010048151016235352
mini_batch_src_global generation:  0.016241073608398438
r_  generation:  0.14010930061340332
local_output_nid generation:  0.008011102676391602
local_in_edges_tensor generation:  0.009302139282226562
mini_batch_src_global generation:  0.02723979949951172
r_  generation:  0.1416325569152832
local_output_nid generation:  0.007960796356201172
local_in_edges_tensor generation:  0.008203268051147461
mini_batch_src_global generation:  0.016057252883911133
r_  generation:  0.13945508003234863
local_output_nid generation:  0.007516145706176758
local_in_edges_tensor generation:  0.0070934295654296875
mini_batch_src_global generation:  0.015755891799926758
r_  generation:  0.1407322883605957
local_output_nid generation:  0.0075838565826416016
local_in_edges_tensor generation:  0.0071446895599365234
mini_batch_src_global generation:  0.01571369171142578
r_  generation:  0.13612961769104004
local_output_nid generation:  0.008573293685913086
local_in_edges_tensor generation:  0.014486312866210938
mini_batch_src_global generation:  0.02279210090637207
r_  generation:  0.13985967636108398
local_output_nid generation:  0.008603572845458984
local_in_edges_tensor generation:  0.010297060012817383
mini_batch_src_global generation:  0.01728534698486328
r_  generation:  0.13872909545898438
local_output_nid generation:  0.007640361785888672
local_in_edges_tensor generation:  0.008516788482666016
mini_batch_src_global generation:  0.019212007522583008
r_  generation:  0.1477494239807129
local_output_nid generation:  0.007566213607788086
local_in_edges_tensor generation:  0.007303953170776367
mini_batch_src_global generation:  0.01601409912109375
r_  generation:  0.1375417709350586
local_output_nid generation:  0.007849693298339844
local_in_edges_tensor generation:  0.009445667266845703
mini_batch_src_global generation:  0.016705751419067383
r_  generation:  0.14289450645446777
local_output_nid generation:  0.007269382476806641
local_in_edges_tensor generation:  0.0071926116943359375
mini_batch_src_global generation:  0.015483856201171875
r_  generation:  0.1358654499053955
local_output_nid generation:  0.007657289505004883
local_in_edges_tensor generation:  0.007447242736816406
mini_batch_src_global generation:  0.016060829162597656
r_  generation:  0.14327383041381836
local_output_nid generation:  0.008465766906738281
local_in_edges_tensor generation:  0.014970541000366211
mini_batch_src_global generation:  0.016727685928344727
r_  generation:  0.14588069915771484
local_output_nid generation:  0.009756803512573242
local_in_edges_tensor generation:  0.010128021240234375
mini_batch_src_global generation:  0.018431663513183594
r_  generation:  0.14537596702575684
----------------------check_connections_block total spend ----------------------------- 6.645345687866211
generate_one_block  0.177445650100708
generate_one_block  0.16140174865722656
generate_one_block  0.16420841217041016
generate_one_block  0.17377686500549316
generate_one_block  0.19536471366882324
generate_one_block  0.1705162525177002
generate_one_block  0.16624879837036133
generate_one_block  0.1723310947418213
generate_one_block  0.16770219802856445
generate_one_block  0.16321539878845215
generate_one_block  0.1568458080291748
generate_one_block  0.1770036220550537
generate_one_block  0.16965675354003906
generate_one_block  0.17713618278503418
generate_one_block  0.16321873664855957
generate_one_block  0.16155290603637695
generate_one_block  0.15965890884399414
generate_one_block  0.1636362075805664
generate_one_block  0.17175602912902832
generate_one_block  0.19581031799316406
generate_one_block  0.17006397247314453
generate_one_block  0.15954875946044922
generate_one_block  0.16275787353515625
generate_one_block  0.16542959213256836
generate_one_block  0.18674826622009277
generate_one_block  0.16464853286743164
generate_one_block  0.1595611572265625
generate_one_block  0.1761178970336914
generate_one_block  0.15631461143493652
generate_one_block  0.1693577766418457
generate_one_block  0.16351819038391113
generate_one_block  0.1798868179321289
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045397281646728516
gen group dst list time:  0.09398221969604492
time for parepare:  0.022774934768676758
local_output_nid generation:  0.02203226089477539
local_in_edges_tensor generation:  0.04398608207702637
mini_batch_src_global generation:  0.04000258445739746
r_  generation:  0.39588451385498047
local_output_nid generation:  0.028041362762451172
local_in_edges_tensor generation:  0.040375709533691406
mini_batch_src_global generation:  0.04662752151489258
r_  generation:  0.4116177558898926
local_output_nid generation:  0.0283510684967041
local_in_edges_tensor generation:  0.04309439659118652
mini_batch_src_global generation:  0.052300453186035156
r_  generation:  0.40024471282958984
local_output_nid generation:  0.0279085636138916
local_in_edges_tensor generation:  0.0347445011138916
mini_batch_src_global generation:  0.05297565460205078
r_  generation:  0.3980553150177002
local_output_nid generation:  0.027823686599731445
local_in_edges_tensor generation:  0.0349583625793457
mini_batch_src_global generation:  0.04630160331726074
r_  generation:  0.405961275100708
local_output_nid generation:  0.02747631072998047
local_in_edges_tensor generation:  0.030698776245117188
mini_batch_src_global generation:  0.04783058166503906
r_  generation:  0.4032104015350342
local_output_nid generation:  0.0270538330078125
local_in_edges_tensor generation:  0.02623152732849121
mini_batch_src_global generation:  0.046889543533325195
r_  generation:  0.40583205223083496
local_output_nid generation:  0.027171850204467773
local_in_edges_tensor generation:  0.03029799461364746
mini_batch_src_global generation:  0.04965043067932129
r_  generation:  0.4228510856628418
local_output_nid generation:  0.02723383903503418
local_in_edges_tensor generation:  0.030308008193969727
mini_batch_src_global generation:  0.046473026275634766
r_  generation:  0.41112685203552246
local_output_nid generation:  0.02718663215637207
local_in_edges_tensor generation:  0.029511213302612305
mini_batch_src_global generation:  0.04700922966003418
r_  generation:  0.40030431747436523
local_output_nid generation:  0.03742790222167969
local_in_edges_tensor generation:  0.03280472755432129
mini_batch_src_global generation:  0.04708600044250488
r_  generation:  0.40955495834350586
local_output_nid generation:  0.027068376541137695
local_in_edges_tensor generation:  0.03786301612854004
mini_batch_src_global generation:  0.05293560028076172
r_  generation:  0.424746036529541
local_output_nid generation:  0.03037405014038086
local_in_edges_tensor generation:  0.03746342658996582
mini_batch_src_global generation:  0.0517578125
r_  generation:  0.4114186763763428
local_output_nid generation:  0.027311325073242188
local_in_edges_tensor generation:  0.030048847198486328
mini_batch_src_global generation:  0.04776787757873535
r_  generation:  0.4044764041900635
local_output_nid generation:  0.02673935890197754
local_in_edges_tensor generation:  0.027846336364746094
mini_batch_src_global generation:  0.04666709899902344
r_  generation:  0.40410423278808594
local_output_nid generation:  0.02679610252380371
local_in_edges_tensor generation:  0.027920246124267578
mini_batch_src_global generation:  0.04712557792663574
r_  generation:  0.4030134677886963
local_output_nid generation:  0.027200698852539062
local_in_edges_tensor generation:  0.03160691261291504
mini_batch_src_global generation:  0.046067237854003906
r_  generation:  0.4141416549682617
local_output_nid generation:  0.027460813522338867
local_in_edges_tensor generation:  0.028284788131713867
mini_batch_src_global generation:  0.04991340637207031
r_  generation:  0.40464282035827637
local_output_nid generation:  0.026833057403564453
local_in_edges_tensor generation:  0.03149890899658203
mini_batch_src_global generation:  0.04667949676513672
r_  generation:  0.41015076637268066
local_output_nid generation:  0.03755950927734375
local_in_edges_tensor generation:  0.031412601470947266
mini_batch_src_global generation:  0.04786992073059082
r_  generation:  0.40696167945861816
local_output_nid generation:  0.02668166160583496
local_in_edges_tensor generation:  0.02732539176940918
mini_batch_src_global generation:  0.04610276222229004
r_  generation:  0.4167463779449463
local_output_nid generation:  0.028071165084838867
local_in_edges_tensor generation:  0.038079023361206055
mini_batch_src_global generation:  0.05776023864746094
r_  generation:  0.40676045417785645
local_output_nid generation:  0.029572725296020508
local_in_edges_tensor generation:  0.030260801315307617
mini_batch_src_global generation:  0.046347856521606445
r_  generation:  0.40549278259277344
local_output_nid generation:  0.026992082595825195
local_in_edges_tensor generation:  0.03538084030151367
mini_batch_src_global generation:  0.04650759696960449
r_  generation:  0.39928150177001953
local_output_nid generation:  0.027205467224121094
local_in_edges_tensor generation:  0.031546831130981445
mini_batch_src_global generation:  0.04614591598510742
r_  generation:  0.41013264656066895
local_output_nid generation:  0.027123212814331055
local_in_edges_tensor generation:  0.0277707576751709
mini_batch_src_global generation:  0.0468592643737793
r_  generation:  0.4090843200683594
local_output_nid generation:  0.027425289154052734
local_in_edges_tensor generation:  0.024953842163085938
mini_batch_src_global generation:  0.048952579498291016
r_  generation:  0.41184210777282715
local_output_nid generation:  0.02773118019104004
local_in_edges_tensor generation:  0.027921676635742188
mini_batch_src_global generation:  0.06834244728088379
r_  generation:  0.4012486934661865
local_output_nid generation:  0.02656078338623047
local_in_edges_tensor generation:  0.0241239070892334
mini_batch_src_global generation:  0.04995393753051758
r_  generation:  0.4061703681945801
local_output_nid generation:  0.026958465576171875
local_in_edges_tensor generation:  0.031296491622924805
mini_batch_src_global generation:  0.046906471252441406
r_  generation:  0.40983033180236816
local_output_nid generation:  0.027124643325805664
local_in_edges_tensor generation:  0.027718305587768555
mini_batch_src_global generation:  0.04709625244140625
r_  generation:  0.41257309913635254
local_output_nid generation:  0.027162551879882812
local_in_edges_tensor generation:  0.030519962310791016
mini_batch_src_global generation:  0.05047750473022461
r_  generation:  0.4074559211730957
----------------------check_connections_block total spend ----------------------------- 19.328006744384766
generate_one_block  0.5336525440216064
generate_one_block  0.5234231948852539
generate_one_block  0.517650842666626
generate_one_block  0.5209407806396484
generate_one_block  0.6273036003112793
generate_one_block  0.5327112674713135
generate_one_block  0.5129275321960449
generate_one_block  0.518261194229126
generate_one_block  0.5154454708099365
generate_one_block  0.5236291885375977
generate_one_block  0.5323870182037354
generate_one_block  0.5545253753662109
generate_one_block  0.533592700958252
generate_one_block  0.5244650840759277
generate_one_block  0.5075948238372803
generate_one_block  0.504025936126709
generate_one_block  0.5347161293029785
generate_one_block  0.5353198051452637
generate_one_block  0.5452165603637695
generate_one_block  0.5158374309539795
generate_one_block  0.5082168579101562
generate_one_block  0.5060474872589111
generate_one_block  0.5126993656158447
generate_one_block  0.5504448413848877
generate_one_block  0.5571246147155762
generate_one_block  0.532217264175415
generate_one_block  0.5084371566772461
generate_one_block  0.5281121730804443
generate_one_block  0.4957156181335449
generate_one_block  0.5113236904144287
generate_one_block  0.525336742401123
generate_one_block  0.5529534816741943
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10169839859008789  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

connection checking time:  25.973352432250977
block generation total time  22.324695825576782
average batch blocks generation time:  0.6976467445492744
block dataloader generation time/epoch 50.677979469299316
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08527088165283203  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

torch.Size([145448, 128])
torch.Size([99597, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.350191593170166  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08308029174804688  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

torch.Size([145332, 128])
torch.Size([98221, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.343353271484375  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08397579193115234  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

torch.Size([145727, 128])
torch.Size([98633, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3451414108276367  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08320140838623047  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

torch.Size([145226, 128])
torch.Size([98770, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34605932235717773  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08420944213867188  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

torch.Size([145291, 128])
torch.Size([99450, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34761857986450195  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08526945114135742  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

torch.Size([145860, 128])
torch.Size([100322, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3516378402709961  GigaBytes
Max Memory Allocated: 0.4007740020751953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08322620391845703  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145304, 128])
torch.Size([99192, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34638166427612305  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08414697647094727  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145113, 128])
torch.Size([99530, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3489823341369629  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.0841665267944336  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145768, 128])
torch.Size([99320, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3475065231323242  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08316516876220703  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145352, 128])
torch.Size([98679, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3440890312194824  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08383464813232422  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145635, 128])
torch.Size([97860, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34252023696899414  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08326482772827148  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145383, 128])
torch.Size([98756, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34567928314208984  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08413362503051758  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145162, 128])
torch.Size([99073, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34653329849243164  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08430051803588867  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145374, 128])
torch.Size([99595, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3493690490722656  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08320999145507812  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145354, 128])
torch.Size([98632, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.345977783203125  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08314704895019531  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145324, 128])
torch.Size([98782, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34471607208251953  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08304643630981445  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145329, 128])
torch.Size([98757, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3437657356262207  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08419990539550781  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145536, 128])
torch.Size([99279, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3469672203063965  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08407115936279297  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([144964, 128])
torch.Size([99085, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3471536636352539  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08423376083374023  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145354, 128])
torch.Size([99504, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3489508628845215  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08422660827636719  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145984, 128])
torch.Size([99368, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3487539291381836  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08301353454589844  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145160, 128])
torch.Size([98804, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34403228759765625  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08404541015625  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145576, 128])
torch.Size([98661, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3448653221130371  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08419036865234375  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145431, 128])
torch.Size([98768, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3459129333496094  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08428573608398438  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145396, 128])
torch.Size([99644, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34932994842529297  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08425426483154297  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145413, 128])
torch.Size([99275, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34757232666015625  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.0831003189086914  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145332, 128])
torch.Size([98588, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34346914291381836  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08527851104736328  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145958, 128])
torch.Size([99818, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.35069990158081055  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08267498016357422  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([144996, 128])
torch.Size([97298, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3380718231201172  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08525228500366211  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145813, 128])
torch.Size([99392, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3497891426086426  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08415031433105469  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145447, 128])
torch.Size([99155, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34636640548706055  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08529424667358398  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

torch.Size([145470, 128])
torch.Size([99905, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.35115814208984375  GigaBytes
Max Memory Allocated: 0.40193700790405273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028656907379627228 |0.012461788952350616 |0.0034914985299110413 |8.929520845413208e-05 |0.003732845187187195 |0.001398324966430664 |
----------------------------------------------------------pseudo_mini_loss sum 3.5832650661468506
Total (block generation + training)time/epoch 52.2771110534668
Training time/epoch 1.5988256931304932
Training time without block to device /epoch 1.2000484466552734
Training time without total dataloading part /epoch 0.23543477058410645
load block tensor time/epoch 0.9170210361480713
block to device time/epoch 0.3987772464752197
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8574696
Number of first layer input nodes during this epoch:  4653812
