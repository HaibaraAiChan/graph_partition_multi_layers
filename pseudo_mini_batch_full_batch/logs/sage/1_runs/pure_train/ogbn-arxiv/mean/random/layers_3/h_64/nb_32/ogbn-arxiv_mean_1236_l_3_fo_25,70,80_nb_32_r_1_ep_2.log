Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648356250.8220708
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02654409408569336
random selection method range initialization spend 0.006344318389892578
time for parepare:  0.018872737884521484
local_output_nid generation:  0.0011119842529296875
local_in_edges_tensor generation:  0.004196643829345703
mini_batch_src_global generation:  0.0016608238220214844
r_  generation:  0.011490821838378906
local_output_nid generation:  0.0014157295227050781
local_in_edges_tensor generation:  0.0009915828704833984
mini_batch_src_global generation:  0.0015835762023925781
r_  generation:  0.009888410568237305
local_output_nid generation:  0.0014734268188476562
local_in_edges_tensor generation:  0.0008525848388671875
mini_batch_src_global generation:  0.0010516643524169922
r_  generation:  0.009571313858032227
local_output_nid generation:  0.0014529228210449219
local_in_edges_tensor generation:  0.0008068084716796875
mini_batch_src_global generation:  0.0010008811950683594
r_  generation:  0.009795188903808594
local_output_nid generation:  0.0014486312866210938
local_in_edges_tensor generation:  0.0007903575897216797
mini_batch_src_global generation:  0.0009605884552001953
r_  generation:  0.00929880142211914
local_output_nid generation:  0.0014452934265136719
local_in_edges_tensor generation:  0.0007822513580322266
mini_batch_src_global generation:  0.0009982585906982422
r_  generation:  0.010243415832519531
local_output_nid generation:  0.0014476776123046875
local_in_edges_tensor generation:  0.0007789134979248047
mini_batch_src_global generation:  0.0009729862213134766
r_  generation:  0.00979304313659668
local_output_nid generation:  0.001432180404663086
local_in_edges_tensor generation:  0.0007944107055664062
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.010126352310180664
local_output_nid generation:  0.0014367103576660156
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.000934600830078125
r_  generation:  0.00970458984375
local_output_nid generation:  0.0014467239379882812
local_in_edges_tensor generation:  0.0007560253143310547
mini_batch_src_global generation:  0.0010120868682861328
r_  generation:  0.009984016418457031
local_output_nid generation:  0.0014491081237792969
local_in_edges_tensor generation:  0.0007691383361816406
mini_batch_src_global generation:  0.0009772777557373047
r_  generation:  0.01013040542602539
local_output_nid generation:  0.0014328956604003906
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0009722709655761719
r_  generation:  0.009860515594482422
local_output_nid generation:  0.0014603137969970703
local_in_edges_tensor generation:  0.0007512569427490234
mini_batch_src_global generation:  0.0009951591491699219
r_  generation:  0.009978294372558594
local_output_nid generation:  0.0014491081237792969
local_in_edges_tensor generation:  0.0007336139678955078
mini_batch_src_global generation:  0.0009806156158447266
r_  generation:  0.009925127029418945
local_output_nid generation:  0.0014472007751464844
local_in_edges_tensor generation:  0.0007824897766113281
mini_batch_src_global generation:  0.0010399818420410156
r_  generation:  0.010533809661865234
local_output_nid generation:  0.001438140869140625
local_in_edges_tensor generation:  0.0007452964782714844
mini_batch_src_global generation:  0.001016855239868164
r_  generation:  0.010356903076171875
local_output_nid generation:  0.0014467239379882812
local_in_edges_tensor generation:  0.0007653236389160156
mini_batch_src_global generation:  0.0010495185852050781
r_  generation:  0.010567426681518555
local_output_nid generation:  0.0014483928680419922
local_in_edges_tensor generation:  0.0007600784301757812
mini_batch_src_global generation:  0.0010344982147216797
r_  generation:  0.01057744026184082
local_output_nid generation:  0.001438140869140625
local_in_edges_tensor generation:  0.0007631778717041016
mini_batch_src_global generation:  0.0010099411010742188
r_  generation:  0.010162591934204102
local_output_nid generation:  0.0014672279357910156
local_in_edges_tensor generation:  0.0007550716400146484
mini_batch_src_global generation:  0.0010290145874023438
r_  generation:  0.010236740112304688
local_output_nid generation:  0.0014491081237792969
local_in_edges_tensor generation:  0.0007460117340087891
mini_batch_src_global generation:  0.0011496543884277344
r_  generation:  0.01061868667602539
local_output_nid generation:  0.0014579296112060547
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.001055002212524414
r_  generation:  0.010665655136108398
local_output_nid generation:  0.0014617443084716797
local_in_edges_tensor generation:  0.0007519721984863281
mini_batch_src_global generation:  0.0010030269622802734
r_  generation:  0.010152578353881836
local_output_nid generation:  0.0014603137969970703
local_in_edges_tensor generation:  0.0007543563842773438
mini_batch_src_global generation:  0.0010149478912353516
r_  generation:  0.010508298873901367
local_output_nid generation:  0.0014684200286865234
local_in_edges_tensor generation:  0.0007619857788085938
mini_batch_src_global generation:  0.001064300537109375
r_  generation:  0.010718345642089844
local_output_nid generation:  0.0014905929565429688
local_in_edges_tensor generation:  0.0007617473602294922
mini_batch_src_global generation:  0.0010197162628173828
r_  generation:  0.009970664978027344
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.000736236572265625
mini_batch_src_global generation:  0.0009827613830566406
r_  generation:  0.009999513626098633
local_output_nid generation:  0.001476287841796875
local_in_edges_tensor generation:  0.0007457733154296875
mini_batch_src_global generation:  0.0010001659393310547
r_  generation:  0.010140180587768555
local_output_nid generation:  0.0014705657958984375
local_in_edges_tensor generation:  0.0007336139678955078
mini_batch_src_global generation:  0.0010151863098144531
r_  generation:  0.010405302047729492
local_output_nid generation:  0.0015134811401367188
local_in_edges_tensor generation:  0.00547480583190918
mini_batch_src_global generation:  0.0012254714965820312
r_  generation:  0.010060787200927734
local_output_nid generation:  0.001329660415649414
local_in_edges_tensor generation:  0.0007719993591308594
mini_batch_src_global generation:  0.0011086463928222656
r_  generation:  0.010272741317749023
local_output_nid generation:  0.001367807388305664
local_in_edges_tensor generation:  0.0007381439208984375
mini_batch_src_global generation:  0.0010771751403808594
r_  generation:  0.01043558120727539
----------------------check_connections_block total spend ----------------------------- 0.5468921661376953
generate_one_block  0.016559123992919922
generate_one_block  0.01572585105895996
generate_one_block  0.015337467193603516
generate_one_block  0.015416622161865234
generate_one_block  0.014799118041992188
generate_one_block  0.01604008674621582
generate_one_block  0.015001296997070312
generate_one_block  0.015424966812133789
generate_one_block  0.014633417129516602
generate_one_block  0.015354156494140625
generate_one_block  0.014990091323852539
generate_one_block  0.014641046524047852
generate_one_block  0.01491999626159668
generate_one_block  0.014732599258422852
generate_one_block  0.015552282333374023
generate_one_block  0.015154123306274414
generate_one_block  0.015460968017578125
generate_one_block  0.015300989151000977
generate_one_block  0.014874935150146484
generate_one_block  0.015141010284423828
generate_one_block  0.0157773494720459
generate_one_block  0.015811681747436523
generate_one_block  0.014888286590576172
generate_one_block  0.015290021896362305
generate_one_block  0.015860319137573242
generate_one_block  0.014790534973144531
generate_one_block  0.01461338996887207
generate_one_block  0.014928340911865234
generate_one_block  0.015199661254882812
generate_one_block  0.014759063720703125
generate_one_block  0.015287160873413086
generate_one_block  0.01493692398071289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04248666763305664
gen group dst list time:  0.024417638778686523
time for parepare:  0.019536495208740234
local_output_nid generation:  0.00536036491394043
local_in_edges_tensor generation:  0.014230489730834961
mini_batch_src_global generation:  0.017560720443725586
r_  generation:  0.16651296615600586
local_output_nid generation:  0.01020050048828125
local_in_edges_tensor generation:  0.01578998565673828
mini_batch_src_global generation:  0.022520065307617188
r_  generation:  0.17593097686767578
local_output_nid generation:  0.01018977165222168
local_in_edges_tensor generation:  0.009458780288696289
mini_batch_src_global generation:  0.02464127540588379
r_  generation:  0.173414945602417
local_output_nid generation:  0.010244607925415039
local_in_edges_tensor generation:  0.011361837387084961
mini_batch_src_global generation:  0.02207040786743164
r_  generation:  0.17763781547546387
local_output_nid generation:  0.00977778434753418
local_in_edges_tensor generation:  0.011933088302612305
mini_batch_src_global generation:  0.020627975463867188
r_  generation:  0.17367792129516602
local_output_nid generation:  0.010318756103515625
local_in_edges_tensor generation:  0.012794256210327148
mini_batch_src_global generation:  0.027404308319091797
r_  generation:  0.18902826309204102
local_output_nid generation:  0.0100555419921875
local_in_edges_tensor generation:  0.011054039001464844
mini_batch_src_global generation:  0.02220439910888672
r_  generation:  0.182647705078125
local_output_nid generation:  0.010152816772460938
local_in_edges_tensor generation:  0.011067390441894531
mini_batch_src_global generation:  0.02398991584777832
r_  generation:  0.18520069122314453
local_output_nid generation:  0.010027408599853516
local_in_edges_tensor generation:  0.01045370101928711
mini_batch_src_global generation:  0.026819944381713867
r_  generation:  0.1759333610534668
local_output_nid generation:  0.009927988052368164
local_in_edges_tensor generation:  0.010678529739379883
mini_batch_src_global generation:  0.023593902587890625
r_  generation:  0.1846001148223877
local_output_nid generation:  0.009982585906982422
local_in_edges_tensor generation:  0.010500192642211914
mini_batch_src_global generation:  0.02189922332763672
r_  generation:  0.1813054084777832
local_output_nid generation:  0.009996414184570312
local_in_edges_tensor generation:  0.010472774505615234
mini_batch_src_global generation:  0.022031068801879883
r_  generation:  0.1792469024658203
local_output_nid generation:  0.01012730598449707
local_in_edges_tensor generation:  0.01233053207397461
mini_batch_src_global generation:  0.02198338508605957
r_  generation:  0.18370795249938965
local_output_nid generation:  0.009860515594482422
local_in_edges_tensor generation:  0.009224653244018555
mini_batch_src_global generation:  0.02161717414855957
r_  generation:  0.17871618270874023
local_output_nid generation:  0.010381937026977539
local_in_edges_tensor generation:  0.011103153228759766
mini_batch_src_global generation:  0.024031877517700195
r_  generation:  0.19429659843444824
local_output_nid generation:  0.010076761245727539
local_in_edges_tensor generation:  0.010898828506469727
mini_batch_src_global generation:  0.022745370864868164
r_  generation:  0.18204188346862793
local_output_nid generation:  0.010225057601928711
local_in_edges_tensor generation:  0.011127233505249023
mini_batch_src_global generation:  0.023499011993408203
r_  generation:  0.19003677368164062
local_output_nid generation:  0.010196924209594727
local_in_edges_tensor generation:  0.010879278182983398
mini_batch_src_global generation:  0.023013591766357422
r_  generation:  0.18466687202453613
local_output_nid generation:  0.009865522384643555
local_in_edges_tensor generation:  0.01081085205078125
mini_batch_src_global generation:  0.02251410484313965
r_  generation:  0.1820535659790039
local_output_nid generation:  0.010414600372314453
local_in_edges_tensor generation:  0.01306605339050293
mini_batch_src_global generation:  0.049126386642456055
r_  generation:  0.18264198303222656
local_output_nid generation:  0.010386943817138672
local_in_edges_tensor generation:  0.014052629470825195
mini_batch_src_global generation:  0.02279829978942871
r_  generation:  0.18783330917358398
local_output_nid generation:  0.010311126708984375
local_in_edges_tensor generation:  0.01164865493774414
mini_batch_src_global generation:  0.02328634262084961
r_  generation:  0.18950128555297852
local_output_nid generation:  0.010162353515625
local_in_edges_tensor generation:  0.0094757080078125
mini_batch_src_global generation:  0.022883176803588867
r_  generation:  0.18300247192382812
local_output_nid generation:  0.01022958755493164
local_in_edges_tensor generation:  0.010664939880371094
mini_batch_src_global generation:  0.023259878158569336
r_  generation:  0.19215631484985352
local_output_nid generation:  0.009427070617675781
local_in_edges_tensor generation:  0.02220773696899414
mini_batch_src_global generation:  0.032434701919555664
r_  generation:  0.1959855556488037
local_output_nid generation:  0.007871389389038086
local_in_edges_tensor generation:  0.01154637336730957
mini_batch_src_global generation:  0.023699522018432617
r_  generation:  0.18026494979858398
local_output_nid generation:  0.007873773574829102
local_in_edges_tensor generation:  0.009966135025024414
mini_batch_src_global generation:  0.0220186710357666
r_  generation:  0.18075203895568848
local_output_nid generation:  0.008025884628295898
local_in_edges_tensor generation:  0.010465860366821289
mini_batch_src_global generation:  0.022210121154785156
r_  generation:  0.18328142166137695
local_output_nid generation:  0.008168935775756836
local_in_edges_tensor generation:  0.010545969009399414
mini_batch_src_global generation:  0.022615432739257812
r_  generation:  0.18491697311401367
local_output_nid generation:  0.007857799530029297
local_in_edges_tensor generation:  0.010041952133178711
mini_batch_src_global generation:  0.021936416625976562
r_  generation:  0.18208074569702148
local_output_nid generation:  0.00806570053100586
local_in_edges_tensor generation:  0.011362791061401367
mini_batch_src_global generation:  0.02207636833190918
r_  generation:  0.18459248542785645
local_output_nid generation:  0.00801396369934082
local_in_edges_tensor generation:  0.01012420654296875
mini_batch_src_global generation:  0.02232217788696289
r_  generation:  0.1849508285522461
----------------------check_connections_block total spend ----------------------------- 8.597989559173584
generate_one_block  0.2418956756591797
generate_one_block  0.23447489738464355
generate_one_block  0.26137256622314453
generate_one_block  0.24101662635803223
generate_one_block  0.22927212715148926
generate_one_block  0.2437140941619873
generate_one_block  0.24414777755737305
generate_one_block  0.25272345542907715
generate_one_block  0.22385478019714355
generate_one_block  0.23154640197753906
generate_one_block  0.23834633827209473
generate_one_block  0.23571252822875977
generate_one_block  0.23823094367980957
generate_one_block  0.26296305656433105
generate_one_block  0.25566983222961426
generate_one_block  0.3115501403808594
generate_one_block  0.25673675537109375
generate_one_block  0.23920750617980957
generate_one_block  0.23241138458251953
generate_one_block  0.23316645622253418
generate_one_block  0.24319076538085938
generate_one_block  0.24898648262023926
generate_one_block  0.23510360717773438
generate_one_block  0.2514986991882324
generate_one_block  0.24750232696533203
generate_one_block  0.23686504364013672
generate_one_block  0.2350912094116211
generate_one_block  0.23546695709228516
generate_one_block  0.23816680908203125
generate_one_block  0.23003077507019043
generate_one_block  0.23114299774169922
generate_one_block  0.2380084991455078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07261800765991211
gen group dst list time:  0.11685419082641602
time for parepare:  0.020242929458618164
local_output_nid generation:  0.023092269897460938
local_in_edges_tensor generation:  0.055042266845703125
mini_batch_src_global generation:  0.042084455490112305
r_  generation:  0.4234285354614258
local_output_nid generation:  0.029981613159179688
local_in_edges_tensor generation:  0.04340076446533203
mini_batch_src_global generation:  0.048525333404541016
r_  generation:  0.43579959869384766
local_output_nid generation:  0.0297396183013916
local_in_edges_tensor generation:  0.036664724349975586
mini_batch_src_global generation:  0.047463178634643555
r_  generation:  0.44687652587890625
local_output_nid generation:  0.0280759334564209
local_in_edges_tensor generation:  0.03212118148803711
mini_batch_src_global generation:  0.05159783363342285
r_  generation:  0.44603657722473145
local_output_nid generation:  0.028840065002441406
local_in_edges_tensor generation:  0.03559613227844238
mini_batch_src_global generation:  0.051247358322143555
r_  generation:  0.4590878486633301
local_output_nid generation:  0.02814650535583496
local_in_edges_tensor generation:  0.03851723670959473
mini_batch_src_global generation:  0.051756858825683594
r_  generation:  0.45819950103759766
local_output_nid generation:  0.031467437744140625
local_in_edges_tensor generation:  0.03640389442443848
mini_batch_src_global generation:  0.05104470252990723
r_  generation:  0.45034098625183105
local_output_nid generation:  0.02939295768737793
local_in_edges_tensor generation:  0.03586864471435547
mini_batch_src_global generation:  0.050104379653930664
r_  generation:  0.44938111305236816
local_output_nid generation:  0.02904987335205078
local_in_edges_tensor generation:  0.027628183364868164
mini_batch_src_global generation:  0.04972076416015625
r_  generation:  0.45206618309020996
local_output_nid generation:  0.02928018569946289
local_in_edges_tensor generation:  0.03172659873962402
mini_batch_src_global generation:  0.0500030517578125
r_  generation:  0.446610689163208
local_output_nid generation:  0.029267072677612305
local_in_edges_tensor generation:  0.03161311149597168
mini_batch_src_global generation:  0.05268096923828125
r_  generation:  0.4556705951690674
local_output_nid generation:  0.02910137176513672
local_in_edges_tensor generation:  0.028253793716430664
mini_batch_src_global generation:  0.04994010925292969
r_  generation:  0.45096325874328613
local_output_nid generation:  0.029216766357421875
local_in_edges_tensor generation:  0.04634356498718262
mini_batch_src_global generation:  0.050275325775146484
r_  generation:  0.4562516212463379
local_output_nid generation:  0.028963804244995117
local_in_edges_tensor generation:  0.028652429580688477
mini_batch_src_global generation:  0.049840688705444336
r_  generation:  0.44516682624816895
local_output_nid generation:  0.02937173843383789
local_in_edges_tensor generation:  0.028398513793945312
mini_batch_src_global generation:  0.05223441123962402
r_  generation:  0.46421003341674805
local_output_nid generation:  0.030103445053100586
local_in_edges_tensor generation:  0.04987907409667969
mini_batch_src_global generation:  0.050757646560668945
r_  generation:  0.45319700241088867
local_output_nid generation:  0.02945685386657715
local_in_edges_tensor generation:  0.030271053314208984
mini_batch_src_global generation:  0.052999258041381836
r_  generation:  0.45218920707702637
local_output_nid generation:  0.02987813949584961
local_in_edges_tensor generation:  0.03392386436462402
mini_batch_src_global generation:  0.05017733573913574
r_  generation:  0.45099902153015137
local_output_nid generation:  0.02910327911376953
local_in_edges_tensor generation:  0.029450416564941406
mini_batch_src_global generation:  0.0549321174621582
r_  generation:  0.4677109718322754
local_output_nid generation:  0.032256364822387695
local_in_edges_tensor generation:  0.03294706344604492
mini_batch_src_global generation:  0.05487322807312012
r_  generation:  0.45070600509643555
local_output_nid generation:  0.029715299606323242
local_in_edges_tensor generation:  0.03827357292175293
mini_batch_src_global generation:  0.04982495307922363
r_  generation:  0.465895414352417
local_output_nid generation:  0.0294039249420166
local_in_edges_tensor generation:  0.03468060493469238
mini_batch_src_global generation:  0.05017876625061035
r_  generation:  0.4524834156036377
local_output_nid generation:  0.02941751480102539
local_in_edges_tensor generation:  0.026720285415649414
mini_batch_src_global generation:  0.049551963806152344
r_  generation:  0.4553844928741455
local_output_nid generation:  0.029810428619384766
local_in_edges_tensor generation:  0.027200937271118164
mini_batch_src_global generation:  0.04994058609008789
r_  generation:  0.4699587821960449
local_output_nid generation:  0.029793262481689453
local_in_edges_tensor generation:  0.04221487045288086
mini_batch_src_global generation:  0.04966855049133301
r_  generation:  0.46503639221191406
local_output_nid generation:  0.02950453758239746
local_in_edges_tensor generation:  0.026814699172973633
mini_batch_src_global generation:  0.050362586975097656
r_  generation:  0.4539344310760498
local_output_nid generation:  0.029990673065185547
local_in_edges_tensor generation:  0.028971195220947266
mini_batch_src_global generation:  0.05023932456970215
r_  generation:  0.4562067985534668
local_output_nid generation:  0.02941107749938965
local_in_edges_tensor generation:  0.03820681571960449
mini_batch_src_global generation:  0.050054073333740234
r_  generation:  0.4549274444580078
local_output_nid generation:  0.029348373413085938
local_in_edges_tensor generation:  0.03033447265625
mini_batch_src_global generation:  0.05006837844848633
r_  generation:  0.4503648281097412
local_output_nid generation:  0.02923417091369629
local_in_edges_tensor generation:  0.029756784439086914
mini_batch_src_global generation:  0.050176382064819336
r_  generation:  0.45783567428588867
local_output_nid generation:  0.0291135311126709
local_in_edges_tensor generation:  0.029866456985473633
mini_batch_src_global generation:  0.04995989799499512
r_  generation:  0.4493112564086914
local_output_nid generation:  0.02929854393005371
local_in_edges_tensor generation:  0.02626204490661621
mini_batch_src_global generation:  0.05051851272583008
r_  generation:  0.4518568515777588
----------------------check_connections_block total spend ----------------------------- 21.245219945907593
generate_one_block  0.6749579906463623
generate_one_block  0.5829238891601562
generate_one_block  0.563086986541748
generate_one_block  0.58656907081604
generate_one_block  0.5903682708740234
generate_one_block  0.5802662372589111
generate_one_block  0.5820481777191162
generate_one_block  0.5785973072052002
generate_one_block  0.5667636394500732
generate_one_block  0.5639564990997314
generate_one_block  0.5718033313751221
generate_one_block  0.5653343200683594
generate_one_block  0.5942013263702393
generate_one_block  0.5727529525756836
generate_one_block  0.597750186920166
generate_one_block  0.5895171165466309
generate_one_block  0.5879168510437012
generate_one_block  0.5730903148651123
generate_one_block  0.563786506652832
generate_one_block  0.5885131359100342
generate_one_block  0.5932486057281494
generate_one_block  0.5852172374725342
generate_one_block  0.5851302146911621
generate_one_block  0.569554328918457
generate_one_block  0.58725905418396
generate_one_block  0.5617830753326416
generate_one_block  0.5692455768585205
generate_one_block  0.5741031169891357
generate_one_block  0.5881094932556152
generate_one_block  0.5741701126098633
generate_one_block  0.5682690143585205
generate_one_block  0.5692453384399414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  29.843209505081177
block generation total time  26.37860679626465
average batch blocks generation time:  0.8243314623832703
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.0853581428527832  GigaBytes
Max Memory Allocated: 0.0853581428527832  GigaBytes

torch.Size([148606, 128])
torch.Size([109191, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5369873046875 GB
    Memory Allocated: 0.21477031707763672  GigaBytes
Max Memory Allocated: 0.22001409530639648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08610391616821289  GigaBytes
Max Memory Allocated: 0.2434983253479004  GigaBytes

torch.Size([148863, 128])
torch.Size([110105, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2154388427734375  GigaBytes
Max Memory Allocated: 0.2434983253479004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08612823486328125  GigaBytes
Max Memory Allocated: 0.24535846710205078  GigaBytes

torch.Size([149264, 128])
torch.Size([110237, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2145843505859375  GigaBytes
Max Memory Allocated: 0.24535846710205078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08621788024902344  GigaBytes
Max Memory Allocated: 0.24535846710205078  GigaBytes

torch.Size([149256, 128])
torch.Size([110906, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21809720993041992  GigaBytes
Max Memory Allocated: 0.24535846710205078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08543157577514648  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([148225, 128])
torch.Size([108621, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21186256408691406  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08610868453979492  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([148683, 128])
torch.Size([110358, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21614313125610352  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08588600158691406  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([148532, 128])
torch.Size([110087, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21398544311523438  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08622980117797852  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([149085, 128])
torch.Size([110551, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21619749069213867  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08586978912353516  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([148988, 128])
torch.Size([109706, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21346044540405273  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08571147918701172  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([148526, 128])
torch.Size([109019, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21269941329956055  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08562898635864258  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([148297, 128])
torch.Size([108920, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21246004104614258  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08569097518920898  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([148609, 128])
torch.Size([109090, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21285200119018555  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08614635467529297  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([149176, 128])
torch.Size([110214, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2144184112548828  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08556318283081055  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([148495, 128])
torch.Size([108927, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21269655227661133  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08631610870361328  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([149242, 128])
torch.Size([110477, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21633577346801758  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08585834503173828  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([148662, 128])
torch.Size([110009, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21402215957641602  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08603715896606445  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([148671, 128])
torch.Size([110395, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21592187881469727  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08617591857910156  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([149220, 128])
torch.Size([110456, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21470022201538086  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08564424514770508  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([148449, 128])
torch.Size([109044, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21242666244506836  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08614969253540039  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([149207, 128])
torch.Size([110491, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21481847763061523  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08632612228393555  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

torch.Size([149355, 128])
torch.Size([110937, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21847915649414062  GigaBytes
Max Memory Allocated: 0.24909448623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08626794815063477  GigaBytes
Max Memory Allocated: 0.24929523468017578  GigaBytes

torch.Size([149123, 128])
torch.Size([110764, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21933412551879883  GigaBytes
Max Memory Allocated: 0.24929523468017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08585262298583984  GigaBytes
Max Memory Allocated: 0.25004053115844727  GigaBytes

torch.Size([148788, 128])
torch.Size([110041, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21389055252075195  GigaBytes
Max Memory Allocated: 0.25004053115844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08613920211791992  GigaBytes
Max Memory Allocated: 0.25004053115844727  GigaBytes

torch.Size([149119, 128])
torch.Size([110222, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21460485458374023  GigaBytes
Max Memory Allocated: 0.25004053115844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08629846572875977  GigaBytes
Max Memory Allocated: 0.25004053115844727  GigaBytes

torch.Size([149167, 128])
torch.Size([110717, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21934747695922852  GigaBytes
Max Memory Allocated: 0.25004053115844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08562469482421875  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148594, 128])
torch.Size([108979, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2126789093017578  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08552837371826172  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148346, 128])
torch.Size([109132, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21208620071411133  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08604907989501953  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([149144, 128])
torch.Size([109931, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2138805389404297  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08598566055297852  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148941, 128])
torch.Size([109939, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2142782211303711  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08589410781860352  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148877, 128])
torch.Size([109232, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21274518966674805  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08584165573120117  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148803, 128])
torch.Size([109634, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21364974975585938  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08583307266235352  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148687, 128])
torch.Size([109186, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21317768096923828  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03039523959159851 |0.023224398493766785 |0.026519641280174255 |9.032338857650757e-05 |0.005441024899482727 |0.0021812915802001953 |
----------------------------------------------------------pseudo_mini_loss sum 5.363707542419434
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9119443
Number of first layer input nodes during this epoch:  4763000
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.11664581298828125  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023651123046875
random selection method range initialization spend 0.004857301712036133
time for parepare:  0.016665935516357422
local_output_nid generation:  0.0012433528900146484
local_in_edges_tensor generation:  0.006447792053222656
mini_batch_src_global generation:  0.0015442371368408203
r_  generation:  0.010913372039794922
local_output_nid generation:  0.001440286636352539
local_in_edges_tensor generation:  0.0009622573852539062
mini_batch_src_global generation:  0.0013880729675292969
r_  generation:  0.010348081588745117
local_output_nid generation:  0.001481771469116211
local_in_edges_tensor generation:  0.0008668899536132812
mini_batch_src_global generation:  0.0010247230529785156
r_  generation:  0.009382009506225586
local_output_nid generation:  0.0015256404876708984
local_in_edges_tensor generation:  0.000835418701171875
mini_batch_src_global generation:  0.0009472370147705078
r_  generation:  0.009332895278930664
local_output_nid generation:  0.001445770263671875
local_in_edges_tensor generation:  0.0008034706115722656
mini_batch_src_global generation:  0.0009298324584960938
r_  generation:  0.009938955307006836
local_output_nid generation:  0.0015058517456054688
local_in_edges_tensor generation:  0.0008065700531005859
mini_batch_src_global generation:  0.0010113716125488281
r_  generation:  0.010335206985473633
local_output_nid generation:  0.0014910697937011719
local_in_edges_tensor generation:  0.00079345703125
mini_batch_src_global generation:  0.0009996891021728516
r_  generation:  0.00984954833984375
local_output_nid generation:  0.0014655590057373047
local_in_edges_tensor generation:  0.0007965564727783203
mini_batch_src_global generation:  0.0009760856628417969
r_  generation:  0.012652873992919922
local_output_nid generation:  0.0015070438385009766
local_in_edges_tensor generation:  0.0007944107055664062
mini_batch_src_global generation:  0.0009667873382568359
r_  generation:  0.009815692901611328
local_output_nid generation:  0.0014698505401611328
local_in_edges_tensor generation:  0.0007719993591308594
mini_batch_src_global generation:  0.0009701251983642578
r_  generation:  0.009963750839233398
local_output_nid generation:  0.0014791488647460938
local_in_edges_tensor generation:  0.0007724761962890625
mini_batch_src_global generation:  0.0010113716125488281
r_  generation:  0.01058197021484375
local_output_nid generation:  0.0014505386352539062
local_in_edges_tensor generation:  0.000782012939453125
mini_batch_src_global generation:  0.0011413097381591797
r_  generation:  0.010650396347045898
local_output_nid generation:  0.0014579296112060547
local_in_edges_tensor generation:  0.0007598400115966797
mini_batch_src_global generation:  0.001020669937133789
r_  generation:  0.010251998901367188
local_output_nid generation:  0.001520395278930664
local_in_edges_tensor generation:  0.0007567405700683594
mini_batch_src_global generation:  0.0010502338409423828
r_  generation:  0.010760784149169922
local_output_nid generation:  0.001482248306274414
local_in_edges_tensor generation:  0.004717111587524414
mini_batch_src_global generation:  0.0010416507720947266
r_  generation:  0.010200023651123047
local_output_nid generation:  0.0015087127685546875
local_in_edges_tensor generation:  0.0011289119720458984
mini_batch_src_global generation:  0.0010042190551757812
r_  generation:  0.010094404220581055
local_output_nid generation:  0.0014765262603759766
local_in_edges_tensor generation:  0.0008456707000732422
mini_batch_src_global generation:  0.001071929931640625
r_  generation:  0.010779619216918945
local_output_nid generation:  0.0015454292297363281
local_in_edges_tensor generation:  0.0008013248443603516
mini_batch_src_global generation:  0.0010383129119873047
r_  generation:  0.010183334350585938
local_output_nid generation:  0.001477956771850586
local_in_edges_tensor generation:  0.0007522106170654297
mini_batch_src_global generation:  0.001035451889038086
r_  generation:  0.010762214660644531
local_output_nid generation:  0.0014889240264892578
local_in_edges_tensor generation:  0.0007584095001220703
mini_batch_src_global generation:  0.0010161399841308594
r_  generation:  0.01023244857788086
local_output_nid generation:  0.0014846324920654297
local_in_edges_tensor generation:  0.0007510185241699219
mini_batch_src_global generation:  0.0010366439819335938
r_  generation:  0.014216423034667969
local_output_nid generation:  0.0027031898498535156
local_in_edges_tensor generation:  0.0020356178283691406
mini_batch_src_global generation:  0.0013604164123535156
r_  generation:  0.01127934455871582
local_output_nid generation:  0.001522064208984375
local_in_edges_tensor generation:  0.001131296157836914
mini_batch_src_global generation:  0.0010607242584228516
r_  generation:  0.010485172271728516
local_output_nid generation:  0.001489877700805664
local_in_edges_tensor generation:  0.0008213520050048828
mini_batch_src_global generation:  0.001010894775390625
r_  generation:  0.010489940643310547
local_output_nid generation:  0.001504659652709961
local_in_edges_tensor generation:  0.0007669925689697266
mini_batch_src_global generation:  0.0010159015655517578
r_  generation:  0.010300636291503906
local_output_nid generation:  0.001504659652709961
local_in_edges_tensor generation:  0.0007321834564208984
mini_batch_src_global generation:  0.0010135173797607422
r_  generation:  0.010089397430419922
local_output_nid generation:  0.001482248306274414
local_in_edges_tensor generation:  0.0007429122924804688
mini_batch_src_global generation:  0.0009717941284179688
r_  generation:  0.012682914733886719
local_output_nid generation:  0.001979351043701172
local_in_edges_tensor generation:  0.0007841587066650391
mini_batch_src_global generation:  0.00098419189453125
r_  generation:  0.010044097900390625
local_output_nid generation:  0.001516580581665039
local_in_edges_tensor generation:  0.0007958412170410156
mini_batch_src_global generation:  0.0010347366333007812
r_  generation:  0.010411262512207031
local_output_nid generation:  0.0015244483947753906
local_in_edges_tensor generation:  0.0007612705230712891
mini_batch_src_global generation:  0.0009992122650146484
r_  generation:  0.010483026504516602
local_output_nid generation:  0.0015132427215576172
local_in_edges_tensor generation:  0.0007402896881103516
mini_batch_src_global generation:  0.0010366439819335938
r_  generation:  0.011330366134643555
local_output_nid generation:  0.0014891624450683594
local_in_edges_tensor generation:  0.0007379055023193359
mini_batch_src_global generation:  0.0010731220245361328
r_  generation:  0.010667085647583008
----------------------check_connections_block total spend ----------------------------- 0.5670769214630127
generate_one_block  0.021940231323242188
generate_one_block  0.0183563232421875
generate_one_block  0.014557123184204102
generate_one_block  0.014518976211547852
generate_one_block  0.014801025390625
generate_one_block  0.015218734741210938
generate_one_block  0.014753103256225586
generate_one_block  0.014721155166625977
generate_one_block  0.014751672744750977
generate_one_block  0.014838695526123047
generate_one_block  0.01582503318786621
generate_one_block  0.016540050506591797
generate_one_block  0.015102386474609375
generate_one_block  0.01810288429260254
generate_one_block  0.018306493759155273
generate_one_block  0.015061378479003906
generate_one_block  0.01657247543334961
generate_one_block  0.01526331901550293
generate_one_block  0.015970706939697266
generate_one_block  0.015076875686645508
generate_one_block  0.015080451965332031
generate_one_block  0.01647162437438965
generate_one_block  0.015814542770385742
generate_one_block  0.014928579330444336
generate_one_block  0.015643596649169922
generate_one_block  0.014732599258422852
generate_one_block  0.014928340911865234
generate_one_block  0.014989137649536133
generate_one_block  0.01560521125793457
generate_one_block  0.01565074920654297
generate_one_block  0.01676034927368164
generate_one_block  0.014955997467041016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.055696725845336914
gen group dst list time:  0.022195100784301758
time for parepare:  0.02193307876586914
local_output_nid generation:  0.005608797073364258
local_in_edges_tensor generation:  0.025915145874023438
mini_batch_src_global generation:  0.0166165828704834
r_  generation:  0.16985869407653809
local_output_nid generation:  0.00850534439086914
local_in_edges_tensor generation:  0.015629291534423828
mini_batch_src_global generation:  0.022686243057250977
r_  generation:  0.17451047897338867
local_output_nid generation:  0.008202552795410156
local_in_edges_tensor generation:  0.031769752502441406
mini_batch_src_global generation:  0.01835918426513672
r_  generation:  0.1659560203552246
local_output_nid generation:  0.008337020874023438
local_in_edges_tensor generation:  0.010663747787475586
mini_batch_src_global generation:  0.018971920013427734
r_  generation:  0.1694784164428711
local_output_nid generation:  0.00814056396484375
local_in_edges_tensor generation:  0.012299299240112305
mini_batch_src_global generation:  0.02042698860168457
r_  generation:  0.17928051948547363
local_output_nid generation:  0.007999658584594727
local_in_edges_tensor generation:  0.011084794998168945
mini_batch_src_global generation:  0.022613525390625
r_  generation:  0.1826038360595703
local_output_nid generation:  0.007907867431640625
local_in_edges_tensor generation:  0.010864973068237305
mini_batch_src_global generation:  0.021318912506103516
r_  generation:  0.1783146858215332
local_output_nid generation:  0.007920026779174805
local_in_edges_tensor generation:  0.01238870620727539
mini_batch_src_global generation:  0.021375656127929688
r_  generation:  0.17766737937927246
local_output_nid generation:  0.009764909744262695
local_in_edges_tensor generation:  0.01089024543762207
mini_batch_src_global generation:  0.021376609802246094
r_  generation:  0.17910432815551758
local_output_nid generation:  0.008165836334228516
local_in_edges_tensor generation:  0.010879278182983398
mini_batch_src_global generation:  0.021523237228393555
r_  generation:  0.18140840530395508
local_output_nid generation:  0.008782386779785156
local_in_edges_tensor generation:  0.01295614242553711
mini_batch_src_global generation:  0.02256917953491211
r_  generation:  0.19154596328735352
local_output_nid generation:  0.008714914321899414
local_in_edges_tensor generation:  0.00988149642944336
mini_batch_src_global generation:  0.02323293685913086
r_  generation:  0.1922471523284912
local_output_nid generation:  0.008491992950439453
local_in_edges_tensor generation:  0.011176824569702148
mini_batch_src_global generation:  0.022708415985107422
r_  generation:  0.1880176067352295
local_output_nid generation:  0.008701562881469727
local_in_edges_tensor generation:  0.011272668838500977
mini_batch_src_global generation:  0.02403736114501953
r_  generation:  0.1878368854522705
local_output_nid generation:  0.008301258087158203
local_in_edges_tensor generation:  0.00962066650390625
mini_batch_src_global generation:  0.02219390869140625
r_  generation:  0.181427001953125
local_output_nid generation:  0.01264643669128418
local_in_edges_tensor generation:  0.018512964248657227
mini_batch_src_global generation:  0.023096084594726562
r_  generation:  0.19638419151306152
local_output_nid generation:  0.011089086532592773
local_in_edges_tensor generation:  0.012916803359985352
mini_batch_src_global generation:  0.025318384170532227
r_  generation:  0.1945362091064453
local_output_nid generation:  0.008799314498901367
local_in_edges_tensor generation:  0.012225627899169922
mini_batch_src_global generation:  0.02245187759399414
r_  generation:  0.18747639656066895
local_output_nid generation:  0.00892186164855957
local_in_edges_tensor generation:  0.013093948364257812
mini_batch_src_global generation:  0.023249387741088867
r_  generation:  0.18861722946166992
local_output_nid generation:  0.008410930633544922
local_in_edges_tensor generation:  0.010954856872558594
mini_batch_src_global generation:  0.022274255752563477
r_  generation:  0.19293808937072754
local_output_nid generation:  0.008148908615112305
local_in_edges_tensor generation:  0.011077404022216797
mini_batch_src_global generation:  0.023400068283081055
r_  generation:  0.1877593994140625
local_output_nid generation:  0.008543968200683594
local_in_edges_tensor generation:  0.011540412902832031
mini_batch_src_global generation:  0.02472519874572754
r_  generation:  0.19350361824035645
local_output_nid generation:  0.008501768112182617
local_in_edges_tensor generation:  0.01475667953491211
mini_batch_src_global generation:  0.02319169044494629
r_  generation:  0.19052505493164062
local_output_nid generation:  0.00832819938659668
local_in_edges_tensor generation:  0.009708166122436523
mini_batch_src_global generation:  0.022698163986206055
r_  generation:  0.18405890464782715
local_output_nid generation:  0.009223222732543945
local_in_edges_tensor generation:  0.025475502014160156
mini_batch_src_global generation:  0.023435354232788086
r_  generation:  0.18442344665527344
local_output_nid generation:  0.00804448127746582
local_in_edges_tensor generation:  0.008757829666137695
mini_batch_src_global generation:  0.022154808044433594
r_  generation:  0.18021798133850098
local_output_nid generation:  0.008152246475219727
local_in_edges_tensor generation:  0.008332967758178711
mini_batch_src_global generation:  0.022533893585205078
r_  generation:  0.18380069732666016
local_output_nid generation:  0.008031845092773438
local_in_edges_tensor generation:  0.008544445037841797
mini_batch_src_global generation:  0.02217578887939453
r_  generation:  0.17864561080932617
local_output_nid generation:  0.008283376693725586
local_in_edges_tensor generation:  0.011025667190551758
mini_batch_src_global generation:  0.022623062133789062
r_  generation:  0.18671154975891113
local_output_nid generation:  0.008315563201904297
local_in_edges_tensor generation:  0.013226032257080078
mini_batch_src_global generation:  0.02321147918701172
r_  generation:  0.18901944160461426
local_output_nid generation:  0.008563518524169922
local_in_edges_tensor generation:  0.01056814193725586
mini_batch_src_global generation:  0.025059938430786133
r_  generation:  0.19190406799316406
local_output_nid generation:  0.008177995681762695
local_in_edges_tensor generation:  0.008611679077148438
mini_batch_src_global generation:  0.022568702697753906
r_  generation:  0.18430876731872559
----------------------check_connections_block total spend ----------------------------- 8.578416585922241
generate_one_block  0.2560873031616211
generate_one_block  0.2332777976989746
generate_one_block  0.21982073783874512
generate_one_block  0.21973443031311035
generate_one_block  0.2436230182647705
generate_one_block  0.2391207218170166
generate_one_block  0.22967743873596191
generate_one_block  0.22672128677368164
generate_one_block  0.2260751724243164
generate_one_block  0.2384195327758789
generate_one_block  0.24271583557128906
generate_one_block  0.2432537078857422
generate_one_block  0.23398423194885254
generate_one_block  0.2373216152191162
generate_one_block  0.2511134147644043
generate_one_block  0.24397802352905273
generate_one_block  0.25525379180908203
generate_one_block  0.2494668960571289
generate_one_block  0.24555492401123047
generate_one_block  0.26294946670532227
generate_one_block  0.23221063613891602
generate_one_block  0.25377368927001953
generate_one_block  0.2432234287261963
generate_one_block  0.23273682594299316
generate_one_block  0.23917722702026367
generate_one_block  0.23046350479125977
generate_one_block  0.2416074275970459
generate_one_block  0.22878670692443848
generate_one_block  0.24370193481445312
generate_one_block  0.24869990348815918
generate_one_block  0.2494359016418457
generate_one_block  0.2432575225830078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07392358779907227
gen group dst list time:  0.11995220184326172
time for parepare:  0.018825531005859375
local_output_nid generation:  0.024320602416992188
local_in_edges_tensor generation:  0.052751779556274414
mini_batch_src_global generation:  0.04143071174621582
r_  generation:  0.43111443519592285
local_output_nid generation:  0.030044078826904297
local_in_edges_tensor generation:  0.04300379753112793
mini_batch_src_global generation:  0.04884696006774902
r_  generation:  0.43534326553344727
local_output_nid generation:  0.02939438819885254
local_in_edges_tensor generation:  0.03232407569885254
mini_batch_src_global generation:  0.04781746864318848
r_  generation:  0.4376990795135498
local_output_nid generation:  0.02766275405883789
local_in_edges_tensor generation:  0.035599708557128906
mini_batch_src_global generation:  0.04818892478942871
r_  generation:  0.4412970542907715
local_output_nid generation:  0.02798628807067871
local_in_edges_tensor generation:  0.03143024444580078
mini_batch_src_global generation:  0.04893970489501953
r_  generation:  0.44069504737854004
local_output_nid generation:  0.0277407169342041
local_in_edges_tensor generation:  0.03266167640686035
mini_batch_src_global generation:  0.052729129791259766
r_  generation:  0.44140124320983887
local_output_nid generation:  0.027712106704711914
local_in_edges_tensor generation:  0.03585386276245117
mini_batch_src_global generation:  0.04937028884887695
r_  generation:  0.45209479331970215
local_output_nid generation:  0.028077125549316406
local_in_edges_tensor generation:  0.038785457611083984
mini_batch_src_global generation:  0.05011177062988281
r_  generation:  0.4472947120666504
local_output_nid generation:  0.029369354248046875
local_in_edges_tensor generation:  0.03567385673522949
mini_batch_src_global generation:  0.04945182800292969
r_  generation:  0.4535796642303467
local_output_nid generation:  0.028254270553588867
local_in_edges_tensor generation:  0.03636980056762695
mini_batch_src_global generation:  0.04955339431762695
r_  generation:  0.4535558223724365
local_output_nid generation:  0.02865886688232422
local_in_edges_tensor generation:  0.0402369499206543
mini_batch_src_global generation:  0.0528559684753418
r_  generation:  0.4737882614135742
local_output_nid generation:  0.0326695442199707
local_in_edges_tensor generation:  0.04046177864074707
mini_batch_src_global generation:  0.0566403865814209
r_  generation:  0.4463639259338379
local_output_nid generation:  0.029257774353027344
local_in_edges_tensor generation:  0.03446531295776367
mini_batch_src_global generation:  0.049957990646362305
r_  generation:  0.4506804943084717
local_output_nid generation:  0.029316186904907227
local_in_edges_tensor generation:  0.03979635238647461
mini_batch_src_global generation:  0.049712181091308594
r_  generation:  0.44721317291259766
local_output_nid generation:  0.029343128204345703
local_in_edges_tensor generation:  0.028403520584106445
mini_batch_src_global generation:  0.0502619743347168
r_  generation:  0.4448235034942627
local_output_nid generation:  0.029024600982666016
local_in_edges_tensor generation:  0.0308687686920166
mini_batch_src_global generation:  0.05059242248535156
r_  generation:  0.4599883556365967
local_output_nid generation:  0.029515504837036133
local_in_edges_tensor generation:  0.0405120849609375
mini_batch_src_global generation:  0.04976081848144531
r_  generation:  0.46060800552368164
local_output_nid generation:  0.029284954071044922
local_in_edges_tensor generation:  0.028109312057495117
mini_batch_src_global generation:  0.050043344497680664
r_  generation:  0.44959044456481934
local_output_nid generation:  0.029247522354125977
local_in_edges_tensor generation:  0.03229165077209473
mini_batch_src_global generation:  0.052036285400390625
r_  generation:  0.45441555976867676
local_output_nid generation:  0.029877185821533203
local_in_edges_tensor generation:  0.03718113899230957
mini_batch_src_global generation:  0.05108284950256348
r_  generation:  0.44429516792297363
local_output_nid generation:  0.02898550033569336
local_in_edges_tensor generation:  0.02959752082824707
mini_batch_src_global generation:  0.04928469657897949
r_  generation:  0.44640469551086426
local_output_nid generation:  0.02944636344909668
local_in_edges_tensor generation:  0.04104733467102051
mini_batch_src_global generation:  0.05025124549865723
r_  generation:  0.45728611946105957
local_output_nid generation:  0.02930164337158203
local_in_edges_tensor generation:  0.0265655517578125
mini_batch_src_global generation:  0.04970383644104004
r_  generation:  0.4547286033630371
local_output_nid generation:  0.03360891342163086
local_in_edges_tensor generation:  0.03427624702453613
mini_batch_src_global generation:  0.06543970108032227
r_  generation:  0.44852471351623535
local_output_nid generation:  0.03076028823852539
local_in_edges_tensor generation:  0.03627133369445801
mini_batch_src_global generation:  0.05394482612609863
r_  generation:  0.4487645626068115
local_output_nid generation:  0.02911233901977539
local_in_edges_tensor generation:  0.029566287994384766
mini_batch_src_global generation:  0.050035715103149414
r_  generation:  0.444993257522583
local_output_nid generation:  0.029063701629638672
local_in_edges_tensor generation:  0.026098012924194336
mini_batch_src_global generation:  0.04997849464416504
r_  generation:  0.44121813774108887
local_output_nid generation:  0.028751611709594727
local_in_edges_tensor generation:  0.030097246170043945
mini_batch_src_global generation:  0.05005931854248047
r_  generation:  0.45550084114074707
local_output_nid generation:  0.02956676483154297
local_in_edges_tensor generation:  0.03412628173828125
mini_batch_src_global generation:  0.049530029296875
r_  generation:  0.4491453170776367
local_output_nid generation:  0.029074907302856445
local_in_edges_tensor generation:  0.03391623497009277
mini_batch_src_global generation:  0.05895090103149414
r_  generation:  0.44864988327026367
local_output_nid generation:  0.029400110244750977
local_in_edges_tensor generation:  0.029903173446655273
mini_batch_src_global generation:  0.05191206932067871
r_  generation:  0.45416736602783203
local_output_nid generation:  0.029143095016479492
local_in_edges_tensor generation:  0.036528587341308594
mini_batch_src_global generation:  0.051291704177856445
r_  generation:  0.44907188415527344
----------------------check_connections_block total spend ----------------------------- 21.10322880744934
generate_one_block  0.5759906768798828
generate_one_block  0.5778839588165283
generate_one_block  0.5604007244110107
generate_one_block  0.5709028244018555
generate_one_block  0.6738672256469727
generate_one_block  0.5712518692016602
generate_one_block  0.5933701992034912
generate_one_block  0.5790884494781494
generate_one_block  0.5742840766906738
generate_one_block  0.5777895450592041
generate_one_block  0.5813508033752441
generate_one_block  0.572920560836792
generate_one_block  0.5741195678710938
generate_one_block  0.5726749897003174
generate_one_block  0.5668501853942871
generate_one_block  0.5779757499694824
generate_one_block  0.5851798057556152
generate_one_block  0.5631546974182129
generate_one_block  0.587069034576416
generate_one_block  0.5607686042785645
generate_one_block  0.5816359519958496
generate_one_block  0.5916109085083008
generate_one_block  0.5908176898956299
generate_one_block  0.5856051445007324
generate_one_block  0.6188416481018066
generate_one_block  0.6014840602874756
generate_one_block  0.5771479606628418
generate_one_block  0.5766482353210449
generate_one_block  0.6091537475585938
generate_one_block  0.5971794128417969
generate_one_block  0.6252591609954834
generate_one_block  0.5774495601654053
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.11664581298828125  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

connection checking time:  29.681645393371582
block generation total time  26.41495108604431
average batch blocks generation time:  0.8254672214388847
block dataloader generation time/epoch 58.7719521522522
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0863947868347168  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148968, 128])
torch.Size([110203, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21609067916870117  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08620548248291016  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148860, 128])
torch.Size([110143, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2143411636352539  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08576488494873047  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148726, 128])
torch.Size([109022, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21212339401245117  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08580493927001953  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148752, 128])
torch.Size([109193, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21268606185913086  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08574056625366211  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148253, 128])
torch.Size([109023, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2122788429260254  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0857992172241211  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148048, 128])
torch.Size([109420, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21349382400512695  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08581876754760742  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148429, 128])
torch.Size([109065, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21311235427856445  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08594322204589844  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([148672, 128])
torch.Size([109586, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21291542053222656  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.086090087890625  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([149012, 128])
torch.Size([109818, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21384668350219727  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08612442016601562  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([149024, 128])
torch.Size([110061, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21408510208129883  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08667325973510742  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

torch.Size([149415, 128])
torch.Size([111227, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21972942352294922  GigaBytes
Max Memory Allocated: 0.25005578994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08630990982055664  GigaBytes
Max Memory Allocated: 0.2504715919494629  GigaBytes

torch.Size([148737, 128])
torch.Size([110090, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21605205535888672  GigaBytes
Max Memory Allocated: 0.2504715919494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08602094650268555  GigaBytes
Max Memory Allocated: 0.2504715919494629  GigaBytes

torch.Size([148557, 128])
torch.Size([109252, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2134995460510254  GigaBytes
Max Memory Allocated: 0.2504715919494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08655500411987305  GigaBytes
Max Memory Allocated: 0.2504715919494629  GigaBytes

torch.Size([149399, 128])
torch.Size([110751, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2186880111694336  GigaBytes
Max Memory Allocated: 0.2504715919494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08599710464477539  GigaBytes
Max Memory Allocated: 0.2504715919494629  GigaBytes

torch.Size([148739, 128])
torch.Size([109423, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21303749084472656  GigaBytes
Max Memory Allocated: 0.2504715919494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0861358642578125  GigaBytes
Max Memory Allocated: 0.2504715919494629  GigaBytes

torch.Size([148800, 128])
torch.Size([109667, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21375083923339844  GigaBytes
Max Memory Allocated: 0.2504715919494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08672142028808594  GigaBytes
Max Memory Allocated: 0.2504715919494629  GigaBytes

torch.Size([149394, 128])
torch.Size([111465, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21987342834472656  GigaBytes
Max Memory Allocated: 0.2504715919494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08623170852661133  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([148997, 128])
torch.Size([109882, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21421384811401367  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0865945816040039  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([149338, 128])
torch.Size([110319, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2164754867553711  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08583307266235352  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([148383, 128])
torch.Size([109029, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21310997009277344  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08586263656616211  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([148289, 128])
torch.Size([109425, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21285247802734375  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08656644821166992  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([149049, 128])
torch.Size([110849, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21964502334594727  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08650064468383789  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([149225, 128])
torch.Size([110389, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21646595001220703  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08611869812011719  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([148786, 128])
torch.Size([110102, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2143855094909668  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08642053604125977  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([149281, 128])
torch.Size([110607, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21839332580566406  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08592891693115234  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([148654, 128])
torch.Size([108947, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21226930618286133  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0859527587890625  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([148626, 128])
torch.Size([109223, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21303606033325195  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0855412483215332  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([148095, 128])
torch.Size([108356, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2119145393371582  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0865011215209961  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([149350, 128])
torch.Size([110585, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21520566940307617  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08576583862304688  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([147800, 128])
torch.Size([108537, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21379709243774414  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08666753768920898  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([149213, 128])
torch.Size([110900, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21982240676879883  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08615970611572266  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

torch.Size([148874, 128])
torch.Size([110179, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21443653106689453  GigaBytes
Max Memory Allocated: 0.25051307678222656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027492649853229523 |0.014541693031787872 |0.0035835430026054382 |9.018182754516602e-05 |0.004038386046886444 |0.0030782222747802734 |
----------------------------------------------------------pseudo_mini_loss sum 4.113234519958496
Total (block generation + training)time/epoch 60.411003828048706
Training time/epoch 1.6387770175933838
Training time without block to device /epoch 1.1734428405761719
Training time without total dataloading part /epoch 0.24986577033996582
load block tensor time/epoch 0.8797647953033447
block to device time/epoch 0.4653341770172119
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9116363
Number of first layer input nodes during this epoch:  4761745
