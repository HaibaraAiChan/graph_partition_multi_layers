Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648354108.3371482
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027767419815063477
random selection method range initialization spend 0.006133079528808594
time for parepare:  0.018732786178588867
local_output_nid generation:  0.004293203353881836
local_in_edges_tensor generation:  0.0064356327056884766
mini_batch_src_global generation:  0.003750324249267578
r_  generation:  0.04141354560852051
local_output_nid generation:  0.00576472282409668
local_in_edges_tensor generation:  0.003186941146850586
mini_batch_src_global generation:  0.004776954650878906
r_  generation:  0.044053077697753906
local_output_nid generation:  0.006105184555053711
local_in_edges_tensor generation:  0.0032155513763427734
mini_batch_src_global generation:  0.0032982826232910156
r_  generation:  0.046365976333618164
local_output_nid generation:  0.006073713302612305
local_in_edges_tensor generation:  0.0032439231872558594
mini_batch_src_global generation:  0.0034987926483154297
r_  generation:  0.045797109603881836
local_output_nid generation:  0.006133079528808594
local_in_edges_tensor generation:  0.0032033920288085938
mini_batch_src_global generation:  0.0036902427673339844
r_  generation:  0.04600167274475098
local_output_nid generation:  0.006021976470947266
local_in_edges_tensor generation:  0.0033299922943115234
mini_batch_src_global generation:  0.003923654556274414
r_  generation:  0.046233415603637695
local_output_nid generation:  0.006001472473144531
local_in_edges_tensor generation:  0.0032286643981933594
mini_batch_src_global generation:  0.0038383007049560547
r_  generation:  0.045711517333984375
local_output_nid generation:  0.006046295166015625
local_in_edges_tensor generation:  0.0031447410583496094
mini_batch_src_global generation:  0.0037336349487304688
r_  generation:  0.04490184783935547
----------------------check_connections_block total spend ----------------------------- 0.5699818134307861
generate_one_block  0.06116962432861328
generate_one_block  0.06207084655761719
generate_one_block  0.06210589408874512
generate_one_block  0.06162428855895996
generate_one_block  0.06580710411071777
generate_one_block  0.06180429458618164
generate_one_block  0.06092429161071777
generate_one_block  0.05982828140258789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04280519485473633
gen group dst list time:  0.016197919845581055
time for parepare:  0.019774436950683594
local_output_nid generation:  0.014615535736083984
local_in_edges_tensor generation:  0.03575730323791504
mini_batch_src_global generation:  0.034838199615478516
r_  generation:  0.3548758029937744
local_output_nid generation:  0.023756742477416992
local_in_edges_tensor generation:  0.03526139259338379
mini_batch_src_global generation:  0.04836440086364746
r_  generation:  0.3799772262573242
local_output_nid generation:  0.02355790138244629
local_in_edges_tensor generation:  0.025767803192138672
mini_batch_src_global generation:  0.044341087341308594
r_  generation:  0.378648042678833
local_output_nid generation:  0.023221254348754883
local_in_edges_tensor generation:  0.02819538116455078
mini_batch_src_global generation:  0.045470476150512695
r_  generation:  0.38011860847473145
local_output_nid generation:  0.02361130714416504
local_in_edges_tensor generation:  0.028397321701049805
mini_batch_src_global generation:  0.045978546142578125
r_  generation:  0.38013768196105957
local_output_nid generation:  0.0235445499420166
local_in_edges_tensor generation:  0.0250852108001709
mini_batch_src_global generation:  0.04559731483459473
r_  generation:  0.3858768939971924
local_output_nid generation:  0.02332901954650879
local_in_edges_tensor generation:  0.02467942237854004
mini_batch_src_global generation:  0.046111106872558594
r_  generation:  0.38063669204711914
local_output_nid generation:  0.023512601852416992
local_in_edges_tensor generation:  0.02530670166015625
mini_batch_src_global generation:  0.045809268951416016
r_  generation:  0.37061572074890137
----------------------check_connections_block total spend ----------------------------- 4.4206788539886475
generate_one_block  0.4939248561859131
generate_one_block  0.5113081932067871
generate_one_block  0.49646782875061035
generate_one_block  0.49613094329833984
generate_one_block  0.4989936351776123
generate_one_block  0.5080184936523438
generate_one_block  0.49382591247558594
generate_one_block  0.4824504852294922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0313410758972168
gen group dst list time:  0.036385297775268555
time for parepare:  0.01943373680114746
local_output_nid generation:  0.02945709228515625
local_in_edges_tensor generation:  0.044467926025390625
mini_batch_src_global generation:  0.048828840255737305
r_  generation:  0.4853949546813965
local_output_nid generation:  0.04024457931518555
local_in_edges_tensor generation:  0.05198049545288086
mini_batch_src_global generation:  0.0545961856842041
r_  generation:  0.48883557319641113
local_output_nid generation:  0.04053330421447754
local_in_edges_tensor generation:  0.04368448257446289
mini_batch_src_global generation:  0.05452680587768555
r_  generation:  0.4822728633880615
local_output_nid generation:  0.040483951568603516
local_in_edges_tensor generation:  0.038648128509521484
mini_batch_src_global generation:  0.052635908126831055
r_  generation:  0.4962739944458008
local_output_nid generation:  0.0407254695892334
local_in_edges_tensor generation:  0.04677629470825195
mini_batch_src_global generation:  0.05689263343811035
r_  generation:  0.49557971954345703
local_output_nid generation:  0.04108858108520508
local_in_edges_tensor generation:  0.03523993492126465
mini_batch_src_global generation:  0.05418825149536133
r_  generation:  0.4994161128997803
local_output_nid generation:  0.040520668029785156
local_in_edges_tensor generation:  0.04001045227050781
mini_batch_src_global generation:  0.05417609214782715
r_  generation:  0.5094852447509766
local_output_nid generation:  0.04061579704284668
local_in_edges_tensor generation:  0.034757375717163086
mini_batch_src_global generation:  0.055469512939453125
r_  generation:  0.5048768520355225
----------------------check_connections_block total spend ----------------------------- 5.944809436798096
generate_one_block  0.6202495098114014
generate_one_block  0.6283595561981201
generate_one_block  0.6224508285522461
generate_one_block  0.6246719360351562
generate_one_block  0.6289689540863037
generate_one_block  0.617849588394165
generate_one_block  0.6525468826293945
generate_one_block  0.6169576644897461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  10.365488290786743
block generation total time  8.993175268173218
average batch blocks generation time:  1.1241469085216522
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.09952735900878906  GigaBytes
Max Memory Allocated: 0.09952735900878906  GigaBytes

torch.Size([161994, 128])
torch.Size([145428, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.22148656845092773  GigaBytes
Max Memory Allocated: 0.22415733337402344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.10191202163696289  GigaBytes
Max Memory Allocated: 0.23672103881835938  GigaBytes

torch.Size([162472, 128])
torch.Size([146487, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.22565507888793945  GigaBytes
Max Memory Allocated: 0.23672103881835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10213279724121094  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162045, 128])
torch.Size([145873, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.2235126495361328  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10199832916259766  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162241, 128])
torch.Size([146191, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.2235708236694336  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10213088989257812  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162154, 128])
torch.Size([145932, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.2236156463623047  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10196781158447266  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162260, 128])
torch.Size([145970, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22360944747924805  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1018991470336914  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162179, 128])
torch.Size([146150, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.2234177589416504  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10188102722167969  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162185, 128])
torch.Size([146111, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22215652465820312  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03571602702140808 |0.05769610404968262 |0.09771844744682312 |0.00012069940567016602 |0.009144514799118042 |0.001834869384765625 |
----------------------------------------------------------pseudo_mini_loss sum 5.016146183013916
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3054563
Number of first layer input nodes during this epoch:  1297530
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.14702939987182617  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02863335609436035
random selection method range initialization spend 0.00524449348449707
time for parepare:  0.017684459686279297
local_output_nid generation:  0.004487037658691406
local_in_edges_tensor generation:  0.009474515914916992
mini_batch_src_global generation:  0.0037114620208740234
r_  generation:  0.04099011421203613
local_output_nid generation:  0.005965709686279297
local_in_edges_tensor generation:  0.0034818649291992188
mini_batch_src_global generation:  0.004843950271606445
r_  generation:  0.04409933090209961
local_output_nid generation:  0.006193399429321289
local_in_edges_tensor generation:  0.0033767223358154297
mini_batch_src_global generation:  0.0034439563751220703
r_  generation:  0.04489612579345703
local_output_nid generation:  0.006167888641357422
local_in_edges_tensor generation:  0.003334522247314453
mini_batch_src_global generation:  0.0034439563751220703
r_  generation:  0.04593825340270996
local_output_nid generation:  0.006165504455566406
local_in_edges_tensor generation:  0.003372669219970703
mini_batch_src_global generation:  0.003702402114868164
r_  generation:  0.047164201736450195
local_output_nid generation:  0.006124258041381836
local_in_edges_tensor generation:  0.0033109188079833984
mini_batch_src_global generation:  0.004018306732177734
r_  generation:  0.047545671463012695
local_output_nid generation:  0.0060884952545166016
local_in_edges_tensor generation:  0.003237009048461914
mini_batch_src_global generation:  0.0039861202239990234
r_  generation:  0.04783368110656738
local_output_nid generation:  0.006093740463256836
local_in_edges_tensor generation:  0.0033745765686035156
mini_batch_src_global generation:  0.0039331912994384766
r_  generation:  0.04797244071960449
----------------------check_connections_block total spend ----------------------------- 0.581519603729248
generate_one_block  0.05839705467224121
generate_one_block  0.0621793270111084
generate_one_block  0.062071800231933594
generate_one_block  0.061414241790771484
generate_one_block  0.06205296516418457
generate_one_block  0.06291055679321289
generate_one_block  0.06472206115722656
generate_one_block  0.0615382194519043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04060220718383789
gen group dst list time:  0.016248703002929688
time for parepare:  0.02115488052368164
local_output_nid generation:  0.014199018478393555
local_in_edges_tensor generation:  0.03635883331298828
mini_batch_src_global generation:  0.03446197509765625
r_  generation:  0.35897159576416016
local_output_nid generation:  0.02024555206298828
local_in_edges_tensor generation:  0.035146236419677734
mini_batch_src_global generation:  0.04478740692138672
r_  generation:  0.3746778964996338
local_output_nid generation:  0.019032716751098633
local_in_edges_tensor generation:  0.028830528259277344
mini_batch_src_global generation:  0.045272111892700195
r_  generation:  0.37468528747558594
local_output_nid generation:  0.01934814453125
local_in_edges_tensor generation:  0.025200605392456055
mini_batch_src_global generation:  0.045966386795043945
r_  generation:  0.3783588409423828
local_output_nid generation:  0.021116971969604492
local_in_edges_tensor generation:  0.02844095230102539
mini_batch_src_global generation:  0.04634976387023926
r_  generation:  0.3813931941986084
local_output_nid generation:  0.019835233688354492
local_in_edges_tensor generation:  0.028545141220092773
mini_batch_src_global generation:  0.04921984672546387
r_  generation:  0.389538049697876
local_output_nid generation:  0.019329547882080078
local_in_edges_tensor generation:  0.022830724716186523
mini_batch_src_global generation:  0.04671669006347656
r_  generation:  0.38494873046875
local_output_nid generation:  0.02180194854736328
local_in_edges_tensor generation:  0.022138357162475586
mini_batch_src_global generation:  0.04973554611206055
r_  generation:  0.3939230442047119
----------------------check_connections_block total spend ----------------------------- 4.440658330917358
generate_one_block  0.5171926021575928
generate_one_block  0.5041627883911133
generate_one_block  0.5195353031158447
generate_one_block  0.5078420639038086
generate_one_block  0.5073652267456055
generate_one_block  0.5050601959228516
generate_one_block  0.4910416603088379
generate_one_block  0.5302939414978027
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04899764060974121
gen group dst list time:  0.03848743438720703
time for parepare:  0.019450902938842773
local_output_nid generation:  0.029781341552734375
local_in_edges_tensor generation:  0.06686639785766602
mini_batch_src_global generation:  0.04848289489746094
r_  generation:  0.4880852699279785
local_output_nid generation:  0.03822517395019531
local_in_edges_tensor generation:  0.05298113822937012
mini_batch_src_global generation:  0.06588578224182129
r_  generation:  0.49143218994140625
local_output_nid generation:  0.039609670639038086
local_in_edges_tensor generation:  0.04987049102783203
mini_batch_src_global generation:  0.05553555488586426
r_  generation:  0.5064055919647217
local_output_nid generation:  0.03786516189575195
local_in_edges_tensor generation:  0.047534942626953125
mini_batch_src_global generation:  0.05366969108581543
r_  generation:  0.5116100311279297
local_output_nid generation:  0.03737235069274902
local_in_edges_tensor generation:  0.0350494384765625
mini_batch_src_global generation:  0.05440258979797363
r_  generation:  0.5011546611785889
local_output_nid generation:  0.03700518608093262
local_in_edges_tensor generation:  0.04256606101989746
mini_batch_src_global generation:  0.07333707809448242
r_  generation:  0.5045573711395264
local_output_nid generation:  0.03744769096374512
local_in_edges_tensor generation:  0.042934417724609375
mini_batch_src_global generation:  0.054976701736450195
r_  generation:  0.5093424320220947
local_output_nid generation:  0.03790736198425293
local_in_edges_tensor generation:  0.039340972900390625
mini_batch_src_global generation:  0.05854916572570801
r_  generation:  0.5137157440185547
----------------------check_connections_block total spend ----------------------------- 6.084608554840088
generate_one_block  0.6401975154876709
generate_one_block  0.6377675533294678
generate_one_block  0.6257033348083496
generate_one_block  0.6327214241027832
generate_one_block  0.6403405666351318
generate_one_block  0.6317799091339111
generate_one_block  0.6402051448822021
generate_one_block  0.631829023361206
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.14702939987182617  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

connection checking time:  10.525266885757446
block generation total time  9.16303825378418
average batch blocks generation time:  1.1453797817230225
block dataloader generation time/epoch 21.870078086853027
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1020965576171875  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162228, 128])
torch.Size([145823, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22309064865112305  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10236644744873047  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162127, 128])
torch.Size([145769, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22353410720825195  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1020193099975586  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162176, 128])
torch.Size([145726, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22344255447387695  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1022176742553711  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162104, 128])
torch.Size([145936, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22345638275146484  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10220813751220703  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162134, 128])
torch.Size([145794, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22360849380493164  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1021738052368164  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162237, 128])
torch.Size([145817, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22391176223754883  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10193729400634766  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162413, 128])
torch.Size([146278, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22368907928466797  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10210800170898438  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

torch.Size([162271, 128])
torch.Size([146256, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22378110885620117  GigaBytes
Max Memory Allocated: 0.24097537994384766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035547733306884766 |0.020628780126571655 |0.0034773945808410645 |9.15229320526123e-05 |0.004118114709854126 |0.0029213428497314453 |
----------------------------------------------------------pseudo_mini_loss sum 4.3325605392456055
Total (block generation + training)time/epoch 22.40505886077881
Training time/epoch 0.5347287654876709
Training time without block to device /epoch 0.36969852447509766
Training time without total dataloading part /epoch 0.06441760063171387
load block tensor time/epoch 0.2843818664550781
block to device time/epoch 0.16503024101257324
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3054055
Number of first layer input nodes during this epoch:  1297690
