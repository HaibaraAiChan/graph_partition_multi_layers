Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648355122.8853009
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024728775024414062
random selection method range initialization spend 0.006078243255615234
time for parepare:  0.018470287322998047
local_output_nid generation:  0.0161745548248291
local_in_edges_tensor generation:  0.014308691024780273
mini_batch_src_global generation:  0.013730764389038086
r_  generation:  0.16642212867736816
local_output_nid generation:  0.02162766456604004
local_in_edges_tensor generation:  0.01577591896057129
mini_batch_src_global generation:  0.016674280166625977
r_  generation:  0.17888402938842773
----------------------check_connections_block total spend ----------------------------- 0.5399951934814453
generate_one_block  0.19881606101989746
generate_one_block  0.20000100135803223
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040369272232055664
gen group dst list time:  0.007237911224365234
time for parepare:  0.019731998443603516
local_output_nid generation:  0.026391029357910156
local_in_edges_tensor generation:  0.05098390579223633
mini_batch_src_global generation:  0.04403376579284668
r_  generation:  0.48376941680908203
local_output_nid generation:  0.03663349151611328
local_in_edges_tensor generation:  0.049742698669433594
mini_batch_src_global generation:  0.05498695373535156
r_  generation:  0.4945187568664551
----------------------check_connections_block total spend ----------------------------- 1.4867229461669922
generate_one_block  0.6305978298187256
generate_one_block  0.6363496780395508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03305840492248535
gen group dst list time:  0.011491537094116211
time for parepare:  0.01884770393371582
local_output_nid generation:  0.03025078773498535
local_in_edges_tensor generation:  0.047203779220581055
mini_batch_src_global generation:  0.04619026184082031
r_  generation:  0.5152521133422852
local_output_nid generation:  0.03753995895385742
local_in_edges_tensor generation:  0.05969691276550293
mini_batch_src_global generation:  0.05668497085571289
r_  generation:  0.5209026336669922
----------------------check_connections_block total spend ----------------------------- 1.5683155059814453
generate_one_block  0.6602113246917725
generate_one_block  0.6485252380371094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  3.0550384521484375
block generation total time  2.575684070587158
average batch blocks generation time:  1.287842035293579
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10735654830932617  GigaBytes
Max Memory Allocated: 0.10735654830932617  GigaBytes

torch.Size([166444, 128])
torch.Size([162652, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.4144163131713867  GigaBytes
Max Memory Allocated: 0.4412531852722168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.11372137069702148  GigaBytes
Max Memory Allocated: 0.47615766525268555  GigaBytes

torch.Size([166390, 128])
torch.Size([162618, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4126853942871094  GigaBytes
Max Memory Allocated: 0.47615766525268555  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02860236167907715 |0.1553562879562378 |0.36531269550323486 |0.00013434886932373047 |0.021648645401000977 |0.001566171646118164 |
----------------------------------------------------------pseudo_mini_loss sum 5.219420433044434
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  927142
Number of first layer input nodes during this epoch:  332834
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.17030572891235352  GigaBytes
Max Memory Allocated: 0.47615766525268555  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01682877540588379
random selection method range initialization spend 0.0063130855560302734
time for parepare:  0.01935124397277832
local_output_nid generation:  0.01621699333190918
local_in_edges_tensor generation:  0.012714147567749023
mini_batch_src_global generation:  0.012708663940429688
r_  generation:  0.16953158378601074
local_output_nid generation:  0.021852731704711914
local_in_edges_tensor generation:  0.013828516006469727
mini_batch_src_global generation:  0.01730036735534668
r_  generation:  0.1829836368560791
----------------------check_connections_block total spend ----------------------------- 0.5473990440368652
generate_one_block  0.2038562297821045
generate_one_block  0.21109271049499512
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036110639572143555
gen group dst list time:  0.007687568664550781
time for parepare:  0.019310712814331055
local_output_nid generation:  0.023943424224853516
local_in_edges_tensor generation:  0.04827523231506348
mini_batch_src_global generation:  0.04795670509338379
r_  generation:  0.513800859451294
local_output_nid generation:  0.03554940223693848
local_in_edges_tensor generation:  0.05918145179748535
mini_batch_src_global generation:  0.06057024002075195
r_  generation:  0.5000805854797363
----------------------check_connections_block total spend ----------------------------- 1.5446052551269531
generate_one_block  0.6325342655181885
generate_one_block  0.635631799697876
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06770586967468262
gen group dst list time:  0.011969327926635742
time for parepare:  0.01903676986694336
local_output_nid generation:  0.030527114868164062
local_in_edges_tensor generation:  0.07416510581970215
mini_batch_src_global generation:  0.0499875545501709
r_  generation:  0.5142936706542969
local_output_nid generation:  0.038396358489990234
local_in_edges_tensor generation:  0.054512977600097656
mini_batch_src_global generation:  0.05998945236206055
r_  generation:  0.5204403400421143
----------------------check_connections_block total spend ----------------------------- 1.6009495258331299
generate_one_block  0.6357662677764893
generate_one_block  0.6454219818115234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.17030572891235352  GigaBytes
Max Memory Allocated: 0.47615766525268555  GigaBytes

connection checking time:  3.145554780960083
block generation total time  2.549354314804077
average batch blocks generation time:  1.2746771574020386
block dataloader generation time/epoch 7.468076944351196
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.11391496658325195  GigaBytes
Max Memory Allocated: 0.47615766525268555  GigaBytes

torch.Size([166350, 128])
torch.Size([162597, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4134969711303711  GigaBytes
Max Memory Allocated: 0.47615766525268555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.1150503158569336  GigaBytes
Max Memory Allocated: 0.47615766525268555  GigaBytes

torch.Size([166408, 128])
torch.Size([162708, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4150352478027344  GigaBytes
Max Memory Allocated: 0.47615766525268555  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04774665832519531 |0.019861936569213867 |0.005193352699279785 |0.0001131296157836914 |0.0033522844314575195 |0.0013289451599121094 |
----------------------------------------------------------pseudo_mini_loss sum 4.048175811767578
Total (block generation + training)time/epoch 7.659447431564331
Training time/epoch 0.19106197357177734
Training time without block to device /epoch 0.1513381004333496
Training time without total dataloading part /epoch 0.0186464786529541
load block tensor time/epoch 0.09549331665039062
block to device time/epoch 0.039723873138427734
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  927390
Number of first layer input nodes during this epoch:  332758
