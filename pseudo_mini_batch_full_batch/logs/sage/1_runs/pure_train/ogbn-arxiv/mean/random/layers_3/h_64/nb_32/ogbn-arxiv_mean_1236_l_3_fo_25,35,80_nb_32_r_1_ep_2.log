Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648355764.0146341
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025875091552734375
random selection method range initialization spend 0.0058383941650390625
time for parepare:  0.01884317398071289
local_output_nid generation:  0.0010919570922851562
local_in_edges_tensor generation:  0.003147125244140625
mini_batch_src_global generation:  0.0016674995422363281
r_  generation:  0.010905742645263672
local_output_nid generation:  0.0014646053314208984
local_in_edges_tensor generation:  0.0009546279907226562
mini_batch_src_global generation:  0.0015954971313476562
r_  generation:  0.009544610977172852
local_output_nid generation:  0.00146484375
local_in_edges_tensor generation:  0.0008559226989746094
mini_batch_src_global generation:  0.0010874271392822266
r_  generation:  0.009288787841796875
local_output_nid generation:  0.0014469623565673828
local_in_edges_tensor generation:  0.0008001327514648438
mini_batch_src_global generation:  0.0010182857513427734
r_  generation:  0.009489059448242188
local_output_nid generation:  0.0014519691467285156
local_in_edges_tensor generation:  0.0007996559143066406
mini_batch_src_global generation:  0.0009908676147460938
r_  generation:  0.008962154388427734
local_output_nid generation:  0.0014357566833496094
local_in_edges_tensor generation:  0.0007791519165039062
mini_batch_src_global generation:  0.0010693073272705078
r_  generation:  0.009900808334350586
local_output_nid generation:  0.0014417171478271484
local_in_edges_tensor generation:  0.0007784366607666016
mini_batch_src_global generation:  0.0009975433349609375
r_  generation:  0.009457588195800781
local_output_nid generation:  0.0014491081237792969
local_in_edges_tensor generation:  0.0007863044738769531
mini_batch_src_global generation:  0.0010426044464111328
r_  generation:  0.009834766387939453
local_output_nid generation:  0.0014581680297851562
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.0009949207305908203
r_  generation:  0.00930023193359375
local_output_nid generation:  0.0014443397521972656
local_in_edges_tensor generation:  0.0007641315460205078
mini_batch_src_global generation:  0.0010101795196533203
r_  generation:  0.009711503982543945
local_output_nid generation:  0.0014514923095703125
local_in_edges_tensor generation:  0.0007519721984863281
mini_batch_src_global generation:  0.000993490219116211
r_  generation:  0.009695291519165039
local_output_nid generation:  0.0014340877532958984
local_in_edges_tensor generation:  0.0007493495941162109
mini_batch_src_global generation:  0.0009844303131103516
r_  generation:  0.009643077850341797
local_output_nid generation:  0.0014400482177734375
local_in_edges_tensor generation:  0.0007426738739013672
mini_batch_src_global generation:  0.000982046127319336
r_  generation:  0.009731769561767578
local_output_nid generation:  0.0014524459838867188
local_in_edges_tensor generation:  0.0007674694061279297
mini_batch_src_global generation:  0.0009860992431640625
r_  generation:  0.009636878967285156
local_output_nid generation:  0.0014443397521972656
local_in_edges_tensor generation:  0.00075531005859375
mini_batch_src_global generation:  0.001033782958984375
r_  generation:  0.010193586349487305
local_output_nid generation:  0.0014641284942626953
local_in_edges_tensor generation:  0.0007555484771728516
mini_batch_src_global generation:  0.0010199546813964844
r_  generation:  0.00982522964477539
local_output_nid generation:  0.0014481544494628906
local_in_edges_tensor generation:  0.0007603168487548828
mini_batch_src_global generation:  0.0010821819305419922
r_  generation:  0.010117769241333008
local_output_nid generation:  0.0014598369598388672
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.001039266586303711
r_  generation:  0.010114669799804688
local_output_nid generation:  0.0014622211456298828
local_in_edges_tensor generation:  0.0007567405700683594
mini_batch_src_global generation:  0.0010159015655517578
r_  generation:  0.009663105010986328
local_output_nid generation:  0.0014624595642089844
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0010399818420410156
r_  generation:  0.009842157363891602
local_output_nid generation:  0.0014636516571044922
local_in_edges_tensor generation:  0.0007562637329101562
mini_batch_src_global generation:  0.0010249614715576172
r_  generation:  0.010134220123291016
local_output_nid generation:  0.0014777183532714844
local_in_edges_tensor generation:  0.0007693767547607422
mini_batch_src_global generation:  0.0010564327239990234
r_  generation:  0.010154962539672852
local_output_nid generation:  0.0014600753784179688
local_in_edges_tensor generation:  0.0007634162902832031
mini_batch_src_global generation:  0.001027822494506836
r_  generation:  0.009833097457885742
local_output_nid generation:  0.001476287841796875
local_in_edges_tensor generation:  0.0007598400115966797
mini_batch_src_global generation:  0.0010616779327392578
r_  generation:  0.010040044784545898
local_output_nid generation:  0.0014805793762207031
local_in_edges_tensor generation:  0.0007519721984863281
mini_batch_src_global generation:  0.0010573863983154297
r_  generation:  0.010193109512329102
local_output_nid generation:  0.0014643669128417969
local_in_edges_tensor generation:  0.0007405281066894531
mini_batch_src_global generation:  0.0010082721710205078
r_  generation:  0.009714126586914062
local_output_nid generation:  0.0014829635620117188
local_in_edges_tensor generation:  0.0007357597351074219
mini_batch_src_global generation:  0.001018524169921875
r_  generation:  0.009510993957519531
local_output_nid generation:  0.001463174819946289
local_in_edges_tensor generation:  0.000736236572265625
mini_batch_src_global generation:  0.001041412353515625
r_  generation:  0.00973057746887207
local_output_nid generation:  0.0014443397521972656
local_in_edges_tensor generation:  0.0007405281066894531
mini_batch_src_global generation:  0.0010750293731689453
r_  generation:  0.009912967681884766
local_output_nid generation:  0.001445770263671875
local_in_edges_tensor generation:  0.005423545837402344
mini_batch_src_global generation:  0.0012090206146240234
r_  generation:  0.009678363800048828
local_output_nid generation:  0.001325368881225586
local_in_edges_tensor generation:  0.0007786750793457031
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.0099639892578125
local_output_nid generation:  0.001377105712890625
local_in_edges_tensor generation:  0.0007295608520507812
mini_batch_src_global generation:  0.001125335693359375
r_  generation:  0.009857416152954102
----------------------check_connections_block total spend ----------------------------- 0.5329670906066895
generate_one_block  0.015475273132324219
generate_one_block  0.014910221099853516
generate_one_block  0.014726400375366211
generate_one_block  0.014742851257324219
generate_one_block  0.014162778854370117
generate_one_block  0.015381813049316406
generate_one_block  0.014558553695678711
generate_one_block  0.01493692398071289
generate_one_block  0.014491558074951172
generate_one_block  0.014970064163208008
generate_one_block  0.014645814895629883
generate_one_block  0.014166831970214844
generate_one_block  0.01443624496459961
generate_one_block  0.014275789260864258
generate_one_block  0.015114068984985352
generate_one_block  0.014684200286865234
generate_one_block  0.015016555786132812
generate_one_block  0.014849662780761719
generate_one_block  0.014336347579956055
generate_one_block  0.01479339599609375
generate_one_block  0.015174150466918945
generate_one_block  0.015251636505126953
generate_one_block  0.014447689056396484
generate_one_block  0.014748811721801758
generate_one_block  0.015185832977294922
generate_one_block  0.014419794082641602
generate_one_block  0.014232873916625977
generate_one_block  0.014596700668334961
generate_one_block  0.014868736267089844
generate_one_block  0.014366388320922852
generate_one_block  0.014826297760009766
generate_one_block  0.01448822021484375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036638498306274414
gen group dst list time:  0.023647308349609375
time for parepare:  0.019007444381713867
local_output_nid generation:  0.0051538944244384766
local_in_edges_tensor generation:  0.013214588165283203
mini_batch_src_global generation:  0.013666391372680664
r_  generation:  0.13317179679870605
local_output_nid generation:  0.009058237075805664
local_in_edges_tensor generation:  0.012433528900146484
mini_batch_src_global generation:  0.01723194122314453
r_  generation:  0.13979101181030273
local_output_nid generation:  0.008746623992919922
local_in_edges_tensor generation:  0.00989532470703125
mini_batch_src_global generation:  0.015735864639282227
r_  generation:  0.14161920547485352
local_output_nid generation:  0.008751153945922852
local_in_edges_tensor generation:  0.010924100875854492
mini_batch_src_global generation:  0.016698837280273438
r_  generation:  0.14402246475219727
local_output_nid generation:  0.008558511734008789
local_in_edges_tensor generation:  0.008504390716552734
mini_batch_src_global generation:  0.016906023025512695
r_  generation:  0.1402606964111328
local_output_nid generation:  0.008978605270385742
local_in_edges_tensor generation:  0.010136842727661133
mini_batch_src_global generation:  0.018623828887939453
r_  generation:  0.15404510498046875
local_output_nid generation:  0.008591413497924805
local_in_edges_tensor generation:  0.009945154190063477
mini_batch_src_global generation:  0.01842975616455078
r_  generation:  0.14644575119018555
local_output_nid generation:  0.008816003799438477
local_in_edges_tensor generation:  0.011361837387084961
mini_batch_src_global generation:  0.018641233444213867
r_  generation:  0.15038132667541504
local_output_nid generation:  0.008493900299072266
local_in_edges_tensor generation:  0.008627176284790039
mini_batch_src_global generation:  0.017917633056640625
r_  generation:  0.14435338973999023
local_output_nid generation:  0.008724689483642578
local_in_edges_tensor generation:  0.010880231857299805
mini_batch_src_global generation:  0.017923831939697266
r_  generation:  0.1504063606262207
local_output_nid generation:  0.00851893424987793
local_in_edges_tensor generation:  0.0097808837890625
mini_batch_src_global generation:  0.0189666748046875
r_  generation:  0.14800119400024414
local_output_nid generation:  0.008527040481567383
local_in_edges_tensor generation:  0.008677005767822266
mini_batch_src_global generation:  0.017906665802001953
r_  generation:  0.14647340774536133
local_output_nid generation:  0.008651018142700195
local_in_edges_tensor generation:  0.012055158615112305
mini_batch_src_global generation:  0.018780946731567383
r_  generation:  0.14835238456726074
local_output_nid generation:  0.008526325225830078
local_in_edges_tensor generation:  0.008520126342773438
mini_batch_src_global generation:  0.018085241317749023
r_  generation:  0.14509034156799316
local_output_nid generation:  0.008870601654052734
local_in_edges_tensor generation:  0.009947776794433594
mini_batch_src_global generation:  0.019954681396484375
r_  generation:  0.1516566276550293
local_output_nid generation:  0.008651018142700195
local_in_edges_tensor generation:  0.0112152099609375
mini_batch_src_global generation:  0.018952131271362305
r_  generation:  0.15084028244018555
local_output_nid generation:  0.00883626937866211
local_in_edges_tensor generation:  0.01008296012878418
mini_batch_src_global generation:  0.019043684005737305
r_  generation:  0.1569957733154297
local_output_nid generation:  0.00872802734375
local_in_edges_tensor generation:  0.010032415390014648
mini_batch_src_global generation:  0.018584728240966797
r_  generation:  0.15058636665344238
local_output_nid generation:  0.008465766906738281
local_in_edges_tensor generation:  0.00857686996459961
mini_batch_src_global generation:  0.01833653450012207
r_  generation:  0.14585351943969727
local_output_nid generation:  0.008718490600585938
local_in_edges_tensor generation:  0.010959386825561523
mini_batch_src_global generation:  0.019617080688476562
r_  generation:  0.1511080265045166
local_output_nid generation:  0.008909463882446289
local_in_edges_tensor generation:  0.009079456329345703
mini_batch_src_global generation:  0.018900156021118164
r_  generation:  0.15744590759277344
local_output_nid generation:  0.008915424346923828
local_in_edges_tensor generation:  0.009827375411987305
mini_batch_src_global generation:  0.019474267959594727
r_  generation:  0.15591835975646973
local_output_nid generation:  0.008558511734008789
local_in_edges_tensor generation:  0.008888721466064453
mini_batch_src_global generation:  0.018258333206176758
r_  generation:  0.16295218467712402
local_output_nid generation:  0.008884906768798828
local_in_edges_tensor generation:  0.009173393249511719
mini_batch_src_global generation:  0.0187685489654541
r_  generation:  0.15722894668579102
local_output_nid generation:  0.008959293365478516
local_in_edges_tensor generation:  0.012671947479248047
mini_batch_src_global generation:  0.0191805362701416
r_  generation:  0.15634393692016602
local_output_nid generation:  0.008578777313232422
local_in_edges_tensor generation:  0.008682966232299805
mini_batch_src_global generation:  0.018598079681396484
r_  generation:  0.14601778984069824
local_output_nid generation:  0.008478641510009766
local_in_edges_tensor generation:  0.008720636367797852
mini_batch_src_global generation:  0.017761707305908203
r_  generation:  0.15038800239562988
local_output_nid generation:  0.008696794509887695
local_in_edges_tensor generation:  0.008826255798339844
mini_batch_src_global generation:  0.01834559440612793
r_  generation:  0.15319085121154785
local_output_nid generation:  0.00889134407043457
local_in_edges_tensor generation:  0.00961446762084961
mini_batch_src_global generation:  0.018240690231323242
r_  generation:  0.15230321884155273
local_output_nid generation:  0.00858449935913086
local_in_edges_tensor generation:  0.009998321533203125
mini_batch_src_global generation:  0.01853322982788086
r_  generation:  0.1506040096282959
local_output_nid generation:  0.008739709854125977
local_in_edges_tensor generation:  0.012414216995239258
mini_batch_src_global generation:  0.018390893936157227
r_  generation:  0.14997267723083496
local_output_nid generation:  0.008697509765625
local_in_edges_tensor generation:  0.00877070426940918
mini_batch_src_global generation:  0.018301010131835938
r_  generation:  0.15143442153930664
----------------------check_connections_block total spend ----------------------------- 7.087540626525879
generate_one_block  0.18862152099609375
generate_one_block  0.1937713623046875
generate_one_block  0.2077312469482422
generate_one_block  0.19132184982299805
generate_one_block  0.1794447898864746
generate_one_block  0.19670557975769043
generate_one_block  0.19289374351501465
generate_one_block  0.19777297973632812
generate_one_block  0.180192232131958
generate_one_block  0.1857891082763672
generate_one_block  0.18602561950683594
generate_one_block  0.1880967617034912
generate_one_block  0.1921839714050293
generate_one_block  0.18713736534118652
generate_one_block  0.19744062423706055
generate_one_block  0.22200250625610352
generate_one_block  0.19656085968017578
generate_one_block  0.19034481048583984
generate_one_block  0.18797993659973145
generate_one_block  0.19949030876159668
generate_one_block  0.19651460647583008
generate_one_block  0.20026206970214844
generate_one_block  0.18491864204406738
generate_one_block  0.18801212310791016
generate_one_block  0.19782042503356934
generate_one_block  0.18462157249450684
generate_one_block  0.1812121868133545
generate_one_block  0.18595409393310547
generate_one_block  0.19332265853881836
generate_one_block  0.18951940536499023
generate_one_block  0.1892564296722412
generate_one_block  0.19642281532287598
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07719206809997559
gen group dst list time:  0.10363960266113281
time for parepare:  0.020253419876098633
local_output_nid generation:  0.021634817123413086
local_in_edges_tensor generation:  0.05312752723693848
mini_batch_src_global generation:  0.03902077674865723
r_  generation:  0.38991761207580566
local_output_nid generation:  0.028373241424560547
local_in_edges_tensor generation:  0.04089713096618652
mini_batch_src_global generation:  0.051712751388549805
r_  generation:  0.4013633728027344
local_output_nid generation:  0.028246164321899414
local_in_edges_tensor generation:  0.029661178588867188
mini_batch_src_global generation:  0.048966169357299805
r_  generation:  0.4036717414855957
local_output_nid generation:  0.026705026626586914
local_in_edges_tensor generation:  0.030222415924072266
mini_batch_src_global generation:  0.05259299278259277
r_  generation:  0.4085726737976074
local_output_nid generation:  0.02637195587158203
local_in_edges_tensor generation:  0.02529430389404297
mini_batch_src_global generation:  0.04921436309814453
r_  generation:  0.40479230880737305
local_output_nid generation:  0.02658247947692871
local_in_edges_tensor generation:  0.029885292053222656
mini_batch_src_global generation:  0.051146745681762695
r_  generation:  0.40630316734313965
local_output_nid generation:  0.026852130889892578
local_in_edges_tensor generation:  0.03692793846130371
mini_batch_src_global generation:  0.04788064956665039
r_  generation:  0.4088711738586426
local_output_nid generation:  0.027033329010009766
local_in_edges_tensor generation:  0.03366732597351074
mini_batch_src_global generation:  0.04873156547546387
r_  generation:  0.4234607219696045
local_output_nid generation:  0.027010679244995117
local_in_edges_tensor generation:  0.025908946990966797
mini_batch_src_global generation:  0.048433780670166016
r_  generation:  0.4069535732269287
local_output_nid generation:  0.026660919189453125
local_in_edges_tensor generation:  0.025679588317871094
mini_batch_src_global generation:  0.04874014854431152
r_  generation:  0.4028754234313965
local_output_nid generation:  0.026976346969604492
local_in_edges_tensor generation:  0.03285837173461914
mini_batch_src_global generation:  0.05037569999694824
r_  generation:  0.4078671932220459
local_output_nid generation:  0.02640533447265625
local_in_edges_tensor generation:  0.02599477767944336
mini_batch_src_global generation:  0.050908803939819336
r_  generation:  0.40674567222595215
local_output_nid generation:  0.028171300888061523
local_in_edges_tensor generation:  0.03538203239440918
mini_batch_src_global generation:  0.05420064926147461
r_  generation:  0.4393880367279053
local_output_nid generation:  0.029944896697998047
local_in_edges_tensor generation:  0.03115081787109375
mini_batch_src_global generation:  0.04933786392211914
r_  generation:  0.4071314334869385
local_output_nid generation:  0.028171539306640625
local_in_edges_tensor generation:  0.033672332763671875
mini_batch_src_global generation:  0.04835987091064453
r_  generation:  0.4204130172729492
local_output_nid generation:  0.027782201766967773
local_in_edges_tensor generation:  0.033141374588012695
mini_batch_src_global generation:  0.047775983810424805
r_  generation:  0.4091813564300537
local_output_nid generation:  0.027763843536376953
local_in_edges_tensor generation:  0.033942222595214844
mini_batch_src_global generation:  0.04756665229797363
r_  generation:  0.4126253128051758
local_output_nid generation:  0.027858972549438477
local_in_edges_tensor generation:  0.033705949783325195
mini_batch_src_global generation:  0.04791760444641113
r_  generation:  0.4068591594696045
local_output_nid generation:  0.027512788772583008
local_in_edges_tensor generation:  0.02658534049987793
mini_batch_src_global generation:  0.047489166259765625
r_  generation:  0.4086921215057373
local_output_nid generation:  0.02773284912109375
local_in_edges_tensor generation:  0.026332616806030273
mini_batch_src_global generation:  0.04784846305847168
r_  generation:  0.410938024520874
local_output_nid generation:  0.02809762954711914
local_in_edges_tensor generation:  0.03329920768737793
mini_batch_src_global generation:  0.04792380332946777
r_  generation:  0.41710901260375977
local_output_nid generation:  0.028075456619262695
local_in_edges_tensor generation:  0.03386998176574707
mini_batch_src_global generation:  0.04858684539794922
r_  generation:  0.41467833518981934
local_output_nid generation:  0.027868270874023438
local_in_edges_tensor generation:  0.029612302780151367
mini_batch_src_global generation:  0.047728538513183594
r_  generation:  0.4129934310913086
local_output_nid generation:  0.0277559757232666
local_in_edges_tensor generation:  0.030041217803955078
mini_batch_src_global generation:  0.05153942108154297
r_  generation:  0.41371583938598633
local_output_nid generation:  0.028001070022583008
local_in_edges_tensor generation:  0.03417181968688965
mini_batch_src_global generation:  0.04873466491699219
r_  generation:  0.41539549827575684
local_output_nid generation:  0.027686119079589844
local_in_edges_tensor generation:  0.02636122703552246
mini_batch_src_global generation:  0.04869699478149414
r_  generation:  0.4136173725128174
local_output_nid generation:  0.02739405632019043
local_in_edges_tensor generation:  0.02661752700805664
mini_batch_src_global generation:  0.0483403205871582
r_  generation:  0.4116377830505371
local_output_nid generation:  0.027676820755004883
local_in_edges_tensor generation:  0.03652381896972656
mini_batch_src_global generation:  0.0483090877532959
r_  generation:  0.409130334854126
local_output_nid generation:  0.02781081199645996
local_in_edges_tensor generation:  0.030359268188476562
mini_batch_src_global generation:  0.04800915718078613
r_  generation:  0.41070127487182617
local_output_nid generation:  0.027272701263427734
local_in_edges_tensor generation:  0.02957630157470703
mini_batch_src_global generation:  0.048197031021118164
r_  generation:  0.4094090461730957
local_output_nid generation:  0.027670860290527344
local_in_edges_tensor generation:  0.02931690216064453
mini_batch_src_global generation:  0.05043172836303711
r_  generation:  0.4203617572784424
local_output_nid generation:  0.027739524841308594
local_in_edges_tensor generation:  0.026546001434326172
mini_batch_src_global generation:  0.0482327938079834
r_  generation:  0.4067821502685547
----------------------check_connections_block total spend ----------------------------- 19.440266609191895
generate_one_block  0.6148955821990967
generate_one_block  0.5393586158752441
generate_one_block  0.5165698528289795
generate_one_block  0.5473575592041016
generate_one_block  0.5149006843566895
generate_one_block  0.5322413444519043
generate_one_block  0.5355873107910156
generate_one_block  0.5361402034759521
generate_one_block  0.5194110870361328
generate_one_block  0.5160725116729736
generate_one_block  0.520427942276001
generate_one_block  0.5260858535766602
generate_one_block  0.5366199016571045
generate_one_block  0.5110845565795898
generate_one_block  0.5373640060424805
generate_one_block  0.5319218635559082
generate_one_block  0.5430819988250732
generate_one_block  0.5238478183746338
generate_one_block  0.516770601272583
generate_one_block  0.5315496921539307
generate_one_block  0.5535197257995605
generate_one_block  0.5432255268096924
generate_one_block  0.5212991237640381
generate_one_block  0.5235085487365723
generate_one_block  0.5426526069641113
generate_one_block  0.5264143943786621
generate_one_block  0.5207734107971191
generate_one_block  0.5223128795623779
generate_one_block  0.5430455207824707
generate_one_block  0.5275163650512695
generate_one_block  0.5272262096405029
generate_one_block  0.5272610187530518
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  26.527807235717773
block generation total time  23.179388523101807
average batch blocks generation time:  0.7243558913469315
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08358335494995117  GigaBytes
Max Memory Allocated: 0.08358335494995117  GigaBytes

torch.Size([146034, 128])
torch.Size([101899, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.20594358444213867  GigaBytes
Max Memory Allocated: 0.21118593215942383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0841827392578125  GigaBytes
Max Memory Allocated: 0.23064708709716797  GigaBytes

torch.Size([146358, 128])
torch.Size([102734, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20876598358154297  GigaBytes
Max Memory Allocated: 0.23064708709716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08401012420654297  GigaBytes
Max Memory Allocated: 0.23523664474487305  GigaBytes

torch.Size([146840, 128])
torch.Size([102633, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20860815048217773  GigaBytes
Max Memory Allocated: 0.23523664474487305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08413982391357422  GigaBytes
Max Memory Allocated: 0.23523664474487305  GigaBytes

torch.Size([146857, 128])
torch.Size([103668, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20884084701538086  GigaBytes
Max Memory Allocated: 0.23523664474487305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08383750915527344  GigaBytes
Max Memory Allocated: 0.23534011840820312  GigaBytes

torch.Size([145672, 128])
torch.Size([101131, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2040691375732422  GigaBytes
Max Memory Allocated: 0.23534011840820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0842752456665039  GigaBytes
Max Memory Allocated: 0.23534011840820312  GigaBytes

torch.Size([146169, 128])
torch.Size([103105, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20953798294067383  GigaBytes
Max Memory Allocated: 0.23534011840820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08414840698242188  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([146080, 128])
torch.Size([102771, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20916986465454102  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08421802520751953  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([146572, 128])
torch.Size([103283, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20882940292358398  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08391666412353516  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([146538, 128])
torch.Size([102138, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20490646362304688  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08393192291259766  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([145895, 128])
torch.Size([101374, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20548105239868164  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08398246765136719  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([145865, 128])
torch.Size([101385, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20445871353149414  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08393001556396484  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([146253, 128])
torch.Size([101693, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20464515686035156  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08408355712890625  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([146787, 128])
torch.Size([102710, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20917940139770508  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0838470458984375  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([145994, 128])
torch.Size([101249, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20432138442993164  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08421611785888672  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([146778, 128])
torch.Size([103154, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2091350555419922  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08406257629394531  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([146164, 128])
torch.Size([102558, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2091817855834961  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08421802520751953  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([146241, 128])
torch.Size([103017, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2090001106262207  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08409881591796875  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([146539, 128])
torch.Size([102869, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20920038223266602  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08391571044921875  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([145674, 128])
torch.Size([101329, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2041778564453125  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08407974243164062  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([146880, 128])
torch.Size([103105, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2091989517211914  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08417606353759766  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([147052, 128])
torch.Size([103569, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20914745330810547  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0842580795288086  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

torch.Size([146739, 128])
torch.Size([103656, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20916748046875  GigaBytes
Max Memory Allocated: 0.2354907989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08398056030273438  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

torch.Size([146452, 128])
torch.Size([102561, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2091670036315918  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08409500122070312  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

torch.Size([146649, 128])
torch.Size([102673, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20868396759033203  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0842599868774414  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

torch.Size([146773, 128])
torch.Size([103532, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2091536521911621  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0838460922241211  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

torch.Size([146018, 128])
torch.Size([101370, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20427942276000977  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08388328552246094  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

torch.Size([145981, 128])
torch.Size([101647, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2043013572692871  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08400440216064453  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

torch.Size([146625, 128])
torch.Size([102485, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20916318893432617  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08405494689941406  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

torch.Size([146589, 128])
torch.Size([102569, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20868873596191406  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08397197723388672  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

torch.Size([146329, 128])
torch.Size([101651, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2044525146484375  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08398723602294922  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

torch.Size([146339, 128])
torch.Size([102263, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20614337921142578  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08399200439453125  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

torch.Size([146264, 128])
torch.Size([101867, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20584344863891602  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026118256151676178 |0.020997703075408936 |0.026599004864692688 |0.00010032206773757935 |0.005870595574378967 |0.0018131732940673828 |
----------------------------------------------------------pseudo_mini_loss sum 5.363399505615234
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8802654
Number of first layer input nodes during this epoch:  4684000
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.11262893676757812  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022548437118530273
random selection method range initialization spend 0.004892110824584961
time for parepare:  0.017299890518188477
local_output_nid generation:  0.0012240409851074219
local_in_edges_tensor generation:  0.0035715103149414062
mini_batch_src_global generation:  0.001558542251586914
r_  generation:  0.010621309280395508
local_output_nid generation:  0.0016334056854248047
local_in_edges_tensor generation:  0.0008938312530517578
mini_batch_src_global generation:  0.0014944076538085938
r_  generation:  0.009968042373657227
local_output_nid generation:  0.0017464160919189453
local_in_edges_tensor generation:  0.0007960796356201172
mini_batch_src_global generation:  0.0010445117950439453
r_  generation:  0.00923919677734375
local_output_nid generation:  0.0017597675323486328
local_in_edges_tensor generation:  0.0007798671722412109
mini_batch_src_global generation:  0.0009868144989013672
r_  generation:  0.009256124496459961
local_output_nid generation:  0.0017385482788085938
local_in_edges_tensor generation:  0.0007770061492919922
mini_batch_src_global generation:  0.0009865760803222656
r_  generation:  0.009403228759765625
local_output_nid generation:  0.0017304420471191406
local_in_edges_tensor generation:  0.0007584095001220703
mini_batch_src_global generation:  0.0010378360748291016
r_  generation:  0.010123729705810547
local_output_nid generation:  0.0017366409301757812
local_in_edges_tensor generation:  0.0007913112640380859
mini_batch_src_global generation:  0.001031637191772461
r_  generation:  0.009746074676513672
local_output_nid generation:  0.0017392635345458984
local_in_edges_tensor generation:  0.0007801055908203125
mini_batch_src_global generation:  0.0010004043579101562
r_  generation:  0.009717702865600586
local_output_nid generation:  0.001737356185913086
local_in_edges_tensor generation:  0.0007557868957519531
mini_batch_src_global generation:  0.0010287761688232422
r_  generation:  0.009768962860107422
local_output_nid generation:  0.0017621517181396484
local_in_edges_tensor generation:  0.0007419586181640625
mini_batch_src_global generation:  0.001085042953491211
r_  generation:  0.010067939758300781
local_output_nid generation:  0.0017735958099365234
local_in_edges_tensor generation:  0.0007655620574951172
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.010485172271728516
local_output_nid generation:  0.00176239013671875
local_in_edges_tensor generation:  0.0007588863372802734
mini_batch_src_global generation:  0.0010883808135986328
r_  generation:  0.010835409164428711
local_output_nid generation:  0.0017843246459960938
local_in_edges_tensor generation:  0.0007765293121337891
mini_batch_src_global generation:  0.0010907649993896484
r_  generation:  0.010809659957885742
local_output_nid generation:  0.0018699169158935547
local_in_edges_tensor generation:  0.0008392333984375
mini_batch_src_global generation:  0.0011768341064453125
r_  generation:  0.010517120361328125
local_output_nid generation:  0.0018079280853271484
local_in_edges_tensor generation:  0.0007736682891845703
mini_batch_src_global generation:  0.0010426044464111328
r_  generation:  0.010018348693847656
local_output_nid generation:  0.0018393993377685547
local_in_edges_tensor generation:  0.0007731914520263672
mini_batch_src_global generation:  0.0010688304901123047
r_  generation:  0.010085344314575195
local_output_nid generation:  0.001804351806640625
local_in_edges_tensor generation:  0.0008118152618408203
mini_batch_src_global generation:  0.001096963882446289
r_  generation:  0.010606527328491211
local_output_nid generation:  0.0017659664154052734
local_in_edges_tensor generation:  0.0007407665252685547
mini_batch_src_global generation:  0.001050710678100586
r_  generation:  0.01024484634399414
local_output_nid generation:  0.0018215179443359375
local_in_edges_tensor generation:  0.0007898807525634766
mini_batch_src_global generation:  0.001070261001586914
r_  generation:  0.010577678680419922
local_output_nid generation:  0.0018641948699951172
local_in_edges_tensor generation:  0.0007567405700683594
mini_batch_src_global generation:  0.0010590553283691406
r_  generation:  0.010148286819458008
local_output_nid generation:  0.001789093017578125
local_in_edges_tensor generation:  0.0007548332214355469
mini_batch_src_global generation:  0.0010547637939453125
r_  generation:  0.00984811782836914
local_output_nid generation:  0.0018146038055419922
local_in_edges_tensor generation:  0.0007700920104980469
mini_batch_src_global generation:  0.0010685920715332031
r_  generation:  0.010621786117553711
local_output_nid generation:  0.0018374919891357422
local_in_edges_tensor generation:  0.0008006095886230469
mini_batch_src_global generation:  0.0011773109436035156
r_  generation:  0.010380983352661133
local_output_nid generation:  0.0018224716186523438
local_in_edges_tensor generation:  0.0007658004760742188
mini_batch_src_global generation:  0.0010418891906738281
r_  generation:  0.010189056396484375
local_output_nid generation:  0.0018422603607177734
local_in_edges_tensor generation:  0.0007538795471191406
mini_batch_src_global generation:  0.0010349750518798828
r_  generation:  0.010408163070678711
local_output_nid generation:  0.0018224716186523438
local_in_edges_tensor generation:  0.0007383823394775391
mini_batch_src_global generation:  0.0010366439819335938
r_  generation:  0.009711980819702148
local_output_nid generation:  0.0017619132995605469
local_in_edges_tensor generation:  0.0007548332214355469
mini_batch_src_global generation:  0.0010628700256347656
r_  generation:  0.010016679763793945
local_output_nid generation:  0.0018153190612792969
local_in_edges_tensor generation:  0.0007655620574951172
mini_batch_src_global generation:  0.0010335445404052734
r_  generation:  0.010519981384277344
local_output_nid generation:  0.0018091201782226562
local_in_edges_tensor generation:  0.0007755756378173828
mini_batch_src_global generation:  0.0010612010955810547
r_  generation:  0.01025390625
local_output_nid generation:  0.0017673969268798828
local_in_edges_tensor generation:  0.000751495361328125
mini_batch_src_global generation:  0.001041412353515625
r_  generation:  0.01034855842590332
local_output_nid generation:  0.0018265247344970703
local_in_edges_tensor generation:  0.0007638931274414062
mini_batch_src_global generation:  0.0010776519775390625
r_  generation:  0.011055469512939453
local_output_nid generation:  0.00179290771484375
local_in_edges_tensor generation:  0.0007424354553222656
mini_batch_src_global generation:  0.0010461807250976562
r_  generation:  0.009845495223999023
----------------------check_connections_block total spend ----------------------------- 0.5570669174194336
generate_one_block  0.01609635353088379
generate_one_block  0.017664194107055664
generate_one_block  0.014332771301269531
generate_one_block  0.014312982559204102
generate_one_block  0.014479875564575195
generate_one_block  0.014905691146850586
generate_one_block  0.014455556869506836
generate_one_block  0.014457225799560547
generate_one_block  0.014428377151489258
generate_one_block  0.014611244201660156
generate_one_block  0.0156552791595459
generate_one_block  0.016336917877197266
generate_one_block  0.014951467514038086
generate_one_block  0.015707731246948242
generate_one_block  0.01447606086730957
generate_one_block  0.014799833297729492
generate_one_block  0.016409873962402344
generate_one_block  0.015230417251586914
generate_one_block  0.015836477279663086
generate_one_block  0.014693021774291992
generate_one_block  0.014444112777709961
generate_one_block  0.016288042068481445
generate_one_block  0.015480756759643555
generate_one_block  0.014817476272583008
generate_one_block  0.015298128128051758
generate_one_block  0.014549970626831055
generate_one_block  0.0146331787109375
generate_one_block  0.014757633209228516
generate_one_block  0.015619516372680664
generate_one_block  0.015338420867919922
generate_one_block  0.015955209732055664
generate_one_block  0.014622688293457031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03856921195983887
gen group dst list time:  0.021431684494018555
time for parepare:  0.02068352699279785
local_output_nid generation:  0.005564451217651367
local_in_edges_tensor generation:  0.01382899284362793
mini_batch_src_global generation:  0.013982534408569336
r_  generation:  0.13949346542358398
local_output_nid generation:  0.010791301727294922
local_in_edges_tensor generation:  0.014731884002685547
mini_batch_src_global generation:  0.01746535301208496
r_  generation:  0.14165258407592773
local_output_nid generation:  0.010690450668334961
local_in_edges_tensor generation:  0.03226876258850098
mini_batch_src_global generation:  0.015007972717285156
r_  generation:  0.13541722297668457
local_output_nid generation:  0.01102900505065918
local_in_edges_tensor generation:  0.010576009750366211
mini_batch_src_global generation:  0.01689457893371582
r_  generation:  0.13984346389770508
local_output_nid generation:  0.010820865631103516
local_in_edges_tensor generation:  0.010373353958129883
mini_batch_src_global generation:  0.01702117919921875
r_  generation:  0.14456629753112793
local_output_nid generation:  0.010717153549194336
local_in_edges_tensor generation:  0.010725975036621094
mini_batch_src_global generation:  0.018154621124267578
r_  generation:  0.14842891693115234
local_output_nid generation:  0.010699748992919922
local_in_edges_tensor generation:  0.011909246444702148
mini_batch_src_global generation:  0.017940521240234375
r_  generation:  0.15111708641052246
local_output_nid generation:  0.010697364807128906
local_in_edges_tensor generation:  0.02073192596435547
mini_batch_src_global generation:  0.01876068115234375
r_  generation:  0.15745329856872559
local_output_nid generation:  0.010387897491455078
local_in_edges_tensor generation:  0.012319326400756836
mini_batch_src_global generation:  0.01828622817993164
r_  generation:  0.1477949619293213
local_output_nid generation:  0.008694887161254883
local_in_edges_tensor generation:  0.01073908805847168
mini_batch_src_global generation:  0.01825881004333496
r_  generation:  0.14934349060058594
local_output_nid generation:  0.00915384292602539
local_in_edges_tensor generation:  0.01104283332824707
mini_batch_src_global generation:  0.02025294303894043
r_  generation:  0.15810918807983398
local_output_nid generation:  0.009023904800415039
local_in_edges_tensor generation:  0.008301019668579102
mini_batch_src_global generation:  0.01940321922302246
r_  generation:  0.15717434883117676
local_output_nid generation:  0.008815765380859375
local_in_edges_tensor generation:  0.00951242446899414
mini_batch_src_global generation:  0.018811941146850586
r_  generation:  0.15414857864379883
local_output_nid generation:  0.00892949104309082
local_in_edges_tensor generation:  0.009427547454833984
mini_batch_src_global generation:  0.0203244686126709
r_  generation:  0.15582036972045898
local_output_nid generation:  0.008573293685913086
local_in_edges_tensor generation:  0.007910728454589844
mini_batch_src_global generation:  0.018337011337280273
r_  generation:  0.15094685554504395
local_output_nid generation:  0.008759498596191406
local_in_edges_tensor generation:  0.00911569595336914
mini_batch_src_global generation:  0.019742727279663086
r_  generation:  0.15570282936096191
local_output_nid generation:  0.008908987045288086
local_in_edges_tensor generation:  0.009445667266845703
mini_batch_src_global generation:  0.019134044647216797
r_  generation:  0.1605827808380127
local_output_nid generation:  0.008747577667236328
local_in_edges_tensor generation:  0.009268760681152344
mini_batch_src_global generation:  0.01908421516418457
r_  generation:  0.15061044692993164
local_output_nid generation:  0.008888483047485352
local_in_edges_tensor generation:  0.009503841400146484
mini_batch_src_global generation:  0.0204012393951416
r_  generation:  0.1876065731048584
local_output_nid generation:  0.011183738708496094
local_in_edges_tensor generation:  0.008922338485717773
mini_batch_src_global generation:  0.024768352508544922
r_  generation:  0.15264320373535156
local_output_nid generation:  0.008170604705810547
local_in_edges_tensor generation:  0.009843111038208008
mini_batch_src_global generation:  0.01856255531311035
r_  generation:  0.15418577194213867
local_output_nid generation:  0.008626222610473633
local_in_edges_tensor generation:  0.011096477508544922
mini_batch_src_global generation:  0.01952195167541504
r_  generation:  0.16195893287658691
local_output_nid generation:  0.008600950241088867
local_in_edges_tensor generation:  0.009305238723754883
mini_batch_src_global generation:  0.02387833595275879
r_  generation:  0.16077947616577148
local_output_nid generation:  0.008403778076171875
local_in_edges_tensor generation:  0.009667634963989258
mini_batch_src_global generation:  0.018885135650634766
r_  generation:  0.15500950813293457
local_output_nid generation:  0.009666204452514648
local_in_edges_tensor generation:  0.01721024513244629
mini_batch_src_global generation:  0.020830869674682617
r_  generation:  0.16289925575256348
local_output_nid generation:  0.010131120681762695
local_in_edges_tensor generation:  0.00902700424194336
mini_batch_src_global generation:  0.018277883529663086
r_  generation:  0.15025711059570312
local_output_nid generation:  0.008211851119995117
local_in_edges_tensor generation:  0.008745908737182617
mini_batch_src_global generation:  0.01839733123779297
r_  generation:  0.15349078178405762
local_output_nid generation:  0.008241653442382812
local_in_edges_tensor generation:  0.00809168815612793
mini_batch_src_global generation:  0.030781030654907227
r_  generation:  0.14959073066711426
local_output_nid generation:  0.008465051651000977
local_in_edges_tensor generation:  0.008951902389526367
mini_batch_src_global generation:  0.025076627731323242
r_  generation:  0.15755438804626465
local_output_nid generation:  0.008339405059814453
local_in_edges_tensor generation:  0.010914802551269531
mini_batch_src_global generation:  0.022867918014526367
r_  generation:  0.15561652183532715
local_output_nid generation:  0.008617162704467773
local_in_edges_tensor generation:  0.008625507354736328
mini_batch_src_global generation:  0.02606201171875
r_  generation:  0.1637735366821289
local_output_nid generation:  0.009347200393676758
local_in_edges_tensor generation:  0.011155366897583008
mini_batch_src_global generation:  0.0197603702545166
r_  generation:  0.15828943252563477
----------------------check_connections_block total spend ----------------------------- 7.371652841567993
generate_one_block  0.21478581428527832
generate_one_block  0.1932210922241211
generate_one_block  0.17795825004577637
generate_one_block  0.1834549903869629
generate_one_block  0.20535731315612793
generate_one_block  0.19269275665283203
generate_one_block  0.18615055084228516
generate_one_block  0.18345904350280762
generate_one_block  0.18452882766723633
generate_one_block  0.1858961582183838
generate_one_block  0.19707179069519043
generate_one_block  0.19509530067443848
generate_one_block  0.1895148754119873
generate_one_block  0.19659757614135742
generate_one_block  0.18738961219787598
generate_one_block  0.1877889633178711
generate_one_block  0.20278239250183105
generate_one_block  0.18874049186706543
generate_one_block  0.19606924057006836
generate_one_block  0.21803689002990723
generate_one_block  0.18591785430908203
generate_one_block  0.19918417930603027
generate_one_block  0.19274187088012695
generate_one_block  0.19110894203186035
generate_one_block  0.18892288208007812
generate_one_block  0.18247246742248535
generate_one_block  0.18835949897766113
generate_one_block  0.1848762035369873
generate_one_block  0.19504952430725098
generate_one_block  0.19638395309448242
generate_one_block  0.21636676788330078
generate_one_block  0.18529200553894043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03600955009460449
gen group dst list time:  0.09914398193359375
time for parepare:  0.020176172256469727
local_output_nid generation:  0.02272772789001465
local_in_edges_tensor generation:  0.0491635799407959
mini_batch_src_global generation:  0.0403285026550293
r_  generation:  0.40363550186157227
local_output_nid generation:  0.03331589698791504
local_in_edges_tensor generation:  0.041434288024902344
mini_batch_src_global generation:  0.04818391799926758
r_  generation:  0.40297603607177734
local_output_nid generation:  0.03371405601501465
local_in_edges_tensor generation:  0.033293724060058594
mini_batch_src_global generation:  0.0468599796295166
r_  generation:  0.40595173835754395
local_output_nid generation:  0.03202533721923828
local_in_edges_tensor generation:  0.02663707733154297
mini_batch_src_global generation:  0.04726743698120117
r_  generation:  0.4004688262939453
local_output_nid generation:  0.032134294509887695
local_in_edges_tensor generation:  0.03335309028625488
mini_batch_src_global generation:  0.04694175720214844
r_  generation:  0.4189286231994629
local_output_nid generation:  0.03258252143859863
local_in_edges_tensor generation:  0.03678560256958008
mini_batch_src_global generation:  0.04833483695983887
r_  generation:  0.4150400161743164
local_output_nid generation:  0.03233766555786133
local_in_edges_tensor generation:  0.030803203582763672
mini_batch_src_global generation:  0.047820329666137695
r_  generation:  0.412844181060791
local_output_nid generation:  0.03280520439147949
local_in_edges_tensor generation:  0.030587434768676758
mini_batch_src_global generation:  0.04821920394897461
r_  generation:  0.40680980682373047
local_output_nid generation:  0.027904272079467773
local_in_edges_tensor generation:  0.02953028678894043
mini_batch_src_global generation:  0.050710439682006836
r_  generation:  0.4152951240539551
local_output_nid generation:  0.026849985122680664
local_in_edges_tensor generation:  0.03339338302612305
mini_batch_src_global generation:  0.05170440673828125
r_  generation:  0.4098687171936035
local_output_nid generation:  0.027400732040405273
local_in_edges_tensor generation:  0.03704118728637695
mini_batch_src_global generation:  0.04891061782836914
r_  generation:  0.4153754711151123
local_output_nid generation:  0.027271747589111328
local_in_edges_tensor generation:  0.02986741065979004
mini_batch_src_global generation:  0.048815250396728516
r_  generation:  0.417621374130249
local_output_nid generation:  0.027182817459106445
local_in_edges_tensor generation:  0.03431224822998047
mini_batch_src_global generation:  0.053648948669433594
r_  generation:  0.4246826171875
local_output_nid generation:  0.029016494750976562
local_in_edges_tensor generation:  0.031599998474121094
mini_batch_src_global generation:  0.052289485931396484
r_  generation:  0.4159419536590576
local_output_nid generation:  0.028714418411254883
local_in_edges_tensor generation:  0.026831865310668945
mini_batch_src_global generation:  0.04897046089172363
r_  generation:  0.41178393363952637
local_output_nid generation:  0.0279543399810791
local_in_edges_tensor generation:  0.02805805206298828
mini_batch_src_global generation:  0.04986977577209473
r_  generation:  0.41176724433898926
local_output_nid generation:  0.028307199478149414
local_in_edges_tensor generation:  0.03445291519165039
mini_batch_src_global generation:  0.04887962341308594
r_  generation:  0.41680049896240234
local_output_nid generation:  0.027971982955932617
local_in_edges_tensor generation:  0.030393362045288086
mini_batch_src_global generation:  0.049196720123291016
r_  generation:  0.41313648223876953
local_output_nid generation:  0.027819395065307617
local_in_edges_tensor generation:  0.030240535736083984
mini_batch_src_global generation:  0.051276206970214844
r_  generation:  0.4163072109222412
local_output_nid generation:  0.027755260467529297
local_in_edges_tensor generation:  0.026957035064697266
mini_batch_src_global generation:  0.049111127853393555
r_  generation:  0.40777039527893066
local_output_nid generation:  0.02767205238342285
local_in_edges_tensor generation:  0.02974104881286621
mini_batch_src_global generation:  0.048328399658203125
r_  generation:  0.41302943229675293
local_output_nid generation:  0.028209209442138672
local_in_edges_tensor generation:  0.034516096115112305
mini_batch_src_global generation:  0.05208301544189453
r_  generation:  0.4141845703125
local_output_nid generation:  0.027881145477294922
local_in_edges_tensor generation:  0.03446078300476074
mini_batch_src_global generation:  0.0483403205871582
r_  generation:  0.42580294609069824
local_output_nid generation:  0.027682065963745117
local_in_edges_tensor generation:  0.026627063751220703
mini_batch_src_global generation:  0.0496525764465332
r_  generation:  0.4109022617340088
local_output_nid generation:  0.027876615524291992
local_in_edges_tensor generation:  0.030065536499023438
mini_batch_src_global generation:  0.05091118812561035
r_  generation:  0.41629481315612793
local_output_nid generation:  0.02749347686767578
local_in_edges_tensor generation:  0.026652097702026367
mini_batch_src_global generation:  0.049550533294677734
r_  generation:  0.41068124771118164
local_output_nid generation:  0.027649879455566406
local_in_edges_tensor generation:  0.026070833206176758
mini_batch_src_global generation:  0.04792308807373047
r_  generation:  0.4153585433959961
local_output_nid generation:  0.027779102325439453
local_in_edges_tensor generation:  0.03369498252868652
mini_batch_src_global generation:  0.04819035530090332
r_  generation:  0.40607476234436035
local_output_nid generation:  0.027806997299194336
local_in_edges_tensor generation:  0.03396463394165039
mini_batch_src_global generation:  0.04823040962219238
r_  generation:  0.4186069965362549
local_output_nid generation:  0.02730250358581543
local_in_edges_tensor generation:  0.03322911262512207
mini_batch_src_global generation:  0.04944586753845215
r_  generation:  0.414076566696167
local_output_nid generation:  0.027996063232421875
local_in_edges_tensor generation:  0.03021979331970215
mini_batch_src_global generation:  0.05062127113342285
r_  generation:  0.43282604217529297
local_output_nid generation:  0.028792381286621094
local_in_edges_tensor generation:  0.029720067977905273
mini_batch_src_global generation:  0.04806637763977051
r_  generation:  0.41425490379333496
----------------------check_connections_block total spend ----------------------------- 19.645938634872437
generate_one_block  0.5555076599121094
generate_one_block  0.5416934490203857
generate_one_block  0.5248243808746338
generate_one_block  0.5221240520477295
generate_one_block  0.6212673187255859
generate_one_block  0.533776044845581
generate_one_block  0.5306031703948975
generate_one_block  0.5280849933624268
generate_one_block  0.53143310546875
generate_one_block  0.535646915435791
generate_one_block  0.5506892204284668
generate_one_block  0.5382111072540283
generate_one_block  0.5360720157623291
generate_one_block  0.5413651466369629
generate_one_block  0.5275869369506836
generate_one_block  0.5346775054931641
generate_one_block  0.5536510944366455
generate_one_block  0.5327019691467285
generate_one_block  0.5321142673492432
generate_one_block  0.525444507598877
generate_one_block  0.5353460311889648
generate_one_block  0.5417835712432861
generate_one_block  0.5635776519775391
generate_one_block  0.5265161991119385
generate_one_block  0.547144889831543
generate_one_block  0.5467262268066406
generate_one_block  0.5242860317230225
generate_one_block  0.52461838722229
generate_one_block  0.546511173248291
generate_one_block  0.5512387752532959
generate_one_block  0.5672886371612549
generate_one_block  0.5569050312042236
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.11262893676757812  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

connection checking time:  27.01759147644043
block generation total time  23.502685546875
average batch blocks generation time:  0.7344589233398438
block dataloader generation time/epoch 53.07388234138489
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08442354202270508  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

torch.Size([146418, 128])
torch.Size([102783, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20911455154418945  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08429431915283203  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

torch.Size([146403, 128])
torch.Size([102711, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2093973159790039  GigaBytes
Max Memory Allocated: 0.2355046272277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08394908905029297  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

torch.Size([146307, 128])
torch.Size([101373, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2041301727294922  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0839548110961914  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

torch.Size([146091, 128])
torch.Size([101280, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20444774627685547  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0841217041015625  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

torch.Size([145572, 128])
torch.Size([101334, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2043323516845703  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08426475524902344  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

torch.Size([145554, 128])
torch.Size([101941, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20615053176879883  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0841217041015625  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

torch.Size([145951, 128])
torch.Size([101442, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2057509422302246  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0840921401977539  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

torch.Size([146158, 128])
torch.Size([101786, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20460128784179688  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08410072326660156  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

torch.Size([146511, 128])
torch.Size([102001, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20511674880981445  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0841665267944336  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

torch.Size([146356, 128])
torch.Size([102476, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2083902359008789  GigaBytes
Max Memory Allocated: 0.23562383651733398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.084503173828125  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

torch.Size([146800, 128])
torch.Size([103927, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20939254760742188  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0844411849975586  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

torch.Size([146305, 128])
torch.Size([102702, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2094717025756836  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08426094055175781  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

torch.Size([146073, 128])
torch.Size([101863, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20607948303222656  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08438777923583984  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

torch.Size([146948, 128])
torch.Size([103455, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20929479598999023  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08412647247314453  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

torch.Size([146151, 128])
torch.Size([101626, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20468664169311523  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08428287506103516  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

torch.Size([146359, 128])
torch.Size([102394, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20644903182983398  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08456039428710938  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

torch.Size([146905, 128])
torch.Size([104143, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20964527130126953  GigaBytes
Max Memory Allocated: 0.23589277267456055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08426475524902344  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([146326, 128])
torch.Size([102504, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20940351486206055  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08446598052978516  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([147021, 128])
torch.Size([103057, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20939254760742188  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0841684341430664  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([145970, 128])
torch.Size([101715, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2059612274169922  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08421516418457031  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([145836, 128])
torch.Size([101827, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20480966567993164  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08454608917236328  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([146625, 128])
torch.Size([103513, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20964956283569336  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08442497253417969  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([146668, 128])
torch.Size([103063, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20931386947631836  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0842599868774414  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([146196, 128])
torch.Size([102656, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20940399169921875  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08432769775390625  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([146955, 128])
torch.Size([103159, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20916128158569336  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08414649963378906  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([146151, 128])
torch.Size([101578, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20446300506591797  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08417224884033203  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([146113, 128])
torch.Size([101641, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20491266250610352  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08396434783935547  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([145494, 128])
torch.Size([100438, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20277786254882812  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08435344696044922  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([146842, 128])
torch.Size([102990, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20893287658691406  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08327531814575195  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([145237, 128])
torch.Size([100948, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20373916625976562  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08456897735595703  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([146597, 128])
torch.Size([103502, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20989322662353516  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08424758911132812  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

torch.Size([146326, 128])
torch.Size([102592, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2093982696533203  GigaBytes
Max Memory Allocated: 0.23590850830078125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029380813241004944 |0.013418540358543396 |0.003709562122821808 |9.278953075408936e-05 |0.004287652671337128 |0.0028460025787353516 |
----------------------------------------------------------pseudo_mini_loss sum 4.110814571380615
Total (block generation + training)time/epoch 54.74905014038086
Training time/epoch 1.6748547554016113
Training time without block to device /epoch 1.2454614639282227
Training time without total dataloading part /epoch 0.26172614097595215
load block tensor time/epoch 0.9401860237121582
block to device time/epoch 0.42939329147338867
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8795639
Number of first layer input nodes during this epoch:  4681219
