Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648354072.7633271
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027838945388793945
random selection method range initialization spend 0.00648045539855957
time for parepare:  0.018482685089111328
local_output_nid generation:  0.008427619934082031
local_in_edges_tensor generation:  0.009320259094238281
mini_batch_src_global generation:  0.007424354553222656
r_  generation:  0.09070086479187012
local_output_nid generation:  0.011776447296142578
local_in_edges_tensor generation:  0.006308317184448242
mini_batch_src_global generation:  0.009837865829467773
r_  generation:  0.09796738624572754
local_output_nid generation:  0.01187753677368164
local_in_edges_tensor generation:  0.006405830383300781
mini_batch_src_global generation:  0.007576942443847656
r_  generation:  0.0995185375213623
local_output_nid generation:  0.011939048767089844
local_in_edges_tensor generation:  0.006239652633666992
mini_batch_src_global generation:  0.008260726928710938
r_  generation:  0.09923982620239258
----------------------check_connections_block total spend ----------------------------- 0.6006293296813965
generate_one_block  0.11520147323608398
generate_one_block  0.11539673805236816
generate_one_block  0.11550307273864746
generate_one_block  0.11247444152832031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044374942779541016
gen group dst list time:  0.01204991340637207
time for parepare:  0.01974940299987793
local_output_nid generation:  0.020731210708618164
local_in_edges_tensor generation:  0.04700422286987305
mini_batch_src_global generation:  0.045362234115600586
r_  generation:  0.4666883945465088
local_output_nid generation:  0.029610633850097656
local_in_edges_tensor generation:  0.04399919509887695
mini_batch_src_global generation:  0.06101179122924805
r_  generation:  0.48129987716674805
local_output_nid generation:  0.029717445373535156
local_in_edges_tensor generation:  0.03572368621826172
mini_batch_src_global generation:  0.05493736267089844
r_  generation:  0.4815664291381836
local_output_nid generation:  0.029388427734375
local_in_edges_tensor generation:  0.030648231506347656
mini_batch_src_global generation:  0.05719947814941406
r_  generation:  0.4858670234680176
----------------------check_connections_block total spend ----------------------------- 2.8398594856262207
generate_one_block  0.6813340187072754
generate_one_block  0.6385290622711182
generate_one_block  0.6461994647979736
generate_one_block  0.6122226715087891
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0350193977355957
gen group dst list time:  0.020914077758789062
time for parepare:  0.019196510314941406
local_output_nid generation:  0.030620813369750977
local_in_edges_tensor generation:  0.04220867156982422
mini_batch_src_global generation:  0.044481515884399414
r_  generation:  0.4899263381958008
local_output_nid generation:  0.04107999801635742
local_in_edges_tensor generation:  0.04512667655944824
mini_batch_src_global generation:  0.06834053993225098
r_  generation:  0.5042026042938232
local_output_nid generation:  0.04198098182678223
local_in_edges_tensor generation:  0.04065275192260742
mini_batch_src_global generation:  0.05962204933166504
r_  generation:  0.5037803649902344
local_output_nid generation:  0.041890859603881836
local_in_edges_tensor generation:  0.04971647262573242
mini_batch_src_global generation:  0.05603909492492676
r_  generation:  0.5083563327789307
----------------------check_connections_block total spend ----------------------------- 3.046658515930176
generate_one_block  0.6485481262207031
generate_one_block  0.6472969055175781
generate_one_block  0.6493008136749268
generate_one_block  0.6579470634460449
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  5.8865180015563965
block generation total time  5.181378126144409
average batch blocks generation time:  1.2953445315361023
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10420656204223633  GigaBytes
Max Memory Allocated: 0.10420656204223633  GigaBytes

torch.Size([165499, 128])
torch.Size([157470, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.26129150390625  GigaBytes
Max Memory Allocated: 0.2646794319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.10774469375610352  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

torch.Size([165520, 128])
torch.Size([157401, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.2604856491088867  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.10784578323364258  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

torch.Size([165518, 128])
torch.Size([157455, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.2607765197753906  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.10779523849487305  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

torch.Size([165516, 128])
torch.Size([157526, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.2595787048339844  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05053114891052246 |0.10271984338760376 |0.1943172812461853 |0.00011307001113891602 |0.017310142517089844 |0.00229644775390625 |
----------------------------------------------------------pseudo_mini_loss sum 4.997658729553223
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1722002
Number of first layer input nodes during this epoch:  662053
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.16031551361083984  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027108192443847656
random selection method range initialization spend 0.0055904388427734375
time for parepare:  0.018547534942626953
local_output_nid generation:  0.00813913345336914
local_in_edges_tensor generation:  0.0123443603515625
mini_batch_src_global generation:  0.0072400569915771484
r_  generation:  0.08857226371765137
local_output_nid generation:  0.011555194854736328
local_in_edges_tensor generation:  0.006615161895751953
mini_batch_src_global generation:  0.010175228118896484
r_  generation:  0.09652447700500488
local_output_nid generation:  0.01167607307434082
local_in_edges_tensor generation:  0.006309986114501953
mini_batch_src_global generation:  0.00790858268737793
r_  generation:  0.10150980949401855
local_output_nid generation:  0.011713266372680664
local_in_edges_tensor generation:  0.0062448978424072266
mini_batch_src_global generation:  0.008500814437866211
r_  generation:  0.1043398380279541
----------------------check_connections_block total spend ----------------------------- 0.6067640781402588
generate_one_block  0.11420083045959473
generate_one_block  0.11581897735595703
generate_one_block  0.11751985549926758
generate_one_block  0.115966796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0393681526184082
gen group dst list time:  0.011887311935424805
time for parepare:  0.019756793975830078
local_output_nid generation:  0.02005314826965332
local_in_edges_tensor generation:  0.04480385780334473
mini_batch_src_global generation:  0.04487252235412598
r_  generation:  0.4676549434661865
local_output_nid generation:  0.029270172119140625
local_in_edges_tensor generation:  0.04458260536193848
mini_batch_src_global generation:  0.058553218841552734
r_  generation:  0.4801020622253418
local_output_nid generation:  0.03081798553466797
local_in_edges_tensor generation:  0.03676152229309082
mini_batch_src_global generation:  0.05535149574279785
r_  generation:  0.48666834831237793
local_output_nid generation:  0.028919696807861328
local_in_edges_tensor generation:  0.03729581832885742
mini_batch_src_global generation:  0.05762791633605957
r_  generation:  0.4885120391845703
----------------------check_connections_block total spend ----------------------------- 2.8564858436584473
generate_one_block  0.6445250511169434
generate_one_block  0.6308624744415283
generate_one_block  0.6753120422363281
generate_one_block  0.6290311813354492
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04420733451843262
gen group dst list time:  0.02164602279663086
time for parepare:  0.01877903938293457
local_output_nid generation:  0.028878450393676758
local_in_edges_tensor generation:  0.05782508850097656
mini_batch_src_global generation:  0.04661750793457031
r_  generation:  0.5155177116394043
local_output_nid generation:  0.03669118881225586
local_in_edges_tensor generation:  0.05569171905517578
mini_batch_src_global generation:  0.0560147762298584
r_  generation:  0.49697208404541016
local_output_nid generation:  0.0367739200592041
local_in_edges_tensor generation:  0.046671390533447266
mini_batch_src_global generation:  0.056565046310424805
r_  generation:  0.5121712684631348
local_output_nid generation:  0.03729987144470215
local_in_edges_tensor generation:  0.03788471221923828
mini_batch_src_global generation:  0.05579805374145508
r_  generation:  0.5199010372161865
----------------------check_connections_block total spend ----------------------------- 3.0951075553894043
generate_one_block  0.6795213222503662
generate_one_block  0.6457886695861816
generate_one_block  0.6438407897949219
generate_one_block  0.6320295333862305
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.16031551361083984  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

connection checking time:  5.951593399047852
block generation total time  5.180911064147949
average batch blocks generation time:  1.2952277660369873
block dataloader generation time/epoch 13.160016536712646
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.10774898529052734  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

torch.Size([165435, 128])
torch.Size([157362, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.2602119445800781  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.10856294631958008  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

torch.Size([165425, 128])
torch.Size([157321, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.2603607177734375  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.10787773132324219  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

torch.Size([165566, 128])
torch.Size([157480, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.26081228256225586  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.1084895133972168  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

torch.Size([165482, 128])
torch.Size([157517, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.2605738639831543  GigaBytes
Max Memory Allocated: 0.2839508056640625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04279989004135132 |0.024246692657470703 |0.00398486852645874 |0.00010448694229125977 |0.010393738746643066 |0.0017235279083251953 |
----------------------------------------------------------pseudo_mini_loss sum 4.301124572753906
Total (block generation + training)time/epoch 13.515292882919312
Training time/epoch 0.35500526428222656
Training time without block to device /epoch 0.25801849365234375
Training time without total dataloading part /epoch 0.05965590476989746
load block tensor time/epoch 0.17119956016540527
block to device time/epoch 0.09698677062988281
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1720938
Number of first layer input nodes during this epoch:  661908
