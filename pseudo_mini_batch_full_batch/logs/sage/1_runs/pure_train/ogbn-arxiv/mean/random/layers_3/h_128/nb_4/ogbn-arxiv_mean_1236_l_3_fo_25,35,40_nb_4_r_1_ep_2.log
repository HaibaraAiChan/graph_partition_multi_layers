Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648357158.079871
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024663686752319336
random selection method range initialization spend 0.006244659423828125
time for parepare:  0.01897406578063965
local_output_nid generation:  0.008457660675048828
local_in_edges_tensor generation:  0.008864164352416992
mini_batch_src_global generation:  0.006818532943725586
r_  generation:  0.08078384399414062
local_output_nid generation:  0.011399269104003906
local_in_edges_tensor generation:  0.005927324295043945
mini_batch_src_global generation:  0.009015798568725586
r_  generation:  0.08930444717407227
local_output_nid generation:  0.011777162551879883
local_in_edges_tensor generation:  0.005952119827270508
mini_batch_src_global generation:  0.006799459457397461
r_  generation:  0.08952856063842773
local_output_nid generation:  0.01180887222290039
local_in_edges_tensor generation:  0.006089925765991211
mini_batch_src_global generation:  0.007747650146484375
r_  generation:  0.09213972091674805
----------------------check_connections_block total spend ----------------------------- 0.5543594360351562
generate_one_block  0.10088443756103516
generate_one_block  0.10361433029174805
generate_one_block  0.10274958610534668
generate_one_block  0.1024923324584961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03817129135131836
gen group dst list time:  0.011626005172729492
time for parepare:  0.019533872604370117
local_output_nid generation:  0.019098281860351562
local_in_edges_tensor generation:  0.03976631164550781
mini_batch_src_global generation:  0.04054403305053711
r_  generation:  0.39241695404052734
local_output_nid generation:  0.024851322174072266
local_in_edges_tensor generation:  0.03844261169433594
mini_batch_src_global generation:  0.04747438430786133
r_  generation:  0.40397024154663086
local_output_nid generation:  0.02463245391845703
local_in_edges_tensor generation:  0.03216958045959473
mini_batch_src_global generation:  0.04763340950012207
r_  generation:  0.4172708988189697
local_output_nid generation:  0.024622440338134766
local_in_edges_tensor generation:  0.0272829532623291
mini_batch_src_global generation:  0.04847145080566406
r_  generation:  0.4115738868713379
----------------------check_connections_block total spend ----------------------------- 2.4222187995910645
generate_one_block  0.538278341293335
generate_one_block  0.5289433002471924
generate_one_block  0.5291566848754883
generate_one_block  0.5270106792449951
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03226327896118164
gen group dst list time:  0.021001577377319336
time for parepare:  0.018477678298950195
local_output_nid generation:  0.028541088104248047
local_in_edges_tensor generation:  0.04555344581604004
mini_batch_src_global generation:  0.05039525032043457
r_  generation:  0.48857712745666504
local_output_nid generation:  0.03584766387939453
local_in_edges_tensor generation:  0.05365562438964844
mini_batch_src_global generation:  0.056311607360839844
r_  generation:  0.498096227645874
local_output_nid generation:  0.0356137752532959
local_in_edges_tensor generation:  0.04067540168762207
mini_batch_src_global generation:  0.053025245666503906
r_  generation:  0.509932279586792
local_output_nid generation:  0.035924673080444336
local_in_edges_tensor generation:  0.04500174522399902
mini_batch_src_global generation:  0.05609869956970215
r_  generation:  0.515784740447998
----------------------check_connections_block total spend ----------------------------- 3.0191233158111572
generate_one_block  0.653449535369873
generate_one_block  0.6388967037200928
generate_one_block  0.6202521324157715
generate_one_block  0.6372332572937012
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  5.441342115402222
block generation total time  4.673220634460449
average batch blocks generation time:  1.1683051586151123
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10116100311279297  GigaBytes
Max Memory Allocated: 0.10116100311279297  GigaBytes

torch.Size([164162, 128])
torch.Size([154422, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.6551761627197266  GigaBytes
Max Memory Allocated: 0.6938905715942383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4237060546875 GB
    Memory Allocated: 0.10604190826416016  GigaBytes
Max Memory Allocated: 0.7504444122314453  GigaBytes

torch.Size([164186, 128])
torch.Size([154446, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4256591796875 GB
    Memory Allocated: 0.6564054489135742  GigaBytes
Max Memory Allocated: 0.7504444122314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.10614204406738281  GigaBytes
Max Memory Allocated: 0.7522416114807129  GigaBytes

torch.Size([164248, 128])
torch.Size([154432, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.6563229560852051  GigaBytes
Max Memory Allocated: 0.7522416114807129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.10621881484985352  GigaBytes
Max Memory Allocated: 0.7522416114807129  GigaBytes

torch.Size([164407, 128])
torch.Size([154753, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.6564798355102539  GigaBytes
Max Memory Allocated: 0.7522416114807129  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04305213689804077 |0.08234214782714844 |0.1885567307472229 |0.00013142824172973633 |0.022526204586029053 |0.002022266387939453 |
----------------------------------------------------------pseudo_mini_loss sum 5.522329807281494
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1680180
Number of first layer input nodes during this epoch:  657003
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.14252948760986328  GigaBytes
Max Memory Allocated: 0.7522416114807129  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01740288734436035
random selection method range initialization spend 0.0050182342529296875
time for parepare:  0.018946409225463867
local_output_nid generation:  0.008673906326293945
local_in_edges_tensor generation:  0.00796961784362793
mini_batch_src_global generation:  0.0067462921142578125
r_  generation:  0.08074688911437988
local_output_nid generation:  0.01179814338684082
local_in_edges_tensor generation:  0.005747556686401367
mini_batch_src_global generation:  0.008858680725097656
r_  generation:  0.08574509620666504
local_output_nid generation:  0.011884689331054688
local_in_edges_tensor generation:  0.0056798458099365234
mini_batch_src_global generation:  0.0067560672760009766
r_  generation:  0.08995914459228516
local_output_nid generation:  0.01187276840209961
local_in_edges_tensor generation:  0.005742788314819336
mini_batch_src_global generation:  0.0074956417083740234
r_  generation:  0.09062004089355469
----------------------check_connections_block total spend ----------------------------- 0.5489952564239502
generate_one_block  0.10090088844299316
generate_one_block  0.10127544403076172
generate_one_block  0.10268425941467285
generate_one_block  0.10247564315795898
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03488326072692871
gen group dst list time:  0.011406898498535156
time for parepare:  0.019316673278808594
local_output_nid generation:  0.018813133239746094
local_in_edges_tensor generation:  0.040360212326049805
mini_batch_src_global generation:  0.03799295425415039
r_  generation:  0.3951990604400635
local_output_nid generation:  0.024520397186279297
local_in_edges_tensor generation:  0.0394132137298584
mini_batch_src_global generation:  0.04763507843017578
r_  generation:  0.4022655487060547
local_output_nid generation:  0.024408817291259766
local_in_edges_tensor generation:  0.028562068939208984
mini_batch_src_global generation:  0.04683399200439453
r_  generation:  0.40468835830688477
local_output_nid generation:  0.02445077896118164
local_in_edges_tensor generation:  0.028651714324951172
mini_batch_src_global generation:  0.05125284194946289
r_  generation:  0.41362953186035156
----------------------check_connections_block total spend ----------------------------- 2.4116122722625732
generate_one_block  0.5215239524841309
generate_one_block  0.5220496654510498
generate_one_block  0.5339980125427246
generate_one_block  0.522796630859375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03146028518676758
gen group dst list time:  0.020900487899780273
time for parepare:  0.021351337432861328
local_output_nid generation:  0.02902984619140625
local_in_edges_tensor generation:  0.04385995864868164
mini_batch_src_global generation:  0.04979586601257324
r_  generation:  0.4844191074371338
local_output_nid generation:  0.03621172904968262
local_in_edges_tensor generation:  0.04958176612854004
mini_batch_src_global generation:  0.05606484413146973
r_  generation:  0.49640870094299316
local_output_nid generation:  0.036554574966430664
local_in_edges_tensor generation:  0.033582448959350586
mini_batch_src_global generation:  0.052620887756347656
r_  generation:  0.5094761848449707
local_output_nid generation:  0.03628063201904297
local_in_edges_tensor generation:  0.03700423240661621
mini_batch_src_global generation:  0.05553388595581055
r_  generation:  0.5164387226104736
----------------------check_connections_block total spend ----------------------------- 2.9922738075256348
generate_one_block  0.6463258266448975
generate_one_block  0.6486213207244873
generate_one_block  0.6178605556488037
generate_one_block  0.6198792457580566
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.14252948760986328  GigaBytes
Max Memory Allocated: 0.7522416114807129  GigaBytes

connection checking time:  5.403886079788208
block generation total time  4.633055210113525
average batch blocks generation time:  1.1582638025283813
block dataloader generation time/epoch 11.808042526245117
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.10673046112060547  GigaBytes
Max Memory Allocated: 0.7522416114807129  GigaBytes

torch.Size([164214, 128])
torch.Size([154653, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.6570596694946289  GigaBytes
Max Memory Allocated: 0.7522416114807129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.10583686828613281  GigaBytes
Max Memory Allocated: 0.7524523735046387  GigaBytes

torch.Size([164211, 128])
torch.Size([154531, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.6564421653747559  GigaBytes
Max Memory Allocated: 0.7524523735046387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.10656452178955078  GigaBytes
Max Memory Allocated: 0.7525720596313477  GigaBytes

torch.Size([164118, 128])
torch.Size([154230, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.6567373275756836  GigaBytes
Max Memory Allocated: 0.7525720596313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.10686302185058594  GigaBytes
Max Memory Allocated: 0.7525720596313477  GigaBytes

torch.Size([164369, 128])
torch.Size([154770, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.657005786895752  GigaBytes
Max Memory Allocated: 0.7525720596313477  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05317443609237671 |0.013118743896484375 |0.003972411155700684 |8.893013000488281e-05 |0.00980520248413086 |0.001577138900756836 |
----------------------------------------------------------pseudo_mini_loss sum 3.546147584915161
Total (block generation + training)time/epoch 12.14439344406128
Training time/epoch 0.33621716499328613
Training time without block to device /epoch 0.28374218940734863
Training time without total dataloading part /epoch 0.05704331398010254
load block tensor time/epoch 0.21269774436950684
block to device time/epoch 0.0524749755859375
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1680352
Number of first layer input nodes during this epoch:  656912
