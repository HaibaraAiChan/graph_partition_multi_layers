Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648353569.6526313
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028116226196289062
random selection method range initialization spend 0.0065288543701171875
time for parepare:  0.01855778694152832
local_output_nid generation:  0.015979766845703125
local_in_edges_tensor generation:  0.01468658447265625
mini_batch_src_global generation:  0.01461029052734375
r_  generation:  0.18770623207092285
local_output_nid generation:  0.0212709903717041
local_in_edges_tensor generation:  0.016811132431030273
mini_batch_src_global generation:  0.019245386123657227
r_  generation:  0.19681906700134277
----------------------check_connections_block total spend ----------------------------- 0.5918536186218262
generate_one_block  0.2277534008026123
generate_one_block  0.22688579559326172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04081320762634277
gen group dst list time:  0.007608175277709961
time for parepare:  0.019072771072387695
local_output_nid generation:  0.025795459747314453
local_in_edges_tensor generation:  0.05277681350708008
mini_batch_src_global generation:  0.04679727554321289
r_  generation:  0.5019395351409912
local_output_nid generation:  0.03235578536987305
local_in_edges_tensor generation:  0.051973581314086914
mini_batch_src_global generation:  0.05705666542053223
r_  generation:  0.5149672031402588
----------------------check_connections_block total spend ----------------------------- 1.5431389808654785
generate_one_block  0.6549544334411621
generate_one_block  0.6551308631896973
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028355836868286133
gen group dst list time:  0.011404752731323242
time for parepare:  0.018685579299926758
local_output_nid generation:  0.03040337562561035
local_in_edges_tensor generation:  0.04355359077453613
mini_batch_src_global generation:  0.046190738677978516
r_  generation:  0.5067896842956543
local_output_nid generation:  0.037126779556274414
local_in_edges_tensor generation:  0.05456042289733887
mini_batch_src_global generation:  0.057537078857421875
r_  generation:  0.5175652503967285
----------------------check_connections_block total spend ----------------------------- 1.555699110031128
generate_one_block  0.67287278175354
generate_one_block  0.6527833938598633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  3.0988380908966064
block generation total time  2.6357414722442627
average batch blocks generation time:  1.3178707361221313
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10776472091674805  GigaBytes
Max Memory Allocated: 0.10776472091674805  GigaBytes

torch.Size([166689, 128])
torch.Size([163435, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.2951931953430176  GigaBytes
Max Memory Allocated: 0.301969051361084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.11438322067260742  GigaBytes
Max Memory Allocated: 0.32103490829467773  GigaBytes

torch.Size([166733, 128])
torch.Size([163417, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.29122114181518555  GigaBytes
Max Memory Allocated: 0.32103490829467773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.045929789543151855 |0.15618538856506348 |0.3677304983139038 |0.00013720989227294922 |0.03476142883300781 |0.003952741622924805 |
----------------------------------------------------------pseudo_mini_loss sum 4.963130950927734
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  938856
Number of first layer input nodes during this epoch:  333422
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.1735215187072754  GigaBytes
Max Memory Allocated: 0.32103490829467773  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03791689872741699
random selection method range initialization spend 0.0061185359954833984
time for parepare:  0.019173145294189453
local_output_nid generation:  0.016512632369995117
local_in_edges_tensor generation:  0.023339033126831055
mini_batch_src_global generation:  0.0160067081451416
r_  generation:  0.18401718139648438
local_output_nid generation:  0.021854877471923828
local_in_edges_tensor generation:  0.016127824783325195
mini_batch_src_global generation:  0.01966118812561035
r_  generation:  0.19881010055541992
----------------------check_connections_block total spend ----------------------------- 0.6019778251647949
generate_one_block  0.2225172519683838
generate_one_block  0.225083589553833
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.055190324783325195
gen group dst list time:  0.007744312286376953
time for parepare:  0.019895315170288086
local_output_nid generation:  0.02593994140625
local_in_edges_tensor generation:  0.059056997299194336
mini_batch_src_global generation:  0.051782846450805664
r_  generation:  0.5022139549255371
local_output_nid generation:  0.03644824028015137
local_in_edges_tensor generation:  0.05217480659484863
mini_batch_src_global generation:  0.07022404670715332
r_  generation:  0.5211536884307861
----------------------check_connections_block total spend ----------------------------- 1.5803050994873047
generate_one_block  0.6746702194213867
generate_one_block  0.6678266525268555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038605451583862305
gen group dst list time:  0.012667417526245117
time for parepare:  0.019273996353149414
local_output_nid generation:  0.03046584129333496
local_in_edges_tensor generation:  0.051130056381225586
mini_batch_src_global generation:  0.04759860038757324
r_  generation:  0.5133376121520996
local_output_nid generation:  0.03791689872741699
local_in_edges_tensor generation:  0.05070757865905762
mini_batch_src_global generation:  0.06575489044189453
r_  generation:  0.5497033596038818
----------------------check_connections_block total spend ----------------------------- 1.616560697555542
generate_one_block  0.6726391315460205
generate_one_block  0.6811790466308594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.1735215187072754  GigaBytes
Max Memory Allocated: 0.32103490829467773  GigaBytes

connection checking time:  3.1968657970428467
block generation total time  2.696315050125122
average batch blocks generation time:  1.348157525062561
block dataloader generation time/epoch 7.86834454536438
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.11561250686645508  GigaBytes
Max Memory Allocated: 0.32103490829467773  GigaBytes

torch.Size([166665, 128])
torch.Size([163287, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.29352807998657227  GigaBytes
Max Memory Allocated: 0.32103490829467773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.11565542221069336  GigaBytes
Max Memory Allocated: 0.32103490829467773  GigaBytes

torch.Size([166733, 128])
torch.Size([163400, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.29566335678100586  GigaBytes
Max Memory Allocated: 0.32103490829467773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.042238712310791016 |0.02489316463470459 |0.004044651985168457 |0.00010824203491210938 |0.005332469940185547 |0.0014853477478027344 |
----------------------------------------------------------pseudo_mini_loss sum 4.266175270080566
Total (block generation + training)time/epoch 8.05263376235962
Training time/epoch 0.1840345859527588
Training time without block to device /epoch 0.1342482566833496
Training time without total dataloading part /epoch 0.02045607566833496
load block tensor time/epoch 0.08447742462158203
block to device time/epoch 0.04978632926940918
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  938470
Number of first layer input nodes during this epoch:  333398
