Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648353756.2774181
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027744770050048828
random selection method range initialization spend 0.006481170654296875
time for parepare:  0.018790245056152344
local_output_nid generation:  0.0010838508605957031
local_in_edges_tensor generation:  0.00441288948059082
mini_batch_src_global generation:  0.0016274452209472656
r_  generation:  0.010443925857543945
local_output_nid generation:  0.0012614727020263672
local_in_edges_tensor generation:  0.001018524169921875
mini_batch_src_global generation:  0.0015079975128173828
r_  generation:  0.009156942367553711
local_output_nid generation:  0.0013306140899658203
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0011348724365234375
r_  generation:  0.009559392929077148
local_output_nid generation:  0.0013566017150878906
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.009190797805786133
local_output_nid generation:  0.0014078617095947266
local_in_edges_tensor generation:  0.0008640289306640625
mini_batch_src_global generation:  0.0009932518005371094
r_  generation:  0.009703874588012695
local_output_nid generation:  0.0014007091522216797
local_in_edges_tensor generation:  0.000835418701171875
mini_batch_src_global generation:  0.001032114028930664
r_  generation:  0.010014533996582031
local_output_nid generation:  0.0014357566833496094
local_in_edges_tensor generation:  0.0008418560028076172
mini_batch_src_global generation:  0.0010304450988769531
r_  generation:  0.009696006774902344
local_output_nid generation:  0.0014379024505615234
local_in_edges_tensor generation:  0.0008003711700439453
mini_batch_src_global generation:  0.0010094642639160156
r_  generation:  0.010177135467529297
local_output_nid generation:  0.0014231204986572266
local_in_edges_tensor generation:  0.0008051395416259766
mini_batch_src_global generation:  0.00101470947265625
r_  generation:  0.009866952896118164
local_output_nid generation:  0.0014691352844238281
local_in_edges_tensor generation:  0.0008251667022705078
mini_batch_src_global generation:  0.0010874271392822266
r_  generation:  0.009904861450195312
local_output_nid generation:  0.0014111995697021484
local_in_edges_tensor generation:  0.0007970333099365234
mini_batch_src_global generation:  0.0009963512420654297
r_  generation:  0.01033473014831543
local_output_nid generation:  0.001481771469116211
local_in_edges_tensor generation:  0.0007865428924560547
mini_batch_src_global generation:  0.0010221004486083984
r_  generation:  0.009940624237060547
local_output_nid generation:  0.0014307498931884766
local_in_edges_tensor generation:  0.0007658004760742188
mini_batch_src_global generation:  0.0010309219360351562
r_  generation:  0.009909868240356445
local_output_nid generation:  0.0014202594757080078
local_in_edges_tensor generation:  0.0007698535919189453
mini_batch_src_global generation:  0.0009875297546386719
r_  generation:  0.010080099105834961
local_output_nid generation:  0.001435995101928711
local_in_edges_tensor generation:  0.0007798671722412109
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.010088443756103516
local_output_nid generation:  0.0014486312866210938
local_in_edges_tensor generation:  0.0007619857788085938
mini_batch_src_global generation:  0.0009696483612060547
r_  generation:  0.009720325469970703
local_output_nid generation:  0.0014374256134033203
local_in_edges_tensor generation:  0.0008029937744140625
mini_batch_src_global generation:  0.001016378402709961
r_  generation:  0.009745359420776367
local_output_nid generation:  0.0014300346374511719
local_in_edges_tensor generation:  0.0007581710815429688
mini_batch_src_global generation:  0.0010330677032470703
r_  generation:  0.01031041145324707
local_output_nid generation:  0.0015180110931396484
local_in_edges_tensor generation:  0.0007948875427246094
mini_batch_src_global generation:  0.0010898113250732422
r_  generation:  0.010224103927612305
local_output_nid generation:  0.0015132427215576172
local_in_edges_tensor generation:  0.0007839202880859375
mini_batch_src_global generation:  0.0010402202606201172
r_  generation:  0.010163307189941406
local_output_nid generation:  0.0014765262603759766
local_in_edges_tensor generation:  0.0007495880126953125
mini_batch_src_global generation:  0.0009732246398925781
r_  generation:  0.009685039520263672
local_output_nid generation:  0.0014905929565429688
local_in_edges_tensor generation:  0.0007753372192382812
mini_batch_src_global generation:  0.0010423660278320312
r_  generation:  0.010148286819458008
local_output_nid generation:  0.0014765262603759766
local_in_edges_tensor generation:  0.0007426738739013672
mini_batch_src_global generation:  0.0009791851043701172
r_  generation:  0.009763956069946289
local_output_nid generation:  0.001493692398071289
local_in_edges_tensor generation:  0.0007851123809814453
mini_batch_src_global generation:  0.0010113716125488281
r_  generation:  0.010317087173461914
local_output_nid generation:  0.0014727115631103516
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.0009970664978027344
r_  generation:  0.009726285934448242
local_output_nid generation:  0.0014760494232177734
local_in_edges_tensor generation:  0.0007479190826416016
mini_batch_src_global generation:  0.0009431838989257812
r_  generation:  0.009993553161621094
local_output_nid generation:  0.0014994144439697266
local_in_edges_tensor generation:  0.0007839202880859375
mini_batch_src_global generation:  0.0010001659393310547
r_  generation:  0.010123968124389648
local_output_nid generation:  0.0014960765838623047
local_in_edges_tensor generation:  0.00075531005859375
mini_batch_src_global generation:  0.0009894371032714844
r_  generation:  0.010139703750610352
local_output_nid generation:  0.0015330314636230469
local_in_edges_tensor generation:  0.0007853507995605469
mini_batch_src_global generation:  0.0010042190551757812
r_  generation:  0.009876012802124023
local_output_nid generation:  0.0015027523040771484
local_in_edges_tensor generation:  0.005461692810058594
mini_batch_src_global generation:  0.0011827945709228516
r_  generation:  0.009687185287475586
local_output_nid generation:  0.0014476776123046875
local_in_edges_tensor generation:  0.0008234977722167969
mini_batch_src_global generation:  0.0011410713195800781
r_  generation:  0.009966611862182617
local_output_nid generation:  0.0014467239379882812
local_in_edges_tensor generation:  0.0007622241973876953
mini_batch_src_global generation:  0.0010390281677246094
r_  generation:  0.00972890853881836
----------------------check_connections_block total spend ----------------------------- 0.5402321815490723
generate_one_block  0.01573038101196289
generate_one_block  0.014584064483642578
generate_one_block  0.015618562698364258
generate_one_block  0.014719724655151367
generate_one_block  0.015352964401245117
generate_one_block  0.015412330627441406
generate_one_block  0.014870882034301758
generate_one_block  0.015249252319335938
generate_one_block  0.015183448791503906
generate_one_block  0.015434026718139648
generate_one_block  0.015236139297485352
generate_one_block  0.01497340202331543
generate_one_block  0.015051603317260742
generate_one_block  0.01482844352722168
generate_one_block  0.015121221542358398
generate_one_block  0.014215946197509766
generate_one_block  0.014621973037719727
generate_one_block  0.015235185623168945
generate_one_block  0.014947652816772461
generate_one_block  0.015186786651611328
generate_one_block  0.014354705810546875
generate_one_block  0.015146255493164062
generate_one_block  0.014524459838867188
generate_one_block  0.01580071449279785
generate_one_block  0.014829158782958984
generate_one_block  0.014513731002807617
generate_one_block  0.015027046203613281
generate_one_block  0.014867067337036133
generate_one_block  0.014482259750366211
generate_one_block  0.014071226119995117
generate_one_block  0.014930963516235352
generate_one_block  0.014357805252075195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03951001167297363
gen group dst list time:  0.023291349411010742
time for parepare:  0.020026206970214844
local_output_nid generation:  0.005318880081176758
local_in_edges_tensor generation:  0.01375889778137207
mini_batch_src_global generation:  0.01356816291809082
r_  generation:  0.13433289527893066
local_output_nid generation:  0.010734319686889648
local_in_edges_tensor generation:  0.014130592346191406
mini_batch_src_global generation:  0.016350984573364258
r_  generation:  0.13495135307312012
local_output_nid generation:  0.01094818115234375
local_in_edges_tensor generation:  0.013788938522338867
mini_batch_src_global generation:  0.015761613845825195
r_  generation:  0.14818120002746582
local_output_nid generation:  0.01054692268371582
local_in_edges_tensor generation:  0.011236190795898438
mini_batch_src_global generation:  0.01630568504333496
r_  generation:  0.14226150512695312
local_output_nid generation:  0.010893821716308594
local_in_edges_tensor generation:  0.010729789733886719
mini_batch_src_global generation:  0.018396854400634766
r_  generation:  0.14771008491516113
local_output_nid generation:  0.011092901229858398
local_in_edges_tensor generation:  0.01223897933959961
mini_batch_src_global generation:  0.01952981948852539
r_  generation:  0.15316414833068848
local_output_nid generation:  0.010576963424682617
local_in_edges_tensor generation:  0.009968757629394531
mini_batch_src_global generation:  0.018234729766845703
r_  generation:  0.1478123664855957
local_output_nid generation:  0.010860681533813477
local_in_edges_tensor generation:  0.009686708450317383
mini_batch_src_global generation:  0.021379470825195312
r_  generation:  0.14891552925109863
local_output_nid generation:  0.010864496231079102
local_in_edges_tensor generation:  0.011267900466918945
mini_batch_src_global generation:  0.018419981002807617
r_  generation:  0.14962363243103027
local_output_nid generation:  0.010563373565673828
local_in_edges_tensor generation:  0.01083683967590332
mini_batch_src_global generation:  0.0179901123046875
r_  generation:  0.14733076095581055
local_output_nid generation:  0.01085662841796875
local_in_edges_tensor generation:  0.012476921081542969
mini_batch_src_global generation:  0.01869940757751465
r_  generation:  0.15488409996032715
local_output_nid generation:  0.010806083679199219
local_in_edges_tensor generation:  0.0108795166015625
mini_batch_src_global generation:  0.018416643142700195
r_  generation:  0.14991998672485352
local_output_nid generation:  0.010912179946899414
local_in_edges_tensor generation:  0.010605573654174805
mini_batch_src_global generation:  0.018923044204711914
r_  generation:  0.15400409698486328
local_output_nid generation:  0.010817766189575195
local_in_edges_tensor generation:  0.010966062545776367
mini_batch_src_global generation:  0.01889777183532715
r_  generation:  0.15104365348815918
local_output_nid generation:  0.010951995849609375
local_in_edges_tensor generation:  0.012330770492553711
mini_batch_src_global generation:  0.018842220306396484
r_  generation:  0.15618896484375
local_output_nid generation:  0.010373830795288086
local_in_edges_tensor generation:  0.01035308837890625
mini_batch_src_global generation:  0.018119335174560547
r_  generation:  0.1440904140472412
local_output_nid generation:  0.013990163803100586
local_in_edges_tensor generation:  0.010601282119750977
mini_batch_src_global generation:  0.017775297164916992
r_  generation:  0.15065360069274902
local_output_nid generation:  0.01089930534362793
local_in_edges_tensor generation:  0.012115955352783203
mini_batch_src_global generation:  0.0191190242767334
r_  generation:  0.15316176414489746
local_output_nid generation:  0.010928630828857422
local_in_edges_tensor generation:  0.012091636657714844
mini_batch_src_global generation:  0.01855945587158203
r_  generation:  0.15449285507202148
local_output_nid generation:  0.010885477066040039
local_in_edges_tensor generation:  0.01081705093383789
mini_batch_src_global generation:  0.020247459411621094
r_  generation:  0.1553030014038086
local_output_nid generation:  0.010467767715454102
local_in_edges_tensor generation:  0.009338855743408203
mini_batch_src_global generation:  0.01814413070678711
r_  generation:  0.1491858959197998
local_output_nid generation:  0.01094961166381836
local_in_edges_tensor generation:  0.010108232498168945
mini_batch_src_global generation:  0.018900394439697266
r_  generation:  0.15307879447937012
local_output_nid generation:  0.010694265365600586
local_in_edges_tensor generation:  0.00946044921875
mini_batch_src_global generation:  0.018068790435791016
r_  generation:  0.1504533290863037
local_output_nid generation:  0.011198282241821289
local_in_edges_tensor generation:  0.01221323013305664
mini_batch_src_global generation:  0.020518779754638672
r_  generation:  0.16109395027160645
local_output_nid generation:  0.010846138000488281
local_in_edges_tensor generation:  0.009563207626342773
mini_batch_src_global generation:  0.0188601016998291
r_  generation:  0.1542799472808838
local_output_nid generation:  0.010769844055175781
local_in_edges_tensor generation:  0.009725809097290039
mini_batch_src_global generation:  0.018692493438720703
r_  generation:  0.15201425552368164
local_output_nid generation:  0.010948657989501953
local_in_edges_tensor generation:  0.010893821716308594
mini_batch_src_global generation:  0.018531084060668945
r_  generation:  0.15616703033447266
local_output_nid generation:  0.010784626007080078
local_in_edges_tensor generation:  0.011918306350708008
mini_batch_src_global generation:  0.019136667251586914
r_  generation:  0.1573636531829834
local_output_nid generation:  0.010639190673828125
local_in_edges_tensor generation:  0.009419679641723633
mini_batch_src_global generation:  0.018680095672607422
r_  generation:  0.15535759925842285
local_output_nid generation:  0.010560035705566406
local_in_edges_tensor generation:  0.009132623672485352
mini_batch_src_global generation:  0.01792120933532715
r_  generation:  0.14937162399291992
local_output_nid generation:  0.010785818099975586
local_in_edges_tensor generation:  0.011238574981689453
mini_batch_src_global generation:  0.0183103084564209
r_  generation:  0.15316987037658691
local_output_nid generation:  0.010400772094726562
local_in_edges_tensor generation:  0.010319232940673828
mini_batch_src_global generation:  0.018157958984375
r_  generation:  0.14787650108337402
----------------------check_connections_block total spend ----------------------------- 7.228784084320068
generate_one_block  0.19065189361572266
generate_one_block  0.18409991264343262
generate_one_block  0.2190701961517334
generate_one_block  0.18854403495788574
generate_one_block  0.19085311889648438
generate_one_block  0.20037484169006348
generate_one_block  0.19268035888671875
generate_one_block  0.19636225700378418
generate_one_block  0.1927928924560547
generate_one_block  0.1877896785736084
generate_one_block  0.19408750534057617
generate_one_block  0.19217228889465332
generate_one_block  0.1922612190246582
generate_one_block  0.19310283660888672
generate_one_block  0.19347810745239258
generate_one_block  0.20242643356323242
generate_one_block  0.19023776054382324
generate_one_block  0.1993415355682373
generate_one_block  0.19379091262817383
generate_one_block  0.1940011978149414
generate_one_block  0.1835477352142334
generate_one_block  0.18941164016723633
generate_one_block  0.1853790283203125
generate_one_block  0.1966395378112793
generate_one_block  0.1862175464630127
generate_one_block  0.18614983558654785
generate_one_block  0.1894979476928711
generate_one_block  0.19004011154174805
generate_one_block  0.19259047508239746
generate_one_block  0.18791651725769043
generate_one_block  0.19107985496520996
generate_one_block  0.1830735206604004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05060219764709473
gen group dst list time:  0.11420345306396484
time for parepare:  0.020426511764526367
local_output_nid generation:  0.021784067153930664
local_in_edges_tensor generation:  0.0690462589263916
mini_batch_src_global generation:  0.041697025299072266
r_  generation:  0.3923532962799072
local_output_nid generation:  0.02808547019958496
local_in_edges_tensor generation:  0.04004240036010742
mini_batch_src_global generation:  0.04650115966796875
r_  generation:  0.394791841506958
local_output_nid generation:  0.028391361236572266
local_in_edges_tensor generation:  0.03376173973083496
mini_batch_src_global generation:  0.04680943489074707
r_  generation:  0.4069643020629883
local_output_nid generation:  0.026689529418945312
local_in_edges_tensor generation:  0.03268551826477051
mini_batch_src_global generation:  0.0486454963684082
r_  generation:  0.40260839462280273
local_output_nid generation:  0.026600122451782227
local_in_edges_tensor generation:  0.030267953872680664
mini_batch_src_global generation:  0.05056023597717285
r_  generation:  0.4099721908569336
local_output_nid generation:  0.026769161224365234
local_in_edges_tensor generation:  0.03410148620605469
mini_batch_src_global generation:  0.05134892463684082
r_  generation:  0.4137578010559082
local_output_nid generation:  0.02665543556213379
local_in_edges_tensor generation:  0.026577234268188477
mini_batch_src_global generation:  0.04898977279663086
r_  generation:  0.41056370735168457
local_output_nid generation:  0.02641606330871582
local_in_edges_tensor generation:  0.029755830764770508
mini_batch_src_global generation:  0.05165433883666992
r_  generation:  0.41181325912475586
local_output_nid generation:  0.026660442352294922
local_in_edges_tensor generation:  0.03426814079284668
mini_batch_src_global generation:  0.049072265625
r_  generation:  0.4131598472595215
local_output_nid generation:  0.026664257049560547
local_in_edges_tensor generation:  0.02652287483215332
mini_batch_src_global generation:  0.05022478103637695
r_  generation:  0.409512996673584
local_output_nid generation:  0.02631664276123047
local_in_edges_tensor generation:  0.02673625946044922
mini_batch_src_global generation:  0.05127835273742676
r_  generation:  0.4112968444824219
local_output_nid generation:  0.026485919952392578
local_in_edges_tensor generation:  0.03348827362060547
mini_batch_src_global generation:  0.048470497131347656
r_  generation:  0.41077518463134766
local_output_nid generation:  0.027890920639038086
local_in_edges_tensor generation:  0.040639638900756836
mini_batch_src_global generation:  0.0494840145111084
r_  generation:  0.4172053337097168
local_output_nid generation:  0.02696847915649414
local_in_edges_tensor generation:  0.03452920913696289
mini_batch_src_global generation:  0.05137324333190918
r_  generation:  0.4335637092590332
local_output_nid generation:  0.02971029281616211
local_in_edges_tensor generation:  0.03784370422363281
mini_batch_src_global generation:  0.05552339553833008
r_  generation:  0.41530632972717285
local_output_nid generation:  0.02741217613220215
local_in_edges_tensor generation:  0.03251385688781738
mini_batch_src_global generation:  0.04857134819030762
r_  generation:  0.40520453453063965
local_output_nid generation:  0.027237653732299805
local_in_edges_tensor generation:  0.028100252151489258
mini_batch_src_global generation:  0.048568010330200195
r_  generation:  0.4094717502593994
local_output_nid generation:  0.027380704879760742
local_in_edges_tensor generation:  0.033447265625
mini_batch_src_global generation:  0.04857778549194336
r_  generation:  0.4108850955963135
local_output_nid generation:  0.027290821075439453
local_in_edges_tensor generation:  0.0332491397857666
mini_batch_src_global generation:  0.048184871673583984
r_  generation:  0.4113490581512451
local_output_nid generation:  0.027551889419555664
local_in_edges_tensor generation:  0.03073263168334961
mini_batch_src_global generation:  0.05191373825073242
r_  generation:  0.4157528877258301
local_output_nid generation:  0.027118682861328125
local_in_edges_tensor generation:  0.029906511306762695
mini_batch_src_global generation:  0.048133134841918945
r_  generation:  0.41033124923706055
local_output_nid generation:  0.0272676944732666
local_in_edges_tensor generation:  0.026292800903320312
mini_batch_src_global generation:  0.06453251838684082
r_  generation:  0.40665364265441895
local_output_nid generation:  0.027369976043701172
local_in_edges_tensor generation:  0.030080080032348633
mini_batch_src_global generation:  0.047826528549194336
r_  generation:  0.41086339950561523
local_output_nid generation:  0.028403759002685547
local_in_edges_tensor generation:  0.039270877838134766
mini_batch_src_global generation:  0.0488886833190918
r_  generation:  0.41047143936157227
local_output_nid generation:  0.02728724479675293
local_in_edges_tensor generation:  0.025751829147338867
mini_batch_src_global generation:  0.051511526107788086
r_  generation:  0.4319908618927002
local_output_nid generation:  0.02765369415283203
local_in_edges_tensor generation:  0.03732776641845703
mini_batch_src_global generation:  0.06486344337463379
r_  generation:  0.4145386219024658
local_output_nid generation:  0.028525114059448242
local_in_edges_tensor generation:  0.03486800193786621
mini_batch_src_global generation:  0.04928255081176758
r_  generation:  0.40694689750671387
local_output_nid generation:  0.027472734451293945
local_in_edges_tensor generation:  0.02564859390258789
mini_batch_src_global generation:  0.04831099510192871
r_  generation:  0.4054245948791504
local_output_nid generation:  0.026956558227539062
local_in_edges_tensor generation:  0.02853107452392578
mini_batch_src_global generation:  0.04776263236999512
r_  generation:  0.41193532943725586
local_output_nid generation:  0.027225017547607422
local_in_edges_tensor generation:  0.03211188316345215
mini_batch_src_global generation:  0.050591468811035156
r_  generation:  0.4163651466369629
local_output_nid generation:  0.027715444564819336
local_in_edges_tensor generation:  0.029097795486450195
mini_batch_src_global generation:  0.05071425437927246
r_  generation:  0.41535139083862305
local_output_nid generation:  0.02700018882751465
local_in_edges_tensor generation:  0.02458643913269043
mini_batch_src_global generation:  0.04895782470703125
r_  generation:  0.4060099124908447
----------------------check_connections_block total spend ----------------------------- 19.53877282142639
generate_one_block  0.6294558048248291
generate_one_block  0.5191900730133057
generate_one_block  0.5497138500213623
generate_one_block  0.5353901386260986
generate_one_block  0.532240629196167
generate_one_block  0.5451111793518066
generate_one_block  0.5287134647369385
generate_one_block  0.5388164520263672
generate_one_block  0.5355079174041748
generate_one_block  0.5312521457672119
generate_one_block  0.5265638828277588
generate_one_block  0.5183424949645996
generate_one_block  0.5472095012664795
generate_one_block  0.5386157035827637
generate_one_block  0.5277941226959229
generate_one_block  0.5159530639648438
generate_one_block  0.5194566249847412
generate_one_block  0.5344579219818115
generate_one_block  0.533822774887085
generate_one_block  0.5500979423522949
generate_one_block  0.533663272857666
generate_one_block  0.5231704711914062
generate_one_block  0.5309827327728271
generate_one_block  0.5478498935699463
generate_one_block  0.5295181274414062
generate_one_block  0.5235013961791992
generate_one_block  0.5333223342895508
generate_one_block  0.5243065357208252
generate_one_block  0.5276362895965576
generate_one_block  0.537135124206543
generate_one_block  0.5385103225708008
generate_one_block  0.5217363834381104
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  26.76755690574646
block generation total time  23.278701305389404
average batch blocks generation time:  0.7274594157934189
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08342218399047852  GigaBytes
Max Memory Allocated: 0.08342218399047852  GigaBytes

torch.Size([146179, 128])
torch.Size([101842, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1525583267211914  GigaBytes
Max Memory Allocated: 0.1542344093322754  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0836782455444336  GigaBytes
Max Memory Allocated: 0.16706323623657227  GigaBytes

torch.Size([146262, 128])
torch.Size([101382, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1523265838623047  GigaBytes
Max Memory Allocated: 0.16706323623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476924896240234  GigaBytes
Max Memory Allocated: 0.16706323623657227  GigaBytes

torch.Size([146068, 128])
torch.Size([102700, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1540670394897461  GigaBytes
Max Memory Allocated: 0.16706323623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475685119628906  GigaBytes
Max Memory Allocated: 0.1688394546508789  GigaBytes

torch.Size([145682, 128])
torch.Size([101366, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15348052978515625  GigaBytes
Max Memory Allocated: 0.1688394546508789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476448059082031  GigaBytes
Max Memory Allocated: 0.1688394546508789  GigaBytes

torch.Size([146760, 128])
torch.Size([102693, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15398454666137695  GigaBytes
Max Memory Allocated: 0.1688394546508789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476829528808594  GigaBytes
Max Memory Allocated: 0.1688394546508789  GigaBytes

torch.Size([146770, 128])
torch.Size([104369, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15464401245117188  GigaBytes
Max Memory Allocated: 0.1688394546508789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475875854492188  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146547, 128])
torch.Size([102341, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15376949310302734  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476448059082031  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146780, 128])
torch.Size([103398, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15417718887329102  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847635269165039  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146800, 128])
torch.Size([103286, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1540985107421875  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847616195678711  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146491, 128])
torch.Size([102778, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1538867950439453  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476638793945312  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145769, 128])
torch.Size([102084, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15381145477294922  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847616195678711  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145901, 128])
torch.Size([101776, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15364789962768555  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847625732421875  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146418, 128])
torch.Size([103193, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15409612655639648  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476066589355469  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146531, 128])
torch.Size([102730, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15391826629638672  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847635269165039  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145757, 128])
torch.Size([102435, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1539020538330078  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08365058898925781  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146015, 128])
torch.Size([101317, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1522045135498047  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475589752197266  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146348, 128])
torch.Size([102040, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1536421775817871  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476543426513672  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146367, 128])
torch.Size([102541, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15394163131713867  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847616195678711  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146168, 128])
torch.Size([102093, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15379571914672852  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476543426513672  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146281, 128])
torch.Size([102955, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15407562255859375  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08376884460449219  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146545, 128])
torch.Size([101832, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15249872207641602  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476543426513672  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145992, 128])
torch.Size([102307, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15385007858276367  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475303649902344  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145762, 128])
torch.Size([101629, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15350008010864258  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08477020263671875  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146542, 128])
torch.Size([103302, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1544041633605957  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475589752197266  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145677, 128])
torch.Size([101646, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15354490280151367  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475494384765625  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146941, 128])
torch.Size([102795, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15381383895874023  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847616195678711  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146036, 128])
torch.Size([102076, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15374231338500977  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475971221923828  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146089, 128])
torch.Size([101898, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1537013053894043  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08376884460449219  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145823, 128])
torch.Size([101154, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15239572525024414  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08372116088867188  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145869, 128])
torch.Size([101311, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1522531509399414  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475685119628906  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146756, 128])
torch.Size([102769, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1538538932800293  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0836191177368164  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145988, 128])
torch.Size([101189, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15218687057495117  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031087875366210938 |0.024769432842731476 |0.026778027415275574 |9.857118129730225e-05 |0.005311176180839539 |0.002440929412841797 |
----------------------------------------------------------pseudo_mini_loss sum 5.064523696899414
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8793339
Number of first layer input nodes during this epoch:  4679914
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.11260557174682617  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022415876388549805
random selection method range initialization spend 0.005301713943481445
time for parepare:  0.017917633056640625
local_output_nid generation:  0.0012450218200683594
local_in_edges_tensor generation:  0.0048296451568603516
mini_batch_src_global generation:  0.001726388931274414
r_  generation:  0.010250091552734375
local_output_nid generation:  0.0014796257019042969
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0015146732330322266
r_  generation:  0.010077953338623047
local_output_nid generation:  0.0014977455139160156
local_in_edges_tensor generation:  0.0008590221405029297
mini_batch_src_global generation:  0.0010619163513183594
r_  generation:  0.01216578483581543
local_output_nid generation:  0.0015072822570800781
local_in_edges_tensor generation:  0.0008666515350341797
mini_batch_src_global generation:  0.0010528564453125
r_  generation:  0.010121822357177734
local_output_nid generation:  0.001552581787109375
local_in_edges_tensor generation:  0.000850677490234375
mini_batch_src_global generation:  0.0010726451873779297
r_  generation:  0.010119199752807617
local_output_nid generation:  0.001520395278930664
local_in_edges_tensor generation:  0.0008103847503662109
mini_batch_src_global generation:  0.0010347366333007812
r_  generation:  0.010187625885009766
local_output_nid generation:  0.0015196800231933594
local_in_edges_tensor generation:  0.0008373260498046875
mini_batch_src_global generation:  0.0010685920715332031
r_  generation:  0.010324954986572266
local_output_nid generation:  0.0015118122100830078
local_in_edges_tensor generation:  0.0007994174957275391
mini_batch_src_global generation:  0.0010476112365722656
r_  generation:  0.010424375534057617
local_output_nid generation:  0.001497507095336914
local_in_edges_tensor generation:  0.0007917881011962891
mini_batch_src_global generation:  0.0010383129119873047
r_  generation:  0.012723684310913086
local_output_nid generation:  0.0015101432800292969
local_in_edges_tensor generation:  0.0007953643798828125
mini_batch_src_global generation:  0.0010743141174316406
r_  generation:  0.010267496109008789
local_output_nid generation:  0.0015218257904052734
local_in_edges_tensor generation:  0.0007765293121337891
mini_batch_src_global generation:  0.001049041748046875
r_  generation:  0.010608196258544922
local_output_nid generation:  0.0014967918395996094
local_in_edges_tensor generation:  0.0007815361022949219
mini_batch_src_global generation:  0.0010390281677246094
r_  generation:  0.010478734970092773
local_output_nid generation:  0.001489877700805664
local_in_edges_tensor generation:  0.0007822513580322266
mini_batch_src_global generation:  0.0010712146759033203
r_  generation:  0.010612249374389648
local_output_nid generation:  0.0015070438385009766
local_in_edges_tensor generation:  0.0007693767547607422
mini_batch_src_global generation:  0.0010225772857666016
r_  generation:  0.010393857955932617
local_output_nid generation:  0.0014889240264892578
local_in_edges_tensor generation:  0.0007948875427246094
mini_batch_src_global generation:  0.0010483264923095703
r_  generation:  0.010334014892578125
local_output_nid generation:  0.0015020370483398438
local_in_edges_tensor generation:  0.0007727146148681641
mini_batch_src_global generation:  0.0010266304016113281
r_  generation:  0.01035618782043457
local_output_nid generation:  0.0014951229095458984
local_in_edges_tensor generation:  0.0007860660552978516
mini_batch_src_global generation:  0.0010237693786621094
r_  generation:  0.010444879531860352
local_output_nid generation:  0.0014944076538085938
local_in_edges_tensor generation:  0.0008018016815185547
mini_batch_src_global generation:  0.0010483264923095703
r_  generation:  0.01036381721496582
local_output_nid generation:  0.001505136489868164
local_in_edges_tensor generation:  0.0007786750793457031
mini_batch_src_global generation:  0.0010738372802734375
r_  generation:  0.010578393936157227
local_output_nid generation:  0.0014739036560058594
local_in_edges_tensor generation:  0.0007486343383789062
mini_batch_src_global generation:  0.0010998249053955078
r_  generation:  0.010289430618286133
local_output_nid generation:  0.001497507095336914
local_in_edges_tensor generation:  0.0007565021514892578
mini_batch_src_global generation:  0.0010840892791748047
r_  generation:  0.010339498519897461
local_output_nid generation:  0.001497030258178711
local_in_edges_tensor generation:  0.0007662773132324219
mini_batch_src_global generation:  0.0010442733764648438
r_  generation:  0.01264810562133789
local_output_nid generation:  0.0014903545379638672
local_in_edges_tensor generation:  0.0007891654968261719
mini_batch_src_global generation:  0.0010457038879394531
r_  generation:  0.010160446166992188
local_output_nid generation:  0.00147247314453125
local_in_edges_tensor generation:  0.0007467269897460938
mini_batch_src_global generation:  0.0010139942169189453
r_  generation:  0.009963274002075195
local_output_nid generation:  0.001495361328125
local_in_edges_tensor generation:  0.0007472038269042969
mini_batch_src_global generation:  0.0010111331939697266
r_  generation:  0.009727716445922852
local_output_nid generation:  0.0014688968658447266
local_in_edges_tensor generation:  0.0007512569427490234
mini_batch_src_global generation:  0.0010101795196533203
r_  generation:  0.010028600692749023
local_output_nid generation:  0.001470327377319336
local_in_edges_tensor generation:  0.0007500648498535156
mini_batch_src_global generation:  0.0010623931884765625
r_  generation:  0.01061558723449707
local_output_nid generation:  0.0014865398406982422
local_in_edges_tensor generation:  0.0007658004760742188
mini_batch_src_global generation:  0.0010528564453125
r_  generation:  0.01005697250366211
local_output_nid generation:  0.001505136489868164
local_in_edges_tensor generation:  0.0007498264312744141
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.010039329528808594
local_output_nid generation:  0.0014977455139160156
local_in_edges_tensor generation:  0.0007572174072265625
mini_batch_src_global generation:  0.0010044574737548828
r_  generation:  0.010468482971191406
local_output_nid generation:  0.00150299072265625
local_in_edges_tensor generation:  0.0007586479187011719
mini_batch_src_global generation:  0.0010306835174560547
r_  generation:  0.010097026824951172
local_output_nid generation:  0.001495361328125
local_in_edges_tensor generation:  0.0007421970367431641
mini_batch_src_global generation:  0.0009937286376953125
r_  generation:  0.009864568710327148
----------------------check_connections_block total spend ----------------------------- 0.5613052845001221
generate_one_block  0.029865026473999023
generate_one_block  0.019322633743286133
generate_one_block  0.014384746551513672
generate_one_block  0.014696598052978516
generate_one_block  0.014737606048583984
generate_one_block  0.014664173126220703
generate_one_block  0.014838457107543945
generate_one_block  0.01515507698059082
generate_one_block  0.01676774024963379
generate_one_block  0.01467752456665039
generate_one_block  0.015000343322753906
generate_one_block  0.01561880111694336
generate_one_block  0.01513814926147461
generate_one_block  0.014838695526123047
generate_one_block  0.014757394790649414
generate_one_block  0.01790332794189453
generate_one_block  0.015250205993652344
generate_one_block  0.014841556549072266
generate_one_block  0.015752792358398438
generate_one_block  0.015185832977294922
generate_one_block  0.015388250350952148
generate_one_block  0.015190362930297852
generate_one_block  0.01976919174194336
generate_one_block  0.014952421188354492
generate_one_block  0.014428377151489258
generate_one_block  0.01502370834350586
generate_one_block  0.015012264251708984
generate_one_block  0.014922857284545898
generate_one_block  0.01820659637451172
generate_one_block  0.014762163162231445
generate_one_block  0.014945507049560547
generate_one_block  0.014481067657470703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05037736892700195
gen group dst list time:  0.024493932723999023
time for parepare:  0.022037744522094727
local_output_nid generation:  0.005403757095336914
local_in_edges_tensor generation:  0.020321130752563477
mini_batch_src_global generation:  0.013228416442871094
r_  generation:  0.13617634773254395
local_output_nid generation:  0.0077972412109375
local_in_edges_tensor generation:  0.012729883193969727
mini_batch_src_global generation:  0.016137123107910156
r_  generation:  0.1302030086517334
local_output_nid generation:  0.008224248886108398
local_in_edges_tensor generation:  0.03018355369567871
mini_batch_src_global generation:  0.01733088493347168
r_  generation:  0.13714385032653809
local_output_nid generation:  0.008312225341796875
local_in_edges_tensor generation:  0.008045673370361328
mini_batch_src_global generation:  0.017668724060058594
r_  generation:  0.1421341896057129
local_output_nid generation:  0.008515596389770508
local_in_edges_tensor generation:  0.010376453399658203
mini_batch_src_global generation:  0.01881551742553711
r_  generation:  0.14681386947631836
local_output_nid generation:  0.008306026458740234
local_in_edges_tensor generation:  0.010918617248535156
mini_batch_src_global generation:  0.01944756507873535
r_  generation:  0.1503305435180664
local_output_nid generation:  0.009364128112792969
local_in_edges_tensor generation:  0.009685516357421875
mini_batch_src_global generation:  0.018014192581176758
r_  generation:  0.1471726894378662
local_output_nid generation:  0.008162736892700195
local_in_edges_tensor generation:  0.009720087051391602
mini_batch_src_global generation:  0.019772768020629883
r_  generation:  0.16034889221191406
local_output_nid generation:  0.007868289947509766
local_in_edges_tensor generation:  0.008460283279418945
mini_batch_src_global generation:  0.018055200576782227
r_  generation:  0.15250205993652344
local_output_nid generation:  0.00834035873413086
local_in_edges_tensor generation:  0.00860905647277832
mini_batch_src_global generation:  0.0180966854095459
r_  generation:  0.1520540714263916
local_output_nid generation:  0.008572101593017578
local_in_edges_tensor generation:  0.01079702377319336
mini_batch_src_global generation:  0.019281625747680664
r_  generation:  0.1550302505493164
local_output_nid generation:  0.008436203002929688
local_in_edges_tensor generation:  0.00985860824584961
mini_batch_src_global generation:  0.018654584884643555
r_  generation:  0.1541914939880371
local_output_nid generation:  0.008643865585327148
local_in_edges_tensor generation:  0.009900331497192383
mini_batch_src_global generation:  0.020172595977783203
r_  generation:  0.15866732597351074
local_output_nid generation:  0.009243249893188477
local_in_edges_tensor generation:  0.00837254524230957
mini_batch_src_global generation:  0.01887059211730957
r_  generation:  0.1595594882965088
local_output_nid generation:  0.010083913803100586
local_in_edges_tensor generation:  0.016396760940551758
mini_batch_src_global generation:  0.01959061622619629
r_  generation:  0.14946341514587402
local_output_nid generation:  0.008655548095703125
local_in_edges_tensor generation:  0.011017560958862305
mini_batch_src_global generation:  0.019910097122192383
r_  generation:  0.14666032791137695
local_output_nid generation:  0.009661674499511719
local_in_edges_tensor generation:  0.01054835319519043
mini_batch_src_global generation:  0.019405603408813477
r_  generation:  0.15478873252868652
local_output_nid generation:  0.008751869201660156
local_in_edges_tensor generation:  0.009582996368408203
mini_batch_src_global generation:  0.01822066307067871
r_  generation:  0.14978408813476562
local_output_nid generation:  0.00881195068359375
local_in_edges_tensor generation:  0.009718656539916992
mini_batch_src_global generation:  0.01846003532409668
r_  generation:  0.14939546585083008
local_output_nid generation:  0.00866389274597168
local_in_edges_tensor generation:  0.012154817581176758
mini_batch_src_global generation:  0.01865696907043457
r_  generation:  0.15175342559814453
local_output_nid generation:  0.008442163467407227
local_in_edges_tensor generation:  0.00985574722290039
mini_batch_src_global generation:  0.020194530487060547
r_  generation:  0.15573477745056152
local_output_nid generation:  0.008325576782226562
local_in_edges_tensor generation:  0.012174367904663086
mini_batch_src_global generation:  0.019184112548828125
r_  generation:  0.1551682949066162
local_output_nid generation:  0.008336305618286133
local_in_edges_tensor generation:  0.008338689804077148
mini_batch_src_global generation:  0.01874542236328125
r_  generation:  0.15166091918945312
local_output_nid generation:  0.008253335952758789
local_in_edges_tensor generation:  0.008303165435791016
mini_batch_src_global generation:  0.01876544952392578
r_  generation:  0.149125337600708
local_output_nid generation:  0.008031845092773438
local_in_edges_tensor generation:  0.008212804794311523
mini_batch_src_global generation:  0.025547504425048828
r_  generation:  0.1450052261352539
local_output_nid generation:  0.01034688949584961
local_in_edges_tensor generation:  0.00998544692993164
mini_batch_src_global generation:  0.019269227981567383
r_  generation:  0.17230892181396484
local_output_nid generation:  0.008637189865112305
local_in_edges_tensor generation:  0.009857177734375
mini_batch_src_global generation:  0.01910567283630371
r_  generation:  0.16281485557556152
local_output_nid generation:  0.008440732955932617
local_in_edges_tensor generation:  0.008463144302368164
mini_batch_src_global generation:  0.01861405372619629
r_  generation:  0.15236997604370117
local_output_nid generation:  0.00833892822265625
local_in_edges_tensor generation:  0.012218713760375977
mini_batch_src_global generation:  0.018758058547973633
r_  generation:  0.15581321716308594
local_output_nid generation:  0.00824880599975586
local_in_edges_tensor generation:  0.008661508560180664
mini_batch_src_global generation:  0.020406246185302734
r_  generation:  0.1518237590789795
local_output_nid generation:  0.008388042449951172
local_in_edges_tensor generation:  0.019339561462402344
mini_batch_src_global generation:  0.02464437484741211
r_  generation:  0.15445709228515625
local_output_nid generation:  0.009217500686645508
local_in_edges_tensor generation:  0.008997678756713867
mini_batch_src_global generation:  0.018631458282470703
r_  generation:  0.1487288475036621
----------------------check_connections_block total spend ----------------------------- 7.218258380889893
generate_one_block  0.19571948051452637
generate_one_block  0.1769862174987793
generate_one_block  0.1805253028869629
generate_one_block  0.1862037181854248
generate_one_block  0.20319032669067383
generate_one_block  0.19275999069213867
generate_one_block  0.187730073928833
generate_one_block  0.19147109985351562
generate_one_block  0.18218660354614258
generate_one_block  0.18451333045959473
generate_one_block  0.1894090175628662
generate_one_block  0.1957712173461914
generate_one_block  0.1980726718902588
generate_one_block  0.18191313743591309
generate_one_block  0.1848917007446289
generate_one_block  0.1863565444946289
generate_one_block  0.1874089241027832
generate_one_block  0.18646860122680664
generate_one_block  0.2008373737335205
generate_one_block  0.22247791290283203
generate_one_block  0.1987442970275879
generate_one_block  0.19511127471923828
generate_one_block  0.19195795059204102
generate_one_block  0.18428993225097656
generate_one_block  0.17931461334228516
generate_one_block  0.2022414207458496
generate_one_block  0.20083189010620117
generate_one_block  0.1892251968383789
generate_one_block  0.19587993621826172
generate_one_block  0.18363261222839355
generate_one_block  0.19591307640075684
generate_one_block  0.18619346618652344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.10471081733703613
gen group dst list time:  0.09518742561340332
time for parepare:  0.017561674118041992
local_output_nid generation:  0.021869182586669922
local_in_edges_tensor generation:  0.046966552734375
mini_batch_src_global generation:  0.036447763442993164
r_  generation:  0.40238142013549805
local_output_nid generation:  0.02801227569580078
local_in_edges_tensor generation:  0.04117584228515625
mini_batch_src_global generation:  0.04648232460021973
r_  generation:  0.40547966957092285
local_output_nid generation:  0.02796626091003418
local_in_edges_tensor generation:  0.03414511680603027
mini_batch_src_global generation:  0.04648876190185547
r_  generation:  0.4113471508026123
local_output_nid generation:  0.026681900024414062
local_in_edges_tensor generation:  0.030561447143554688
mini_batch_src_global generation:  0.048163652420043945
r_  generation:  0.41039538383483887
local_output_nid generation:  0.026424169540405273
local_in_edges_tensor generation:  0.03289318084716797
mini_batch_src_global generation:  0.04752159118652344
r_  generation:  0.41832756996154785
local_output_nid generation:  0.026874065399169922
local_in_edges_tensor generation:  0.0370330810546875
mini_batch_src_global generation:  0.05136919021606445
r_  generation:  0.4156672954559326
local_output_nid generation:  0.027681589126586914
local_in_edges_tensor generation:  0.03203177452087402
mini_batch_src_global generation:  0.04758810997009277
r_  generation:  0.4121065139770508
local_output_nid generation:  0.027017593383789062
local_in_edges_tensor generation:  0.030321359634399414
mini_batch_src_global generation:  0.05120396614074707
r_  generation:  0.41637659072875977
local_output_nid generation:  0.02764415740966797
local_in_edges_tensor generation:  0.02994513511657715
mini_batch_src_global generation:  0.049852609634399414
r_  generation:  0.4189016819000244
local_output_nid generation:  0.028546571731567383
local_in_edges_tensor generation:  0.03415060043334961
mini_batch_src_global generation:  0.04851651191711426
r_  generation:  0.4083216190338135
local_output_nid generation:  0.0277249813079834
local_in_edges_tensor generation:  0.034523725509643555
mini_batch_src_global generation:  0.04763174057006836
r_  generation:  0.4112517833709717
local_output_nid generation:  0.02734231948852539
local_in_edges_tensor generation:  0.026376724243164062
mini_batch_src_global generation:  0.04871010780334473
r_  generation:  0.42322611808776855
local_output_nid generation:  0.028134822845458984
local_in_edges_tensor generation:  0.034125328063964844
mini_batch_src_global generation:  0.0479121208190918
r_  generation:  0.4222135543823242
local_output_nid generation:  0.027443885803222656
local_in_edges_tensor generation:  0.026766300201416016
mini_batch_src_global generation:  0.04857182502746582
r_  generation:  0.4047379493713379
local_output_nid generation:  0.02733635902404785
local_in_edges_tensor generation:  0.03026866912841797
mini_batch_src_global generation:  0.05057716369628906
r_  generation:  0.4132375717163086
local_output_nid generation:  0.027769804000854492
local_in_edges_tensor generation:  0.030193567276000977
mini_batch_src_global generation:  0.0485682487487793
r_  generation:  0.40725159645080566
local_output_nid generation:  0.028109312057495117
local_in_edges_tensor generation:  0.03418993949890137
mini_batch_src_global generation:  0.0476839542388916
r_  generation:  0.4138340950012207
local_output_nid generation:  0.027717113494873047
local_in_edges_tensor generation:  0.03091740608215332
mini_batch_src_global generation:  0.04827737808227539
r_  generation:  0.4095010757446289
local_output_nid generation:  0.02814793586730957
local_in_edges_tensor generation:  0.03061652183532715
mini_batch_src_global generation:  0.047721147537231445
r_  generation:  0.41535115242004395
local_output_nid generation:  0.027378320693969727
local_in_edges_tensor generation:  0.03026437759399414
mini_batch_src_global generation:  0.04826235771179199
r_  generation:  0.4083106517791748
local_output_nid generation:  0.027530193328857422
local_in_edges_tensor generation:  0.03416299819946289
mini_batch_src_global generation:  0.04780888557434082
r_  generation:  0.4214823246002197
local_output_nid generation:  0.027662992477416992
local_in_edges_tensor generation:  0.03381776809692383
mini_batch_src_global generation:  0.048325538635253906
r_  generation:  0.4094982147216797
local_output_nid generation:  0.027594566345214844
local_in_edges_tensor generation:  0.029574155807495117
mini_batch_src_global generation:  0.04743313789367676
r_  generation:  0.41356563568115234
local_output_nid generation:  0.027609825134277344
local_in_edges_tensor generation:  0.03313279151916504
mini_batch_src_global generation:  0.0482180118560791
r_  generation:  0.40862584114074707
local_output_nid generation:  0.027261734008789062
local_in_edges_tensor generation:  0.025905609130859375
mini_batch_src_global generation:  0.047162771224975586
r_  generation:  0.4082167148590088
local_output_nid generation:  0.027745962142944336
local_in_edges_tensor generation:  0.03414773941040039
mini_batch_src_global generation:  0.04830455780029297
r_  generation:  0.4145393371582031
local_output_nid generation:  0.0275423526763916
local_in_edges_tensor generation:  0.034499168395996094
mini_batch_src_global generation:  0.047670841217041016
r_  generation:  0.41338109970092773
local_output_nid generation:  0.02766704559326172
local_in_edges_tensor generation:  0.030633211135864258
mini_batch_src_global generation:  0.04856300354003906
r_  generation:  0.40799498558044434
local_output_nid generation:  0.027770280838012695
local_in_edges_tensor generation:  0.03403425216674805
mini_batch_src_global generation:  0.04775428771972656
r_  generation:  0.41381216049194336
local_output_nid generation:  0.027518272399902344
local_in_edges_tensor generation:  0.02670574188232422
mini_batch_src_global generation:  0.049102783203125
r_  generation:  0.4073824882507324
local_output_nid generation:  0.027657508850097656
local_in_edges_tensor generation:  0.030924081802368164
mini_batch_src_global generation:  0.04867219924926758
r_  generation:  0.4093000888824463
local_output_nid generation:  0.031659603118896484
local_in_edges_tensor generation:  0.040941476821899414
mini_batch_src_global generation:  0.049046993255615234
r_  generation:  0.40843796730041504
----------------------check_connections_block total spend ----------------------------- 19.52136492729187
generate_one_block  0.5306618213653564
generate_one_block  0.5263397693634033
generate_one_block  0.533728837966919
generate_one_block  0.5384671688079834
generate_one_block  0.6373317241668701
generate_one_block  0.5308849811553955
generate_one_block  0.526932954788208
generate_one_block  0.5363712310791016
generate_one_block  0.5292937755584717
generate_one_block  0.5340895652770996
generate_one_block  0.5433337688446045
generate_one_block  0.5264835357666016
generate_one_block  0.5404152870178223
generate_one_block  0.5191776752471924
generate_one_block  0.5291099548339844
generate_one_block  0.5908048152923584
generate_one_block  0.5551629066467285
generate_one_block  0.5237436294555664
generate_one_block  0.5330471992492676
generate_one_block  0.556337833404541
generate_one_block  0.5715744495391846
generate_one_block  0.5406134128570557
generate_one_block  0.5276038646697998
generate_one_block  0.5268902778625488
generate_one_block  0.5695147514343262
generate_one_block  0.5820791721343994
generate_one_block  0.5536160469055176
generate_one_block  0.5478270053863525
generate_one_block  0.5488462448120117
generate_one_block  0.535961389541626
generate_one_block  0.5252070426940918
generate_one_block  0.5447988510131836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.11260557174682617  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

connection checking time:  26.739623308181763
block generation total time  23.53447985649109
average batch blocks generation time:  0.7354524955153465
block dataloader generation time/epoch 52.89749479293823
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485746383666992  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146025, 128])
torch.Size([102378, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15388059616088867  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08368873596191406  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145705, 128])
torch.Size([100888, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1511821746826172  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08379745483398438  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145759, 128])
torch.Size([101612, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15243244171142578  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485794067382812  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146612, 128])
torch.Size([102704, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15396976470947266  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485889434814453  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146114, 128])
torch.Size([101968, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1537947654724121  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485984802246094  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146354, 128])
torch.Size([102656, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15402460098266602  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486270904541016  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146108, 128])
torch.Size([102420, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15393400192260742  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486461639404297  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145895, 128])
torch.Size([102513, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15403318405151367  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485603332519531  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146152, 128])
torch.Size([101820, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15364694595336914  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485794067382812  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146262, 128])
torch.Size([102129, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1537947654724121  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486080169677734  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146700, 128])
torch.Size([103388, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15418195724487305  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486175537109375  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146229, 128])
torch.Size([101751, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1537766456604004  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486461639404297  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146500, 128])
torch.Size([102920, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15428543090820312  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485603332519531  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145877, 128])
torch.Size([101616, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15361547470092773  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485889434814453  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146030, 128])
torch.Size([102336, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15381336212158203  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0848550796508789  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145943, 128])
torch.Size([101754, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15362787246704102  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485889434814453  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146290, 128])
torch.Size([102412, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15390539169311523  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485603332519531  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145825, 128])
torch.Size([101608, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15361261367797852  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486461639404297  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146394, 128])
torch.Size([102800, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15407419204711914  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486175537109375  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146642, 128])
torch.Size([102189, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1539006233215332  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486652374267578  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146231, 128])
torch.Size([102816, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1542515754699707  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486080169677734  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146207, 128])
torch.Size([102574, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15401601791381836  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486366271972656  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146670, 128])
torch.Size([102453, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15400362014770508  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485794067382812  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145829, 128])
torch.Size([101616, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15362977981567383  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08377933502197266  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([145938, 128])
torch.Size([100897, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15234375  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485984802246094  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146822, 128])
torch.Size([103668, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15427732467651367  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485794067382812  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146168, 128])
torch.Size([102178, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15382957458496094  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485889434814453  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146578, 128])
torch.Size([103083, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15410232543945312  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486270904541016  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146601, 128])
torch.Size([103088, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15417909622192383  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485698699951172  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146452, 128])
torch.Size([102070, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15380859375  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486175537109375  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146281, 128])
torch.Size([101912, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15381383895874023  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485126495361328  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

torch.Size([146763, 128])
torch.Size([102359, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15376949310302734  GigaBytes
Max Memory Allocated: 0.16936159133911133  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02412726730108261 |0.012421391904354095 |0.00335906445980072 |8.810311555862427e-05 |0.004024907946586609 |0.0029621124267578125 |
----------------------------------------------------------pseudo_mini_loss sum 4.340717315673828
Total (block generation + training)time/epoch 54.34958505630493
Training time/epoch 1.4518957138061523
Training time without block to device /epoch 1.0544111728668213
Training time without total dataloading part /epoch 0.24206852912902832
load block tensor time/epoch 0.7720725536346436
block to device time/epoch 0.39748454093933105
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8791605
Number of first layer input nodes during this epoch:  4679956
