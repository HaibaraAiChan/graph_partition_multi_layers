Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648354681.8813136
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0275576114654541
random selection method range initialization spend 0.0063970088958740234
time for parepare:  0.018514156341552734
local_output_nid generation:  0.0021660327911376953
local_in_edges_tensor generation:  0.004866600036621094
mini_batch_src_global generation:  0.001932382583618164
r_  generation:  0.019945383071899414
local_output_nid generation:  0.0025076866149902344
local_in_edges_tensor generation:  0.0017313957214355469
mini_batch_src_global generation:  0.002392292022705078
r_  generation:  0.020138025283813477
local_output_nid generation:  0.002741098403930664
local_in_edges_tensor generation:  0.00173187255859375
mini_batch_src_global generation:  0.0015799999237060547
r_  generation:  0.02091073989868164
local_output_nid generation:  0.0029211044311523438
local_in_edges_tensor generation:  0.0016341209411621094
mini_batch_src_global generation:  0.0015492439270019531
r_  generation:  0.02035045623779297
local_output_nid generation:  0.0029418468475341797
local_in_edges_tensor generation:  0.0015876293182373047
mini_batch_src_global generation:  0.0015790462493896484
r_  generation:  0.02055644989013672
local_output_nid generation:  0.0029172897338867188
local_in_edges_tensor generation:  0.0016052722930908203
mini_batch_src_global generation:  0.0016448497772216797
r_  generation:  0.02142333984375
local_output_nid generation:  0.002914905548095703
local_in_edges_tensor generation:  0.001573324203491211
mini_batch_src_global generation:  0.0017070770263671875
r_  generation:  0.021131515502929688
local_output_nid generation:  0.002910614013671875
local_in_edges_tensor generation:  0.0015664100646972656
mini_batch_src_global generation:  0.0017082691192626953
r_  generation:  0.020984411239624023
local_output_nid generation:  0.0028858184814453125
local_in_edges_tensor generation:  0.0016698837280273438
mini_batch_src_global generation:  0.0016100406646728516
r_  generation:  0.02140641212463379
local_output_nid generation:  0.0029230117797851562
local_in_edges_tensor generation:  0.0015726089477539062
mini_batch_src_global generation:  0.0017271041870117188
r_  generation:  0.02192974090576172
local_output_nid generation:  0.0029180049896240234
local_in_edges_tensor generation:  0.0016324520111083984
mini_batch_src_global generation:  0.0018150806427001953
r_  generation:  0.021778583526611328
local_output_nid generation:  0.0029098987579345703
local_in_edges_tensor generation:  0.0016756057739257812
mini_batch_src_global generation:  0.008523941040039062
r_  generation:  0.021873950958251953
local_output_nid generation:  0.0029151439666748047
local_in_edges_tensor generation:  0.0015747547149658203
mini_batch_src_global generation:  0.0017170906066894531
r_  generation:  0.021718263626098633
local_output_nid generation:  0.0029747486114501953
local_in_edges_tensor generation:  0.0016002655029296875
mini_batch_src_global generation:  0.0018069744110107422
r_  generation:  0.02178788185119629
local_output_nid generation:  0.0029392242431640625
local_in_edges_tensor generation:  0.0016160011291503906
mini_batch_src_global generation:  0.0018024444580078125
r_  generation:  0.02127695083618164
local_output_nid generation:  0.0029206275939941406
local_in_edges_tensor generation:  0.0015752315521240234
mini_batch_src_global generation:  0.0017516613006591797
r_  generation:  0.020986318588256836
----------------------check_connections_block total spend ----------------------------- 0.5541174411773682
generate_one_block  0.03081512451171875
generate_one_block  0.03193354606628418
generate_one_block  0.0348203182220459
generate_one_block  0.03179430961608887
generate_one_block  0.031609296798706055
generate_one_block  0.03156280517578125
generate_one_block  0.031245708465576172
generate_one_block  0.030785560607910156
generate_one_block  0.031415700912475586
generate_one_block  0.031618356704711914
generate_one_block  0.030670881271362305
generate_one_block  0.03132295608520508
generate_one_block  0.030408143997192383
generate_one_block  0.03138899803161621
generate_one_block  0.029996633529663086
generate_one_block  0.030669689178466797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04540109634399414
gen group dst list time:  0.020719051361083984
time for parepare:  0.019743919372558594
local_output_nid generation:  0.009373188018798828
local_in_edges_tensor generation:  0.023245573043823242
mini_batch_src_global generation:  0.026617765426635742
r_  generation:  0.24394607543945312
local_output_nid generation:  0.01622152328491211
local_in_edges_tensor generation:  0.0257871150970459
mini_batch_src_global generation:  0.03396940231323242
r_  generation:  0.2647669315338135
local_output_nid generation:  0.01634836196899414
local_in_edges_tensor generation:  0.020863056182861328
mini_batch_src_global generation:  0.03152036666870117
r_  generation:  0.2696363925933838
local_output_nid generation:  0.016167163848876953
local_in_edges_tensor generation:  0.02106022834777832
mini_batch_src_global generation:  0.03263115882873535
r_  generation:  0.2749168872833252
local_output_nid generation:  0.016309261322021484
local_in_edges_tensor generation:  0.015305519104003906
mini_batch_src_global generation:  0.03332877159118652
r_  generation:  0.2672269344329834
local_output_nid generation:  0.016099214553833008
local_in_edges_tensor generation:  0.02040576934814453
mini_batch_src_global generation:  0.03354668617248535
r_  generation:  0.27308106422424316
local_output_nid generation:  0.016142845153808594
local_in_edges_tensor generation:  0.02595376968383789
mini_batch_src_global generation:  0.03403306007385254
r_  generation:  0.27251696586608887
local_output_nid generation:  0.015872478485107422
local_in_edges_tensor generation:  0.01582479476928711
mini_batch_src_global generation:  0.03409123420715332
r_  generation:  0.2707087993621826
local_output_nid generation:  0.016053199768066406
local_in_edges_tensor generation:  0.016397714614868164
mini_batch_src_global generation:  0.0339207649230957
r_  generation:  0.2722909450531006
local_output_nid generation:  0.016410112380981445
local_in_edges_tensor generation:  0.02363896369934082
mini_batch_src_global generation:  0.0346217155456543
r_  generation:  0.2802717685699463
local_output_nid generation:  0.016056060791015625
local_in_edges_tensor generation:  0.016068696975708008
mini_batch_src_global generation:  0.034036874771118164
r_  generation:  0.2687690258026123
local_output_nid generation:  0.016220808029174805
local_in_edges_tensor generation:  0.016445398330688477
mini_batch_src_global generation:  0.03520369529724121
r_  generation:  0.28257107734680176
local_output_nid generation:  0.015866994857788086
local_in_edges_tensor generation:  0.01620197296142578
mini_batch_src_global generation:  0.03473997116088867
r_  generation:  0.2696678638458252
local_output_nid generation:  0.01607227325439453
local_in_edges_tensor generation:  0.01813673973083496
mini_batch_src_global generation:  0.03655052185058594
r_  generation:  0.27724647521972656
local_output_nid generation:  0.015859603881835938
local_in_edges_tensor generation:  0.015866994857788086
mini_batch_src_global generation:  0.03377246856689453
r_  generation:  0.2664468288421631
local_output_nid generation:  0.01604485511779785
local_in_edges_tensor generation:  0.017650842666625977
mini_batch_src_global generation:  0.03396129608154297
r_  generation:  0.2701263427734375
----------------------check_connections_block total spend ----------------------------- 6.386895418167114
generate_one_block  0.3500831127166748
generate_one_block  0.36768102645874023
generate_one_block  0.37006354331970215
generate_one_block  0.3581686019897461
generate_one_block  0.3709871768951416
generate_one_block  0.3561391830444336
generate_one_block  0.3597548007965088
generate_one_block  0.34658384323120117
generate_one_block  0.3596775531768799
generate_one_block  0.36646246910095215
generate_one_block  0.34698033332824707
generate_one_block  0.36240434646606445
generate_one_block  0.3458576202392578
generate_one_block  0.35248494148254395
generate_one_block  0.35434675216674805
generate_one_block  0.3441746234893799
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04161548614501953
gen group dst list time:  0.06206393241882324
time for parepare:  0.02012181282043457
local_output_nid generation:  0.027481794357299805
local_in_edges_tensor generation:  0.04511213302612305
mini_batch_src_global generation:  0.05035829544067383
r_  generation:  0.512880802154541
local_output_nid generation:  0.03365063667297363
local_in_edges_tensor generation:  0.05591630935668945
mini_batch_src_global generation:  0.06183958053588867
r_  generation:  0.5223953723907471
local_output_nid generation:  0.03318166732788086
local_in_edges_tensor generation:  0.05202603340148926
mini_batch_src_global generation:  0.05863809585571289
r_  generation:  0.5317139625549316
local_output_nid generation:  0.03321337699890137
local_in_edges_tensor generation:  0.04204607009887695
mini_batch_src_global generation:  0.059937238693237305
r_  generation:  0.5337216854095459
local_output_nid generation:  0.03314518928527832
local_in_edges_tensor generation:  0.04158830642700195
mini_batch_src_global generation:  0.0664827823638916
r_  generation:  0.5383219718933105
local_output_nid generation:  0.03256416320800781
local_in_edges_tensor generation:  0.037064552307128906
mini_batch_src_global generation:  0.060739994049072266
r_  generation:  0.5344469547271729
local_output_nid generation:  0.03308248519897461
local_in_edges_tensor generation:  0.036959171295166016
mini_batch_src_global generation:  0.06500959396362305
r_  generation:  0.547760009765625
local_output_nid generation:  0.033280134201049805
local_in_edges_tensor generation:  0.04708242416381836
mini_batch_src_global generation:  0.06142592430114746
r_  generation:  0.5447402000427246
local_output_nid generation:  0.033154964447021484
local_in_edges_tensor generation:  0.046154022216796875
mini_batch_src_global generation:  0.06163334846496582
r_  generation:  0.5495424270629883
local_output_nid generation:  0.033382415771484375
local_in_edges_tensor generation:  0.03683185577392578
mini_batch_src_global generation:  0.06331181526184082
r_  generation:  0.5517826080322266
local_output_nid generation:  0.03321218490600586
local_in_edges_tensor generation:  0.03810548782348633
mini_batch_src_global generation:  0.06184267997741699
r_  generation:  0.5443949699401855
local_output_nid generation:  0.03322339057922363
local_in_edges_tensor generation:  0.03737640380859375
mini_batch_src_global generation:  0.06517505645751953
r_  generation:  0.5474750995635986
local_output_nid generation:  0.03340864181518555
local_in_edges_tensor generation:  0.04580855369567871
mini_batch_src_global generation:  0.06218290328979492
r_  generation:  0.5426480770111084
local_output_nid generation:  0.03334832191467285
local_in_edges_tensor generation:  0.037220001220703125
mini_batch_src_global generation:  0.06191229820251465
r_  generation:  0.5437097549438477
local_output_nid generation:  0.033115386962890625
local_in_edges_tensor generation:  0.03692293167114258
mini_batch_src_global generation:  0.06545615196228027
r_  generation:  0.5450644493103027
local_output_nid generation:  0.0357210636138916
local_in_edges_tensor generation:  0.061951637268066406
mini_batch_src_global generation:  0.06713652610778809
r_  generation:  0.5448687076568604
----------------------check_connections_block total spend ----------------------------- 12.828674554824829
generate_one_block  0.6963546276092529
generate_one_block  0.7330756187438965
generate_one_block  0.6972630023956299
generate_one_block  0.7288017272949219
generate_one_block  0.7042357921600342
generate_one_block  0.7070572376251221
generate_one_block  0.7756242752075195
generate_one_block  0.7069084644317627
generate_one_block  0.7238855361938477
generate_one_block  0.7022943496704102
generate_one_block  0.6811439990997314
generate_one_block  0.6950197219848633
generate_one_block  0.7091798782348633
generate_one_block  0.6858329772949219
generate_one_block  0.6857893466949463
generate_one_block  0.6909785270690918
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  19.215569972991943
block generation total time  17.035295009613037
average batch blocks generation time:  1.0647059381008148
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09506368637084961  GigaBytes
Max Memory Allocated: 0.09506368637084961  GigaBytes

torch.Size([157260, 128])
torch.Size([129185, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.19185161590576172  GigaBytes
Max Memory Allocated: 0.19434499740600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.0966649055480957  GigaBytes
Max Memory Allocated: 0.20569896697998047  GigaBytes

torch.Size([157449, 128])
torch.Size([129498, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19472599029541016  GigaBytes
Max Memory Allocated: 0.20569896697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09784603118896484  GigaBytes
Max Memory Allocated: 0.20896577835083008  GigaBytes

torch.Size([157923, 128])
torch.Size([130865, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19623374938964844  GigaBytes
Max Memory Allocated: 0.20896577835083008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09772109985351562  GigaBytes
Max Memory Allocated: 0.20956134796142578  GigaBytes

torch.Size([158062, 128])
torch.Size([130653, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1958484649658203  GigaBytes
Max Memory Allocated: 0.20956134796142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09764957427978516  GigaBytes
Max Memory Allocated: 0.2101435661315918  GigaBytes

torch.Size([157841, 128])
torch.Size([130678, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1958303451538086  GigaBytes
Max Memory Allocated: 0.2101435661315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09643030166625977  GigaBytes
Max Memory Allocated: 0.2101435661315918  GigaBytes

torch.Size([157189, 128])
torch.Size([128984, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19454050064086914  GigaBytes
Max Memory Allocated: 0.2101435661315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09772586822509766  GigaBytes
Max Memory Allocated: 0.2101435661315918  GigaBytes

torch.Size([157890, 128])
torch.Size([130368, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19580411911010742  GigaBytes
Max Memory Allocated: 0.2101435661315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09642982482910156  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157390, 128])
torch.Size([129523, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1935272216796875  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09764480590820312  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157768, 128])
torch.Size([130219, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19576311111450195  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.0967397689819336  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157570, 128])
torch.Size([130011, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1948375701904297  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09652519226074219  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157582, 128])
torch.Size([129717, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19367265701293945  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09669160842895508  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157529, 128])
torch.Size([129963, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19481658935546875  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09754657745361328  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157696, 128])
torch.Size([130146, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19469213485717773  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09642934799194336  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157339, 128])
torch.Size([129543, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19360876083374023  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.0963444709777832  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157365, 128])
torch.Size([129460, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19336700439453125  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09641075134277344  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157554, 128])
torch.Size([130336, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19350719451904297  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030265003442764282 |0.03551982343196869 |0.050353556871414185 |0.00010091066360473633 |0.006783410906791687 |0.0022916793823242188 |
----------------------------------------------------------pseudo_mini_loss sum 5.049427032470703
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5330580
Number of first layer input nodes during this epoch:  2521407
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.13855886459350586  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026872634887695312
random selection method range initialization spend 0.005166530609130859
time for parepare:  0.01683187484741211
local_output_nid generation:  0.0024008750915527344
local_in_edges_tensor generation:  0.005939006805419922
mini_batch_src_global generation:  0.002052783966064453
r_  generation:  0.019137144088745117
local_output_nid generation:  0.0026824474334716797
local_in_edges_tensor generation:  0.0017058849334716797
mini_batch_src_global generation:  0.0022916793823242188
r_  generation:  0.019965648651123047
local_output_nid generation:  0.002877950668334961
local_in_edges_tensor generation:  0.0016245841979980469
mini_batch_src_global generation:  0.0015532970428466797
r_  generation:  0.02023768424987793
local_output_nid generation:  0.002923727035522461
local_in_edges_tensor generation:  0.0015647411346435547
mini_batch_src_global generation:  0.001573801040649414
r_  generation:  0.021252870559692383
local_output_nid generation:  0.003041505813598633
local_in_edges_tensor generation:  0.0015697479248046875
mini_batch_src_global generation:  0.0016181468963623047
r_  generation:  0.020502567291259766
local_output_nid generation:  0.002928018569946289
local_in_edges_tensor generation:  0.0015635490417480469
mini_batch_src_global generation:  0.0016107559204101562
r_  generation:  0.02126932144165039
local_output_nid generation:  0.0029549598693847656
local_in_edges_tensor generation:  0.001504659652709961
mini_batch_src_global generation:  0.0017299652099609375
r_  generation:  0.021279096603393555
local_output_nid generation:  0.0029327869415283203
local_in_edges_tensor generation:  0.0014984607696533203
mini_batch_src_global generation:  0.00168609619140625
r_  generation:  0.0214231014251709
local_output_nid generation:  0.0029442310333251953
local_in_edges_tensor generation:  0.001504659652709961
mini_batch_src_global generation:  0.0017116069793701172
r_  generation:  0.021114110946655273
local_output_nid generation:  0.0029251575469970703
local_in_edges_tensor generation:  0.0014920234680175781
mini_batch_src_global generation:  0.00173187255859375
r_  generation:  0.02184152603149414
local_output_nid generation:  0.0029325485229492188
local_in_edges_tensor generation:  0.0015010833740234375
mini_batch_src_global generation:  0.0017752647399902344
r_  generation:  0.021858692169189453
local_output_nid generation:  0.0029821395874023438
local_in_edges_tensor generation:  0.0014946460723876953
mini_batch_src_global generation:  0.0017435550689697266
r_  generation:  0.022079944610595703
local_output_nid generation:  0.002937793731689453
local_in_edges_tensor generation:  0.0014801025390625
mini_batch_src_global generation:  0.0017266273498535156
r_  generation:  0.021678924560546875
local_output_nid generation:  0.0029439926147460938
local_in_edges_tensor generation:  0.0015468597412109375
mini_batch_src_global generation:  0.0018198490142822266
r_  generation:  0.02169942855834961
local_output_nid generation:  0.002991914749145508
local_in_edges_tensor generation:  0.0015146732330322266
mini_batch_src_global generation:  0.0017766952514648438
r_  generation:  0.021942615509033203
local_output_nid generation:  0.0029478073120117188
local_in_edges_tensor generation:  0.0014712810516357422
mini_batch_src_global generation:  0.0018084049224853516
r_  generation:  0.022215604782104492
----------------------check_connections_block total spend ----------------------------- 0.5512661933898926
generate_one_block  0.03713560104370117
generate_one_block  0.030170202255249023
generate_one_block  0.030783891677856445
generate_one_block  0.031607866287231445
generate_one_block  0.030665159225463867
generate_one_block  0.03429079055786133
generate_one_block  0.03182387351989746
generate_one_block  0.030865907669067383
generate_one_block  0.031189918518066406
generate_one_block  0.03196454048156738
generate_one_block  0.03201484680175781
generate_one_block  0.0313563346862793
generate_one_block  0.03059220314025879
generate_one_block  0.031116724014282227
generate_one_block  0.03229570388793945
generate_one_block  0.031156063079833984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04272913932800293
gen group dst list time:  0.01909327507019043
time for parepare:  0.019242048263549805
local_output_nid generation:  0.009445667266845703
local_in_edges_tensor generation:  0.02320241928100586
mini_batch_src_global generation:  0.024250030517578125
r_  generation:  0.24686288833618164
local_output_nid generation:  0.013515949249267578
local_in_edges_tensor generation:  0.022725820541381836
mini_batch_src_global generation:  0.03204917907714844
r_  generation:  0.2540321350097656
local_output_nid generation:  0.013720273971557617
local_in_edges_tensor generation:  0.021268129348754883
mini_batch_src_global generation:  0.03256821632385254
r_  generation:  0.2682802677154541
local_output_nid generation:  0.014048576354980469
local_in_edges_tensor generation:  0.018985271453857422
mini_batch_src_global generation:  0.03274869918823242
r_  generation:  0.26677417755126953
local_output_nid generation:  0.013445615768432617
local_in_edges_tensor generation:  0.015476703643798828
mini_batch_src_global generation:  0.03299903869628906
r_  generation:  0.26726484298706055
local_output_nid generation:  0.01369929313659668
local_in_edges_tensor generation:  0.014507770538330078
mini_batch_src_global generation:  0.03343534469604492
r_  generation:  0.2700674533843994
local_output_nid generation:  0.013234376907348633
local_in_edges_tensor generation:  0.02096247673034668
mini_batch_src_global generation:  0.033872365951538086
r_  generation:  0.2721748352050781
local_output_nid generation:  0.012937068939208984
local_in_edges_tensor generation:  0.014014244079589844
mini_batch_src_global generation:  0.033705711364746094
r_  generation:  0.27073240280151367
local_output_nid generation:  0.013084173202514648
local_in_edges_tensor generation:  0.017868757247924805
mini_batch_src_global generation:  0.03394889831542969
r_  generation:  0.2711060047149658
local_output_nid generation:  0.013226032257080078
local_in_edges_tensor generation:  0.016162633895874023
mini_batch_src_global generation:  0.03407621383666992
r_  generation:  0.2735273838043213
local_output_nid generation:  0.013307332992553711
local_in_edges_tensor generation:  0.019240856170654297
mini_batch_src_global generation:  0.03629279136657715
r_  generation:  0.27695178985595703
local_output_nid generation:  0.01323390007019043
local_in_edges_tensor generation:  0.01614069938659668
mini_batch_src_global generation:  0.034174442291259766
r_  generation:  0.27151918411254883
local_output_nid generation:  0.013032913208007812
local_in_edges_tensor generation:  0.013882875442504883
mini_batch_src_global generation:  0.034261465072631836
r_  generation:  0.2728424072265625
local_output_nid generation:  0.013218164443969727
local_in_edges_tensor generation:  0.015597343444824219
mini_batch_src_global generation:  0.03589320182800293
r_  generation:  0.2732100486755371
local_output_nid generation:  0.013294696807861328
local_in_edges_tensor generation:  0.018936872482299805
mini_batch_src_global generation:  0.034325361251831055
r_  generation:  0.27675890922546387
local_output_nid generation:  0.013029813766479492
local_in_edges_tensor generation:  0.013819694519042969
mini_batch_src_global generation:  0.034162044525146484
r_  generation:  0.2732112407684326
----------------------check_connections_block total spend ----------------------------- 6.293251037597656
generate_one_block  0.3450801372528076
generate_one_block  0.34375858306884766
generate_one_block  0.35805749893188477
generate_one_block  0.3572876453399658
generate_one_block  0.3588829040527344
generate_one_block  0.35718297958374023
generate_one_block  0.39543628692626953
generate_one_block  0.3465561866760254
generate_one_block  0.35406494140625
generate_one_block  0.3566160202026367
generate_one_block  0.3621559143066406
generate_one_block  0.35474634170532227
generate_one_block  0.34839701652526855
generate_one_block  0.3484506607055664
generate_one_block  0.3589954376220703
generate_one_block  0.3456137180328369
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.15462493896484375
gen group dst list time:  0.06490373611450195
time for parepare:  0.01862359046936035
local_output_nid generation:  0.02781391143798828
local_in_edges_tensor generation:  0.05607795715332031
mini_batch_src_global generation:  0.05323433876037598
r_  generation:  0.5110604763031006
local_output_nid generation:  0.033574819564819336
local_in_edges_tensor generation:  0.052820682525634766
mini_batch_src_global generation:  0.061327219009399414
r_  generation:  0.5216357707977295
local_output_nid generation:  0.032802581787109375
local_in_edges_tensor generation:  0.0480198860168457
mini_batch_src_global generation:  0.0617680549621582
r_  generation:  0.5310063362121582
local_output_nid generation:  0.03278207778930664
local_in_edges_tensor generation:  0.03790855407714844
mini_batch_src_global generation:  0.05944228172302246
r_  generation:  0.5333659648895264
local_output_nid generation:  0.03299832344055176
local_in_edges_tensor generation:  0.0875089168548584
mini_batch_src_global generation:  0.06045937538146973
r_  generation:  0.536013126373291
local_output_nid generation:  0.03313803672790527
local_in_edges_tensor generation:  0.03827786445617676
mini_batch_src_global generation:  0.06126284599304199
r_  generation:  0.5366148948669434
local_output_nid generation:  0.03308987617492676
local_in_edges_tensor generation:  0.03305554389953613
mini_batch_src_global generation:  0.061585426330566406
r_  generation:  0.539160966873169
local_output_nid generation:  0.03258490562438965
local_in_edges_tensor generation:  0.03336930274963379
mini_batch_src_global generation:  0.06607532501220703
r_  generation:  0.5377497673034668
local_output_nid generation:  0.03294014930725098
local_in_edges_tensor generation:  0.033226728439331055
mini_batch_src_global generation:  0.061617136001586914
r_  generation:  0.5470333099365234
local_output_nid generation:  0.033148765563964844
local_in_edges_tensor generation:  0.038140058517456055
mini_batch_src_global generation:  0.06224513053894043
r_  generation:  0.5417766571044922
local_output_nid generation:  0.033097028732299805
local_in_edges_tensor generation:  0.04340505599975586
mini_batch_src_global generation:  0.06160759925842285
r_  generation:  0.5448484420776367
local_output_nid generation:  0.03294658660888672
local_in_edges_tensor generation:  0.03417062759399414
mini_batch_src_global generation:  0.06196141242980957
r_  generation:  0.5458769798278809
local_output_nid generation:  0.03298640251159668
local_in_edges_tensor generation:  0.053690195083618164
mini_batch_src_global generation:  0.061247825622558594
r_  generation:  0.5455830097198486
local_output_nid generation:  0.034642696380615234
local_in_edges_tensor generation:  0.0475156307220459
mini_batch_src_global generation:  0.06155991554260254
r_  generation:  0.5468368530273438
local_output_nid generation:  0.03320789337158203
local_in_edges_tensor generation:  0.04404091835021973
mini_batch_src_global generation:  0.0656423568725586
r_  generation:  0.5475554466247559
local_output_nid generation:  0.03455710411071777
local_in_edges_tensor generation:  0.03435969352722168
mini_batch_src_global generation:  0.06117725372314453
r_  generation:  0.5433042049407959
----------------------check_connections_block total spend ----------------------------- 12.798491477966309
generate_one_block  0.6840062141418457
generate_one_block  0.6942605972290039
generate_one_block  0.6949131488800049
generate_one_block  0.6959309577941895
generate_one_block  0.6857995986938477
generate_one_block  0.6972718238830566
generate_one_block  0.6743552684783936
generate_one_block  0.6907453536987305
generate_one_block  0.72737717628479
generate_one_block  0.689016580581665
generate_one_block  0.6905033588409424
generate_one_block  0.6933295726776123
generate_one_block  0.7004659175872803
generate_one_block  0.695354700088501
generate_one_block  0.695845365524292
generate_one_block  0.6757323741912842
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.13855886459350586  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

connection checking time:  19.091742515563965
block generation total time  16.776190280914307
average batch blocks generation time:  1.0485118925571442
block dataloader generation time/epoch 38.337430477142334
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09653568267822266  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157513, 128])
torch.Size([129380, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1935892105102539  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09758853912353516  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157874, 128])
torch.Size([130261, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19472932815551758  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09684228897094727  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157669, 128])
torch.Size([129914, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19487953186035156  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.0966801643371582  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157355, 128])
torch.Size([129794, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19478416442871094  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09668159484863281  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157686, 128])
torch.Size([129969, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19384431838989258  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09777259826660156  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

torch.Size([157825, 128])
torch.Size([130459, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19591188430786133  GigaBytes
Max Memory Allocated: 0.2101459503173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09680557250976562  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

torch.Size([157576, 128])
torch.Size([129942, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19487476348876953  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.0964818000793457  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

torch.Size([157281, 128])
torch.Size([129642, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19359207153320312  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09662961959838867  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

torch.Size([157405, 128])
torch.Size([129627, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19472503662109375  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09773826599121094  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

torch.Size([157700, 128])
torch.Size([130046, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19594240188598633  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.0968790054321289  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

torch.Size([157612, 128])
torch.Size([129535, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19495296478271484  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09679508209228516  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

torch.Size([157686, 128])
torch.Size([129780, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19490528106689453  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.0976552963256836  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

torch.Size([157713, 128])
torch.Size([130120, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19480514526367188  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.0977315902709961  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

torch.Size([157771, 128])
torch.Size([130194, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19588708877563477  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09778594970703125  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

torch.Size([157816, 128])
torch.Size([130360, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1959371566772461  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09766960144042969  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

torch.Size([157782, 128])
torch.Size([129940, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1948103904724121  GigaBytes
Max Memory Allocated: 0.210205078125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023036912083625793 |0.01329609751701355 |0.003449171781539917 |9.426474571228027e-05 |0.00344046950340271 |0.0016214847564697266 |
----------------------------------------------------------pseudo_mini_loss sum 4.333927154541016
Total (block generation + training)time/epoch 39.0611834526062
Training time/epoch 0.7234530448913574
Training time without block to device /epoch 0.5107154846191406
Training time without total dataloading part /epoch 0.11336398124694824
load block tensor time/epoch 0.3685905933380127
block to device time/epoch 0.2127375602722168
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5330906
Number of first layer input nodes during this epoch:  2522264
