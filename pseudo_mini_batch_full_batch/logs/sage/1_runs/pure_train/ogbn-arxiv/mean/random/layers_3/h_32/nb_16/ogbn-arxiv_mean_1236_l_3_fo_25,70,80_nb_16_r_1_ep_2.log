Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648354161.3549008
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028155088424682617
random selection method range initialization spend 0.0065310001373291016
time for parepare:  0.01865363121032715
local_output_nid generation:  0.0021026134490966797
local_in_edges_tensor generation:  0.0049304962158203125
mini_batch_src_global generation:  0.001970529556274414
r_  generation:  0.020062923431396484
local_output_nid generation:  0.0025527477264404297
local_in_edges_tensor generation:  0.0017459392547607422
mini_batch_src_global generation:  0.0024442672729492188
r_  generation:  0.02040266990661621
local_output_nid generation:  0.0029153823852539062
local_in_edges_tensor generation:  0.0016503334045410156
mini_batch_src_global generation:  0.001565694808959961
r_  generation:  0.020352602005004883
local_output_nid generation:  0.002902507781982422
local_in_edges_tensor generation:  0.0016057491302490234
mini_batch_src_global generation:  0.001562356948852539
r_  generation:  0.020281553268432617
local_output_nid generation:  0.0028781890869140625
local_in_edges_tensor generation:  0.0016057491302490234
mini_batch_src_global generation:  0.0015714168548583984
r_  generation:  0.020420551300048828
local_output_nid generation:  0.0028409957885742188
local_in_edges_tensor generation:  0.0015878677368164062
mini_batch_src_global generation:  0.0016093254089355469
r_  generation:  0.021131038665771484
local_output_nid generation:  0.002850055694580078
local_in_edges_tensor generation:  0.0015435218811035156
mini_batch_src_global generation:  0.0016334056854248047
r_  generation:  0.02101874351501465
local_output_nid generation:  0.0028553009033203125
local_in_edges_tensor generation:  0.001535177230834961
mini_batch_src_global generation:  0.0016891956329345703
r_  generation:  0.02084517478942871
local_output_nid generation:  0.0028955936431884766
local_in_edges_tensor generation:  0.0016109943389892578
mini_batch_src_global generation:  0.0016679763793945312
r_  generation:  0.02141404151916504
local_output_nid generation:  0.002927064895629883
local_in_edges_tensor generation:  0.0015735626220703125
mini_batch_src_global generation:  0.0016603469848632812
r_  generation:  0.021351337432861328
local_output_nid generation:  0.002910137176513672
local_in_edges_tensor generation:  0.001575469970703125
mini_batch_src_global generation:  0.0016808509826660156
r_  generation:  0.021239757537841797
local_output_nid generation:  0.002907276153564453
local_in_edges_tensor generation:  0.0015332698822021484
mini_batch_src_global generation:  0.0017774105072021484
r_  generation:  0.021659374237060547
local_output_nid generation:  0.0029304027557373047
local_in_edges_tensor generation:  0.0015864372253417969
mini_batch_src_global generation:  0.0017247200012207031
r_  generation:  0.02134561538696289
local_output_nid generation:  0.002960205078125
local_in_edges_tensor generation:  0.0015614032745361328
mini_batch_src_global generation:  0.001710653305053711
r_  generation:  0.021887779235839844
local_output_nid generation:  0.0029420852661132812
local_in_edges_tensor generation:  0.0015501976013183594
mini_batch_src_global generation:  0.0016853809356689453
r_  generation:  0.020635604858398438
local_output_nid generation:  0.0029234886169433594
local_in_edges_tensor generation:  0.0015301704406738281
mini_batch_src_global generation:  0.0017018318176269531
r_  generation:  0.020797014236450195
----------------------check_connections_block total spend ----------------------------- 0.5393466949462891
generate_one_block  0.03032827377319336
generate_one_block  0.0316164493560791
generate_one_block  0.03480648994445801
generate_one_block  0.03159451484680176
generate_one_block  0.03139352798461914
generate_one_block  0.031258583068847656
generate_one_block  0.030772924423217773
generate_one_block  0.030573129653930664
generate_one_block  0.031239748001098633
generate_one_block  0.03172421455383301
generate_one_block  0.030834436416625977
generate_one_block  0.03149008750915527
generate_one_block  0.03019881248474121
generate_one_block  0.03098607063293457
generate_one_block  0.02971816062927246
generate_one_block  0.030382633209228516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04393601417541504
gen group dst list time:  0.020415782928466797
time for parepare:  0.019473791122436523
local_output_nid generation:  0.009396553039550781
local_in_edges_tensor generation:  0.022942066192626953
mini_batch_src_global generation:  0.026706695556640625
r_  generation:  0.2445695400238037
local_output_nid generation:  0.015863895416259766
local_in_edges_tensor generation:  0.02549123764038086
mini_batch_src_global generation:  0.03238654136657715
r_  generation:  0.258101224899292
local_output_nid generation:  0.0162203311920166
local_in_edges_tensor generation:  0.023594141006469727
mini_batch_src_global generation:  0.03160881996154785
r_  generation:  0.26880383491516113
local_output_nid generation:  0.016108989715576172
local_in_edges_tensor generation:  0.020812511444091797
mini_batch_src_global generation:  0.032347917556762695
r_  generation:  0.26742100715637207
local_output_nid generation:  0.0158538818359375
local_in_edges_tensor generation:  0.02101612091064453
mini_batch_src_global generation:  0.03261971473693848
r_  generation:  0.26872920989990234
local_output_nid generation:  0.01602959632873535
local_in_edges_tensor generation:  0.018070697784423828
mini_batch_src_global generation:  0.03366518020629883
r_  generation:  0.2694096565246582
local_output_nid generation:  0.015825510025024414
local_in_edges_tensor generation:  0.02298569679260254
mini_batch_src_global generation:  0.03564047813415527
r_  generation:  0.2718534469604492
local_output_nid generation:  0.015722274780273438
local_in_edges_tensor generation:  0.01629805564880371
mini_batch_src_global generation:  0.03346443176269531
r_  generation:  0.26623082160949707
local_output_nid generation:  0.01569199562072754
local_in_edges_tensor generation:  0.015405416488647461
mini_batch_src_global generation:  0.03400373458862305
r_  generation:  0.26984167098999023
local_output_nid generation:  0.016156911849975586
local_in_edges_tensor generation:  0.02058267593383789
mini_batch_src_global generation:  0.03731584548950195
r_  generation:  0.2765340805053711
local_output_nid generation:  0.015605449676513672
local_in_edges_tensor generation:  0.015720605850219727
mini_batch_src_global generation:  0.03387761116027832
r_  generation:  0.2688565254211426
local_output_nid generation:  0.016093730926513672
local_in_edges_tensor generation:  0.017848491668701172
mini_batch_src_global generation:  0.03401589393615723
r_  generation:  0.27565908432006836
local_output_nid generation:  0.015691280364990234
local_in_edges_tensor generation:  0.020265817642211914
mini_batch_src_global generation:  0.03364205360412598
r_  generation:  0.26730942726135254
local_output_nid generation:  0.015626907348632812
local_in_edges_tensor generation:  0.017822265625
mini_batch_src_global generation:  0.034134626388549805
r_  generation:  0.26930809020996094
local_output_nid generation:  0.0154571533203125
local_in_edges_tensor generation:  0.016188621520996094
mini_batch_src_global generation:  0.03394818305969238
r_  generation:  0.26876044273376465
local_output_nid generation:  0.01571965217590332
local_in_edges_tensor generation:  0.01741623878479004
mini_batch_src_global generation:  0.033350229263305664
r_  generation:  0.2693755626678467
----------------------check_connections_block total spend ----------------------------- 6.300663471221924
generate_one_block  0.3462955951690674
generate_one_block  0.3649446964263916
generate_one_block  0.3650648593902588
generate_one_block  0.35359811782836914
generate_one_block  0.3697700500488281
generate_one_block  0.3544909954071045
generate_one_block  0.35758352279663086
generate_one_block  0.3521597385406494
generate_one_block  0.352463960647583
generate_one_block  0.3651692867279053
generate_one_block  0.3491940498352051
generate_one_block  0.35724449157714844
generate_one_block  0.3494124412536621
generate_one_block  0.35158848762512207
generate_one_block  0.35642576217651367
generate_one_block  0.34613466262817383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0322566032409668
gen group dst list time:  0.06286978721618652
time for parepare:  0.019072294235229492
local_output_nid generation:  0.02612900733947754
local_in_edges_tensor generation:  0.04156494140625
mini_batch_src_global generation:  0.04205965995788574
r_  generation:  0.4501991271972656
local_output_nid generation:  0.03218841552734375
local_in_edges_tensor generation:  0.04914259910583496
mini_batch_src_global generation:  0.0528721809387207
r_  generation:  0.4559946060180664
local_output_nid generation:  0.03178548812866211
local_in_edges_tensor generation:  0.0445709228515625
mini_batch_src_global generation:  0.051041603088378906
r_  generation:  0.46852922439575195
local_output_nid generation:  0.03185749053955078
local_in_edges_tensor generation:  0.037029266357421875
mini_batch_src_global generation:  0.05236029624938965
r_  generation:  0.4688534736633301
local_output_nid generation:  0.031832218170166016
local_in_edges_tensor generation:  0.03650641441345215
mini_batch_src_global generation:  0.055666446685791016
r_  generation:  0.4784891605377197
local_output_nid generation:  0.03197336196899414
local_in_edges_tensor generation:  0.032959699630737305
mini_batch_src_global generation:  0.052854061126708984
r_  generation:  0.471621036529541
local_output_nid generation:  0.03231024742126465
local_in_edges_tensor generation:  0.032451629638671875
mini_batch_src_global generation:  0.053137779235839844
r_  generation:  0.47542428970336914
local_output_nid generation:  0.03189563751220703
local_in_edges_tensor generation:  0.03714776039123535
mini_batch_src_global generation:  0.05380892753601074
r_  generation:  0.47505736351013184
local_output_nid generation:  0.03311610221862793
local_in_edges_tensor generation:  0.03741645812988281
mini_batch_src_global generation:  0.05639791488647461
r_  generation:  0.479900598526001
local_output_nid generation:  0.03255486488342285
local_in_edges_tensor generation:  0.04112601280212402
mini_batch_src_global generation:  0.053424835205078125
r_  generation:  0.4743666648864746
local_output_nid generation:  0.03200840950012207
local_in_edges_tensor generation:  0.0337681770324707
mini_batch_src_global generation:  0.053830862045288086
r_  generation:  0.4808220863342285
local_output_nid generation:  0.03211379051208496
local_in_edges_tensor generation:  0.03634071350097656
mini_batch_src_global generation:  0.05752682685852051
r_  generation:  0.47621774673461914
local_output_nid generation:  0.03241610527038574
local_in_edges_tensor generation:  0.03349423408508301
mini_batch_src_global generation:  0.05406832695007324
r_  generation:  0.48464202880859375
local_output_nid generation:  0.03210759162902832
local_in_edges_tensor generation:  0.036437273025512695
mini_batch_src_global generation:  0.05402040481567383
r_  generation:  0.4775698184967041
local_output_nid generation:  0.031899452209472656
local_in_edges_tensor generation:  0.03697943687438965
mini_batch_src_global generation:  0.057108163833618164
r_  generation:  0.47689056396484375
local_output_nid generation:  0.03233647346496582
local_in_edges_tensor generation:  0.04550766944885254
mini_batch_src_global generation:  0.054151296615600586
r_  generation:  0.4738485813140869
----------------------check_connections_block total spend ----------------------------- 11.23562741279602
generate_one_block  0.5955617427825928
generate_one_block  0.6007945537567139
generate_one_block  0.6026196479797363
generate_one_block  0.6176002025604248
generate_one_block  0.5951666831970215
generate_one_block  0.581627607345581
generate_one_block  0.6436889171600342
generate_one_block  0.6061906814575195
generate_one_block  0.6067187786102295
generate_one_block  0.6213235855102539
generate_one_block  0.5978505611419678
generate_one_block  0.5976438522338867
generate_one_block  0.5886454582214355
generate_one_block  0.6062676906585693
generate_one_block  0.5991950035095215
generate_one_block  0.6035983562469482
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  17.536290884017944
block generation total time  15.35603404045105
average batch blocks generation time:  0.9597521275281906
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09221553802490234  GigaBytes
Max Memory Allocated: 0.09221553802490234  GigaBytes

torch.Size([156477, 128])
torch.Size([129192, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.18744754791259766  GigaBytes
Max Memory Allocated: 0.18994140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09437370300292969  GigaBytes
Max Memory Allocated: 0.20146608352661133  GigaBytes

torch.Size([156746, 128])
torch.Size([129496, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18916893005371094  GigaBytes
Max Memory Allocated: 0.20146608352661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09469413757324219  GigaBytes
Max Memory Allocated: 0.2027416229248047  GigaBytes

torch.Size([157212, 128])
torch.Size([130816, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1901707649230957  GigaBytes
Max Memory Allocated: 0.2027416229248047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09463357925415039  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([157401, 128])
torch.Size([130612, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18960285186767578  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.094451904296875  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([157136, 128])
torch.Size([130673, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18932533264160156  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.0941162109375  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156408, 128])
torch.Size([129016, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18881893157958984  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09455347061157227  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([157179, 128])
torch.Size([130345, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1894054412841797  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09412479400634766  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156622, 128])
torch.Size([129509, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18833160400390625  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.0944223403930664  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([157084, 128])
torch.Size([130218, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1891307830810547  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09447717666625977  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156897, 128])
torch.Size([130094, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1895294189453125  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09424304962158203  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156912, 128])
torch.Size([129782, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18842077255249023  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09436416625976562  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156756, 128])
torch.Size([129948, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18930292129516602  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09425592422485352  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156925, 128])
torch.Size([130101, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1887669563293457  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09414148330688477  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156591, 128])
torch.Size([129588, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18875837326049805  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09409046173095703  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156734, 128])
torch.Size([129540, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18804407119750977  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09412574768066406  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156822, 128])
torch.Size([130328, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1883544921875  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034186601638793945 |0.0353805273771286 |0.05076754093170166 |9.897351264953613e-05 |0.00788930058479309 |0.0037355422973632812 |
----------------------------------------------------------pseudo_mini_loss sum 5.053243160247803
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5319358
Number of first layer input nodes during this epoch:  2509902
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.13135576248168945  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025402307510375977
random selection method range initialization spend 0.0052814483642578125
time for parepare:  0.01805424690246582
local_output_nid generation:  0.002395153045654297
local_in_edges_tensor generation:  0.008522748947143555
mini_batch_src_global generation:  0.0019915103912353516
r_  generation:  0.01965165138244629
local_output_nid generation:  0.0031087398529052734
local_in_edges_tensor generation:  0.0017223358154296875
mini_batch_src_global generation:  0.002468109130859375
r_  generation:  0.02054429054260254
local_output_nid generation:  0.0030090808868408203
local_in_edges_tensor generation:  0.0016815662384033203
mini_batch_src_global generation:  0.0016052722930908203
r_  generation:  0.020616769790649414
local_output_nid generation:  0.002955913543701172
local_in_edges_tensor generation:  0.00160980224609375
mini_batch_src_global generation:  0.0016388893127441406
r_  generation:  0.021254777908325195
local_output_nid generation:  0.002948284149169922
local_in_edges_tensor generation:  0.0016028881072998047
mini_batch_src_global generation:  0.0015935897827148438
r_  generation:  0.020889759063720703
local_output_nid generation:  0.003003358840942383
local_in_edges_tensor generation:  0.00160980224609375
mini_batch_src_global generation:  0.001626729965209961
r_  generation:  0.02148723602294922
local_output_nid generation:  0.0029854774475097656
local_in_edges_tensor generation:  0.0015578269958496094
mini_batch_src_global generation:  0.0016210079193115234
r_  generation:  0.02175140380859375
local_output_nid generation:  0.0029375553131103516
local_in_edges_tensor generation:  0.0015423297882080078
mini_batch_src_global generation:  0.0016672611236572266
r_  generation:  0.021240949630737305
local_output_nid generation:  0.0029163360595703125
local_in_edges_tensor generation:  0.001516103744506836
mini_batch_src_global generation:  0.0016338825225830078
r_  generation:  0.021347522735595703
local_output_nid generation:  0.0029342174530029297
local_in_edges_tensor generation:  0.0015444755554199219
mini_batch_src_global generation:  0.0017142295837402344
r_  generation:  0.022048234939575195
local_output_nid generation:  0.0029256343841552734
local_in_edges_tensor generation:  0.0015153884887695312
mini_batch_src_global generation:  0.0017657279968261719
r_  generation:  0.022182941436767578
local_output_nid generation:  0.0030329227447509766
local_in_edges_tensor generation:  0.0014941692352294922
mini_batch_src_global generation:  0.0017249584197998047
r_  generation:  0.02190423011779785
local_output_nid generation:  0.0029878616333007812
local_in_edges_tensor generation:  0.001508474349975586
mini_batch_src_global generation:  0.0017437934875488281
r_  generation:  0.02164769172668457
local_output_nid generation:  0.0029382705688476562
local_in_edges_tensor generation:  0.001474618911743164
mini_batch_src_global generation:  0.001689910888671875
r_  generation:  0.022069454193115234
local_output_nid generation:  0.0029277801513671875
local_in_edges_tensor generation:  0.0015017986297607422
mini_batch_src_global generation:  0.001714944839477539
r_  generation:  0.021704673767089844
local_output_nid generation:  0.0029573440551757812
local_in_edges_tensor generation:  0.0015611648559570312
mini_batch_src_global generation:  0.0017304420471191406
r_  generation:  0.02167344093322754
----------------------check_connections_block total spend ----------------------------- 0.5551340579986572
generate_one_block  0.037714481353759766
generate_one_block  0.03138899803161621
generate_one_block  0.03145623207092285
generate_one_block  0.032242536544799805
generate_one_block  0.030904531478881836
generate_one_block  0.03447699546813965
generate_one_block  0.032010793685913086
generate_one_block  0.031096220016479492
generate_one_block  0.030926227569580078
generate_one_block  0.03185915946960449
generate_one_block  0.031983137130737305
generate_one_block  0.03207039833068848
generate_one_block  0.03111100196838379
generate_one_block  0.03160405158996582
generate_one_block  0.031549692153930664
generate_one_block  0.03221440315246582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03560662269592285
gen group dst list time:  0.019409656524658203
time for parepare:  0.019022226333618164
local_output_nid generation:  0.008849382400512695
local_in_edges_tensor generation:  0.026399612426757812
mini_batch_src_global generation:  0.026562929153442383
r_  generation:  0.24349737167358398
local_output_nid generation:  0.013058662414550781
local_in_edges_tensor generation:  0.023808717727661133
mini_batch_src_global generation:  0.034271955490112305
r_  generation:  0.25483083724975586
local_output_nid generation:  0.013823509216308594
local_in_edges_tensor generation:  0.02163100242614746
mini_batch_src_global generation:  0.03366422653198242
r_  generation:  0.2644355297088623
local_output_nid generation:  0.013807058334350586
local_in_edges_tensor generation:  0.016930818557739258
mini_batch_src_global generation:  0.03633403778076172
r_  generation:  0.2679154872894287
local_output_nid generation:  0.01282501220703125
local_in_edges_tensor generation:  0.01931166648864746
mini_batch_src_global generation:  0.03244662284851074
r_  generation:  0.2651388645172119
local_output_nid generation:  0.013417482376098633
local_in_edges_tensor generation:  0.014541387557983398
mini_batch_src_global generation:  0.03461480140686035
r_  generation:  0.2706892490386963
local_output_nid generation:  0.012931585311889648
local_in_edges_tensor generation:  0.019397735595703125
mini_batch_src_global generation:  0.0392155647277832
r_  generation:  0.27568650245666504
local_output_nid generation:  0.013913869857788086
local_in_edges_tensor generation:  0.01678180694580078
mini_batch_src_global generation:  0.041301727294921875
r_  generation:  0.2802698612213135
local_output_nid generation:  0.015580892562866211
local_in_edges_tensor generation:  0.03131818771362305
mini_batch_src_global generation:  0.036272525787353516
r_  generation:  0.2708711624145508
local_output_nid generation:  0.013784408569335938
local_in_edges_tensor generation:  0.0170748233795166
mini_batch_src_global generation:  0.03369593620300293
r_  generation:  0.2754707336425781
local_output_nid generation:  0.013711929321289062
local_in_edges_tensor generation:  0.01930832862854004
mini_batch_src_global generation:  0.03423309326171875
r_  generation:  0.27992701530456543
local_output_nid generation:  0.013490438461303711
local_in_edges_tensor generation:  0.014159679412841797
mini_batch_src_global generation:  0.03445863723754883
r_  generation:  0.27611279487609863
local_output_nid generation:  0.013559103012084961
local_in_edges_tensor generation:  0.0157318115234375
mini_batch_src_global generation:  0.038706064224243164
r_  generation:  0.27158474922180176
local_output_nid generation:  0.014369010925292969
local_in_edges_tensor generation:  0.018918514251708984
mini_batch_src_global generation:  0.03743600845336914
r_  generation:  0.2908656597137451
local_output_nid generation:  0.01569962501525879
local_in_edges_tensor generation:  0.027601003646850586
mini_batch_src_global generation:  0.036432743072509766
r_  generation:  0.2742323875427246
local_output_nid generation:  0.013266563415527344
local_in_edges_tensor generation:  0.015429019927978516
mini_batch_src_global generation:  0.03349637985229492
r_  generation:  0.2696235179901123
----------------------check_connections_block total spend ----------------------------- 6.37651515007019
generate_one_block  0.35950255393981934
generate_one_block  0.34544873237609863
generate_one_block  0.3664839267730713
generate_one_block  0.3574380874633789
generate_one_block  0.3512148857116699
generate_one_block  0.35637998580932617
generate_one_block  0.38861942291259766
generate_one_block  0.34464335441589355
generate_one_block  0.35268592834472656
generate_one_block  0.3535284996032715
generate_one_block  0.3634340763092041
generate_one_block  0.3518669605255127
generate_one_block  0.34824609756469727
generate_one_block  0.3512856960296631
generate_one_block  0.359088659286499
generate_one_block  0.34778594970703125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.12595391273498535
gen group dst list time:  0.06480145454406738
time for parepare:  0.018207311630249023
local_output_nid generation:  0.027179956436157227
local_in_edges_tensor generation:  0.05458354949951172
mini_batch_src_global generation:  0.04590153694152832
r_  generation:  0.45112180709838867
local_output_nid generation:  0.03250527381896973
local_in_edges_tensor generation:  0.049198150634765625
mini_batch_src_global generation:  0.05236077308654785
r_  generation:  0.46225810050964355
local_output_nid generation:  0.0325009822845459
local_in_edges_tensor generation:  0.04081892967224121
mini_batch_src_global generation:  0.05058431625366211
r_  generation:  0.466372013092041
local_output_nid generation:  0.032587528228759766
local_in_edges_tensor generation:  0.03216290473937988
mini_batch_src_global generation:  0.05187177658081055
r_  generation:  0.46810030937194824
local_output_nid generation:  0.03269004821777344
local_in_edges_tensor generation:  0.07930302619934082
mini_batch_src_global generation:  0.05175161361694336
r_  generation:  0.4764382839202881
local_output_nid generation:  0.032774925231933594
local_in_edges_tensor generation:  0.040723323822021484
mini_batch_src_global generation:  0.055795907974243164
r_  generation:  0.47371387481689453
local_output_nid generation:  0.03302168846130371
local_in_edges_tensor generation:  0.036000728607177734
mini_batch_src_global generation:  0.0531156063079834
r_  generation:  0.4767031669616699
local_output_nid generation:  0.0331118106842041
local_in_edges_tensor generation:  0.031987905502319336
mini_batch_src_global generation:  0.0564727783203125
r_  generation:  0.47644925117492676
local_output_nid generation:  0.03260469436645508
local_in_edges_tensor generation:  0.03194904327392578
mini_batch_src_global generation:  0.05616641044616699
r_  generation:  0.4825875759124756
local_output_nid generation:  0.0336000919342041
local_in_edges_tensor generation:  0.04586362838745117
mini_batch_src_global generation:  0.05680274963378906
r_  generation:  0.4783821105957031
local_output_nid generation:  0.03258061408996582
local_in_edges_tensor generation:  0.032068490982055664
mini_batch_src_global generation:  0.052831172943115234
r_  generation:  0.4830143451690674
local_output_nid generation:  0.032762765884399414
local_in_edges_tensor generation:  0.032170772552490234
mini_batch_src_global generation:  0.05316019058227539
r_  generation:  0.48436665534973145
local_output_nid generation:  0.03348994255065918
local_in_edges_tensor generation:  0.04462289810180664
mini_batch_src_global generation:  0.05250716209411621
r_  generation:  0.47867798805236816
local_output_nid generation:  0.03328824043273926
local_in_edges_tensor generation:  0.04478096961975098
mini_batch_src_global generation:  0.05310559272766113
r_  generation:  0.48064517974853516
local_output_nid generation:  0.03312802314758301
local_in_edges_tensor generation:  0.036203861236572266
mini_batch_src_global generation:  0.05607867240905762
r_  generation:  0.4860987663269043
local_output_nid generation:  0.033261775970458984
local_in_edges_tensor generation:  0.0345156192779541
mini_batch_src_global generation:  0.05555987358093262
r_  generation:  0.4776127338409424
----------------------check_connections_block total spend ----------------------------- 11.338618516921997
generate_one_block  0.5818448066711426
generate_one_block  0.5929067134857178
generate_one_block  0.6155951023101807
generate_one_block  0.5940475463867188
generate_one_block  0.5901792049407959
generate_one_block  0.5986559391021729
generate_one_block  0.5850241184234619
generate_one_block  0.5900478363037109
generate_one_block  0.6292786598205566
generate_one_block  0.5976336002349854
generate_one_block  0.5826592445373535
generate_one_block  0.6062512397766113
generate_one_block  0.6009948253631592
generate_one_block  0.6085209846496582
generate_one_block  0.6060068607330322
generate_one_block  0.5869896411895752
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.13135576248168945  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

connection checking time:  17.715133666992188
block generation total time  15.264289140701294
average batch blocks generation time:  0.9540180712938309
block dataloader generation time/epoch 35.32647681236267
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.0942239761352539  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156731, 128])
torch.Size([129423, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18826723098754883  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09433841705322266  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([157024, 128])
torch.Size([130187, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18888139724731445  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09453105926513672  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156922, 128])
torch.Size([130005, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18927812576293945  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09435415267944336  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156577, 128])
torch.Size([129732, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18920087814331055  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09428977966308594  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156804, 128])
torch.Size([129917, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18854522705078125  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09448909759521484  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156926, 128])
torch.Size([130447, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18938398361206055  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09448814392089844  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156802, 128])
torch.Size([129942, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18926382064819336  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09415006637573242  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156493, 128])
torch.Size([129646, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18839550018310547  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.0943155288696289  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156648, 128])
torch.Size([129716, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18887853622436523  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.0944528579711914  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156950, 128])
torch.Size([129969, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18941783905029297  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09456157684326172  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156846, 128])
torch.Size([129580, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18943452835083008  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09447097778320312  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156910, 128])
torch.Size([129781, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18931341171264648  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.0943746566772461  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156968, 128])
torch.Size([130176, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18889379501342773  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09445476531982422  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156956, 128])
torch.Size([130238, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18930625915527344  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.0945429801940918  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([157071, 128])
torch.Size([130398, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18949079513549805  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09440088272094727  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

torch.Size([156955, 128])
torch.Size([130014, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18905973434448242  GigaBytes
Max Memory Allocated: 0.2034616470336914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03036344051361084 |0.013606831431388855 |0.0034198015928268433 |9.08970832824707e-05 |0.0035468637943267822 |0.0016376972198486328 |
----------------------------------------------------------pseudo_mini_loss sum 4.347385883331299
Total (block generation + training)time/epoch 36.172945499420166
Training time/epoch 0.8462622165679932
Training time without block to device /epoch 0.6285529136657715
Training time without total dataloading part /epoch 0.11455869674682617
load block tensor time/epoch 0.48581504821777344
block to device time/epoch 0.21770930290222168
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5318614
Number of first layer input nodes during this epoch:  2509583
