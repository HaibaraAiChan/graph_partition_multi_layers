Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648356115.1873682
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02695012092590332
random selection method range initialization spend 0.007771968841552734
time for parepare:  0.021785497665405273
local_output_nid generation:  0.004458427429199219
local_in_edges_tensor generation:  0.006186485290527344
mini_batch_src_global generation:  0.00457763671875
r_  generation:  0.04581165313720703
local_output_nid generation:  0.007314443588256836
local_in_edges_tensor generation:  0.003725290298461914
mini_batch_src_global generation:  0.005666255950927734
r_  generation:  0.047298431396484375
local_output_nid generation:  0.007497549057006836
local_in_edges_tensor generation:  0.003787994384765625
mini_batch_src_global generation:  0.0038471221923828125
r_  generation:  0.04742741584777832
local_output_nid generation:  0.007536411285400391
local_in_edges_tensor generation:  0.003831148147583008
mini_batch_src_global generation:  0.0042476654052734375
r_  generation:  0.04916787147521973
local_output_nid generation:  0.0075588226318359375
local_in_edges_tensor generation:  0.003824949264526367
mini_batch_src_global generation:  0.004520416259765625
r_  generation:  0.050722360610961914
local_output_nid generation:  0.007654666900634766
local_in_edges_tensor generation:  0.0038301944732666016
mini_batch_src_global generation:  0.004992246627807617
r_  generation:  0.05144762992858887
local_output_nid generation:  0.007662296295166016
local_in_edges_tensor generation:  0.003755807876586914
mini_batch_src_global generation:  0.0048274993896484375
r_  generation:  0.04954671859741211
local_output_nid generation:  0.007729768753051758
local_in_edges_tensor generation:  0.0038385391235351562
mini_batch_src_global generation:  0.004137992858886719
r_  generation:  0.048558712005615234
----------------------check_connections_block total spend ----------------------------- 0.6401505470275879
generate_one_block  0.0633535385131836
generate_one_block  0.06294584274291992
generate_one_block  0.06233477592468262
generate_one_block  0.06415176391601562
generate_one_block  0.06742501258850098
generate_one_block  0.06531071662902832
generate_one_block  0.06403040885925293
generate_one_block  0.06292176246643066
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04002833366394043
gen group dst list time:  0.01669764518737793
time for parepare:  0.019162654876708984
local_output_nid generation:  0.015313863754272461
local_in_edges_tensor generation:  0.03716135025024414
mini_batch_src_global generation:  0.03545260429382324
r_  generation:  0.36784815788269043
local_output_nid generation:  0.021160364151000977
local_in_edges_tensor generation:  0.03780174255371094
mini_batch_src_global generation:  0.045296669006347656
r_  generation:  0.38363146781921387
local_output_nid generation:  0.02403712272644043
local_in_edges_tensor generation:  0.0274505615234375
mini_batch_src_global generation:  0.043633460998535156
r_  generation:  0.3886237144470215
local_output_nid generation:  0.021306514739990234
local_in_edges_tensor generation:  0.0382235050201416
mini_batch_src_global generation:  0.05863046646118164
r_  generation:  0.39592981338500977
local_output_nid generation:  0.022203922271728516
local_in_edges_tensor generation:  0.02900075912475586
mini_batch_src_global generation:  0.04592394828796387
r_  generation:  0.3829665184020996
local_output_nid generation:  0.020380020141601562
local_in_edges_tensor generation:  0.02790236473083496
mini_batch_src_global generation:  0.04638838768005371
r_  generation:  0.38768625259399414
local_output_nid generation:  0.01994013786315918
local_in_edges_tensor generation:  0.02005767822265625
mini_batch_src_global generation:  0.04635024070739746
r_  generation:  0.38149142265319824
local_output_nid generation:  0.02054882049560547
local_in_edges_tensor generation:  0.02027726173400879
mini_batch_src_global generation:  0.04644918441772461
r_  generation:  0.382220983505249
----------------------check_connections_block total spend ----------------------------- 4.501951217651367
generate_one_block  0.49859070777893066
generate_one_block  0.5148208141326904
generate_one_block  0.4985616207122803
generate_one_block  0.5133872032165527
generate_one_block  0.5273988246917725
generate_one_block  0.5232689380645752
generate_one_block  0.4979264736175537
generate_one_block  0.5155854225158691
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03850126266479492
gen group dst list time:  0.03855156898498535
time for parepare:  0.019011974334716797
local_output_nid generation:  0.030367374420166016
local_in_edges_tensor generation:  0.06202363967895508
mini_batch_src_global generation:  0.0510251522064209
r_  generation:  0.48990535736083984
local_output_nid generation:  0.03660011291503906
local_in_edges_tensor generation:  0.05515170097351074
mini_batch_src_global generation:  0.05862879753112793
r_  generation:  0.5047342777252197
local_output_nid generation:  0.0379946231842041
local_in_edges_tensor generation:  0.04323601722717285
mini_batch_src_global generation:  0.056897640228271484
r_  generation:  0.48833346366882324
local_output_nid generation:  0.03665661811828613
local_in_edges_tensor generation:  0.0414433479309082
mini_batch_src_global generation:  0.05553126335144043
r_  generation:  0.4974076747894287
local_output_nid generation:  0.03677725791931152
local_in_edges_tensor generation:  0.04113483428955078
mini_batch_src_global generation:  0.05368924140930176
r_  generation:  0.5023431777954102
local_output_nid generation:  0.03646278381347656
local_in_edges_tensor generation:  0.03609347343444824
mini_batch_src_global generation:  0.05732297897338867
r_  generation:  0.5040340423583984
local_output_nid generation:  0.03650856018066406
local_in_edges_tensor generation:  0.032798051834106445
mini_batch_src_global generation:  0.053743600845336914
r_  generation:  0.5046696662902832
local_output_nid generation:  0.03641986846923828
local_in_edges_tensor generation:  0.03253674507141113
mini_batch_src_global generation:  0.05474853515625
r_  generation:  0.5029723644256592
----------------------check_connections_block total spend ----------------------------- 5.983930826187134
generate_one_block  0.6386795043945312
generate_one_block  0.6282353401184082
generate_one_block  0.6133332252502441
generate_one_block  0.6248757839202881
generate_one_block  0.6361088752746582
generate_one_block  0.629591703414917
generate_one_block  0.6640472412109375
generate_one_block  0.6169319152832031
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  10.485882043838501
block generation total time  9.141343593597412
average batch blocks generation time:  1.1426679491996765
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.09972953796386719  GigaBytes
Max Memory Allocated: 0.09972953796386719  GigaBytes

torch.Size([162124, 128])
torch.Size([145930, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.31558847427368164  GigaBytes
Max Memory Allocated: 0.32867002487182617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.10209083557128906  GigaBytes
Max Memory Allocated: 0.3503756523132324  GigaBytes

torch.Size([162095, 128])
torch.Size([145906, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.31693553924560547  GigaBytes
Max Memory Allocated: 0.3503756523132324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.1018986701965332  GigaBytes
Max Memory Allocated: 0.3514823913574219  GigaBytes

torch.Size([162280, 128])
torch.Size([145722, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.31542491912841797  GigaBytes
Max Memory Allocated: 0.3514823913574219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.1019124984741211  GigaBytes
Max Memory Allocated: 0.3514823913574219  GigaBytes

torch.Size([162278, 128])
torch.Size([146146, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.31667041778564453  GigaBytes
Max Memory Allocated: 0.3514823913574219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.10212421417236328  GigaBytes
Max Memory Allocated: 0.3514823913574219  GigaBytes

torch.Size([162296, 128])
torch.Size([146052, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.31665802001953125  GigaBytes
Max Memory Allocated: 0.3514823913574219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.1022186279296875  GigaBytes
Max Memory Allocated: 0.3514823913574219  GigaBytes

torch.Size([162355, 128])
torch.Size([146396, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3171687126159668  GigaBytes
Max Memory Allocated: 0.3514823913574219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10190010070800781  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

torch.Size([162156, 128])
torch.Size([145884, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3163132667541504  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10213518142700195  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

torch.Size([162313, 128])
torch.Size([145797, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31615209579467773  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037730872631073 |0.0640140175819397 |0.09579017758369446 |0.0001062154769897461 |0.015662550926208496 |0.003837108612060547 |
----------------------------------------------------------pseudo_mini_loss sum 5.311753273010254
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3055217
Number of first layer input nodes during this epoch:  1297897
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.14816570281982422  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020557880401611328
random selection method range initialization spend 0.005408287048339844
time for parepare:  0.01801586151123047
local_output_nid generation:  0.004605770111083984
local_in_edges_tensor generation:  0.009860515594482422
mini_batch_src_global generation:  0.003957033157348633
r_  generation:  0.0416417121887207
local_output_nid generation:  0.006091117858886719
local_in_edges_tensor generation:  0.0035467147827148438
mini_batch_src_global generation:  0.004754304885864258
r_  generation:  0.043712615966796875
local_output_nid generation:  0.006157875061035156
local_in_edges_tensor generation:  0.0034689903259277344
mini_batch_src_global generation:  0.003319978713989258
r_  generation:  0.04661417007446289
local_output_nid generation:  0.0061817169189453125
local_in_edges_tensor generation:  0.003396749496459961
mini_batch_src_global generation:  0.003556966781616211
r_  generation:  0.046121835708618164
local_output_nid generation:  0.006157398223876953
local_in_edges_tensor generation:  0.0035207271575927734
mini_batch_src_global generation:  0.003748655319213867
r_  generation:  0.048653602600097656
local_output_nid generation:  0.006203651428222656
local_in_edges_tensor generation:  0.0034084320068359375
mini_batch_src_global generation:  0.004067420959472656
r_  generation:  0.04803466796875
local_output_nid generation:  0.006228446960449219
local_in_edges_tensor generation:  0.003433704376220703
mini_batch_src_global generation:  0.003951072692871094
r_  generation:  0.04824352264404297
local_output_nid generation:  0.006303310394287109
local_in_edges_tensor generation:  0.003559112548828125
mini_batch_src_global generation:  0.004022836685180664
r_  generation:  0.048920392990112305
----------------------check_connections_block total spend ----------------------------- 0.5917496681213379
generate_one_block  0.05907940864562988
generate_one_block  0.06048440933227539
generate_one_block  0.06654548645019531
generate_one_block  0.06298089027404785
generate_one_block  0.0656442642211914
generate_one_block  0.06863975524902344
generate_one_block  0.06548118591308594
generate_one_block  0.06386208534240723
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03682756423950195
gen group dst list time:  0.017498254776000977
time for parepare:  0.020568370819091797
local_output_nid generation:  0.016295433044433594
local_in_edges_tensor generation:  0.04569220542907715
mini_batch_src_global generation:  0.03738236427307129
r_  generation:  0.3932161331176758
local_output_nid generation:  0.025211811065673828
local_in_edges_tensor generation:  0.04075264930725098
mini_batch_src_global generation:  0.048120975494384766
r_  generation:  0.38913416862487793
local_output_nid generation:  0.0246889591217041
local_in_edges_tensor generation:  0.031159639358520508
mini_batch_src_global generation:  0.048911333084106445
r_  generation:  0.4315602779388428
local_output_nid generation:  0.03073906898498535
local_in_edges_tensor generation:  0.03831601142883301
mini_batch_src_global generation:  0.05101585388183594
r_  generation:  0.39798688888549805
local_output_nid generation:  0.025455474853515625
local_in_edges_tensor generation:  0.029541015625
mini_batch_src_global generation:  0.051955223083496094
r_  generation:  0.40289950370788574
local_output_nid generation:  0.025336503982543945
local_in_edges_tensor generation:  0.026665210723876953
mini_batch_src_global generation:  0.04964852333068848
r_  generation:  0.3997764587402344
local_output_nid generation:  0.025177955627441406
local_in_edges_tensor generation:  0.02567601203918457
mini_batch_src_global generation:  0.049399375915527344
r_  generation:  0.39781951904296875
local_output_nid generation:  0.025485754013061523
local_in_edges_tensor generation:  0.0254671573638916
mini_batch_src_global generation:  0.04976844787597656
r_  generation:  0.40280580520629883
----------------------check_connections_block total spend ----------------------------- 4.775342702865601
generate_one_block  0.48738551139831543
generate_one_block  0.4848761558532715
generate_one_block  0.531693696975708
generate_one_block  0.5008931159973145
generate_one_block  0.5053200721740723
generate_one_block  0.5245034694671631
generate_one_block  0.48969101905822754
generate_one_block  0.5378868579864502
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.043580055236816406
gen group dst list time:  0.04230189323425293
time for parepare:  0.022678136825561523
local_output_nid generation:  0.029987812042236328
local_in_edges_tensor generation:  0.055454254150390625
mini_batch_src_global generation:  0.04436516761779785
r_  generation:  0.4840269088745117
local_output_nid generation:  0.03515625
local_in_edges_tensor generation:  0.049391984939575195
mini_batch_src_global generation:  0.055230140686035156
r_  generation:  0.4859907627105713
local_output_nid generation:  0.035652875900268555
local_in_edges_tensor generation:  0.037303924560546875
mini_batch_src_global generation:  0.05887961387634277
r_  generation:  0.4974856376647949
local_output_nid generation:  0.03590679168701172
local_in_edges_tensor generation:  0.045562028884887695
mini_batch_src_global generation:  0.052793264389038086
r_  generation:  0.4966752529144287
local_output_nid generation:  0.03554511070251465
local_in_edges_tensor generation:  0.03693509101867676
mini_batch_src_global generation:  0.05345892906188965
r_  generation:  0.504063606262207
local_output_nid generation:  0.03542637825012207
local_in_edges_tensor generation:  0.03254508972167969
mini_batch_src_global generation:  0.053924560546875
r_  generation:  0.5040328502655029
local_output_nid generation:  0.0359346866607666
local_in_edges_tensor generation:  0.04655122756958008
mini_batch_src_global generation:  0.054775238037109375
r_  generation:  0.5101759433746338
local_output_nid generation:  0.03736543655395508
local_in_edges_tensor generation:  0.043730974197387695
mini_batch_src_global generation:  0.07084012031555176
r_  generation:  0.513763427734375
----------------------check_connections_block total spend ----------------------------- 5.991632699966431
generate_one_block  0.6294896602630615
generate_one_block  0.622849702835083
generate_one_block  0.6299967765808105
generate_one_block  0.6474285125732422
generate_one_block  0.6314640045166016
generate_one_block  0.6151611804962158
generate_one_block  0.6242554187774658
generate_one_block  0.6277024745941162
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.14816570281982422  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

connection checking time:  10.766975402832031
block generation total time  9.09059762954712
average batch blocks generation time:  1.13632470369339
block dataloader generation time/epoch 22.0152370929718
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.102386474609375  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

torch.Size([162392, 128])
torch.Size([146238, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.316495418548584  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10225296020507812  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

torch.Size([162081, 128])
torch.Size([145389, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31540775299072266  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10227012634277344  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

torch.Size([162198, 128])
torch.Size([146058, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3171553611755371  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10225868225097656  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

torch.Size([162337, 128])
torch.Size([146157, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31679868698120117  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10250186920166016  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

torch.Size([162227, 128])
torch.Size([145972, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31737518310546875  GigaBytes
Max Memory Allocated: 0.35204076766967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10228872299194336  GigaBytes
Max Memory Allocated: 0.352142333984375  GigaBytes

torch.Size([161960, 128])
torch.Size([145570, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3170018196105957  GigaBytes
Max Memory Allocated: 0.352142333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10225296020507812  GigaBytes
Max Memory Allocated: 0.352142333984375  GigaBytes

torch.Size([162150, 128])
torch.Size([145886, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3165006637573242  GigaBytes
Max Memory Allocated: 0.352142333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10255908966064453  GigaBytes
Max Memory Allocated: 0.352142333984375  GigaBytes

torch.Size([162223, 128])
torch.Size([145848, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3172163963317871  GigaBytes
Max Memory Allocated: 0.352142333984375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03840261697769165 |0.01643797755241394 |0.0035316944122314453 |9.715557098388672e-05 |0.006924152374267578 |0.0016393661499023438 |
----------------------------------------------------------pseudo_mini_loss sum 4.088799476623535
Total (block generation + training)time/epoch 22.56708574295044
Training time/epoch 0.5515501499176025
Training time without block to device /epoch 0.420046329498291
Training time without total dataloading part /epoch 0.08606338500976562
load block tensor time/epoch 0.3072209358215332
block to device time/epoch 0.13150382041931152
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3053713
Number of first layer input nodes during this epoch:  1297568
