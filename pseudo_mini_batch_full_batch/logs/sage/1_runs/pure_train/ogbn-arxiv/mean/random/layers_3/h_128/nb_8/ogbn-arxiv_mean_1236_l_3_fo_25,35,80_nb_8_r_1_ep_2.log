Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648357647.6638296
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026386737823486328
random selection method range initialization spend 0.006220102310180664
time for parepare:  0.01883387565612793
local_output_nid generation:  0.0041599273681640625
local_in_edges_tensor generation:  0.005376100540161133
mini_batch_src_global generation:  0.0037224292755126953
r_  generation:  0.04198431968688965
local_output_nid generation:  0.005975484848022461
local_in_edges_tensor generation:  0.003143310546875
mini_batch_src_global generation:  0.00462651252746582
r_  generation:  0.04292178153991699
local_output_nid generation:  0.006038188934326172
local_in_edges_tensor generation:  0.003268003463745117
mini_batch_src_global generation:  0.003278970718383789
r_  generation:  0.045989036560058594
local_output_nid generation:  0.006098508834838867
local_in_edges_tensor generation:  0.0031976699829101562
mini_batch_src_global generation:  0.0035774707794189453
r_  generation:  0.04763984680175781
local_output_nid generation:  0.006140947341918945
local_in_edges_tensor generation:  0.0032775402069091797
mini_batch_src_global generation:  0.0037653446197509766
r_  generation:  0.04708981513977051
local_output_nid generation:  0.00612640380859375
local_in_edges_tensor generation:  0.0032281875610351562
mini_batch_src_global generation:  0.003916263580322266
r_  generation:  0.0467529296875
local_output_nid generation:  0.006187915802001953
local_in_edges_tensor generation:  0.0031778812408447266
mini_batch_src_global generation:  0.0039942264556884766
r_  generation:  0.04765486717224121
local_output_nid generation:  0.006130695343017578
local_in_edges_tensor generation:  0.0031692981719970703
mini_batch_src_global generation:  0.0040340423583984375
r_  generation:  0.0478968620300293
----------------------check_connections_block total spend ----------------------------- 0.5793826580047607
generate_one_block  0.06086397171020508
generate_one_block  0.06047511100769043
generate_one_block  0.06274151802062988
generate_one_block  0.06312966346740723
generate_one_block  0.06573772430419922
generate_one_block  0.06234455108642578
generate_one_block  0.06183338165283203
generate_one_block  0.06262612342834473
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037606239318847656
gen group dst list time:  0.01645827293395996
time for parepare:  0.019188404083251953
local_output_nid generation:  0.013944387435913086
local_in_edges_tensor generation:  0.030794858932495117
mini_batch_src_global generation:  0.030225515365600586
r_  generation:  0.3119227886199951
local_output_nid generation:  0.01978302001953125
local_in_edges_tensor generation:  0.030695676803588867
mini_batch_src_global generation:  0.042624473571777344
r_  generation:  0.3184540271759033
local_output_nid generation:  0.02340865135192871
local_in_edges_tensor generation:  0.0257871150970459
mini_batch_src_global generation:  0.03786420822143555
r_  generation:  0.33351612091064453
local_output_nid generation:  0.0205228328704834
local_in_edges_tensor generation:  0.023949861526489258
mini_batch_src_global generation:  0.03957343101501465
r_  generation:  0.3430793285369873
local_output_nid generation:  0.019671201705932617
local_in_edges_tensor generation:  0.025054454803466797
mini_batch_src_global generation:  0.04005026817321777
r_  generation:  0.3343381881713867
local_output_nid generation:  0.019963741302490234
local_in_edges_tensor generation:  0.022357940673828125
mini_batch_src_global generation:  0.04096078872680664
r_  generation:  0.3435652256011963
local_output_nid generation:  0.01997971534729004
local_in_edges_tensor generation:  0.022405385971069336
mini_batch_src_global generation:  0.040884971618652344
r_  generation:  0.3381021022796631
local_output_nid generation:  0.020267009735107422
local_in_edges_tensor generation:  0.022535324096679688
mini_batch_src_global generation:  0.041306495666503906
r_  generation:  0.345304012298584
----------------------check_connections_block total spend ----------------------------- 3.9266133308410645
generate_one_block  0.4246525764465332
generate_one_block  0.42369699478149414
generate_one_block  0.43997812271118164
generate_one_block  0.44986939430236816
generate_one_block  0.4248790740966797
generate_one_block  0.4581310749053955
generate_one_block  0.4261970520019531
generate_one_block  0.44318556785583496
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03069901466369629
gen group dst list time:  0.036934852600097656
time for parepare:  0.019181489944458008
local_output_nid generation:  0.02847909927368164
local_in_edges_tensor generation:  0.04248356819152832
mini_batch_src_global generation:  0.043168067932128906
r_  generation:  0.47809934616088867
local_output_nid generation:  0.03539705276489258
local_in_edges_tensor generation:  0.04895305633544922
mini_batch_src_global generation:  0.05424332618713379
r_  generation:  0.4850020408630371
local_output_nid generation:  0.03514719009399414
local_in_edges_tensor generation:  0.04987049102783203
mini_batch_src_global generation:  0.05147075653076172
r_  generation:  0.4996166229248047
local_output_nid generation:  0.03506660461425781
local_in_edges_tensor generation:  0.04649543762207031
mini_batch_src_global generation:  0.05433011054992676
r_  generation:  0.4924583435058594
local_output_nid generation:  0.03612971305847168
local_in_edges_tensor generation:  0.04111146926879883
mini_batch_src_global generation:  0.05259275436401367
r_  generation:  0.5014946460723877
local_output_nid generation:  0.034718990325927734
local_in_edges_tensor generation:  0.03963351249694824
mini_batch_src_global generation:  0.07120156288146973
r_  generation:  0.5088522434234619
local_output_nid generation:  0.03825783729553223
local_in_edges_tensor generation:  0.04407763481140137
mini_batch_src_global generation:  0.06307554244995117
r_  generation:  0.49489903450012207
local_output_nid generation:  0.03556537628173828
local_in_edges_tensor generation:  0.0405430793762207
mini_batch_src_global generation:  0.05424094200134277
r_  generation:  0.4911322593688965
----------------------check_connections_block total spend ----------------------------- 5.916090726852417
generate_one_block  0.615537166595459
generate_one_block  0.6054778099060059
generate_one_block  0.6334056854248047
generate_one_block  0.6289947032928467
generate_one_block  0.6065053939819336
generate_one_block  0.622718334197998
generate_one_block  0.6508510112762451
generate_one_block  0.6286830902099609
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  9.842704057693481
block generation total time  8.482763051986694
average batch blocks generation time:  1.0603453814983368
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09760570526123047  GigaBytes
Max Memory Allocated: 0.09760570526123047  GigaBytes

torch.Size([161066, 128])
torch.Size([143129, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.5625286102294922  GigaBytes
Max Memory Allocated: 0.5932354927062988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.09914207458496094  GigaBytes
Max Memory Allocated: 0.6322422027587891  GigaBytes

torch.Size([160577, 128])
torch.Size([142204, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.5626082420349121  GigaBytes
Max Memory Allocated: 0.6322422027587891  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.10045051574707031  GigaBytes
Max Memory Allocated: 0.6322422027587891  GigaBytes

torch.Size([160931, 128])
torch.Size([143121, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.5632357597351074  GigaBytes
Max Memory Allocated: 0.6322422027587891  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.0996561050415039  GigaBytes
Max Memory Allocated: 0.6333951950073242  GigaBytes

torch.Size([160763, 128])
torch.Size([143106, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.563960075378418  GigaBytes
Max Memory Allocated: 0.6333951950073242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.09944438934326172  GigaBytes
Max Memory Allocated: 0.6342620849609375  GigaBytes

torch.Size([160780, 128])
torch.Size([142553, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.5630364418029785  GigaBytes
Max Memory Allocated: 0.6342620849609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.09964990615844727  GigaBytes
Max Memory Allocated: 0.6342620849609375  GigaBytes

torch.Size([160847, 128])
torch.Size([143064, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.5631747245788574  GigaBytes
Max Memory Allocated: 0.6342620849609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.09964704513549805  GigaBytes
Max Memory Allocated: 0.6342620849609375  GigaBytes

torch.Size([160972, 128])
torch.Size([143242, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5627884864807129  GigaBytes
Max Memory Allocated: 0.6342620849609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.09972095489501953  GigaBytes
Max Memory Allocated: 0.6342620849609375  GigaBytes

torch.Size([161009, 128])
torch.Size([143401, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 0.5640220642089844  GigaBytes
Max Memory Allocated: 0.6342620849609375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04693406820297241 |0.054060280323028564 |0.09379011392593384 |0.00010901689529418945 |0.009897828102111816 |0.004046201705932617 |
----------------------------------------------------------pseudo_mini_loss sum 5.571700572967529
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3020052
Number of first layer input nodes during this epoch:  1286945
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.13066673278808594  GigaBytes
Max Memory Allocated: 0.6342620849609375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024545907974243164
random selection method range initialization spend 0.0053784847259521484
time for parepare:  0.018277406692504883
local_output_nid generation:  0.004568338394165039
local_in_edges_tensor generation:  0.010377645492553711
mini_batch_src_global generation:  0.003995180130004883
r_  generation:  0.04182791709899902
local_output_nid generation:  0.0059661865234375
local_in_edges_tensor generation:  0.0034148693084716797
mini_batch_src_global generation:  0.006281614303588867
r_  generation:  0.04382801055908203
local_output_nid generation:  0.006055593490600586
local_in_edges_tensor generation:  0.0035991668701171875
mini_batch_src_global generation:  0.0033969879150390625
r_  generation:  0.04644632339477539
local_output_nid generation:  0.006212949752807617
local_in_edges_tensor generation:  0.003392457962036133
mini_batch_src_global generation:  0.0036475658416748047
r_  generation:  0.04812264442443848
local_output_nid generation:  0.006288051605224609
local_in_edges_tensor generation:  0.003513336181640625
mini_batch_src_global generation:  0.0037984848022460938
r_  generation:  0.04757952690124512
local_output_nid generation:  0.00619959831237793
local_in_edges_tensor generation:  0.0035715103149414062
mini_batch_src_global generation:  0.003986835479736328
r_  generation:  0.048399925231933594
local_output_nid generation:  0.00608372688293457
local_in_edges_tensor generation:  0.0035037994384765625
mini_batch_src_global generation:  0.004107236862182617
r_  generation:  0.04977583885192871
local_output_nid generation:  0.0062580108642578125
local_in_edges_tensor generation:  0.003504037857055664
mini_batch_src_global generation:  0.005710601806640625
r_  generation:  0.04916787147521973
----------------------check_connections_block total spend ----------------------------- 0.6001520156860352
generate_one_block  0.061139822006225586
generate_one_block  0.0625302791595459
generate_one_block  0.060820579528808594
generate_one_block  0.06499505043029785
generate_one_block  0.06244254112243652
generate_one_block  0.06390690803527832
generate_one_block  0.06718325614929199
generate_one_block  0.06894230842590332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036290645599365234
gen group dst list time:  0.016500473022460938
time for parepare:  0.0204317569732666
local_output_nid generation:  0.016350984573364258
local_in_edges_tensor generation:  0.04243135452270508
mini_batch_src_global generation:  0.035327911376953125
r_  generation:  0.3357834815979004
local_output_nid generation:  0.02168440818786621
local_in_edges_tensor generation:  0.0371556282043457
mini_batch_src_global generation:  0.053937673568725586
r_  generation:  0.3365483283996582
local_output_nid generation:  0.02157115936279297
local_in_edges_tensor generation:  0.027466773986816406
mini_batch_src_global generation:  0.04239034652709961
r_  generation:  0.34905147552490234
local_output_nid generation:  0.020542621612548828
local_in_edges_tensor generation:  0.023309946060180664
mini_batch_src_global generation:  0.04611945152282715
r_  generation:  0.34382128715515137
local_output_nid generation:  0.020276546478271484
local_in_edges_tensor generation:  0.0261991024017334
mini_batch_src_global generation:  0.040520429611206055
r_  generation:  0.36240124702453613
local_output_nid generation:  0.022934675216674805
local_in_edges_tensor generation:  0.03164958953857422
mini_batch_src_global generation:  0.04547429084777832
r_  generation:  0.34046268463134766
local_output_nid generation:  0.020369529724121094
local_in_edges_tensor generation:  0.029531240463256836
mini_batch_src_global generation:  0.04326629638671875
r_  generation:  0.3542799949645996
local_output_nid generation:  0.020195722579956055
local_in_edges_tensor generation:  0.030727624893188477
mini_batch_src_global generation:  0.040740251541137695
r_  generation:  0.3454775810241699
----------------------check_connections_block total spend ----------------------------- 4.1491241455078125
generate_one_block  0.44874143600463867
generate_one_block  0.44109439849853516
generate_one_block  0.43604397773742676