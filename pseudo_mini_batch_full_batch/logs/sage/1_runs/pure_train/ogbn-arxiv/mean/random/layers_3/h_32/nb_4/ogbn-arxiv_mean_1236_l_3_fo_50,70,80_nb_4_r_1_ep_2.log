Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648354587.440114
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02746415138244629
random selection method range initialization spend 0.006239175796508789
time for parepare:  0.018904924392700195
local_output_nid generation:  0.008357763290405273
local_in_edges_tensor generation:  0.009162187576293945
mini_batch_src_global generation:  0.007742643356323242
r_  generation:  0.09281277656555176
local_output_nid generation:  0.011864900588989258
local_in_edges_tensor generation:  0.00633549690246582
mini_batch_src_global generation:  0.010132312774658203
r_  generation:  0.09860467910766602
local_output_nid generation:  0.011965751647949219
local_in_edges_tensor generation:  0.0064122676849365234
mini_batch_src_global generation:  0.007816791534423828
r_  generation:  0.10151124000549316
local_output_nid generation:  0.012030839920043945
local_in_edges_tensor generation:  0.006461143493652344
mini_batch_src_global generation:  0.008402109146118164
r_  generation:  0.10161304473876953
----------------------check_connections_block total spend ----------------------------- 0.6114296913146973
generate_one_block  0.11776375770568848
generate_one_block  0.11702537536621094
generate_one_block  0.11703205108642578
generate_one_block  0.11480069160461426
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0444178581237793
gen group dst list time:  0.012071609497070312
time for parepare:  0.02000284194946289
local_output_nid generation:  0.020969390869140625
local_in_edges_tensor generation:  0.04660487174987793
mini_batch_src_global generation:  0.04559826850891113
r_  generation:  0.47580409049987793
local_output_nid generation:  0.029036760330200195
local_in_edges_tensor generation:  0.04446721076965332
mini_batch_src_global generation:  0.05635237693786621
r_  generation:  0.4898200035095215
local_output_nid generation:  0.0294954776763916
local_in_edges_tensor generation:  0.03260231018066406
mini_batch_src_global generation:  0.05995965003967285
r_  generation:  0.49474048614501953
local_output_nid generation:  0.029511690139770508
local_in_edges_tensor generation:  0.027466773986816406
mini_batch_src_global generation:  0.057305097579956055
r_  generation:  0.4907064437866211
----------------------check_connections_block total spend ----------------------------- 2.8716750144958496
generate_one_block  0.669811487197876
generate_one_block  0.649282693862915
generate_one_block  0.6511342525482178
generate_one_block  0.6471438407897949
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05697798728942871
gen group dst list time:  0.024997711181640625
time for parepare:  0.01916050910949707
local_output_nid generation:  0.03060460090637207
local_in_edges_tensor generation:  0.05982398986816406
mini_batch_src_global generation:  0.053644418716430664
r_  generation:  0.5695645809173584
local_output_nid generation:  0.03818464279174805
local_in_edges_tensor generation:  0.05805802345275879
mini_batch_src_global generation:  0.06587600708007812
r_  generation:  0.57086181640625
local_output_nid generation:  0.037476539611816406
local_in_edges_tensor generation:  0.06053614616394043
mini_batch_src_global generation:  0.0684809684753418
r_  generation:  0.5991179943084717
local_output_nid generation:  0.03895974159240723
local_in_edges_tensor generation:  0.04321908950805664
mini_batch_src_global generation:  0.06529426574707031
r_  generation:  0.5864565372467041
----------------------check_connections_block total spend ----------------------------- 3.478423595428467
generate_one_block  0.7496829032897949
generate_one_block  0.745281457901001
generate_one_block  0.7363269329071045
generate_one_block  0.7292652130126953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  6.350098609924316
block generation total time  5.577928781509399
average batch blocks generation time:  1.3944821953773499
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10645675659179688  GigaBytes
Max Memory Allocated: 0.10645675659179688  GigaBytes

torch.Size([165737, 128])
torch.Size([157426, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.26616811752319336  GigaBytes
Max Memory Allocated: 0.2696237564086914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10986852645874023  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

torch.Size([165764, 128])
torch.Size([157351, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2640199661254883  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10991334915161133  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

torch.Size([165832, 128])
torch.Size([157519, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2640261650085449  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10981416702270508  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

torch.Size([165710, 128])
torch.Size([157475, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2644777297973633  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04009467363357544 |0.1009674072265625 |0.1865215301513672 |0.00011652708053588867 |0.017270028591156006 |0.001981496810913086 |
----------------------------------------------------------pseudo_mini_loss sum 4.99228572845459
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1722807
Number of first layer input nodes during this epoch:  663043
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.16751480102539062  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022592544555664062
random selection method range initialization spend 0.0058138370513916016
time for parepare:  0.020114421844482422
local_output_nid generation:  0.00840616226196289
local_in_edges_tensor generation:  0.0098114013671875
mini_batch_src_global generation:  0.0075244903564453125
r_  generation:  0.0907750129699707
local_output_nid generation:  0.013846635818481445
local_in_edges_tensor generation:  0.010640859603881836
mini_batch_src_global generation:  0.010634183883666992
r_  generation:  0.103607177734375
local_output_nid generation:  0.01406550407409668
local_in_edges_tensor generation:  0.006346464157104492
mini_batch_src_global generation:  0.00806879997253418
r_  generation:  0.10722589492797852
local_output_nid generation:  0.01442575454711914
local_in_edges_tensor generation:  0.006415128707885742
mini_batch_src_global generation:  0.01125955581665039
r_  generation:  0.1067049503326416
----------------------check_connections_block total spend ----------------------------- 0.6440930366516113
generate_one_block  0.12448501586914062
generate_one_block  0.12365984916687012
generate_one_block  0.1224663257598877
generate_one_block  0.11764407157897949
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.058338165283203125
gen group dst list time:  0.012243986129760742
time for parepare:  0.020380496978759766
local_output_nid generation:  0.02051687240600586
local_in_edges_tensor generation:  0.05730462074279785
mini_batch_src_global generation:  0.04845690727233887
r_  generation:  0.48610997200012207
local_output_nid generation:  0.031077146530151367
local_in_edges_tensor generation:  0.046877145767211914
mini_batch_src_global generation:  0.05739927291870117
r_  generation:  0.4811549186706543
local_output_nid generation:  0.03350377082824707
local_in_edges_tensor generation:  0.04285407066345215
mini_batch_src_global generation:  0.05489230155944824
r_  generation:  0.5140318870544434
local_output_nid generation:  0.029924631118774414
local_in_edges_tensor generation:  0.043256282806396484
mini_batch_src_global generation:  0.06444144248962402
r_  generation:  0.4912405014038086
----------------------check_connections_block total spend ----------------------------- 2.964503526687622
generate_one_block  0.6957900524139404
generate_one_block  0.678753137588501
generate_one_block  0.6710736751556396
generate_one_block  0.6502265930175781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05153775215148926
gen group dst list time:  0.021967172622680664
time for parepare:  0.021465778350830078
local_output_nid generation:  0.02935481071472168
local_in_edges_tensor generation:  0.06595182418823242
mini_batch_src_global generation:  0.05385422706604004
r_  generation:  0.5712399482727051
local_output_nid generation:  0.038454294204711914
local_in_edges_tensor generation:  0.06249880790710449
mini_batch_src_global generation:  0.06664609909057617
r_  generation:  0.6054782867431641
local_output_nid generation:  0.04169464111328125
local_in_edges_tensor generation:  0.05992460250854492
mini_batch_src_global generation:  0.07132315635681152
r_  generation:  0.5780489444732666
local_output_nid generation:  0.0400843620300293
local_in_edges_tensor generation:  0.04989814758300781
mini_batch_src_global generation:  0.06485390663146973
r_  generation:  0.5776326656341553
----------------------check_connections_block total spend ----------------------------- 3.5173115730285645
generate_one_block  0.752371072769165
generate_one_block  0.7584452629089355
generate_one_block  0.7419888973236084
generate_one_block  0.7375681400299072
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.16751480102539062  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

connection checking time:  6.4818150997161865
block generation total time  5.686216831207275
average batch blocks generation time:  1.4215542078018188
block dataloader generation time/epoch 14.306135177612305
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10967493057250977  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

torch.Size([165702, 128])
torch.Size([157360, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.26343822479248047  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.11007118225097656  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

torch.Size([165740, 128])
torch.Size([157329, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.26360607147216797  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.1098623275756836  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

torch.Size([165871, 128])
torch.Size([157553, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.26393795013427734  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10999488830566406  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

torch.Size([165782, 128])
torch.Size([157558, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.26398372650146484  GigaBytes
Max Memory Allocated: 0.28914546966552734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04263031482696533 |0.021361589431762695 |0.0037953853607177734 |9.775161743164062e-05 |0.004477441310882568 |0.0012984275817871094 |
----------------------------------------------------------pseudo_mini_loss sum 4.310972690582275
Total (block generation + training)time/epoch 14.619870662689209
Training time/epoch 0.3134443759918213
Training time without block to device /epoch 0.2279980182647705
Training time without total dataloading part /epoch 0.03478074073791504
load block tensor time/epoch 0.17052125930786133
block to device time/epoch 0.08544635772705078
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1722379
Number of first layer input nodes during this epoch:  663095
