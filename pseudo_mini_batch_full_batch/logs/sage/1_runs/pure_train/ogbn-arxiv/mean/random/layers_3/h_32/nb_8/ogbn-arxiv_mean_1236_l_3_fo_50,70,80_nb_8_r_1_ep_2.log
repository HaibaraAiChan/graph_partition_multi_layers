Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648354625.007893
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02715921401977539
random selection method range initialization spend 0.0077593326568603516
time for parepare:  0.02002859115600586
local_output_nid generation:  0.004223823547363281
local_in_edges_tensor generation:  0.005943775177001953
mini_batch_src_global generation:  0.0044705867767333984
r_  generation:  0.043422698974609375
local_output_nid generation:  0.006003141403198242
local_in_edges_tensor generation:  0.003207683563232422
mini_batch_src_global generation:  0.004912853240966797
r_  generation:  0.04533505439758301
local_output_nid generation:  0.006123781204223633
local_in_edges_tensor generation:  0.0031800270080566406
mini_batch_src_global generation:  0.0033562183380126953
r_  generation:  0.04635810852050781
local_output_nid generation:  0.00615692138671875
local_in_edges_tensor generation:  0.003253459930419922
mini_batch_src_global generation:  0.003518342971801758
r_  generation:  0.046790361404418945
local_output_nid generation:  0.00616765022277832
local_in_edges_tensor generation:  0.003317594528198242
mini_batch_src_global generation:  0.0037415027618408203
r_  generation:  0.04718327522277832
local_output_nid generation:  0.006163835525512695
local_in_edges_tensor generation:  0.00330352783203125
mini_batch_src_global generation:  0.0040683746337890625
r_  generation:  0.04823803901672363
local_output_nid generation:  0.006165266036987305
local_in_edges_tensor generation:  0.003270864486694336
mini_batch_src_global generation:  0.003961324691772461
r_  generation:  0.04758930206298828
local_output_nid generation:  0.006112098693847656
local_in_edges_tensor generation:  0.003175497055053711
mini_batch_src_global generation:  0.003962993621826172
r_  generation:  0.04694175720214844
----------------------check_connections_block total spend ----------------------------- 0.588576078414917
generate_one_block  0.060861825942993164
generate_one_block  0.06239509582519531
generate_one_block  0.062313079833984375
generate_one_block  0.06134390830993652
generate_one_block  0.06528234481811523
generate_one_block  0.061716318130493164
generate_one_block  0.06078934669494629
generate_one_block  0.05955815315246582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04070734977722168
gen group dst list time:  0.01649951934814453
time for parepare:  0.018808364868164062
local_output_nid generation:  0.014323234558105469
local_in_edges_tensor generation:  0.03600502014160156
mini_batch_src_global generation:  0.03489422798156738
r_  generation:  0.358489990234375
local_output_nid generation:  0.020336151123046875
local_in_edges_tensor generation:  0.034697532653808594
mini_batch_src_global generation:  0.0620877742767334
r_  generation:  0.39252328872680664
local_output_nid generation:  0.02939152717590332
local_in_edges_tensor generation:  0.036745309829711914
mini_batch_src_global generation:  0.04708528518676758
r_  generation:  0.3946499824523926
local_output_nid generation:  0.029910802841186523
local_in_edges_tensor generation:  0.030780315399169922
mini_batch_src_global generation:  0.04963207244873047
r_  generation:  0.3956758975982666
local_output_nid generation:  0.030080556869506836
local_in_edges_tensor generation:  0.03728795051574707
mini_batch_src_global generation:  0.04955148696899414
r_  generation:  0.40364837646484375
local_output_nid generation:  0.03004288673400879
local_in_edges_tensor generation:  0.027354001998901367
mini_batch_src_global generation:  0.05054807662963867
r_  generation:  0.40012240409851074
local_output_nid generation:  0.02967095375061035
local_in_edges_tensor generation:  0.02739095687866211
mini_batch_src_global generation:  0.05203104019165039
r_  generation:  0.4045836925506592
local_output_nid generation:  0.029436588287353516
local_in_edges_tensor generation:  0.029210329055786133
mini_batch_src_global generation:  0.05072617530822754
r_  generation:  0.3934628963470459
----------------------check_connections_block total spend ----------------------------- 4.725779056549072
generate_one_block  0.516751766204834
generate_one_block  0.5235276222229004
generate_one_block  0.5129661560058594
generate_one_block  0.5092544555664062
generate_one_block  0.5127158164978027
generate_one_block  0.535956621170044
generate_one_block  0.4985086917877197
generate_one_block  0.49338865280151367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0445561408996582
gen group dst list time:  0.039179325103759766
time for parepare:  0.019811391830444336
local_output_nid generation:  0.03023695945739746
local_in_edges_tensor generation:  0.04541802406311035
mini_batch_src_global generation:  0.055095672607421875
r_  generation:  0.573655366897583
local_output_nid generation:  0.040548086166381836
local_in_edges_tensor generation:  0.06033658981323242
mini_batch_src_global generation:  0.06534886360168457
r_  generation:  0.5677733421325684
local_output_nid generation:  0.03680992126464844
local_in_edges_tensor generation:  0.04500007629394531
mini_batch_src_global generation:  0.06126737594604492
r_  generation:  0.5743627548217773
local_output_nid generation:  0.03766202926635742
local_in_edges_tensor generation:  0.05308794975280762
mini_batch_src_global generation:  0.0770113468170166
r_  generation:  0.5648744106292725
local_output_nid generation:  0.0381014347076416
local_in_edges_tensor generation:  0.039760589599609375
mini_batch_src_global generation:  0.0616145133972168
r_  generation:  0.5691325664520264
local_output_nid generation:  0.03668355941772461
local_in_edges_tensor generation:  0.03721141815185547
mini_batch_src_global generation:  0.06201338768005371
r_  generation:  0.5741982460021973
local_output_nid generation:  0.03871893882751465
local_in_edges_tensor generation:  0.04569649696350098
mini_batch_src_global generation:  0.06300973892211914
r_  generation:  0.5792388916015625
local_output_nid generation:  0.03678536415100098
local_in_edges_tensor generation:  0.04711437225341797
mini_batch_src_global generation:  0.0706937313079834
r_  generation:  0.5749795436859131
----------------------check_connections_block total spend ----------------------------- 6.829939603805542
generate_one_block  0.715153694152832
generate_one_block  0.7287125587463379
generate_one_block  0.7179105281829834
generate_one_block  0.7208573818206787
generate_one_block  0.7209970951080322
generate_one_block  0.7217893600463867
generate_one_block  0.745023250579834
generate_one_block  0.7148528099060059
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  11.555718660354614
block generation total time  9.888366460800171
average batch blocks generation time:  1.2360458076000214
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.1014719009399414  GigaBytes
Max Memory Allocated: 0.1014719009399414  GigaBytes

torch.Size([162394, 128])
torch.Size([145430, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.22618627548217773  GigaBytes
Max Memory Allocated: 0.22870254516601562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10393095016479492  GigaBytes
Max Memory Allocated: 0.2413477897644043  GigaBytes

torch.Size([162877, 128])
torch.Size([146526, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22837209701538086  GigaBytes
Max Memory Allocated: 0.2413477897644043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10409164428710938  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162457, 128])
torch.Size([145833, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22777175903320312  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10392475128173828  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162640, 128])
torch.Size([146128, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22757434844970703  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10407161712646484  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162578, 128])
torch.Size([145876, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22784805297851562  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10393714904785156  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162630, 128])
torch.Size([145934, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22786664962768555  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10383319854736328  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162534, 128])
torch.Size([146021, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.227447509765625  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10390472412109375  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162574, 128])
torch.Size([146056, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.2264552116394043  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04157796502113342 |0.06264734268188477 |0.09446579217910767 |0.00010320544242858887 |0.009114176034927368 |0.0038094520568847656 |
----------------------------------------------------------pseudo_mini_loss sum 5.0163254737854
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3057554
Number of first layer input nodes during this epoch:  1300684
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.15236854553222656  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02238774299621582
random selection method range initialization spend 0.0048694610595703125
time for parepare:  0.01857900619506836
local_output_nid generation:  0.00454401969909668
local_in_edges_tensor generation:  0.014198541641235352
mini_batch_src_global generation:  0.003982067108154297
r_  generation:  0.041248321533203125
local_output_nid generation:  0.0071566104888916016
local_in_edges_tensor generation:  0.0036306381225585938
mini_batch_src_global generation:  0.004853487014770508
r_  generation:  0.04441261291503906
local_output_nid generation:  0.007317304611206055
local_in_edges_tensor generation:  0.0035164356231689453
mini_batch_src_global generation:  0.003305196762084961
r_  generation:  0.0450897216796875
local_output_nid generation:  0.007468461990356445
local_in_edges_tensor generation:  0.0035169124603271484
mini_batch_src_global generation:  0.0034685134887695312
r_  generation:  0.046564340591430664
local_output_nid generation:  0.007460355758666992
local_in_edges_tensor generation:  0.003495454788208008
mini_batch_src_global generation:  0.0037081241607666016
r_  generation:  0.047693729400634766
local_output_nid generation:  0.007422685623168945
local_in_edges_tensor generation:  0.0034682750701904297
mini_batch_src_global generation:  0.00399327278137207
r_  generation:  0.048589229583740234
local_output_nid generation:  0.00748753547668457
local_in_edges_tensor generation:  0.0033698081970214844
mini_batch_src_global generation:  0.003914594650268555
r_  generation:  0.04886436462402344
local_output_nid generation:  0.00755763053894043
local_in_edges_tensor generation:  0.003550291061401367
mini_batch_src_global generation:  0.0040967464447021484
r_  generation:  0.048380374908447266
----------------------check_connections_block total spend ----------------------------- 0.6038632392883301
generate_one_block  0.05963468551635742
generate_one_block  0.06227827072143555
generate_one_block  0.061179399490356445
generate_one_block  0.061872243881225586
generate_one_block  0.06261086463928223
generate_one_block  0.06300830841064453
generate_one_block  0.06555557250976562
generate_one_block  0.06260108947753906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04189705848693848
gen group dst list time:  0.01653909683227539
time for parepare:  0.019301891326904297
local_output_nid generation:  0.014400482177734375
local_in_edges_tensor generation:  0.03919243812561035
mini_batch_src_global generation:  0.03523445129394531
r_  generation:  0.35556817054748535
local_output_nid generation:  0.02301335334777832
local_in_edges_tensor generation:  0.03443503379821777
mini_batch_src_global generation:  0.04508495330810547
r_  generation:  0.3772714138031006
local_output_nid generation:  0.019582033157348633
local_in_edges_tensor generation:  0.023767471313476562
mini_batch_src_global generation:  0.0457003116607666
r_  generation:  0.37567138671875
local_output_nid generation:  0.019590139389038086
local_in_edges_tensor generation:  0.024145126342773438
mini_batch_src_global generation:  0.04531502723693848
r_  generation:  0.3778982162475586
local_output_nid generation:  0.019740581512451172
local_in_edges_tensor generation:  0.02925729751586914
mini_batch_src_global generation:  0.04596257209777832
r_  generation:  0.38283753395080566
local_output_nid generation:  0.019840240478515625
local_in_edges_tensor generation:  0.028201818466186523
mini_batch_src_global generation:  0.046927690505981445
r_  generation:  0.3963906764984131
local_output_nid generation:  0.01956343650817871
local_in_edges_tensor generation:  0.02105879783630371
mini_batch_src_global generation:  0.04607987403869629
r_  generation:  0.3861541748046875
local_output_nid generation:  0.020870685577392578
local_in_edges_tensor generation:  0.027720212936401367
mini_batch_src_global generation:  0.04643750190734863
r_  generation:  0.3935706615447998
----------------------check_connections_block total spend ----------------------------- 4.443429231643677
generate_one_block  0.5065176486968994
generate_one_block  0.5064797401428223
generate_one_block  0.49613165855407715
generate_one_block  0.5109376907348633
generate_one_block  0.5002148151397705
generate_one_block  0.5028564929962158
generate_one_block  0.4930896759033203
generate_one_block  0.5322582721710205
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.047801971435546875
gen group dst list time:  0.03770613670349121
time for parepare:  0.019362211227416992
local_output_nid generation:  0.029061079025268555
local_in_edges_tensor generation:  0.1605377197265625
mini_batch_src_global generation:  0.0708310604095459
r_  generation:  0.567620038986206
local_output_nid generation:  0.03956151008605957
local_in_edges_tensor generation:  0.05973553657531738
mini_batch_src_global generation:  0.0644068717956543
r_  generation:  0.5469720363616943
local_output_nid generation:  0.036560773849487305
local_in_edges_tensor generation:  0.044103384017944336
mini_batch_src_global generation:  0.06201887130737305
r_  generation:  0.5669188499450684
local_output_nid generation:  0.03681373596191406
local_in_edges_tensor generation:  0.05252194404602051
mini_batch_src_global generation:  0.06069016456604004
r_  generation:  0.565925121307373
local_output_nid generation:  0.03692030906677246
local_in_edges_tensor generation:  0.04510378837585449
mini_batch_src_global generation:  0.06500530242919922
r_  generation:  0.5911855697631836
local_output_nid generation:  0.04174399375915527
local_in_edges_tensor generation:  0.04420065879821777
mini_batch_src_global generation:  0.07095909118652344
r_  generation:  0.5715646743774414
local_output_nid generation:  0.05918598175048828
local_in_edges_tensor generation:  0.06961178779602051
mini_batch_src_global generation:  0.07179117202758789
r_  generation:  0.5961999893188477
local_output_nid generation:  0.04317164421081543
local_in_edges_tensor generation:  0.050519466400146484
mini_batch_src_global generation:  0.06258487701416016
r_  generation:  0.5980362892150879
----------------------check_connections_block total spend ----------------------------- 7.027985095977783
generate_one_block  0.7333734035491943
generate_one_block  0.7119863033294678
generate_one_block  0.710486888885498
generate_one_block  0.709831714630127
generate_one_block  0.7186124324798584
generate_one_block  0.7497446537017822
generate_one_block  0.7242655754089355
generate_one_block  0.7492926120758057
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.15236854553222656  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

connection checking time:  11.47141432762146
block generation total time  9.856079578399658
average batch blocks generation time:  1.2320099472999573
block dataloader generation time/epoch 23.510416746139526
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.1040658950805664  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162649, 128])
torch.Size([145899, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22724151611328125  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10430574417114258  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162468, 128])
torch.Size([145754, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22746562957763672  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10398006439208984  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162610, 128])
torch.Size([145694, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.2274770736694336  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10425043106079102  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162501, 128])
torch.Size([145929, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.2277665138244629  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10413932800292969  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162565, 128])
torch.Size([145725, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22780799865722656  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10413932800292969  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162684, 128])
torch.Size([145889, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22821664810180664  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10389900207519531  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162817, 128])
torch.Size([146263, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22770023345947266  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10421371459960938  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

torch.Size([162702, 128])
torch.Size([146316, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22788667678833008  GigaBytes
Max Memory Allocated: 0.24363231658935547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035033732652664185 |0.02476397156715393 |0.0036972463130950928 |9.799003601074219e-05 |0.0037641823291778564 |0.002904176712036133 |
----------------------------------------------------------pseudo_mini_loss sum 4.333499431610107
Total (block generation + training)time/epoch 24.07568073272705
Training time/epoch 0.5649497509002686
Training time without block to device /epoch 0.3668379783630371
Training time without total dataloading part /epoch 0.06337952613830566
load block tensor time/epoch 0.2802698612213135
block to device time/epoch 0.19811177253723145
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3057455
Number of first layer input nodes during this epoch:  1300996
