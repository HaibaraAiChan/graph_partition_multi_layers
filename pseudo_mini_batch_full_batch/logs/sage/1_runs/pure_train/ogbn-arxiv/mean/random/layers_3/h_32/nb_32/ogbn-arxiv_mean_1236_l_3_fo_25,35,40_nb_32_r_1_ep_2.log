Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648353295.5913935
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023389816284179688
random selection method range initialization spend 0.006112575531005859
time for parepare:  0.01918935775756836
local_output_nid generation:  0.0010974407196044922
local_in_edges_tensor generation:  0.0029664039611816406
mini_batch_src_global generation:  0.0014581680297851562
r_  generation:  0.009263992309570312
local_output_nid generation:  0.0013446807861328125
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0013973712921142578
r_  generation:  0.007627964019775391
local_output_nid generation:  0.0014061927795410156
local_in_edges_tensor generation:  0.0008528232574462891
mini_batch_src_global generation:  0.0009322166442871094
r_  generation:  0.008904695510864258
local_output_nid generation:  0.0014231204986572266
local_in_edges_tensor generation:  0.0008175373077392578
mini_batch_src_global generation:  0.0008592605590820312
r_  generation:  0.007522106170654297
local_output_nid generation:  0.001394033432006836
local_in_edges_tensor generation:  0.0007867813110351562
mini_batch_src_global generation:  0.000858306884765625
r_  generation:  0.0077359676361083984
local_output_nid generation:  0.001367807388305664
local_in_edges_tensor generation:  0.0007572174072265625
mini_batch_src_global generation:  0.0008068084716796875
r_  generation:  0.00797271728515625
local_output_nid generation:  0.001360177993774414
local_in_edges_tensor generation:  0.0007488727569580078
mini_batch_src_global generation:  0.0007956027984619141
r_  generation:  0.00781869888305664
local_output_nid generation:  0.0013432502746582031
local_in_edges_tensor generation:  0.0007429122924804688
mini_batch_src_global generation:  0.0007929801940917969
r_  generation:  0.00807809829711914
local_output_nid generation:  0.0013513565063476562
local_in_edges_tensor generation:  0.0007419586181640625
mini_batch_src_global generation:  0.0007905960083007812
r_  generation:  0.008045434951782227
local_output_nid generation:  0.0013883113861083984
local_in_edges_tensor generation:  0.0007739067077636719
mini_batch_src_global generation:  0.0008394718170166016
r_  generation:  0.008083343505859375
local_output_nid generation:  0.0013637542724609375
local_in_edges_tensor generation:  0.0007386207580566406
mini_batch_src_global generation:  0.0009319782257080078
r_  generation:  0.008229732513427734
local_output_nid generation:  0.0013718605041503906
local_in_edges_tensor generation:  0.0007219314575195312
mini_batch_src_global generation:  0.0008099079132080078
r_  generation:  0.008062601089477539
local_output_nid generation:  0.0013496875762939453
local_in_edges_tensor generation:  0.0007143020629882812
mini_batch_src_global generation:  0.00080108642578125
r_  generation:  0.008020401000976562
local_output_nid generation:  0.0013480186462402344
local_in_edges_tensor generation:  0.0007188320159912109
mini_batch_src_global generation:  0.0007936954498291016
r_  generation:  0.008049964904785156
local_output_nid generation:  0.001363515853881836
local_in_edges_tensor generation:  0.0007226467132568359
mini_batch_src_global generation:  0.0008037090301513672
r_  generation:  0.008177518844604492
local_output_nid generation:  0.0013682842254638672
local_in_edges_tensor generation:  0.0007157325744628906
mini_batch_src_global generation:  0.0008020401000976562
r_  generation:  0.007866859436035156
local_output_nid generation:  0.0013854503631591797
local_in_edges_tensor generation:  0.0007107257843017578
mini_batch_src_global generation:  0.0008199214935302734
r_  generation:  0.007914304733276367
local_output_nid generation:  0.0013687610626220703
local_in_edges_tensor generation:  0.000720977783203125
mini_batch_src_global generation:  0.0008244514465332031
r_  generation:  0.008148193359375
local_output_nid generation:  0.0013921260833740234
local_in_edges_tensor generation:  0.0007135868072509766
mini_batch_src_global generation:  0.0008397102355957031
r_  generation:  0.008196353912353516
local_output_nid generation:  0.001394510269165039
local_in_edges_tensor generation:  0.0007226467132568359
mini_batch_src_global generation:  0.0008273124694824219
r_  generation:  0.008177518844604492
local_output_nid generation:  0.001354217529296875
local_in_edges_tensor generation:  0.0006999969482421875
mini_batch_src_global generation:  0.0007901191711425781
r_  generation:  0.007800579071044922
local_output_nid generation:  0.0013616085052490234
local_in_edges_tensor generation:  0.0007138252258300781
mini_batch_src_global generation:  0.0008287429809570312
r_  generation:  0.008331298828125
local_output_nid generation:  0.0013692378997802734
local_in_edges_tensor generation:  0.0007169246673583984
mini_batch_src_global generation:  0.0008172988891601562
r_  generation:  0.007809162139892578
local_output_nid generation:  0.0013604164123535156
local_in_edges_tensor generation:  0.00072479248046875
mini_batch_src_global generation:  0.0008273124694824219
r_  generation:  0.008270263671875
local_output_nid generation:  0.0014045238494873047
local_in_edges_tensor generation:  0.0007159709930419922
mini_batch_src_global generation:  0.0008141994476318359
r_  generation:  0.007947683334350586
local_output_nid generation:  0.0013632774353027344
local_in_edges_tensor generation:  0.0007154941558837891
mini_batch_src_global generation:  0.0008032321929931641
r_  generation:  0.00790262222290039
local_output_nid generation:  0.0013730525970458984
local_in_edges_tensor generation:  0.0007100105285644531
mini_batch_src_global generation:  0.0008056163787841797
r_  generation:  0.008169174194335938
local_output_nid generation:  0.0013456344604492188
local_in_edges_tensor generation:  0.0007050037384033203
mini_batch_src_global generation:  0.0008158683776855469
r_  generation:  0.008075952529907227
local_output_nid generation:  0.0013539791107177734
local_in_edges_tensor generation:  0.0007073879241943359
mini_batch_src_global generation:  0.0008072853088378906
r_  generation:  0.007932901382446289
local_output_nid generation:  0.001355886459350586
local_in_edges_tensor generation:  0.005055904388427734
mini_batch_src_global generation:  0.0010175704956054688
r_  generation:  0.007746219635009766
local_output_nid generation:  0.0012307167053222656
local_in_edges_tensor generation:  0.0007796287536621094
mini_batch_src_global generation:  0.0009930133819580078
r_  generation:  0.00801849365234375
local_output_nid generation:  0.001277923583984375
local_in_edges_tensor generation:  0.0007171630859375
mini_batch_src_global generation:  0.0008854866027832031
r_  generation:  0.007883548736572266
----------------------check_connections_block total spend ----------------------------- 0.4587545394897461
generate_one_block  0.013762712478637695
generate_one_block  0.012791872024536133
generate_one_block  0.013549089431762695
generate_one_block  0.012730121612548828
generate_one_block  0.013361215591430664
generate_one_block  0.013190507888793945
generate_one_block  0.013082265853881836
generate_one_block  0.013311386108398438
generate_one_block  0.013182640075683594
generate_one_block  0.013375997543334961
generate_one_block  0.013224124908447266
generate_one_block  0.012964487075805664
generate_one_block  0.013200759887695312
generate_one_block  0.013090372085571289
generate_one_block  0.013278484344482422
generate_one_block  0.012727022171020508
generate_one_block  0.012765645980834961
generate_one_block  0.013102293014526367
generate_one_block  0.013200044631958008
generate_one_block  0.013128280639648438
generate_one_block  0.012543678283691406
generate_one_block  0.013479232788085938
generate_one_block  0.012668848037719727
generate_one_block  0.013228893280029297
generate_one_block  0.012685060501098633
generate_one_block  0.012903451919555664
generate_one_block  0.012958526611328125
generate_one_block  0.012930154800415039
generate_one_block  0.012814998626708984
generate_one_block  0.012366771697998047
generate_one_block  0.013102054595947266
generate_one_block  0.012636661529541016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039844512939453125
gen group dst list time:  0.021355152130126953
time for parepare:  0.01888298988342285
local_output_nid generation:  0.004558086395263672
local_in_edges_tensor generation:  0.011153936386108398
mini_batch_src_global generation:  0.011682987213134766
r_  generation:  0.11428427696228027
local_output_nid generation:  0.007498979568481445
local_in_edges_tensor generation:  0.007426738739013672
mini_batch_src_global generation:  0.014098167419433594
r_  generation:  0.11804866790771484
local_output_nid generation:  0.007559061050415039
local_in_edges_tensor generation:  0.008960485458374023
mini_batch_src_global generation:  0.013936758041381836
r_  generation:  0.13122081756591797
local_output_nid generation:  0.007023334503173828
local_in_edges_tensor generation:  0.008546113967895508
mini_batch_src_global generation:  0.014110803604125977
r_  generation:  0.12425470352172852
local_output_nid generation:  0.007220745086669922
local_in_edges_tensor generation:  0.00791478157043457
mini_batch_src_global generation:  0.015798568725585938
r_  generation:  0.131744384765625
local_output_nid generation:  0.007401227951049805
local_in_edges_tensor generation:  0.009143590927124023
mini_batch_src_global generation:  0.01574850082397461
r_  generation:  0.13358831405639648
local_output_nid generation:  0.007109165191650391
local_in_edges_tensor generation:  0.008725166320800781
mini_batch_src_global generation:  0.01883530616760254
r_  generation:  0.13208937644958496
local_output_nid generation:  0.007288217544555664
local_in_edges_tensor generation:  0.008800745010375977
mini_batch_src_global generation:  0.016862154006958008
r_  generation:  0.13258647918701172
local_output_nid generation:  0.0072727203369140625
local_in_edges_tensor generation:  0.009034395217895508
mini_batch_src_global generation:  0.01603412628173828
r_  generation:  0.13414311408996582
local_output_nid generation:  0.0072672367095947266
local_in_edges_tensor generation:  0.007728099822998047
mini_batch_src_global generation:  0.015901565551757812
r_  generation:  0.13140106201171875
local_output_nid generation:  0.007176637649536133
local_in_edges_tensor generation:  0.008794069290161133
mini_batch_src_global generation:  0.017197847366333008
r_  generation:  0.13812732696533203
local_output_nid generation:  0.007219791412353516
local_in_edges_tensor generation:  0.007669210433959961
mini_batch_src_global generation:  0.01604914665222168
r_  generation:  0.13016533851623535
local_output_nid generation:  0.007333278656005859
local_in_edges_tensor generation:  0.009870052337646484
mini_batch_src_global generation:  0.016184329986572266
r_  generation:  0.13263654708862305
local_output_nid generation:  0.007186412811279297
local_in_edges_tensor generation:  0.007730245590209961
mini_batch_src_global generation:  0.015958786010742188
r_  generation:  0.13327884674072266
local_output_nid generation:  0.007341861724853516
local_in_edges_tensor generation:  0.008802413940429688
mini_batch_src_global generation:  0.017411231994628906
r_  generation:  0.13529253005981445
local_output_nid generation:  0.007044076919555664
local_in_edges_tensor generation:  0.007699728012084961
mini_batch_src_global generation:  0.015935897827148438
r_  generation:  0.1326591968536377
local_output_nid generation:  0.007191896438598633
local_in_edges_tensor generation:  0.01031637191772461
mini_batch_src_global generation:  0.01564955711364746
r_  generation:  0.13326811790466309
local_output_nid generation:  0.007254362106323242
local_in_edges_tensor generation:  0.00773167610168457
mini_batch_src_global generation:  0.017265796661376953
r_  generation:  0.13463044166564941
local_output_nid generation:  0.0072345733642578125
local_in_edges_tensor generation:  0.009682178497314453
mini_batch_src_global generation:  0.01633143424987793
r_  generation:  0.13763427734375
local_output_nid generation:  0.007543087005615234
local_in_edges_tensor generation:  0.009964704513549805
mini_batch_src_global generation:  0.01668524742126465
r_  generation:  0.14014983177185059
local_output_nid generation:  0.007091522216796875
local_in_edges_tensor generation:  0.0074765682220458984
mini_batch_src_global generation:  0.015723705291748047
r_  generation:  0.13021111488342285
local_output_nid generation:  0.007405519485473633
local_in_edges_tensor generation:  0.00794839859008789
mini_batch_src_global generation:  0.01638627052307129
r_  generation:  0.13753914833068848
local_output_nid generation:  0.00717926025390625
local_in_edges_tensor generation:  0.008551359176635742
mini_batch_src_global generation:  0.015857934951782227
r_  generation:  0.13195109367370605
local_output_nid generation:  0.007415294647216797
local_in_edges_tensor generation:  0.008873462677001953
mini_batch_src_global generation:  0.01722097396850586
r_  generation:  0.13610029220581055
local_output_nid generation:  0.007187604904174805
local_in_edges_tensor generation:  0.0077762603759765625
mini_batch_src_global generation:  0.015848398208618164
r_  generation:  0.13602733612060547
local_output_nid generation:  0.007195711135864258
local_in_edges_tensor generation:  0.00908207893371582
mini_batch_src_global generation:  0.015910863876342773
r_  generation:  0.13199186325073242
local_output_nid generation:  0.007238149642944336
local_in_edges_tensor generation:  0.009662866592407227
mini_batch_src_global generation:  0.01619410514831543
r_  generation:  0.14643073081970215
local_output_nid generation:  0.007218122482299805
local_in_edges_tensor generation:  0.00781559944152832
mini_batch_src_global generation:  0.01612114906311035
r_  generation:  0.13371706008911133
local_output_nid generation:  0.0072100162506103516
local_in_edges_tensor generation:  0.007309436798095703
mini_batch_src_global generation:  0.015921354293823242
r_  generation:  0.1319103240966797
local_output_nid generation:  0.00693511962890625
local_in_edges_tensor generation:  0.007738828659057617
mini_batch_src_global generation:  0.018460750579833984
r_  generation:  0.1300945281982422
local_output_nid generation:  0.0072095394134521484
local_in_edges_tensor generation:  0.00872182846069336
mini_batch_src_global generation:  0.016976594924926758
r_  generation:  0.13524365425109863
local_output_nid generation:  0.007036924362182617
local_in_edges_tensor generation:  0.0074160099029541016
mini_batch_src_global generation:  0.0157926082611084
r_  generation:  0.12922239303588867
----------------------check_connections_block total spend ----------------------------- 6.262756109237671
generate_one_block  0.16540741920471191
generate_one_block  0.15668678283691406
generate_one_block  0.1947956085205078
generate_one_block  0.16214990615844727
generate_one_block  0.1649479866027832
generate_one_block  0.16939282417297363
generate_one_block  0.1626269817352295
generate_one_block  0.17076563835144043
generate_one_block  0.1677541732788086
generate_one_block  0.1613631248474121
generate_one_block  0.16806674003601074
generate_one_block  0.16297030448913574
generate_one_block  0.1671607494354248
generate_one_block  0.1638181209564209
generate_one_block  0.1685941219329834
generate_one_block  0.17997336387634277
generate_one_block  0.16158413887023926
generate_one_block  0.17038321495056152
generate_one_block  0.16608953475952148
generate_one_block  0.16943931579589844
generate_one_block  0.1572582721710205
generate_one_block  0.16490578651428223
generate_one_block  0.1599438190460205
generate_one_block  0.17638945579528809
generate_one_block  0.16092991828918457
generate_one_block  0.16095638275146484
generate_one_block  0.16613316535949707
generate_one_block  0.16160893440246582
generate_one_block  0.1667475700378418
generate_one_block  0.1597614288330078
generate_one_block  0.16371512413024902
generate_one_block  0.15925216674804688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05061984062194824
gen group dst list time:  0.0960245132446289
time for parepare:  0.02123737335205078
local_output_nid generation:  0.020426511764526367
local_in_edges_tensor generation:  0.05451679229736328
mini_batch_src_global generation:  0.03910088539123535
r_  generation:  0.3725409507751465
local_output_nid generation:  0.02721571922302246
local_in_edges_tensor generation:  0.041054725646972656
mini_batch_src_global generation:  0.04454851150512695
r_  generation:  0.3905024528503418
local_output_nid generation:  0.028224468231201172
local_in_edges_tensor generation:  0.03685569763183594
mini_batch_src_global generation:  0.04711627960205078
r_  generation:  0.3980135917663574
local_output_nid generation:  0.0262451171875
local_in_edges_tensor generation:  0.032099246978759766
mini_batch_src_global generation:  0.04703712463378906
r_  generation:  0.39211201667785645
local_output_nid generation:  0.025798797607421875
local_in_edges_tensor generation:  0.029422521591186523
mini_batch_src_global generation:  0.049250125885009766
r_  generation:  0.3941030502319336
local_output_nid generation:  0.025528669357299805
local_in_edges_tensor generation:  0.033030033111572266
mini_batch_src_global generation:  0.046561241149902344
r_  generation:  0.4008364677429199
local_output_nid generation:  0.02562427520751953
local_in_edges_tensor generation:  0.025780439376831055
mini_batch_src_global generation:  0.055615901947021484
r_  generation:  0.4007260799407959
local_output_nid generation:  0.02776956558227539
local_in_edges_tensor generation:  0.03353524208068848
mini_batch_src_global generation:  0.050226449966430664
r_  generation:  0.399029016494751
local_output_nid generation:  0.026530742645263672
local_in_edges_tensor generation:  0.03326416015625
mini_batch_src_global generation:  0.04919266700744629
r_  generation:  0.3983449935913086
local_output_nid generation:  0.026531457901000977
local_in_edges_tensor generation:  0.026004314422607422
mini_batch_src_global generation:  0.0637204647064209
r_  generation:  0.39915919303894043
local_output_nid generation:  0.027141332626342773
local_in_edges_tensor generation:  0.028107881546020508
mini_batch_src_global generation:  0.04752540588378906
r_  generation:  0.39922571182250977
local_output_nid generation:  0.026167869567871094
local_in_edges_tensor generation:  0.025342226028442383
mini_batch_src_global generation:  0.04727911949157715
r_  generation:  0.3945744037628174
local_output_nid generation:  0.02664637565612793
local_in_edges_tensor generation:  0.032961368560791016
mini_batch_src_global generation:  0.048718929290771484
r_  generation:  0.4018259048461914
local_output_nid generation:  0.02641916275024414
local_in_edges_tensor generation:  0.035570383071899414
mini_batch_src_global generation:  0.04663586616516113
r_  generation:  0.39876794815063477
local_output_nid generation:  0.0265653133392334
local_in_edges_tensor generation:  0.026134014129638672
mini_batch_src_global generation:  0.049652099609375
r_  generation:  0.4019343852996826
local_output_nid generation:  0.026557445526123047
local_in_edges_tensor generation:  0.026065349578857422
mini_batch_src_global generation:  0.04705810546875
r_  generation:  0.40033483505249023
local_output_nid generation:  0.02643585205078125
local_in_edges_tensor generation:  0.02547311782836914
mini_batch_src_global generation:  0.048583984375
r_  generation:  0.4006180763244629
local_output_nid generation:  0.026565074920654297
local_in_edges_tensor generation:  0.030886411666870117
mini_batch_src_global generation:  0.04952883720397949
r_  generation:  0.40042686462402344
local_output_nid generation:  0.026579618453979492
local_in_edges_tensor generation:  0.02997565269470215
mini_batch_src_global generation:  0.0473780632019043
r_  generation:  0.4199709892272949
local_output_nid generation:  0.02680659294128418
local_in_edges_tensor generation:  0.0375208854675293
mini_batch_src_global generation:  0.05163860321044922
r_  generation:  0.40102124214172363
local_output_nid generation:  0.026628732681274414
local_in_edges_tensor generation:  0.027181386947631836
mini_batch_src_global generation:  0.047969818115234375
r_  generation:  0.3995976448059082
local_output_nid generation:  0.02649521827697754
local_in_edges_tensor generation:  0.03296303749084473
mini_batch_src_global generation:  0.04652237892150879
r_  generation:  0.40015101432800293
local_output_nid generation:  0.028464794158935547
local_in_edges_tensor generation:  0.02547287940979004
mini_batch_src_global generation:  0.047066688537597656
r_  generation:  0.3956899642944336
local_output_nid generation:  0.0267794132232666
local_in_edges_tensor generation:  0.03654336929321289
mini_batch_src_global generation:  0.04684591293334961
r_  generation:  0.40543365478515625
local_output_nid generation:  0.02688765525817871
local_in_edges_tensor generation:  0.026309490203857422
mini_batch_src_global generation:  0.04761552810668945
r_  generation:  0.3945353031158447
local_output_nid generation:  0.026669740676879883
local_in_edges_tensor generation:  0.029506921768188477
mini_batch_src_global generation:  0.04685497283935547
r_  generation:  0.40375566482543945
local_output_nid generation:  0.026866674423217773
local_in_edges_tensor generation:  0.029691696166992188
mini_batch_src_global generation:  0.04703998565673828
r_  generation:  0.408827543258667
local_output_nid generation:  0.026808977127075195
local_in_edges_tensor generation:  0.02939128875732422
mini_batch_src_global generation:  0.04720902442932129
r_  generation:  0.398723840713501
local_output_nid generation:  0.026532888412475586
local_in_edges_tensor generation:  0.0290679931640625
mini_batch_src_global generation:  0.04946613311767578
r_  generation:  0.39898180961608887
local_output_nid generation:  0.026160001754760742
local_in_edges_tensor generation:  0.0287625789642334
mini_batch_src_global generation:  0.04922890663146973
r_  generation:  0.3965306282043457
local_output_nid generation:  0.026636123657226562
local_in_edges_tensor generation:  0.03300666809082031
mini_batch_src_global generation:  0.046282052993774414
r_  generation:  0.40209436416625977
local_output_nid generation:  0.026206493377685547
local_in_edges_tensor generation:  0.025890350341796875
mini_batch_src_global generation:  0.04726004600524902
r_  generation:  0.39273953437805176
----------------------check_connections_block total spend ----------------------------- 18.943111896514893
generate_one_block  0.5966622829437256
generate_one_block  0.5046730041503906
generate_one_block  0.5288898944854736
generate_one_block  0.5257494449615479
generate_one_block  0.5119674205780029
generate_one_block  0.524055004119873
generate_one_block  0.5172216892242432
generate_one_block  0.5216495990753174
generate_one_block  0.5252609252929688
generate_one_block  0.515972375869751
generate_one_block  0.5136544704437256
generate_one_block  0.5047297477722168
generate_one_block  0.5175817012786865
generate_one_block  0.5328001976013184
generate_one_block  0.5319151878356934
generate_one_block  0.5116944313049316
generate_one_block  0.5063750743865967
generate_one_block  0.5076084136962891
generate_one_block  0.5092084407806396
generate_one_block  0.530440092086792
generate_one_block  0.5119054317474365
generate_one_block  0.5067369937896729
generate_one_block  0.49904537200927734
generate_one_block  0.5243065357208252
generate_one_block  0.5003349781036377
generate_one_block  0.5099070072174072
generate_one_block  0.5198996067047119
generate_one_block  0.498354434967041
generate_one_block  0.5046498775482178
generate_one_block  0.5072755813598633
generate_one_block  0.524071455001831
generate_one_block  0.5131666660308838
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  25.205868005752563
block generation total time  21.869335412979126
average batch blocks generation time:  0.6834167316555977
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08270788192749023  GigaBytes
Max Memory Allocated: 0.08270788192749023  GigaBytes

torch.Size([145414, 128])
torch.Size([98857, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.14832162857055664  GigaBytes
Max Memory Allocated: 0.14970874786376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08198404312133789  GigaBytes
Max Memory Allocated: 0.16332435607910156  GigaBytes

torch.Size([145381, 128])
torch.Size([98198, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1466836929321289  GigaBytes
Max Memory Allocated: 0.16332435607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08345222473144531  GigaBytes
Max Memory Allocated: 0.16332435607910156  GigaBytes

torch.Size([145591, 128])
torch.Size([99950, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15049123764038086  GigaBytes
Max Memory Allocated: 0.16332435607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08200407028198242  GigaBytes
Max Memory Allocated: 0.16408920288085938  GigaBytes

torch.Size([145079, 128])
torch.Size([98388, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14768123626708984  GigaBytes
Max Memory Allocated: 0.16408920288085938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08321952819824219  GigaBytes
Max Memory Allocated: 0.16408920288085938  GigaBytes

torch.Size([146145, 128])
torch.Size([99458, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15008211135864258  GigaBytes
Max Memory Allocated: 0.16408920288085938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08335399627685547  GigaBytes
Max Memory Allocated: 0.16443967819213867  GigaBytes

torch.Size([146032, 128])
torch.Size([100827, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15058088302612305  GigaBytes
Max Memory Allocated: 0.16443967819213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08320236206054688  GigaBytes
Max Memory Allocated: 0.16443967819213867  GigaBytes

torch.Size([145866, 128])
torch.Size([99465, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1500072479248047  GigaBytes
Max Memory Allocated: 0.16443967819213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08333396911621094  GigaBytes
Max Memory Allocated: 0.16444730758666992  GigaBytes

torch.Size([146081, 128])
torch.Size([100402, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1504058837890625  GigaBytes
Max Memory Allocated: 0.16444730758666992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08328914642333984  GigaBytes
Max Memory Allocated: 0.16444730758666992  GigaBytes

torch.Size([145842, 128])
torch.Size([100079, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15024423599243164  GigaBytes
Max Memory Allocated: 0.16444730758666992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0831756591796875  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145648, 128])
torch.Size([99591, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1500720977783203  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08214378356933594  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145070, 128])
torch.Size([99169, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14883089065551758  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08203935623168945  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145131, 128])
torch.Size([98711, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1469130516052246  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08321666717529297  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145617, 128])
torch.Size([99729, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15010929107666016  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08321666717529297  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145775, 128])
torch.Size([99436, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14998817443847656  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0821676254272461  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145082, 128])
torch.Size([99352, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14891529083251953  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08207941055297852  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145375, 128])
torch.Size([98908, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14680957794189453  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08308219909667969  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145609, 128])
torch.Size([98644, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14792537689208984  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0832376480102539  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145659, 128])
torch.Size([99332, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14999008178710938  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08316230773925781  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145503, 128])
torch.Size([98887, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14811992645263672  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08331871032714844  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145553, 128])
torch.Size([99761, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15018844604492188  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08303070068359375  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145642, 128])
torch.Size([98582, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14771270751953125  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08213281631469727  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145147, 128])
torch.Size([99409, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1489715576171875  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08189630508422852  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145035, 128])
torch.Size([98241, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1465926170349121  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08332633972167969  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145802, 128])
torch.Size([99852, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15025997161865234  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08181571960449219  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([144842, 128])
torch.Size([98362, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1465926170349121  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08316516876220703  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([146151, 128])
torch.Size([99782, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15007543563842773  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08211660385131836  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145209, 128])
torch.Size([98899, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14793157577514648  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08205223083496094  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145342, 128])
torch.Size([98516, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14691972732543945  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08196496963500977  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145155, 128])
torch.Size([98318, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14668750762939453  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08194875717163086  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145243, 128])
torch.Size([98284, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1464982032775879  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0831918716430664  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([146069, 128])
torch.Size([99907, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15015220642089844  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08179855346679688  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145062, 128])
torch.Size([97961, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14641380310058594  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02791936695575714 |0.01896476000547409 |0.026368245482444763 |9.435415267944336e-05 |0.004381462931632996 |0.003612995147705078 |
----------------------------------------------------------pseudo_mini_loss sum 5.012282371520996
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8581286
Number of first layer input nodes during this epoch:  4656152
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.10881805419921875  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018831253051757812
random selection method range initialization spend 0.00487065315246582
time for parepare:  0.01732158660888672
local_output_nid generation:  0.0012912750244140625
local_in_edges_tensor generation:  0.005677461624145508
mini_batch_src_global generation:  0.001598358154296875
r_  generation:  0.008601188659667969
local_output_nid generation:  0.0014429092407226562
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0014319419860839844
r_  generation:  0.007871627807617188
local_output_nid generation:  0.001524209976196289
local_in_edges_tensor generation:  0.0008502006530761719
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.007669925689697266
local_output_nid generation:  0.0014579296112060547
local_in_edges_tensor generation:  0.0008108615875244141
mini_batch_src_global generation:  0.001005411148071289
r_  generation:  0.007863283157348633
local_output_nid generation:  0.001430511474609375
local_in_edges_tensor generation:  0.0008039474487304688
mini_batch_src_global generation:  0.0009708404541015625
r_  generation:  0.007873773574829102
local_output_nid generation:  0.001451730728149414
local_in_edges_tensor generation:  0.0007905960083007812
mini_batch_src_global generation:  0.0009481906890869141
r_  generation:  0.008039712905883789
local_output_nid generation:  0.0014019012451171875
local_in_edges_tensor generation:  0.0007953643798828125
mini_batch_src_global generation:  0.0009729862213134766
r_  generation:  0.00835728645324707
local_output_nid generation:  0.0014023780822753906
local_in_edges_tensor generation:  0.00078582763671875
mini_batch_src_global generation:  0.0009670257568359375
r_  generation:  0.008233785629272461
local_output_nid generation:  0.001415252685546875
local_in_edges_tensor generation:  0.0008053779602050781
mini_batch_src_global generation:  0.003926992416381836
r_  generation:  0.00872802734375
local_output_nid generation:  0.0020492076873779297
local_in_edges_tensor generation:  0.003320932388305664
mini_batch_src_global generation:  0.001207590103149414
r_  generation:  0.008471250534057617
local_output_nid generation:  0.0014262199401855469
local_in_edges_tensor generation:  0.0012133121490478516
mini_batch_src_global generation:  0.0009970664978027344
r_  generation:  0.008639335632324219
local_output_nid generation:  0.0014042854309082031
local_in_edges_tensor generation:  0.0008432865142822266
mini_batch_src_global generation:  0.0009455680847167969
r_  generation:  0.008539676666259766
local_output_nid generation:  0.0014104843139648438
local_in_edges_tensor generation:  0.0007882118225097656
mini_batch_src_global generation:  0.0009570121765136719
r_  generation:  0.008245229721069336
local_output_nid generation:  0.0014376640319824219
local_in_edges_tensor generation:  0.0007848739624023438
mini_batch_src_global generation:  0.0009145736694335938
r_  generation:  0.00850057601928711
local_output_nid generation:  0.0013988018035888672
local_in_edges_tensor generation:  0.0008456707000732422
mini_batch_src_global generation:  0.000911712646484375
r_  generation:  0.008268594741821289
local_output_nid generation:  0.0013971328735351562
local_in_edges_tensor generation:  0.0007500648498535156
mini_batch_src_global generation:  0.0008866786956787109
r_  generation:  0.00852346420288086
local_output_nid generation:  0.0020110607147216797
local_in_edges_tensor generation:  0.0007824897766113281
mini_batch_src_global generation:  0.0009350776672363281
r_  generation:  0.00838923454284668
local_output_nid generation:  0.0014383792877197266
local_in_edges_tensor generation:  0.0008060932159423828
mini_batch_src_global generation:  0.0009138584136962891
r_  generation:  0.008112907409667969
local_output_nid generation:  0.0014019012451171875
local_in_edges_tensor generation:  0.0007848739624023438
mini_batch_src_global generation:  0.0012388229370117188
r_  generation:  0.008728981018066406
local_output_nid generation:  0.0014028549194335938
local_in_edges_tensor generation:  0.0007643699645996094
mini_batch_src_global generation:  0.0009465217590332031
r_  generation:  0.008520126342773438
local_output_nid generation:  0.0014407634735107422
local_in_edges_tensor generation:  0.0007863044738769531
mini_batch_src_global generation:  0.0010008811950683594
r_  generation:  0.008377313613891602
local_output_nid generation:  0.0014128684997558594
local_in_edges_tensor generation:  0.0008008480072021484
mini_batch_src_global generation:  0.0009241104125976562
r_  generation:  0.008437156677246094
local_output_nid generation:  0.0014162063598632812
local_in_edges_tensor generation:  0.0007672309875488281
mini_batch_src_global generation:  0.0009279251098632812
r_  generation:  0.01023554801940918
local_output_nid generation:  0.0014302730560302734
local_in_edges_tensor generation:  0.0009341239929199219
mini_batch_src_global generation:  0.0009150505065917969
r_  generation:  0.008415460586547852
local_output_nid generation:  0.0014138221740722656
local_in_edges_tensor generation:  0.0007481575012207031
mini_batch_src_global generation:  0.0009531974792480469
r_  generation:  0.008423805236816406
local_output_nid generation:  0.0014061927795410156
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.0009336471557617188
r_  generation:  0.008322477340698242
local_output_nid generation:  0.0014145374298095703
local_in_edges_tensor generation:  0.0007445812225341797
mini_batch_src_global generation:  0.0009250640869140625
r_  generation:  0.008367538452148438
local_output_nid generation:  0.0014133453369140625
local_in_edges_tensor generation:  0.0009486675262451172
mini_batch_src_global generation:  0.0009348392486572266
r_  generation:  0.008653402328491211
local_output_nid generation:  0.0014181137084960938
local_in_edges_tensor generation:  0.00075531005859375
mini_batch_src_global generation:  0.0009210109710693359
r_  generation:  0.008391857147216797
local_output_nid generation:  0.001422882080078125
local_in_edges_tensor generation:  0.0007908344268798828
mini_batch_src_global generation:  0.0008995532989501953
r_  generation:  0.008437871932983398
local_output_nid generation:  0.0014090538024902344
local_in_edges_tensor generation:  0.0007479190826416016
mini_batch_src_global generation:  0.0009007453918457031
r_  generation:  0.008764266967773438
local_output_nid generation:  0.0014162063598632812
local_in_edges_tensor generation:  0.0007960796356201172
mini_batch_src_global generation:  0.0009090900421142578
r_  generation:  0.00811314582824707
----------------------check_connections_block total spend ----------------------------- 0.48964786529541016
generate_one_block  0.014492988586425781
generate_one_block  0.01584601402282715
generate_one_block  0.013044118881225586
generate_one_block  0.013329744338989258
generate_one_block  0.013397932052612305
generate_one_block  0.013204336166381836
generate_one_block  0.013513326644897461
generate_one_block  0.013577461242675781
generate_one_block  0.013229846954345703
generate_one_block  0.013391494750976562
generate_one_block  0.013454675674438477
generate_one_block  0.013613224029541016
generate_one_block  0.015710830688476562
generate_one_block  0.02285909652709961
generate_one_block  0.014811038970947266
generate_one_block  0.013108015060424805
generate_one_block  0.013084888458251953
generate_one_block  0.01306295394897461
generate_one_block  0.013508081436157227
generate_one_block  0.013458967208862305
generate_one_block  0.013433218002319336
generate_one_block  0.013140678405761719
generate_one_block  0.013364315032958984
generate_one_block  0.013396501541137695
generate_one_block  0.013218164443969727
generate_one_block  0.013583898544311523
generate_one_block  0.014968156814575195
generate_one_block  0.01699972152709961
generate_one_block  0.013838052749633789
generate_one_block  0.013314962387084961
generate_one_block  0.013478755950927734
generate_one_block  0.013322830200195312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04703712463378906
gen group dst list time:  0.01982259750366211
time for parepare:  0.022472858428955078
local_output_nid generation:  0.004869937896728516
local_in_edges_tensor generation:  0.02474069595336914
mini_batch_src_global generation:  0.01175069808959961
r_  generation:  0.11780762672424316
local_output_nid generation:  0.0073757171630859375
local_in_edges_tensor generation:  0.011361837387084961
mini_batch_src_global generation:  0.01635599136352539
r_  generation:  0.12173247337341309
local_output_nid generation:  0.007664203643798828
local_in_edges_tensor generation:  0.02593207359313965
mini_batch_src_global generation:  0.014118671417236328
r_  generation:  0.12369418144226074
local_output_nid generation:  0.007835865020751953
local_in_edges_tensor generation:  0.009369373321533203
mini_batch_src_global generation:  0.0165863037109375
r_  generation:  0.12955880165100098
local_output_nid generation:  0.007835865020751953
local_in_edges_tensor generation:  0.008557796478271484
mini_batch_src_global generation:  0.015352487564086914
r_  generation:  0.13172554969787598
local_output_nid generation:  0.0073773860931396484
local_in_edges_tensor generation:  0.010329723358154297
mini_batch_src_global generation:  0.017071962356567383
r_  generation:  0.1307821273803711
local_output_nid generation:  0.007513999938964844
local_in_edges_tensor generation:  0.009401559829711914
mini_batch_src_global generation:  0.01732778549194336
r_  generation:  0.13288593292236328
local_output_nid generation:  0.007518768310546875
local_in_edges_tensor generation:  0.009120941162109375
mini_batch_src_global generation:  0.017881155014038086
r_  generation:  0.13493752479553223
local_output_nid generation:  0.00729680061340332
local_in_edges_tensor generation:  0.009286880493164062
mini_batch_src_global generation:  0.01594090461730957
r_  generation:  0.1315155029296875
local_output_nid generation:  0.007425069808959961
local_in_edges_tensor generation:  0.00906515121459961
mini_batch_src_global generation:  0.017052650451660156
r_  generation:  0.1314249038696289
local_output_nid generation:  0.007950067520141602
local_in_edges_tensor generation:  0.009279489517211914
mini_batch_src_global generation:  0.01627802848815918
r_  generation:  0.1372826099395752
local_output_nid generation:  0.007863759994506836
local_in_edges_tensor generation:  0.008090972900390625
mini_batch_src_global generation:  0.021453380584716797
r_  generation:  0.13370847702026367
local_output_nid generation:  0.007951498031616211
local_in_edges_tensor generation:  0.009053707122802734
mini_batch_src_global generation:  0.022856712341308594
r_  generation:  0.13838791847229004
local_output_nid generation:  0.00777435302734375
local_in_edges_tensor generation:  0.008211374282836914
mini_batch_src_global generation:  0.016193151473999023
r_  generation:  0.13122296333312988
local_output_nid generation:  0.007768869400024414
local_in_edges_tensor generation:  0.009600162506103516
mini_batch_src_global generation:  0.01584482192993164
r_  generation:  0.1347670555114746
local_output_nid generation:  0.007729768753051758
local_in_edges_tensor generation:  0.010282516479492188
mini_batch_src_global generation:  0.022678613662719727
r_  generation:  0.13380885124206543
local_output_nid generation:  0.007796764373779297
local_in_edges_tensor generation:  0.010219812393188477
mini_batch_src_global generation:  0.022386550903320312
r_  generation:  0.13870573043823242
local_output_nid generation:  0.008710145950317383
local_in_edges_tensor generation:  0.013930559158325195
mini_batch_src_global generation:  0.01667308807373047
r_  generation:  0.13770627975463867
local_output_nid generation:  0.009309530258178711
local_in_edges_tensor generation:  0.011110067367553711
mini_batch_src_global generation:  0.017279386520385742
r_  generation:  0.1363227367401123
local_output_nid generation:  0.008136749267578125
local_in_edges_tensor generation:  0.009668827056884766
mini_batch_src_global generation:  0.016344785690307617
r_  generation:  0.1374359130859375
local_output_nid generation:  0.008319616317749023
local_in_edges_tensor generation:  0.011404991149902344
mini_batch_src_global generation:  0.016916513442993164
r_  generation:  0.13867926597595215
local_output_nid generation:  0.007981538772583008
local_in_edges_tensor generation:  0.009119749069213867
mini_batch_src_global generation:  0.01890850067138672
r_  generation:  0.13611626625061035
local_output_nid generation:  0.007979869842529297
local_in_edges_tensor generation:  0.009318828582763672
mini_batch_src_global generation:  0.016153335571289062
r_  generation:  0.13503170013427734
local_output_nid generation:  0.0075871944427490234
local_in_edges_tensor generation:  0.007975578308105469
mini_batch_src_global generation:  0.01602005958557129
r_  generation:  0.13346648216247559
local_output_nid generation:  0.007405757904052734
local_in_edges_tensor generation:  0.007924079895019531
mini_batch_src_global generation:  0.015673160552978516
r_  generation:  0.12975287437438965
local_output_nid generation:  0.007476091384887695
local_in_edges_tensor generation:  0.009239435195922852
mini_batch_src_global generation:  0.016880035400390625
r_  generation:  0.13508224487304688
local_output_nid generation:  0.0074613094329833984
local_in_edges_tensor generation:  0.008142471313476562
mini_batch_src_global generation:  0.03181266784667969
r_  generation:  0.13259410858154297
local_output_nid generation:  0.0074465274810791016
local_in_edges_tensor generation:  0.009181022644042969
mini_batch_src_global generation:  0.016129016876220703
r_  generation:  0.1312544345855713
local_output_nid generation:  0.007576465606689453
local_in_edges_tensor generation:  0.010294437408447266
mini_batch_src_global generation:  0.018399477005004883
r_  generation:  0.136458158493042
local_output_nid generation:  0.007616281509399414
local_in_edges_tensor generation:  0.008166074752807617
mini_batch_src_global generation:  0.030280113220214844
r_  generation:  0.1344287395477295
local_output_nid generation:  0.008420228958129883
local_in_edges_tensor generation:  0.021506071090698242
mini_batch_src_global generation:  0.018148422241210938
r_  generation:  0.13520026206970215
local_output_nid generation:  0.007422208786010742
local_in_edges_tensor generation:  0.00799703598022461
mini_batch_src_global generation:  0.01595592498779297
r_  generation:  0.13175225257873535
----------------------check_connections_block total spend ----------------------------- 6.465686798095703
generate_one_block  0.16915440559387207
generate_one_block  0.15947794914245605
generate_one_block  0.16312360763549805
generate_one_block  0.16393685340881348
generate_one_block  0.17885351181030273
generate_one_block  0.16355419158935547
generate_one_block  0.16315984725952148
generate_one_block  0.16533637046813965
generate_one_block  0.16556406021118164
generate_one_block  0.15898609161376953
generate_one_block  0.16445112228393555
generate_one_block  0.16485381126403809
generate_one_block  0.16887807846069336
generate_one_block  0.15873074531555176
generate_one_block  0.16224908828735352
generate_one_block  0.15958309173583984
generate_one_block  0.17057347297668457
generate_one_block  0.15987420082092285
generate_one_block  0.16997718811035156
generate_one_block  0.1957848072052002
generate_one_block  0.17374348640441895
generate_one_block  0.16744112968444824
generate_one_block  0.16633009910583496
generate_one_block  0.16484308242797852
generate_one_block  0.15724396705627441
generate_one_block  0.16902947425842285
generate_one_block  0.16339373588562012
generate_one_block  0.16481971740722656
generate_one_block  0.17165780067443848
generate_one_block  0.16330313682556152
generate_one_block  0.16488933563232422
generate_one_block  0.16475510597229004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04029583930969238
gen group dst list time:  0.1027381420135498
time for parepare:  0.01745772361755371
local_output_nid generation:  0.02242279052734375
local_in_edges_tensor generation:  0.04911518096923828
mini_batch_src_global generation:  0.04016280174255371
r_  generation:  0.3849809169769287
local_output_nid generation:  0.027226924896240234
local_in_edges_tensor generation:  0.040348052978515625
mini_batch_src_global generation:  0.04793906211853027
r_  generation:  0.38346385955810547
local_output_nid generation:  0.026973724365234375
local_in_edges_tensor generation:  0.0344390869140625
mini_batch_src_global generation:  0.04517841339111328
r_  generation:  0.3896827697753906
local_output_nid generation:  0.026019811630249023
local_in_edges_tensor generation:  0.03452563285827637
mini_batch_src_global generation:  0.046152353286743164
r_  generation:  0.3931436538696289
local_output_nid generation:  0.025735855102539062
local_in_edges_tensor generation:  0.03044438362121582
mini_batch_src_global generation:  0.04927945137023926
r_  generation:  0.40103793144226074
local_output_nid generation:  0.02590799331665039
local_in_edges_tensor generation:  0.0270535945892334
mini_batch_src_global generation:  0.04649615287780762
r_  generation:  0.3906433582305908
local_output_nid generation:  0.025745153427124023
local_in_edges_tensor generation:  0.027910947799682617
mini_batch_src_global generation:  0.04959702491760254
r_  generation:  0.409376859664917
local_output_nid generation:  0.025839805603027344
local_in_edges_tensor generation:  0.03841280937194824
mini_batch_src_global generation:  0.04965806007385254
r_  generation:  0.3957808017730713
local_output_nid generation:  0.02558612823486328
local_in_edges_tensor generation:  0.027520418167114258
mini_batch_src_global generation:  0.04756736755371094
r_  generation:  0.3926370143890381
local_output_nid generation:  0.02555561065673828
local_in_edges_tensor generation:  0.027118921279907227
mini_batch_src_global generation:  0.04709434509277344
r_  generation:  0.4026296138763428
local_output_nid generation:  0.02579212188720703
local_in_edges_tensor generation:  0.0384676456451416
mini_batch_src_global generation:  0.046219587326049805
r_  generation:  0.39884424209594727
local_output_nid generation:  0.025575876235961914
local_in_edges_tensor generation:  0.026860952377319336
mini_batch_src_global generation:  0.04771685600280762
r_  generation:  0.39707374572753906
local_output_nid generation:  0.02576613426208496
local_in_edges_tensor generation:  0.027901887893676758
mini_batch_src_global generation:  0.048906803131103516
r_  generation:  0.3986527919769287
local_output_nid generation:  0.02567744255065918
local_in_edges_tensor generation:  0.03020167350769043
mini_batch_src_global generation:  0.047243595123291016
r_  generation:  0.3968353271484375
local_output_nid generation:  0.02544856071472168
local_in_edges_tensor generation:  0.030914783477783203
mini_batch_src_global generation:  0.04902791976928711
r_  generation:  0.41173553466796875
local_output_nid generation:  0.025699138641357422
local_in_edges_tensor generation:  0.03321504592895508
mini_batch_src_global generation:  0.04716181755065918
r_  generation:  0.3948664665222168
local_output_nid generation:  0.02566981315612793
local_in_edges_tensor generation:  0.03412604331970215
mini_batch_src_global generation:  0.0487208366394043
r_  generation:  0.4001278877258301
local_output_nid generation:  0.025647878646850586
local_in_edges_tensor generation:  0.02700519561767578
mini_batch_src_global generation:  0.04682636260986328
r_  generation:  0.4017786979675293
local_output_nid generation:  0.02596282958984375
local_in_edges_tensor generation:  0.03045964241027832
mini_batch_src_global generation:  0.04658937454223633
r_  generation:  0.40025854110717773
local_output_nid generation:  0.026077985763549805
local_in_edges_tensor generation:  0.03464770317077637
mini_batch_src_global generation:  0.04684305191040039
r_  generation:  0.39890265464782715
local_output_nid generation:  0.026265382766723633
local_in_edges_tensor generation:  0.03484463691711426
mini_batch_src_global generation:  0.046692848205566406
r_  generation:  0.4040365219116211
local_output_nid generation:  0.026952505111694336
local_in_edges_tensor generation:  0.03504180908203125
mini_batch_src_global generation:  0.04689335823059082
r_  generation:  0.40369653701782227
local_output_nid generation:  0.02581310272216797
local_in_edges_tensor generation:  0.02716970443725586
mini_batch_src_global generation:  0.045984506607055664
r_  generation:  0.39826512336730957
local_output_nid generation:  0.03051900863647461
local_in_edges_tensor generation:  0.03438925743103027
mini_batch_src_global generation:  0.05333089828491211
r_  generation:  0.40180063247680664
local_output_nid generation:  0.025765419006347656
local_in_edges_tensor generation:  0.03436541557312012
mini_batch_src_global generation:  0.04593920707702637
r_  generation:  0.3972809314727783
local_output_nid generation:  0.026247501373291016
local_in_edges_tensor generation:  0.0316624641418457
mini_batch_src_global generation:  0.04730939865112305
r_  generation:  0.4111044406890869
local_output_nid generation:  0.028829336166381836
local_in_edges_tensor generation:  0.03421759605407715
mini_batch_src_global generation:  0.04632759094238281
r_  generation:  0.4010183811187744
local_output_nid generation:  0.026671648025512695
local_in_edges_tensor generation:  0.027727603912353516
mini_batch_src_global generation:  0.04982495307922363
r_  generation:  0.3967421054840088
local_output_nid generation:  0.026676416397094727
local_in_edges_tensor generation:  0.0345149040222168
mini_batch_src_global generation:  0.0464174747467041
r_  generation:  0.408078670501709
local_output_nid generation:  0.026816606521606445
local_in_edges_tensor generation:  0.02798008918762207
mini_batch_src_global generation:  0.04706931114196777
r_  generation:  0.3945484161376953
local_output_nid generation:  0.026453018188476562
local_in_edges_tensor generation:  0.027551651000976562
mini_batch_src_global generation:  0.046546220779418945
r_  generation:  0.3989851474761963
local_output_nid generation:  0.02662348747253418
local_in_edges_tensor generation:  0.035024404525756836
mini_batch_src_global generation:  0.0467371940612793
r_  generation:  0.40169692039489746
----------------------check_connections_block total spend ----------------------------- 18.91560173034668
generate_one_block  0.5209400653839111
generate_one_block  0.5152847766876221
generate_one_block  0.5097546577453613
generate_one_block  0.5141513347625732
generate_one_block  0.6128554344177246
generate_one_block  0.512751579284668
generate_one_block  0.5181221961975098
generate_one_block  0.5221562385559082
generate_one_block  0.5036566257476807
generate_one_block  0.5088152885437012
generate_one_block  0.5258839130401611
generate_one_block  0.582787275314331
generate_one_block  0.5318942070007324
generate_one_block  0.5106384754180908
generate_one_block  0.5205960273742676
generate_one_block  0.5333797931671143
generate_one_block  0.5416498184204102
generate_one_block  0.5151448249816895
generate_one_block  0.5252151489257812
generate_one_block  0.5220437049865723
generate_one_block  0.5669071674346924
generate_one_block  0.5544319152832031
generate_one_block  0.5448276996612549
generate_one_block  0.5188064575195312
generate_one_block  0.518545389175415
generate_one_block  0.5341668128967285
generate_one_block  0.5055837631225586
generate_one_block  0.5307595729827881
generate_one_block  0.5521650314331055
generate_one_block  0.511009693145752
generate_one_block  0.518916130065918
generate_one_block  0.5309686660766602
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.10881805419921875  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

connection checking time:  25.381288528442383
block generation total time  22.25236225128174
average batch blocks generation time:  0.6953863203525543
block dataloader generation time/epoch 50.06094431877136
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08336114883422852  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145455, 128])
torch.Size([99498, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14911460876464844  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08182430267333984  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([144922, 128])
torch.Size([97793, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1463923454284668  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08209657669067383  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145299, 128])
torch.Size([98467, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14681434631347656  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0832681655883789  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145911, 128])
torch.Size([99345, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15009355545043945  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0833292007446289  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145504, 128])
torch.Size([99157, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15003728866577148  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08327579498291016  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145601, 128])
torch.Size([99205, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1490926742553711  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08232307434082031  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145332, 128])
torch.Size([99228, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1490788459777832  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08230113983154297  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145194, 128])
torch.Size([99402, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14907121658325195  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0832529067993164  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145506, 128])
torch.Size([99047, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14905309677124023  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08325004577636719  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145671, 128])
torch.Size([99079, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1491546630859375  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08335399627685547  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

torch.Size([145980, 128])
torch.Size([100237, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1503744125366211  GigaBytes
Max Memory Allocated: 0.16464519500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08327674865722656  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145529, 128])
torch.Size([98818, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1491079330444336  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08343696594238281  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145775, 128])
torch.Size([99645, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15027475357055664  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0821676254272461  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145296, 128])
torch.Size([98697, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14698505401611328  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08225393295288086  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145321, 128])
torch.Size([99084, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14799261093139648  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08214807510375977  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145229, 128])
torch.Size([98625, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14688968658447266  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08328914642333984  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145666, 128])
torch.Size([99119, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1490778923034668  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08210134506225586  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145141, 128])
torch.Size([98631, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1468510627746582  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08331489562988281  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145761, 128])
torch.Size([99338, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15015077590942383  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08329391479492188  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145817, 128])
torch.Size([99044, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15003490447998047  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.083465576171875  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145443, 128])
torch.Size([99747, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15038633346557617  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08336639404296875  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145598, 128])
torch.Size([99530, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15012884140014648  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08325481414794922  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145811, 128])
torch.Size([98824, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1481633186340332  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08216238021850586  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145157, 128])
torch.Size([98425, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14784574508666992  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08308029174804688  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145486, 128])
torch.Size([97949, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14775991439819336  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08340644836425781  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([146115, 128])
torch.Size([100474, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15041780471801758  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08221912384033203  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145352, 128])
torch.Size([98807, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1471090316772461  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08325767517089844  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145665, 128])
torch.Size([99383, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15010690689086914  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08341598510742188  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145975, 128])
torch.Size([100007, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1503596305847168  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0832061767578125  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145869, 128])
torch.Size([98993, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1482100486755371  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08326435089111328  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([145520, 128])
torch.Size([98746, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14814186096191406  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.083221435546875  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

torch.Size([146156, 128])
torch.Size([99461, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14907073974609375  GigaBytes
Max Memory Allocated: 0.16486120223999023  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02720913290977478 |0.01408693939447403 |0.0037551969289779663 |9.219348430633545e-05 |0.0035812407732009888 |0.001756429672241211 |
----------------------------------------------------------pseudo_mini_loss sum 4.336831569671631
Total (block generation + training)time/epoch 51.66651940345764
Training time/epoch 1.6053662300109863
Training time without block to device /epoch 1.1545841693878174
Training time without total dataloading part /epoch 0.2394726276397705
load block tensor time/epoch 0.870692253112793
block to device time/epoch 0.45078206062316895
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8581185
Number of first layer input nodes during this epoch:  4658057
