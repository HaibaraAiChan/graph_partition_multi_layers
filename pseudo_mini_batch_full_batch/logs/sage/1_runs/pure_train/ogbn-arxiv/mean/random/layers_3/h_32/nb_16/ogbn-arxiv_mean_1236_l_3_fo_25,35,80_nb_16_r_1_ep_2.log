Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648353679.3609207
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027956008911132812
random selection method range initialization spend 0.006091117858886719
time for parepare:  0.01852273941040039
local_output_nid generation:  0.0021240711212158203
local_in_edges_tensor generation:  0.004853963851928711
mini_batch_src_global generation:  0.001953601837158203
r_  generation:  0.0203244686126709
local_output_nid generation:  0.002593994140625
local_in_edges_tensor generation:  0.0017085075378417969
mini_batch_src_global generation:  0.0024080276489257812
r_  generation:  0.020572423934936523
local_output_nid generation:  0.002796173095703125
local_in_edges_tensor generation:  0.001634836196899414
mini_batch_src_global generation:  0.001605987548828125
r_  generation:  0.021267414093017578
local_output_nid generation:  0.002877950668334961
local_in_edges_tensor generation:  0.0016047954559326172
mini_batch_src_global generation:  0.0015988349914550781
r_  generation:  0.020574569702148438
local_output_nid generation:  0.0029001235961914062
local_in_edges_tensor generation:  0.0015869140625
mini_batch_src_global generation:  0.0015981197357177734
r_  generation:  0.020946502685546875
local_output_nid generation:  0.003047943115234375
local_in_edges_tensor generation:  0.0016703605651855469
mini_batch_src_global generation:  0.0017247200012207031
r_  generation:  0.0218198299407959
local_output_nid generation:  0.0030035972595214844
local_in_edges_tensor generation:  0.0015790462493896484
mini_batch_src_global generation:  0.0016946792602539062
r_  generation:  0.021381616592407227
local_output_nid generation:  0.0029904842376708984
local_in_edges_tensor generation:  0.0016093254089355469
mini_batch_src_global generation:  0.001699209213256836
r_  generation:  0.02075934410095215
local_output_nid generation:  0.0029327869415283203
local_in_edges_tensor generation:  0.0015423297882080078
mini_batch_src_global generation:  0.0016753673553466797
r_  generation:  0.02132105827331543
local_output_nid generation:  0.0029740333557128906
local_in_edges_tensor generation:  0.001668691635131836
mini_batch_src_global generation:  0.0017609596252441406
r_  generation:  0.021954774856567383
local_output_nid generation:  0.003016233444213867
local_in_edges_tensor generation:  0.0015871524810791016
mini_batch_src_global generation:  0.0017020702362060547
r_  generation:  0.021569490432739258
local_output_nid generation:  0.002936840057373047
local_in_edges_tensor generation:  0.0015521049499511719
mini_batch_src_global generation:  0.0017120838165283203
r_  generation:  0.021572113037109375
local_output_nid generation:  0.002889871597290039
local_in_edges_tensor generation:  0.001546621322631836
mini_batch_src_global generation:  0.001687765121459961
r_  generation:  0.021013259887695312
local_output_nid generation:  0.0029354095458984375
local_in_edges_tensor generation:  0.0015506744384765625
mini_batch_src_global generation:  0.0017323493957519531
r_  generation:  0.0216672420501709
local_output_nid generation:  0.002918720245361328
local_in_edges_tensor generation:  0.0015590190887451172
mini_batch_src_global generation:  0.0016908645629882812
r_  generation:  0.02072596549987793
local_output_nid generation:  0.0029611587524414062
local_in_edges_tensor generation:  0.0015659332275390625
mini_batch_src_global generation:  0.0017375946044921875
r_  generation:  0.020914554595947266
----------------------check_connections_block total spend ----------------------------- 0.5454339981079102
generate_one_block  0.03023695945739746
generate_one_block  0.03158712387084961
generate_one_block  0.0345759391784668
generate_one_block  0.03162884712219238
generate_one_block  0.031504154205322266
generate_one_block  0.031363487243652344
generate_one_block  0.030966997146606445
generate_one_block  0.0303647518157959
generate_one_block  0.0310823917388916
generate_one_block  0.032059669494628906
generate_one_block  0.03242087364196777
generate_one_block  0.032132625579833984
generate_one_block  0.031121015548706055
generate_one_block  0.03115057945251465
generate_one_block  0.029886722564697266
generate_one_block  0.03048229217529297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040445566177368164
gen group dst list time:  0.020443201065063477
time for parepare:  0.01943492889404297
local_output_nid generation:  0.008868217468261719
local_in_edges_tensor generation:  0.018774032592773438
mini_batch_src_global generation:  0.020574569702148438
r_  generation:  0.21139025688171387
local_output_nid generation:  0.013250589370727539
local_in_edges_tensor generation:  0.022326231002807617
mini_batch_src_global generation:  0.0276336669921875
r_  generation:  0.228135347366333
local_output_nid generation:  0.013006448745727539
local_in_edges_tensor generation:  0.01944112777709961
mini_batch_src_global generation:  0.027159690856933594
r_  generation:  0.23252391815185547
local_output_nid generation:  0.01293635368347168
local_in_edges_tensor generation:  0.018864154815673828
mini_batch_src_global generation:  0.027584314346313477
r_  generation:  0.23048114776611328
local_output_nid generation:  0.012856006622314453
local_in_edges_tensor generation:  0.01868271827697754
mini_batch_src_global generation:  0.028272628784179688
r_  generation:  0.23351693153381348
local_output_nid generation:  0.012869119644165039
local_in_edges_tensor generation:  0.01631474494934082
mini_batch_src_global generation:  0.028927326202392578
r_  generation:  0.23087525367736816
local_output_nid generation:  0.012896299362182617
local_in_edges_tensor generation:  0.0163118839263916
mini_batch_src_global generation:  0.030829906463623047
r_  generation:  0.2344341278076172
local_output_nid generation:  0.012548446655273438
local_in_edges_tensor generation:  0.016681909561157227
mini_batch_src_global generation:  0.02875494956970215
r_  generation:  0.2326517105102539
local_output_nid generation:  0.012725114822387695
local_in_edges_tensor generation:  0.014280319213867188
mini_batch_src_global generation:  0.029088973999023438
r_  generation:  0.2336592674255371
local_output_nid generation:  0.012852191925048828
local_in_edges_tensor generation:  0.018504858016967773
mini_batch_src_global generation:  0.0313725471496582
r_  generation:  0.23702144622802734
local_output_nid generation:  0.012918233871459961
local_in_edges_tensor generation:  0.01496744155883789
mini_batch_src_global generation:  0.02900242805480957
r_  generation:  0.23211956024169922
local_output_nid generation:  0.012936830520629883
local_in_edges_tensor generation:  0.016344785690307617
mini_batch_src_global generation:  0.03153371810913086
r_  generation:  0.23606014251708984
local_output_nid generation:  0.012756586074829102
local_in_edges_tensor generation:  0.018728256225585938
mini_batch_src_global generation:  0.029353618621826172
r_  generation:  0.2318587303161621
local_output_nid generation:  0.012820720672607422
local_in_edges_tensor generation:  0.016489267349243164
mini_batch_src_global generation:  0.029470443725585938
r_  generation:  0.23688340187072754
local_output_nid generation:  0.012543916702270508
local_in_edges_tensor generation:  0.0159304141998291
mini_batch_src_global generation:  0.028603553771972656
r_  generation:  0.23019957542419434
local_output_nid generation:  0.012712955474853516
local_in_edges_tensor generation:  0.016585350036621094
mini_batch_src_global generation:  0.029196500778198242
r_  generation:  0.22905635833740234
----------------------check_connections_block total spend ----------------------------- 5.466527223587036
generate_one_block  0.298022985458374
generate_one_block  0.3082900047302246
generate_one_block  0.31397581100463867
generate_one_block  0.3058655261993408
generate_one_block  0.3179929256439209
generate_one_block  0.30149102210998535
generate_one_block  0.3050408363342285
generate_one_block  0.2974402904510498
generate_one_block  0.30154919624328613
generate_one_block  0.306262731552124
generate_one_block  0.3001589775085449
generate_one_block  0.30809903144836426
generate_one_block  0.2968409061431885
generate_one_block  0.30170297622680664
generate_one_block  0.3029017448425293
generate_one_block  0.29656982421875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036121368408203125
gen group dst list time:  0.0600886344909668
time for parepare:  0.019001245498657227
local_output_nid generation:  0.025597333908081055
local_in_edges_tensor generation:  0.03959941864013672
mini_batch_src_global generation:  0.04490208625793457
r_  generation:  0.45432209968566895
local_output_nid generation:  0.032093048095703125
local_in_edges_tensor generation:  0.048891305923461914
mini_batch_src_global generation:  0.06290006637573242
r_  generation:  0.44794368743896484
local_output_nid generation:  0.03170037269592285
local_in_edges_tensor generation:  0.045708417892456055
mini_batch_src_global generation:  0.05279183387756348
r_  generation:  0.4586954116821289
local_output_nid generation:  0.03142595291137695
local_in_edges_tensor generation:  0.06090116500854492
mini_batch_src_global generation:  0.054271697998046875
r_  generation:  0.4560396671295166
local_output_nid generation:  0.03199648857116699
local_in_edges_tensor generation:  0.033646583557128906
mini_batch_src_global generation:  0.05180954933166504
r_  generation:  0.4586503505706787
local_output_nid generation:  0.031459808349609375
local_in_edges_tensor generation:  0.02866363525390625
mini_batch_src_global generation:  0.05309867858886719
r_  generation:  0.4535517692565918
local_output_nid generation:  0.03588294982910156
local_in_edges_tensor generation:  0.02970433235168457
mini_batch_src_global generation:  0.055324554443359375
r_  generation:  0.46279382705688477
local_output_nid generation:  0.031681060791015625
local_in_edges_tensor generation:  0.03643155097961426
mini_batch_src_global generation:  0.05246090888977051
r_  generation:  0.45306825637817383
local_output_nid generation:  0.03180551528930664
local_in_edges_tensor generation:  0.035648345947265625
mini_batch_src_global generation:  0.052402496337890625
r_  generation:  0.45992445945739746
local_output_nid generation:  0.03497481346130371
local_in_edges_tensor generation:  0.039872169494628906
mini_batch_src_global generation:  0.058301687240600586
r_  generation:  0.4565591812133789
local_output_nid generation:  0.03148984909057617
local_in_edges_tensor generation:  0.034211158752441406
mini_batch_src_global generation:  0.05921792984008789
r_  generation:  0.4591517448425293
local_output_nid generation:  0.03191637992858887
local_in_edges_tensor generation:  0.03024458885192871
mini_batch_src_global generation:  0.05693554878234863
r_  generation:  0.4707024097442627
local_output_nid generation:  0.03252220153808594
local_in_edges_tensor generation:  0.037491559982299805
mini_batch_src_global generation:  0.053949832916259766
r_  generation:  0.46451520919799805
local_output_nid generation:  0.03258919715881348
local_in_edges_tensor generation:  0.030199766159057617
mini_batch_src_global generation:  0.05430459976196289
r_  generation:  0.4557821750640869
local_output_nid generation:  0.032273054122924805
local_in_edges_tensor generation:  0.0292356014251709
mini_batch_src_global generation:  0.05231308937072754
r_  generation:  0.4660830497741699
local_output_nid generation:  0.0345301628112793
local_in_edges_tensor generation:  0.037525177001953125
mini_batch_src_global generation:  0.05272936820983887
r_  generation:  0.45737266540527344
----------------------check_connections_block total spend ----------------------------- 10.91889500617981
generate_one_block  0.5787098407745361
generate_one_block  0.5887229442596436
generate_one_block  0.5983607769012451
generate_one_block  0.587085485458374
generate_one_block  0.5993547439575195
generate_one_block  0.5885822772979736
generate_one_block  0.6356110572814941
generate_one_block  0.581986665725708
generate_one_block  0.5872611999511719
generate_one_block  0.5986931324005127
generate_one_block  0.5709559917449951
generate_one_block  0.5865933895111084
generate_one_block  0.5784103870391846
generate_one_block  0.5832931995391846
generate_one_block  0.5873026847839355
generate_one_block  0.5848660469055176
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  16.385422229766846
block generation total time  14.297994613647461
average batch blocks generation time:  0.8936246633529663
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.0905308723449707  GigaBytes
Max Memory Allocated: 0.0905308723449707  GigaBytes

torch.Size([154720, 128])
torch.Size([123922, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.18296527862548828  GigaBytes
Max Memory Allocated: 0.1854538917541504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09171009063720703  GigaBytes
Max Memory Allocated: 0.19605016708374023  GigaBytes

torch.Size([154807, 128])
torch.Size([124535, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18589353561401367  GigaBytes
Max Memory Allocated: 0.19605016708374023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0918426513671875  GigaBytes
Max Memory Allocated: 0.19684648513793945  GigaBytes

torch.Size([155460, 128])
torch.Size([126090, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18736839294433594  GigaBytes
Max Memory Allocated: 0.19684648513793945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09169673919677734  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155576, 128])
torch.Size([125547, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18593788146972656  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09167671203613281  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155376, 128])
torch.Size([125775, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1858682632446289  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09157085418701172  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([154574, 128])
torch.Size([124080, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18443536758422852  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09171295166015625  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155289, 128])
torch.Size([125480, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1858668327331543  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09151554107666016  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([154805, 128])
torch.Size([124617, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1842341423034668  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09161090850830078  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155261, 128])
torch.Size([125247, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1855783462524414  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09173965454101562  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([154993, 128])
torch.Size([125114, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1870102882385254  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09151268005371094  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155079, 128])
torch.Size([124667, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1853199005126953  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09170246124267578  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155087, 128])
torch.Size([125151, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1859755516052246  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09151554107666016  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155130, 128])
torch.Size([125191, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18533039093017578  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09154129028320312  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([154732, 128])
torch.Size([124487, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18448972702026367  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09144020080566406  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([154863, 128])
torch.Size([124406, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18280506134033203  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0914306640625  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155037, 128])
torch.Size([125128, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18405914306640625  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033994972705841064 |0.031721457839012146 |0.052141815423965454 |9.579956531524658e-05 |0.0075179338455200195 |0.0018854141235351562 |
----------------------------------------------------------pseudo_mini_loss sum 5.044978618621826
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5210415
Number of first layer input nodes during this epoch:  2480789
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.12609100341796875  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028966426849365234
random selection method range initialization spend 0.0052585601806640625
time for parepare:  0.018580198287963867
local_output_nid generation:  0.0023398399353027344
local_in_edges_tensor generation:  0.011918783187866211
mini_batch_src_global generation:  0.002133607864379883
r_  generation:  0.019276142120361328
local_output_nid generation:  0.0028057098388671875
local_in_edges_tensor generation:  0.001794576644897461
mini_batch_src_global generation:  0.0023741722106933594
r_  generation:  0.020269393920898438
local_output_nid generation:  0.0028810501098632812
local_in_edges_tensor generation:  0.00170135498046875
mini_batch_src_global generation:  0.0015697479248046875
r_  generation:  0.020519495010375977
local_output_nid generation:  0.002967357635498047
local_in_edges_tensor generation:  0.001749277114868164
mini_batch_src_global generation:  0.0015902519226074219
r_  generation:  0.021394968032836914
local_output_nid generation:  0.00289154052734375
local_in_edges_tensor generation:  0.0017070770263671875
mini_batch_src_global generation:  0.0015821456909179688
r_  generation:  0.02334761619567871
local_output_nid generation:  0.002907991409301758
local_in_edges_tensor generation:  0.0017971992492675781
mini_batch_src_global generation:  0.001703023910522461
r_  generation:  0.021558284759521484
local_output_nid generation:  0.002971649169921875
local_in_edges_tensor generation:  0.0017123222351074219
mini_batch_src_global generation:  0.001707315444946289
r_  generation:  0.021681547164916992
local_output_nid generation:  0.002934694290161133
local_in_edges_tensor generation:  0.0017087459564208984
mini_batch_src_global generation:  0.0017392635345458984
r_  generation:  0.021622657775878906
local_output_nid generation:  0.0029227733612060547
local_in_edges_tensor generation:  0.0017092227935791016
mini_batch_src_global generation:  0.0017039775848388672
r_  generation:  0.021425962448120117
local_output_nid generation:  0.0029366016387939453
local_in_edges_tensor generation:  0.0016503334045410156
mini_batch_src_global generation:  0.001781463623046875
r_  generation:  0.021979808807373047
local_output_nid generation:  0.002963542938232422
local_in_edges_tensor generation:  0.0016803741455078125
mini_batch_src_global generation:  0.0018384456634521484
r_  generation:  0.02241039276123047
local_output_nid generation:  0.0029866695404052734
local_in_edges_tensor generation:  0.001664876937866211
mini_batch_src_global generation:  0.0017664432525634766
r_  generation:  0.022032737731933594
local_output_nid generation:  0.00295257568359375
local_in_edges_tensor generation:  0.001729726791381836
mini_batch_src_global generation:  0.0017507076263427734
r_  generation:  0.021709203720092773
local_output_nid generation:  0.0029549598693847656
local_in_edges_tensor generation:  0.0016863346099853516
mini_batch_src_global generation:  0.0018227100372314453
r_  generation:  0.0218966007232666
local_output_nid generation:  0.002909421920776367
local_in_edges_tensor generation:  0.0017108917236328125
mini_batch_src_global generation:  0.0018031597137451172
r_  generation:  0.02222156524658203
local_output_nid generation:  0.0029196739196777344
local_in_edges_tensor generation:  0.0016281604766845703
mini_batch_src_global generation:  0.0017905235290527344
r_  generation:  0.021646976470947266
----------------------check_connections_block total spend ----------------------------- 0.5640726089477539
generate_one_block  0.042365074157714844
generate_one_block  0.031163454055786133
generate_one_block  0.030861377716064453
generate_one_block  0.031774044036865234
generate_one_block  0.03057384490966797
generate_one_block  0.03383827209472656
generate_one_block  0.03186321258544922
generate_one_block  0.031114578247070312
generate_one_block  0.030707120895385742
generate_one_block  0.03154778480529785
generate_one_block  0.031770944595336914
generate_one_block  0.031591176986694336
generate_one_block  0.03098011016845703
generate_one_block  0.03099656105041504
generate_one_block  0.03146934509277344
generate_one_block  0.03161144256591797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04907798767089844
gen group dst list time:  0.019385099411010742
time for parepare:  0.018777132034301758
local_output_nid generation:  0.008971214294433594
local_in_edges_tensor generation:  0.0211789608001709
mini_batch_src_global generation:  0.022341012954711914
r_  generation:  0.20767641067504883
local_output_nid generation:  0.013271808624267578
local_in_edges_tensor generation:  0.02094864845275879
mini_batch_src_global generation:  0.02823615074157715
r_  generation:  0.21575593948364258
local_output_nid generation:  0.013234138488769531
local_in_edges_tensor generation:  0.019617557525634766
mini_batch_src_global generation:  0.02627396583557129
r_  generation:  0.2268965244293213
local_output_nid generation:  0.013887405395507812
local_in_edges_tensor generation:  0.017664432525634766
mini_batch_src_global generation:  0.027423858642578125
r_  generation:  0.2304973602294922
local_output_nid generation:  0.01345372200012207
local_in_edges_tensor generation:  0.013625144958496094
mini_batch_src_global generation:  0.028003454208374023
r_  generation:  0.22922468185424805
local_output_nid generation:  0.013517618179321289
local_in_edges_tensor generation:  0.017255306243896484
mini_batch_src_global generation:  0.030122041702270508
r_  generation:  0.23368000984191895
local_output_nid generation:  0.012984752655029297
local_in_edges_tensor generation:  0.019779443740844727
mini_batch_src_global generation:  0.030777692794799805
r_  generation:  0.23873329162597656
local_output_nid generation:  0.012897491455078125
local_in_edges_tensor generation:  0.013589143753051758
mini_batch_src_global generation:  0.029349327087402344
r_  generation:  0.23029065132141113
local_output_nid generation:  0.013026714324951172
local_in_edges_tensor generation:  0.013170957565307617
mini_batch_src_global generation:  0.029253482818603516
r_  generation:  0.236008882522583
local_output_nid generation:  0.013077497482299805
local_in_edges_tensor generation:  0.01753973960876465
mini_batch_src_global generation:  0.031143903732299805
r_  generation:  0.23934245109558105
local_output_nid generation:  0.013179302215576172
local_in_edges_tensor generation:  0.018354177474975586
mini_batch_src_global generation:  0.031195878982543945
r_  generation:  0.23904037475585938
local_output_nid generation:  0.013187885284423828
local_in_edges_tensor generation:  0.017690420150756836
mini_batch_src_global generation:  0.029644012451171875
r_  generation:  0.23699617385864258
local_output_nid generation:  0.012825489044189453
local_in_edges_tensor generation:  0.016237497329711914
mini_batch_src_global generation:  0.029306411743164062
r_  generation:  0.23561620712280273
local_output_nid generation:  0.013048410415649414
local_in_edges_tensor generation:  0.013574600219726562
mini_batch_src_global generation:  0.0293731689453125
r_  generation:  0.2374286651611328
local_output_nid generation:  0.01322317123413086
local_in_edges_tensor generation:  0.019367456436157227
mini_batch_src_global generation:  0.029613971710205078
r_  generation:  0.24021291732788086
local_output_nid generation:  0.016333341598510742
local_in_edges_tensor generation:  0.017110109329223633
mini_batch_src_global generation:  0.029577970504760742
r_  generation:  0.24029207229614258
----------------------check_connections_block total spend ----------------------------- 5.502264022827148
generate_one_block  0.30534911155700684
generate_one_block  0.2976498603820801
generate_one_block  0.3142244815826416
generate_one_block  0.31557369232177734
generate_one_block  0.31110358238220215
generate_one_block  0.3064258098602295
generate_one_block  0.34330272674560547
generate_one_block  0.2938096523284912
generate_one_block  0.3071577548980713
generate_one_block  0.3137693405151367
generate_one_block  0.31202077865600586
generate_one_block  0.31218504905700684
generate_one_block  0.29952073097229004
generate_one_block  0.3011636734008789
generate_one_block  0.30697154998779297
generate_one_block  0.34324193000793457
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05183124542236328
gen group dst list time:  0.0711221694946289
time for parepare:  0.02112555503845215
local_output_nid generation:  0.026852846145629883
local_in_edges_tensor generation:  0.05433988571166992
mini_batch_src_global generation:  0.06812357902526855
r_  generation:  0.4580535888671875
local_output_nid generation:  0.03649425506591797
local_in_edges_tensor generation:  0.054811716079711914
mini_batch_src_global generation:  0.05650663375854492
r_  generation:  0.4741666316986084
local_output_nid generation:  0.034978628158569336
local_in_edges_tensor generation:  0.05813479423522949
mini_batch_src_global generation:  0.05259990692138672
r_  generation:  0.4559648036956787
local_output_nid generation:  0.032456159591674805
local_in_edges_tensor generation:  0.035097360610961914
mini_batch_src_global generation:  0.05272316932678223
r_  generation:  0.4561116695404053
local_output_nid generation:  0.032532453536987305
local_in_edges_tensor generation:  0.08801627159118652
mini_batch_src_global generation:  0.05150008201599121
r_  generation:  0.4655177593231201
local_output_nid generation:  0.031725406646728516
local_in_edges_tensor generation:  0.04417562484741211
mini_batch_src_global generation:  0.052703142166137695
r_  generation:  0.47008490562438965
local_output_nid generation:  0.0316472053527832
local_in_edges_tensor generation:  0.03210592269897461
mini_batch_src_global generation:  0.05457901954650879
r_  generation:  0.48634815216064453
local_output_nid generation:  0.03736758232116699
local_in_edges_tensor generation:  0.05291318893432617
mini_batch_src_global generation:  0.06351637840270996
r_  generation:  0.4593796730041504
local_output_nid generation:  0.03254508972167969
local_in_edges_tensor generation:  0.04224514961242676
mini_batch_src_global generation:  0.05205273628234863
r_  generation:  0.46199798583984375
local_output_nid generation:  0.03304338455200195
local_in_edges_tensor generation:  0.02939295768737793
mini_batch_src_global generation:  0.05339789390563965
r_  generation:  0.4576427936553955
local_output_nid generation:  0.03270840644836426
local_in_edges_tensor generation:  0.0327913761138916
mini_batch_src_global generation:  0.05263710021972656
r_  generation:  0.4673430919647217
local_output_nid generation:  0.03306245803833008
local_in_edges_tensor generation:  0.02932429313659668
mini_batch_src_global generation:  0.0528867244720459
r_  generation:  0.4685370922088623
local_output_nid generation:  0.03277778625488281
local_in_edges_tensor generation:  0.03035283088684082
mini_batch_src_global generation:  0.05218791961669922
r_  generation:  0.4688384532928467
local_output_nid generation:  0.0326085090637207
local_in_edges_tensor generation:  0.038046836853027344
mini_batch_src_global generation:  0.052776336669921875
r_  generation:  0.4674098491668701
local_output_nid generation:  0.032889604568481445
local_in_edges_tensor generation:  0.0338900089263916
mini_batch_src_global generation:  0.0522005558013916
r_  generation:  0.474658727645874
local_output_nid generation:  0.034188032150268555
local_in_edges_tensor generation:  0.034597158432006836
mini_batch_src_global generation:  0.05357789993286133
r_  generation:  0.4724240303039551
----------------------check_connections_block total spend ----------------------------- 11.192548751831055
generate_one_block  0.6029603481292725
generate_one_block  0.5908477306365967
generate_one_block  0.5976171493530273
generate_one_block  0.5908575057983398
generate_one_block  0.5828649997711182
generate_one_block  0.6098196506500244
generate_one_block  0.5863454341888428
generate_one_block  0.5851671695709229
generate_one_block  0.6166820526123047
generate_one_block  0.5875744819641113
generate_one_block  0.5853502750396729
generate_one_block  0.6023554801940918
generate_one_block  0.5892033576965332
generate_one_block  0.5850677490234375
generate_one_block  0.595299243927002
generate_one_block  0.5892167091369629
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.12609100341796875  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

connection checking time:  16.694812774658203
block generation total time  14.480699062347412
average batch blocks generation time:  0.9050436913967133
block dataloader generation time/epoch 33.48600363731384
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09154272079467773  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([154821, 128])
torch.Size([124250, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18305683135986328  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09158706665039062  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155246, 128])
torch.Size([125116, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18528461456298828  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09179210662841797  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155039, 128])
torch.Size([124878, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18584728240966797  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09174442291259766  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([154785, 128])
torch.Size([124666, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18587255477905273  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09164714813232422  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155037, 128])
torch.Size([124923, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1855015754699707  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.091766357421875  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155157, 128])
torch.Size([125339, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18590736389160156  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0917959213256836  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([154998, 128])
torch.Size([124925, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18594026565551758  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09160614013671875  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([154631, 128])
torch.Size([124462, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1833343505859375  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09169387817382812  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([154788, 128])
torch.Size([124597, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18562602996826172  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09169960021972656  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155071, 128])
torch.Size([124819, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18584346771240234  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09183120727539062  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155009, 128])
torch.Size([124505, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18605661392211914  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09173011779785156  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155115, 128])
torch.Size([124712, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1858062744140625  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09161758422851562  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155142, 128])
torch.Size([125064, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1854381561279297  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09171390533447266  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155128, 128])
torch.Size([125183, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1857924461364746  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09174633026123047  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155199, 128])
torch.Size([125182, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18594694137573242  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09162616729736328  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

torch.Size([155091, 128])
torch.Size([124766, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18544435501098633  GigaBytes
Max Memory Allocated: 0.19816350936889648  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030980393290519714 |0.014826074242591858 |0.0035178065299987793 |9.401142597198486e-05 |0.0035221129655838013 |0.003007650375366211 |
----------------------------------------------------------pseudo_mini_loss sum 4.34288215637207
Total (block generation + training)time/epoch 34.362905502319336
Training time/epoch 0.8766882419586182
Training time without block to device /epoch 0.6394710540771484
Training time without total dataloading part /epoch 0.11715054512023926
load block tensor time/epoch 0.49568629264831543
block to device time/epoch 0.23721718788146973
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5207656
Number of first layer input nodes during this epoch:  2480257
