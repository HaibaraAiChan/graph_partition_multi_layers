Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648355302.1638944
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0247495174407959
random selection method range initialization spend 0.006369829177856445
time for parepare:  0.01813650131225586
local_output_nid generation:  0.001096487045288086
local_in_edges_tensor generation:  0.0039517879486083984
mini_batch_src_global generation:  0.0013887882232666016
r_  generation:  0.00865793228149414
local_output_nid generation:  0.00118255615234375
local_in_edges_tensor generation:  0.000980377197265625
mini_batch_src_global generation:  0.0012919902801513672
r_  generation:  0.0076830387115478516
local_output_nid generation:  0.0012328624725341797
local_in_edges_tensor generation:  0.0008552074432373047
mini_batch_src_global generation:  0.0009450912475585938
r_  generation:  0.00756525993347168
local_output_nid generation:  0.0012753009796142578
local_in_edges_tensor generation:  0.0008232593536376953
mini_batch_src_global generation:  0.0008363723754882812
r_  generation:  0.007757663726806641
local_output_nid generation:  0.0012676715850830078
local_in_edges_tensor generation:  0.0008029937744140625
mini_batch_src_global generation:  0.00077056884765625
r_  generation:  0.00753021240234375
local_output_nid generation:  0.0012969970703125
local_in_edges_tensor generation:  0.0007865428924560547
mini_batch_src_global generation:  0.000812530517578125
r_  generation:  0.007866621017456055
local_output_nid generation:  0.0013496875762939453
local_in_edges_tensor generation:  0.0007929801940917969
mini_batch_src_global generation:  0.0008029937744140625
r_  generation:  0.007909297943115234
local_output_nid generation:  0.00131988525390625
local_in_edges_tensor generation:  0.0007612705230712891
mini_batch_src_global generation:  0.0008132457733154297
r_  generation:  0.008229970932006836
local_output_nid generation:  0.0013344287872314453
local_in_edges_tensor generation:  0.0007827281951904297
mini_batch_src_global generation:  0.00079345703125
r_  generation:  0.007694244384765625
local_output_nid generation:  0.0014045238494873047
local_in_edges_tensor generation:  0.0007824897766113281
mini_batch_src_global generation:  0.0007941722869873047
r_  generation:  0.00785064697265625
local_output_nid generation:  0.001329660415649414
local_in_edges_tensor generation:  0.0007383823394775391
mini_batch_src_global generation:  0.0008265972137451172
r_  generation:  0.008045434951782227
local_output_nid generation:  0.0013399124145507812
local_in_edges_tensor generation:  0.0007598400115966797
mini_batch_src_global generation:  0.0008091926574707031
r_  generation:  0.007863521575927734
local_output_nid generation:  0.0013201236724853516
local_in_edges_tensor generation:  0.0007627010345458984
mini_batch_src_global generation:  0.0008416175842285156
r_  generation:  0.007929325103759766
local_output_nid generation:  0.0013298988342285156
local_in_edges_tensor generation:  0.0007617473602294922
mini_batch_src_global generation:  0.0008265972137451172
r_  generation:  0.008007287979125977
local_output_nid generation:  0.0013322830200195312
local_in_edges_tensor generation:  0.0007729530334472656
mini_batch_src_global generation:  0.0008544921875
r_  generation:  0.008433341979980469
local_output_nid generation:  0.0013370513916015625
local_in_edges_tensor generation:  0.0007731914520263672
mini_batch_src_global generation:  0.0008778572082519531
r_  generation:  0.008175849914550781
local_output_nid generation:  0.0013358592987060547
local_in_edges_tensor generation:  0.0007512569427490234
mini_batch_src_global generation:  0.0008654594421386719
r_  generation:  0.008315324783325195
local_output_nid generation:  0.001344919204711914
local_in_edges_tensor generation:  0.0007457733154296875
mini_batch_src_global generation:  0.0008912086486816406
r_  generation:  0.008314132690429688
local_output_nid generation:  0.0013544559478759766
local_in_edges_tensor generation:  0.0007677078247070312
mini_batch_src_global generation:  0.0008485317230224609
r_  generation:  0.008394956588745117
local_output_nid generation:  0.0013866424560546875
local_in_edges_tensor generation:  0.0007703304290771484
mini_batch_src_global generation:  0.0008840560913085938
r_  generation:  0.00809788703918457
local_output_nid generation:  0.0013608932495117188
local_in_edges_tensor generation:  0.0007622241973876953
mini_batch_src_global generation:  0.0008976459503173828
r_  generation:  0.008374452590942383
local_output_nid generation:  0.001440286636352539
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.0008938312530517578
r_  generation:  0.008569478988647461
local_output_nid generation:  0.0013718605041503906
local_in_edges_tensor generation:  0.0007517337799072266
mini_batch_src_global generation:  0.0008509159088134766
r_  generation:  0.008194446563720703
local_output_nid generation:  0.0013709068298339844
local_in_edges_tensor generation:  0.0007581710815429688
mini_batch_src_global generation:  0.0009043216705322266
r_  generation:  0.008537054061889648
local_output_nid generation:  0.0014417171478271484
local_in_edges_tensor generation:  0.0007901191711425781
mini_batch_src_global generation:  0.0009355545043945312
r_  generation:  0.008572816848754883
local_output_nid generation:  0.0014281272888183594
local_in_edges_tensor generation:  0.0007827281951904297
mini_batch_src_global generation:  0.0008943080902099609
r_  generation:  0.008069515228271484
local_output_nid generation:  0.0014085769653320312
local_in_edges_tensor generation:  0.0007932186126708984
mini_batch_src_global generation:  0.0008418560028076172
r_  generation:  0.007865428924560547
local_output_nid generation:  0.001390218734741211
local_in_edges_tensor generation:  0.0007562637329101562
mini_batch_src_global generation:  0.0008499622344970703
r_  generation:  0.008094310760498047
local_output_nid generation:  0.0013959407806396484
local_in_edges_tensor generation:  0.0007543563842773438
mini_batch_src_global generation:  0.0008478164672851562
r_  generation:  0.008299827575683594
local_output_nid generation:  0.0013914108276367188
local_in_edges_tensor generation:  0.005188465118408203
mini_batch_src_global generation:  0.001043081283569336
r_  generation:  0.008059501647949219
local_output_nid generation:  0.001249551773071289
local_in_edges_tensor generation:  0.000804901123046875
mini_batch_src_global generation:  0.0009634494781494141
r_  generation:  0.008155107498168945
local_output_nid generation:  0.0013091564178466797
local_in_edges_tensor generation:  0.0007588863372802734
mini_batch_src_global generation:  0.00091552734375
r_  generation:  0.00822591781616211
----------------------check_connections_block total spend ----------------------------- 0.46252989768981934
generate_one_block  0.014008522033691406
generate_one_block  0.013315200805664062
generate_one_block  0.013386249542236328
generate_one_block  0.013609886169433594
generate_one_block  0.012934446334838867
generate_one_block  0.01326894760131836
generate_one_block  0.01312708854675293
generate_one_block  0.013251543045043945
generate_one_block  0.013099908828735352
generate_one_block  0.013267278671264648
generate_one_block  0.013107061386108398
generate_one_block  0.012789011001586914
generate_one_block  0.012944221496582031
generate_one_block  0.012851476669311523
generate_one_block  0.013366222381591797
generate_one_block  0.013205289840698242
generate_one_block  0.013448238372802734
generate_one_block  0.013299703598022461
generate_one_block  0.013085603713989258
generate_one_block  0.013037919998168945
generate_one_block  0.013633012771606445
generate_one_block  0.013543844223022461
generate_one_block  0.012987136840820312
generate_one_block  0.013176679611206055
generate_one_block  0.013573646545410156
generate_one_block  0.012859106063842773
generate_one_block  0.012680292129516602
generate_one_block  0.012976884841918945
generate_one_block  0.013188362121582031
generate_one_block  0.012777566909790039
generate_one_block  0.01327824592590332
generate_one_block  0.012893199920654297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04169321060180664
gen group dst list time:  0.020686864852905273
time for parepare:  0.019414424896240234
local_output_nid generation:  0.004630327224731445
local_in_edges_tensor generation:  0.012758493423461914
mini_batch_src_global generation:  0.011331796646118164
r_  generation:  0.1188499927520752
local_output_nid generation:  0.009251117706298828
local_in_edges_tensor generation:  0.01039433479309082
mini_batch_src_global generation:  0.014512300491333008
r_  generation:  0.12204980850219727
local_output_nid generation:  0.00935220718383789
local_in_edges_tensor generation:  0.011604785919189453
mini_batch_src_global generation:  0.012957334518432617
r_  generation:  0.12464451789855957
local_output_nid generation:  0.00936269760131836
local_in_edges_tensor generation:  0.010629415512084961
mini_batch_src_global generation:  0.013831615447998047
r_  generation:  0.12682080268859863
local_output_nid generation:  0.009098529815673828
local_in_edges_tensor generation:  0.008393526077270508
mini_batch_src_global generation:  0.014293670654296875
r_  generation:  0.12348437309265137
local_output_nid generation:  0.009318351745605469
local_in_edges_tensor generation:  0.00893402099609375
mini_batch_src_global generation:  0.015069723129272461
r_  generation:  0.13273191452026367
local_output_nid generation:  0.009198188781738281
local_in_edges_tensor generation:  0.008433818817138672
mini_batch_src_global generation:  0.015565872192382812
r_  generation:  0.13161206245422363
local_output_nid generation:  0.009285449981689453
local_in_edges_tensor generation:  0.010966300964355469
mini_batch_src_global generation:  0.015985965728759766
r_  generation:  0.13268804550170898
local_output_nid generation:  0.009208440780639648
local_in_edges_tensor generation:  0.008881092071533203
mini_batch_src_global generation:  0.015528202056884766
r_  generation:  0.12982177734375
local_output_nid generation:  0.009086847305297852
local_in_edges_tensor generation:  0.009470701217651367
mini_batch_src_global generation:  0.015562057495117188
r_  generation:  0.1314537525177002
local_output_nid generation:  0.009253501892089844
local_in_edges_tensor generation:  0.00829005241394043
mini_batch_src_global generation:  0.015486955642700195
r_  generation:  0.13042926788330078
local_output_nid generation:  0.009176492691040039
local_in_edges_tensor generation:  0.009161949157714844
mini_batch_src_global generation:  0.015249252319335938
r_  generation:  0.13121461868286133
local_output_nid generation:  0.009276390075683594
local_in_edges_tensor generation:  0.012059688568115234
mini_batch_src_global generation:  0.01624584197998047
r_  generation:  0.13410353660583496
local_output_nid generation:  0.009219646453857422
local_in_edges_tensor generation:  0.010697126388549805
mini_batch_src_global generation:  0.01558995246887207
r_  generation:  0.13212323188781738
local_output_nid generation:  0.009472370147705078
local_in_edges_tensor generation:  0.00965738296508789
mini_batch_src_global generation:  0.017235994338989258
r_  generation:  0.13659119606018066
local_output_nid generation:  0.009134292602539062
local_in_edges_tensor generation:  0.008373498916625977
mini_batch_src_global generation:  0.01599860191345215
r_  generation:  0.13320231437683105
local_output_nid generation:  0.009417295455932617
local_in_edges_tensor generation:  0.008901834487915039
mini_batch_src_global generation:  0.01639533042907715
r_  generation:  0.1344747543334961
local_output_nid generation:  0.009324073791503906
local_in_edges_tensor generation:  0.00980234146118164
mini_batch_src_global generation:  0.01616811752319336
r_  generation:  0.13429498672485352
local_output_nid generation:  0.009189367294311523
local_in_edges_tensor generation:  0.009476661682128906
mini_batch_src_global generation:  0.015553474426269531
r_  generation:  0.13205790519714355
local_output_nid generation:  0.009322404861450195
local_in_edges_tensor generation:  0.009548425674438477
mini_batch_src_global generation:  0.015895605087280273
r_  generation:  0.1344456672668457
local_output_nid generation:  0.00945138931274414
local_in_edges_tensor generation:  0.010817527770996094
mini_batch_src_global generation:  0.016271352767944336
r_  generation:  0.13619232177734375
local_output_nid generation:  0.00947260856628418
local_in_edges_tensor generation:  0.009643316268920898
mini_batch_src_global generation:  0.01739954948425293
r_  generation:  0.13598084449768066
local_output_nid generation:  0.009402036666870117
local_in_edges_tensor generation:  0.00957179069519043
mini_batch_src_global generation:  0.015889644622802734
r_  generation:  0.13060259819030762
local_output_nid generation:  0.009359121322631836
local_in_edges_tensor generation:  0.009789228439331055
mini_batch_src_global generation:  0.01694512367248535
r_  generation:  0.14138197898864746
local_output_nid generation:  0.009440183639526367
local_in_edges_tensor generation:  0.008661985397338867
mini_batch_src_global generation:  0.01624441146850586
r_  generation:  0.13645410537719727
local_output_nid generation:  0.00914621353149414
local_in_edges_tensor generation:  0.008326292037963867
mini_batch_src_global generation:  0.01598525047302246
r_  generation:  0.13019800186157227
local_output_nid generation:  0.008926868438720703
local_in_edges_tensor generation:  0.00882267951965332
mini_batch_src_global generation:  0.015215873718261719
r_  generation:  0.1292879581451416
local_output_nid generation:  0.009238481521606445
local_in_edges_tensor generation:  0.01006174087524414
mini_batch_src_global generation:  0.01582050323486328
r_  generation:  0.1330864429473877
local_output_nid generation:  0.009372472763061523
local_in_edges_tensor generation:  0.009353399276733398
mini_batch_src_global generation:  0.01667928695678711
r_  generation:  0.1329820156097412
local_output_nid generation:  0.00901031494140625
local_in_edges_tensor generation:  0.009545564651489258
mini_batch_src_global generation:  0.01577925682067871
r_  generation:  0.13470768928527832
local_output_nid generation:  0.009328365325927734
local_in_edges_tensor generation:  0.009462594985961914
mini_batch_src_global generation:  0.01680779457092285
r_  generation:  0.13233637809753418
local_output_nid generation:  0.009132862091064453
local_in_edges_tensor generation:  0.009414911270141602
mini_batch_src_global generation:  0.01588892936706543
r_  generation:  0.13328766822814941
----------------------check_connections_block total spend ----------------------------- 6.312317609786987
generate_one_block  0.17000961303710938
generate_one_block  0.1665632724761963
generate_one_block  0.18183374404907227
generate_one_block  0.16427230834960938
generate_one_block  0.1578359603881836
generate_one_block  0.1696608066558838
generate_one_block  0.16891169548034668
generate_one_block  0.168731689453125
generate_one_block  0.16408371925354004
generate_one_block  0.15937590599060059
generate_one_block  0.1630403995513916
generate_one_block  0.16169142723083496
generate_one_block  0.1663682460784912
generate_one_block  0.16119813919067383
generate_one_block  0.17388367652893066
generate_one_block  0.18610024452209473
generate_one_block  0.1706252098083496
generate_one_block  0.16808366775512695
generate_one_block  0.16198062896728516
generate_one_block  0.16404008865356445
generate_one_block  0.17578458786010742
generate_one_block  0.17397546768188477
generate_one_block  0.16193509101867676
generate_one_block  0.16515541076660156
generate_one_block  0.17336750030517578
generate_one_block  0.16009974479675293
generate_one_block  0.15807461738586426
generate_one_block  0.16218924522399902
generate_one_block  0.16939687728881836
generate_one_block  0.16481828689575195
generate_one_block  0.16562891006469727
generate_one_block  0.1662886142730713
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036240577697753906
gen group dst list time:  0.09429073333740234
time for parepare:  0.018752336502075195
local_output_nid generation:  0.020064830780029297
local_in_edges_tensor generation:  0.0379791259765625
mini_batch_src_global generation:  0.03546023368835449
r_  generation:  0.37949228286743164
local_output_nid generation:  0.027315378189086914
local_in_edges_tensor generation:  0.042168378829956055
mini_batch_src_global generation:  0.04536890983581543
r_  generation:  0.39099693298339844
local_output_nid generation:  0.02735590934753418
local_in_edges_tensor generation:  0.03127336502075195
mini_batch_src_global generation:  0.0453028678894043
r_  generation:  0.39822816848754883
local_output_nid generation:  0.026218891143798828
local_in_edges_tensor generation:  0.034845829010009766
mini_batch_src_global generation:  0.045801639556884766
r_  generation:  0.3970506191253662
local_output_nid generation:  0.02517843246459961
local_in_edges_tensor generation:  0.028728961944580078
mini_batch_src_global generation:  0.04591488838195801
r_  generation:  0.39536166191101074
local_output_nid generation:  0.025270938873291016
local_in_edges_tensor generation:  0.034290313720703125
mini_batch_src_global generation:  0.049469709396362305
r_  generation:  0.40536928176879883
local_output_nid generation:  0.025768280029296875
local_in_edges_tensor generation:  0.03496503829956055
mini_batch_src_global generation:  0.046221256256103516
r_  generation:  0.4036266803741455
local_output_nid generation:  0.025779247283935547
local_in_edges_tensor generation:  0.028743982315063477
mini_batch_src_global generation:  0.048029422760009766
r_  generation:  0.40523552894592285
local_output_nid generation:  0.02575230598449707
local_in_edges_tensor generation:  0.027361631393432617
mini_batch_src_global generation:  0.046587228775024414
r_  generation:  0.39986348152160645
local_output_nid generation:  0.02552628517150879
local_in_edges_tensor generation:  0.03093433380126953
mini_batch_src_global generation:  0.04709458351135254
r_  generation:  0.3990132808685303
local_output_nid generation:  0.025580167770385742
local_in_edges_tensor generation:  0.0318751335144043
mini_batch_src_global generation:  0.04908180236816406
r_  generation:  0.40007662773132324
local_output_nid generation:  0.025344371795654297
local_in_edges_tensor generation:  0.03179216384887695
mini_batch_src_global generation:  0.04646944999694824
r_  generation:  0.39653682708740234
local_output_nid generation:  0.025493383407592773
local_in_edges_tensor generation:  0.03159737586975098
mini_batch_src_global generation:  0.04648780822753906
r_  generation:  0.4032864570617676
local_output_nid generation:  0.02540755271911621
local_in_edges_tensor generation:  0.030721187591552734
mini_batch_src_global generation:  0.04853558540344238
r_  generation:  0.39873361587524414
local_output_nid generation:  0.0257718563079834
local_in_edges_tensor generation:  0.031354665756225586
mini_batch_src_global generation:  0.04674649238586426
r_  generation:  0.40432262420654297
local_output_nid generation:  0.02556324005126953
local_in_edges_tensor generation:  0.03453850746154785
mini_batch_src_global generation:  0.0474398136138916
r_  generation:  0.4092385768890381
local_output_nid generation:  0.026192665100097656
local_in_edges_tensor generation:  0.03091907501220703
mini_batch_src_global generation:  0.04987645149230957
r_  generation:  0.4083211421966553
local_output_nid generation:  0.026301145553588867
local_in_edges_tensor generation:  0.02809429168701172
mini_batch_src_global generation:  0.048471689224243164
r_  generation:  0.40187644958496094
local_output_nid generation:  0.02573871612548828
local_in_edges_tensor generation:  0.03357839584350586
mini_batch_src_global generation:  0.046623945236206055
r_  generation:  0.39951491355895996
local_output_nid generation:  0.025766372680664062
local_in_edges_tensor generation:  0.03137636184692383
mini_batch_src_global generation:  0.04760432243347168
r_  generation:  0.4127388000488281
local_output_nid generation:  0.02572774887084961
local_in_edges_tensor generation:  0.0386958122253418
mini_batch_src_global generation:  0.04672694206237793
r_  generation:  0.4040389060974121
local_output_nid generation:  0.026728153228759766
local_in_edges_tensor generation:  0.047602176666259766
mini_batch_src_global generation:  0.048453330993652344
r_  generation:  0.40488457679748535
local_output_nid generation:  0.025731801986694336
local_in_edges_tensor generation:  0.027497291564941406
mini_batch_src_global generation:  0.055725812911987305
r_  generation:  0.41873836517333984
local_output_nid generation:  0.028857707977294922
local_in_edges_tensor generation:  0.037043094635009766
mini_batch_src_global generation:  0.047994375228881836
r_  generation:  0.4006686210632324
local_output_nid generation:  0.02652144432067871
local_in_edges_tensor generation:  0.03206157684326172
mini_batch_src_global generation:  0.046636343002319336
r_  generation:  0.40763401985168457
local_output_nid generation:  0.02637028694152832
local_in_edges_tensor generation:  0.024997711181640625
mini_batch_src_global generation:  0.04689478874206543
r_  generation:  0.39980340003967285
local_output_nid generation:  0.026479482650756836
local_in_edges_tensor generation:  0.024283409118652344
mini_batch_src_global generation:  0.04728245735168457
r_  generation:  0.3992154598236084
local_output_nid generation:  0.02639913558959961
local_in_edges_tensor generation:  0.03104996681213379
mini_batch_src_global generation:  0.04671025276184082
r_  generation:  0.4003007411956787
local_output_nid generation:  0.026630401611328125
local_in_edges_tensor generation:  0.03202080726623535
mini_batch_src_global generation:  0.04647517204284668
r_  generation:  0.4048502445220947
local_output_nid generation:  0.02631402015686035
local_in_edges_tensor generation:  0.027467012405395508
mini_batch_src_global generation:  0.0500185489654541
r_  generation:  0.40463805198669434
local_output_nid generation:  0.026489973068237305
local_in_edges_tensor generation:  0.02524876594543457
mini_batch_src_global generation:  0.05708122253417969
r_  generation:  0.4047529697418213
local_output_nid generation:  0.02631688117980957
local_in_edges_tensor generation:  0.028144121170043945
mini_batch_src_global generation:  0.050786733627319336
r_  generation:  0.399550199508667
----------------------check_connections_block total spend ----------------------------- 19.01547598838806
generate_one_block  0.61474609375
generate_one_block  0.5324239730834961
generate_one_block  0.5109074115753174
generate_one_block  0.5389425754547119
generate_one_block  0.5117383003234863
generate_one_block  0.5217478275299072
generate_one_block  0.5256192684173584
generate_one_block  0.5256593227386475
generate_one_block  0.5078146457672119
generate_one_block  0.510718584060669
generate_one_block  0.5194947719573975
generate_one_block  0.5123095512390137
generate_one_block  0.5235810279846191
generate_one_block  0.5071258544921875
generate_one_block  0.5335073471069336
generate_one_block  0.5182640552520752
generate_one_block  0.5258150100708008
generate_one_block  0.5093338489532471
generate_one_block  0.5043976306915283
generate_one_block  0.5159342288970947
generate_one_block  0.5372641086578369
generate_one_block  0.5328750610351562
generate_one_block  0.5253760814666748
generate_one_block  0.5108652114868164
generate_one_block  0.5203967094421387
generate_one_block  0.5050632953643799
generate_one_block  0.5000612735748291
generate_one_block  0.5109467506408691
generate_one_block  0.510765552520752
generate_one_block  0.5212571620941162
generate_one_block  0.5071747303009033
generate_one_block  0.5103268623352051
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  25.32779359817505
block generation total time  22.007458925247192
average batch blocks generation time:  0.6877330914139748
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08184003829956055  GigaBytes
Max Memory Allocated: 0.08184003829956055  GigaBytes

torch.Size([145320, 128])
torch.Size([98912, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.19868183135986328  GigaBytes
Max Memory Allocated: 0.20329666137695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08335399627685547  GigaBytes
Max Memory Allocated: 0.22492027282714844  GigaBytes

torch.Size([145414, 128])
torch.Size([99104, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1992039680480957  GigaBytes
Max Memory Allocated: 0.22492027282714844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08327770233154297  GigaBytes
Max Memory Allocated: 0.22603559494018555  GigaBytes

torch.Size([145835, 128])
torch.Size([99439, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19856977462768555  GigaBytes
Max Memory Allocated: 0.22603559494018555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08336830139160156  GigaBytes
Max Memory Allocated: 0.22603559494018555  GigaBytes

torch.Size([145806, 128])
torch.Size([100112, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1998891830444336  GigaBytes
Max Memory Allocated: 0.22603559494018555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08184528350830078  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

torch.Size([144816, 128])
torch.Size([97665, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19618797302246094  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08236885070800781  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

torch.Size([145284, 128])
torch.Size([99492, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19896984100341797  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0823216438293457  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

torch.Size([145157, 128])
torch.Size([99585, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19849252700805664  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08343982696533203  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

torch.Size([145720, 128])
torch.Size([99953, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19987249374389648  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08325576782226562  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

torch.Size([145836, 128])
torch.Size([99255, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19921159744262695  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08197021484375  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

torch.Size([144994, 128])
torch.Size([97933, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19646263122558594  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08215999603271484  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

torch.Size([145084, 128])
torch.Size([98446, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19785165786743164  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08219385147094727  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

torch.Size([145387, 128])
torch.Size([98236, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19689464569091797  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08333873748779297  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

torch.Size([145874, 128])
torch.Size([99660, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1994614601135254  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08203840255737305  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

torch.Size([145075, 128])
torch.Size([98303, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19681072235107422  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08345413208007812  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

torch.Size([145935, 128])
torch.Size([99841, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.2002391815185547  GigaBytes
Max Memory Allocated: 0.22655677795410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08234119415283203  GigaBytes
Max Memory Allocated: 0.2274303436279297  GigaBytes

torch.Size([145334, 128])
torch.Size([99553, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19848012924194336  GigaBytes
Max Memory Allocated: 0.2274303436279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08243942260742188  GigaBytes
Max Memory Allocated: 0.2274303436279297  GigaBytes

torch.Size([145306, 128])
torch.Size([99913, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19916391372680664  GigaBytes
Max Memory Allocated: 0.2274303436279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0833740234375  GigaBytes
Max Memory Allocated: 0.2274303436279297  GigaBytes

torch.Size([145779, 128])
torch.Size([99628, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19986295700073242  GigaBytes
Max Memory Allocated: 0.2274303436279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08198976516723633  GigaBytes
Max Memory Allocated: 0.2274303436279297  GigaBytes

torch.Size([144841, 128])
torch.Size([98304, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1964430809020996  GigaBytes
Max Memory Allocated: 0.2274303436279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08332157135009766  GigaBytes
Max Memory Allocated: 0.2274303436279297  GigaBytes

torch.Size([145818, 128])
torch.Size([99567, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19956064224243164  GigaBytes
Max Memory Allocated: 0.2274303436279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08343315124511719  GigaBytes
Max Memory Allocated: 0.2274303436279297  GigaBytes

torch.Size([145932, 128])
torch.Size([100226, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20032358169555664  GigaBytes
Max Memory Allocated: 0.2274303436279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08351516723632812  GigaBytes
Max Memory Allocated: 0.2275834083557129  GigaBytes

torch.Size([145835, 128])
torch.Size([100404, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20112943649291992  GigaBytes
Max Memory Allocated: 0.2275834083557129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08227062225341797  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145390, 128])
torch.Size([99140, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19736719131469727  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08336639404296875  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145881, 128])
torch.Size([99636, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19986772537231445  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08347225189208984  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145885, 128])
torch.Size([100065, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20026254653930664  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08205556869506836  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145129, 128])
torch.Size([98422, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19665002822875977  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08201789855957031  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145152, 128])
torch.Size([98374, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1963329315185547  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.083251953125  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145681, 128])
torch.Size([99129, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1982564926147461  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08333396911621094  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145680, 128])
torch.Size([99494, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1997089385986328  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0832834243774414  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145631, 128])
torch.Size([98754, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19878530502319336  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08327865600585938  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145653, 128])
torch.Size([99236, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19941377639770508  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08222770690917969  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145320, 128])
torch.Size([98552, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1968693733215332  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027983300387859344 |0.023700051009655 |0.026932500302791595 |9.548664093017578e-05 |0.005080901086330414 |0.002016782760620117 |
----------------------------------------------------------pseudo_mini_loss sum 5.337246894836426
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8582689
Number of first layer input nodes during this epoch:  4655784
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.11010169982910156  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022158384323120117
random selection method range initialization spend 0.005597114562988281
time for parepare:  0.017833232879638672
local_output_nid generation:  0.0012500286102294922
local_in_edges_tensor generation:  0.00597691535949707
mini_batch_src_global generation:  0.0015316009521484375
r_  generation:  0.008689641952514648
local_output_nid generation:  0.001394033432006836
local_in_edges_tensor generation:  0.000982522964477539
mini_batch_src_global generation:  0.0013835430145263672
r_  generation:  0.008470296859741211
local_output_nid generation:  0.0014286041259765625
local_in_edges_tensor generation:  0.0008456707000732422
mini_batch_src_global generation:  0.0009310245513916016
r_  generation:  0.0074079036712646484
local_output_nid generation:  0.0014295578002929688
local_in_edges_tensor generation:  0.0008232593536376953
mini_batch_src_global generation:  0.0008602142333984375
r_  generation:  0.007649421691894531
local_output_nid generation:  0.0013833045959472656
local_in_edges_tensor generation:  0.0007917881011962891
mini_batch_src_global generation:  0.0007994174957275391
r_  generation:  0.007971763610839844
local_output_nid generation:  0.0014369487762451172
local_in_edges_tensor generation:  0.0008046627044677734
mini_batch_src_global generation:  0.0011281967163085938
r_  generation:  0.008105039596557617
local_output_nid generation:  0.0013759136199951172
local_in_edges_tensor generation:  0.0007967948913574219
mini_batch_src_global generation:  0.0008423328399658203
r_  generation:  0.010459661483764648
local_output_nid generation:  0.0014863014221191406
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0008451938629150391
r_  generation:  0.007984161376953125
local_output_nid generation:  0.0014553070068359375
local_in_edges_tensor generation:  0.0007777214050292969
mini_batch_src_global generation:  0.0008435249328613281
r_  generation:  0.007791996002197266
local_output_nid generation:  0.0014171600341796875
local_in_edges_tensor generation:  0.000732421875
mini_batch_src_global generation:  0.0008220672607421875
r_  generation:  0.008059978485107422
local_output_nid generation:  0.0014011859893798828
local_in_edges_tensor generation:  0.0007433891296386719
mini_batch_src_global generation:  0.0008499622344970703
r_  generation:  0.008303642272949219
local_output_nid generation:  0.0013759136199951172
local_in_edges_tensor generation:  0.0007333755493164062
mini_batch_src_global generation:  0.0010211467742919922
r_  generation:  0.008426189422607422
local_output_nid generation:  0.0013780593872070312
local_in_edges_tensor generation:  0.0007410049438476562
mini_batch_src_global generation:  0.0008471012115478516
r_  generation:  0.008035898208618164
local_output_nid generation:  0.0013995170593261719
local_in_edges_tensor generation:  0.0007376670837402344
mini_batch_src_global generation:  0.0008702278137207031
r_  generation:  0.008359670639038086
local_output_nid generation:  0.001394033432006836
local_in_edges_tensor generation:  0.0007398128509521484
mini_batch_src_global generation:  0.0008482933044433594
r_  generation:  0.008013010025024414
local_output_nid generation:  0.001386880874633789
local_in_edges_tensor generation:  0.0007162094116210938
mini_batch_src_global generation:  0.0008351802825927734
r_  generation:  0.007977724075317383
local_output_nid generation:  0.0014164447784423828
local_in_edges_tensor generation:  0.0007462501525878906
mini_batch_src_global generation:  0.0009853839874267578
r_  generation:  0.008414983749389648
local_output_nid generation:  0.0013759136199951172
local_in_edges_tensor generation:  0.0007557868957519531
mini_batch_src_global generation:  0.0008757114410400391
r_  generation:  0.00806570053100586
local_output_nid generation:  0.0013837814331054688
local_in_edges_tensor generation:  0.0007300376892089844
mini_batch_src_global generation:  0.0009646415710449219
r_  generation:  0.008411407470703125
local_output_nid generation:  0.0013718605041503906
local_in_edges_tensor generation:  0.0007123947143554688
mini_batch_src_global generation:  0.0008530616760253906
r_  generation:  0.008090734481811523
local_output_nid generation:  0.0014019012451171875
local_in_edges_tensor generation:  0.0007276535034179688
mini_batch_src_global generation:  0.0008459091186523438
r_  generation:  0.007990121841430664
local_output_nid generation:  0.0013654232025146484
local_in_edges_tensor generation:  0.0007176399230957031
mini_batch_src_global generation:  0.0008709430694580078
r_  generation:  0.010895967483520508
local_output_nid generation:  0.0013957023620605469
local_in_edges_tensor generation:  0.0007462501525878906
mini_batch_src_global generation:  0.0009093284606933594
r_  generation:  0.008247613906860352
local_output_nid generation:  0.0013935565948486328
local_in_edges_tensor generation:  0.0007112026214599609
mini_batch_src_global generation:  0.0008492469787597656
r_  generation:  0.008290767669677734
local_output_nid generation:  0.00138092041015625
local_in_edges_tensor generation:  0.0007257461547851562
mini_batch_src_global generation:  0.0008652210235595703
r_  generation:  0.00830221176147461
local_output_nid generation:  0.0013775825500488281
local_in_edges_tensor generation:  0.0007262229919433594
mini_batch_src_global generation:  0.0008285045623779297
r_  generation:  0.007689237594604492
local_output_nid generation:  0.001378774642944336
local_in_edges_tensor generation:  0.0006961822509765625
mini_batch_src_global generation:  0.0008370876312255859
r_  generation:  0.008056879043579102
local_output_nid generation:  0.001363992691040039
local_in_edges_tensor generation:  0.0007131099700927734
mini_batch_src_global generation:  0.0008144378662109375
r_  generation:  0.007970094680786133
local_output_nid generation:  0.0013723373413085938
local_in_edges_tensor generation:  0.0006966590881347656
mini_batch_src_global generation:  0.0008683204650878906
r_  generation:  0.008187532424926758
local_output_nid generation:  0.0014047622680664062
local_in_edges_tensor generation:  0.0007116794586181641
mini_batch_src_global generation:  0.0008580684661865234
r_  generation:  0.008212089538574219
local_output_nid generation:  0.0013821125030517578
local_in_edges_tensor generation:  0.0007102489471435547
mini_batch_src_global generation:  0.0008668899536132812
r_  generation:  0.009276390075683594
local_output_nid generation:  0.0014014244079589844
local_in_edges_tensor generation:  0.0007109642028808594
mini_batch_src_global generation:  0.0008649826049804688
r_  generation:  0.008112430572509766
----------------------check_connections_block total spend ----------------------------- 0.4668002128601074
generate_one_block  0.021493911743164062
generate_one_block  0.015936851501464844
generate_one_block  0.012674570083618164
generate_one_block  0.015100240707397461
generate_one_block  0.012892007827758789
generate_one_block  0.013172388076782227
generate_one_block  0.012753486633300781
generate_one_block  0.012835979461669922
generate_one_block  0.012546777725219727
generate_one_block  0.01284933090209961
generate_one_block  0.013220548629760742
generate_one_block  0.013681650161743164
generate_one_block  0.012791872024536133
generate_one_block  0.01331949234008789
generate_one_block  0.01259303092956543
generate_one_block  0.012581110000610352
generate_one_block  0.013489007949829102
generate_one_block  0.012918949127197266
generate_one_block  0.01329493522644043
generate_one_block  0.015342473983764648
generate_one_block  0.012680530548095703
generate_one_block  0.013383626937866211
generate_one_block  0.01323246955871582
generate_one_block  0.013042211532592773
generate_one_block  0.013086080551147461
generate_one_block  0.01251673698425293
generate_one_block  0.012941837310791016
generate_one_block  0.012610673904418945
generate_one_block  0.013005495071411133
generate_one_block  0.013087034225463867
generate_one_block  0.013582944869995117
generate_one_block  0.012842416763305664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0347440242767334
gen group dst list time:  0.019250869750976562
time for parepare:  0.01972365379333496
local_output_nid generation:  0.004666566848754883
local_in_edges_tensor generation:  0.014950037002563477
mini_batch_src_global generation:  0.01172780990600586
r_  generation:  0.1185455322265625
local_output_nid generation:  0.009727239608764648
local_in_edges_tensor generation:  0.01017618179321289
mini_batch_src_global generation:  0.01708531379699707
r_  generation:  0.1266920566558838
local_output_nid generation:  0.009680986404418945
local_in_edges_tensor generation:  0.028880834579467773
mini_batch_src_global generation:  0.012634754180908203
r_  generation:  0.12183761596679688
local_output_nid generation:  0.012295007705688477
local_in_edges_tensor generation:  0.008159160614013672
mini_batch_src_global generation:  0.013276100158691406
r_  generation:  0.12416791915893555
local_output_nid generation:  0.009863138198852539
local_in_edges_tensor generation:  0.008311033248901367
mini_batch_src_global generation:  0.016860008239746094
r_  generation:  0.1295483112335205
local_output_nid generation:  0.00988459587097168
local_in_edges_tensor generation:  0.01041269302368164
mini_batch_src_global generation:  0.015248775482177734
r_  generation:  0.13257741928100586
local_output_nid generation:  0.009613752365112305
local_in_edges_tensor generation:  0.008413076400756836
mini_batch_src_global generation:  0.018224000930786133
r_  generation:  0.12835144996643066
local_output_nid generation:  0.009507179260253906
local_in_edges_tensor generation:  0.010390281677246094
mini_batch_src_global generation:  0.015498876571655273
r_  generation:  0.1297924518585205
local_output_nid generation:  0.009663581848144531
local_in_edges_tensor generation:  0.008044004440307617
mini_batch_src_global generation:  0.017702817916870117
r_  generation:  0.13116002082824707
local_output_nid generation:  0.009758234024047852
local_in_edges_tensor generation:  0.01046442985534668
mini_batch_src_global generation:  0.015503406524658203
r_  generation:  0.13081884384155273
local_output_nid generation:  0.01045680046081543
local_in_edges_tensor generation:  0.009702682495117188
mini_batch_src_global generation:  0.01863574981689453
r_  generation:  0.13879013061523438
local_output_nid generation:  0.010515451431274414
local_in_edges_tensor generation:  0.010831832885742188
mini_batch_src_global generation:  0.019377946853637695
r_  generation:  0.1376633644104004
local_output_nid generation:  0.010027885437011719
local_in_edges_tensor generation:  0.008452892303466797
mini_batch_src_global generation:  0.01574254035949707
r_  generation:  0.13125848770141602
local_output_nid generation:  0.010281085968017578
local_in_edges_tensor generation:  0.008363962173461914
mini_batch_src_global generation:  0.017290115356445312
r_  generation:  0.13576984405517578
local_output_nid generation:  0.009885787963867188
local_in_edges_tensor generation:  0.008287429809570312
mini_batch_src_global generation:  0.020500898361206055
r_  generation:  0.1320040225982666
local_output_nid generation:  0.009903430938720703
local_in_edges_tensor generation:  0.01464223861694336
mini_batch_src_global generation:  0.015995502471923828
r_  generation:  0.137725830078125
local_output_nid generation:  0.008796453475952148
local_in_edges_tensor generation:  0.011823892593383789
mini_batch_src_global generation:  0.01733112335205078
r_  generation:  0.1385805606842041
local_output_nid generation:  0.007615089416503906
local_in_edges_tensor generation:  0.008916616439819336
mini_batch_src_global generation:  0.01603555679321289
r_  generation:  0.13681888580322266
local_output_nid generation:  0.007988929748535156
local_in_edges_tensor generation:  0.01256704330444336
mini_batch_src_global generation:  0.01735687255859375
r_  generation:  0.13769865036010742
local_output_nid generation:  0.007769584655761719
local_in_edges_tensor generation:  0.007573843002319336
mini_batch_src_global generation:  0.015937328338623047
r_  generation:  0.13358449935913086
local_output_nid generation:  0.007725715637207031
local_in_edges_tensor generation:  0.00918436050415039
mini_batch_src_global generation:  0.018347501754760742
r_  generation:  0.13528180122375488
local_output_nid generation:  0.007742166519165039
local_in_edges_tensor generation:  0.007947444915771484
mini_batch_src_global generation:  0.01665782928466797
r_  generation:  0.1378316879272461
local_output_nid generation:  0.0074748992919921875
local_in_edges_tensor generation:  0.010619401931762695
mini_batch_src_global generation:  0.030251264572143555
r_  generation:  0.13833928108215332
local_output_nid generation:  0.00746607780456543
local_in_edges_tensor generation:  0.008516311645507812
mini_batch_src_global generation:  0.016602277755737305
r_  generation:  0.13749051094055176
local_output_nid generation:  0.007498979568481445
local_in_edges_tensor generation:  0.01115870475769043
mini_batch_src_global generation:  0.016115427017211914
r_  generation:  0.13602471351623535
local_output_nid generation:  0.0072634220123291016
local_in_edges_tensor generation:  0.007839202880859375
mini_batch_src_global generation:  0.015526771545410156
r_  generation:  0.13278698921203613
local_output_nid generation:  0.007453441619873047
local_in_edges_tensor generation:  0.00767207145690918
mini_batch_src_global generation:  0.01759028434753418
r_  generation:  0.13696050643920898
local_output_nid generation:  0.007231235504150391
local_in_edges_tensor generation:  0.007579803466796875
mini_batch_src_global generation:  0.01924443244934082
r_  generation:  0.13329029083251953
local_output_nid generation:  0.008327007293701172
local_in_edges_tensor generation:  0.02007436752319336
mini_batch_src_global generation:  0.017627954483032227
r_  generation:  0.13837528228759766
local_output_nid generation:  0.007367372512817383
local_in_edges_tensor generation:  0.009706258773803711
mini_batch_src_global generation:  0.01620340347290039
r_  generation:  0.14942479133605957
local_output_nid generation:  0.009714126586914062
local_in_edges_tensor generation:  0.010936260223388672
mini_batch_src_global generation:  0.018131017684936523
r_  generation:  0.14550566673278809
local_output_nid generation:  0.007412433624267578
local_in_edges_tensor generation:  0.008455753326416016
mini_batch_src_global generation:  0.01883077621459961
r_  generation:  0.13944005966186523
----------------------check_connections_block total spend ----------------------------- 6.499399662017822
generate_one_block  0.1741180419921875
generate_one_block  0.16651558876037598
generate_one_block  0.15541768074035645
generate_one_block  0.15996026992797852
generate_one_block  0.18424582481384277
generate_one_block  0.16539525985717773
generate_one_block  0.15732693672180176
generate_one_block  0.1615297794342041
generate_one_block  0.15814828872680664
generate_one_block  0.16413521766662598
generate_one_block  0.1730360984802246
generate_one_block  0.172027587890625
generate_one_block  0.16275334358215332
generate_one_block  0.1676626205444336
generate_one_block  0.15960216522216797
generate_one_block  0.1639406681060791
generate_one_block  0.1757972240447998
generate_one_block  0.1653439998626709
generate_one_block  0.17186307907104492
generate_one_block  0.1911299228668213
generate_one_block  0.1653740406036377
generate_one_block  0.18020319938659668
generate_one_block  0.17307186126708984
generate_one_block  0.1727612018585205
generate_one_block  0.165114164352417
generate_one_block  0.16227149963378906
generate_one_block  0.16539645195007324
generate_one_block  0.16024994850158691
generate_one_block  0.16883039474487305
generate_one_block  0.16872739791870117
generate_one_block  0.18129897117614746
generate_one_block  0.16459298133850098
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0505070686340332
gen group dst list time:  0.10764813423156738
time for parepare:  0.020691871643066406
local_output_nid generation:  0.021658897399902344
local_in_edges_tensor generation:  0.05537605285644531
mini_batch_src_global generation:  0.03896975517272949
r_  generation:  0.3939685821533203
local_output_nid generation:  0.02733612060546875
local_in_edges_tensor generation:  0.040778160095214844
mini_batch_src_global generation:  0.04564309120178223
r_  generation:  0.3942079544067383
local_output_nid generation:  0.02681279182434082
local_in_edges_tensor generation:  0.033162593841552734
mini_batch_src_global generation:  0.044614553451538086
r_  generation:  0.3896167278289795
local_output_nid generation:  0.025754451751708984
local_in_edges_tensor generation:  0.030349254608154297
mini_batch_src_global generation:  0.04494810104370117
r_  generation:  0.39208030700683594
local_output_nid generation:  0.025703907012939453
local_in_edges_tensor generation:  0.030368328094482422
mini_batch_src_global generation:  0.04569649696350098
r_  generation:  0.39811015129089355
local_output_nid generation:  0.0258176326751709
local_in_edges_tensor generation:  0.0380403995513916
mini_batch_src_global generation:  0.0691227912902832
r_  generation:  0.404207706451416
local_output_nid generation:  0.025638103485107422
local_in_edges_tensor generation:  0.026413440704345703
mini_batch_src_global generation:  0.045487165451049805
r_  generation:  0.3974337577819824
local_output_nid generation:  0.02570819854736328
local_in_edges_tensor generation:  0.030855655670166016
mini_batch_src_global generation:  0.04871392250061035
r_  generation:  0.39906883239746094
local_output_nid generation:  0.025794029235839844
local_in_edges_tensor generation:  0.029827356338500977
mini_batch_src_global generation:  0.04602670669555664
r_  generation:  0.3978080749511719
local_output_nid generation:  0.02592611312866211
local_in_edges_tensor generation:  0.03336954116821289
mini_batch_src_global generation:  0.050684452056884766
r_  generation:  0.40719151496887207
local_output_nid generation:  0.0263669490814209
local_in_edges_tensor generation:  0.03429865837097168
mini_batch_src_global generation:  0.04634690284729004
r_  generation:  0.40944981575012207
local_output_nid generation:  0.02589559555053711
local_in_edges_tensor generation:  0.030397415161132812
mini_batch_src_global generation:  0.05152010917663574
r_  generation:  0.409060001373291
local_output_nid generation:  0.026105880737304688
local_in_edges_tensor generation:  0.0317842960357666
mini_batch_src_global generation:  0.052257537841796875
r_  generation:  0.41965460777282715
local_output_nid generation:  0.030007123947143555
local_in_edges_tensor generation:  0.034592628479003906
mini_batch_src_global generation:  0.05638265609741211
r_  generation:  0.3999292850494385
local_output_nid generation:  0.02660846710205078
local_in_edges_tensor generation:  0.029580116271972656
mini_batch_src_global generation:  0.04687762260437012
r_  generation:  0.3986012935638428
local_output_nid generation:  0.026942014694213867
local_in_edges_tensor generation:  0.030711889266967773
mini_batch_src_global generation:  0.04768538475036621
r_  generation:  0.40138912200927734
local_output_nid generation:  0.027298688888549805
local_in_edges_tensor generation:  0.03800654411315918
mini_batch_src_global generation:  0.04704618453979492
r_  generation:  0.40685272216796875
local_output_nid generation:  0.02680492401123047
local_in_edges_tensor generation:  0.030248165130615234
mini_batch_src_global generation:  0.04721999168395996
r_  generation:  0.4000866413116455
local_output_nid generation:  0.027106046676635742
local_in_edges_tensor generation:  0.03039717674255371
mini_batch_src_global generation:  0.04954886436462402
r_  generation:  0.4040520191192627
local_output_nid generation:  0.026543855667114258
local_in_edges_tensor generation:  0.02658534049987793
mini_batch_src_global generation:  0.04693436622619629
r_  generation:  0.39455652236938477
local_output_nid generation:  0.02695012092590332
local_in_edges_tensor generation:  0.026075124740600586
mini_batch_src_global generation:  0.04990196228027344
r_  generation:  0.3975222110748291
local_output_nid generation:  0.026971817016601562
local_in_edges_tensor generation:  0.03401350975036621
mini_batch_src_global generation:  0.04736948013305664
r_  generation:  0.3997318744659424
local_output_nid generation:  0.027021169662475586
local_in_edges_tensor generation:  0.034041643142700195
mini_batch_src_global generation:  0.04663372039794922
r_  generation:  0.4052443504333496
local_output_nid generation:  0.026947736740112305
local_in_edges_tensor generation:  0.026534318923950195
mini_batch_src_global generation:  0.06420111656188965
r_  generation:  0.41186046600341797
local_output_nid generation:  0.02741861343383789
local_in_edges_tensor generation:  0.03030991554260254
mini_batch_src_global generation:  0.04726886749267578
r_  generation:  0.4098334312438965
local_output_nid generation:  0.02711033821105957
local_in_edges_tensor generation:  0.029783964157104492
mini_batch_src_global generation:  0.048169851303100586
r_  generation:  0.3996448516845703
local_output_nid generation:  0.026836156845092773
local_in_edges_tensor generation:  0.030106067657470703
mini_batch_src_global generation:  0.046354055404663086
r_  generation:  0.429018497467041
local_output_nid generation:  0.02747368812561035
local_in_edges_tensor generation:  0.037458181381225586
mini_batch_src_global generation:  0.04731106758117676
r_  generation:  0.4004840850830078
local_output_nid generation:  0.027040481567382812
local_in_edges_tensor generation:  0.029672861099243164
mini_batch_src_global generation:  0.04964852333068848
r_  generation:  0.41359758377075195
local_output_nid generation:  0.026546239852905273
local_in_edges_tensor generation:  0.03256535530090332
mini_batch_src_global generation:  0.04713845252990723
r_  generation:  0.4015822410583496
local_output_nid generation:  0.027365922927856445
local_in_edges_tensor generation:  0.032968759536743164
mini_batch_src_global generation:  0.047144174575805664
r_  generation:  0.4091174602508545
local_output_nid generation:  0.02731609344482422
local_in_edges_tensor generation:  0.02538919448852539
mini_batch_src_global generation:  0.049163818359375
r_  generation:  0.40668797492980957
----------------------check_connections_block total spend ----------------------------- 19.130908966064453
generate_one_block  0.5196866989135742
generate_one_block  0.523881196975708
generate_one_block  0.5218043327331543
generate_one_block  0.5081193447113037
generate_one_block  0.6120264530181885
generate_one_block  0.5169000625610352
generate_one_block  0.5035204887390137
generate_one_block  0.5099453926086426
generate_one_block  0.5133762359619141
generate_one_block  0.5150191783905029
generate_one_block  0.530360221862793
generate_one_block  0.5229437351226807
generate_one_block  0.505882740020752
generate_one_block  0.5353701114654541
generate_one_block  0.5043437480926514
generate_one_block  0.5138256549835205
generate_one_block  0.5326147079467773
generate_one_block  0.5175931453704834
generate_one_block  0.5223922729492188
generate_one_block  0.5001232624053955
generate_one_block  0.5182516574859619
generate_one_block  0.5328154563903809
generate_one_block  0.5106050968170166
generate_one_block  0.5151486396789551
generate_one_block  0.5294857025146484
generate_one_block  0.5148138999938965
generate_one_block  0.5169353485107422
generate_one_block  0.5072448253631592
generate_one_block  0.5281021595001221
generate_one_block  0.5141689777374268
generate_one_block  0.5292603969573975
generate_one_block  0.5068397521972656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.11010169982910156  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

connection checking time:  25.630308628082275
block generation total time  22.031242609024048
average batch blocks generation time:  0.6884763315320015
block dataloader generation time/epoch 49.977174043655396
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08363103866577148  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145466, 128])
torch.Size([99327, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.2001199722290039  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08355236053466797  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145474, 128])
torch.Size([99233, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1996316909790039  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08222198486328125  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145272, 128])
torch.Size([98175, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19653749465942383  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0822763442993164  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145386, 128])
torch.Size([98304, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19693565368652344  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08224630355834961  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([144923, 128])
torch.Size([98455, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19680213928222656  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0822453498840332  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([144717, 128])
torch.Size([98780, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19839000701904297  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08213329315185547  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([144914, 128])
torch.Size([97796, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19670534133911133  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08344745635986328  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145472, 128])
torch.Size([98950, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19809532165527344  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08334732055664062  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145521, 128])
torch.Size([98578, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1979656219482422  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08343982696533203  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145553, 128])
torch.Size([99265, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1984577178955078  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08369922637939453  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

torch.Size([145977, 128])
torch.Size([100488, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20118427276611328  GigaBytes
Max Memory Allocated: 0.22821378707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08371543884277344  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145415, 128])
torch.Size([99638, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20064306259155273  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08232307434082031  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145070, 128])
torch.Size([98476, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1970200538635254  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08364009857177734  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145879, 128])
torch.Size([100005, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.2005457878112793  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08233308792114258  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145247, 128])
torch.Size([98409, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19682645797729492  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0834817886352539  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145483, 128])
torch.Size([98948, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1990056037902832  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08373737335205078  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([146027, 128])
torch.Size([100489, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20224857330322266  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08354568481445312  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145464, 128])
torch.Size([99219, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19965219497680664  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08371829986572266  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([146114, 128])
torch.Size([99814, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20052099227905273  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0822138786315918  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([144959, 128])
torch.Size([98014, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19690179824829102  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08235836029052734  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145032, 128])
torch.Size([98769, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19782304763793945  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08372974395751953  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145579, 128])
torch.Size([99862, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.2005915641784668  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08366012573242188  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145773, 128])
torch.Size([99664, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20043420791625977  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0836324691772461  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145493, 128])
torch.Size([99986, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20033645629882812  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08360004425048828  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145937, 128])
torch.Size([100053, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20026206970214844  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08235788345336914  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145273, 128])
torch.Size([98277, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19643926620483398  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08247137069702148  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145313, 128])
torch.Size([98730, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19743013381958008  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08189821243286133  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([144627, 128])
torch.Size([97344, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19609355926513672  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0836038589477539  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145867, 128])
torch.Size([99630, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1999344825744629  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08210420608520508  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([144368, 128])
torch.Size([97614, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19711875915527344  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08376312255859375  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145757, 128])
torch.Size([99965, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.2008209228515625  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08351325988769531  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

torch.Size([145534, 128])
torch.Size([99398, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1995692253112793  GigaBytes
Max Memory Allocated: 0.22870922088623047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027918055653572083 |0.013174071907997131 |0.003912158310413361 |0.00010079145431518555 |0.004492752254009247 |0.0016322135925292969 |
----------------------------------------------------------pseudo_mini_loss sum 4.094156742095947
Total (block generation + training)time/epoch 51.611788749694824
Training time/epoch 1.6342957019805908
Training time without block to device /epoch 1.2127254009246826
Training time without total dataloading part /epoch 0.27381467819213867
load block tensor time/epoch 0.8933777809143066
block to device time/epoch 0.4215703010559082
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8574175
Number of first layer input nodes during this epoch:  4652886
