Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648355179.9796815
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024719953536987305
random selection method range initialization spend 0.006114959716796875
time for parepare:  0.02010512351989746
local_output_nid generation:  0.004377841949462891
local_in_edges_tensor generation:  0.00533294677734375
mini_batch_src_global generation:  0.0033969879150390625
r_  generation:  0.03896808624267578
local_output_nid generation:  0.0071697235107421875
local_in_edges_tensor generation:  0.0031359195709228516
mini_batch_src_global generation:  0.004225730895996094
r_  generation:  0.03997969627380371
local_output_nid generation:  0.007381439208984375
local_in_edges_tensor generation:  0.003505229949951172
mini_batch_src_global generation:  0.0029358863830566406
r_  generation:  0.04137134552001953
local_output_nid generation:  0.007600069046020508
local_in_edges_tensor generation:  0.003461599349975586
mini_batch_src_global generation:  0.003010272979736328
r_  generation:  0.041051387786865234
local_output_nid generation:  0.0077381134033203125
local_in_edges_tensor generation:  0.0033562183380126953
mini_batch_src_global generation:  0.003113985061645508
r_  generation:  0.041795969009399414
local_output_nid generation:  0.007606029510498047
local_in_edges_tensor generation:  0.0033240318298339844
mini_batch_src_global generation:  0.0035097599029541016
r_  generation:  0.04364609718322754
local_output_nid generation:  0.0075588226318359375
local_in_edges_tensor generation:  0.0034186840057373047
mini_batch_src_global generation:  0.003329038619995117
r_  generation:  0.04352903366088867
local_output_nid generation:  0.0076482295989990234
local_in_edges_tensor generation:  0.0034723281860351562
mini_batch_src_global generation:  0.003409147262573242
r_  generation:  0.04262685775756836
----------------------check_connections_block total spend ----------------------------- 0.5454020500183105
generate_one_block  0.055785417556762695
generate_one_block  0.05642557144165039
generate_one_block  0.05624532699584961
generate_one_block  0.057953596115112305
generate_one_block  0.060694217681884766
generate_one_block  0.05849289894104004
generate_one_block  0.05730414390563965
generate_one_block  0.05688214302062988
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035199880599975586
gen group dst list time:  0.015564441680908203
time for parepare:  0.01980733871459961
local_output_nid generation:  0.014425516128540039
local_in_edges_tensor generation:  0.02950119972229004
mini_batch_src_global generation:  0.029688119888305664
r_  generation:  0.29348254203796387
local_output_nid generation:  0.02155923843383789
local_in_edges_tensor generation:  0.028689146041870117
mini_batch_src_global generation:  0.0349123477935791
r_  generation:  0.3123178482055664
local_output_nid generation:  0.0212094783782959
local_in_edges_tensor generation:  0.02230095863342285
mini_batch_src_global generation:  0.037429094314575195
r_  generation:  0.31442809104919434
local_output_nid generation:  0.02147984504699707
local_in_edges_tensor generation:  0.024768590927124023
mini_batch_src_global generation:  0.038562774658203125
r_  generation:  0.32940173149108887
local_output_nid generation:  0.02060675621032715
local_in_edges_tensor generation:  0.03300595283508301
mini_batch_src_global generation:  0.049691200256347656
r_  generation:  0.331911563873291
local_output_nid generation:  0.020355224609375
local_in_edges_tensor generation:  0.023150205612182617
mini_batch_src_global generation:  0.04129910469055176
r_  generation:  0.32495927810668945
local_output_nid generation:  0.01951456069946289
local_in_edges_tensor generation:  0.021025896072387695
mini_batch_src_global generation:  0.03984260559082031
r_  generation:  0.3172464370727539
local_output_nid generation:  0.0191805362701416
local_in_edges_tensor generation:  0.02003312110900879
mini_batch_src_global generation:  0.04003787040710449
r_  generation:  0.31093525886535645
----------------------check_connections_block total spend ----------------------------- 3.7708992958068848
generate_one_block  0.3992469310760498
generate_one_block  0.4085419178009033
generate_one_block  0.3873481750488281
generate_one_block  0.41414952278137207
generate_one_block  0.3979148864746094
generate_one_block  0.42318105697631836
generate_one_block  0.41451168060302734
generate_one_block  0.41489315032958984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04941964149475098
gen group dst list time:  0.04249453544616699
time for parepare:  0.0193784236907959
local_output_nid generation:  0.030767202377319336
local_in_edges_tensor generation:  0.06646275520324707
mini_batch_src_global generation:  0.04485678672790527
r_  generation:  0.47498440742492676
local_output_nid generation:  0.034661293029785156
local_in_edges_tensor generation:  0.05048775672912598
mini_batch_src_global generation:  0.05423307418823242
r_  generation:  0.4801523685455322
local_output_nid generation:  0.03505563735961914
local_in_edges_tensor generation:  0.038233041763305664
mini_batch_src_global generation:  0.05079817771911621
r_  generation:  0.49190855026245117
local_output_nid generation:  0.03499579429626465
local_in_edges_tensor generation:  0.037897348403930664
mini_batch_src_global generation:  0.05720829963684082
r_  generation:  0.4841456413269043
local_output_nid generation:  0.03513312339782715
local_in_edges_tensor generation:  0.038843393325805664
mini_batch_src_global generation:  0.053128957748413086
r_  generation:  0.5025594234466553
local_output_nid generation:  0.03703022003173828
local_in_edges_tensor generation:  0.03864336013793945
mini_batch_src_global generation:  0.055448055267333984
r_  generation:  0.49039506912231445
local_output_nid generation:  0.034978628158569336
local_in_edges_tensor generation:  0.03788423538208008
mini_batch_src_global generation:  0.05367398262023926
r_  generation:  0.5034012794494629
local_output_nid generation:  0.03504467010498047
local_in_edges_tensor generation:  0.037876129150390625
mini_batch_src_global generation:  0.0551455020904541
r_  generation:  0.4877591133117676
----------------------check_connections_block total spend ----------------------------- 5.837295293807983
generate_one_block  0.6373291015625
generate_one_block  0.6192400455474854
generate_one_block  0.6155047416687012
generate_one_block  0.6318588256835938
generate_one_block  0.6163475513458252
generate_one_block  0.5963714122772217
generate_one_block  0.635591983795166
generate_one_block  0.6136465072631836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  9.608194589614868
block generation total time  8.225677490234375
average batch blocks generation time:  1.0282096862792969
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09574556350708008  GigaBytes
Max Memory Allocated: 0.09574556350708008  GigaBytes

torch.Size([160511, 128])
torch.Size([141235, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2998652458190918  GigaBytes
Max Memory Allocated: 0.31172609329223633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09903383255004883  GigaBytes
Max Memory Allocated: 0.331728458404541  GigaBytes

torch.Size([160419, 128])
torch.Size([141223, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.2987065315246582  GigaBytes
Max Memory Allocated: 0.331728458404541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09808683395385742  GigaBytes
Max Memory Allocated: 0.331728458404541  GigaBytes

torch.Size([160706, 128])
torch.Size([141097, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.2996058464050293  GigaBytes
Max Memory Allocated: 0.331728458404541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.0982670783996582  GigaBytes
Max Memory Allocated: 0.331728458404541  GigaBytes

torch.Size([160628, 128])
torch.Size([141464, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.29922056198120117  GigaBytes
Max Memory Allocated: 0.331728458404541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09819412231445312  GigaBytes
Max Memory Allocated: 0.331728458404541  GigaBytes

torch.Size([160649, 128])
torch.Size([141302, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.3003573417663574  GigaBytes
Max Memory Allocated: 0.331728458404541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09766101837158203  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

torch.Size([160641, 128])
torch.Size([141596, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.2999725341796875  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09824562072753906  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

torch.Size([160519, 128])
torch.Size([141173, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.2990913391113281  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09815168380737305  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

torch.Size([160648, 128])
torch.Size([141028, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.298128604888916  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04246634244918823 |0.054935723543167114 |0.09831884503364563 |0.00011184811592102051 |0.009813159704208374 |0.0022821426391601562 |
----------------------------------------------------------pseudo_mini_loss sum 5.294787406921387
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2958155
Number of first layer input nodes during this epoch:  1284721
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.13927745819091797  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023797273635864258
random selection method range initialization spend 0.006734371185302734
time for parepare:  0.018953800201416016
local_output_nid generation:  0.004258871078491211
local_in_edges_tensor generation:  0.00832509994506836
mini_batch_src_global generation:  0.003934383392333984
r_  generation:  0.038185834884643555
local_output_nid generation:  0.0058672428131103516
local_in_edges_tensor generation:  0.0031974315643310547
mini_batch_src_global generation:  0.004792928695678711
r_  generation:  0.040160417556762695
local_output_nid generation:  0.005959987640380859
local_in_edges_tensor generation:  0.003138303756713867
mini_batch_src_global generation:  0.003255605697631836
r_  generation:  0.039478302001953125
local_output_nid generation:  0.006013154983520508
local_in_edges_tensor generation:  0.0032112598419189453
mini_batch_src_global generation:  0.003065347671508789
r_  generation:  0.040352821350097656
local_output_nid generation:  0.006071567535400391
local_in_edges_tensor generation:  0.0031995773315429688
mini_batch_src_global generation:  0.0031135082244873047
r_  generation:  0.042140960693359375
local_output_nid generation:  0.006056070327758789
local_in_edges_tensor generation:  0.0032389163970947266
mini_batch_src_global generation:  0.0033981800079345703
r_  generation:  0.04149580001831055
local_output_nid generation:  0.005975246429443359
local_in_edges_tensor generation:  0.003326892852783203
mini_batch_src_global generation:  0.003360748291015625
r_  generation:  0.04073143005371094
local_output_nid generation:  0.005975246429443359
local_in_edges_tensor generation:  0.0033490657806396484
mini_batch_src_global generation:  0.0033943653106689453
r_  generation:  0.04214000701904297
----------------------check_connections_block total spend ----------------------------- 0.5305047035217285
generate_one_block  0.05181622505187988
generate_one_block  0.053563833236694336
generate_one_block  0.05481386184692383
generate_one_block  0.05565619468688965
generate_one_block  0.05579948425292969
generate_one_block  0.05899524688720703
generate_one_block  0.05710124969482422
generate_one_block  0.055498361587524414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03693366050720215
gen group dst list time:  0.015063047409057617
time for parepare:  0.01890850067138672
local_output_nid generation:  0.013179779052734375
local_in_edges_tensor generation:  0.033925771713256836
mini_batch_src_global generation:  0.0267794132232666
r_  generation:  0.28563380241394043
local_output_nid generation:  0.018087387084960938
local_in_edges_tensor generation:  0.0287930965423584
mini_batch_src_global generation:  0.036881446838378906
r_  generation:  0.2992091178894043
local_output_nid generation:  0.017971515655517578
local_in_edges_tensor generation:  0.026767492294311523
mini_batch_src_global generation:  0.04349493980407715
r_  generation:  0.3055074214935303
local_output_nid generation:  0.017821788787841797
local_in_edges_tensor generation:  0.02183055877685547
mini_batch_src_global generation:  0.03527474403381348
r_  generation:  0.32761716842651367
local_output_nid generation:  0.021500587463378906
local_in_edges_tensor generation:  0.033376216888427734
mini_batch_src_global generation:  0.04041290283203125
r_  generation:  0.30811405181884766
local_output_nid generation:  0.01837944984436035
local_in_edges_tensor generation:  0.024618148803710938
mini_batch_src_global generation:  0.038539886474609375
r_  generation:  0.31069397926330566
local_output_nid generation:  0.01894521713256836
local_in_edges_tensor generation:  0.02046966552734375
mini_batch_src_global generation:  0.03725600242614746
r_  generation:  0.30436062812805176
local_output_nid generation:  0.018436670303344727
local_in_edges_tensor generation:  0.017539262771606445
mini_batch_src_global generation:  0.03710603713989258
r_  generation:  0.3101530075073242
----------------------check_connections_block total spend ----------------------------- 3.64321231842041
generate_one_block  0.38684844970703125
generate_one_block  0.3859069347381592
generate_one_block  0.3929567337036133
generate_one_block  0.3953268527984619
generate_one_block  0.416820764541626
generate_one_block  0.39943432807922363
generate_one_block  0.38571977615356445
generate_one_block  0.43033576011657715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04089212417602539
gen group dst list time:  0.0391690731048584
time for parepare:  0.021159887313842773
local_output_nid generation:  0.028038978576660156
local_in_edges_tensor generation:  0.07592058181762695
mini_batch_src_global generation:  0.0439915657043457
r_  generation:  0.46832942962646484
local_output_nid generation:  0.03566288948059082
local_in_edges_tensor generation:  0.05216789245605469
mini_batch_src_global generation:  0.05338788032531738
r_  generation:  0.4843466281890869
local_output_nid generation:  0.03471064567565918
local_in_edges_tensor generation:  0.043596506118774414
mini_batch_src_global generation:  0.05079817771911621
r_  generation:  0.4841599464416504
local_output_nid generation:  0.03427577018737793
local_in_edges_tensor generation:  0.04346060752868652
mini_batch_src_global generation:  0.05333757400512695
r_  generation:  0.4845433235168457
local_output_nid generation:  0.03451061248779297
local_in_edges_tensor generation:  0.03873586654663086
mini_batch_src_global generation:  0.05186915397644043
r_  generation:  0.49495553970336914
local_output_nid generation:  0.03420829772949219
local_in_edges_tensor generation:  0.038266897201538086
mini_batch_src_global generation:  0.05540919303894043
r_  generation:  0.50136399269104
local_output_nid generation:  0.03427839279174805
local_in_edges_tensor generation:  0.03426957130432129
mini_batch_src_global generation:  0.05328631401062012
r_  generation:  0.4957389831542969
local_output_nid generation:  0.03448796272277832
local_in_edges_tensor generation:  0.04100203514099121
mini_batch_src_global generation:  0.05448269844055176
r_  generation:  0.4897005558013916
----------------------check_connections_block total spend ----------------------------- 5.833207845687866
generate_one_block  0.6161775588989258
generate_one_block  0.6089637279510498
generate_one_block  0.6336567401885986
generate_one_block  0.6134331226348877
generate_one_block  0.6152939796447754
generate_one_block  0.6019301414489746
generate_one_block  0.6049513816833496
generate_one_block  0.6330921649932861
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.13927745819091797  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

connection checking time:  9.476420164108276
block generation total time  8.120848417282104
average batch blocks generation time:  1.015106052160263
block dataloader generation time/epoch 19.699759483337402
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09832143783569336  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

torch.Size([160665, 128])
torch.Size([141315, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.3001823425292969  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09820413589477539  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

torch.Size([160411, 128])
torch.Size([140637, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.2972450256347656  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09829425811767578  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

torch.Size([160439, 128])
torch.Size([141345, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.30022478103637695  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.0984950065612793  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

torch.Size([160657, 128])
torch.Size([141350, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.2986111640930176  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09845781326293945  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

torch.Size([160576, 128])
torch.Size([141154, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.30052852630615234  GigaBytes
Max Memory Allocated: 0.33210277557373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09831762313842773  GigaBytes
Max Memory Allocated: 0.3322772979736328  GigaBytes

torch.Size([160268, 128])
torch.Size([140871, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.29891204833984375  GigaBytes
Max Memory Allocated: 0.3322772979736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.0982522964477539  GigaBytes
Max Memory Allocated: 0.3322772979736328  GigaBytes

torch.Size([160468, 128])
torch.Size([141029, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.29825925827026367  GigaBytes
Max Memory Allocated: 0.3322772979736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09839916229248047  GigaBytes
Max Memory Allocated: 0.3322772979736328  GigaBytes

torch.Size([160487, 128])
torch.Size([141189, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.3003358840942383  GigaBytes
Max Memory Allocated: 0.3322772979736328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.040781617164611816 |0.016505569219589233 |0.003651440143585205 |9.41157341003418e-05 |0.004675537347793579 |0.0014734268188476562 |
----------------------------------------------------------pseudo_mini_loss sum 4.075845718383789
Total (block generation + training)time/epoch 20.252622604370117
Training time/epoch 0.5525734424591064
Training time without block to device /epoch 0.4205288887023926
Training time without total dataloading part /epoch 0.06884217262268066
load block tensor time/epoch 0.32625293731689453
block to device time/epoch 0.13204455375671387
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2955554
Number of first layer input nodes during this epoch:  1283971
