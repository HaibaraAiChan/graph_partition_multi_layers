Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648355576.920298
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026813983917236328
random selection method range initialization spend 0.0063419342041015625
time for parepare:  0.018182992935180664
local_output_nid generation:  0.01596808433532715
local_in_edges_tensor generation:  0.014552593231201172
mini_batch_src_global generation:  0.01463937759399414
r_  generation:  0.18404245376586914
local_output_nid generation:  0.02140069007873535
local_in_edges_tensor generation:  0.01604604721069336
mini_batch_src_global generation:  0.019420623779296875
r_  generation:  0.1961226463317871
----------------------check_connections_block total spend ----------------------------- 0.5847604274749756
generate_one_block  0.2250361442565918
generate_one_block  0.22352385520935059
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04077935218811035
gen group dst list time:  0.0075283050537109375
time for parepare:  0.018796682357788086
local_output_nid generation:  0.025353193283081055
local_in_edges_tensor generation:  0.04824638366699219
mini_batch_src_global generation:  0.050046682357788086
r_  generation:  0.49384260177612305
local_output_nid generation:  0.03233003616333008
local_in_edges_tensor generation:  0.05141592025756836
mini_batch_src_global generation:  0.056299686431884766
r_  generation:  0.5029160976409912
----------------------check_connections_block total spend ----------------------------- 1.5142099857330322
generate_one_block  0.660820722579956
generate_one_block  0.6582231521606445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028087854385375977
gen group dst list time:  0.011730432510375977
time for parepare:  0.01867842674255371
local_output_nid generation:  0.030338048934936523
local_in_edges_tensor generation:  0.04384732246398926
mini_batch_src_global generation:  0.04590320587158203
r_  generation:  0.505164623260498
local_output_nid generation:  0.038163185119628906
local_in_edges_tensor generation:  0.05161261558532715
mini_batch_src_global generation:  0.0570063591003418
r_  generation:  0.509772539138794
----------------------check_connections_block total spend ----------------------------- 1.5390405654907227
generate_one_block  0.6694462299346924
generate_one_block  0.6557672023773193
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  3.053250551223755
block generation total time  2.6442573070526123
average batch blocks generation time:  1.3221286535263062
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.1078023910522461  GigaBytes
Max Memory Allocated: 0.1078023910522461  GigaBytes

torch.Size([166742, 128])
torch.Size([163436, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.4204697608947754  GigaBytes
Max Memory Allocated: 0.44811296463012695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.1145477294921875  GigaBytes
Max Memory Allocated: 0.4831833839416504  GigaBytes

torch.Size([166687, 128])
torch.Size([163396, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.41921281814575195  GigaBytes
Max Memory Allocated: 0.4831833839416504  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04424595832824707 |0.1550658941268921 |0.37012040615081787 |0.0001361370086669922 |0.02118813991546631 |0.0037796497344970703 |
----------------------------------------------------------pseudo_mini_loss sum 5.235675811767578
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  938589
Number of first layer input nodes during this epoch:  333429
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.17328834533691406  GigaBytes
Max Memory Allocated: 0.4831833839416504  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022045373916625977
random selection method range initialization spend 0.006129741668701172
time for parepare:  0.018857240676879883
local_output_nid generation:  0.01645207405090332
local_in_edges_tensor generation:  0.018282175064086914
mini_batch_src_global generation:  0.0138092041015625
r_  generation:  0.1855158805847168
local_output_nid generation:  0.025207042694091797
local_in_edges_tensor generation:  0.017946958541870117
mini_batch_src_global generation:  0.019196271896362305
r_  generation:  0.20438432693481445
----------------------check_connections_block total spend ----------------------------- 0.6084401607513428
generate_one_block  0.22905921936035156
generate_one_block  0.23567676544189453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04594779014587402
gen group dst list time:  0.007735729217529297
time for parepare:  0.01929783821105957
local_output_nid generation:  0.029052257537841797
local_in_edges_tensor generation:  0.047705888748168945
mini_batch_src_global generation:  0.048227787017822266
r_  generation:  0.5239222049713135
local_output_nid generation:  0.03790092468261719
local_in_edges_tensor generation:  0.054978370666503906
mini_batch_src_global generation:  0.061365365982055664
r_  generation:  0.5108461380004883
----------------------check_connections_block total spend ----------------------------- 1.5839500427246094
generate_one_block  0.645993709564209
generate_one_block  0.6606807708740234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04166603088378906
gen group dst list time:  0.013765335083007812
time for parepare:  0.01912236213684082
local_output_nid generation:  0.03042912483215332
local_in_edges_tensor generation:  0.07244515419006348
mini_batch_src_global generation:  0.050423622131347656
r_  generation:  0.5199074745178223
local_output_nid generation:  0.04012179374694824
local_in_edges_tensor generation:  0.05472421646118164
mini_batch_src_global generation:  0.057146549224853516
r_  generation:  0.535914421081543
----------------------check_connections_block total spend ----------------------------- 1.6220381259918213
generate_one_block  0.6663556098937988
generate_one_block  0.6803152561187744
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.17328834533691406  GigaBytes
Max Memory Allocated: 0.4831833839416504  GigaBytes

connection checking time:  3.2059881687164307
block generation total time  2.6533453464508057
average batch blocks generation time:  1.3266726732254028
block dataloader generation time/epoch 7.757312059402466
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.11542749404907227  GigaBytes
Max Memory Allocated: 0.4831833839416504  GigaBytes

torch.Size([166748, 128])
torch.Size([163434, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.4201335906982422  GigaBytes
Max Memory Allocated: 0.4831833839416504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.11548089981079102  GigaBytes
Max Memory Allocated: 0.4839611053466797  GigaBytes

torch.Size([166796, 128])
torch.Size([163475, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.42182159423828125  GigaBytes
Max Memory Allocated: 0.4839611053466797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047130465507507324 |0.03435051441192627 |0.0049550533294677734 |0.00010824203491210938 |0.022757887840270996 |0.002885580062866211 |
----------------------------------------------------------pseudo_mini_loss sum 4.0443878173828125
Total (block generation + training)time/epoch 7.9820005893707275
Training time/epoch 0.22440600395202637
Training time without block to device /epoch 0.15570497512817383
Training time without total dataloading part /epoch 0.05852794647216797
load block tensor time/epoch 0.09426093101501465
block to device time/epoch 0.06870102882385254
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  939216
Number of first layer input nodes during this epoch:  333544
