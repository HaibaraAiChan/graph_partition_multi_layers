Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648353172.7658951
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0230410099029541
random selection method range initialization spend 0.006037473678588867
time for parepare:  0.019011974334716797
local_output_nid generation:  0.004235982894897461
local_in_edges_tensor generation:  0.005105495452880859
mini_batch_src_global generation:  0.003271341323852539
r_  generation:  0.03780245780944824
local_output_nid generation:  0.005924701690673828
local_in_edges_tensor generation:  0.003037691116333008
mini_batch_src_global generation:  0.004286766052246094
r_  generation:  0.03957653045654297
local_output_nid generation:  0.006057262420654297
local_in_edges_tensor generation:  0.0031480789184570312
mini_batch_src_global generation:  0.0028426647186279297
r_  generation:  0.040740251541137695
local_output_nid generation:  0.006101369857788086
local_in_edges_tensor generation:  0.0030846595764160156
mini_batch_src_global generation:  0.0029840469360351562
r_  generation:  0.04067683219909668
local_output_nid generation:  0.006095409393310547
local_in_edges_tensor generation:  0.003106832504272461
mini_batch_src_global generation:  0.003180265426635742
r_  generation:  0.04147911071777344
local_output_nid generation:  0.006121635437011719
local_in_edges_tensor generation:  0.0030841827392578125
mini_batch_src_global generation:  0.0033316612243652344
r_  generation:  0.04232978820800781
local_output_nid generation:  0.006116390228271484
local_in_edges_tensor generation:  0.0030477046966552734
mini_batch_src_global generation:  0.0033643245697021484
r_  generation:  0.041674137115478516
local_output_nid generation:  0.006075620651245117
local_in_edges_tensor generation:  0.0031113624572753906
mini_batch_src_global generation:  0.003269672393798828
r_  generation:  0.04054450988769531
----------------------check_connections_block total spend ----------------------------- 0.5217452049255371
generate_one_block  0.054267168045043945
generate_one_block  0.05550193786621094
generate_one_block  0.05584526062011719
generate_one_block  0.05509495735168457
generate_one_block  0.05893564224243164
generate_one_block  0.05524945259094238
generate_one_block  0.05467557907104492
generate_one_block  0.053716421127319336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037424564361572266
gen group dst list time:  0.015316963195800781
time for parepare:  0.019249677658081055
local_output_nid generation:  0.01318812370300293
local_in_edges_tensor generation:  0.030740022659301758
mini_batch_src_global generation:  0.029561281204223633
r_  generation:  0.29082751274108887
local_output_nid generation:  0.019941329956054688
local_in_edges_tensor generation:  0.028850317001342773
mini_batch_src_global generation:  0.0356447696685791
r_  generation:  0.3131732940673828
local_output_nid generation:  0.018915176391601562
local_in_edges_tensor generation:  0.026446819305419922
mini_batch_src_global generation:  0.0379185676574707
r_  generation:  0.3150768280029297
local_output_nid generation:  0.01859307289123535
local_in_edges_tensor generation:  0.017953872680664062
mini_batch_src_global generation:  0.03918647766113281
r_  generation:  0.31598734855651855
local_output_nid generation:  0.018929004669189453
local_in_edges_tensor generation:  0.02484297752380371
mini_batch_src_global generation:  0.037784576416015625
r_  generation:  0.3329920768737793
local_output_nid generation:  0.02125406265258789
local_in_edges_tensor generation:  0.033199310302734375
mini_batch_src_global generation:  0.04050326347351074
r_  generation:  0.3096327781677246
local_output_nid generation:  0.018282175064086914
local_in_edges_tensor generation:  0.02086186408996582
mini_batch_src_global generation:  0.03701043128967285
r_  generation:  0.30977392196655273
local_output_nid generation:  0.01844930648803711
local_in_edges_tensor generation:  0.02030205726623535
mini_batch_src_global generation:  0.03708052635192871
r_  generation:  0.3066737651824951
----------------------check_connections_block total spend ----------------------------- 3.691967725753784
generate_one_block  0.39580845832824707
generate_one_block  0.415665864944458
generate_one_block  0.4012584686279297
generate_one_block  0.38807034492492676
generate_one_block  0.3953733444213867
generate_one_block  0.40402817726135254
generate_one_block  0.3898200988769531
generate_one_block  0.3872396945953369
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0442047119140625
gen group dst list time:  0.03591203689575195
time for parepare:  0.019168853759765625
local_output_nid generation:  0.02922201156616211
local_in_edges_tensor generation:  0.05914568901062012
mini_batch_src_global generation:  0.0435945987701416
r_  generation:  0.47217226028442383
local_output_nid generation:  0.03517293930053711
local_in_edges_tensor generation:  0.05101490020751953
mini_batch_src_global generation:  0.05375266075134277
r_  generation:  0.48330187797546387
local_output_nid generation:  0.036452293395996094
local_in_edges_tensor generation:  0.04624128341674805
mini_batch_src_global generation:  0.051265716552734375
r_  generation:  0.5118846893310547
local_output_nid generation:  0.03588986396789551
local_in_edges_tensor generation:  0.03918027877807617
mini_batch_src_global generation:  0.060270071029663086
r_  generation:  0.510784387588501
local_output_nid generation:  0.03792119026184082
local_in_edges_tensor generation:  0.04509854316711426
mini_batch_src_global generation:  0.057089805603027344
r_  generation:  0.5092558860778809
local_output_nid generation:  0.03654789924621582
local_in_edges_tensor generation:  0.04618668556213379
mini_batch_src_global generation:  0.05493950843811035
r_  generation:  0.4973888397216797
local_output_nid generation:  0.03594088554382324
local_in_edges_tensor generation:  0.0374453067779541
mini_batch_src_global generation:  0.05514860153198242
r_  generation:  0.5077979564666748
local_output_nid generation:  0.0372767448425293
local_in_edges_tensor generation:  0.04947090148925781
mini_batch_src_global generation:  0.05638694763183594
r_  generation:  0.5070934295654297
----------------------check_connections_block total spend ----------------------------- 5.98778510093689
generate_one_block  0.6196165084838867
generate_one_block  0.6217973232269287
generate_one_block  0.6185524463653564
generate_one_block  0.6140918731689453
generate_one_block  0.6283175945281982
generate_one_block  0.6114094257354736
generate_one_block  0.6428163051605225
generate_one_block  0.6097679138183594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  9.679752826690674
block generation total time  8.143633842468262
average batch blocks generation time:  1.0179542303085327
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09551143646240234  GigaBytes
Max Memory Allocated: 0.09551143646240234  GigaBytes

torch.Size([160240, 128])
torch.Size([140648, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.2131786346435547  GigaBytes
Max Memory Allocated: 0.21527576446533203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09768009185791016  GigaBytes
Max Memory Allocated: 0.2269301414489746  GigaBytes

torch.Size([160819, 128])
torch.Size([141845, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.2150745391845703  GigaBytes
Max Memory Allocated: 0.2269301414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09827852249145508  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160348, 128])
torch.Size([141157, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21222162246704102  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09833717346191406  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160542, 128])
torch.Size([141387, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21196937561035156  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09834623336791992  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160459, 128])
torch.Size([141244, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.2120041847229004  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09796428680419922  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160545, 128])
torch.Size([141098, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21319341659545898  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09798479080200195  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160451, 128])
torch.Size([141266, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21344709396362305  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09787225723266602  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160528, 128])
torch.Size([141201, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21251678466796875  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03655785322189331 |0.05558699369430542 |0.09696188569068909 |0.00010699033737182617 |0.008999049663543701 |0.0016677379608154297 |
----------------------------------------------------------pseudo_mini_loss sum 4.993534088134766
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2956477
Number of first layer input nodes during this epoch:  1283932
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.13862276077270508  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01786208152770996
random selection method range initialization spend 0.0057849884033203125
time for parepare:  0.01733994483947754
local_output_nid generation:  0.004571199417114258
local_in_edges_tensor generation:  0.007772684097290039
mini_batch_src_global generation:  0.0032663345336914062
r_  generation:  0.036324262619018555
local_output_nid generation:  0.005855560302734375
local_in_edges_tensor generation:  0.003081798553466797
mini_batch_src_global generation:  0.004207611083984375
r_  generation:  0.039804935455322266
local_output_nid generation:  0.0060079097747802734
local_in_edges_tensor generation:  0.0031354427337646484
mini_batch_src_global generation:  0.002812623977661133
r_  generation:  0.040610551834106445
local_output_nid generation:  0.0061664581298828125
local_in_edges_tensor generation:  0.003206014633178711
mini_batch_src_global generation:  0.0030286312103271484
r_  generation:  0.04056501388549805
local_output_nid generation:  0.006135702133178711
local_in_edges_tensor generation:  0.0031659603118896484
mini_batch_src_global generation:  0.0031118392944335938
r_  generation:  0.041561126708984375
local_output_nid generation:  0.006037712097167969
local_in_edges_tensor generation:  0.0031828880310058594
mini_batch_src_global generation:  0.0033228397369384766
r_  generation:  0.041907548904418945
local_output_nid generation:  0.006094217300415039
local_in_edges_tensor generation:  0.003145456314086914
mini_batch_src_global generation:  0.0033473968505859375
r_  generation:  0.04178953170776367
local_output_nid generation:  0.0060787200927734375
local_in_edges_tensor generation:  0.0030829906463623047
mini_batch_src_global generation:  0.003367900848388672
r_  generation:  0.042611122131347656
----------------------check_connections_block total spend ----------------------------- 0.5246133804321289
generate_one_block  0.0567622184753418
generate_one_block  0.054511070251464844
generate_one_block  0.05945730209350586
generate_one_block  0.05478811264038086
generate_one_block  0.05530834197998047
generate_one_block  0.05562305450439453
generate_one_block  0.05825996398925781
generate_one_block  0.0551149845123291
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037268877029418945
gen group dst list time:  0.016272544860839844
time for parepare:  0.01909637451171875
local_output_nid generation:  0.013108253479003906
local_in_edges_tensor generation:  0.031122207641601562
mini_batch_src_global generation:  0.027119874954223633
r_  generation:  0.28772568702697754
local_output_nid generation:  0.018894672393798828
local_in_edges_tensor generation:  0.029227256774902344
mini_batch_src_global generation:  0.03564786911010742
r_  generation:  0.30258798599243164
local_output_nid generation:  0.0182034969329834
local_in_edges_tensor generation:  0.02718973159790039
mini_batch_src_global generation:  0.03457045555114746
r_  generation:  0.3068525791168213
local_output_nid generation:  0.01796889305114746
local_in_edges_tensor generation:  0.021497726440429688
mini_batch_src_global generation:  0.038175344467163086
r_  generation:  0.31122612953186035
local_output_nid generation:  0.018360137939453125
local_in_edges_tensor generation:  0.024148941040039062
mini_batch_src_global generation:  0.0396883487701416
r_  generation:  0.3182353973388672
local_output_nid generation:  0.0243990421295166
local_in_edges_tensor generation:  0.03207826614379883
mini_batch_src_global generation:  0.04906749725341797
r_  generation:  0.3161282539367676
local_output_nid generation:  0.018845081329345703
local_in_edges_tensor generation:  0.024898767471313477
mini_batch_src_global generation:  0.042392730712890625
r_  generation:  0.3109593391418457
local_output_nid generation:  0.018926382064819336
local_in_edges_tensor generation:  0.021210670471191406
mini_batch_src_global generation:  0.03962206840515137
r_  generation:  0.31087470054626465
----------------------check_connections_block total spend ----------------------------- 3.678584098815918
generate_one_block  0.3913733959197998
generate_one_block  0.40282130241394043
generate_one_block  0.4129636287689209
generate_one_block  0.40436744689941406
generate_one_block  0.3996589183807373
generate_one_block  0.40358901023864746
generate_one_block  0.3890872001647949
generate_one_block  0.4222884178161621
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.044422149658203125
gen group dst list time:  0.036061763763427734
time for parepare:  0.019069433212280273
local_output_nid generation:  0.028343677520751953
local_in_edges_tensor generation:  0.060353994369506836
mini_batch_src_global generation:  0.047590017318725586
r_  generation:  0.4768385887145996
local_output_nid generation:  0.03571033477783203
local_in_edges_tensor generation:  0.05614185333251953
mini_batch_src_global generation:  0.05304765701293945
r_  generation:  0.49465012550354004
local_output_nid generation:  0.038381099700927734
local_in_edges_tensor generation:  0.04429197311401367
mini_batch_src_global generation:  0.05750083923339844
r_  generation:  0.4917185306549072
local_output_nid generation:  0.03601217269897461
local_in_edges_tensor generation:  0.04150748252868652
mini_batch_src_global generation:  0.054293155670166016
r_  generation:  0.4855639934539795
local_output_nid generation:  0.035973548889160156
local_in_edges_tensor generation:  0.040181875228881836
mini_batch_src_global generation:  0.05282950401306152
r_  generation:  0.501009464263916
local_output_nid generation:  0.035874128341674805
local_in_edges_tensor generation:  0.0419158935546875
mini_batch_src_global generation:  0.05478787422180176
r_  generation:  0.4863245487213135
local_output_nid generation:  0.03582477569580078
local_in_edges_tensor generation:  0.03793001174926758
mini_batch_src_global generation:  0.054036617279052734
r_  generation:  0.4994692802429199
local_output_nid generation:  0.03604245185852051
local_in_edges_tensor generation:  0.041695594787597656
mini_batch_src_global generation:  0.05556917190551758
r_  generation:  0.4934377670288086
----------------------check_connections_block total spend ----------------------------- 5.903208017349243
generate_one_block  0.6134557723999023
generate_one_block  0.5988476276397705
generate_one_block  0.6123201847076416
generate_one_block  0.6223516464233398
generate_one_block  0.6136150360107422
generate_one_block  0.6175999641418457
generate_one_block  0.610252857208252
generate_one_block  0.6285932064056396
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.13862276077270508  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

connection checking time:  9.581792116165161
block generation total time  8.14318561553955
average batch blocks generation time:  1.0178982019424438
block dataloader generation time/epoch 19.688305139541626
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09800291061401367  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160593, 128])
torch.Size([141159, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21382427215576172  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09810304641723633  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160464, 128])
torch.Size([140971, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21411657333374023  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09808826446533203  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160579, 128])
torch.Size([141057, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21403264999389648  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.0974879264831543  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160474, 128])
torch.Size([141215, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21249675750732422  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.0980997085571289  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160509, 128])
torch.Size([141136, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21334266662597656  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09878826141357422  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160598, 128])
torch.Size([141128, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21425962448120117  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09850025177001953  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160714, 128])
torch.Size([141476, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21328496932983398  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09851932525634766  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

torch.Size([160616, 128])
torch.Size([141659, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21329355239868164  GigaBytes
Max Memory Allocated: 0.22793865203857422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03553211688995361 |0.017256498336791992 |0.0034852027893066406 |9.277462959289551e-05 |0.003844141960144043 |0.0015153884887695312 |
----------------------------------------------------------pseudo_mini_loss sum 4.306978702545166
Total (block generation + training)time/epoch 20.19295382499695
Training time/epoch 0.5043659210205078
Training time without block to device /epoch 0.3663139343261719
Training time without total dataloading part /epoch 0.060892343521118164
load block tensor time/epoch 0.2842569351196289
block to device time/epoch 0.13805198669433594
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2957156
Number of first layer input nodes during this epoch:  1284547
