Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648355229.3710313
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024899005889892578
random selection method range initialization spend 0.006494045257568359
time for parepare:  0.01836681365966797
local_output_nid generation:  0.0021903514862060547
local_in_edges_tensor generation:  0.004704475402832031
mini_batch_src_global generation:  0.0017170906066894531
r_  generation:  0.01726078987121582
local_output_nid generation:  0.0024900436401367188
local_in_edges_tensor generation:  0.0016295909881591797
mini_batch_src_global generation:  0.00211334228515625
r_  generation:  0.017429590225219727
local_output_nid generation:  0.0028383731842041016
local_in_edges_tensor generation:  0.0016207695007324219
mini_batch_src_global generation:  0.0013437271118164062
r_  generation:  0.017129898071289062
local_output_nid generation:  0.002789020538330078
local_in_edges_tensor generation:  0.0014681816101074219
mini_batch_src_global generation:  0.0013530254364013672
r_  generation:  0.01732468605041504
local_output_nid generation:  0.002765655517578125
local_in_edges_tensor generation:  0.0015411376953125
mini_batch_src_global generation:  0.0011196136474609375
r_  generation:  0.017217397689819336
local_output_nid generation:  0.0028352737426757812
local_in_edges_tensor generation:  0.0015151500701904297
mini_batch_src_global generation:  0.0013418197631835938
r_  generation:  0.017429351806640625
local_output_nid generation:  0.002757549285888672
local_in_edges_tensor generation:  0.0014693737030029297
mini_batch_src_global generation:  0.0014789104461669922
r_  generation:  0.017934799194335938
local_output_nid generation:  0.0028014183044433594
local_in_edges_tensor generation:  0.0014529228210449219
mini_batch_src_global generation:  0.0014667510986328125
r_  generation:  0.018258333206176758
local_output_nid generation:  0.002779245376586914
local_in_edges_tensor generation:  0.0014755725860595703
mini_batch_src_global generation:  0.0014564990997314453
r_  generation:  0.018259763717651367
local_output_nid generation:  0.0028007030487060547
local_in_edges_tensor generation:  0.0014655590057373047
mini_batch_src_global generation:  0.00146484375
r_  generation:  0.018278121948242188
local_output_nid generation:  0.002841949462890625
local_in_edges_tensor generation:  0.0014536380767822266
mini_batch_src_global generation:  0.001504659652709961
r_  generation:  0.018841266632080078
local_output_nid generation:  0.0028183460235595703
local_in_edges_tensor generation:  0.0015060901641845703
mini_batch_src_global generation:  0.0014331340789794922
r_  generation:  0.01819014549255371
local_output_nid generation:  0.0027992725372314453
local_in_edges_tensor generation:  0.0014586448669433594
mini_batch_src_global generation:  0.0015425682067871094
r_  generation:  0.018126249313354492
local_output_nid generation:  0.0027997493743896484
local_in_edges_tensor generation:  0.0015153884887695312
mini_batch_src_global generation:  0.001462697982788086
r_  generation:  0.017999649047851562
local_output_nid generation:  0.002749919891357422
local_in_edges_tensor generation:  0.0014812946319580078
mini_batch_src_global generation:  0.0015103816986083984
r_  generation:  0.017808914184570312
local_output_nid generation:  0.002797365188598633
local_in_edges_tensor generation:  0.0014128684997558594
mini_batch_src_global generation:  0.0015285015106201172
r_  generation:  0.018361806869506836
----------------------check_connections_block total spend ----------------------------- 0.4737062454223633
generate_one_block  0.027217388153076172
generate_one_block  0.027009010314941406
generate_one_block  0.029223203659057617
generate_one_block  0.02712392807006836
generate_one_block  0.02647233009338379
generate_one_block  0.02644801139831543
generate_one_block  0.026407957077026367
generate_one_block  0.0271303653717041
generate_one_block  0.027251243591308594
generate_one_block  0.026322126388549805
generate_one_block  0.027390480041503906
generate_one_block  0.02674269676208496
generate_one_block  0.026707172393798828
generate_one_block  0.02601146697998047
generate_one_block  0.02633047103881836
generate_one_block  0.027484416961669922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03939342498779297
gen group dst list time:  0.01833486557006836
time for parepare:  0.019319772720336914
local_output_nid generation:  0.008424758911132812
local_in_edges_tensor generation:  0.017867565155029297
mini_batch_src_global generation:  0.018081188201904297
r_  generation:  0.19234824180603027
local_output_nid generation:  0.012237071990966797
local_in_edges_tensor generation:  0.01960468292236328
mini_batch_src_global generation:  0.023418426513671875
r_  generation:  0.19836926460266113
local_output_nid generation:  0.011884450912475586
local_in_edges_tensor generation:  0.015608072280883789
mini_batch_src_global generation:  0.022576570510864258
r_  generation:  0.2007617950439453
local_output_nid generation:  0.01189279556274414
local_in_edges_tensor generation:  0.01592111587524414
mini_batch_src_global generation:  0.025096654891967773
r_  generation:  0.20574140548706055
local_output_nid generation:  0.011846542358398438
local_in_edges_tensor generation:  0.012146472930908203
mini_batch_src_global generation:  0.03232693672180176
r_  generation:  0.20134925842285156
local_output_nid generation:  0.01183938980102539
local_in_edges_tensor generation:  0.014111518859863281
mini_batch_src_global generation:  0.024226903915405273
r_  generation:  0.2024519443511963
local_output_nid generation:  0.011853694915771484
local_in_edges_tensor generation:  0.015617609024047852
mini_batch_src_global generation:  0.028817176818847656
r_  generation:  0.20522260665893555
local_output_nid generation:  0.011939525604248047
local_in_edges_tensor generation:  0.013242721557617188
mini_batch_src_global generation:  0.025151729583740234
r_  generation:  0.21243572235107422
local_output_nid generation:  0.011919021606445312
local_in_edges_tensor generation:  0.01670074462890625
mini_batch_src_global generation:  0.027418136596679688
r_  generation:  0.20948147773742676
local_output_nid generation:  0.011752843856811523
local_in_edges_tensor generation:  0.013576507568359375
mini_batch_src_global generation:  0.025185823440551758
r_  generation:  0.20567655563354492
local_output_nid generation:  0.012146711349487305
local_in_edges_tensor generation:  0.014603614807128906
mini_batch_src_global generation:  0.027282238006591797
r_  generation:  0.21388483047485352
local_output_nid generation:  0.011816024780273438
local_in_edges_tensor generation:  0.01263117790222168
mini_batch_src_global generation:  0.0258328914642334
r_  generation:  0.20905613899230957
local_output_nid generation:  0.011869668960571289
local_in_edges_tensor generation:  0.012609720230102539
mini_batch_src_global generation:  0.02732110023498535
r_  generation:  0.2099745273590088
local_output_nid generation:  0.011648893356323242
local_in_edges_tensor generation:  0.014397382736206055
mini_batch_src_global generation:  0.02474498748779297
r_  generation:  0.20631742477416992
local_output_nid generation:  0.011799812316894531
local_in_edges_tensor generation:  0.01617121696472168
mini_batch_src_global generation:  0.027009963989257812
r_  generation:  0.2083423137664795
local_output_nid generation:  0.014794111251831055
local_in_edges_tensor generation:  0.013430118560791016
mini_batch_src_global generation:  0.025481224060058594
r_  generation:  0.2072608470916748
----------------------check_connections_block total spend ----------------------------- 4.876742839813232
generate_one_block  0.2760012149810791
generate_one_block  0.2723836898803711
generate_one_block  0.27152228355407715
generate_one_block  0.27483129501342773
generate_one_block  0.2750706672668457
generate_one_block  0.26799702644348145
generate_one_block  0.26922154426574707
generate_one_block  0.2736804485321045
generate_one_block  0.2789337635040283
generate_one_block  0.2691957950592041
generate_one_block  0.28350067138671875
generate_one_block  0.2669668197631836
generate_one_block  0.27530503273010254
generate_one_block  0.26529932022094727
generate_one_block  0.2816469669342041
generate_one_block  0.2697782516479492
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03678584098815918
gen group dst list time:  0.0586848258972168
time for parepare:  0.01933455467224121
local_output_nid generation:  0.024845361709594727
local_in_edges_tensor generation:  0.04442739486694336
mini_batch_src_global generation:  0.040822505950927734
r_  generation:  0.4354414939880371
local_output_nid generation:  0.03168010711669922
local_in_edges_tensor generation:  0.04993271827697754
mini_batch_src_global generation:  0.05295515060424805
r_  generation:  0.44005322456359863
local_output_nid generation:  0.030141830444335938
local_in_edges_tensor generation:  0.04094362258911133
mini_batch_src_global generation:  0.04974865913391113
r_  generation:  0.4526801109313965
local_output_nid generation:  0.03172945976257324
local_in_edges_tensor generation:  0.056945085525512695
mini_batch_src_global generation:  0.050659894943237305
r_  generation:  0.44692087173461914
local_output_nid generation:  0.030385494232177734
local_in_edges_tensor generation:  0.031798362731933594
mini_batch_src_global generation:  0.05014491081237793
r_  generation:  0.4519765377044678
local_output_nid generation:  0.0305631160736084
local_in_edges_tensor generation:  0.03293919563293457
mini_batch_src_global generation:  0.05158710479736328
r_  generation:  0.4573953151702881
local_output_nid generation:  0.030735015869140625
local_in_edges_tensor generation:  0.04407691955566406
mini_batch_src_global generation:  0.05769038200378418
r_  generation:  0.45253849029541016
local_output_nid generation:  0.030911922454833984
local_in_edges_tensor generation:  0.03697538375854492
mini_batch_src_global generation:  0.054108619689941406
r_  generation:  0.45224499702453613
local_output_nid generation:  0.03345537185668945
local_in_edges_tensor generation:  0.03239727020263672
mini_batch_src_global generation:  0.053218841552734375
r_  generation:  0.453610897064209
local_output_nid generation:  0.03131818771362305
local_in_edges_tensor generation:  0.03299522399902344
mini_batch_src_global generation:  0.05152177810668945
r_  generation:  0.44472742080688477
local_output_nid generation:  0.031826019287109375
local_in_edges_tensor generation:  0.033757925033569336
mini_batch_src_global generation:  0.055185556411743164
r_  generation:  0.455944299697876
local_output_nid generation:  0.03124690055847168
local_in_edges_tensor generation:  0.033078670501708984
mini_batch_src_global generation:  0.051987648010253906
r_  generation:  0.4475364685058594
local_output_nid generation:  0.031078815460205078
local_in_edges_tensor generation:  0.02947235107421875
mini_batch_src_global generation:  0.052152156829833984
r_  generation:  0.45498132705688477
local_output_nid generation:  0.03148698806762695
local_in_edges_tensor generation:  0.029118061065673828
mini_batch_src_global generation:  0.05278420448303223
r_  generation:  0.44821643829345703
local_output_nid generation:  0.0312347412109375
local_in_edges_tensor generation:  0.03643298149108887
mini_batch_src_global generation:  0.05037236213684082
r_  generation:  0.46164703369140625
local_output_nid generation:  0.03168058395385742
local_in_edges_tensor generation:  0.031006336212158203
mini_batch_src_global generation:  0.0513913631439209
r_  generation:  0.4468050003051758
----------------------check_connections_block total spend ----------------------------- 10.71166467666626
generate_one_block  0.5895566940307617
generate_one_block  0.6062920093536377
generate_one_block  0.5776104927062988
generate_one_block  0.5908668041229248
generate_one_block  0.5705091953277588
generate_one_block  0.5746750831604004
generate_one_block  0.6245687007904053
generate_one_block  0.586768388748169
generate_one_block  0.5850200653076172
generate_one_block  0.5748960971832275
generate_one_block  0.5806546211242676
generate_one_block  0.5777420997619629
generate_one_block  0.5897238254547119
generate_one_block  0.5932786464691162
generate_one_block  0.5988340377807617
generate_one_block  0.5739181041717529
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  15.588407516479492
block generation total time  13.766249656677246
average batch blocks generation time:  0.8603906035423279
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08993387222290039  GigaBytes
Max Memory Allocated: 0.08993387222290039  GigaBytes

torch.Size([154385, 128])
torch.Size([121874, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.24610376358032227  GigaBytes
Max Memory Allocated: 0.2538414001464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.09090900421142578  GigaBytes
Max Memory Allocated: 0.2674856185913086  GigaBytes

torch.Size([154720, 128])
torch.Size([122993, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.24661970138549805  GigaBytes
Max Memory Allocated: 0.2674856185913086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09086227416992188  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154206, 128])
torch.Size([122038, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24544382095336914  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09101676940917969  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154735, 128])
torch.Size([123255, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2467503547668457  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09075260162353516  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154463, 128])
torch.Size([122111, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24494504928588867  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09078121185302734  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154426, 128])
torch.Size([121841, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24497365951538086  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09082698822021484  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154721, 128])
torch.Size([122536, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24542474746704102  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09096050262451172  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154536, 128])
torch.Size([122713, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24621820449829102  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.0909872055053711  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154701, 128])
torch.Size([123099, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2469015121459961  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09085750579833984  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154780, 128])
torch.Size([122537, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24539422988891602  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09104442596435547  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154895, 128])
torch.Size([123497, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2476673126220703  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09085750579833984  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154687, 128])
torch.Size([122815, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24563074111938477  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.0908956527709961  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154476, 128])
torch.Size([122367, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24580144882202148  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09073829650878906  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154432, 128])
torch.Size([122288, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24477338790893555  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09087848663330078  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154795, 128])
torch.Size([122515, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24554109573364258  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09080886840820312  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154540, 128])
torch.Size([122041, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24527263641357422  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03421902656555176 |0.035422950983047485 |0.05003495514392853 |9.371340274810791e-05 |0.008865892887115479 |0.002046346664428711 |
----------------------------------------------------------pseudo_mini_loss sum 5.30940055847168
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5095900
Number of first layer input nodes during this epoch:  2473498
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.12379026412963867  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018201112747192383
random selection method range initialization spend 0.005410909652709961
time for parepare:  0.016745328903198242
local_output_nid generation:  0.0023915767669677734
local_in_edges_tensor generation:  0.004677772521972656
mini_batch_src_global generation:  0.0017476081848144531
r_  generation:  0.017437458038330078
local_output_nid generation:  0.002795696258544922
local_in_edges_tensor generation:  0.0016026496887207031
mini_batch_src_global generation:  0.002054452896118164
r_  generation:  0.017531156539916992
local_output_nid generation:  0.0028548240661621094
local_in_edges_tensor generation:  0.0014791488647460938
mini_batch_src_global generation:  0.0013396739959716797
r_  generation:  0.01820659637451172
local_output_nid generation:  0.0028600692749023438
local_in_edges_tensor generation:  0.0014886856079101562
mini_batch_src_global generation:  0.0013935565948486328
r_  generation:  0.017976760864257812
local_output_nid generation:  0.0027997493743896484
local_in_edges_tensor generation:  0.0013997554779052734
mini_batch_src_global generation:  0.0013415813446044922
r_  generation:  0.018198251724243164
local_output_nid generation:  0.002882242202758789
local_in_edges_tensor generation:  0.001453399658203125
mini_batch_src_global generation:  0.0014357566833496094
r_  generation:  0.019159793853759766
local_output_nid generation:  0.0028378963470458984
local_in_edges_tensor generation:  0.0014188289642333984
mini_batch_src_global generation:  0.001459360122680664
r_  generation:  0.01933121681213379
local_output_nid generation:  0.0028955936431884766
local_in_edges_tensor generation:  0.0014903545379638672
mini_batch_src_global generation:  0.0014328956604003906
r_  generation:  0.018346309661865234
local_output_nid generation:  0.002877950668334961
local_in_edges_tensor generation:  0.0014362335205078125
mini_batch_src_global generation:  0.0014393329620361328
r_  generation:  0.019105195999145508
local_output_nid generation:  0.0028870105743408203
local_in_edges_tensor generation:  0.0014617443084716797
mini_batch_src_global generation:  0.0014553070068359375
r_  generation:  0.019255638122558594
local_output_nid generation:  0.00286865234375
local_in_edges_tensor generation:  0.001397848129272461
mini_batch_src_global generation:  0.0014929771423339844
r_  generation:  0.019115447998046875
local_output_nid generation:  0.0028955936431884766
local_in_edges_tensor generation:  0.0014150142669677734
mini_batch_src_global generation:  0.0015451908111572266
r_  generation:  0.019382953643798828
local_output_nid generation:  0.002909421920776367
local_in_edges_tensor generation:  0.0014188289642333984
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.01878833770751953
local_output_nid generation:  0.002885103225708008
local_in_edges_tensor generation:  0.0014755725860595703
mini_batch_src_global generation:  0.0014526844024658203
r_  generation:  0.018814802169799805
local_output_nid generation:  0.0028257369995117188
local_in_edges_tensor generation:  0.0014035701751708984
mini_batch_src_global generation:  0.0014641284942626953
r_  generation:  0.019167661666870117
local_output_nid generation:  0.0027992725372314453
local_in_edges_tensor generation:  0.001405954360961914
mini_batch_src_global generation:  0.0015397071838378906
r_  generation:  0.019561767578125
----------------------check_connections_block total spend ----------------------------- 0.4906141757965088
generate_one_block  0.04215598106384277
generate_one_block  0.027179956436157227
generate_one_block  0.027521371841430664
generate_one_block  0.027155637741088867
generate_one_block  0.026917457580566406
generate_one_block  0.030508756637573242
generate_one_block  0.027739763259887695
generate_one_block  0.026690006256103516
generate_one_block  0.028188705444335938
generate_one_block  0.028073549270629883
generate_one_block  0.027786970138549805
generate_one_block  0.02833700180053711
generate_one_block  0.027141332626342773
generate_one_block  0.02732062339782715
generate_one_block  0.027826547622680664
generate_one_block  0.02877521514892578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035096168518066406
gen group dst list time:  0.017290353775024414
time for parepare:  0.018897294998168945
local_output_nid generation:  0.008086919784545898
local_in_edges_tensor generation:  0.019923686981201172
mini_batch_src_global generation:  0.019069194793701172
r_  generation:  0.18937468528747559
local_output_nid generation:  0.011716604232788086
local_in_edges_tensor generation:  0.02037835121154785
mini_batch_src_global generation:  0.023077964782714844
r_  generation:  0.19182825088500977
local_output_nid generation:  0.011649847030639648
local_in_edges_tensor generation:  0.015345573425292969
mini_batch_src_global generation:  0.02297520637512207
r_  generation:  0.20251202583312988
local_output_nid generation:  0.012151241302490234
local_in_edges_tensor generation:  0.018587589263916016
mini_batch_src_global generation:  0.023543119430541992
r_  generation:  0.19883513450622559
local_output_nid generation:  0.011763811111450195
local_in_edges_tensor generation:  0.013332605361938477
mini_batch_src_global generation:  0.024181604385375977
r_  generation:  0.19863343238830566
local_output_nid generation:  0.01205897331237793
local_in_edges_tensor generation:  0.017255783081054688
mini_batch_src_global generation:  0.02712392807006836
r_  generation:  0.2122206687927246
local_output_nid generation:  0.011762142181396484
local_in_edges_tensor generation:  0.017091035842895508
mini_batch_src_global generation:  0.02595233917236328
r_  generation:  0.20665836334228516
local_output_nid generation:  0.011635065078735352
local_in_edges_tensor generation:  0.013638019561767578
mini_batch_src_global generation:  0.02597951889038086
r_  generation:  0.2039787769317627
local_output_nid generation:  0.011840105056762695
local_in_edges_tensor generation:  0.017571449279785156
mini_batch_src_global generation:  0.0277402400970459
r_  generation:  0.21335816383361816
local_output_nid generation:  0.011772871017456055
local_in_edges_tensor generation:  0.01592540740966797
mini_batch_src_global generation:  0.028830289840698242
r_  generation:  0.2110424041748047
local_output_nid generation:  0.011704444885253906
local_in_edges_tensor generation:  0.01568293571472168
mini_batch_src_global generation:  0.029107093811035156
r_  generation:  0.2103407382965088
local_output_nid generation:  0.011895179748535156
local_in_edges_tensor generation:  0.01751995086669922
mini_batch_src_global generation:  0.027858257293701172
r_  generation:  0.21265530586242676
local_output_nid generation:  0.011588096618652344
local_in_edges_tensor generation:  0.014068841934204102
mini_batch_src_global generation:  0.026298999786376953
r_  generation:  0.20476675033569336
local_output_nid generation:  0.011596918106079102
local_in_edges_tensor generation:  0.013733148574829102
mini_batch_src_global generation:  0.025873899459838867
r_  generation:  0.20414042472839355
local_output_nid generation:  0.01160883903503418
local_in_edges_tensor generation:  0.015501737594604492
mini_batch_src_global generation:  0.026429176330566406
r_  generation:  0.21022534370422363
local_output_nid generation:  0.011831045150756836
local_in_edges_tensor generation:  0.01604914665222168
mini_batch_src_global generation:  0.02672410011291504
r_  generation:  0.2121880054473877
----------------------check_connections_block total spend ----------------------------- 4.880595684051514
generate_one_block  0.26902318000793457
generate_one_block  0.2529466152191162
generate_one_block  0.2642955780029297
generate_one_block  0.25902366638183594
generate_one_block  0.25798487663269043
generate_one_block  0.27399396896362305
generate_one_block  0.2861015796661377
generate_one_block  0.2614157199859619
generate_one_block  0.27144551277160645
generate_one_block  0.26996946334838867
generate_one_block  0.27002954483032227
generate_one_block  0.27207398414611816
generate_one_block  0.26193666458129883
generate_one_block  0.25991153717041016
generate_one_block  0.2677583694458008
generate_one_block  0.27072954177856445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036438941955566406
gen group dst list time:  0.05802297592163086
time for parepare:  0.017597198486328125
local_output_nid generation:  0.02573108673095703
local_in_edges_tensor generation:  0.0432281494140625
mini_batch_src_global generation:  0.0439150333404541
r_  generation:  0.43314051628112793
local_output_nid generation:  0.030767440795898438
local_in_edges_tensor generation:  0.04475855827331543
mini_batch_src_global generation:  0.04939985275268555
r_  generation:  0.437100887298584
local_output_nid generation:  0.030313491821289062
local_in_edges_tensor generation:  0.03709602355957031
mini_batch_src_global generation:  0.048491716384887695
r_  generation:  0.44112515449523926
local_output_nid generation:  0.030521869659423828
local_in_edges_tensor generation:  0.02990126609802246
mini_batch_src_global generation:  0.050624847412109375
r_  generation:  0.4406890869140625
local_output_nid generation:  0.030922889709472656
local_in_edges_tensor generation:  0.07330107688903809
mini_batch_src_global generation:  0.050035953521728516
r_  generation:  0.45392894744873047
local_output_nid generation:  0.030820608139038086
local_in_edges_tensor generation:  0.0375521183013916
mini_batch_src_global generation:  0.05145668983459473
r_  generation:  0.4473111629486084
local_output_nid generation:  0.030997276306152344
local_in_edges_tensor generation:  0.04154467582702637
mini_batch_src_global generation:  0.04984235763549805
r_  generation:  0.45101261138916016
local_output_nid generation:  0.03081989288330078
local_in_edges_tensor generation:  0.029500484466552734
mini_batch_src_global generation:  0.05213308334350586
r_  generation:  0.4461328983306885
local_output_nid generation:  0.03106689453125
local_in_edges_tensor generation:  0.03771495819091797
mini_batch_src_global generation:  0.05427694320678711
r_  generation:  0.45499682426452637
local_output_nid generation:  0.03100299835205078
local_in_edges_tensor generation:  0.038069963455200195
mini_batch_src_global generation:  0.05120515823364258
r_  generation:  0.44765305519104004
local_output_nid generation:  0.031155824661254883
local_in_edges_tensor generation:  0.029506206512451172
mini_batch_src_global generation:  0.05113363265991211
r_  generation:  0.4521749019622803
local_output_nid generation:  0.031114816665649414
local_in_edges_tensor generation:  0.033339500427246094
mini_batch_src_global generation:  0.05458641052246094
r_  generation:  0.4512763023376465
local_output_nid generation:  0.030766963958740234
local_in_edges_tensor generation:  0.03940296173095703
mini_batch_src_global generation:  0.050705909729003906
r_  generation:  0.4562695026397705
local_output_nid generation:  0.031050682067871094
local_in_edges_tensor generation:  0.029974699020385742
mini_batch_src_global generation:  0.052297353744506836
r_  generation:  0.44436097145080566
local_output_nid generation:  0.03136420249938965
local_in_edges_tensor generation:  0.03004741668701172
mini_batch_src_global generation:  0.0507662296295166
r_  generation:  0.45580625534057617
local_output_nid generation:  0.0312650203704834
local_in_edges_tensor generation:  0.04125642776489258
mini_batch_src_global generation:  0.05172395706176758
r_  generation:  0.4518759250640869
----------------------check_connections_block total spend ----------------------------- 10.626907348632812
generate_one_block  0.5619096755981445
generate_one_block  0.5595266819000244
generate_one_block  0.5646317005157471
generate_one_block  0.5688540935516357
generate_one_block  0.574364423751831
generate_one_block  0.5841882228851318
generate_one_block  0.5682666301727295
generate_one_block  0.5673937797546387
generate_one_block  0.610835075378418
generate_one_block  0.56536865234375
generate_one_block  0.5696542263031006
generate_one_block  0.5739865303039551
generate_one_block  0.5710570812225342
generate_one_block  0.5598092079162598
generate_one_block  0.5608718395233154
generate_one_block  0.5817010402679443
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.12379026412963867  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

connection checking time:  15.507503032684326
block generation total time  13.4110586643219
average batch blocks generation time:  0.8381911665201187
block dataloader generation time/epoch 30.96288561820984
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09116983413696289  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154493, 128])
torch.Size([122500, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24620532989501953  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09083747863769531  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154508, 128])
torch.Size([122204, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24478483200073242  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09102058410644531  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([153905, 128])
torch.Size([121334, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24526071548461914  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09092903137207031  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154351, 128])
torch.Size([121776, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2448291778564453  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.0909280776977539  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154591, 128])
torch.Size([122327, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24500751495361328  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09126472473144531  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154322, 128])
torch.Size([122776, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24684476852416992  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.0911245346069336  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154505, 128])
torch.Size([122550, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2462158203125  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09100818634033203  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154396, 128])
torch.Size([122321, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24509143829345703  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09125614166259766  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154616, 128])
torch.Size([123052, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2473607063293457  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09116172790527344  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154510, 128])
torch.Size([122402, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24623823165893555  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.0911712646484375  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154126, 128])
torch.Size([122115, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24595403671264648  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09122467041015625  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154588, 128])
torch.Size([122954, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24723386764526367  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09104728698730469  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154517, 128])
torch.Size([122486, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24538326263427734  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09091377258300781  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([153943, 128])
torch.Size([121318, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24490022659301758  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09112834930419922  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154335, 128])
torch.Size([121847, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24570798873901367  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09121227264404297  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

torch.Size([154476, 128])
torch.Size([122776, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24666500091552734  GigaBytes
Max Memory Allocated: 0.268618106842041  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033930838108062744 |0.010713547468185425 |0.003678068518638611 |8.983910083770752e-05 |0.004245653748512268 |0.001481771469116211 |
----------------------------------------------------------pseudo_mini_loss sum 4.090814590454102
Total (block generation + training)time/epoch 31.836632013320923
Training time/epoch 0.8735527992248535
Training time without block to device /epoch 0.7021360397338867
Training time without total dataloading part /epoch 0.1296987533569336
load block tensor time/epoch 0.5428934097290039
block to device time/epoch 0.1714167594909668
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5087679
Number of first layer input nodes during this epoch:  2470182
