Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648355635.8807156
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027909517288208008
random selection method range initialization spend 0.006533384323120117
time for parepare:  0.01856851577758789
local_output_nid generation:  0.0041768550872802734
local_in_edges_tensor generation:  0.006128072738647461
mini_batch_src_global generation:  0.0037195682525634766
r_  generation:  0.04142260551452637
local_output_nid generation:  0.005760908126831055
local_in_edges_tensor generation:  0.0032601356506347656
mini_batch_src_global generation:  0.004587411880493164
r_  generation:  0.04323744773864746
local_output_nid generation:  0.006075382232666016
local_in_edges_tensor generation:  0.0032546520233154297
mini_batch_src_global generation:  0.0031960010528564453
r_  generation:  0.0433351993560791
local_output_nid generation:  0.0060732364654541016
local_in_edges_tensor generation:  0.003121614456176758
mini_batch_src_global generation:  0.0035369396209716797
r_  generation:  0.04560589790344238
local_output_nid generation:  0.006093502044677734
local_in_edges_tensor generation:  0.0032777786254882812
mini_batch_src_global generation:  0.003667116165161133
r_  generation:  0.046186208724975586
local_output_nid generation:  0.006117820739746094
local_in_edges_tensor generation:  0.0031309127807617188
mini_batch_src_global generation:  0.003921031951904297
r_  generation:  0.046398162841796875
local_output_nid generation:  0.006124258041381836
local_in_edges_tensor generation:  0.003187417984008789
mini_batch_src_global generation:  0.0038726329803466797
r_  generation:  0.04613327980041504
local_output_nid generation:  0.0060672760009765625
local_in_edges_tensor generation:  0.0032570362091064453
mini_batch_src_global generation:  0.003867626190185547
r_  generation:  0.04624819755554199
----------------------check_connections_block total spend ----------------------------- 0.5670163631439209
generate_one_block  0.06211090087890625
generate_one_block  0.06238746643066406
generate_one_block  0.06068754196166992
generate_one_block  0.06144452095031738
generate_one_block  0.06551551818847656
generate_one_block  0.06254148483276367
generate_one_block  0.06120109558105469
generate_one_block  0.06157255172729492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038361310958862305
gen group dst list time:  0.016163349151611328
time for parepare:  0.019820213317871094
local_output_nid generation:  0.014706611633300781
local_in_edges_tensor generation:  0.03323864936828613
mini_batch_src_global generation:  0.030546188354492188
r_  generation:  0.31682491302490234
local_output_nid generation:  0.02350473403930664
local_in_edges_tensor generation:  0.0325164794921875
mini_batch_src_global generation:  0.038461923599243164
r_  generation:  0.3266744613647461
local_output_nid generation:  0.023340463638305664
local_in_edges_tensor generation:  0.023481369018554688
mini_batch_src_global generation:  0.03812718391418457
r_  generation:  0.3259584903717041
local_output_nid generation:  0.023432016372680664
local_in_edges_tensor generation:  0.026635408401489258
mini_batch_src_global generation:  0.03881430625915527
r_  generation:  0.333970308303833
local_output_nid generation:  0.023135662078857422
local_in_edges_tensor generation:  0.02521657943725586
mini_batch_src_global generation:  0.04020357131958008
r_  generation:  0.3341975212097168
local_output_nid generation:  0.023053646087646484
local_in_edges_tensor generation:  0.02662801742553711
mini_batch_src_global generation:  0.04297924041748047
r_  generation:  0.34076523780822754
local_output_nid generation:  0.02319645881652832
local_in_edges_tensor generation:  0.02124309539794922
mini_batch_src_global generation:  0.0405428409576416
r_  generation:  0.33505678176879883
local_output_nid generation:  0.023135662078857422
local_in_edges_tensor generation:  0.023221254348754883
mini_batch_src_global generation:  0.04035043716430664
r_  generation:  0.3368949890136719
----------------------check_connections_block total spend ----------------------------- 3.9456140995025635
generate_one_block  0.43764829635620117
generate_one_block  0.4455099105834961
generate_one_block  0.4242992401123047
generate_one_block  0.443878173828125
generate_one_block  0.4406459331512451
generate_one_block  0.4508523941040039
generate_one_block  0.43375587463378906
generate_one_block  0.4271056652069092
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03223752975463867
gen group dst list time:  0.035967111587524414
time for parepare:  0.022844552993774414
local_output_nid generation:  0.029008150100708008
local_in_edges_tensor generation:  0.044110774993896484
mini_batch_src_global generation:  0.04734659194946289
r_  generation:  0.47336602210998535
local_output_nid generation:  0.03816676139831543
local_in_edges_tensor generation:  0.05156421661376953
mini_batch_src_global generation:  0.05347585678100586
r_  generation:  0.4782376289367676
local_output_nid generation:  0.0386042594909668
local_in_edges_tensor generation:  0.042272329330444336
mini_batch_src_global generation:  0.050421953201293945
r_  generation:  0.49051427841186523
local_output_nid generation:  0.03884553909301758
local_in_edges_tensor generation:  0.035405874252319336
mini_batch_src_global generation:  0.05309343338012695
r_  generation:  0.48140549659729004
local_output_nid generation:  0.03912234306335449
local_in_edges_tensor generation:  0.04319047927856445
mini_batch_src_global generation:  0.05195808410644531
r_  generation:  0.49501538276672363
local_output_nid generation:  0.038733482360839844
local_in_edges_tensor generation:  0.04237842559814453
mini_batch_src_global generation:  0.05416154861450195
r_  generation:  0.49099016189575195
local_output_nid generation:  0.03868746757507324
local_in_edges_tensor generation:  0.03426384925842285
mini_batch_src_global generation:  0.05377197265625
r_  generation:  0.49695444107055664
local_output_nid generation:  0.03844928741455078
local_in_edges_tensor generation:  0.0335085391998291
mini_batch_src_global generation:  0.05492115020751953
r_  generation:  0.4877486228942871
----------------------check_connections_block total spend ----------------------------- 5.821483612060547
generate_one_block  0.6165778636932373
generate_one_block  0.6191496849060059
generate_one_block  0.6283876895904541
generate_one_block  0.6223266124725342
generate_one_block  0.6254687309265137
generate_one_block  0.6211128234863281
generate_one_block  0.637615442276001
generate_one_block  0.6155016422271729
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  9.76709771156311
block generation total time  8.489835977554321
average batch blocks generation time:  1.0612294971942902
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09733343124389648  GigaBytes
Max Memory Allocated: 0.09733343124389648  GigaBytes

torch.Size([160819, 128])
torch.Size([142857, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.3086519241333008  GigaBytes
Max Memory Allocated: 0.3216977119445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.09933757781982422  GigaBytes
Max Memory Allocated: 0.34340333938598633  GigaBytes

torch.Size([160749, 128])
torch.Size([142964, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.3087954521179199  GigaBytes
Max Memory Allocated: 0.34340333938598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.0992441177368164  GigaBytes
Max Memory Allocated: 0.34340333938598633  GigaBytes

torch.Size([160895, 128])
torch.Size([142711, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.30770301818847656  GigaBytes
Max Memory Allocated: 0.34340333938598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.09967803955078125  GigaBytes
Max Memory Allocated: 0.34340333938598633  GigaBytes

torch.Size([160896, 128])
torch.Size([143111, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.30877685546875  GigaBytes
Max Memory Allocated: 0.34340333938598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.09940528869628906  GigaBytes
Max Memory Allocated: 0.34340333938598633  GigaBytes

torch.Size([160895, 128])
torch.Size([142958, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.3084907531738281  GigaBytes
Max Memory Allocated: 0.34340333938598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09959268569946289  GigaBytes
Max Memory Allocated: 0.34340333938598633  GigaBytes

torch.Size([161014, 128])
torch.Size([143362, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.31227684020996094  GigaBytes
Max Memory Allocated: 0.34340333938598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09922504425048828  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

torch.Size([160820, 128])
torch.Size([142778, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30805158615112305  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09946823120117188  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

torch.Size([160910, 128])
torch.Size([142617, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3077993392944336  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038080066442489624 |0.048413246870040894 |0.09576120972633362 |9.849667549133301e-05 |0.012613385915756226 |0.0016036033630371094 |
----------------------------------------------------------pseudo_mini_loss sum 5.313289165496826
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3019545
Number of first layer input nodes during this epoch:  1286998
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.14194250106811523  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026682376861572266
random selection method range initialization spend 0.005217313766479492
time for parepare:  0.017634153366088867
local_output_nid generation:  0.0048220157623291016
local_in_edges_tensor generation:  0.009983062744140625
mini_batch_src_global generation:  0.0037300586700439453
r_  generation:  0.04119086265563965
local_output_nid generation:  0.006081104278564453
local_in_edges_tensor generation:  0.003179311752319336
mini_batch_src_global generation:  0.004777193069458008
r_  generation:  0.043003082275390625
local_output_nid generation:  0.0060880184173583984
local_in_edges_tensor generation:  0.003206014633178711
mini_batch_src_global generation:  0.0033004283905029297
r_  generation:  0.04536247253417969
local_output_nid generation:  0.0060482025146484375
local_in_edges_tensor generation:  0.0059070587158203125
mini_batch_src_global generation:  0.0034978389739990234
r_  generation:  0.045736074447631836
local_output_nid generation:  0.006078958511352539
local_in_edges_tensor generation:  0.003340482711791992
mini_batch_src_global generation:  0.0037322044372558594
r_  generation:  0.04752516746520996
local_output_nid generation:  0.0060803890228271484
local_in_edges_tensor generation:  0.003324270248413086
mini_batch_src_global generation:  0.004033327102661133
r_  generation:  0.04817533493041992
local_output_nid generation:  0.00614476203918457
local_in_edges_tensor generation:  0.003357410430908203
mini_batch_src_global generation:  0.003981590270996094
r_  generation:  0.047518014907836914
local_output_nid generation:  0.006194114685058594
local_in_edges_tensor generation:  0.003430604934692383
mini_batch_src_global generation:  0.004160165786743164
r_  generation:  0.04945778846740723
----------------------check_connections_block total spend ----------------------------- 0.5871951580047607
generate_one_block  0.06381726264953613
generate_one_block  0.061243295669555664
generate_one_block  0.06310176849365234
generate_one_block  0.06283688545227051
generate_one_block  0.06400609016418457
generate_one_block  0.06362271308898926
generate_one_block  0.06569695472717285
generate_one_block  0.06413865089416504
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035788774490356445
gen group dst list time:  0.016563892364501953
time for parepare:  0.018950700759887695
local_output_nid generation:  0.014564037322998047
local_in_edges_tensor generation:  0.035172462463378906
mini_batch_src_global generation:  0.03236532211303711
r_  generation:  0.3152439594268799
local_output_nid generation:  0.01996636390686035
local_in_edges_tensor generation:  0.030216217041015625
mini_batch_src_global generation:  0.03824925422668457
r_  generation:  0.32254838943481445
local_output_nid generation:  0.01946568489074707
local_in_edges_tensor generation:  0.028429031372070312
mini_batch_src_global generation:  0.0379638671875
r_  generation:  0.33638978004455566
local_output_nid generation:  0.01975417137145996
local_in_edges_tensor generation:  0.02663874626159668
mini_batch_src_global generation:  0.03949737548828125
r_  generation:  0.3388974666595459
local_output_nid generation:  0.019762277603149414
local_in_edges_tensor generation:  0.025185108184814453
mini_batch_src_global generation:  0.04057908058166504
r_  generation:  0.34192609786987305
local_output_nid generation:  0.019542217254638672
local_in_edges_tensor generation:  0.022387027740478516
mini_batch_src_global generation:  0.042406558990478516
r_  generation:  0.34134507179260254
local_output_nid generation:  0.02096104621887207
local_in_edges_tensor generation:  0.019162654876708984
mini_batch_src_global generation:  0.04027104377746582
r_  generation:  0.34189844131469727
local_output_nid generation:  0.01975536346435547
local_in_edges_tensor generation:  0.02201676368713379
mini_batch_src_global generation:  0.043363332748413086
r_  generation:  0.34458255767822266
----------------------check_connections_block total spend ----------------------------- 3.9481360912323
generate_one_block  0.4338493347167969
generate_one_block  0.4499056339263916
generate_one_block  0.4456450939178467
generate_one_block  0.4377615451812744
generate_one_block  0.46459460258483887
generate_one_block  0.44013285636901855
generate_one_block  0.4254434108734131
generate_one_block  0.4698188304901123
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037767887115478516
gen group dst list time:  0.03717207908630371
time for parepare:  0.01944136619567871
local_output_nid generation:  0.02950310707092285
local_in_edges_tensor generation:  0.05923819541931152
mini_batch_src_global generation:  0.0479884147644043
r_  generation:  0.47673964500427246
local_output_nid generation:  0.037110090255737305
local_in_edges_tensor generation:  0.055344343185424805
mini_batch_src_global generation:  0.05399060249328613
r_  generation:  0.5031957626342773
local_output_nid generation:  0.03912353515625
local_in_edges_tensor generation:  0.043847084045410156
mini_batch_src_global generation:  0.05432486534118652
r_  generation:  0.49243783950805664
local_output_nid generation:  0.036786794662475586
local_in_edges_tensor generation:  0.04030132293701172
mini_batch_src_global generation:  0.053421735763549805
r_  generation:  0.49037790298461914
local_output_nid generation:  0.03675389289855957
local_in_edges_tensor generation:  0.04331493377685547
mini_batch_src_global generation:  0.05222368240356445
r_  generation:  0.5004220008850098
local_output_nid generation:  0.03650999069213867
local_in_edges_tensor generation:  0.03354787826538086
mini_batch_src_global generation:  0.05424642562866211
r_  generation:  0.5096766948699951
local_output_nid generation:  0.0364072322845459
local_in_edges_tensor generation:  0.03300333023071289
mini_batch_src_global generation:  0.05285191535949707
r_  generation:  0.5033667087554932
local_output_nid generation:  0.03724193572998047
local_in_edges_tensor generation:  0.04661273956298828
mini_batch_src_global generation:  0.05761528015136719
r_  generation:  0.49727487564086914
----------------------check_connections_block total spend ----------------------------- 5.9394378662109375
generate_one_block  0.6185510158538818
generate_one_block  0.6084487438201904
generate_one_block  0.6162974834442139
generate_one_block  0.6273157596588135
generate_one_block  0.6275889873504639
generate_one_block  0.6038126945495605
generate_one_block  0.6139276027679443
generate_one_block  0.6403238773345947
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.14194250106811523  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

connection checking time:  9.887573957443237
block generation total time  8.523417472839355
average batch blocks generation time:  1.0654271841049194
block dataloader generation time/epoch 20.54795265197754
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09984874725341797  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

torch.Size([161063, 128])
torch.Size([143258, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3089313507080078  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.0994720458984375  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

torch.Size([160736, 128])
torch.Size([142305, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30738067626953125  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.10000228881835938  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

torch.Size([160878, 128])
torch.Size([143066, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3091001510620117  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09966611862182617  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

torch.Size([161053, 128])
torch.Size([143154, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3088812828063965  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09987735748291016  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

torch.Size([161042, 128])
torch.Size([142956, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30925512313842773  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09951305389404297  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

torch.Size([160646, 128])
torch.Size([142555, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30848121643066406  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09957742691040039  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

torch.Size([160937, 128])
torch.Size([142827, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30832719802856445  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09988975524902344  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

torch.Size([160892, 128])
torch.Size([142944, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30922460556030273  GigaBytes
Max Memory Allocated: 0.3470282554626465  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04042598605155945 |0.019929617643356323 |0.003702402114868164 |9.623169898986816e-05 |0.007097810506820679 |0.001707315444946289 |
----------------------------------------------------------pseudo_mini_loss sum 4.076166152954102
Total (block generation + training)time/epoch 21.14572548866272
Training time/epoch 0.5974698066711426
Training time without block to device /epoch 0.438032865524292
Training time without total dataloading part /epoch 0.08887887001037598
load block tensor time/epoch 0.3234078884124756
block to device time/epoch 0.15943694114685059
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3019446
Number of first layer input nodes during this epoch:  1287247
