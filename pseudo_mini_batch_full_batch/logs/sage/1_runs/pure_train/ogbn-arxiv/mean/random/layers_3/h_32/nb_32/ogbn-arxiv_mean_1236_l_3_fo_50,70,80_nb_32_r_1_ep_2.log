Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648354769.1618195
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02594161033630371
random selection method range initialization spend 0.005848407745361328
time for parepare:  0.019747495651245117
local_output_nid generation:  0.0011110305786132812
local_in_edges_tensor generation:  0.003160238265991211
mini_batch_src_global generation:  0.0016641616821289062
r_  generation:  0.011057376861572266
local_output_nid generation:  0.0014297962188720703
local_in_edges_tensor generation:  0.0009307861328125
mini_batch_src_global generation:  0.001619100570678711
r_  generation:  0.0094146728515625
local_output_nid generation:  0.0015113353729248047
local_in_edges_tensor generation:  0.0008900165557861328
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.009747743606567383
local_output_nid generation:  0.0014960765838623047
local_in_edges_tensor generation:  0.0008339881896972656
mini_batch_src_global generation:  0.0010347366333007812
r_  generation:  0.009200096130371094
local_output_nid generation:  0.0014772415161132812
local_in_edges_tensor generation:  0.000804901123046875
mini_batch_src_global generation:  0.001001119613647461
r_  generation:  0.009547948837280273
local_output_nid generation:  0.001462697982788086
local_in_edges_tensor generation:  0.0007927417755126953
mini_batch_src_global generation:  0.0010178089141845703
r_  generation:  0.009894132614135742
local_output_nid generation:  0.001470804214477539
local_in_edges_tensor generation:  0.0007877349853515625
mini_batch_src_global generation:  0.000997304916381836
r_  generation:  0.009639978408813477
local_output_nid generation:  0.0014653205871582031
local_in_edges_tensor generation:  0.0007710456848144531
mini_batch_src_global generation:  0.001001119613647461
r_  generation:  0.010000467300415039
local_output_nid generation:  0.0014700889587402344
local_in_edges_tensor generation:  0.0008144378662109375
mini_batch_src_global generation:  0.0010018348693847656
r_  generation:  0.009812355041503906
local_output_nid generation:  0.0014717578887939453
local_in_edges_tensor generation:  0.0007719993591308594
mini_batch_src_global generation:  0.0010492801666259766
r_  generation:  0.009778738021850586
local_output_nid generation:  0.0014736652374267578
local_in_edges_tensor generation:  0.000762939453125
mini_batch_src_global generation:  0.0010318756103515625
r_  generation:  0.010312557220458984
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.00079345703125
mini_batch_src_global generation:  0.0010738372802734375
r_  generation:  0.009982109069824219
local_output_nid generation:  0.0014617443084716797
local_in_edges_tensor generation:  0.0007729530334472656
mini_batch_src_global generation:  0.0010623931884765625
r_  generation:  0.009930133819580078
local_output_nid generation:  0.001466512680053711
local_in_edges_tensor generation:  0.0007760524749755859
mini_batch_src_global generation:  0.001033782958984375
r_  generation:  0.00993204116821289
local_output_nid generation:  0.0014624595642089844
local_in_edges_tensor generation:  0.00075531005859375
mini_batch_src_global generation:  0.00104522705078125
r_  generation:  0.010213613510131836
local_output_nid generation:  0.0015032291412353516
local_in_edges_tensor generation:  0.0007774829864501953
mini_batch_src_global generation:  0.0010182857513427734
r_  generation:  0.009563446044921875
local_output_nid generation:  0.0014672279357910156
local_in_edges_tensor generation:  0.0007610321044921875
mini_batch_src_global generation:  0.0010440349578857422
r_  generation:  0.009761333465576172
local_output_nid generation:  0.001455545425415039
local_in_edges_tensor generation:  0.0007760524749755859
mini_batch_src_global generation:  0.0010554790496826172
r_  generation:  0.010260581970214844
local_output_nid generation:  0.0014719963073730469
local_in_edges_tensor generation:  0.00077056884765625
mini_batch_src_global generation:  0.0010845661163330078
r_  generation:  0.0101470947265625
local_output_nid generation:  0.0014851093292236328
local_in_edges_tensor generation:  0.0007791519165039062
mini_batch_src_global generation:  0.0010654926300048828
r_  generation:  0.010143756866455078
local_output_nid generation:  0.0014879703521728516
local_in_edges_tensor generation:  0.0007798671722412109
mini_batch_src_global generation:  0.0010309219360351562
r_  generation:  0.009627103805541992
local_output_nid generation:  0.0014781951904296875
local_in_edges_tensor generation:  0.0007429122924804688
mini_batch_src_global generation:  0.0010504722595214844
r_  generation:  0.010201215744018555
local_output_nid generation:  0.0014634132385253906
local_in_edges_tensor generation:  0.0007510185241699219
mini_batch_src_global generation:  0.00102996826171875
r_  generation:  0.009956598281860352
local_output_nid generation:  0.0014758110046386719
local_in_edges_tensor generation:  0.0007882118225097656
mini_batch_src_global generation:  0.0011050701141357422
r_  generation:  0.010468244552612305
local_output_nid generation:  0.0014867782592773438
local_in_edges_tensor generation:  0.0007712841033935547
mini_batch_src_global generation:  0.0010743141174316406
r_  generation:  0.009869813919067383
local_output_nid generation:  0.0014693737030029297
local_in_edges_tensor generation:  0.0007605552673339844
mini_batch_src_global generation:  0.0010254383087158203
r_  generation:  0.00974583625793457
local_output_nid generation:  0.0014681816101074219
local_in_edges_tensor generation:  0.0007507801055908203
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.010126829147338867
local_output_nid generation:  0.0014805793762207031
local_in_edges_tensor generation:  0.0007736682891845703
mini_batch_src_global generation:  0.0010521411895751953
r_  generation:  0.010047197341918945
local_output_nid generation:  0.0014750957489013672
local_in_edges_tensor generation:  0.0007491111755371094
mini_batch_src_global generation:  0.0011057853698730469
r_  generation:  0.009822845458984375
local_output_nid generation:  0.0014674663543701172
local_in_edges_tensor generation:  0.005404472351074219
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.009595870971679688
local_output_nid generation:  0.0013382434844970703
local_in_edges_tensor generation:  0.0007865428924560547
mini_batch_src_global generation:  0.0011203289031982422
r_  generation:  0.009947061538696289
local_output_nid generation:  0.0013959407806396484
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.0010752677917480469
r_  generation:  0.00973963737487793
----------------------check_connections_block total spend ----------------------------- 0.5391726493835449
generate_one_block  0.01552581787109375
generate_one_block  0.014404535293579102
generate_one_block  0.015258073806762695
generate_one_block  0.014477729797363281
generate_one_block  0.014958381652832031
generate_one_block  0.015521764755249023
generate_one_block  0.014638185501098633
generate_one_block  0.014964580535888672
generate_one_block  0.014856815338134766
generate_one_block  0.01509404182434082
generate_one_block  0.01517796516418457
generate_one_block  0.01478719711303711
generate_one_block  0.014817476272583008
generate_one_block  0.014697551727294922
generate_one_block  0.014943122863769531
generate_one_block  0.014061927795410156
generate_one_block  0.01439976692199707
generate_one_block  0.01504826545715332
generate_one_block  0.014739751815795898
generate_one_block  0.015072345733642578
generate_one_block  0.014168977737426758
generate_one_block  0.01516103744506836
generate_one_block  0.014290094375610352
generate_one_block  0.015500068664550781
generate_one_block  0.014455080032348633
generate_one_block  0.014356613159179688
generate_one_block  0.01478433609008789
generate_one_block  0.014632225036621094
generate_one_block  0.014231681823730469
generate_one_block  0.013965845108032227
generate_one_block  0.014672279357910156
generate_one_block  0.014136314392089844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03940844535827637
gen group dst list time:  0.02376270294189453
time for parepare:  0.019238710403442383
local_output_nid generation:  0.005242824554443359
local_in_edges_tensor generation:  0.011662721633911133
mini_batch_src_global generation:  0.016745567321777344
r_  generation:  0.15909862518310547
local_output_nid generation:  0.00874638557434082
local_in_edges_tensor generation:  0.014464139938354492
mini_batch_src_global generation:  0.020444869995117188
r_  generation:  0.1615312099456787
local_output_nid generation:  0.008791685104370117
local_in_edges_tensor generation:  0.013454675674438477
mini_batch_src_global generation:  0.01990675926208496
r_  generation:  0.17644000053405762
local_output_nid generation:  0.008358001708984375
local_in_edges_tensor generation:  0.011642694473266602
mini_batch_src_global generation:  0.024407625198364258
r_  generation:  0.16899633407592773
local_output_nid generation:  0.008590459823608398
local_in_edges_tensor generation:  0.0103607177734375
mini_batch_src_global generation:  0.022592544555664062
r_  generation:  0.17682433128356934
local_output_nid generation:  0.008742570877075195
local_in_edges_tensor generation:  0.012445449829101562
mini_batch_src_global generation:  0.028979778289794922
r_  generation:  0.18537139892578125
local_output_nid generation:  0.008376598358154297
local_in_edges_tensor generation:  0.008908748626708984
mini_batch_src_global generation:  0.02205491065979004
r_  generation:  0.17617464065551758
local_output_nid generation:  0.008615732192993164
local_in_edges_tensor generation:  0.009422540664672852
mini_batch_src_global generation:  0.022726774215698242
r_  generation:  0.1813955307006836
local_output_nid generation:  0.008574724197387695
local_in_edges_tensor generation:  0.011972427368164062
mini_batch_src_global generation:  0.022301912307739258
r_  generation:  0.17958736419677734
local_output_nid generation:  0.008516311645507812
local_in_edges_tensor generation:  0.008843660354614258
mini_batch_src_global generation:  0.022036075592041016
r_  generation:  0.1808164119720459
local_output_nid generation:  0.00859522819519043
local_in_edges_tensor generation:  0.010462284088134766
mini_batch_src_global generation:  0.022914409637451172
r_  generation:  0.18560218811035156
local_output_nid generation:  0.008541345596313477
local_in_edges_tensor generation:  0.010457515716552734
mini_batch_src_global generation:  0.02273106575012207
r_  generation:  0.17653751373291016
local_output_nid generation:  0.008646249771118164
local_in_edges_tensor generation:  0.010482549667358398
mini_batch_src_global generation:  0.02411794662475586
r_  generation:  0.18230366706848145
local_output_nid generation:  0.00849151611328125
local_in_edges_tensor generation:  0.010426521301269531
mini_batch_src_global generation:  0.022951841354370117
r_  generation:  0.18180561065673828
local_output_nid generation:  0.008594989776611328
local_in_edges_tensor generation:  0.010365724563598633
mini_batch_src_global generation:  0.023115873336791992
r_  generation:  0.1818075180053711
local_output_nid generation:  0.008287906646728516
local_in_edges_tensor generation:  0.008613109588623047
mini_batch_src_global generation:  0.02230548858642578
r_  generation:  0.1734926700592041
local_output_nid generation:  0.00845026969909668
local_in_edges_tensor generation:  0.009908914566040039
mini_batch_src_global generation:  0.022359848022460938
r_  generation:  0.17817068099975586
local_output_nid generation:  0.008606433868408203
local_in_edges_tensor generation:  0.010413885116577148
mini_batch_src_global generation:  0.023296833038330078
r_  generation:  0.18805575370788574
local_output_nid generation:  0.00858926773071289
local_in_edges_tensor generation:  0.013349294662475586
mini_batch_src_global generation:  0.023053407669067383
r_  generation:  0.1819627285003662
local_output_nid generation:  0.008613109588623047
local_in_edges_tensor generation:  0.010334968566894531
mini_batch_src_global generation:  0.02472710609436035
r_  generation:  0.1842784881591797
local_output_nid generation:  0.008379697799682617
local_in_edges_tensor generation:  0.008575677871704102
mini_batch_src_global generation:  0.022174596786499023
r_  generation:  0.17542529106140137
local_output_nid generation:  0.00870060920715332
local_in_edges_tensor generation:  0.009163141250610352
mini_batch_src_global generation:  0.02418684959411621
r_  generation:  0.1820368766784668
local_output_nid generation:  0.008363008499145508
local_in_edges_tensor generation:  0.01016545295715332
mini_batch_src_global generation:  0.022295713424682617
r_  generation:  0.1760396957397461
local_output_nid generation:  0.00885772705078125
local_in_edges_tensor generation:  0.012399911880493164
mini_batch_src_global generation:  0.0235440731048584
r_  generation:  0.1915266513824463
local_output_nid generation:  0.008416414260864258
local_in_edges_tensor generation:  0.008917570114135742
mini_batch_src_global generation:  0.02245163917541504
r_  generation:  0.17919635772705078
local_output_nid generation:  0.00842428207397461
local_in_edges_tensor generation:  0.009762048721313477
mini_batch_src_global generation:  0.022782564163208008
r_  generation:  0.17684006690979004
local_output_nid generation:  0.008526086807250977
local_in_edges_tensor generation:  0.01197361946105957
mini_batch_src_global generation:  0.023842334747314453
r_  generation:  0.18073201179504395
local_output_nid generation:  0.008418798446655273
local_in_edges_tensor generation:  0.011702775955200195
mini_batch_src_global generation:  0.02262282371520996
r_  generation:  0.17961597442626953
local_output_nid generation:  0.008457422256469727
local_in_edges_tensor generation:  0.00883793830871582
mini_batch_src_global generation:  0.022510528564453125
r_  generation:  0.1771683692932129
local_output_nid generation:  0.008263349533081055
local_in_edges_tensor generation:  0.008388996124267578
mini_batch_src_global generation:  0.021979808807373047
r_  generation:  0.17446422576904297
local_output_nid generation:  0.008466958999633789
local_in_edges_tensor generation:  0.009915828704833984
mini_batch_src_global generation:  0.022072315216064453
r_  generation:  0.17999887466430664
local_output_nid generation:  0.008280754089355469
local_in_edges_tensor generation:  0.011351585388183594
mini_batch_src_global generation:  0.02228260040283203
r_  generation:  0.17316293716430664
----------------------check_connections_block total spend ----------------------------- 8.320928573608398
generate_one_block  0.22242474555969238
generate_one_block  0.22088098526000977
generate_one_block  0.2573282718658447
generate_one_block  0.22332358360290527
generate_one_block  0.22891473770141602
generate_one_block  0.2366962432861328
generate_one_block  0.22185349464416504
generate_one_block  0.2309703826904297
generate_one_block  0.22913050651550293
generate_one_block  0.22323966026306152
generate_one_block  0.23604059219360352
generate_one_block  0.2214033603668213
generate_one_block  0.23209214210510254
generate_one_block  0.23070716857910156
generate_one_block  0.22892117500305176
generate_one_block  0.23793816566467285
generate_one_block  0.21960687637329102
generate_one_block  0.2384333610534668
generate_one_block  0.2304999828338623
generate_one_block  0.23636794090270996
generate_one_block  0.21727752685546875
generate_one_block  0.22531723976135254
generate_one_block  0.22188329696655273
generate_one_block  0.24203896522521973
generate_one_block  0.22074317932128906
generate_one_block  0.22225570678710938
generate_one_block  0.23177361488342285
generate_one_block  0.22879815101623535
generate_one_block  0.22049212455749512
generate_one_block  0.21961498260498047
generate_one_block  0.22640037536621094
generate_one_block  0.2170088291168213
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05484890937805176
gen group dst list time:  0.10870122909545898
time for parepare:  0.020420551300048828
local_output_nid generation:  0.02314019203186035
local_in_edges_tensor generation:  0.055083513259887695
mini_batch_src_global generation:  0.05013561248779297
r_  generation:  0.47872138023376465
local_output_nid generation:  0.030089855194091797
local_in_edges_tensor generation:  0.04693794250488281
mini_batch_src_global generation:  0.05732536315917969
r_  generation:  0.4789416790008545
local_output_nid generation:  0.03008723258972168
local_in_edges_tensor generation:  0.04284811019897461
mini_batch_src_global generation:  0.055544137954711914
r_  generation:  0.49178385734558105
local_output_nid generation:  0.028197526931762695
local_in_edges_tensor generation:  0.0384368896484375
mini_batch_src_global generation:  0.05723834037780762
r_  generation:  0.4909975528717041
local_output_nid generation:  0.02822709083557129
local_in_edges_tensor generation:  0.03864598274230957
mini_batch_src_global generation:  0.06088685989379883
r_  generation:  0.5006136894226074
local_output_nid generation:  0.028775453567504883
local_in_edges_tensor generation:  0.041405677795410156
mini_batch_src_global generation:  0.06206393241882324
r_  generation:  0.49384188652038574
local_output_nid generation:  0.028319358825683594
local_in_edges_tensor generation:  0.02958822250366211
mini_batch_src_global generation:  0.058571577072143555
r_  generation:  0.5070309638977051
local_output_nid generation:  0.028682231903076172
local_in_edges_tensor generation:  0.03888082504272461
mini_batch_src_global generation:  0.060869455337524414
r_  generation:  0.4969167709350586
local_output_nid generation:  0.028775453567504883
local_in_edges_tensor generation:  0.03675484657287598
mini_batch_src_global generation:  0.05896639823913574
r_  generation:  0.49892687797546387
local_output_nid generation:  0.02869558334350586
local_in_edges_tensor generation:  0.0317387580871582
mini_batch_src_global generation:  0.059110164642333984
r_  generation:  0.49762988090515137
local_output_nid generation:  0.029204130172729492
local_in_edges_tensor generation:  0.029634714126586914
mini_batch_src_global generation:  0.05883598327636719
r_  generation:  0.5016157627105713
local_output_nid generation:  0.028835058212280273
local_in_edges_tensor generation:  0.03486371040344238
mini_batch_src_global generation:  0.05884718894958496
r_  generation:  0.5000360012054443
local_output_nid generation:  0.03130364418029785
local_in_edges_tensor generation:  0.03368639945983887
mini_batch_src_global generation:  0.06038808822631836
r_  generation:  0.5028035640716553
local_output_nid generation:  0.02923440933227539
local_in_edges_tensor generation:  0.03902149200439453
mini_batch_src_global generation:  0.059030771255493164
r_  generation:  0.49547624588012695
local_output_nid generation:  0.02873682975769043
local_in_edges_tensor generation:  0.0334928035736084
mini_batch_src_global generation:  0.058133840560913086
r_  generation:  0.5093252658843994
local_output_nid generation:  0.029009342193603516
local_in_edges_tensor generation:  0.029504060745239258
mini_batch_src_global generation:  0.05910372734069824
r_  generation:  0.49344372749328613
local_output_nid generation:  0.029221296310424805
local_in_edges_tensor generation:  0.03300762176513672
mini_batch_src_global generation:  0.058663129806518555
r_  generation:  0.4949767589569092
local_output_nid generation:  0.029207229614257812
local_in_edges_tensor generation:  0.03849291801452637
mini_batch_src_global generation:  0.059370994567871094
r_  generation:  0.49440932273864746
local_output_nid generation:  0.02895641326904297
local_in_edges_tensor generation:  0.04245114326477051
mini_batch_src_global generation:  0.058261871337890625
r_  generation:  0.5000176429748535
local_output_nid generation:  0.02891230583190918
local_in_edges_tensor generation:  0.03381967544555664
mini_batch_src_global generation:  0.06280517578125
r_  generation:  0.4955024719238281
local_output_nid generation:  0.02893352508544922
local_in_edges_tensor generation:  0.033209800720214844
mini_batch_src_global generation:  0.05792593955993652
r_  generation:  0.5034306049346924
local_output_nid generation:  0.0290677547454834
local_in_edges_tensor generation:  0.02918219566345215
mini_batch_src_global generation:  0.059505462646484375
r_  generation:  0.49958324432373047
local_output_nid generation:  0.028872251510620117
local_in_edges_tensor generation:  0.03845334053039551
mini_batch_src_global generation:  0.0581667423248291
r_  generation:  0.5008945465087891
local_output_nid generation:  0.031172513961791992
local_in_edges_tensor generation:  0.03369760513305664
mini_batch_src_global generation:  0.06285333633422852
r_  generation:  0.4985041618347168
local_output_nid generation:  0.028874635696411133
local_in_edges_tensor generation:  0.029287099838256836
mini_batch_src_global generation:  0.05785036087036133
r_  generation:  0.4974229335784912
local_output_nid generation:  0.028988122940063477
local_in_edges_tensor generation:  0.029393911361694336
mini_batch_src_global generation:  0.059328317642211914
r_  generation:  0.49570298194885254
local_output_nid generation:  0.028806209564208984
local_in_edges_tensor generation:  0.04335784912109375
mini_batch_src_global generation:  0.0575404167175293
r_  generation:  0.49831628799438477
local_output_nid generation:  0.029380321502685547
local_in_edges_tensor generation:  0.029703378677368164
mini_batch_src_global generation:  0.07427597045898438
r_  generation:  0.4916880130767822
local_output_nid generation:  0.031391143798828125
local_in_edges_tensor generation:  0.03227090835571289
mini_batch_src_global generation:  0.05934786796569824
r_  generation:  0.49832701683044434
local_output_nid generation:  0.028897762298583984
local_in_edges_tensor generation:  0.03783059120178223
mini_batch_src_global generation:  0.06197810173034668
r_  generation:  0.5015132427215576
local_output_nid generation:  0.02901911735534668
local_in_edges_tensor generation:  0.03865170478820801
mini_batch_src_global generation:  0.0582733154296875
r_  generation:  0.5010499954223633
local_output_nid generation:  0.028523683547973633
local_in_edges_tensor generation:  0.029226303100585938
mini_batch_src_global generation:  0.05999875068664551
r_  generation:  0.4946327209472656
----------------------check_connections_block total spend ----------------------------- 23.30490279197693
generate_one_block  0.7314236164093018
generate_one_block  0.6337413787841797
generate_one_block  0.6527020931243896
generate_one_block  0.6403565406799316
generate_one_block  0.6483287811279297
generate_one_block  0.6587257385253906
generate_one_block  0.6372747421264648
generate_one_block  0.6526238918304443
generate_one_block  0.6455531120300293
generate_one_block  0.6345810890197754
generate_one_block  0.6391518115997314
generate_one_block  0.626121997833252
generate_one_block  0.6516504287719727
generate_one_block  0.6490652561187744
generate_one_block  0.6293182373046875
generate_one_block  0.6281716823577881
generate_one_block  0.6308321952819824
generate_one_block  0.6499505043029785
generate_one_block  0.6467218399047852
generate_one_block  0.6637442111968994
generate_one_block  0.6438632011413574
generate_one_block  0.632331132888794
generate_one_block  0.6454122066497803
generate_one_block  0.6594662666320801
generate_one_block  0.6439979076385498
generate_one_block  0.6532952785491943
generate_one_block  0.6469211578369141
generate_one_block  0.6309804916381836
generate_one_block  0.6341812610626221
generate_one_block  0.6470139026641846
generate_one_block  0.6618149280548096
generate_one_block  0.6409125328063965
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  31.625831365585327
block generation total time  27.990606784820557
average batch blocks generation time:  0.8747064620256424
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08857965469360352  GigaBytes
Max Memory Allocated: 0.08857965469360352  GigaBytes

torch.Size([150263, 128])
torch.Size([109497, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.1641860008239746  GigaBytes
Max Memory Allocated: 0.16585826873779297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08881664276123047  GigaBytes
Max Memory Allocated: 0.18401384353637695  GigaBytes

torch.Size([150266, 128])
torch.Size([109083, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1631464958190918  GigaBytes
Max Memory Allocated: 0.18401384353637695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08927345275878906  GigaBytes
Max Memory Allocated: 0.18401384353637695  GigaBytes

torch.Size([150106, 128])
torch.Size([110018, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16492891311645508  GigaBytes
Max Memory Allocated: 0.18401384353637695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08896827697753906  GigaBytes
Max Memory Allocated: 0.1842794418334961  GigaBytes

torch.Size([149886, 128])
torch.Size([108753, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16421747207641602  GigaBytes
Max Memory Allocated: 0.1842794418334961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08911991119384766  GigaBytes
Max Memory Allocated: 0.1842794418334961  GigaBytes

torch.Size([150884, 128])
torch.Size([110216, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16501903533935547  GigaBytes
Max Memory Allocated: 0.1842794418334961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0893106460571289  GigaBytes
Max Memory Allocated: 0.18477392196655273  GigaBytes

torch.Size([150628, 128])
torch.Size([111537, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16691827774047852  GigaBytes
Max Memory Allocated: 0.18477392196655273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08902263641357422  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150573, 128])
torch.Size([109859, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16460847854614258  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08920001983642578  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150715, 128])
torch.Size([111209, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16539573669433594  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08911514282226562  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150619, 128])
torch.Size([110770, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16511869430541992  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08901119232177734  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150437, 128])
torch.Size([110264, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16491127014160156  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08916187286376953  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([149840, 128])
torch.Size([109588, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16458511352539062  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08897113800048828  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([149858, 128])
torch.Size([109003, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16437101364135742  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08914947509765625  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150406, 128])
torch.Size([110628, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16504478454589844  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.089111328125  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150414, 128])
torch.Size([109914, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16471338272094727  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08912277221679688  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([149722, 128])
torch.Size([109503, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1647019386291504  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08882904052734375  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150134, 128])
torch.Size([109308, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16296815872192383  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0889272689819336  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150276, 128])
torch.Size([109453, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16451263427734375  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08916854858398438  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150395, 128])
torch.Size([109929, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16468191146850586  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08906841278076172  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150232, 128])
torch.Size([109796, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16471004486083984  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08923816680908203  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150359, 128])
torch.Size([110167, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16493940353393555  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08889961242675781  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150480, 128])
torch.Size([109570, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1633129119873047  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08904361724853516  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([149903, 128])
torch.Size([109670, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16468095779418945  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08894538879394531  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([149916, 128])
torch.Size([109222, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16434383392333984  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08928966522216797  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150435, 128])
torch.Size([110490, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1651897430419922  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08893585205078125  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([149797, 128])
torch.Size([109261, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16437721252441406  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0889730453491211  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150960, 128])
torch.Size([110482, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16479969024658203  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08903026580810547  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150039, 128])
torch.Size([109482, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16456365585327148  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08896160125732422  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150162, 128])
torch.Size([109267, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16447162628173828  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0888824462890625  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([149811, 128])
torch.Size([108676, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16410064697265625  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08882522583007812  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([149796, 128])
torch.Size([108765, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16274690628051758  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08902931213378906  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150767, 128])
torch.Size([110593, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16492700576782227  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08875274658203125  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150059, 128])
torch.Size([108927, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1628561019897461  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029071740806102753 |0.02400410920381546 |0.027226537466049194 |9.022653102874756e-05 |0.005282312631607056 |0.0034279823303222656 |
----------------------------------------------------------pseudo_mini_loss sum 5.059546947479248
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9161467
Number of first layer input nodes during this epoch:  4808138
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.12311553955078125  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022568702697753906
random selection method range initialization spend 0.004838705062866211
time for parepare:  0.01715373992919922
local_output_nid generation:  0.0012531280517578125
local_in_edges_tensor generation:  0.005365133285522461
mini_batch_src_global generation:  0.0028009414672851562
r_  generation:  0.014049530029296875
local_output_nid generation:  0.0025734901428222656
local_in_edges_tensor generation:  0.0011878013610839844
mini_batch_src_global generation:  0.0016169548034667969
r_  generation:  0.009844779968261719
local_output_nid generation:  0.002352476119995117
local_in_edges_tensor generation:  0.0010211467742919922
mini_batch_src_global generation:  0.0011875629425048828
r_  generation:  0.025380849838256836
local_output_nid generation:  0.002103090286254883
local_in_edges_tensor generation:  0.0012664794921875
mini_batch_src_global generation:  0.0017459392547607422
r_  generation:  0.009631633758544922
local_output_nid generation:  0.0018420219421386719
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.0011124610900878906
r_  generation:  0.00955057144165039
local_output_nid generation:  0.0018494129180908203
local_in_edges_tensor generation:  0.0008695125579833984
mini_batch_src_global generation:  0.001062631607055664
r_  generation:  0.009783744812011719
local_output_nid generation:  0.0018134117126464844
local_in_edges_tensor generation:  0.0008249282836914062
mini_batch_src_global generation:  0.0010356903076171875
r_  generation:  0.009891748428344727
local_output_nid generation:  0.0018017292022705078
local_in_edges_tensor generation:  0.0008299350738525391
mini_batch_src_global generation:  0.0010423660278320312
r_  generation:  0.012623310089111328
local_output_nid generation:  0.001821279525756836
local_in_edges_tensor generation:  0.000820159912109375
mini_batch_src_global generation:  0.0010030269622802734
r_  generation:  0.00965428352355957
local_output_nid generation:  0.001790761947631836
local_in_edges_tensor generation:  0.0007932186126708984
mini_batch_src_global generation:  0.0009860992431640625
r_  generation:  0.009936094284057617
local_output_nid generation:  0.0018527507781982422
local_in_edges_tensor generation:  0.0008122920989990234
mini_batch_src_global generation:  0.0010132789611816406
r_  generation:  0.009988546371459961
local_output_nid generation:  0.0017881393432617188
local_in_edges_tensor generation:  0.0007872581481933594
mini_batch_src_global generation:  0.0010075569152832031
r_  generation:  0.010143041610717773
local_output_nid generation:  0.0017733573913574219
local_in_edges_tensor generation:  0.0007739067077636719
mini_batch_src_global generation:  0.0010440349578857422
r_  generation:  0.010263681411743164
local_output_nid generation:  0.0018024444580078125
local_in_edges_tensor generation:  0.0007774829864501953
mini_batch_src_global generation:  0.00101470947265625
r_  generation:  0.00987100601196289
local_output_nid generation:  0.0017910003662109375
local_in_edges_tensor generation:  0.0007693767547607422
mini_batch_src_global generation:  0.0010044574737548828
r_  generation:  0.012173175811767578
local_output_nid generation:  0.0018000602722167969
local_in_edges_tensor generation:  0.0007529258728027344
mini_batch_src_global generation:  0.0009989738464355469
r_  generation:  0.009944915771484375
local_output_nid generation:  0.0017824172973632812
local_in_edges_tensor generation:  0.0007569789886474609
mini_batch_src_global generation:  0.0009951591491699219
r_  generation:  0.01075291633605957
local_output_nid generation:  0.0018780231475830078
local_in_edges_tensor generation:  0.0007832050323486328
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.010223388671875
local_output_nid generation:  0.0018372535705566406
local_in_edges_tensor generation:  0.0007929801940917969
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.010749578475952148
local_output_nid generation:  0.0018620491027832031
local_in_edges_tensor generation:  0.0008111000061035156
mini_batch_src_global generation:  0.001089334487915039
r_  generation:  0.01021718978881836
local_output_nid generation:  0.0018100738525390625
local_in_edges_tensor generation:  0.0007529258728027344
mini_batch_src_global generation:  0.0010426044464111328
r_  generation:  0.01309347152709961
local_output_nid generation:  0.0018191337585449219
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.010200977325439453
local_output_nid generation:  0.0018301010131835938
local_in_edges_tensor generation:  0.0007717609405517578
mini_batch_src_global generation:  0.0010280609130859375
r_  generation:  0.010281085968017578
local_output_nid generation:  0.0017635822296142578
local_in_edges_tensor generation:  0.0007562637329101562
mini_batch_src_global generation:  0.0010175704956054688
r_  generation:  0.010319948196411133
local_output_nid generation:  0.0018298625946044922
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.0010368824005126953
r_  generation:  0.009868144989013672
local_output_nid generation:  0.001851797103881836
local_in_edges_tensor generation:  0.0007486343383789062
mini_batch_src_global generation:  0.0010428428649902344
r_  generation:  0.010091304779052734
local_output_nid generation:  0.0017962455749511719
local_in_edges_tensor generation:  0.0007498264312744141
mini_batch_src_global generation:  0.0010342597961425781
r_  generation:  0.010210275650024414
local_output_nid generation:  0.0018122196197509766
local_in_edges_tensor generation:  0.003458261489868164
mini_batch_src_global generation:  0.0010547637939453125
r_  generation:  0.010076284408569336
local_output_nid generation:  0.001817464828491211
local_in_edges_tensor generation:  0.000766754150390625
mini_batch_src_global generation:  0.0010645389556884766
r_  generation:  0.01018381118774414
local_output_nid generation:  0.0017876625061035156
local_in_edges_tensor generation:  0.0007467269897460938
mini_batch_src_global generation:  0.0011029243469238281
r_  generation:  0.010111331939697266
local_output_nid generation:  0.001811981201171875
local_in_edges_tensor generation:  0.0007617473602294922
mini_batch_src_global generation:  0.0010547637939453125
r_  generation:  0.010266304016113281
local_output_nid generation:  0.0018024444580078125
local_in_edges_tensor generation:  0.0007455348968505859
mini_batch_src_global generation:  0.0010247230529785156
r_  generation:  0.009740352630615234
----------------------check_connections_block total spend ----------------------------- 0.5903177261352539
generate_one_block  0.016072511672973633
generate_one_block  0.019610166549682617
generate_one_block  0.014647483825683594
generate_one_block  0.014861106872558594
generate_one_block  0.014813899993896484
generate_one_block  0.014822959899902344
generate_one_block  0.014862537384033203
generate_one_block  0.015066862106323242
generate_one_block  0.017088651657104492
generate_one_block  0.014601945877075195
generate_one_block  0.015215873718261719
generate_one_block  0.015187263488769531
generate_one_block  0.015244245529174805
generate_one_block  0.014693021774291992
generate_one_block  0.019384384155273438
generate_one_block  0.014561176300048828
generate_one_block  0.014820098876953125
generate_one_block  0.014582633972167969
generate_one_block  0.015379667282104492
generate_one_block  0.015148401260375977
generate_one_block  0.015487432479858398
generate_one_block  0.01987457275390625
generate_one_block  0.01611948013305664
generate_one_block  0.014786005020141602
generate_one_block  0.01473855972290039
generate_one_block  0.015153646469116211
generate_one_block  0.015335798263549805
generate_one_block  0.014847517013549805
generate_one_block  0.020280838012695312
generate_one_block  0.015007972717285156
generate_one_block  0.015141487121582031
generate_one_block  0.014278888702392578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04566073417663574
gen group dst list time:  0.02506089210510254
time for parepare:  0.01900029182434082
local_output_nid generation:  0.005545854568481445
local_in_edges_tensor generation:  0.02017974853515625
mini_batch_src_global generation:  0.017429113388061523
r_  generation:  0.16148161888122559
local_output_nid generation:  0.008143186569213867
local_in_edges_tensor generation:  0.016913175582885742
mini_batch_src_global generation:  0.019989728927612305
r_  generation:  0.15589690208435059
local_output_nid generation:  0.008152961730957031
local_in_edges_tensor generation:  0.03140544891357422
mini_batch_src_global generation:  0.01852250099182129
r_  generation:  0.16475820541381836
local_output_nid generation:  0.00838780403137207
local_in_edges_tensor generation:  0.008938074111938477
mini_batch_src_global generation:  0.0211944580078125
r_  generation:  0.1732025146484375
local_output_nid generation:  0.008335351943969727
local_in_edges_tensor generation:  0.011780500411987305
mini_batch_src_global generation:  0.021300315856933594
r_  generation:  0.18066167831420898
local_output_nid generation:  0.008124589920043945
local_in_edges_tensor generation:  0.012006998062133789
mini_batch_src_global generation:  0.02347540855407715
r_  generation:  0.1819629669189453
local_output_nid generation:  0.008091449737548828
local_in_edges_tensor generation:  0.010145187377929688
mini_batch_src_global generation:  0.02227044105529785
r_  generation:  0.1885998249053955
local_output_nid generation:  0.00812077522277832
local_in_edges_tensor generation:  0.008867740631103516
mini_batch_src_global generation:  0.022516965866088867
r_  generation:  0.1810317039489746
local_output_nid generation:  0.007915019989013672
local_in_edges_tensor generation:  0.008680582046508789
mini_batch_src_global generation:  0.021936893463134766
r_  generation:  0.17270874977111816
local_output_nid generation:  0.008331060409545898
local_in_edges_tensor generation:  0.011266469955444336
mini_batch_src_global generation:  0.03178882598876953
r_  generation:  0.176163911819458
local_output_nid generation:  0.008709907531738281
local_in_edges_tensor generation:  0.010179281234741211
mini_batch_src_global generation:  0.023859739303588867
r_  generation:  0.17975997924804688
local_output_nid generation:  0.008571386337280273
local_in_edges_tensor generation:  0.013144493103027344
mini_batch_src_global generation:  0.022811174392700195
r_  generation:  0.18199539184570312
local_output_nid generation:  0.008753776550292969
local_in_edges_tensor generation:  0.010423421859741211
mini_batch_src_global generation:  0.02342367172241211
r_  generation:  0.18895530700683594
local_output_nid generation:  0.008451461791992188
local_in_edges_tensor generation:  0.019654035568237305
mini_batch_src_global generation:  0.028040170669555664
r_  generation:  0.18950271606445312
local_output_nid generation:  0.011660337448120117
local_in_edges_tensor generation:  0.011538982391357422
mini_batch_src_global generation:  0.023449420928955078
r_  generation:  0.1803603172302246
local_output_nid generation:  0.008641719818115234
local_in_edges_tensor generation:  0.010185480117797852
mini_batch_src_global generation:  0.022629976272583008
r_  generation:  0.1770033836364746
local_output_nid generation:  0.008814334869384766
local_in_edges_tensor generation:  0.0102996826171875
mini_batch_src_global generation:  0.026543855667114258
r_  generation:  0.18106865882873535
local_output_nid generation:  0.008576393127441406
local_in_edges_tensor generation:  0.011676549911499023
mini_batch_src_global generation:  0.0443422794342041
r_  generation:  0.18147969245910645
local_output_nid generation:  0.008889436721801758
local_in_edges_tensor generation:  0.010745048522949219
mini_batch_src_global generation:  0.022924423217773438
r_  generation:  0.18085861206054688
local_output_nid generation:  0.008847475051879883
local_in_edges_tensor generation:  0.011859893798828125
mini_batch_src_global generation:  0.027420997619628906
r_  generation:  0.1791830062866211
local_output_nid generation:  0.008634567260742188
local_in_edges_tensor generation:  0.01102757453918457
mini_batch_src_global generation:  0.04573822021484375
r_  generation:  0.1858501434326172
local_output_nid generation:  0.008297204971313477
local_in_edges_tensor generation:  0.013642072677612305
mini_batch_src_global generation:  0.023484230041503906
r_  generation:  0.1857750415802002
local_output_nid generation:  0.009404659271240234
local_in_edges_tensor generation:  0.01638197898864746
mini_batch_src_global generation:  0.03452134132385254
r_  generation:  0.1816704273223877
local_output_nid generation:  0.009156227111816406
local_in_edges_tensor generation:  0.011299848556518555
mini_batch_src_global generation:  0.02257061004638672
r_  generation:  0.18249011039733887
local_output_nid generation:  0.008079051971435547
local_in_edges_tensor generation:  0.009047985076904297
mini_batch_src_global generation:  0.022246122360229492
r_  generation:  0.17553234100341797
local_output_nid generation:  0.008428096771240234
local_in_edges_tensor generation:  0.010549068450927734
mini_batch_src_global generation:  0.024254798889160156
r_  generation:  0.18447256088256836
local_output_nid generation:  0.008254051208496094
local_in_edges_tensor generation:  0.010395288467407227
mini_batch_src_global generation:  0.022783994674682617
r_  generation:  0.1802685260772705
local_output_nid generation:  0.008314847946166992
local_in_edges_tensor generation:  0.010241270065307617
mini_batch_src_global generation:  0.02465057373046875
r_  generation:  0.1811661720275879
local_output_nid generation:  0.00840449333190918
local_in_edges_tensor generation:  0.010456323623657227
mini_batch_src_global generation:  0.03725552558898926
r_  generation:  0.18479180335998535
local_output_nid generation:  0.008409976959228516
local_in_edges_tensor generation:  0.009168624877929688
mini_batch_src_global generation:  0.03075861930847168
r_  generation:  0.18199825286865234
local_output_nid generation:  0.008361577987670898
local_in_edges_tensor generation:  0.008891105651855469
mini_batch_src_global generation:  0.022609472274780273
r_  generation:  0.182722806930542
local_output_nid generation:  0.008224010467529297
local_in_edges_tensor generation:  0.008902311325073242
mini_batch_src_global generation:  0.022658348083496094
r_  generation:  0.17954301834106445
----------------------check_connections_block total spend ----------------------------- 8.524290084838867
generate_one_block  0.2432861328125
generate_one_block  0.21565890312194824
generate_one_block  0.21671819686889648
generate_one_block  0.22352170944213867
generate_one_block  0.2497551441192627
generate_one_block  0.23256826400756836
generate_one_block  0.22626805305480957
generate_one_block  0.23174047470092773
generate_one_block  0.21854448318481445
generate_one_block  0.22232437133789062
generate_one_block  0.22445392608642578
generate_one_block  0.23186159133911133
generate_one_block  0.24268388748168945
generate_one_block  0.2314891815185547
generate_one_block  0.22488784790039062
generate_one_block  0.22237229347229004
generate_one_block  0.22690916061401367
generate_one_block  0.22171974182128906
generate_one_block  0.22843408584594727
generate_one_block  0.26341891288757324
generate_one_block  0.23593568801879883
generate_one_block  0.23047804832458496
generate_one_block  0.23255133628845215
generate_one_block  0.23028945922851562
generate_one_block  0.2157444953918457
generate_one_block  0.23295855522155762
generate_one_block  0.22299647331237793
generate_one_block  0.25269246101379395
generate_one_block  0.2479405403137207
generate_one_block  0.22330832481384277
generate_one_block  0.22945380210876465
generate_one_block  0.22358059883117676
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05574369430541992
gen group dst list time:  0.10558557510375977
time for parepare:  0.01767730712890625
local_output_nid generation:  0.024070262908935547
local_in_edges_tensor generation:  0.056093454360961914
mini_batch_src_global generation:  0.05134892463684082
r_  generation:  0.4939448833465576
local_output_nid generation:  0.030437707901000977
local_in_edges_tensor generation:  0.054856061935424805
mini_batch_src_global generation:  0.06582379341125488
r_  generation:  0.49260902404785156
local_output_nid generation:  0.03339672088623047
local_in_edges_tensor generation:  0.04081892967224121
mini_batch_src_global generation:  0.05998086929321289
r_  generation:  0.48911309242248535
local_output_nid generation:  0.029599428176879883
local_in_edges_tensor generation:  0.04122328758239746
mini_batch_src_global generation:  0.05810904502868652
r_  generation:  0.4916067123413086
local_output_nid generation:  0.02978062629699707
local_in_edges_tensor generation:  0.03548622131347656
mini_batch_src_global generation:  0.05839848518371582
r_  generation:  0.5027990341186523
local_output_nid generation:  0.02921748161315918
local_in_edges_tensor generation:  0.03490138053894043
mini_batch_src_global generation:  0.0820462703704834
r_  generation:  0.5041251182556152
local_output_nid generation:  0.02944469451904297
local_in_edges_tensor generation:  0.034917593002319336
mini_batch_src_global generation:  0.058591365814208984
r_  generation:  0.5013372898101807
local_output_nid generation:  0.029690980911254883
local_in_edges_tensor generation:  0.0368494987487793
mini_batch_src_global generation:  0.0600895881652832
r_  generation:  0.5127553939819336
local_output_nid generation:  0.030923843383789062
local_in_edges_tensor generation:  0.05581188201904297
mini_batch_src_global generation:  0.07059621810913086
r_  generation:  0.5057873725891113
local_output_nid generation:  0.030521154403686523
local_in_edges_tensor generation:  0.03786826133728027
mini_batch_src_global generation:  0.05961751937866211
r_  generation:  0.4941067695617676
local_output_nid generation:  0.02984619140625
local_in_edges_tensor generation:  0.03743290901184082
mini_batch_src_global generation:  0.058173418045043945
r_  generation:  0.5025436878204346
local_output_nid generation:  0.02965569496154785
local_in_edges_tensor generation:  0.028266429901123047
mini_batch_src_global generation:  0.059395551681518555
r_  generation:  0.5063772201538086
local_output_nid generation:  0.02968287467956543
local_in_edges_tensor generation:  0.028351783752441406
mini_batch_src_global generation:  0.06181502342224121
r_  generation:  0.5038397312164307
local_output_nid generation:  0.02938985824584961
local_in_edges_tensor generation:  0.028403282165527344
mini_batch_src_global generation:  0.05973649024963379
r_  generation:  0.5057981014251709
local_output_nid generation:  0.029433727264404297
local_in_edges_tensor generation:  0.03728938102722168
mini_batch_src_global generation:  0.06182241439819336
r_  generation:  0.5066821575164795
local_output_nid generation:  0.02921438217163086
local_in_edges_tensor generation:  0.03992176055908203
mini_batch_src_global generation:  0.05949139595031738
r_  generation:  0.49736714363098145
local_output_nid generation:  0.029546260833740234
local_in_edges_tensor generation:  0.03732800483703613
mini_batch_src_global generation:  0.058068037033081055
r_  generation:  0.503345251083374
local_output_nid generation:  0.030277013778686523
local_in_edges_tensor generation:  0.03687238693237305
mini_batch_src_global generation:  0.06590771675109863
r_  generation:  0.5079259872436523
local_output_nid generation:  0.03114795684814453
local_in_edges_tensor generation:  0.03949236869812012
mini_batch_src_global generation:  0.06235218048095703
r_  generation:  0.49892735481262207
local_output_nid generation:  0.02946615219116211
local_in_edges_tensor generation:  0.029352664947509766
mini_batch_src_global generation:  0.061014652252197266
r_  generation:  0.4939453601837158
local_output_nid generation:  0.029473066329956055
local_in_edges_tensor generation:  0.03301358222961426
mini_batch_src_global generation:  0.06156778335571289
r_  generation:  0.5029520988464355
local_output_nid generation:  0.029691696166992188
local_in_edges_tensor generation:  0.03280758857727051
mini_batch_src_global generation:  0.05945134162902832
r_  generation:  0.5048909187316895
local_output_nid generation:  0.030211925506591797
local_in_edges_tensor generation:  0.032531023025512695
mini_batch_src_global generation:  0.05938410758972168
r_  generation:  0.5036375522613525
local_output_nid generation:  0.029559850692749023
local_in_edges_tensor generation:  0.03277420997619629
mini_batch_src_global generation:  0.05876588821411133
r_  generation:  0.5005717277526855
local_output_nid generation:  0.02931809425354004
local_in_edges_tensor generation:  0.028054237365722656
mini_batch_src_global generation:  0.05788016319274902
r_  generation:  0.510185956954956
local_output_nid generation:  0.029689550399780273
local_in_edges_tensor generation:  0.03712654113769531
mini_batch_src_global generation:  0.05974268913269043
r_  generation:  0.5022890567779541
local_output_nid generation:  0.030786991119384766
local_in_edges_tensor generation:  0.03263998031616211
mini_batch_src_global generation:  0.05863070487976074
r_  generation:  0.49883508682250977
local_output_nid generation:  0.029978513717651367
local_in_edges_tensor generation:  0.03722214698791504
mini_batch_src_global generation:  0.06104230880737305
r_  generation:  0.49778079986572266
local_output_nid generation:  0.02969217300415039
local_in_edges_tensor generation:  0.05164456367492676
mini_batch_src_global generation:  0.0624234676361084
r_  generation:  0.5059893131256104
local_output_nid generation:  0.02953624725341797
local_in_edges_tensor generation:  0.02803826332092285
mini_batch_src_global generation:  0.05878400802612305
r_  generation:  0.5021023750305176
local_output_nid generation:  0.03016829490661621
local_in_edges_tensor generation:  0.028270483016967773
mini_batch_src_global generation:  0.05847501754760742
r_  generation:  0.5002820491790771
local_output_nid generation:  0.029488086700439453
local_in_edges_tensor generation:  0.03517556190490723
mini_batch_src_global generation:  0.059668540954589844
r_  generation:  0.5031094551086426
----------------------check_connections_block total spend ----------------------------- 23.64790987968445
generate_one_block  0.66560959815979
generate_one_block  0.6493566036224365
generate_one_block  0.6739046573638916
generate_one_block  0.7058901786804199
generate_one_block  0.7826261520385742
generate_one_block  0.6689307689666748
generate_one_block  0.6890745162963867
generate_one_block  0.6519169807434082
generate_one_block  0.664365291595459
generate_one_block  0.6595149040222168
generate_one_block  0.6712958812713623
generate_one_block  0.6494338512420654
generate_one_block  0.6658616065979004
generate_one_block  0.6362514495849609
generate_one_block  0.6437675952911377
generate_one_block  0.6656653881072998
generate_one_block  0.6595427989959717
generate_one_block  0.6488628387451172
generate_one_block  0.6501376628875732
generate_one_block  0.6483426094055176
generate_one_block  0.6641075611114502
generate_one_block  0.6579430103302002
generate_one_block  0.6574468612670898
generate_one_block  0.6471056938171387
generate_one_block  0.6552560329437256
generate_one_block  0.6626245975494385
generate_one_block  0.6393990516662598
generate_one_block  0.6535444259643555
generate_one_block  0.6710131168365479
generate_one_block  0.6486499309539795
generate_one_block  0.6343700885772705
generate_one_block  0.6458842754364014
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.12311553955078125  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

connection checking time:  32.172199964523315
block generation total time  28.564242124557495
average batch blocks generation time:  0.8926325663924217
block dataloader generation time/epoch 63.51041507720947
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08924531936645508  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150091, 128])
torch.Size([110083, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16476917266845703  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08881092071533203  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([149799, 128])
torch.Size([108641, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16275596618652344  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08891010284423828  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150015, 128])
torch.Size([109389, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16318988800048828  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08910465240478516  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150638, 128])
torch.Size([110150, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.1649622917175293  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08920669555664062  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150222, 128])
torch.Size([109865, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16471433639526367  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08924388885498047  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150373, 128])
torch.Size([109999, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16483211517333984  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.0891866683959961  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150074, 128])
torch.Size([110177, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16488885879516602  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.0892791748046875  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([149819, 128])
torch.Size([110160, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.1649646759033203  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08904075622558594  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150209, 128])
torch.Size([109603, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.1645340919494629  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08905315399169922  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150327, 128])
torch.Size([109719, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16478490829467773  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.0891561508178711  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150656, 128])
torch.Size([110718, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.1652235984802246  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08919143676757812  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150261, 128])
torch.Size([109444, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16455411911010742  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08939647674560547  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150594, 128])
torch.Size([110374, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.1651444435119629  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.0890359878540039  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150037, 128])
torch.Size([109409, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16446399688720703  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08911800384521484  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150056, 128])
torch.Size([109780, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16465044021606445  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08904647827148438  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150100, 128])
torch.Size([109398, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16450119018554688  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.0891561508178711  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150332, 128])
torch.Size([109898, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.1648111343383789  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08905601501464844  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([149925, 128])
torch.Size([109221, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16440153121948242  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08915424346923828  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150322, 128])
torch.Size([110115, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16499090194702148  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08912944793701172  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150633, 128])
torch.Size([109640, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16475200653076172  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08934783935546875  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150204, 128])
torch.Size([110154, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16509485244750977  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08922290802001953  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150396, 128])
torch.Size([109948, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16486454010009766  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08914661407470703  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150584, 128])
torch.Size([109641, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16475582122802734  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08910655975341797  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150002, 128])
torch.Size([109392, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16451740264892578  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08890342712402344  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150051, 128])
torch.Size([108574, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16303682327270508  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08928203582763672  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150576, 128])
torch.Size([111212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16536283493041992  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08909988403320312  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150257, 128])
torch.Size([109720, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16466617584228516  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08918380737304688  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150516, 128])
torch.Size([110785, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16518688201904297  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08927154541015625  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150600, 128])
torch.Size([110642, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16522216796875  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08902263641357422  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150548, 128])
torch.Size([109588, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.1647205352783203  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08914566040039062  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150284, 128])
torch.Size([109497, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.1646432876586914  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.08904457092285156  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

torch.Size([150904, 128])
torch.Size([110393, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.16376924514770508  GigaBytes
Max Memory Allocated: 0.18558549880981445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0256485715508461 |0.01476549357175827 |0.0034719109535217285 |9.227544069290161e-05 |0.0038742125034332275 |0.0030317306518554688 |
----------------------------------------------------------pseudo_mini_loss sum 4.357451915740967
Total (block generation + training)time/epoch 65.08709239959717
Training time/epoch 1.5764079093933105
Training time without block to device /epoch 1.103912115097046
Training time without total dataloading part /epoch 0.24106049537658691
load block tensor time/epoch 0.8207542896270752
block to device time/epoch 0.47249579429626465
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9163899
Number of first layer input nodes during this epoch:  4809405
