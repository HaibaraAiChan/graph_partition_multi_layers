Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648353114.5546296
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024310827255249023
random selection method range initialization spend 0.006502628326416016
time for parepare:  0.01864147186279297
local_output_nid generation:  0.016200542449951172
local_in_edges_tensor generation:  0.014176607131958008
mini_batch_src_global generation:  0.013948202133178711
r_  generation:  0.17152094841003418
local_output_nid generation:  0.021952152252197266
local_in_edges_tensor generation:  0.015845775604248047
mini_batch_src_global generation:  0.017108917236328125
r_  generation:  0.1805586814880371
----------------------check_connections_block total spend ----------------------------- 0.5486986637115479
generate_one_block  0.20789027214050293
generate_one_block  0.2035365104675293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040723323822021484
gen group dst list time:  0.007288455963134766
time for parepare:  0.019684314727783203
local_output_nid generation:  0.025433778762817383
local_in_edges_tensor generation:  0.050318002700805664
mini_batch_src_global generation:  0.04828763008117676
r_  generation:  0.4882233142852783
local_output_nid generation:  0.035732269287109375
local_in_edges_tensor generation:  0.04754900932312012
mini_batch_src_global generation:  0.05448651313781738
r_  generation:  0.49230074882507324
----------------------check_connections_block total spend ----------------------------- 1.488666296005249
generate_one_block  0.6286971569061279
generate_one_block  0.638648271560669
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033057451248168945
gen group dst list time:  0.011634349822998047
time for parepare:  0.019517898559570312
local_output_nid generation:  0.03025531768798828
local_in_edges_tensor generation:  0.047844886779785156
mini_batch_src_global generation:  0.04626798629760742
r_  generation:  0.510737419128418
local_output_nid generation:  0.042465925216674805
local_in_edges_tensor generation:  0.05438089370727539
mini_batch_src_global generation:  0.055970191955566406
r_  generation:  0.5111570358276367
----------------------check_connections_block total spend ----------------------------- 1.5552923679351807
generate_one_block  0.6632025241851807
generate_one_block  0.6579277515411377
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  3.0439586639404297
block generation total time  2.5884757041931152
average batch blocks generation time:  1.2942378520965576
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.1073155403137207  GigaBytes
Max Memory Allocated: 0.1073155403137207  GigaBytes

torch.Size([166369, 128])
torch.Size([162644, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.28832530975341797  GigaBytes
Max Memory Allocated: 0.2951011657714844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.11366701126098633  GigaBytes
Max Memory Allocated: 0.31175804138183594  GigaBytes

torch.Size([166417, 128])
torch.Size([162680, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.2871713638305664  GigaBytes
Max Memory Allocated: 0.31175804138183594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03569352626800537 |0.15474164485931396 |0.3615220785140991 |0.00014519691467285156 |0.03377354145050049 |0.0038442611694335938 |
----------------------------------------------------------pseudo_mini_loss sum 4.950030326843262
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  927334
Number of first layer input nodes during this epoch:  332786
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.17179059982299805  GigaBytes
Max Memory Allocated: 0.31175804138183594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018028736114501953
random selection method range initialization spend 0.0060825347900390625
time for parepare:  0.01943182945251465
local_output_nid generation:  0.016170024871826172
local_in_edges_tensor generation:  0.014153718948364258
mini_batch_src_global generation:  0.012599706649780273
r_  generation:  0.17486047744750977
local_output_nid generation:  0.021573781967163086
local_in_edges_tensor generation:  0.015423297882080078
mini_batch_src_global generation:  0.028023719787597656
r_  generation:  0.18669891357421875
----------------------check_connections_block total spend ----------------------------- 0.5719401836395264
generate_one_block  0.2078392505645752
generate_one_block  0.2096691131591797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040235280990600586
gen group dst list time:  0.007567405700683594
time for parepare:  0.019316434860229492
local_output_nid generation:  0.027889490127563477
local_in_edges_tensor generation:  0.04713773727416992
mini_batch_src_global generation:  0.044773101806640625
r_  generation:  0.5236947536468506
local_output_nid generation:  0.03673863410949707
local_in_edges_tensor generation:  0.05974745750427246
mini_batch_src_global generation:  0.059154510498046875
r_  generation:  0.500361442565918
----------------------check_connections_block total spend ----------------------------- 1.5598881244659424
generate_one_block  0.6337456703186035
generate_one_block  0.6443259716033936
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04000425338745117
gen group dst list time:  0.012144088745117188
time for parepare:  0.01914072036743164
local_output_nid generation:  0.030088424682617188
local_in_edges_tensor generation:  0.08130931854248047
mini_batch_src_global generation:  0.049799442291259766
r_  generation:  0.5229027271270752
local_output_nid generation:  0.03698015213012695
local_in_edges_tensor generation:  0.05500388145446777
mini_batch_src_global generation:  0.0563504695892334
r_  generation:  0.5238611698150635
----------------------check_connections_block total spend ----------------------------- 1.630246639251709
generate_one_block  0.6921112537384033
generate_one_block  0.6651120185852051
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.17179059982299805  GigaBytes
Max Memory Allocated: 0.31175804138183594  GigaBytes

connection checking time:  3.1901347637176514
block generation total time  2.6352949142456055
average batch blocks generation time:  1.3176474571228027
block dataloader generation time/epoch 7.632468938827515
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.11501359939575195  GigaBytes
Max Memory Allocated: 0.31175804138183594  GigaBytes

torch.Size([166323, 128])
torch.Size([162485, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.2881007194519043  GigaBytes
Max Memory Allocated: 0.31175804138183594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.11502981185913086  GigaBytes
Max Memory Allocated: 0.3117847442626953  GigaBytes

torch.Size([166379, 128])
torch.Size([162558, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.28834104537963867  GigaBytes
Max Memory Allocated: 0.3117847442626953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04926156997680664 |0.02259838581085205 |0.004061460494995117 |0.0001112222671508789 |0.003841996192932129 |0.0015935897827148438 |
----------------------------------------------------------pseudo_mini_loss sum 4.263824939727783
Total (block generation + training)time/epoch 7.8255016803741455
Training time/epoch 0.1927473545074463
Training time without block to device /epoch 0.1475505828857422
Training time without total dataloading part /epoch 0.017622947692871094
load block tensor time/epoch 0.09852313995361328
block to device time/epoch 0.0451967716217041
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  926903
Number of first layer input nodes during this epoch:  332702
