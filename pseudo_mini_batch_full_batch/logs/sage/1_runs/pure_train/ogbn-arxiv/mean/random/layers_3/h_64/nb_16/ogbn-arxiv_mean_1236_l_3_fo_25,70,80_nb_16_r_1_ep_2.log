Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648356168.9168103
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027136802673339844
random selection method range initialization spend 0.0064280033111572266
time for parepare:  0.018827438354492188
local_output_nid generation:  0.0021288394927978516
local_in_edges_tensor generation:  0.0049245357513427734
mini_batch_src_global generation:  0.0019731521606445312
r_  generation:  0.02027750015258789
local_output_nid generation:  0.0025315284729003906
local_in_edges_tensor generation:  0.0017299652099609375
mini_batch_src_global generation:  0.0023016929626464844
r_  generation:  0.020102500915527344
local_output_nid generation:  0.002809762954711914
local_in_edges_tensor generation:  0.001678466796875
mini_batch_src_global generation:  0.0014514923095703125
r_  generation:  0.020377159118652344
local_output_nid generation:  0.002856731414794922
local_in_edges_tensor generation:  0.0016913414001464844
mini_batch_src_global generation:  0.0016007423400878906
r_  generation:  0.020067930221557617
local_output_nid generation:  0.002910614013671875
local_in_edges_tensor generation:  0.0015635490417480469
mini_batch_src_global generation:  0.0015482902526855469
r_  generation:  0.019649744033813477
local_output_nid generation:  0.002893209457397461
local_in_edges_tensor generation:  0.0015382766723632812
mini_batch_src_global generation:  0.0016629695892333984
r_  generation:  0.02026987075805664
local_output_nid generation:  0.0028738975524902344
local_in_edges_tensor generation:  0.0015382766723632812
mini_batch_src_global generation:  0.0016505718231201172
r_  generation:  0.020373106002807617
local_output_nid generation:  0.0028519630432128906
local_in_edges_tensor generation:  0.0015740394592285156
mini_batch_src_global generation:  0.0016884803771972656
r_  generation:  0.021500587463378906
local_output_nid generation:  0.0029549598693847656
local_in_edges_tensor generation:  0.0015797615051269531
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.022377967834472656
local_output_nid generation:  0.002930879592895508
local_in_edges_tensor generation:  0.0016160011291503906
mini_batch_src_global generation:  0.0016634464263916016
r_  generation:  0.021138668060302734
local_output_nid generation:  0.0029778480529785156
local_in_edges_tensor generation:  0.0015840530395507812
mini_batch_src_global generation:  0.0017211437225341797
r_  generation:  0.02193617820739746
local_output_nid generation:  0.0029370784759521484
local_in_edges_tensor generation:  0.0016295909881591797
mini_batch_src_global generation:  0.0017609596252441406
r_  generation:  0.021365642547607422
local_output_nid generation:  0.0029838085174560547
local_in_edges_tensor generation:  0.0015377998352050781
mini_batch_src_global generation:  0.0017781257629394531
r_  generation:  0.021778345108032227
local_output_nid generation:  0.0029861927032470703
local_in_edges_tensor generation:  0.0016009807586669922
mini_batch_src_global generation:  0.0016973018646240234
r_  generation:  0.02110147476196289
local_output_nid generation:  0.002901315689086914
local_in_edges_tensor generation:  0.0015716552734375
mini_batch_src_global generation:  0.0017366409301757812
r_  generation:  0.020857810974121094
local_output_nid generation:  0.002864837646484375
local_in_edges_tensor generation:  0.0016536712646484375
mini_batch_src_global generation:  0.0017361640930175781
r_  generation:  0.02138209342956543
----------------------check_connections_block total spend ----------------------------- 0.5400257110595703
generate_one_block  0.03134751319885254
generate_one_block  0.03179788589477539
generate_one_block  0.034168243408203125
generate_one_block  0.0312345027923584
generate_one_block  0.030369997024536133
generate_one_block  0.030282020568847656
generate_one_block  0.03118276596069336
generate_one_block  0.03160667419433594
generate_one_block  0.03159618377685547
generate_one_block  0.03043961524963379
generate_one_block  0.03172945976257324
generate_one_block  0.031160354614257812
generate_one_block  0.03146934509277344
generate_one_block  0.0304718017578125
generate_one_block  0.03079080581665039
generate_one_block  0.030642986297607422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04449462890625
gen group dst list time:  0.020351886749267578
time for parepare:  0.01954030990600586
local_output_nid generation:  0.009219169616699219
local_in_edges_tensor generation:  0.022804975509643555
mini_batch_src_global generation:  0.027051687240600586
r_  generation:  0.2508995532989502
local_output_nid generation:  0.016294240951538086
local_in_edges_tensor generation:  0.02418804168701172
mini_batch_src_global generation:  0.0318150520324707
r_  generation:  0.2550783157348633
local_output_nid generation:  0.016222476959228516
local_in_edges_tensor generation:  0.019516468048095703
mini_batch_src_global generation:  0.03079676628112793
r_  generation:  0.2608833312988281
local_output_nid generation:  0.015969038009643555
local_in_edges_tensor generation:  0.019496440887451172
mini_batch_src_global generation:  0.03519010543823242
r_  generation:  0.26784491539001465
local_output_nid generation:  0.016141414642333984
local_in_edges_tensor generation:  0.019269227981567383
mini_batch_src_global generation:  0.03263211250305176
r_  generation:  0.2605094909667969
local_output_nid generation:  0.015690088272094727
local_in_edges_tensor generation:  0.01685333251953125
mini_batch_src_global generation:  0.0328521728515625
r_  generation:  0.2613074779510498
local_output_nid generation:  0.01613903045654297
local_in_edges_tensor generation:  0.016669034957885742
mini_batch_src_global generation:  0.03325700759887695
r_  generation:  0.26549482345581055
local_output_nid generation:  0.016546964645385742
local_in_edges_tensor generation:  0.01959824562072754
mini_batch_src_global generation:  0.03584599494934082
r_  generation:  0.2709207534790039
local_output_nid generation:  0.016416549682617188
local_in_edges_tensor generation:  0.01432490348815918
mini_batch_src_global generation:  0.03444027900695801
r_  generation:  0.2728919982910156
local_output_nid generation:  0.016390562057495117
local_in_edges_tensor generation:  0.018306255340576172
mini_batch_src_global generation:  0.034186601638793945
r_  generation:  0.2696082592010498
local_output_nid generation:  0.01650857925415039
local_in_edges_tensor generation:  0.017606258392333984
mini_batch_src_global generation:  0.0345454216003418
r_  generation:  0.27421998977661133
local_output_nid generation:  0.016192197799682617
local_in_edges_tensor generation:  0.01973557472229004
mini_batch_src_global generation:  0.034246206283569336
r_  generation:  0.27759432792663574
local_output_nid generation:  0.016419649124145508
local_in_edges_tensor generation:  0.016685009002685547
mini_batch_src_global generation:  0.0343475341796875
r_  generation:  0.2686121463775635
local_output_nid generation:  0.016092300415039062
local_in_edges_tensor generation:  0.01667022705078125
mini_batch_src_global generation:  0.033600807189941406
r_  generation:  0.2699286937713623
local_output_nid generation:  0.015973567962646484
local_in_edges_tensor generation:  0.017179012298583984
mini_batch_src_global generation:  0.03564572334289551
r_  generation:  0.2684452533721924
local_output_nid generation:  0.016173124313354492
local_in_edges_tensor generation:  0.015061616897583008
mini_batch_src_global generation:  0.03424954414367676
r_  generation:  0.26740503311157227
----------------------check_connections_block total spend ----------------------------- 6.276956081390381
generate_one_block  0.3582570552825928
generate_one_block  0.36329078674316406
generate_one_block  0.3626878261566162
generate_one_block  0.36882877349853516
generate_one_block  0.3604702949523926
generate_one_block  0.3553767204284668
generate_one_block  0.3546900749206543
generate_one_block  0.3634819984436035
generate_one_block  0.36707162857055664
generate_one_block  0.34662961959838867
generate_one_block  0.3741762638092041
generate_one_block  0.35865211486816406
generate_one_block  0.36545610427856445
generate_one_block  0.38028478622436523
generate_one_block  0.3693807125091553
generate_one_block  0.358595609664917
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.055689334869384766
gen group dst list time:  0.07451462745666504
time for parepare:  0.021108150482177734
local_output_nid generation:  0.028676509857177734
local_in_edges_tensor generation:  0.06563210487365723
mini_batch_src_global generation:  0.04336881637573242
r_  generation:  0.4522857666015625
local_output_nid generation:  0.03285527229309082
local_in_edges_tensor generation:  0.048758745193481445
mini_batch_src_global generation:  0.05795145034790039
r_  generation:  0.48029303550720215
local_output_nid generation:  0.032137393951416016
local_in_edges_tensor generation:  0.05027174949645996
mini_batch_src_global generation:  0.05399656295776367
r_  generation:  0.5030035972595215
local_output_nid generation:  0.0367887020111084
local_in_edges_tensor generation:  0.047519683837890625
mini_batch_src_global generation:  0.05654287338256836
r_  generation:  0.500075101852417
local_output_nid generation:  0.03768587112426758
local_in_edges_tensor generation:  0.05126357078552246
mini_batch_src_global generation:  0.0604856014251709
r_  generation:  0.49592065811157227
local_output_nid generation:  0.0341799259185791
local_in_edges_tensor generation:  0.03583526611328125
mini_batch_src_global generation:  0.06267213821411133
r_  generation:  0.5031213760375977
local_output_nid generation:  0.036614418029785156
local_in_edges_tensor generation:  0.05389237403869629
mini_batch_src_global generation:  0.06702876091003418
r_  generation:  0.4839808940887451
local_output_nid generation:  0.03352522850036621
local_in_edges_tensor generation:  0.03918266296386719
mini_batch_src_global generation:  0.0685431957244873
r_  generation:  0.4888336658477783
local_output_nid generation:  0.03472614288330078
local_in_edges_tensor generation:  0.04354119300842285
mini_batch_src_global generation:  0.05559396743774414
r_  generation:  0.5091755390167236
local_output_nid generation:  0.035738229751586914
local_in_edges_tensor generation:  0.04143548011779785
mini_batch_src_global generation:  0.059801578521728516
r_  generation:  0.4988276958465576
local_output_nid generation:  0.033312082290649414
local_in_edges_tensor generation:  0.03736257553100586
mini_batch_src_global generation:  0.06090402603149414
r_  generation:  0.4878041744232178
local_output_nid generation:  0.03456258773803711
local_in_edges_tensor generation:  0.04192709922790527
mini_batch_src_global generation:  0.0574185848236084
r_  generation:  0.5052640438079834
local_output_nid generation:  0.03562760353088379
local_in_edges_tensor generation:  0.04038119316101074
mini_batch_src_global generation:  0.06421780586242676
r_  generation:  0.4804496765136719
local_output_nid generation:  0.03321957588195801
local_in_edges_tensor generation:  0.036246538162231445
mini_batch_src_global generation:  0.057286977767944336
r_  generation:  0.4784114360809326
local_output_nid generation:  0.033568382263183594
local_in_edges_tensor generation:  0.03434610366821289
mini_batch_src_global generation:  0.05865979194641113
r_  generation:  0.48320794105529785
local_output_nid generation:  0.03319954872131348
local_in_edges_tensor generation:  0.034621477127075195
mini_batch_src_global generation:  0.05617523193359375
r_  generation:  0.48737001419067383
----------------------check_connections_block total spend ----------------------------- 11.79634952545166
generate_one_block  0.6151976585388184
generate_one_block  0.608349084854126
generate_one_block  0.6210846900939941
generate_one_block  0.6279580593109131
generate_one_block  0.6021418571472168
generate_one_block  0.6046600341796875
generate_one_block  0.6751389503479004
generate_one_block  0.6178431510925293
generate_one_block  0.6098556518554688
generate_one_block  0.613682746887207
generate_one_block  0.6313660144805908
generate_one_block  0.6160495281219482
generate_one_block  0.5870304107666016
generate_one_block  0.5911962985992432
generate_one_block  0.5964303016662598
generate_one_block  0.6028497219085693
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  18.07330560684204
block generation total time  15.628164529800415
average batch blocks generation time:  0.9767602831125259
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09263896942138672  GigaBytes
Max Memory Allocated: 0.09263896942138672  GigaBytes

torch.Size([156685, 128])
torch.Size([129329, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.26312828063964844  GigaBytes
Max Memory Allocated: 0.27264881134033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09448528289794922  GigaBytes
Max Memory Allocated: 0.2863492965698242  GigaBytes

torch.Size([156932, 128])
torch.Size([130546, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26435184478759766  GigaBytes
Max Memory Allocated: 0.2863492965698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09432792663574219  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

torch.Size([156492, 128])
torch.Size([129576, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26397275924682617  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0946207046508789  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

torch.Size([157010, 128])
torch.Size([130472, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26418495178222656  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09429359436035156  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

torch.Size([156834, 128])
torch.Size([129688, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2626481056213379  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09425163269042969  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

torch.Size([156716, 128])
torch.Size([129475, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2623610496520996  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09440851211547852  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

torch.Size([156923, 128])
torch.Size([130002, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2635054588317871  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0944967269897461  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

torch.Size([156780, 128])
torch.Size([129943, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2642970085144043  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09455108642578125  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

torch.Size([156902, 128])
torch.Size([130541, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26433420181274414  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0944986343383789  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

torch.Size([157116, 128])
torch.Size([130017, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26347875595092773  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0947427749633789  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

torch.Size([157126, 128])
torch.Size([130968, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2652568817138672  GigaBytes
Max Memory Allocated: 0.28678035736083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09446907043457031  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156968, 128])
torch.Size([130369, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26378917694091797  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0944209098815918  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156779, 128])
torch.Size([129978, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26381397247314453  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09431123733520508  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156805, 128])
torch.Size([129977, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2624959945678711  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09443140029907227  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156941, 128])
torch.Size([129749, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2633843421936035  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09433937072753906  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156796, 128])
torch.Size([129557, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2627739906311035  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03162392973899841 |0.03767818212509155 |0.05051325261592865 |0.00010123848915100098 |0.00939592719078064 |0.0016715526580810547 |
----------------------------------------------------------pseudo_mini_loss sum 5.338532447814941
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5321010
Number of first layer input nodes during this epoch:  2509805
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.13268327713012695  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021088838577270508
random selection method range initialization spend 0.005520820617675781
time for parepare:  0.018059492111206055
local_output_nid generation:  0.0023801326751708984
local_in_edges_tensor generation:  0.004681110382080078
mini_batch_src_global generation:  0.001995086669921875
r_  generation:  0.020499706268310547
local_output_nid generation:  0.002828359603881836
local_in_edges_tensor generation:  0.0017635822296142578
mini_batch_src_global generation:  0.002370119094848633
r_  generation:  0.019837379455566406
local_output_nid generation:  0.0029075145721435547
local_in_edges_tensor generation:  0.0016658306121826172
mini_batch_src_global generation:  0.0015380382537841797
r_  generation:  0.02092432975769043
local_output_nid generation:  0.002956390380859375
local_in_edges_tensor generation:  0.0016584396362304688
mini_batch_src_global generation:  0.0015802383422851562
r_  generation:  0.020632028579711914
local_output_nid generation:  0.0029413700103759766
local_in_edges_tensor generation:  0.001611471176147461
mini_batch_src_global generation:  0.0015895366668701172
r_  generation:  0.020628929138183594
local_output_nid generation:  0.0028662681579589844
local_in_edges_tensor generation:  0.0015826225280761719
mini_batch_src_global generation:  0.0016951560974121094
r_  generation:  0.0224301815032959
local_output_nid generation:  0.002870798110961914
local_in_edges_tensor generation:  0.0016667842864990234
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.022317171096801758
local_output_nid generation:  0.002917766571044922
local_in_edges_tensor generation:  0.0016362667083740234
mini_batch_src_global generation:  0.0017511844635009766
r_  generation:  0.021601438522338867
local_output_nid generation:  0.0029449462890625
local_in_edges_tensor generation:  0.001630544662475586
mini_batch_src_global generation:  0.0017704963684082031
r_  generation:  0.02211737632751465
local_output_nid generation:  0.0029227733612060547
local_in_edges_tensor generation:  0.0016689300537109375
mini_batch_src_global generation:  0.0017440319061279297
r_  generation:  0.022400617599487305
local_output_nid generation:  0.003046751022338867
local_in_edges_tensor generation:  0.001661062240600586
mini_batch_src_global generation:  0.0017995834350585938
r_  generation:  0.02245640754699707
local_output_nid generation:  0.0029485225677490234
local_in_edges_tensor generation:  0.0016238689422607422
mini_batch_src_global generation:  0.0018248558044433594
r_  generation:  0.02219414710998535
local_output_nid generation:  0.0029218196868896484
local_in_edges_tensor generation:  0.0016362667083740234
mini_batch_src_global generation:  0.0017962455749511719
r_  generation:  0.02183055877685547
local_output_nid generation:  0.0029134750366210938
local_in_edges_tensor generation:  0.0015926361083984375
mini_batch_src_global generation:  0.0017657279968261719
r_  generation:  0.021965742111206055
local_output_nid generation:  0.0029511451721191406
local_in_edges_tensor generation:  0.0015687942504882812
mini_batch_src_global generation:  0.0018537044525146484
r_  generation:  0.022010087966918945
local_output_nid generation:  0.002957582473754883
local_in_edges_tensor generation:  0.0016851425170898438
mini_batch_src_global generation:  0.0018761157989501953
r_  generation:  0.022750139236450195
----------------------check_connections_block total spend ----------------------------- 0.556621789932251
generate_one_block  0.033969879150390625
generate_one_block  0.029979467391967773
generate_one_block  0.03076457977294922
generate_one_block  0.030524015426635742
generate_one_block  0.030463218688964844
generate_one_block  0.03525662422180176
generate_one_block  0.03197884559631348
generate_one_block  0.030593156814575195
generate_one_block  0.032164573669433594
generate_one_block  0.03209877014160156
generate_one_block  0.0315709114074707
generate_one_block  0.03152632713317871
generate_one_block  0.03093099594116211
generate_one_block  0.030934810638427734
generate_one_block  0.032219648361206055
generate_one_block  0.0331273078918457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03728437423706055
gen group dst list time:  0.019190311431884766
time for parepare:  0.018851041793823242
local_output_nid generation:  0.00927877426147461
local_in_edges_tensor generation:  0.022219181060791016
mini_batch_src_global generation:  0.02520918846130371
r_  generation:  0.25372743606567383
local_output_nid generation:  0.013251304626464844
local_in_edges_tensor generation:  0.023293495178222656
mini_batch_src_global generation:  0.031086206436157227
r_  generation:  0.24520254135131836
local_output_nid generation:  0.013455629348754883
local_in_edges_tensor generation:  0.021481990814208984
mini_batch_src_global generation:  0.030183792114257812
r_  generation:  0.25829291343688965
local_output_nid generation:  0.013622283935546875
local_in_edges_tensor generation:  0.01620936393737793
mini_batch_src_global generation:  0.031511545181274414
r_  generation:  0.2599468231201172
local_output_nid generation:  0.013145685195922852
local_in_edges_tensor generation:  0.014666318893432617
mini_batch_src_global generation:  0.034262895584106445
r_  generation:  0.2646951675415039
local_output_nid generation:  0.013738155364990234
local_in_edges_tensor generation:  0.019850730895996094
mini_batch_src_global generation:  0.03423309326171875
r_  generation:  0.28378891944885254
local_output_nid generation:  0.013253211975097656
local_in_edges_tensor generation:  0.019642114639282227
mini_batch_src_global generation:  0.03375506401062012
r_  generation:  0.2732391357421875
local_output_nid generation:  0.012902259826660156
local_in_edges_tensor generation:  0.014178991317749023
mini_batch_src_global generation:  0.033913612365722656
r_  generation:  0.2700233459472656
local_output_nid generation:  0.013335466384887695
local_in_edges_tensor generation:  0.0187222957611084
mini_batch_src_global generation:  0.03451395034790039
r_  generation:  0.2826852798461914
local_output_nid generation:  0.01330423355102539
local_in_edges_tensor generation:  0.019221067428588867
mini_batch_src_global generation:  0.03408503532409668
r_  generation:  0.278123140335083
local_output_nid generation:  0.013059139251708984
local_in_edges_tensor generation:  0.014817237854003906
mini_batch_src_global generation:  0.036528587341308594
r_  generation:  0.28174781799316406
local_output_nid generation:  0.013314485549926758
local_in_edges_tensor generation:  0.014425277709960938
mini_batch_src_global generation:  0.03474068641662598
r_  generation:  0.2777693271636963
local_output_nid generation:  0.014384984970092773
local_in_edges_tensor generation:  0.01694798469543457
mini_batch_src_global generation:  0.03615069389343262
r_  generation:  0.27846622467041016
local_output_nid generation:  0.01905989646911621
local_in_edges_tensor generation:  0.026645183563232422
mini_batch_src_global generation:  0.045805931091308594
r_  generation:  0.26832032203674316
local_output_nid generation:  0.014735698699951172
local_in_edges_tensor generation:  0.021265745162963867
mini_batch_src_global generation:  0.03473949432373047
r_  generation:  0.276247501373291
local_output_nid generation:  0.01355433464050293
local_in_edges_tensor generation:  0.02177262306213379
mini_batch_src_global generation:  0.03486275672912598
r_  generation:  0.27862048149108887
----------------------check_connections_block total spend ----------------------------- 6.342226505279541
generate_one_block  0.3645894527435303
generate_one_block  0.3380246162414551
generate_one_block  0.34973692893981934
generate_one_block  0.3424875736236572
generate_one_block  0.3437776565551758
generate_one_block  0.37367773056030273
generate_one_block  0.3777918815612793
generate_one_block  0.3462653160095215
generate_one_block  0.3557868003845215
generate_one_block  0.3495638370513916
generate_one_block  0.35696864128112793
generate_one_block  0.35002613067626953
generate_one_block  0.3663160800933838
generate_one_block  0.34232020378112793
generate_one_block  0.377044677734375
generate_one_block  0.3771655559539795
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.043801307678222656
gen group dst list time:  0.0738832950592041
time for parepare:  0.019696712493896484
local_output_nid generation:  0.02771592140197754
local_in_edges_tensor generation:  0.06054115295410156
mini_batch_src_global generation:  0.04281949996948242
r_  generation:  0.4526700973510742
local_output_nid generation:  0.03251385688781738
local_in_edges_tensor generation:  0.049546003341674805
mini_batch_src_global generation:  0.05283212661743164
r_  generation:  0.47275829315185547
local_output_nid generation:  0.03259849548339844
local_in_edges_tensor generation:  0.03458285331726074
mini_batch_src_global generation:  0.05071568489074707
r_  generation:  0.47509145736694336
local_output_nid generation:  0.032561540603637695
local_in_edges_tensor generation:  0.04294252395629883
mini_batch_src_global generation:  0.05110740661621094
r_  generation:  0.47505879402160645
local_output_nid generation:  0.033109188079833984
local_in_edges_tensor generation:  0.09164953231811523
mini_batch_src_global generation:  0.05303001403808594
r_  generation:  0.5027012825012207
local_output_nid generation:  0.037353515625
local_in_edges_tensor generation:  0.04462242126464844
mini_batch_src_global generation:  0.05847430229187012
r_  generation:  0.47644639015197754
local_output_nid generation:  0.034038543701171875
local_in_edges_tensor generation:  0.03529858589172363
mini_batch_src_global generation:  0.052954673767089844
r_  generation:  0.4781022071838379
local_output_nid generation:  0.0334012508392334
local_in_edges_tensor generation:  0.03286027908325195
mini_batch_src_global generation:  0.054544687271118164
r_  generation:  0.4755733013153076
local_output_nid generation:  0.03353619575500488
local_in_edges_tensor generation:  0.043365478515625
mini_batch_src_global generation:  0.05356001853942871
r_  generation:  0.4921152591705322
local_output_nid generation:  0.03333306312561035
local_in_edges_tensor generation:  0.03906965255737305
mini_batch_src_global generation:  0.053626298904418945
r_  generation:  0.47908520698547363
local_output_nid generation:  0.033349037170410156
local_in_edges_tensor generation:  0.030210256576538086
mini_batch_src_global generation:  0.05382204055786133
r_  generation:  0.48358607292175293
local_output_nid generation:  0.03371477127075195
local_in_edges_tensor generation:  0.03524947166442871
mini_batch_src_global generation:  0.056928396224975586
r_  generation:  0.4849240779876709
local_output_nid generation:  0.03359818458557129
local_in_edges_tensor generation:  0.0473477840423584
mini_batch_src_global generation:  0.05333304405212402
r_  generation:  0.4943559169769287
local_output_nid generation:  0.03375577926635742
local_in_edges_tensor generation:  0.036066293716430664
mini_batch_src_global generation:  0.054340362548828125
r_  generation:  0.48082900047302246
local_output_nid generation:  0.03481268882751465
local_in_edges_tensor generation:  0.03527069091796875
mini_batch_src_global generation:  0.053479909896850586
r_  generation:  0.5050604343414307
local_output_nid generation:  0.0359954833984375
local_in_edges_tensor generation:  0.04321551322937012
mini_batch_src_global generation:  0.05886125564575195
r_  generation:  0.47971200942993164
----------------------check_connections_block total spend ----------------------------- 11.531160831451416
generate_one_block  0.6034934520721436
generate_one_block  0.5853478908538818
generate_one_block  0.6110477447509766
generate_one_block  0.6040654182434082
generate_one_block  0.5981504917144775
generate_one_block  0.606008768081665
generate_one_block  0.5993242263793945
generate_one_block  0.5868387222290039
generate_one_block  0.637108325958252
generate_one_block  0.5979321002960205
generate_one_block  0.5887598991394043
generate_one_block  0.6014561653137207
generate_one_block  0.6040735244750977
generate_one_block  0.5838830471038818
generate_one_block  0.5837266445159912
generate_one_block  0.6030020713806152
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.13268327713012695  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

connection checking time:  17.873387336730957
block generation total time  15.305761575698853
average batch blocks generation time:  0.9566100984811783
block dataloader generation time/epoch 35.51163411140442
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09485244750976562  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([157051, 128])
torch.Size([130003, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26444387435913086  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.0943918228149414  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156964, 128])
torch.Size([129815, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2625269889831543  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09434652328491211  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156345, 128])
torch.Size([128936, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26250553131103516  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09444761276245117  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156807, 128])
torch.Size([129343, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26231956481933594  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09463930130004883  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([157133, 128])
torch.Size([130116, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2630033493041992  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09489917755126953  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156864, 128])
torch.Size([130210, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26528215408325195  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09476566314697266  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156954, 128])
torch.Size([130042, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2644972801208496  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09466266632080078  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156968, 128])
torch.Size([129935, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2633533477783203  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09493684768676758  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([157089, 128])
torch.Size([130608, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2650766372680664  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09473752975463867  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156883, 128])
torch.Size([129838, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26436710357666016  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09465646743774414  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156607, 128])
torch.Size([129671, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26414966583251953  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09476947784423828  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156982, 128])
torch.Size([130223, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2643575668334961  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09468984603881836  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([157009, 128])
torch.Size([130157, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26388072967529297  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09431886672973633  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156479, 128])
torch.Size([129021, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26241016387939453  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09474706649780273  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156853, 128])
torch.Size([129574, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2641596794128418  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09482192993164062  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

torch.Size([156912, 128])
torch.Size([130232, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2649393081665039  GigaBytes
Max Memory Allocated: 0.28733015060424805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029217615723609924 |0.01217043399810791 |0.0035609006881713867 |9.012222290039062e-05 |0.004066035151481628 |0.002911806106567383 |
----------------------------------------------------------pseudo_mini_loss sum 4.098055362701416
Total (block generation + training)time/epoch 36.331549882888794
Training time/epoch 0.8196299076080322
Training time without block to device /epoch 0.6249029636383057
Training time without total dataloading part /epoch 0.12638473510742188
load block tensor time/epoch 0.4674818515777588
block to device time/epoch 0.19472694396972656
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5317383
Number of first layer input nodes during this epoch:  2509900
