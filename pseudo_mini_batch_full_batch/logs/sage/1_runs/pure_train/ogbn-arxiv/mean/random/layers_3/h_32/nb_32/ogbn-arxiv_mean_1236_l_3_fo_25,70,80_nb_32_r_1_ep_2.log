Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648354242.2610123
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027353525161743164
random selection method range initialization spend 0.006644725799560547
time for parepare:  0.018799781799316406
local_output_nid generation:  0.0011303424835205078
local_in_edges_tensor generation:  0.004240512847900391
mini_batch_src_global generation:  0.0016477108001708984
r_  generation:  0.011244535446166992
local_output_nid generation:  0.0013699531555175781
local_in_edges_tensor generation:  0.0010080337524414062
mini_batch_src_global generation:  0.0015225410461425781
r_  generation:  0.0092315673828125
local_output_nid generation:  0.0014147758483886719
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0011022090911865234
r_  generation:  0.009900093078613281
local_output_nid generation:  0.0014755725860595703
local_in_edges_tensor generation:  0.0008318424224853516
mini_batch_src_global generation:  0.00096893310546875
r_  generation:  0.00912928581237793
local_output_nid generation:  0.0014519691467285156
local_in_edges_tensor generation:  0.0008258819580078125
mini_batch_src_global generation:  0.0009710788726806641
r_  generation:  0.009726524353027344
local_output_nid generation:  0.0014655590057373047
local_in_edges_tensor generation:  0.0008151531219482422
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.00973820686340332
local_output_nid generation:  0.0014338493347167969
local_in_edges_tensor generation:  0.0008273124694824219
mini_batch_src_global generation:  0.0009682178497314453
r_  generation:  0.009827852249145508
local_output_nid generation:  0.0014312267303466797
local_in_edges_tensor generation:  0.0007879734039306641
mini_batch_src_global generation:  0.0009758472442626953
r_  generation:  0.009891033172607422
local_output_nid generation:  0.0014719963073730469
local_in_edges_tensor generation:  0.0007755756378173828
mini_batch_src_global generation:  0.0009636878967285156
r_  generation:  0.010004758834838867
local_output_nid generation:  0.0014333724975585938
local_in_edges_tensor generation:  0.0007715225219726562
mini_batch_src_global generation:  0.0009834766387939453
r_  generation:  0.009774446487426758
local_output_nid generation:  0.0014584064483642578
local_in_edges_tensor generation:  0.0007777214050292969
mini_batch_src_global generation:  0.0010173320770263672
r_  generation:  0.010536909103393555
local_output_nid generation:  0.0014498233795166016
local_in_edges_tensor generation:  0.0007894039154052734
mini_batch_src_global generation:  0.000997781753540039
r_  generation:  0.0099639892578125
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0007688999176025391
mini_batch_src_global generation:  0.0009927749633789062
r_  generation:  0.010192632675170898
local_output_nid generation:  0.0014390945434570312
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.0009882450103759766
r_  generation:  0.00988912582397461
local_output_nid generation:  0.0014379024505615234
local_in_edges_tensor generation:  0.0007565021514892578
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.01040792465209961
local_output_nid generation:  0.0014426708221435547
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.0009963512420654297
r_  generation:  0.009538888931274414
local_output_nid generation:  0.0014526844024658203
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.0010073184967041016
r_  generation:  0.01020956039428711
local_output_nid generation:  0.0014624595642089844
local_in_edges_tensor generation:  0.0007975101470947266
mini_batch_src_global generation:  0.0010576248168945312
r_  generation:  0.01020050048828125
local_output_nid generation:  0.0014712810516357422
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.0010256767272949219
r_  generation:  0.010444164276123047
local_output_nid generation:  0.0015027523040771484
local_in_edges_tensor generation:  0.0007607936859130859
mini_batch_src_global generation:  0.0010457038879394531
r_  generation:  0.009987354278564453
local_output_nid generation:  0.0014801025390625
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.0010023117065429688
r_  generation:  0.009825706481933594
local_output_nid generation:  0.0014715194702148438
local_in_edges_tensor generation:  0.0007565021514892578
mini_batch_src_global generation:  0.0010867118835449219
r_  generation:  0.010045289993286133
local_output_nid generation:  0.0014522075653076172
local_in_edges_tensor generation:  0.0007534027099609375
mini_batch_src_global generation:  0.0010275840759277344
r_  generation:  0.010022640228271484
local_output_nid generation:  0.0014560222625732422
local_in_edges_tensor generation:  0.0007674694061279297
mini_batch_src_global generation:  0.0010383129119873047
r_  generation:  0.010264158248901367
local_output_nid generation:  0.0014848709106445312
local_in_edges_tensor generation:  0.0007436275482177734
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.010100841522216797
local_output_nid generation:  0.0014460086822509766
local_in_edges_tensor generation:  0.0007421970367431641
mini_batch_src_global generation:  0.000982522964477539
r_  generation:  0.009634733200073242
local_output_nid generation:  0.001455545425415039
local_in_edges_tensor generation:  0.0007445812225341797
mini_batch_src_global generation:  0.0010151863098144531
r_  generation:  0.010304689407348633
local_output_nid generation:  0.0014476776123046875
local_in_edges_tensor generation:  0.0007333755493164062
mini_batch_src_global generation:  0.0010137557983398438
r_  generation:  0.009862184524536133
local_output_nid generation:  0.0014464855194091797
local_in_edges_tensor generation:  0.0007336139678955078
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.00994563102722168
local_output_nid generation:  0.0014410018920898438
local_in_edges_tensor generation:  0.005382061004638672
mini_batch_src_global generation:  0.0011632442474365234
r_  generation:  0.00946187973022461
local_output_nid generation:  0.001306772232055664
local_in_edges_tensor generation:  0.0007762908935546875
mini_batch_src_global generation:  0.0010786056518554688
r_  generation:  0.009727716445922852
local_output_nid generation:  0.0013816356658935547
local_in_edges_tensor generation:  0.0007424354553222656
mini_batch_src_global generation:  0.0010280609130859375
r_  generation:  0.009679555892944336
----------------------check_connections_block total spend ----------------------------- 0.539339542388916
generate_one_block  0.015570402145385742
generate_one_block  0.014425039291381836
generate_one_block  0.015238523483276367
generate_one_block  0.014524459838867188
generate_one_block  0.015054941177368164
generate_one_block  0.015167713165283203
generate_one_block  0.014520883560180664
generate_one_block  0.014956235885620117
generate_one_block  0.01491236686706543
generate_one_block  0.015170812606811523
generate_one_block  0.015014886856079102
generate_one_block  0.014796257019042969
generate_one_block  0.014965534210205078
generate_one_block  0.014696121215820312
generate_one_block  0.014928340911865234
generate_one_block  0.014046430587768555
generate_one_block  0.014495372772216797
generate_one_block  0.0151214599609375
generate_one_block  0.01493525505065918
generate_one_block  0.015102863311767578
generate_one_block  0.014273881912231445
generate_one_block  0.014977693557739258
generate_one_block  0.014342784881591797
generate_one_block  0.01553487777709961
generate_one_block  0.014523506164550781
generate_one_block  0.014500617980957031
generate_one_block  0.01487588882446289
generate_one_block  0.014801263809204102
generate_one_block  0.014295578002929688
generate_one_block  0.014163494110107422
generate_one_block  0.01499032974243164
generate_one_block  0.014148712158203125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04309248924255371
gen group dst list time:  0.023705720901489258
time for parepare:  0.01949334144592285
local_output_nid generation:  0.005194425582885742
local_in_edges_tensor generation:  0.014215707778930664
mini_batch_src_global generation:  0.01650714874267578
r_  generation:  0.15960192680358887
local_output_nid generation:  0.009756088256835938
local_in_edges_tensor generation:  0.015516042709350586
mini_batch_src_global generation:  0.020721912384033203
r_  generation:  0.16145539283752441
local_output_nid generation:  0.00986933708190918
local_in_edges_tensor generation:  0.013698577880859375
mini_batch_src_global generation:  0.020046710968017578
r_  generation:  0.17509150505065918
local_output_nid generation:  0.00954580307006836
local_in_edges_tensor generation:  0.012696504592895508
mini_batch_src_global generation:  0.020583152770996094
r_  generation:  0.17138123512268066
local_output_nid generation:  0.009795188903808594
local_in_edges_tensor generation:  0.009981155395507812
mini_batch_src_global generation:  0.021553754806518555
r_  generation:  0.17617487907409668
local_output_nid generation:  0.010009288787841797
local_in_edges_tensor generation:  0.013606548309326172
mini_batch_src_global generation:  0.02220916748046875
r_  generation:  0.17970633506774902
local_output_nid generation:  0.009629487991333008
local_in_edges_tensor generation:  0.011545658111572266
mini_batch_src_global generation:  0.02222442626953125
r_  generation:  0.17812132835388184
local_output_nid generation:  0.009819746017456055
local_in_edges_tensor generation:  0.012965202331542969
mini_batch_src_global generation:  0.022480249404907227
r_  generation:  0.18155694007873535
local_output_nid generation:  0.009783267974853516
local_in_edges_tensor generation:  0.00996851921081543
mini_batch_src_global generation:  0.022109031677246094
r_  generation:  0.17742300033569336
local_output_nid generation:  0.009704351425170898
local_in_edges_tensor generation:  0.0113983154296875
mini_batch_src_global generation:  0.022081613540649414
r_  generation:  0.17693066596984863
local_output_nid generation:  0.009688615798950195
local_in_edges_tensor generation:  0.014791011810302734
mini_batch_src_global generation:  0.02305769920349121
r_  generation:  0.18102669715881348
local_output_nid generation:  0.009814739227294922
local_in_edges_tensor generation:  0.011543989181518555
mini_batch_src_global generation:  0.022769689559936523
r_  generation:  0.17684435844421387
local_output_nid generation:  0.009810924530029297
local_in_edges_tensor generation:  0.011857748031616211
mini_batch_src_global generation:  0.02448248863220215
r_  generation:  0.1820354461669922
local_output_nid generation:  0.009720563888549805
local_in_edges_tensor generation:  0.011841535568237305
mini_batch_src_global generation:  0.022707700729370117
r_  generation:  0.18291592597961426
local_output_nid generation:  0.009870767593383789
local_in_edges_tensor generation:  0.011555910110473633
mini_batch_src_global generation:  0.0244905948638916
r_  generation:  0.18042564392089844
local_output_nid generation:  0.009418964385986328
local_in_edges_tensor generation:  0.009956598281860352
mini_batch_src_global generation:  0.022234678268432617
r_  generation:  0.17251276969909668
local_output_nid generation:  0.009763717651367188
local_in_edges_tensor generation:  0.009557723999023438
mini_batch_src_global generation:  0.02232217788696289
r_  generation:  0.17574429512023926
local_output_nid generation:  0.010105133056640625
local_in_edges_tensor generation:  0.011852025985717773
mini_batch_src_global generation:  0.023409128189086914
r_  generation:  0.18439888954162598
local_output_nid generation:  0.009802103042602539
local_in_edges_tensor generation:  0.012945413589477539
mini_batch_src_global generation:  0.023463010787963867
r_  generation:  0.18022489547729492
local_output_nid generation:  0.00979304313659668
local_in_edges_tensor generation:  0.011826515197753906
mini_batch_src_global generation:  0.023348093032836914
r_  generation:  0.18528318405151367
local_output_nid generation:  0.009490489959716797
local_in_edges_tensor generation:  0.011364936828613281
mini_batch_src_global generation:  0.022299766540527344
r_  generation:  0.17321491241455078
local_output_nid generation:  0.009948015213012695
local_in_edges_tensor generation:  0.011418581008911133
mini_batch_src_global generation:  0.0240170955657959
r_  generation:  0.18456411361694336
local_output_nid generation:  0.009619951248168945
local_in_edges_tensor generation:  0.011163711547851562
mini_batch_src_global generation:  0.02261638641357422
r_  generation:  0.17632532119750977
local_output_nid generation:  0.010016202926635742
local_in_edges_tensor generation:  0.015074968338012695
mini_batch_src_global generation:  0.025151729583740234
r_  generation:  0.19277524948120117
local_output_nid generation:  0.009584665298461914
local_in_edges_tensor generation:  0.009958744049072266
mini_batch_src_global generation:  0.02239203453063965
r_  generation:  0.1741042137145996
local_output_nid generation:  0.009527921676635742
local_in_edges_tensor generation:  0.00996541976928711
mini_batch_src_global generation:  0.022114992141723633
r_  generation:  0.18057727813720703
local_output_nid generation:  0.009697198867797852
local_in_edges_tensor generation:  0.01284646987915039
mini_batch_src_global generation:  0.027172327041625977
r_  generation:  0.18133211135864258
local_output_nid generation:  0.00968480110168457
local_in_edges_tensor generation:  0.00998544692993164
mini_batch_src_global generation:  0.02268671989440918
r_  generation:  0.1832418441772461
local_output_nid generation:  0.009627819061279297
local_in_edges_tensor generation:  0.00973367691040039
mini_batch_src_global generation:  0.0220644474029541
r_  generation:  0.1764841079711914
local_output_nid generation:  0.009191513061523438
local_in_edges_tensor generation:  0.009700775146484375
mini_batch_src_global generation:  0.022502422332763672
r_  generation:  0.17397809028625488
local_output_nid generation:  0.009663820266723633
local_in_edges_tensor generation:  0.01279902458190918
mini_batch_src_global generation:  0.022452116012573242
r_  generation:  0.17918872833251953
local_output_nid generation:  0.009576559066772461
local_in_edges_tensor generation:  0.009835243225097656
mini_batch_src_global generation:  0.022352218627929688
r_  generation:  0.17403435707092285
----------------------check_connections_block total spend ----------------------------- 8.372897624969482
generate_one_block  0.22814583778381348
generate_one_block  0.21800684928894043
generate_one_block  0.2584667205810547
generate_one_block  0.2262277603149414
generate_one_block  0.22974467277526855
generate_one_block  0.2369697093963623
generate_one_block  0.2257235050201416
generate_one_block  0.23239994049072266
generate_one_block  0.2358403205871582
generate_one_block  0.22702455520629883
generate_one_block  0.2363584041595459
generate_one_block  0.22694110870361328
generate_one_block  0.23787879943847656
generate_one_block  0.2364335060119629
generate_one_block  0.23183274269104004
generate_one_block  0.2506132125854492
generate_one_block  0.22391629219055176
generate_one_block  0.23871636390686035
generate_one_block  0.22901558876037598
generate_one_block  0.23946738243103027
generate_one_block  0.22606873512268066
generate_one_block  0.2311246395111084
generate_one_block  0.223219633102417
generate_one_block  0.24445414543151855
generate_one_block  0.24471378326416016
generate_one_block  0.25303006172180176
generate_one_block  0.24197745323181152
generate_one_block  0.2456977367401123
generate_one_block  0.22787809371948242
generate_one_block  0.22100520133972168
generate_one_block  0.22625064849853516
generate_one_block  0.21826744079589844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07380247116088867
gen group dst list time:  0.11298036575317383
time for parepare:  0.023030757904052734
local_output_nid generation:  0.023585796356201172
local_in_edges_tensor generation:  0.04859209060668945
mini_batch_src_global generation:  0.04201555252075195
r_  generation:  0.4251251220703125
local_output_nid generation:  0.029885292053222656
local_in_edges_tensor generation:  0.04310178756713867
mini_batch_src_global generation:  0.04851508140563965
r_  generation:  0.42312002182006836
local_output_nid generation:  0.03056955337524414
local_in_edges_tensor generation:  0.04732990264892578
mini_batch_src_global generation:  0.055336713790893555
r_  generation:  0.4464385509490967
local_output_nid generation:  0.030891895294189453
local_in_edges_tensor generation:  0.04092144966125488
mini_batch_src_global generation:  0.04814553260803223
r_  generation:  0.42362070083618164
local_output_nid generation:  0.028977155685424805
local_in_edges_tensor generation:  0.03431582450866699
mini_batch_src_global generation:  0.051820993423461914
r_  generation:  0.43221044540405273
local_output_nid generation:  0.02916693687438965
local_in_edges_tensor generation:  0.030187368392944336
mini_batch_src_global generation:  0.04978156089782715
r_  generation:  0.43627476692199707
local_output_nid generation:  0.028759002685546875
local_in_edges_tensor generation:  0.028217792510986328
mini_batch_src_global generation:  0.05114459991455078
r_  generation:  0.46083927154541016
local_output_nid generation:  0.029178142547607422
local_in_edges_tensor generation:  0.03256106376647949
mini_batch_src_global generation:  0.049867868423461914
r_  generation:  0.4395639896392822
local_output_nid generation:  0.02960991859436035
local_in_edges_tensor generation:  0.04739570617675781
mini_batch_src_global generation:  0.05049729347229004
r_  generation:  0.4376370906829834
local_output_nid generation:  0.029354095458984375
local_in_edges_tensor generation:  0.03229045867919922
mini_batch_src_global generation:  0.05013394355773926
r_  generation:  0.4526357650756836
local_output_nid generation:  0.02882671356201172
local_in_edges_tensor generation:  0.03435254096984863
mini_batch_src_global generation:  0.05366230010986328
r_  generation:  0.43843507766723633
local_output_nid generation:  0.02978825569152832
local_in_edges_tensor generation:  0.03384876251220703
mini_batch_src_global generation:  0.04971718788146973
r_  generation:  0.4326939582824707
local_output_nid generation:  0.029144763946533203
local_in_edges_tensor generation:  0.037654876708984375
mini_batch_src_global generation:  0.049674272537231445
r_  generation:  0.4400908946990967
local_output_nid generation:  0.0291898250579834
local_in_edges_tensor generation:  0.0298309326171875
mini_batch_src_global generation:  0.04993414878845215
r_  generation:  0.43346142768859863
local_output_nid generation:  0.02892279624938965
local_in_edges_tensor generation:  0.025883913040161133
mini_batch_src_global generation:  0.050000667572021484
r_  generation:  0.43491411209106445
local_output_nid generation:  0.028765201568603516
local_in_edges_tensor generation:  0.029773950576782227
mini_batch_src_global generation:  0.04973793029785156
r_  generation:  0.43042922019958496
local_output_nid generation:  0.028624296188354492
local_in_edges_tensor generation:  0.03350472450256348
mini_batch_src_global generation:  0.04945111274719238
r_  generation:  0.4365990161895752
local_output_nid generation:  0.029021263122558594
local_in_edges_tensor generation:  0.03074789047241211
mini_batch_src_global generation:  0.05094313621520996
r_  generation:  0.4411172866821289
local_output_nid generation:  0.0290219783782959
local_in_edges_tensor generation:  0.034357309341430664
mini_batch_src_global generation:  0.05071902275085449
r_  generation:  0.4395008087158203
local_output_nid generation:  0.0291445255279541
local_in_edges_tensor generation:  0.030238866806030273
mini_batch_src_global generation:  0.05064654350280762
r_  generation:  0.4402458667755127
local_output_nid generation:  0.029820680618286133
local_in_edges_tensor generation:  0.03213047981262207
mini_batch_src_global generation:  0.05101418495178223
r_  generation:  0.43643879890441895
local_output_nid generation:  0.02908492088317871
local_in_edges_tensor generation:  0.030188560485839844
mini_batch_src_global generation:  0.05376434326171875
r_  generation:  0.4378170967102051
local_output_nid generation:  0.028693675994873047
local_in_edges_tensor generation:  0.026887178421020508
mini_batch_src_global generation:  0.05027580261230469
r_  generation:  0.4386470317840576
local_output_nid generation:  0.02912306785583496
local_in_edges_tensor generation:  0.03396725654602051
mini_batch_src_global generation:  0.049973487854003906
r_  generation:  0.43567872047424316
local_output_nid generation:  0.0289156436920166
local_in_edges_tensor generation:  0.03064441680908203
mini_batch_src_global generation:  0.05028223991394043
r_  generation:  0.4321920871734619
local_output_nid generation:  0.029073238372802734
local_in_edges_tensor generation:  0.026162385940551758
mini_batch_src_global generation:  0.05402016639709473
r_  generation:  0.44469213485717773
local_output_nid generation:  0.029288530349731445
local_in_edges_tensor generation:  0.042115211486816406
mini_batch_src_global generation:  0.050922393798828125
r_  generation:  0.4422640800476074
local_output_nid generation:  0.028943300247192383
local_in_edges_tensor generation:  0.029488801956176758
mini_batch_src_global generation:  0.06189393997192383
r_  generation:  0.4427781105041504
local_output_nid generation:  0.028476953506469727
local_in_edges_tensor generation:  0.029410123825073242
mini_batch_src_global generation:  0.05083775520324707
r_  generation:  0.4402608871459961
local_output_nid generation:  0.03107166290283203
local_in_edges_tensor generation:  0.03417611122131348
mini_batch_src_global generation:  0.05060100555419922
r_  generation:  0.4339179992675781
local_output_nid generation:  0.029080867767333984
local_in_edges_tensor generation:  0.038343191146850586
mini_batch_src_global generation:  0.0501863956451416
r_  generation:  0.437441349029541
local_output_nid generation:  0.028490304946899414
local_in_edges_tensor generation:  0.02605152130126953
mini_batch_src_global generation:  0.05094718933105469
r_  generation:  0.4326193332672119
----------------------check_connections_block total spend ----------------------------- 20.7703595161438
generate_one_block  0.6581742763519287
generate_one_block  0.552649736404419
generate_one_block  0.5639667510986328
generate_one_block  0.5496401786804199
generate_one_block  0.554279088973999
generate_one_block  0.555819034576416
generate_one_block  0.5415632724761963
generate_one_block  0.5620880126953125
generate_one_block  0.578420877456665
generate_one_block  0.5531153678894043
generate_one_block  0.5420668125152588
generate_one_block  0.5522561073303223
generate_one_block  0.55507493019104
generate_one_block  0.5522103309631348
generate_one_block  0.5547966957092285
generate_one_block  0.5431368350982666
generate_one_block  0.5511960983276367
generate_one_block  0.5565431118011475
generate_one_block  0.5504171848297119
generate_one_block  0.5640125274658203
generate_one_block  0.5639653205871582
generate_one_block  0.5520291328430176
generate_one_block  0.5596458911895752
generate_one_block  0.5580742359161377
generate_one_block  0.5464262962341309
generate_one_block  0.5678389072418213
generate_one_block  0.5517387390136719
generate_one_block  0.5443770885467529
generate_one_block  0.5558750629425049
generate_one_block  0.5478615760803223
generate_one_block  0.557948112487793
generate_one_block  0.5422048568725586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  29.14325714111328
block generation total time  25.31282329559326
average batch blocks generation time:  0.7910257279872894
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08534574508666992  GigaBytes
Max Memory Allocated: 0.08534574508666992  GigaBytes

torch.Size([148812, 128])
torch.Size([109552, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.15862464904785156  GigaBytes
Max Memory Allocated: 0.16039180755615234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08555889129638672  GigaBytes
Max Memory Allocated: 0.17644977569580078  GigaBytes

torch.Size([148772, 128])
torch.Size([109145, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15754985809326172  GigaBytes
Max Memory Allocated: 0.17644977569580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0859375  GigaBytes
Max Memory Allocated: 0.17644977569580078  GigaBytes

torch.Size([148622, 128])
torch.Size([110076, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15876483917236328  GigaBytes
Max Memory Allocated: 0.17644977569580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0855097770690918  GigaBytes
Max Memory Allocated: 0.17644977569580078  GigaBytes

torch.Size([148345, 128])
torch.Size([108776, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15752840042114258  GigaBytes
Max Memory Allocated: 0.17644977569580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08613300323486328  GigaBytes
Max Memory Allocated: 0.17644977569580078  GigaBytes

torch.Size([149352, 128])
torch.Size([110190, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15995407104492188  GigaBytes
Max Memory Allocated: 0.17644977569580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08631467819213867  GigaBytes
Max Memory Allocated: 0.17644977569580078  GigaBytes

torch.Size([149311, 128])
torch.Size([111551, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16144418716430664  GigaBytes
Max Memory Allocated: 0.17644977569580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08594703674316406  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149140, 128])
torch.Size([109861, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15829801559448242  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08615922927856445  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149241, 128])
torch.Size([111031, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16128969192504883  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08612871170043945  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149303, 128])
torch.Size([110791, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16011619567871094  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0858449935913086  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148922, 128])
torch.Size([110408, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15964937210083008  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08571100234985352  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148415, 128])
torch.Size([109553, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15809297561645508  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08555364608764648  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148379, 128])
torch.Size([109189, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1577448844909668  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08599662780761719  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149022, 128])
torch.Size([110508, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15988445281982422  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08594703674316406  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148942, 128])
torch.Size([110002, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15964698791503906  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08561325073242188  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148228, 128])
torch.Size([109579, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1580190658569336  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08550310134887695  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148661, 128])
torch.Size([109281, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15744495391845703  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08569860458374023  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148821, 128])
torch.Size([109533, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15790939331054688  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08598136901855469  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148918, 128])
torch.Size([109947, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15869951248168945  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08583259582519531  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148822, 128])
torch.Size([109711, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15822410583496094  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08605098724365234  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148934, 128])
torch.Size([110201, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15890216827392578  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08576679229736328  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149038, 128])
torch.Size([109557, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1578812599182129  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08564233779907227  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148441, 128])
torch.Size([109713, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1580343246459961  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08552217483520508  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148441, 128])
torch.Size([109115, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1575946807861328  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08620071411132812  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149086, 128])
torch.Size([110746, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16120481491088867  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08546257019042969  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148332, 128])
torch.Size([109270, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1575937271118164  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0860595703125  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149466, 128])
torch.Size([110614, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15985918045043945  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0856771469116211  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148536, 128])
torch.Size([109539, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15797996520996094  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0856313705444336  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148610, 128])
torch.Size([109192, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15782499313354492  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08543920516967773  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148403, 128])
torch.Size([108654, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1573476791381836  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08542251586914062  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148498, 128])
torch.Size([108880, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15723180770874023  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08603239059448242  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149301, 128])
torch.Size([110704, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15990257263183594  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08539867401123047  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148544, 128])
torch.Size([108954, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15726041793823242  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02881622314453125 |0.023649200797080994 |0.026799999177455902 |9.375065565109253e-05 |0.004703491926193237 |0.0019338130950927734 |
----------------------------------------------------------pseudo_mini_loss sum 5.065976619720459
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9115789
Number of first layer input nodes during this epoch:  4761658
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.11588287353515625  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019855022430419922
random selection method range initialization spend 0.005268096923828125
time for parepare:  0.01815032958984375
local_output_nid generation:  0.001285552978515625
local_in_edges_tensor generation:  0.0063283443450927734
mini_batch_src_global generation:  0.0015170574188232422
r_  generation:  0.010096311569213867
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0009834766387939453
mini_batch_src_global generation:  0.0013775825500488281
r_  generation:  0.009824037551879883
local_output_nid generation:  0.001772165298461914
local_in_edges_tensor generation:  0.0008792877197265625
mini_batch_src_global generation:  0.0011293888092041016
r_  generation:  0.009360551834106445
local_output_nid generation:  0.0017986297607421875
local_in_edges_tensor generation:  0.0008485317230224609
mini_batch_src_global generation:  0.0010292530059814453
r_  generation:  0.009566783905029297
local_output_nid generation:  0.0017707347869873047
local_in_edges_tensor generation:  0.0008070468902587891
mini_batch_src_global generation:  0.0009989738464355469
r_  generation:  0.009618282318115234
local_output_nid generation:  0.0017406940460205078
local_in_edges_tensor generation:  0.0007963180541992188
mini_batch_src_global generation:  0.0010271072387695312
r_  generation:  0.009852170944213867
local_output_nid generation:  0.00177764892578125
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0011186599731445312
r_  generation:  0.009975910186767578
local_output_nid generation:  0.0017504692077636719
local_in_edges_tensor generation:  0.000782012939453125
mini_batch_src_global generation:  0.0010411739349365234
r_  generation:  0.011663198471069336
local_output_nid generation:  0.0018057823181152344
local_in_edges_tensor generation:  0.0007750988006591797
mini_batch_src_global generation:  0.001008749008178711
r_  generation:  0.009767532348632812
local_output_nid generation:  0.0018224716186523438
local_in_edges_tensor generation:  0.0007660388946533203
mini_batch_src_global generation:  0.0010433197021484375
r_  generation:  0.009857654571533203
local_output_nid generation:  0.0018076896667480469
local_in_edges_tensor generation:  0.0007827281951904297
mini_batch_src_global generation:  0.0010645389556884766
r_  generation:  0.010053396224975586
local_output_nid generation:  0.0017902851104736328
local_in_edges_tensor generation:  0.0007462501525878906
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.010100841522216797
local_output_nid generation:  0.001802682876586914
local_in_edges_tensor generation:  0.0007755756378173828
mini_batch_src_global generation:  0.001028299331665039
r_  generation:  0.010413885116577148
local_output_nid generation:  0.0018222332000732422
local_in_edges_tensor generation:  0.0007729530334472656
mini_batch_src_global generation:  0.0010225772857666016
r_  generation:  0.009909868240356445
local_output_nid generation:  0.0031197071075439453
local_in_edges_tensor generation:  0.0008132457733154297
mini_batch_src_global generation:  0.001035451889038086
r_  generation:  0.010167837142944336
local_output_nid generation:  0.0018582344055175781
local_in_edges_tensor generation:  0.0007712841033935547
mini_batch_src_global generation:  0.0010116100311279297
r_  generation:  0.009866476058959961
local_output_nid generation:  0.0018200874328613281
local_in_edges_tensor generation:  0.0007722377777099609
mini_batch_src_global generation:  0.0010306835174560547
r_  generation:  0.010013818740844727
local_output_nid generation:  0.0018389225006103516
local_in_edges_tensor generation:  0.0007493495941162109
mini_batch_src_global generation:  0.001027822494506836
r_  generation:  0.010222196578979492
local_output_nid generation:  0.0018389225006103516
local_in_edges_tensor generation:  0.0007960796356201172
mini_batch_src_global generation:  0.0011322498321533203
r_  generation:  0.010297298431396484
local_output_nid generation:  0.001918792724609375
local_in_edges_tensor generation:  0.0007710456848144531
mini_batch_src_global generation:  0.0010483264923095703
r_  generation:  0.010298490524291992
local_output_nid generation:  0.0018482208251953125
local_in_edges_tensor generation:  0.0007653236389160156
mini_batch_src_global generation:  0.0010654926300048828
r_  generation:  0.012454032897949219
local_output_nid generation:  0.0018563270568847656
local_in_edges_tensor generation:  0.0007867813110351562
mini_batch_src_global generation:  0.0010421276092529297
r_  generation:  0.010063886642456055
local_output_nid generation:  0.0018372535705566406
local_in_edges_tensor generation:  0.0007538795471191406
mini_batch_src_global generation:  0.001035451889038086
r_  generation:  0.010259866714477539
local_output_nid generation:  0.001798391342163086
local_in_edges_tensor generation:  0.0007545948028564453
mini_batch_src_global generation:  0.0010042190551757812
r_  generation:  0.010012149810791016
local_output_nid generation:  0.0018525123596191406
local_in_edges_tensor generation:  0.0007998943328857422
mini_batch_src_global generation:  0.0009846687316894531
r_  generation:  0.009757757186889648
local_output_nid generation:  0.0018067359924316406
local_in_edges_tensor generation:  0.00075531005859375
mini_batch_src_global generation:  0.0011191368103027344
r_  generation:  0.009945154190063477
local_output_nid generation:  0.001852273941040039
local_in_edges_tensor generation:  0.0007789134979248047
mini_batch_src_global generation:  0.0010309219360351562
r_  generation:  0.010216712951660156
local_output_nid generation:  0.0018854141235351562
local_in_edges_tensor generation:  0.0007829666137695312
mini_batch_src_global generation:  0.0010199546813964844
r_  generation:  0.010341405868530273
local_output_nid generation:  0.0018458366394042969
local_in_edges_tensor generation:  0.0007688999176025391
mini_batch_src_global generation:  0.0010311603546142578
r_  generation:  0.01007699966430664
local_output_nid generation:  0.001787424087524414
local_in_edges_tensor generation:  0.0007464885711669922
mini_batch_src_global generation:  0.000997781753540039
r_  generation:  0.009844541549682617
local_output_nid generation:  0.0018193721771240234
local_in_edges_tensor generation:  0.0007801055908203125
mini_batch_src_global generation:  0.0010166168212890625
r_  generation:  0.010354757308959961
local_output_nid generation:  0.001800537109375
local_in_edges_tensor generation:  0.0007431507110595703
mini_batch_src_global generation:  0.0010013580322265625
r_  generation:  0.009630203247070312
----------------------check_connections_block total spend ----------------------------- 0.5583674907684326
generate_one_block  0.019399166107177734
generate_one_block  0.01961660385131836
generate_one_block  0.014527559280395508
generate_one_block  0.014866828918457031
generate_one_block  0.014767885208129883
generate_one_block  0.014778852462768555
generate_one_block  0.01493072509765625
generate_one_block  0.017817974090576172
generate_one_block  0.01452493667602539
generate_one_block  0.014612674713134766
generate_one_block  0.014800548553466797
generate_one_block  0.01505279541015625
generate_one_block  0.015178203582763672
generate_one_block  0.014726638793945312
generate_one_block  0.017283201217651367
generate_one_block  0.014458894729614258
generate_one_block  0.014629364013671875
generate_one_block  0.014571428298950195
generate_one_block  0.01512598991394043
generate_one_block  0.015016317367553711
generate_one_block  0.015208959579467773
generate_one_block  0.017918825149536133
generate_one_block  0.01504206657409668
generate_one_block  0.014621973037719727
generate_one_block  0.014266490936279297
generate_one_block  0.014779090881347656
generate_one_block  0.014704465866088867
generate_one_block  0.01488804817199707
generate_one_block  0.017760038375854492
generate_one_block  0.014790773391723633
generate_one_block  0.01504659652709961
generate_one_block  0.014520645141601562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04582500457763672
gen group dst list time:  0.020716428756713867
time for parepare:  0.019086599349975586
local_output_nid generation:  0.005287885665893555
local_in_edges_tensor generation:  0.015114545822143555
mini_batch_src_global generation:  0.016388893127441406
r_  generation:  0.1696784496307373
local_output_nid generation:  0.008373022079467773
local_in_edges_tensor generation:  0.014232158660888672
mini_batch_src_global generation:  0.027333974838256836
r_  generation:  0.1746046543121338
local_output_nid generation:  0.011609792709350586
local_in_edges_tensor generation:  0.04541325569152832
mini_batch_src_global generation:  0.020767927169799805
r_  generation:  0.16518044471740723
local_output_nid generation:  0.008481740951538086
local_in_edges_tensor generation:  0.012132883071899414
mini_batch_src_global generation:  0.021422147750854492
r_  generation:  0.17159175872802734
local_output_nid generation:  0.00812077522277832
local_in_edges_tensor generation:  0.010394811630249023
mini_batch_src_global generation:  0.02144026756286621
r_  generation:  0.1763923168182373
local_output_nid generation:  0.00827646255493164
local_in_edges_tensor generation:  0.02284860610961914
mini_batch_src_global generation:  0.023712873458862305
r_  generation:  0.18100452423095703
local_output_nid generation:  0.008150577545166016
local_in_edges_tensor generation:  0.008823156356811523
mini_batch_src_global generation:  0.022336483001708984
r_  generation:  0.1784045696258545
local_output_nid generation:  0.008170604705810547
local_in_edges_tensor generation:  0.010123729705810547
mini_batch_src_global generation:  0.024144887924194336
r_  generation:  0.1810009479522705
local_output_nid generation:  0.008287906646728516
local_in_edges_tensor generation:  0.008983850479125977
mini_batch_src_global generation:  0.02241992950439453
r_  generation:  0.17380475997924805
local_output_nid generation:  0.00853419303894043
local_in_edges_tensor generation:  0.011760950088500977
mini_batch_src_global generation:  0.0220029354095459
r_  generation:  0.17711687088012695
local_output_nid generation:  0.008698225021362305
local_in_edges_tensor generation:  0.010193347930908203
mini_batch_src_global generation:  0.02265167236328125
r_  generation:  0.18055438995361328
local_output_nid generation:  0.008764028549194336
local_in_edges_tensor generation:  0.010374307632446289
mini_batch_src_global generation:  0.024412870407104492
r_  generation:  0.18300127983093262
local_output_nid generation:  0.009906530380249023
local_in_edges_tensor generation:  0.01975536346435547
mini_batch_src_global generation:  0.02440953254699707
r_  generation:  0.1841111183166504
local_output_nid generation:  0.008577823638916016
local_in_edges_tensor generation:  0.011384725570678711
mini_batch_src_global generation:  0.02285909652709961
r_  generation:  0.1741178035736084
local_output_nid generation:  0.008559465408325195
local_in_edges_tensor generation:  0.008790016174316406
mini_batch_src_global generation:  0.022437334060668945
r_  generation:  0.17654037475585938
local_output_nid generation:  0.008464574813842773
local_in_edges_tensor generation:  0.008544683456420898
mini_batch_src_global generation:  0.022255897521972656
r_  generation:  0.177628755569458
local_output_nid generation:  0.008748292922973633
local_in_edges_tensor generation:  0.01138758659362793
mini_batch_src_global generation:  0.024033784866333008
r_  generation:  0.1790316104888916
local_output_nid generation:  0.008625268936157227
local_in_edges_tensor generation:  0.011628866195678711
mini_batch_src_global generation:  0.02217555046081543
r_  generation:  0.17783546447753906
local_output_nid generation:  0.00890970230102539
local_in_edges_tensor generation:  0.01003408432006836
mini_batch_src_global generation:  0.023934125900268555
r_  generation:  0.17885160446166992
local_output_nid generation:  0.008632421493530273
local_in_edges_tensor generation:  0.011831998825073242
mini_batch_src_global generation:  0.023958921432495117
r_  generation:  0.18286681175231934
local_output_nid generation:  0.008558511734008789
local_in_edges_tensor generation:  0.009226083755493164
mini_batch_src_global generation:  0.023139476776123047
r_  generation:  0.2010326385498047
local_output_nid generation:  0.008466482162475586
local_in_edges_tensor generation:  0.011845111846923828
mini_batch_src_global generation:  0.024571895599365234
r_  generation:  0.18352842330932617
local_output_nid generation:  0.010698080062866211
local_in_edges_tensor generation:  0.012624025344848633
mini_batch_src_global generation:  0.022800445556640625
r_  generation:  0.1826636791229248
local_output_nid generation:  0.008422613143920898
local_in_edges_tensor generation:  0.009010791778564453
mini_batch_src_global generation:  0.022623062133789062
r_  generation:  0.17963647842407227
local_output_nid generation:  0.008306503295898438
local_in_edges_tensor generation:  0.009554862976074219
mini_batch_src_global generation:  0.021887779235839844
r_  generation:  0.17557001113891602
local_output_nid generation:  0.008542060852050781
local_in_edges_tensor generation:  0.012067556381225586
mini_batch_src_global generation:  0.024006128311157227
r_  generation:  0.1834089756011963
local_output_nid generation:  0.008477210998535156
local_in_edges_tensor generation:  0.010262489318847656
mini_batch_src_global generation:  0.022566556930541992
r_  generation:  0.18135547637939453
local_output_nid generation:  0.008548974990844727
local_in_edges_tensor generation:  0.011764049530029297
mini_batch_src_global generation:  0.022838592529296875
r_  generation:  0.18067479133605957
local_output_nid generation:  0.008531808853149414
local_in_edges_tensor generation:  0.00879979133605957
mini_batch_src_global generation:  0.02422332763671875
r_  generation:  0.18197202682495117
local_output_nid generation:  0.008533954620361328
local_in_edges_tensor generation:  0.008977890014648438
mini_batch_src_global generation:  0.022606849670410156
r_  generation:  0.17854952812194824
local_output_nid generation:  0.00857996940612793
local_in_edges_tensor generation:  0.008998870849609375
mini_batch_src_global generation:  0.024145841598510742
r_  generation:  0.18363499641418457
local_output_nid generation:  0.008176088333129883
local_in_edges_tensor generation:  0.008711576461791992
mini_batch_src_global generation:  0.02242565155029297
r_  generation:  0.17871785163879395
----------------------check_connections_block total spend ----------------------------- 8.433925151824951
generate_one_block  0.23560667037963867
generate_one_block  0.21631479263305664
generate_one_block  0.22774434089660645
generate_one_block  0.22408342361450195
generate_one_block  0.24729132652282715
generate_one_block  0.23184514045715332
generate_one_block  0.22490978240966797
generate_one_block  0.23861145973205566
generate_one_block  0.22270536422729492
generate_one_block  0.22915935516357422
generate_one_block  0.22663259506225586
generate_one_block  0.23761320114135742
generate_one_block  0.2445518970489502
generate_one_block  0.2215428352355957
generate_one_block  0.22726798057556152
generate_one_block  0.22108840942382812
generate_one_block  0.23274993896484375
generate_one_block  0.22436857223510742
generate_one_block  0.22796201705932617
generate_one_block  0.26361989974975586
generate_one_block  0.23778986930847168
generate_one_block  0.22960138320922852
generate_one_block  0.22511696815490723
generate_one_block  0.2254624366760254
generate_one_block  0.23104572296142578
generate_one_block  0.23287630081176758
generate_one_block  0.2225186824798584
generate_one_block  0.2269895076751709
generate_one_block  0.23833727836608887
generate_one_block  0.22478580474853516
generate_one_block  0.22710895538330078
generate_one_block  0.22565650939941406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07309079170227051
gen group dst list time:  0.10407352447509766
time for parepare:  0.017441272735595703
local_output_nid generation:  0.023382186889648438
local_in_edges_tensor generation:  0.05547380447387695
mini_batch_src_global generation:  0.03868699073791504
r_  generation:  0.42146754264831543
local_output_nid generation:  0.029570579528808594
local_in_edges_tensor generation:  0.04326653480529785
mini_batch_src_global generation:  0.048981666564941406
r_  generation:  0.4181838035583496
local_output_nid generation:  0.02901148796081543
local_in_edges_tensor generation:  0.035994529724121094
mini_batch_src_global generation:  0.050301313400268555
r_  generation:  0.42968273162841797
local_output_nid generation:  0.028109312057495117
local_in_edges_tensor generation:  0.03662419319152832
mini_batch_src_global generation:  0.049578189849853516
r_  generation:  0.432692289352417
local_output_nid generation:  0.028156518936157227
local_in_edges_tensor generation:  0.028816699981689453
mini_batch_src_global generation:  0.04917311668395996
r_  generation:  0.4371070861816406
local_output_nid generation:  0.02939295768737793
local_in_edges_tensor generation:  0.03741645812988281
mini_batch_src_global generation:  0.052449941635131836
r_  generation:  0.4455900192260742
local_output_nid generation:  0.02917170524597168
local_in_edges_tensor generation:  0.038603782653808594
mini_batch_src_global generation:  0.05380678176879883
r_  generation:  0.4367644786834717
local_output_nid generation:  0.028695106506347656
local_in_edges_tensor generation:  0.04397726058959961
mini_batch_src_global generation:  0.05605888366699219
r_  generation:  0.43282198905944824
local_output_nid generation:  0.029537200927734375
local_in_edges_tensor generation:  0.0325930118560791
mini_batch_src_global generation:  0.050298452377319336
r_  generation:  0.430743932723999
local_output_nid generation:  0.028939485549926758
local_in_edges_tensor generation:  0.028638362884521484
mini_batch_src_global generation:  0.05034160614013672
r_  generation:  0.43277859687805176
local_output_nid generation:  0.029172658920288086
local_in_edges_tensor generation:  0.03594851493835449
mini_batch_src_global generation:  0.04994559288024902
r_  generation:  0.4388408660888672
local_output_nid generation:  0.029037952423095703
local_in_edges_tensor generation:  0.02877044677734375
mini_batch_src_global generation:  0.050470590591430664
r_  generation:  0.4304351806640625
local_output_nid generation:  0.029116153717041016
local_in_edges_tensor generation:  0.032154083251953125
mini_batch_src_global generation:  0.05035829544067383
r_  generation:  0.43527674674987793
local_output_nid generation:  0.028884172439575195
local_in_edges_tensor generation:  0.02873063087463379
mini_batch_src_global generation:  0.05002951622009277
r_  generation:  0.4289538860321045
local_output_nid generation:  0.029325008392333984
local_in_edges_tensor generation:  0.032392024993896484
mini_batch_src_global generation:  0.06972670555114746
r_  generation:  0.43851447105407715
local_output_nid generation:  0.029189586639404297
local_in_edges_tensor generation:  0.03959321975708008
mini_batch_src_global generation:  0.05029702186584473
r_  generation:  0.4313042163848877
local_output_nid generation:  0.02911686897277832
local_in_edges_tensor generation:  0.02864980697631836
mini_batch_src_global generation:  0.049771785736083984
r_  generation:  0.43667030334472656
local_output_nid generation:  0.029220104217529297
local_in_edges_tensor generation:  0.028823137283325195
mini_batch_src_global generation:  0.05239248275756836
r_  generation:  0.43570494651794434
local_output_nid generation:  0.02939295768737793
local_in_edges_tensor generation:  0.031955718994140625
mini_batch_src_global generation:  0.05455589294433594
r_  generation:  0.44088053703308105
local_output_nid generation:  0.02930593490600586
local_in_edges_tensor generation:  0.036556243896484375
mini_batch_src_global generation:  0.05042719841003418
r_  generation:  0.4367399215698242
local_output_nid generation:  0.030347108840942383
local_in_edges_tensor generation:  0.043097496032714844
mini_batch_src_global generation:  0.05343937873840332
r_  generation:  0.4379863739013672
local_output_nid generation:  0.029249906539916992
local_in_edges_tensor generation:  0.03356504440307617
mini_batch_src_global generation:  0.05040144920349121
r_  generation:  0.4359264373779297
local_output_nid generation:  0.029271841049194336
local_in_edges_tensor generation:  0.026526927947998047
mini_batch_src_global generation:  0.05019640922546387
r_  generation:  0.43392348289489746
local_output_nid generation:  0.028925657272338867
local_in_edges_tensor generation:  0.026250123977661133
mini_batch_src_global generation:  0.05030989646911621
r_  generation:  0.43575024604797363
local_output_nid generation:  0.029223918914794922
local_in_edges_tensor generation:  0.03271818161010742
mini_batch_src_global generation:  0.06390023231506348
r_  generation:  0.441650390625
local_output_nid generation:  0.031740427017211914
local_in_edges_tensor generation:  0.03804326057434082
mini_batch_src_global generation:  0.05340886116027832
r_  generation:  0.4352264404296875
local_output_nid generation:  0.02927541732788086
local_in_edges_tensor generation:  0.030917644500732422
mini_batch_src_global generation:  0.0503535270690918
r_  generation:  0.43518948554992676
local_output_nid generation:  0.029349565505981445
local_in_edges_tensor generation:  0.026166439056396484
mini_batch_src_global generation:  0.05047726631164551
r_  generation:  0.4356081485748291
local_output_nid generation:  0.02938365936279297
local_in_edges_tensor generation:  0.03394818305969238
mini_batch_src_global generation:  0.05031132698059082
r_  generation:  0.4388468265533447
local_output_nid generation:  0.029144763946533203
local_in_edges_tensor generation:  0.02651381492614746
mini_batch_src_global generation:  0.057109832763671875
r_  generation:  0.4333817958831787
local_output_nid generation:  0.029076576232910156
local_in_edges_tensor generation:  0.026168346405029297
mini_batch_src_global generation:  0.04977822303771973
r_  generation:  0.4340178966522217
local_output_nid generation:  0.029698848724365234
local_in_edges_tensor generation:  0.03475189208984375
mini_batch_src_global generation:  0.04981589317321777
r_  generation:  0.43445825576782227
----------------------check_connections_block total spend ----------------------------- 20.656710147857666
generate_one_block  0.5575466156005859
generate_one_block  0.560497522354126
generate_one_block  0.5636017322540283
generate_one_block  0.563270092010498
generate_one_block  0.6534225940704346
generate_one_block  0.5580258369445801
generate_one_block  0.5573875904083252
generate_one_block  0.5657904148101807
generate_one_block  0.5475490093231201
generate_one_block  0.5610017776489258
generate_one_block  0.5638952255249023
generate_one_block  0.5472745895385742
generate_one_block  0.5675039291381836
generate_one_block  0.5461723804473877
generate_one_block  0.5603783130645752
generate_one_block  0.558896541595459
generate_one_block  0.5608689785003662
generate_one_block  0.5464966297149658
generate_one_block  0.562962532043457
generate_one_block  0.5605454444885254
generate_one_block  0.5681948661804199
generate_one_block  0.5610551834106445
generate_one_block  0.5469398498535156
generate_one_block  0.5526218414306641
generate_one_block  0.5627884864807129
generate_one_block  0.5726437568664551
generate_one_block  0.5589606761932373
generate_one_block  0.5666658878326416
generate_one_block  0.5694682598114014
generate_one_block  0.5448346138000488
generate_one_block  0.559356689453125
generate_one_block  0.5584313869476318
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.11588287353515625  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

connection checking time:  29.090635299682617
block generation total time  25.358007669448853
average batch blocks generation time:  0.7924377396702766
block dataloader generation time/epoch 57.02823352813721
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08588027954101562  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148557, 128])
torch.Size([110004, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15831804275512695  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08531475067138672  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148240, 128])
torch.Size([108692, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15706729888916016  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0855560302734375  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148544, 128])
torch.Size([109404, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15756559371948242  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08605098724365234  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149134, 128])
torch.Size([110276, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15983104705810547  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08594703674316406  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148774, 128])
torch.Size([109798, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1583261489868164  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08599615097045898  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148819, 128])
torch.Size([109873, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15844488143920898  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08591842651367188  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148710, 128])
torch.Size([110180, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15967512130737305  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08589553833007812  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148512, 128])
torch.Size([110142, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1596827507019043  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08580303192138672  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148780, 128])
torch.Size([109633, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15800809860229492  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08581304550170898  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148775, 128])
torch.Size([109779, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15811491012573242  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08607959747314453  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149162, 128])
torch.Size([110582, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15996646881103516  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0859532356262207  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148785, 128])
torch.Size([109529, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15828943252563477  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08627080917358398  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149073, 128])
torch.Size([110246, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1592249870300293  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08566665649414062  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148554, 128])
torch.Size([109349, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15779733657836914  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08585262298583984  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148702, 128])
torch.Size([109979, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1582026481628418  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0856781005859375  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148520, 128])
torch.Size([109347, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15780210494995117  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08594512939453125  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148880, 128])
torch.Size([109848, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15832138061523438  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08567237854003906  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148462, 128])
torch.Size([109280, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1578073501586914  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0859837532043457  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148969, 128])
torch.Size([110075, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15973234176635742  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0860443115234375  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149120, 128])
torch.Size([109642, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1584005355834961  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08605289459228516  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148680, 128])
torch.Size([110198, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1599578857421875  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08597087860107422  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148770, 128])
torch.Size([109828, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15841007232666016  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08608484268188477  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149139, 128])
torch.Size([109745, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15849924087524414  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08567333221435547  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148426, 128])
torch.Size([109190, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15780162811279297  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0855264663696289  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148548, 128])
torch.Size([108521, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15732288360595703  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08623886108398438  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149252, 128])
torch.Size([111061, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16126346588134766  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08583974838256836  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148737, 128])
torch.Size([109739, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1581587791442871  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0860128402709961  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148978, 128])
torch.Size([110411, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1598377227783203  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08618974685668945  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149139, 128])
torch.Size([110559, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16011810302734375  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08598899841308594  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149158, 128])
torch.Size([109671, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1582951545715332  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08589315414428711  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([148785, 128])
torch.Size([109375, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15816354751586914  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08607816696166992  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

torch.Size([149341, 128])
torch.Size([110419, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15847444534301758  GigaBytes
Max Memory Allocated: 0.17915058135986328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026188984513282776 |0.021379373967647552 |0.003466367721557617 |9.469687938690186e-05 |0.0036962032318115234 |0.0012879371643066406 |
----------------------------------------------------------pseudo_mini_loss sum 4.348223686218262
Total (block generation + training)time/epoch 58.827648878097534
Training time/epoch 1.7992103099822998
Training time without block to device /epoch 1.1150703430175781
Training time without total dataloading part /epoch 0.2335205078125
load block tensor time/epoch 0.8380475044250488
block to device time/epoch 0.6841399669647217
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9115480
Number of first layer input nodes during this epoch:  4762025
