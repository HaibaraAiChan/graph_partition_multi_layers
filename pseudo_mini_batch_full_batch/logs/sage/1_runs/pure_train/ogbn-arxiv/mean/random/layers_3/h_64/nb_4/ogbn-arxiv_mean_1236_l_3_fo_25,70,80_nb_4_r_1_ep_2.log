Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648356080.0351794
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02706766128540039
random selection method range initialization spend 0.006510496139526367
time for parepare:  0.018804073333740234
local_output_nid generation:  0.008517265319824219
local_in_edges_tensor generation:  0.009471654891967773
mini_batch_src_global generation:  0.007649421691894531
r_  generation:  0.09010553359985352
local_output_nid generation:  0.011827230453491211
local_in_edges_tensor generation:  0.006011962890625
mini_batch_src_global generation:  0.009932994842529297
r_  generation:  0.09693765640258789
local_output_nid generation:  0.01219630241394043
local_in_edges_tensor generation:  0.006002902984619141
mini_batch_src_global generation:  0.007843255996704102
r_  generation:  0.10189390182495117
local_output_nid generation:  0.011931896209716797
local_in_edges_tensor generation:  0.005815267562866211
mini_batch_src_global generation:  0.008612632751464844
r_  generation:  0.10195398330688477
----------------------check_connections_block total spend ----------------------------- 0.6053676605224609
generate_one_block  0.11647439002990723
generate_one_block  0.11352133750915527
generate_one_block  0.1169271469116211
generate_one_block  0.11461448669433594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04427289962768555
gen group dst list time:  0.011798620223999023
time for parepare:  0.018989086151123047
local_output_nid generation:  0.019812822341918945
local_in_edges_tensor generation:  0.047766685485839844
mini_batch_src_global generation:  0.04681110382080078
r_  generation:  0.4846477508544922
local_output_nid generation:  0.026133298873901367
local_in_edges_tensor generation:  0.04622960090637207
mini_batch_src_global generation:  0.05746293067932129
r_  generation:  0.4736032485961914
local_output_nid generation:  0.026265382766723633
local_in_edges_tensor generation:  0.03818845748901367
mini_batch_src_global generation:  0.06031680107116699
r_  generation:  0.4831235408782959
local_output_nid generation:  0.0264585018157959
local_in_edges_tensor generation:  0.03353071212768555
mini_batch_src_global generation:  0.05718708038330078
r_  generation:  0.4786362648010254
----------------------check_connections_block total spend ----------------------------- 2.84513521194458
generate_one_block  0.658815860748291
generate_one_block  0.6363451480865479
generate_one_block  0.626457929611206
generate_one_block  0.6230096817016602
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02906179428100586
gen group dst list time:  0.0211641788482666
time for parepare:  0.018728971481323242
local_output_nid generation:  0.029964208602905273
local_in_edges_tensor generation:  0.04199719429016113
mini_batch_src_global generation:  0.046175241470336914
r_  generation:  0.49507570266723633
local_output_nid generation:  0.0370638370513916
local_in_edges_tensor generation:  0.04805111885070801
mini_batch_src_global generation:  0.05698847770690918
r_  generation:  0.5001885890960693
local_output_nid generation:  0.0369873046875
local_in_edges_tensor generation:  0.03990983963012695
mini_batch_src_global generation:  0.06071615219116211
r_  generation:  0.5064342021942139
local_output_nid generation:  0.04007315635681152
local_in_edges_tensor generation:  0.045168161392211914
mini_batch_src_global generation:  0.05613446235656738
r_  generation:  0.5031683444976807
----------------------check_connections_block total spend ----------------------------- 3.0230658054351807
generate_one_block  0.6295690536499023
generate_one_block  0.6349244117736816
generate_one_block  0.6468038558959961
generate_one_block  0.6400551795959473
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  5.868201017379761
block generation total time  5.095981121063232
average batch blocks generation time:  1.273995280265808
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.1042790412902832  GigaBytes
Max Memory Allocated: 0.1042790412902832  GigaBytes

torch.Size([165487, 128])
torch.Size([157328, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.3696107864379883  GigaBytes
Max Memory Allocated: 0.3891420364379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.10807371139526367  GigaBytes
Max Memory Allocated: 0.41982460021972656  GigaBytes

torch.Size([165549, 128])
torch.Size([157327, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.36985254287719727  GigaBytes
Max Memory Allocated: 0.41982460021972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.10893917083740234  GigaBytes
Max Memory Allocated: 0.41982460021972656  GigaBytes

torch.Size([165502, 128])
torch.Size([157444, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.3697495460510254  GigaBytes
Max Memory Allocated: 0.41982460021972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1078958511352539  GigaBytes
Max Memory Allocated: 0.4199032783508301  GigaBytes

torch.Size([165415, 128])
torch.Size([157385, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.368955135345459  GigaBytes
Max Memory Allocated: 0.4199032783508301  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03845423460006714 |0.08563649654388428 |0.18332427740097046 |0.00010639429092407227 |0.01980602741241455 |0.001764059066772461 |
----------------------------------------------------------pseudo_mini_loss sum 5.277554035186768
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1721055
Number of first layer input nodes during this epoch:  661953
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.16159582138061523  GigaBytes
Max Memory Allocated: 0.4199032783508301  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021285295486450195
random selection method range initialization spend 0.0055828094482421875
time for parepare:  0.018654584884643555
local_output_nid generation:  0.008449077606201172
local_in_edges_tensor generation:  0.009369850158691406
mini_batch_src_global generation:  0.0073201656341552734
r_  generation:  0.08717083930969238
local_output_nid generation:  0.011820077896118164
local_in_edges_tensor generation:  0.00667262077331543
mini_batch_src_global generation:  0.009573936462402344
r_  generation:  0.09578347206115723
local_output_nid generation:  0.012007713317871094
local_in_edges_tensor generation:  0.006280183792114258
mini_batch_src_global generation:  0.00779271125793457
r_  generation:  0.10036420822143555
local_output_nid generation:  0.012259483337402344
local_in_edges_tensor generation:  0.006337642669677734
mini_batch_src_global generation:  0.008667469024658203
r_  generation:  0.10416793823242188
----------------------check_connections_block total spend ----------------------------- 0.602147102355957
generate_one_block  0.11322951316833496
generate_one_block  0.11855363845825195
generate_one_block  0.11700153350830078
generate_one_block  0.11775088310241699
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04337954521179199
gen group dst list time:  0.011617660522460938
time for parepare:  0.019578218460083008
local_output_nid generation:  0.019517898559570312
local_in_edges_tensor generation:  0.04824376106262207
mini_batch_src_global generation:  0.0459742546081543
r_  generation:  0.4623444080352783
local_output_nid generation:  0.02590799331665039
local_in_edges_tensor generation:  0.046167850494384766
mini_batch_src_global generation:  0.05619502067565918
r_  generation:  0.478759765625
local_output_nid generation:  0.026488304138183594
local_in_edges_tensor generation:  0.03515195846557617
mini_batch_src_global generation:  0.05698847770690918
r_  generation:  0.49068737030029297
local_output_nid generation:  0.02631998062133789
local_in_edges_tensor generation:  0.0421907901763916
mini_batch_src_global generation:  0.05774068832397461
r_  generation:  0.48830652236938477
----------------------check_connections_block total spend ----------------------------- 2.855626106262207
generate_one_block  0.6253812313079834
generate_one_block  0.6229755878448486
generate_one_block  0.6668694019317627
generate_one_block  0.6464431285858154
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03229808807373047
gen group dst list time:  0.021227121353149414
time for parepare:  0.018918991088867188
local_output_nid generation:  0.029581308364868164
local_in_edges_tensor generation:  0.041895151138305664
mini_batch_src_global generation:  0.05011582374572754
r_  generation:  0.4981346130371094
local_output_nid generation:  0.03783059120178223
local_in_edges_tensor generation:  0.04761767387390137
mini_batch_src_global generation:  0.05735206604003906
r_  generation:  0.5088872909545898
local_output_nid generation:  0.039453983306884766
local_in_edges_tensor generation:  0.04680895805358887
mini_batch_src_global generation:  0.06672549247741699
r_  generation:  0.5031278133392334
local_output_nid generation:  0.03843045234680176
local_in_edges_tensor generation:  0.04397106170654297
mini_batch_src_global generation:  0.056671142578125
r_  generation:  0.5113811492919922
----------------------check_connections_block total spend ----------------------------- 3.08467960357666
generate_one_block  0.6484625339508057
generate_one_block  0.6451900005340576
generate_one_block  0.6366796493530273
generate_one_block  0.6402275562286377
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.16159582138061523  GigaBytes
Max Memory Allocated: 0.4199032783508301  GigaBytes

connection checking time:  5.940305709838867
block generation total time  5.1322290897369385
average batch blocks generation time:  1.2830572724342346
block dataloader generation time/epoch 13.014196157455444
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.10853719711303711  GigaBytes
Max Memory Allocated: 0.4199032783508301  GigaBytes

torch.Size([165508, 128])
torch.Size([157425, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.3690066337585449  GigaBytes
Max Memory Allocated: 0.4199032783508301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1082000732421875  GigaBytes
Max Memory Allocated: 0.4199032783508301  GigaBytes

torch.Size([165533, 128])
torch.Size([157509, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.3700680732727051  GigaBytes
Max Memory Allocated: 0.4199032783508301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.10851049423217773  GigaBytes
Max Memory Allocated: 0.4200749397277832  GigaBytes

torch.Size([165410, 128])
torch.Size([157266, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.36971426010131836  GigaBytes
Max Memory Allocated: 0.4200749397277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1081843376159668  GigaBytes
Max Memory Allocated: 0.4200749397277832  GigaBytes

torch.Size([165506, 128])
torch.Size([157537, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.37032032012939453  GigaBytes
Max Memory Allocated: 0.4200749397277832  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05190896987915039 |0.022090613842010498 |0.004576623439788818 |9.381771087646484e-05 |0.004532039165496826 |0.0012967586517333984 |
----------------------------------------------------------pseudo_mini_loss sum 4.064910888671875
Total (block generation + training)time/epoch 13.381072044372559
Training time/epoch 0.366588830947876
Training time without block to device /epoch 0.278226375579834
Training time without total dataloading part /epoch 0.038106679916381836
load block tensor time/epoch 0.20763587951660156
block to device time/epoch 0.08836245536804199
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1721554
Number of first layer input nodes during this epoch:  661957
