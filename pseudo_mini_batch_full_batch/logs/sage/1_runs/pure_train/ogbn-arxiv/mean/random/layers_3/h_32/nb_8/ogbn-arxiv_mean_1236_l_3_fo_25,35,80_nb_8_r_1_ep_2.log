Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648353628.77114
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02706623077392578
random selection method range initialization spend 0.0062100887298583984
time for parepare:  0.018909692764282227
local_output_nid generation:  0.0042192935943603516
local_in_edges_tensor generation:  0.005436897277832031
mini_batch_src_global generation:  0.003754854202270508
r_  generation:  0.042005300521850586
local_output_nid generation:  0.00594639778137207
local_in_edges_tensor generation:  0.003316164016723633
mini_batch_src_global generation:  0.004889249801635742
r_  generation:  0.044683218002319336
local_output_nid generation:  0.006070852279663086
local_in_edges_tensor generation:  0.003319263458251953
mini_batch_src_global generation:  0.003273487091064453
r_  generation:  0.04552197456359863
local_output_nid generation:  0.006097555160522461
local_in_edges_tensor generation:  0.0033457279205322266
mini_batch_src_global generation:  0.0035657882690429688
r_  generation:  0.045928955078125
local_output_nid generation:  0.00616765022277832
local_in_edges_tensor generation:  0.0033562183380126953
mini_batch_src_global generation:  0.003706693649291992
r_  generation:  0.04681754112243652
local_output_nid generation:  0.006143808364868164
local_in_edges_tensor generation:  0.0032961368560791016
mini_batch_src_global generation:  0.003824472427368164
r_  generation:  0.047408103942871094
local_output_nid generation:  0.0061800479888916016
local_in_edges_tensor generation:  0.0032460689544677734
mini_batch_src_global generation:  0.0038123130798339844
r_  generation:  0.0473325252532959
local_output_nid generation:  0.006094217300415039
local_in_edges_tensor generation:  0.0033218860626220703
mini_batch_src_global generation:  0.003922700881958008
r_  generation:  0.045805931091308594
----------------------check_connections_block total spend ----------------------------- 0.5773768424987793
generate_one_block  0.06162738800048828
generate_one_block  0.06316876411437988
generate_one_block  0.06290197372436523
generate_one_block  0.06169724464416504
generate_one_block  0.06685113906860352
generate_one_block  0.062441110610961914
generate_one_block  0.061704397201538086
generate_one_block  0.06045675277709961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0391085147857666
gen group dst list time:  0.01649928092956543
time for parepare:  0.01875901222229004
local_output_nid generation:  0.014153480529785156
local_in_edges_tensor generation:  0.030637264251708984
mini_batch_src_global generation:  0.03228902816772461
r_  generation:  0.33797550201416016
local_output_nid generation:  0.020091533660888672
local_in_edges_tensor generation:  0.03135085105895996
mini_batch_src_global generation:  0.03916144371032715
r_  generation:  0.3322174549102783
local_output_nid generation:  0.019304752349853516
local_in_edges_tensor generation:  0.02545166015625
mini_batch_src_global generation:  0.04380607604980469
r_  generation:  0.33302783966064453
local_output_nid generation:  0.022115230560302734
local_in_edges_tensor generation:  0.022847652435302734
mini_batch_src_global generation:  0.03926730155944824
r_  generation:  0.33595943450927734
local_output_nid generation:  0.019261837005615234
local_in_edges_tensor generation:  0.022703886032104492
mini_batch_src_global generation:  0.0399324893951416
r_  generation:  0.33655810356140137
local_output_nid generation:  0.019293546676635742
local_in_edges_tensor generation:  0.026067256927490234
mini_batch_src_global generation:  0.040308475494384766
r_  generation:  0.3381369113922119
local_output_nid generation:  0.019223690032958984
local_in_edges_tensor generation:  0.0220184326171875
mini_batch_src_global generation:  0.03976559638977051
r_  generation:  0.3341965675354004
local_output_nid generation:  0.018985271453857422
local_in_edges_tensor generation:  0.021694421768188477
mini_batch_src_global generation:  0.04351234436035156
r_  generation:  0.33589935302734375
----------------------check_connections_block total spend ----------------------------- 3.9385924339294434
generate_one_block  0.42719292640686035
generate_one_block  0.45046114921569824
generate_one_block  0.4334850311279297
generate_one_block  0.4345259666442871
generate_one_block  0.4342360496520996
generate_one_block  0.4443960189819336
generate_one_block  0.42407941818237305
generate_one_block  0.42287707328796387
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03065013885498047
gen group dst list time:  0.03931856155395508
time for parepare:  0.01909184455871582
local_output_nid generation:  0.028237581253051758
local_in_edges_tensor generation:  0.041199445724487305
mini_batch_src_global generation:  0.04619765281677246
r_  generation:  0.46863722801208496
local_output_nid generation:  0.035124778747558594
local_in_edges_tensor generation:  0.05010986328125
mini_batch_src_global generation:  0.05735921859741211
r_  generation:  0.4824233055114746
local_output_nid generation:  0.03515315055847168
local_in_edges_tensor generation:  0.04174685478210449
mini_batch_src_global generation:  0.050664424896240234
r_  generation:  0.4953882694244385
local_output_nid generation:  0.035736799240112305
local_in_edges_tensor generation:  0.04159259796142578
mini_batch_src_global generation:  0.0529327392578125
r_  generation:  0.49594569206237793
local_output_nid generation:  0.03553915023803711
local_in_edges_tensor generation:  0.03746795654296875
mini_batch_src_global generation:  0.05400800704956055
r_  generation:  0.5042893886566162
local_output_nid generation:  0.03504586219787598
local_in_edges_tensor generation:  0.03776860237121582
mini_batch_src_global generation:  0.05487394332885742
r_  generation:  0.5005989074707031
local_output_nid generation:  0.0352785587310791
local_in_edges_tensor generation:  0.03362441062927246
mini_batch_src_global generation:  0.05330371856689453
r_  generation:  0.5003364086151123
local_output_nid generation:  0.034889936447143555
local_in_edges_tensor generation:  0.03783106803894043
mini_batch_src_global generation:  0.05564165115356445
r_  generation:  0.49410533905029297
----------------------check_connections_block total spend ----------------------------- 5.836388349533081
generate_one_block  0.6092596054077148
generate_one_block  0.6246664524078369
generate_one_block  0.6156716346740723
generate_one_block  0.6210799217224121
generate_one_block  0.6188311576843262
generate_one_block  0.6180624961853027
generate_one_block  0.6304049491882324
generate_one_block  0.6049098968505859
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  9.774980783462524
block generation total time  8.414139747619629
average batch blocks generation time:  1.0517674684524536
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.0971517562866211  GigaBytes
Max Memory Allocated: 0.0971517562866211  GigaBytes

torch.Size([160586, 128])
torch.Size([142207, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.2185525894165039  GigaBytes
Max Memory Allocated: 0.22050809860229492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.09970951080322266  GigaBytes
Max Memory Allocated: 0.23345708847045898  GigaBytes

torch.Size([161132, 128])
torch.Size([143501, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.22016334533691406  GigaBytes
Max Memory Allocated: 0.23345708847045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.09849119186401367  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([160662, 128])
torch.Size([142860, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.21841859817504883  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09903287887573242  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([160840, 128])
torch.Size([143110, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21836233139038086  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09946441650390625  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([160795, 128])
torch.Size([142831, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21884393692016602  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09989118576049805  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([160899, 128])
torch.Size([142948, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21957635879516602  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09845638275146484  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([160819, 128])
torch.Size([143006, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2181839942932129  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09889411926269531  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([160813, 128])
torch.Size([142883, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2177276611328125  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03295689821243286 |0.046412765979766846 |0.09359973669052124 |0.00011658668518066406 |0.008545637130737305 |0.003796100616455078 |
----------------------------------------------------------pseudo_mini_loss sum 5.007907867431641
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3018893
Number of first layer input nodes during this epoch:  1286546
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.1425485610961914  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0256807804107666
random selection method range initialization spend 0.0054454803466796875
time for parepare:  0.017793655395507812
local_output_nid generation:  0.0043909549713134766
local_in_edges_tensor generation:  0.010918855667114258
mini_batch_src_global generation:  0.003816843032836914
r_  generation:  0.040827035903930664
local_output_nid generation:  0.0059359073638916016
local_in_edges_tensor generation:  0.003307819366455078
mini_batch_src_global generation:  0.004983186721801758
r_  generation:  0.04451465606689453
local_output_nid generation:  0.006093025207519531
local_in_edges_tensor generation:  0.003777742385864258
mini_batch_src_global generation:  0.0033855438232421875
r_  generation:  0.04586434364318848
local_output_nid generation:  0.006105899810791016
local_in_edges_tensor generation:  0.0032663345336914062
mini_batch_src_global generation:  0.0035827159881591797
r_  generation:  0.04656624794006348
local_output_nid generation:  0.0061244964599609375
local_in_edges_tensor generation:  0.0032358169555664062
mini_batch_src_global generation:  0.003734111785888672
r_  generation:  0.047036170959472656
local_output_nid generation:  0.006073951721191406
local_in_edges_tensor generation:  0.0032846927642822266
mini_batch_src_global generation:  0.004082679748535156
r_  generation:  0.047618865966796875
local_output_nid generation:  0.006149768829345703
local_in_edges_tensor generation:  0.0033326148986816406
mini_batch_src_global generation:  0.003993034362792969
r_  generation:  0.04753232002258301
local_output_nid generation:  0.006130695343017578
local_in_edges_tensor generation:  0.0033979415893554688
mini_batch_src_global generation:  0.004181861877441406
r_  generation:  0.04770994186401367
----------------------check_connections_block total spend ----------------------------- 0.5861396789550781
generate_one_block  0.058461904525756836
generate_one_block  0.06232333183288574
generate_one_block  0.061760902404785156
generate_one_block  0.062238216400146484
generate_one_block  0.06274557113647461
generate_one_block  0.06334686279296875
generate_one_block  0.06569862365722656
generate_one_block  0.06238079071044922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03537249565124512
gen group dst list time:  0.0166018009185791
time for parepare:  0.018996715545654297
local_output_nid generation:  0.014754533767700195
local_in_edges_tensor generation:  0.035559654235839844
mini_batch_src_global generation:  0.03239083290100098
r_  generation:  0.31178736686706543
local_output_nid generation:  0.020348072052001953
local_in_edges_tensor generation:  0.031037092208862305
mini_batch_src_global generation:  0.038294315338134766
r_  generation:  0.33584046363830566
local_output_nid generation:  0.019463777542114258
local_in_edges_tensor generation:  0.0263979434967041
mini_batch_src_global generation:  0.03817391395568848
r_  generation:  0.3329453468322754
local_output_nid generation:  0.01971125602722168
local_in_edges_tensor generation:  0.022356510162353516
mini_batch_src_global generation:  0.041550397872924805
r_  generation:  0.3351290225982666
local_output_nid generation:  0.019443750381469727
local_in_edges_tensor generation:  0.027040719985961914
mini_batch_src_global generation:  0.0406949520111084
r_  generation:  0.34794139862060547
local_output_nid generation:  0.019573450088500977
local_in_edges_tensor generation:  0.019652366638183594
mini_batch_src_global generation:  0.04143166542053223
r_  generation:  0.3428463935852051
local_output_nid generation:  0.01939535140991211
local_in_edges_tensor generation:  0.02021169662475586
mini_batch_src_global generation:  0.04231739044189453
r_  generation:  0.34559130668640137
local_output_nid generation:  0.019350290298461914
local_in_edges_tensor generation:  0.022909879684448242
mini_batch_src_global generation:  0.041211605072021484
r_  generation:  0.3450286388397217
----------------------check_connections_block total spend ----------------------------- 3.960280656814575
generate_one_block  0.43476271629333496
generate_one_block  0.46411681175231934
generate_one_block  0.4402158260345459
generate_one_block  0.43364691734313965
generate_one_block  0.45239996910095215
generate_one_block  0.4618699550628662
generate_one_block  0.4388618469238281
generate_one_block  0.4837803840637207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05373525619506836
gen group dst list time:  0.039298295974731445
time for parepare:  0.020685195922851562
local_output_nid generation:  0.02897810935974121
local_in_edges_tensor generation:  0.0651087760925293
mini_batch_src_global generation:  0.047574758529663086
r_  generation:  0.47994542121887207
local_output_nid generation:  0.035059452056884766
local_in_edges_tensor generation:  0.04955720901489258
mini_batch_src_global generation:  0.0549161434173584
r_  generation:  0.4882087707519531
local_output_nid generation:  0.03507351875305176
local_in_edges_tensor generation:  0.03204917907714844
mini_batch_src_global generation:  0.05129075050354004
r_  generation:  0.4933345317840576
local_output_nid generation:  0.03546786308288574
local_in_edges_tensor generation:  0.03663897514343262
mini_batch_src_global generation:  0.05742502212524414
r_  generation:  0.5202693939208984
local_output_nid generation:  0.03533124923706055
local_in_edges_tensor generation:  0.03283977508544922
mini_batch_src_global generation:  0.053928375244140625
r_  generation:  0.5007665157318115
local_output_nid generation:  0.03533315658569336
local_in_edges_tensor generation:  0.036332130432128906
mini_batch_src_global generation:  0.057779550552368164
r_  generation:  0.49971437454223633
local_output_nid generation:  0.03570675849914551
local_in_edges_tensor generation:  0.052811384201049805
mini_batch_src_global generation:  0.0538027286529541
r_  generation:  0.5339889526367188
local_output_nid generation:  0.0403285026550293
local_in_edges_tensor generation:  0.0419001579284668
mini_batch_src_global generation:  0.05733990669250488
r_  generation:  0.5165364742279053
----------------------check_connections_block total spend ----------------------------- 5.991107940673828
generate_one_block  0.6284892559051514
generate_one_block  0.6422281265258789
generate_one_block  0.6182212829589844
generate_one_block  0.6223819255828857
generate_one_block  0.6249735355377197
generate_one_block  0.665276288986206
generate_one_block  0.6530323028564453
generate_one_block  0.6143560409545898
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.1425485610961914  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

connection checking time:  9.951388597488403
block generation total time  8.678613185882568
average batch blocks generation time:  1.084826648235321
block dataloader generation time/epoch 20.811182498931885
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09958171844482422  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([160902, 128])
torch.Size([142905, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21786069869995117  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09919309616088867  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([160826, 128])
torch.Size([142845, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21893644332885742  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09987831115722656  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([160838, 128])
torch.Size([142641, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21779394149780273  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.0991353988647461  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([160821, 128])
torch.Size([142894, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21857023239135742  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09947919845581055  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([160827, 128])
torch.Size([142730, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21991348266601562  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09881258010864258  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([161002, 128])
torch.Size([142874, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21876811981201172  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09936809539794922  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([161088, 128])
torch.Size([143234, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2188854217529297  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09916400909423828  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

torch.Size([160901, 128])
torch.Size([143092, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21872615814208984  GigaBytes
Max Memory Allocated: 0.2354116439819336  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03804856538772583 |0.01830613613128662 |0.0034957826137542725 |9.304285049438477e-05 |0.0038978755474090576 |0.0013217926025390625 |
----------------------------------------------------------pseudo_mini_loss sum 4.327908039093018
Total (block generation + training)time/epoch 21.346123218536377
Training time/epoch 0.5346560478210449
Training time without block to device /epoch 0.38820695877075195
Training time without total dataloading part /epoch 0.06121540069580078
load block tensor time/epoch 0.30438852310180664
block to device time/epoch 0.14644908905029297
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3019350
Number of first layer input nodes during this epoch:  1287205
