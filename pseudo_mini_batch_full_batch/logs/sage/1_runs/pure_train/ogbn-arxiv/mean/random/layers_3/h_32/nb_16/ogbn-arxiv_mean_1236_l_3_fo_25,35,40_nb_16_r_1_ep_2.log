Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648353221.9383812
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024295330047607422
random selection method range initialization spend 0.006346702575683594
time for parepare:  0.018358469009399414
local_output_nid generation:  0.002127408981323242
local_in_edges_tensor generation:  0.004687309265136719
mini_batch_src_global generation:  0.0016891956329345703
r_  generation:  0.017208337783813477
local_output_nid generation:  0.0024423599243164062
local_in_edges_tensor generation:  0.001683950424194336
mini_batch_src_global generation:  0.002070903778076172
r_  generation:  0.01722574234008789
local_output_nid generation:  0.0026407241821289062
local_in_edges_tensor generation:  0.0015358924865722656
mini_batch_src_global generation:  0.0013141632080078125
r_  generation:  0.017581939697265625
local_output_nid generation:  0.0027933120727539062
local_in_edges_tensor generation:  0.0015430450439453125
mini_batch_src_global generation:  0.0012156963348388672
r_  generation:  0.01754140853881836
local_output_nid generation:  0.0028276443481445312
local_in_edges_tensor generation:  0.0015392303466796875
mini_batch_src_global generation:  0.001430511474609375
r_  generation:  0.017554283142089844
local_output_nid generation:  0.002789735794067383
local_in_edges_tensor generation:  0.0014348030090332031
mini_batch_src_global generation:  0.001499176025390625
r_  generation:  0.017812252044677734
local_output_nid generation:  0.0027709007263183594
local_in_edges_tensor generation:  0.0014905929565429688
mini_batch_src_global generation:  0.0014574527740478516
r_  generation:  0.017682313919067383
local_output_nid generation:  0.002930879592895508
local_in_edges_tensor generation:  0.0014808177947998047
mini_batch_src_global generation:  0.0013284683227539062
r_  generation:  0.01848435401916504
local_output_nid generation:  0.0028815269470214844
local_in_edges_tensor generation:  0.0015025138854980469
mini_batch_src_global generation:  0.001470804214477539
r_  generation:  0.01829981803894043
local_output_nid generation:  0.0028464794158935547
local_in_edges_tensor generation:  0.0015461444854736328
mini_batch_src_global generation:  0.0014815330505371094
r_  generation:  0.018787145614624023
local_output_nid generation:  0.0028460025787353516
local_in_edges_tensor generation:  0.0014743804931640625
mini_batch_src_global generation:  0.001501321792602539
r_  generation:  0.018581390380859375
local_output_nid generation:  0.0028748512268066406
local_in_edges_tensor generation:  0.0014591217041015625
mini_batch_src_global generation:  0.001489400863647461
r_  generation:  0.018241167068481445
local_output_nid generation:  0.0027785301208496094
local_in_edges_tensor generation:  0.001398324966430664
mini_batch_src_global generation:  0.0014507770538330078
r_  generation:  0.018241405487060547
local_output_nid generation:  0.0028641223907470703
local_in_edges_tensor generation:  0.001459360122680664
mini_batch_src_global generation:  0.0014255046844482422
r_  generation:  0.018783092498779297
local_output_nid generation:  0.002823352813720703
local_in_edges_tensor generation:  0.001466989517211914
mini_batch_src_global generation:  0.0014567375183105469
r_  generation:  0.01790761947631836
local_output_nid generation:  0.002744913101196289
local_in_edges_tensor generation:  0.0014634132385253906
mini_batch_src_global generation:  0.001455068588256836
r_  generation:  0.01830911636352539
----------------------check_connections_block total spend ----------------------------- 0.47672152519226074
generate_one_block  0.027099609375
generate_one_block  0.0280611515045166
generate_one_block  0.030853748321533203
generate_one_block  0.027919769287109375
generate_one_block  0.02814197540283203
generate_one_block  0.02810811996459961
generate_one_block  0.027492284774780273
generate_one_block  0.027609586715698242
generate_one_block  0.027620792388916016
generate_one_block  0.027941226959228516
generate_one_block  0.027798891067504883
generate_one_block  0.027477264404296875
generate_one_block  0.027210712432861328
generate_one_block  0.02745795249938965
generate_one_block  0.02690291404724121
generate_one_block  0.02699589729309082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03775429725646973
gen group dst list time:  0.01847362518310547
time for parepare:  0.0192108154296875
local_output_nid generation:  0.007784128189086914
local_in_edges_tensor generation:  0.017200946807861328
mini_batch_src_global generation:  0.018142223358154297
r_  generation:  0.18673086166381836
local_output_nid generation:  0.012128114700317383
local_in_edges_tensor generation:  0.019770383834838867
mini_batch_src_global generation:  0.024007081985473633
r_  generation:  0.20307636260986328
local_output_nid generation:  0.011907815933227539
local_in_edges_tensor generation:  0.01596522331237793
mini_batch_src_global generation:  0.023128986358642578
r_  generation:  0.20819306373596191
local_output_nid generation:  0.011774301528930664
local_in_edges_tensor generation:  0.016038179397583008
mini_batch_src_global generation:  0.024787187576293945
r_  generation:  0.2083122730255127
local_output_nid generation:  0.011794328689575195
local_in_edges_tensor generation:  0.014178037643432617
mini_batch_src_global generation:  0.0250852108001709
r_  generation:  0.208449125289917
local_output_nid generation:  0.011782169342041016
local_in_edges_tensor generation:  0.014134407043457031
mini_batch_src_global generation:  0.025572776794433594
r_  generation:  0.20714473724365234
local_output_nid generation:  0.011702775955200195
local_in_edges_tensor generation:  0.015769481658935547
mini_batch_src_global generation:  0.025456666946411133
r_  generation:  0.20968413352966309
local_output_nid generation:  0.011712789535522461
local_in_edges_tensor generation:  0.014129161834716797
mini_batch_src_global generation:  0.02599954605102539
r_  generation:  0.2087247371673584
local_output_nid generation:  0.011713743209838867
local_in_edges_tensor generation:  0.015860795974731445
mini_batch_src_global generation:  0.025702953338623047
r_  generation:  0.20664286613464355
local_output_nid generation:  0.011972188949584961
local_in_edges_tensor generation:  0.016099214553833008
mini_batch_src_global generation:  0.026334524154663086
r_  generation:  0.21449065208435059
local_output_nid generation:  0.011742591857910156
local_in_edges_tensor generation:  0.013883113861083984
mini_batch_src_global generation:  0.025847911834716797
r_  generation:  0.2078857421875
local_output_nid generation:  0.01179957389831543
local_in_edges_tensor generation:  0.013849496841430664
mini_batch_src_global generation:  0.02785468101501465
r_  generation:  0.21119451522827148
local_output_nid generation:  0.011717557907104492
local_in_edges_tensor generation:  0.012235164642333984
mini_batch_src_global generation:  0.02635502815246582
r_  generation:  0.21034836769104004
local_output_nid generation:  0.011502981185913086
local_in_edges_tensor generation:  0.01346898078918457
mini_batch_src_global generation:  0.025954484939575195
r_  generation:  0.20692849159240723
local_output_nid generation:  0.011615514755249023
local_in_edges_tensor generation:  0.015382766723632812
mini_batch_src_global generation:  0.0254366397857666
r_  generation:  0.20429563522338867
local_output_nid generation:  0.011616230010986328
local_in_edges_tensor generation:  0.013950824737548828
mini_batch_src_global generation:  0.026207685470581055
r_  generation:  0.20767831802368164
----------------------check_connections_block total spend ----------------------------- 4.881087779998779
generate_one_block  0.2612183094024658
generate_one_block  0.27367424964904785
generate_one_block  0.2786562442779541
generate_one_block  0.27231884002685547
generate_one_block  0.2828655242919922
generate_one_block  0.27132272720336914
generate_one_block  0.2708923816680908
generate_one_block  0.26821112632751465
generate_one_block  0.2689800262451172
generate_one_block  0.27721476554870605
generate_one_block  0.26688146591186523
generate_one_block  0.27089953422546387
generate_one_block  0.26963329315185547
generate_one_block  0.2669641971588135
generate_one_block  0.2678952217102051
generate_one_block  0.27179598808288574
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04079174995422363
gen group dst list time:  0.060579538345336914
time for parepare:  0.01873302459716797
local_output_nid generation:  0.025593280792236328
local_in_edges_tensor generation:  0.03912234306335449
mini_batch_src_global generation:  0.04433727264404297
r_  generation:  0.4355916976928711
local_output_nid generation:  0.030762672424316406
local_in_edges_tensor generation:  0.04626798629760742
mini_batch_src_global generation:  0.053223371505737305
r_  generation:  0.44303154945373535
local_output_nid generation:  0.030240774154663086
local_in_edges_tensor generation:  0.04540681838989258
mini_batch_src_global generation:  0.050107717514038086
r_  generation:  0.455904483795166
local_output_nid generation:  0.0312962532043457
local_in_edges_tensor generation:  0.036083221435546875
mini_batch_src_global generation:  0.055383920669555664
r_  generation:  0.46219563484191895
local_output_nid generation:  0.030602455139160156
local_in_edges_tensor generation:  0.036298513412475586
mini_batch_src_global generation:  0.060605764389038086
r_  generation:  0.4581730365753174
local_output_nid generation:  0.03034663200378418
local_in_edges_tensor generation:  0.036669254302978516
mini_batch_src_global generation:  0.06029200553894043
r_  generation:  0.4485933780670166
local_output_nid generation:  0.03251504898071289
local_in_edges_tensor generation:  0.03299689292907715
mini_batch_src_global generation:  0.05493664741516113
r_  generation:  0.45714640617370605
local_output_nid generation:  0.031545162200927734
local_in_edges_tensor generation:  0.040520429611206055
mini_batch_src_global generation:  0.052564382553100586
r_  generation:  0.4495365619659424
local_output_nid generation:  0.031296491622924805
local_in_edges_tensor generation:  0.028212308883666992
mini_batch_src_global generation:  0.05253291130065918
r_  generation:  0.45603513717651367
local_output_nid generation:  0.03131604194641113
local_in_edges_tensor generation:  0.040540456771850586
mini_batch_src_global generation:  0.05468273162841797
r_  generation:  0.45096850395202637
local_output_nid generation:  0.03112173080444336
local_in_edges_tensor generation:  0.029020309448242188
mini_batch_src_global generation:  0.05269885063171387
r_  generation:  0.45744848251342773
local_output_nid generation:  0.03108525276184082
local_in_edges_tensor generation:  0.028449535369873047
mini_batch_src_global generation:  0.05557847023010254
r_  generation:  0.45111751556396484
local_output_nid generation:  0.031194448471069336
local_in_edges_tensor generation:  0.028891801834106445
mini_batch_src_global generation:  0.052767276763916016
r_  generation:  0.4555087089538574
local_output_nid generation:  0.030993223190307617
local_in_edges_tensor generation:  0.03247499465942383
mini_batch_src_global generation:  0.06742596626281738
r_  generation:  0.4509725570678711
local_output_nid generation:  0.031239748001098633
local_in_edges_tensor generation:  0.040018558502197266
mini_batch_src_global generation:  0.0527193546295166
r_  generation:  0.4606666564941406
local_output_nid generation:  0.03129434585571289
local_in_edges_tensor generation:  0.035452842712402344
mini_batch_src_global generation:  0.05274820327758789
r_  generation:  0.4517993927001953
----------------------check_connections_block total spend ----------------------------- 10.780517816543579
generate_one_block  0.5806028842926025
generate_one_block  0.5938098430633545
generate_one_block  0.59389328956604
generate_one_block  0.587031364440918
generate_one_block  0.5802357196807861
generate_one_block  0.5765728950500488
generate_one_block  0.619713544845581
generate_one_block  0.594965934753418
generate_one_block  0.5900740623474121
generate_one_block  0.5914885997772217
generate_one_block  0.5797286033630371
generate_one_block  0.5834202766418457
generate_one_block  0.5761706829071045
generate_one_block  0.5765058994293213
generate_one_block  0.5894222259521484
generate_one_block  0.5724771022796631
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  15.661605596542358
block generation total time  13.725536823272705
average batch blocks generation time:  0.8578460514545441
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08970880508422852  GigaBytes
Max Memory Allocated: 0.08970880508422852  GigaBytes

torch.Size([154106, 128])
torch.Size([121460, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.17832660675048828  GigaBytes
Max Memory Allocated: 0.18037748336791992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.09088325500488281  GigaBytes
Max Memory Allocated: 0.18980026245117188  GigaBytes

torch.Size([154330, 128])
torch.Size([122315, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17927074432373047  GigaBytes
Max Memory Allocated: 0.18980026245117188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09091472625732422  GigaBytes
Max Memory Allocated: 0.1908130645751953  GigaBytes

torch.Size([154822, 128])
torch.Size([123444, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1819615364074707  GigaBytes
Max Memory Allocated: 0.1908130645751953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09086036682128906  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([155080, 128])
torch.Size([123311, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.18192815780639648  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09081554412841797  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154717, 128])
torch.Size([123282, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.18192625045776367  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09072399139404297  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([153997, 128])
torch.Size([121523, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1787419319152832  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09076499938964844  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154752, 128])
torch.Size([122834, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17984628677368164  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.0907135009765625  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154219, 128])
torch.Size([122280, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17900323867797852  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09070873260498047  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154754, 128])
torch.Size([122609, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17912912368774414  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09086227416992188  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154505, 128])
torch.Size([122693, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17934417724609375  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09067726135253906  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154472, 128])
torch.Size([122247, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.178955078125  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09076118469238281  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154399, 128])
torch.Size([122432, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1791086196899414  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09066295623779297  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154607, 128])
torch.Size([122551, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1790599822998047  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09064102172851562  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154137, 128])
torch.Size([121814, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17876911163330078  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09062480926513672  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154385, 128])
torch.Size([122252, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17670917510986328  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09062385559082031  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154464, 128])
torch.Size([122458, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17798566818237305  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03160417079925537 |0.03475889563560486 |0.04994481801986694 |9.991228580474854e-05 |0.007302999496459961 |0.0016667842864990234 |
----------------------------------------------------------pseudo_mini_loss sum 5.01299524307251
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5092238
Number of first layer input nodes during this epoch:  2471746
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.12491130828857422  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021439552307128906
random selection method range initialization spend 0.0053212642669677734
time for parepare:  0.017541885375976562
local_output_nid generation:  0.0024607181549072266
local_in_edges_tensor generation:  0.0056858062744140625
mini_batch_src_global generation:  0.001760244369506836
r_  generation:  0.017398357391357422
local_output_nid generation:  0.003156423568725586
local_in_edges_tensor generation:  0.0016477108001708984
mini_batch_src_global generation:  0.0021970272064208984
r_  generation:  0.0181121826171875
local_output_nid generation:  0.003432750701904297
local_in_edges_tensor generation:  0.001512289047241211
mini_batch_src_global generation:  0.001421213150024414
r_  generation:  0.018243789672851562
local_output_nid generation:  0.0034770965576171875
local_in_edges_tensor generation:  0.0015327930450439453
mini_batch_src_global generation:  0.0014548301696777344
r_  generation:  0.0191802978515625
local_output_nid generation:  0.003541707992553711
local_in_edges_tensor generation:  0.0014808177947998047
mini_batch_src_global generation:  0.0013859272003173828
r_  generation:  0.01882767677307129
local_output_nid generation:  0.003536224365234375
local_in_edges_tensor generation:  0.0015213489532470703
mini_batch_src_global generation:  0.0014615058898925781
r_  generation:  0.019280672073364258
local_output_nid generation:  0.0035877227783203125
local_in_edges_tensor generation:  0.0014553070068359375
mini_batch_src_global generation:  0.0015118122100830078
r_  generation:  0.01928400993347168
local_output_nid generation:  0.003587961196899414
local_in_edges_tensor generation:  0.0014405250549316406
mini_batch_src_global generation:  0.0014805793762207031
r_  generation:  0.019072532653808594
local_output_nid generation:  0.0035881996154785156
local_in_edges_tensor generation:  0.001416921615600586
mini_batch_src_global generation:  0.0014388561248779297
r_  generation:  0.018995046615600586
local_output_nid generation:  0.0035719871520996094
local_in_edges_tensor generation:  0.0014934539794921875
mini_batch_src_global generation:  0.0014760494232177734
r_  generation:  0.019667625427246094
local_output_nid generation:  0.003610372543334961
local_in_edges_tensor generation:  0.001439809799194336
mini_batch_src_global generation:  0.0015208721160888672
r_  generation:  0.019622325897216797
local_output_nid generation:  0.003553152084350586
local_in_edges_tensor generation:  0.0014219284057617188
mini_batch_src_global generation:  0.0015254020690917969
r_  generation:  0.019517183303833008
local_output_nid generation:  0.003636598587036133
local_in_edges_tensor generation:  0.0014400482177734375
mini_batch_src_global generation:  0.001486063003540039
r_  generation:  0.01940441131591797
local_output_nid generation:  0.0035600662231445312
local_in_edges_tensor generation:  0.0014183521270751953
mini_batch_src_global generation:  0.0015277862548828125
r_  generation:  0.019383668899536133
local_output_nid generation:  0.003568410873413086
local_in_edges_tensor generation:  0.001405954360961914
mini_batch_src_global generation:  0.0015001296997070312
r_  generation:  0.019601106643676758
local_output_nid generation:  0.0034792423248291016
local_in_edges_tensor generation:  0.0014641284942626953
mini_batch_src_global generation:  0.0015206336975097656
r_  generation:  0.019492149353027344
----------------------check_connections_block total spend ----------------------------- 0.5118181705474854
generate_one_block  0.04122495651245117
generate_one_block  0.028298139572143555
generate_one_block  0.027471303939819336
generate_one_block  0.028167009353637695
generate_one_block  0.027808189392089844
generate_one_block  0.030766725540161133
generate_one_block  0.02818012237548828
generate_one_block  0.02761220932006836
generate_one_block  0.02777695655822754
generate_one_block  0.028412342071533203
generate_one_block  0.028196096420288086
generate_one_block  0.027945518493652344
generate_one_block  0.028179168701171875
generate_one_block  0.028202056884765625
generate_one_block  0.028357744216918945
generate_one_block  0.028374433517456055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035341501235961914
gen group dst list time:  0.017431020736694336
time for parepare:  0.018889427185058594
local_output_nid generation:  0.008068323135375977
local_in_edges_tensor generation:  0.016351938247680664
mini_batch_src_global generation:  0.022227764129638672
r_  generation:  0.19991397857666016
local_output_nid generation:  0.014925956726074219
local_in_edges_tensor generation:  0.02535533905029297
mini_batch_src_global generation:  0.029011011123657227
r_  generation:  0.1945946216583252
local_output_nid generation:  0.01519465446472168
local_in_edges_tensor generation:  0.016959667205810547
mini_batch_src_global generation:  0.022759199142456055
r_  generation:  0.20930194854736328
local_output_nid generation:  0.012981653213500977
local_in_edges_tensor generation:  0.016733884811401367
mini_batch_src_global generation:  0.024225234985351562
r_  generation:  0.20708537101745605
local_output_nid generation:  0.015263557434082031
local_in_edges_tensor generation:  0.012578487396240234
mini_batch_src_global generation:  0.02515435218811035
r_  generation:  0.22160601615905762
local_output_nid generation:  0.01244807243347168
local_in_edges_tensor generation:  0.012830972671508789
mini_batch_src_global generation:  0.02637028694152832
r_  generation:  0.21358776092529297
local_output_nid generation:  0.014577150344848633
local_in_edges_tensor generation:  0.014536380767822266
mini_batch_src_global generation:  0.025897502899169922
r_  generation:  0.21287083625793457
local_output_nid generation:  0.012337446212768555
local_in_edges_tensor generation:  0.014074087142944336
mini_batch_src_global generation:  0.025944948196411133
r_  generation:  0.20714259147644043
local_output_nid generation:  0.015751123428344727
local_in_edges_tensor generation:  0.017791748046875
mini_batch_src_global generation:  0.026102542877197266
r_  generation:  0.22719788551330566
local_output_nid generation:  0.014267206192016602
local_in_edges_tensor generation:  0.025935888290405273
mini_batch_src_global generation:  0.02838277816772461
r_  generation:  0.2152881622314453
local_output_nid generation:  0.012222528457641602
local_in_edges_tensor generation:  0.014209270477294922
mini_batch_src_global generation:  0.027861356735229492
r_  generation:  0.21849536895751953
local_output_nid generation:  0.012267827987670898
local_in_edges_tensor generation:  0.014249563217163086
mini_batch_src_global generation:  0.026431560516357422
r_  generation:  0.22115588188171387
local_output_nid generation:  0.01235055923461914
local_in_edges_tensor generation:  0.013433456420898438
mini_batch_src_global generation:  0.026073932647705078
r_  generation:  0.21253466606140137
local_output_nid generation:  0.012194633483886719
local_in_edges_tensor generation:  0.017409801483154297
mini_batch_src_global generation:  0.02649378776550293
r_  generation:  0.21053647994995117
local_output_nid generation:  0.012378215789794922
local_in_edges_tensor generation:  0.013460159301757812
mini_batch_src_global generation:  0.02761054039001465
r_  generation:  0.2134084701538086
local_output_nid generation:  0.012162208557128906
local_in_edges_tensor generation:  0.011343955993652344
mini_batch_src_global generation:  0.02750420570373535
r_  generation:  0.21336627006530762
----------------------check_connections_block total spend ----------------------------- 5.04519248008728
generate_one_block  0.2751736640930176
generate_one_block  0.274486780166626
generate_one_block  0.27376556396484375
generate_one_block  0.27813076972961426
generate_one_block  0.2690119743347168
generate_one_block  0.2766108512878418
generate_one_block  0.32543039321899414
generate_one_block  0.26491570472717285
generate_one_block  0.26885437965393066
generate_one_block  0.2719602584838867
generate_one_block  0.2761971950531006
generate_one_block  0.2697591781616211
generate_one_block  0.2722747325897217
generate_one_block  0.2723419666290283
generate_one_block  0.2709789276123047
generate_one_block  0.2678368091583252
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04938244819641113
gen group dst list time:  0.06616926193237305
time for parepare:  0.018558979034423828
local_output_nid generation:  0.026327848434448242
local_in_edges_tensor generation:  0.06220102310180664
mini_batch_src_global generation:  0.0419614315032959
r_  generation:  0.43628716468811035
local_output_nid generation:  0.031266212463378906
local_in_edges_tensor generation:  0.04822397232055664
mini_batch_src_global generation:  0.05083727836608887
r_  generation:  0.44701457023620605
local_output_nid generation:  0.031139135360717773
local_in_edges_tensor generation:  0.04003715515136719
mini_batch_src_global generation:  0.05491042137145996
r_  generation:  0.4487180709838867
local_output_nid generation:  0.03092789649963379
local_in_edges_tensor generation:  0.03676652908325195
mini_batch_src_global generation:  0.0519099235534668
r_  generation:  0.4527909755706787
local_output_nid generation:  0.031473636627197266
local_in_edges_tensor generation:  0.07611846923828125
mini_batch_src_global generation:  0.05457019805908203
r_  generation:  0.45540618896484375
local_output_nid generation:  0.03224825859069824
local_in_edges_tensor generation:  0.04010581970214844
mini_batch_src_global generation:  0.052225589752197266
r_  generation:  0.45590877532958984
local_output_nid generation:  0.03156542778015137
local_in_edges_tensor generation:  0.036450862884521484
mini_batch_src_global generation:  0.05314922332763672
r_  generation:  0.458324670791626
local_output_nid generation:  0.03100442886352539
local_in_edges_tensor generation:  0.031763553619384766
mini_batch_src_global generation:  0.05295395851135254
r_  generation:  0.4565155506134033
local_output_nid generation:  0.031098604202270508
local_in_edges_tensor generation:  0.03992033004760742
mini_batch_src_global generation:  0.051416873931884766
r_  generation:  0.45919227600097656
local_output_nid generation:  0.03183150291442871
local_in_edges_tensor generation:  0.03991889953613281
mini_batch_src_global generation:  0.052980661392211914
r_  generation:  0.45464515686035156
local_output_nid generation:  0.03097844123840332
local_in_edges_tensor generation:  0.04073905944824219
mini_batch_src_global generation:  0.05614519119262695
r_  generation:  0.4643266201019287
local_output_nid generation:  0.030990123748779297
local_in_edges_tensor generation:  0.032094478607177734
mini_batch_src_global generation:  0.05239248275756836
r_  generation:  0.4532036781311035
local_output_nid generation:  0.03147387504577637
local_in_edges_tensor generation:  0.032973289489746094
mini_batch_src_global generation:  0.05138516426086426
r_  generation:  0.4714810848236084
local_output_nid generation:  0.03102278709411621
local_in_edges_tensor generation:  0.03493356704711914
mini_batch_src_global generation:  0.05308985710144043
r_  generation:  0.4520747661590576
local_output_nid generation:  0.031182050704956055
local_in_edges_tensor generation:  0.04376673698425293
mini_batch_src_global generation:  0.05175447463989258
r_  generation:  0.4631173610687256
local_output_nid generation:  0.03155684471130371
local_in_edges_tensor generation:  0.03587222099304199
mini_batch_src_global generation:  0.05275988578796387
r_  generation:  0.4531369209289551
----------------------check_connections_block total spend ----------------------------- 10.849512577056885
generate_one_block  0.5660233497619629
generate_one_block  0.5800831317901611
generate_one_block  0.578819990158081
generate_one_block  0.5646848678588867
generate_one_block  0.590576171875
generate_one_block  0.5837068557739258
generate_one_block  0.5700826644897461
generate_one_block  0.5709471702575684
generate_one_block  0.6069071292877197
generate_one_block  0.5846359729766846
generate_one_block  0.578887939453125
generate_one_block  0.6193864345550537
generate_one_block  0.570037841796875
generate_one_block  0.6120948791503906
generate_one_block  0.6210825443267822
generate_one_block  0.5933151245117188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.12491130828857422  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

connection checking time:  15.894705057144165
block generation total time  13.799001216888428
average batch blocks generation time:  0.8624375760555267
block dataloader generation time/epoch 31.854053497314453
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.0907292366027832  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154337, 128])
torch.Size([121884, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17778587341308594  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09075546264648438  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154682, 128])
torch.Size([122587, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17915773391723633  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09089279174804688  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154548, 128])
torch.Size([122527, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17927265167236328  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09088420867919922  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154110, 128])
torch.Size([122078, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17911386489868164  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09083747863769531  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154535, 128])
torch.Size([122665, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17929935455322266  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09090995788574219  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154572, 128])
torch.Size([123015, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.18195486068725586  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09090423583984375  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154389, 128])
torch.Size([122514, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1792888641357422  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09078311920166016  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154079, 128])
torch.Size([122031, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17795515060424805  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09082412719726562  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154303, 128])
torch.Size([122244, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17909526824951172  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09087848663330078  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154547, 128])
torch.Size([122407, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17923212051391602  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.0909433364868164  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154402, 128])
torch.Size([122202, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1792922019958496  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09082698822021484  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154534, 128])
torch.Size([122200, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17908859252929688  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09078025817871094  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154653, 128])
torch.Size([122487, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17915582656860352  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09084606170654297  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154563, 128])
torch.Size([122605, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17926788330078125  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09088897705078125  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154700, 128])
torch.Size([122845, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1799602508544922  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09079742431640625  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

torch.Size([154654, 128])
torch.Size([122462, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1791682243347168  GigaBytes
Max Memory Allocated: 0.1934032440185547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027915343642234802 |0.015114128589630127 |0.0033867359161376953 |9.082257747650146e-05 |0.003888934850692749 |0.002901315689086914 |
----------------------------------------------------------pseudo_mini_loss sum 4.317779064178467
Total (block generation + training)time/epoch 32.68620443344116
Training time/epoch 0.8318824768066406
Training time without block to device /epoch 0.5900564193725586
Training time without total dataloading part /epoch 0.12076520919799805
load block tensor time/epoch 0.44664549827575684
block to device time/epoch 0.24182605743408203
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5091589
Number of first layer input nodes during this epoch:  2471608
