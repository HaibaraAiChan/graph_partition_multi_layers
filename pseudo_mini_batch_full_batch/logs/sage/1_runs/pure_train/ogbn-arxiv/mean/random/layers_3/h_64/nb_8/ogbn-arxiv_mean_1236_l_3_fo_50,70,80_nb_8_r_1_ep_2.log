Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648356636.96879
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030457258224487305
random selection method range initialization spend 0.00799250602722168
time for parepare:  0.019356727600097656
local_output_nid generation:  0.004301309585571289
local_in_edges_tensor generation:  0.007723093032836914
mini_batch_src_global generation:  0.004333019256591797
r_  generation:  0.05338454246520996
local_output_nid generation:  0.005776643753051758
local_in_edges_tensor generation:  0.0033495426177978516
mini_batch_src_global generation:  0.004665374755859375
r_  generation:  0.043248891830444336
local_output_nid generation:  0.006090879440307617
local_in_edges_tensor generation:  0.0032317638397216797
mini_batch_src_global generation:  0.0031609535217285156
r_  generation:  0.043066978454589844
local_output_nid generation:  0.006086826324462891
local_in_edges_tensor generation:  0.0032460689544677734
mini_batch_src_global generation:  0.003319263458251953
r_  generation:  0.04496026039123535
local_output_nid generation:  0.006165266036987305
local_in_edges_tensor generation:  0.0032532215118408203
mini_batch_src_global generation:  0.0036361217498779297
r_  generation:  0.04674100875854492
local_output_nid generation:  0.006191730499267578
local_in_edges_tensor generation:  0.0032396316528320312
mini_batch_src_global generation:  0.0039370059967041016
r_  generation:  0.0464174747467041
local_output_nid generation:  0.00615692138671875
local_in_edges_tensor generation:  0.0032777786254882812
mini_batch_src_global generation:  0.0038003921508789062
r_  generation:  0.04622387886047363
local_output_nid generation:  0.006177186965942383
local_in_edges_tensor generation:  0.0032684803009033203
mini_batch_src_global generation:  0.0038652420043945312
r_  generation:  0.04601335525512695
----------------------check_connections_block total spend ----------------------------- 0.5832459926605225
generate_one_block  0.062468767166137695
generate_one_block  0.061791419982910156
generate_one_block  0.0608518123626709
generate_one_block  0.06226658821105957
generate_one_block  0.06743836402893066
generate_one_block  0.06449031829833984
generate_one_block  0.06286048889160156
generate_one_block  0.06246495246887207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043265581130981445
gen group dst list time:  0.016669034957885742
time for parepare:  0.020674943923950195
local_output_nid generation:  0.01506185531616211
local_in_edges_tensor generation:  0.03545093536376953
mini_batch_src_global generation:  0.038391828536987305
r_  generation:  0.35929203033447266
local_output_nid generation:  0.024128437042236328
local_in_edges_tensor generation:  0.03601479530334473
mini_batch_src_global generation:  0.044615983963012695
r_  generation:  0.3705003261566162
local_output_nid generation:  0.023750782012939453
local_in_edges_tensor generation:  0.025921106338500977
mini_batch_src_global generation:  0.04418134689331055
r_  generation:  0.3723008632659912
local_output_nid generation:  0.024128198623657227
local_in_edges_tensor generation:  0.025295495986938477
mini_batch_src_global generation:  0.048256874084472656
r_  generation:  0.3806886672973633
local_output_nid generation:  0.0235445499420166
local_in_edges_tensor generation:  0.02552318572998047
mini_batch_src_global generation:  0.04637312889099121
r_  generation:  0.37984657287597656
local_output_nid generation:  0.024358034133911133
local_in_edges_tensor generation:  0.02935934066772461
mini_batch_src_global generation:  0.04748725891113281
r_  generation:  0.39504575729370117
local_output_nid generation:  0.023863792419433594
local_in_edges_tensor generation:  0.02243185043334961
mini_batch_src_global generation:  0.04614448547363281
r_  generation:  0.3872802257537842
local_output_nid generation:  0.024207353591918945
local_in_edges_tensor generation:  0.02847003936767578
mini_batch_src_global generation:  0.047208547592163086
r_  generation:  0.3892030715942383
----------------------check_connections_block total spend ----------------------------- 4.468378782272339
generate_one_block  0.5079095363616943
generate_one_block  0.5158817768096924
generate_one_block  0.4889853000640869
generate_one_block  0.5001156330108643
generate_one_block  0.49710965156555176
generate_one_block  0.5166118144989014
generate_one_block  0.5054605007171631
generate_one_block  0.4930844306945801
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03767848014831543
gen group dst list time:  0.03764772415161133
time for parepare:  0.019214630126953125
local_output_nid generation:  0.02916693687438965
local_in_edges_tensor generation:  0.04849505424499512
mini_batch_src_global generation:  0.05221199989318848
r_  generation:  0.5428612232208252
local_output_nid generation:  0.038576364517211914
local_in_edges_tensor generation:  0.053399085998535156
mini_batch_src_global generation:  0.06368613243103027
r_  generation:  0.5530416965484619
local_output_nid generation:  0.035566091537475586
local_in_edges_tensor generation:  0.04562115669250488
mini_batch_src_global generation:  0.06108689308166504
r_  generation:  0.5557172298431396
local_output_nid generation:  0.035506486892700195
local_in_edges_tensor generation:  0.03928518295288086
mini_batch_src_global generation:  0.060419559478759766
r_  generation:  0.5732407569885254
local_output_nid generation:  0.0359349250793457
local_in_edges_tensor generation:  0.04505777359008789
mini_batch_src_global generation:  0.06604266166687012
r_  generation:  0.5643072128295898
local_output_nid generation:  0.03573155403137207
local_in_edges_tensor generation:  0.039322853088378906
mini_batch_src_global generation:  0.06613659858703613
r_  generation:  0.5689184665679932
local_output_nid generation:  0.03555941581726074
local_in_edges_tensor generation:  0.035619258880615234
mini_batch_src_global generation:  0.06329774856567383
r_  generation:  0.5702006816864014
local_output_nid generation:  0.03563427925109863
local_in_edges_tensor generation:  0.049056053161621094
mini_batch_src_global generation:  0.06240701675415039
r_  generation:  0.5681171417236328
----------------------check_connections_block total spend ----------------------------- 6.637221813201904
generate_one_block  0.749608039855957
generate_one_block  0.7352988719940186
generate_one_block  0.7129826545715332
generate_one_block  0.7294483184814453
generate_one_block  0.7266411781311035
generate_one_block  0.7202568054199219
generate_one_block  0.72951340675354
generate_one_block  0.7015273571014404
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  11.105600595474243
block generation total time  9.830435276031494
average batch blocks generation time:  1.2288044095039368
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10166358947753906  GigaBytes
Max Memory Allocated: 0.10166358947753906  GigaBytes

torch.Size([162565, 128])
torch.Size([146001, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.3197188377380371  GigaBytes
Max Memory Allocated: 0.3329038619995117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.10392904281616211  GigaBytes
Max Memory Allocated: 0.35448455810546875  GigaBytes

torch.Size([162521, 128])
torch.Size([145978, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.3203296661376953  GigaBytes
Max Memory Allocated: 0.35448455810546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.10384225845336914  GigaBytes
Max Memory Allocated: 0.35489654541015625  GigaBytes

torch.Size([162696, 128])
torch.Size([145816, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.31928348541259766  GigaBytes
Max Memory Allocated: 0.35489654541015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.10432767868041992  GigaBytes
Max Memory Allocated: 0.35489654541015625  GigaBytes

torch.Size([162640, 128])
torch.Size([146097, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.3199453353881836  GigaBytes
Max Memory Allocated: 0.35489654541015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.10398101806640625  GigaBytes
Max Memory Allocated: 0.35489654541015625  GigaBytes

torch.Size([162651, 128])
torch.Size([146022, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.3198680877685547  GigaBytes
Max Memory Allocated: 0.35489654541015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10419034957885742  GigaBytes
Max Memory Allocated: 0.35489654541015625  GigaBytes

torch.Size([162707, 128])
torch.Size([146410, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3204832077026367  GigaBytes
Max Memory Allocated: 0.35489654541015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10389232635498047  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

torch.Size([162549, 128])
torch.Size([145878, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.31974077224731445  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10408449172973633  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

torch.Size([162711, 128])
torch.Size([145799, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.31932592391967773  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038004398345947266 |0.04930746555328369 |0.09248000383377075 |0.00010442733764648438 |0.012508541345596313 |0.0022878646850585938 |
----------------------------------------------------------pseudo_mini_loss sum 5.318028450012207
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3058177
Number of first layer input nodes during this epoch:  1301040
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.1529841423034668  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02238774299621582
random selection method range initialization spend 0.00574183464050293
time for parepare:  0.017394542694091797
local_output_nid generation:  0.004402875900268555
local_in_edges_tensor generation:  0.006596088409423828
mini_batch_src_global generation:  0.0037467479705810547
r_  generation:  0.04048275947570801
local_output_nid generation:  0.005791664123535156
local_in_edges_tensor generation:  0.0032303333282470703
mini_batch_src_global generation:  0.004790782928466797
r_  generation:  0.04372358322143555
local_output_nid generation:  0.006011486053466797
local_in_edges_tensor generation:  0.0035245418548583984
mini_batch_src_global generation:  0.0033092498779296875
r_  generation:  0.04899263381958008
local_output_nid generation:  0.006022930145263672
local_in_edges_tensor generation:  0.0034530162811279297
mini_batch_src_global generation:  0.003595113754272461
r_  generation:  0.04698824882507324
local_output_nid generation:  0.006005287170410156
local_in_edges_tensor generation:  0.0033779144287109375
mini_batch_src_global generation:  0.0037813186645507812
r_  generation:  0.0487513542175293
local_output_nid generation:  0.00609588623046875
local_in_edges_tensor generation:  0.0035178661346435547
mini_batch_src_global generation:  0.0039408206939697266
r_  generation:  0.051665306091308594
local_output_nid generation:  0.006119489669799805
local_in_edges_tensor generation:  0.0036420822143554688
mini_batch_src_global generation:  0.004030466079711914
r_  generation:  0.0466763973236084
local_output_nid generation:  0.006097078323364258
local_in_edges_tensor generation:  0.003493070602416992
mini_batch_src_global generation:  0.004101991653442383
r_  generation:  0.04817938804626465
----------------------check_connections_block total spend ----------------------------- 0.6044392585754395
generate_one_block  0.06492495536804199
generate_one_block  0.06364822387695312
generate_one_block  0.06410551071166992
generate_one_block  0.06191277503967285
generate_one_block  0.06568431854248047
generate_one_block  0.06561660766601562
generate_one_block  0.06807947158813477
generate_one_block  0.06613755226135254
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06535005569458008
gen group dst list time:  0.016805171966552734
time for parepare:  0.02161574363708496
local_output_nid generation:  0.014467239379882812
local_in_edges_tensor generation:  0.04955315589904785
mini_batch_src_global generation:  0.035614013671875
r_  generation:  0.3556098937988281
local_output_nid generation:  0.02007126808166504
local_in_edges_tensor generation:  0.03427243232727051
mini_batch_src_global generation:  0.04423236846923828
r_  generation:  0.3674027919769287
local_output_nid generation:  0.019721508026123047
local_in_edges_tensor generation:  0.028811931610107422
mini_batch_src_global generation:  0.04459786415100098
r_  generation:  0.38223791122436523
local_output_nid generation:  0.0194244384765625
local_in_edges_tensor generation:  0.028574466705322266
mini_batch_src_global generation:  0.04645562171936035
r_  generation:  0.3824198246002197
local_output_nid generation:  0.01938652992248535
local_in_edges_tensor generation:  0.024564266204833984
mini_batch_src_global generation:  0.04687952995300293
r_  generation:  0.38608431816101074
local_output_nid generation:  0.019382953643798828
local_in_edges_tensor generation:  0.02589726448059082
mini_batch_src_global generation:  0.046744585037231445
r_  generation:  0.39353489875793457
local_output_nid generation:  0.019465923309326172
local_in_edges_tensor generation:  0.02478480339050293
mini_batch_src_global generation:  0.04750823974609375
r_  generation:  0.380190372467041
local_output_nid generation:  0.019553661346435547
local_in_edges_tensor generation:  0.028671741485595703
mini_batch_src_global generation:  0.04672694206237793
r_  generation:  0.3879690170288086
----------------------check_connections_block total spend ----------------------------- 4.450443267822266
generate_one_block  0.5017654895782471
generate_one_block  0.4903225898742676
generate_one_block  0.5294969081878662
generate_one_block  0.5039658546447754
generate_one_block  0.5083439350128174
generate_one_block  0.5321390628814697
generate_one_block  0.49484705924987793
generate_one_block  0.5374152660369873
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03989839553833008
gen group dst list time:  0.03859448432922363
time for parepare:  0.019485950469970703
local_output_nid generation:  0.02890944480895996
local_in_edges_tensor generation:  0.07324719429016113
mini_batch_src_global generation:  0.051928043365478516
r_  generation:  0.549640417098999
local_output_nid generation:  0.035063743591308594
local_in_edges_tensor generation:  0.05479121208190918
mini_batch_src_global generation:  0.0641477108001709
r_  generation:  0.5733232498168945
local_output_nid generation:  0.03618049621582031
local_in_edges_tensor generation:  0.04378533363342285
mini_batch_src_global generation:  0.06516504287719727
r_  generation:  0.5635595321655273
local_output_nid generation:  0.03683972358703613
local_in_edges_tensor generation:  0.05738425254821777
mini_batch_src_global generation:  0.06079244613647461
r_  generation:  0.5780529975891113
local_output_nid generation:  0.03834128379821777
local_in_edges_tensor generation:  0.047605037689208984
mini_batch_src_global generation:  0.06532526016235352
r_  generation:  0.5623583793640137
local_output_nid generation:  0.03695487976074219
local_in_edges_tensor generation:  0.040198326110839844
mini_batch_src_global generation:  0.0641927719116211
r_  generation:  0.5657253265380859
local_output_nid generation:  0.036360979080200195
local_in_edges_tensor generation:  0.040419816970825195
mini_batch_src_global generation:  0.06297683715820312
r_  generation:  0.5675389766693115
local_output_nid generation:  0.0373377799987793
local_in_edges_tensor generation:  0.05597424507141113
mini_batch_src_global generation:  0.062113046646118164
r_  generation:  0.5753321647644043
----------------------check_connections_block total spend ----------------------------- 6.756009340286255
generate_one_block  0.7245121002197266
generate_one_block  0.7195746898651123
generate_one_block  0.7189631462097168
generate_one_block  0.7104084491729736
generate_one_block  0.7056264877319336
generate_one_block  0.6991028785705566
generate_one_block  0.7113282680511475
generate_one_block  0.7096970081329346
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.1529841423034668  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

connection checking time:  11.20645260810852
block generation total time  9.79750919342041
average batch blocks generation time:  1.2246886491775513
block dataloader generation time/epoch 23.188368320465088
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10422945022583008  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

torch.Size([162818, 128])
torch.Size([146240, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3198380470275879  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10410594940185547  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

torch.Size([162522, 128])
torch.Size([145341, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3193669319152832  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10465478897094727  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

torch.Size([162599, 128])
torch.Size([145971, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.32051610946655273  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10420942306518555  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

torch.Size([162812, 128])
torch.Size([146254, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3200864791870117  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10445594787597656  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

torch.Size([162612, 128])
torch.Size([145804, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3206520080566406  GigaBytes
Max Memory Allocated: 0.35526323318481445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10425615310668945  GigaBytes
Max Memory Allocated: 0.3553614616394043  GigaBytes

torch.Size([162400, 128])
torch.Size([145523, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3203096389770508  GigaBytes
Max Memory Allocated: 0.3553614616394043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10418987274169922  GigaBytes
Max Memory Allocated: 0.3553614616394043  GigaBytes

torch.Size([162544, 128])
torch.Size([145813, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3197193145751953  GigaBytes
Max Memory Allocated: 0.3553614616394043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10443305969238281  GigaBytes
Max Memory Allocated: 0.3553614616394043  GigaBytes

torch.Size([162661, 128])
torch.Size([145918, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3206491470336914  GigaBytes
Max Memory Allocated: 0.3553614616394043  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.042044490575790405 |0.017899423837661743 |0.0035657286643981934 |9.202957153320312e-05 |0.007333159446716309 |0.0015692710876464844 |
----------------------------------------------------------pseudo_mini_loss sum 4.083693504333496
Total (block generation + training)time/epoch 23.784296989440918
Training time/epoch 0.5956907272338867
Training time without block to device /epoch 0.4524953365325928
Training time without total dataloading part /epoch 0.08949661254882812
load block tensor time/epoch 0.33635592460632324
block to device time/epoch 0.14319539070129395
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3056948
Number of first layer input nodes during this epoch:  1300968
