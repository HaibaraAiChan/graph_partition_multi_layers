Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648357134.1155121
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024582386016845703
random selection method range initialization spend 0.006242036819458008
time for parepare:  0.01828622817993164
local_output_nid generation:  0.01601576805114746
local_in_edges_tensor generation:  0.01522064208984375
mini_batch_src_global generation:  0.013736724853515625
r_  generation:  0.16533517837524414
local_output_nid generation:  0.023065567016601562
local_in_edges_tensor generation:  0.015911102294921875
mini_batch_src_global generation:  0.017150163650512695
r_  generation:  0.17568325996398926
----------------------check_connections_block total spend ----------------------------- 0.5382921695709229
generate_one_block  0.19855284690856934
generate_one_block  0.1988694667816162
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04003477096557617
gen group dst list time:  0.007237911224365234
time for parepare:  0.02001166343688965
local_output_nid generation:  0.02557063102722168
local_in_edges_tensor generation:  0.05062150955200195
mini_batch_src_global generation:  0.04947805404663086
r_  generation:  0.48047637939453125
local_output_nid generation:  0.03558063507080078
local_in_edges_tensor generation:  0.049784183502197266
mini_batch_src_global generation:  0.05599355697631836
r_  generation:  0.49245262145996094
----------------------check_connections_block total spend ----------------------------- 1.4887969493865967
generate_one_block  0.6255486011505127
generate_one_block  0.6456582546234131
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028667926788330078
gen group dst list time:  0.011469841003417969
time for parepare:  0.01967000961303711
local_output_nid generation:  0.03139233589172363
local_in_edges_tensor generation:  0.047663211822509766
mini_batch_src_global generation:  0.04774808883666992
r_  generation:  0.5037641525268555
local_output_nid generation:  0.04222917556762695
local_in_edges_tensor generation:  0.051349639892578125
mini_batch_src_global generation:  0.05707502365112305
r_  generation:  0.5101981163024902
----------------------check_connections_block total spend ----------------------------- 1.5564360618591309
generate_one_block  0.6633288860321045
generate_one_block  0.659170389175415
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  3.0452330112457275
block generation total time  2.5937061309814453
average batch blocks generation time:  1.2968530654907227
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10752058029174805  GigaBytes
Max Memory Allocated: 0.10752058029174805  GigaBytes

torch.Size([166416, 128])
torch.Size([162661, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7563638687133789  GigaBytes
Max Memory Allocated: 0.8032059669494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6248779296875 GB
    Memory Allocated: 0.11409521102905273  GigaBytes
Max Memory Allocated: 0.8820195198059082  GigaBytes

torch.Size([166488, 128])
torch.Size([162713, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.7562727928161621  GigaBytes
Max Memory Allocated: 0.8820195198059082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03932154178619385 |0.15510571002960205 |0.360670804977417 |0.00013375282287597656 |0.037334322929382324 |0.003807544708251953 |
----------------------------------------------------------pseudo_mini_loss sum 5.463700771331787
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  927558
Number of first layer input nodes during this epoch:  332904
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.15921926498413086  GigaBytes
Max Memory Allocated: 0.8820195198059082  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018225908279418945
random selection method range initialization spend 0.006041049957275391
time for parepare:  0.019070148468017578
local_output_nid generation:  0.01636958122253418
local_in_edges_tensor generation:  0.014211177825927734
mini_batch_src_global generation:  0.01347661018371582
r_  generation:  0.16706371307373047
local_output_nid generation:  0.021760940551757812
local_in_edges_tensor generation:  0.015269994735717773
mini_batch_src_global generation:  0.021236419677734375
r_  generation:  0.17905402183532715
----------------------check_connections_block total spend ----------------------------- 0.5497415065765381
generate_one_block  0.20807385444641113
generate_one_block  0.21087145805358887
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03483986854553223
gen group dst list time:  0.007512807846069336
time for parepare:  0.019215822219848633
local_output_nid generation:  0.02433609962463379
local_in_edges_tensor generation:  0.054311513900756836
mini_batch_src_global generation:  0.050333499908447266
r_  generation:  0.5148184299468994
local_output_nid generation:  0.03615379333496094
local_in_edges_tensor generation:  0.06052589416503906
mini_batch_src_global generation:  0.0647726058959961
r_  generation:  0.49899840354919434
----------------------check_connections_block total spend ----------------------------- 1.579216718673706
generate_one_block  0.6496899127960205
generate_one_block  0.6421213150024414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04799222946166992
gen group dst list time:  0.011889934539794922
time for parepare:  0.01911020278930664
local_output_nid generation:  0.030263900756835938
local_in_edges_tensor generation:  0.08653926849365234
mini_batch_src_global generation:  0.06208014488220215
r_  generation:  0.5204803943634033
local_output_nid generation:  0.03736686706542969
local_in_edges_tensor generation:  0.056559085845947266
mini_batch_src_global generation:  0.07269668579101562
r_  generation:  0.532141923904419
----------------------check_connections_block total spend ----------------------------- 1.6658499240875244
generate_one_block  0.6801297664642334
generate_one_block  0.661379337310791
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.15921926498413086  GigaBytes
Max Memory Allocated: 0.8820195198059082  GigaBytes

connection checking time:  3.2450666427612305
block generation total time  2.6333203315734863
average batch blocks generation time:  1.3166601657867432
block dataloader generation time/epoch 7.6641480922698975
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.11474132537841797  GigaBytes
Max Memory Allocated: 0.8820195198059082  GigaBytes

torch.Size([166444, 128])
torch.Size([162666, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.7564702033996582  GigaBytes
Max Memory Allocated: 0.8820195198059082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.11482620239257812  GigaBytes
Max Memory Allocated: 0.8820486068725586  GigaBytes

torch.Size([166368, 128])
torch.Size([162586, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.7565412521362305  GigaBytes
Max Memory Allocated: 0.8820486068725586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05170726776123047 |0.024632930755615234 |0.0040503740310668945 |0.00010895729064941406 |0.0035566091537475586 |0.0014729499816894531 |
----------------------------------------------------------pseudo_mini_loss sum 3.5391640663146973
Total (block generation + training)time/epoch 7.883896827697754
Training time/epoch 0.21953082084655762
Training time without block to device /epoch 0.17026495933532715
Training time without total dataloading part /epoch 0.016904830932617188
load block tensor time/epoch 0.10341453552246094
block to device time/epoch 0.04926586151123047
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  927287
Number of first layer input nodes during this epoch:  332812
