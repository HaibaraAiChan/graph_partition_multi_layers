Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648354047.9625437
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02655959129333496
random selection method range initialization spend 0.006534099578857422
time for parepare:  0.01858210563659668
local_output_nid generation:  0.016060829162597656
local_in_edges_tensor generation:  0.014783620834350586
mini_batch_src_global generation:  0.014617204666137695
r_  generation:  0.18613791465759277
local_output_nid generation:  0.021648168563842773
local_in_edges_tensor generation:  0.015593290328979492
mini_batch_src_global generation:  0.019002676010131836
r_  generation:  0.19535374641418457
----------------------check_connections_block total spend ----------------------------- 0.5868062973022461
generate_one_block  0.226395845413208
generate_one_block  0.2202439308166504
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04572916030883789
gen group dst list time:  0.007923603057861328
time for parepare:  0.019460439682006836
local_output_nid generation:  0.025997161865234375
local_in_edges_tensor generation:  0.05604100227355957
mini_batch_src_global generation:  0.05604958534240723
r_  generation:  0.5580127239227295
local_output_nid generation:  0.03209710121154785
local_in_edges_tensor generation:  0.05449962615966797
mini_batch_src_global generation:  0.06351733207702637
r_  generation:  0.5662157535552979
----------------------check_connections_block total spend ----------------------------- 1.6924734115600586
generate_one_block  0.7481884956359863
generate_one_block  0.7380764484405518
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028031587600708008
gen group dst list time:  0.01198434829711914
time for parepare:  0.019315719604492188
local_output_nid generation:  0.030969619750976562
local_in_edges_tensor generation:  0.04369401931762695
mini_batch_src_global generation:  0.04521012306213379
r_  generation:  0.5106544494628906
local_output_nid generation:  0.04224419593811035
local_in_edges_tensor generation:  0.052018165588378906
mini_batch_src_global generation:  0.05701112747192383
r_  generation:  0.5181066989898682
----------------------check_connections_block total spend ----------------------------- 1.5670194625854492
generate_one_block  0.6744301319122314
generate_one_block  0.6665043830871582
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  3.259492874145508
block generation total time  2.8271994590759277
average batch blocks generation time:  1.4135997295379639
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10910272598266602  GigaBytes
Max Memory Allocated: 0.10910272598266602  GigaBytes

torch.Size([167223, 128])
torch.Size([164277, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.29732465744018555  GigaBytes
Max Memory Allocated: 0.30422067642211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.11731767654418945  GigaBytes
Max Memory Allocated: 0.3246912956237793  GigaBytes

torch.Size([167249, 128])
torch.Size([164258, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.2953524589538574  GigaBytes
Max Memory Allocated: 0.3246912956237793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03992938995361328 |0.1583176851272583 |0.3708120584487915 |0.0001386404037475586 |0.012679100036621094 |0.003906726837158203 |
----------------------------------------------------------pseudo_mini_loss sum 4.9584760665893555
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  941538
Number of first layer input nodes during this epoch:  334472
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.17932939529418945  GigaBytes
Max Memory Allocated: 0.3246912956237793  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02028965950012207
random selection method range initialization spend 0.006549358367919922
time for parepare:  0.023092031478881836
local_output_nid generation:  0.01683950424194336
local_in_edges_tensor generation:  0.014503002166748047
mini_batch_src_global generation:  0.014613866806030273
r_  generation:  0.19310760498046875
local_output_nid generation:  0.024692773818969727
local_in_edges_tensor generation:  0.01934957504272461
mini_batch_src_global generation:  0.01939702033996582
r_  generation:  0.20675134658813477
----------------------check_connections_block total spend ----------------------------- 0.6184685230255127
generate_one_block  0.23228740692138672
generate_one_block  0.2620582580566406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07056427001953125
gen group dst list time:  0.008308649063110352
time for parepare:  0.0207674503326416
local_output_nid generation:  0.026787757873535156
local_in_edges_tensor generation:  0.07342171669006348
mini_batch_src_global generation:  0.056200265884399414
r_  generation:  0.5550947189331055
local_output_nid generation:  0.03352499008178711
local_in_edges_tensor generation:  0.05667686462402344
mini_batch_src_global generation:  0.0638890266418457
r_  generation:  0.5653524398803711
----------------------check_connections_block total spend ----------------------------- 1.7131800651550293
generate_one_block  0.7476620674133301
generate_one_block  0.7607710361480713
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04247713088989258
gen group dst list time:  0.012636899948120117
time for parepare:  0.019297361373901367
local_output_nid generation:  0.030771732330322266
local_in_edges_tensor generation:  0.04555964469909668
mini_batch_src_global generation:  0.045346975326538086
r_  generation:  0.5119295120239258
local_output_nid generation:  0.03783917427062988
local_in_edges_tensor generation:  0.04918527603149414
mini_batch_src_global generation:  0.05775928497314453
r_  generation:  0.5233767032623291
----------------------check_connections_block total spend ----------------------------- 1.569282054901123
generate_one_block  0.641350507736206
generate_one_block  0.6649112701416016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.17932939529418945  GigaBytes
Max Memory Allocated: 0.3246912956237793  GigaBytes

connection checking time:  3.2824621200561523
block generation total time  2.814694881439209
average batch blocks generation time:  1.4073474407196045
block dataloader generation time/epoch 8.09948992729187
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.11743497848510742  GigaBytes
Max Memory Allocated: 0.3246912956237793  GigaBytes

torch.Size([167210, 128])
torch.Size([164197, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.2953667640686035  GigaBytes
Max Memory Allocated: 0.3246912956237793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.11745977401733398  GigaBytes
Max Memory Allocated: 0.3246912956237793  GigaBytes

torch.Size([167237, 128])
torch.Size([164283, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.2965965270996094  GigaBytes
Max Memory Allocated: 0.3246912956237793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04427957534790039 |0.019983887672424316 |0.0040853023529052734 |0.00010895729064941406 |0.0033845901489257812 |0.0016384124755859375 |
----------------------------------------------------------pseudo_mini_loss sum 4.274013519287109
Total (block generation + training)time/epoch 8.27696418762207
Training time/epoch 0.17719197273254395
Training time without block to device /epoch 0.1372241973876953
Training time without total dataloading part /epoch 0.016796112060546875
load block tensor time/epoch 0.08855915069580078
block to device time/epoch 0.03996777534484863
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  941353
Number of first layer input nodes during this epoch:  334447
