Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648357240.1793358
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02387690544128418
random selection method range initialization spend 0.007265567779541016
time for parepare:  0.019639968872070312
local_output_nid generation:  0.0021276473999023438
local_in_edges_tensor generation:  0.004041194915771484
mini_batch_src_global generation:  0.002069234848022461
r_  generation:  0.02018260955810547
local_output_nid generation:  0.002977132797241211
local_in_edges_tensor generation:  0.0015609264373779297
mini_batch_src_global generation:  0.0024847984313964844
r_  generation:  0.02022409439086914
local_output_nid generation:  0.002955913543701172
local_in_edges_tensor generation:  0.0015132427215576172
mini_batch_src_global generation:  0.0016596317291259766
r_  generation:  0.019823074340820312
local_output_nid generation:  0.0029358863830566406
local_in_edges_tensor generation:  0.0014333724975585938
mini_batch_src_global generation:  0.0016169548034667969
r_  generation:  0.019841432571411133
local_output_nid generation:  0.0029234886169433594
local_in_edges_tensor generation:  0.001425027847290039
mini_batch_src_global generation:  0.006522655487060547
r_  generation:  0.020288705825805664
local_output_nid generation:  0.0029382705688476562
local_in_edges_tensor generation:  0.0014386177062988281
mini_batch_src_global generation:  0.0018336772918701172
r_  generation:  0.019112348556518555
local_output_nid generation:  0.0029976367950439453
local_in_edges_tensor generation:  0.0014646053314208984
mini_batch_src_global generation:  0.0015218257904052734
r_  generation:  0.019210100173950195
local_output_nid generation:  0.002947092056274414
local_in_edges_tensor generation:  0.0014927387237548828
mini_batch_src_global generation:  0.0015611648559570312
r_  generation:  0.01966714859008789
local_output_nid generation:  0.0030357837677001953
local_in_edges_tensor generation:  0.0014302730560302734
mini_batch_src_global generation:  0.0015225410461425781
r_  generation:  0.020647048950195312
local_output_nid generation:  0.003045797348022461
local_in_edges_tensor generation:  0.0014674663543701172
mini_batch_src_global generation:  0.0018579959869384766
r_  generation:  0.021103382110595703
local_output_nid generation:  0.0029816627502441406
local_in_edges_tensor generation:  0.0014224052429199219
mini_batch_src_global generation:  0.001850128173828125
r_  generation:  0.02135634422302246
local_output_nid generation:  0.0029175281524658203
local_in_edges_tensor generation:  0.0014252662658691406
mini_batch_src_global generation:  0.0019116401672363281
r_  generation:  0.021409273147583008
local_output_nid generation:  0.0029468536376953125
local_in_edges_tensor generation:  0.0014338493347167969
mini_batch_src_global generation:  0.001941680908203125
r_  generation:  0.021405458450317383
local_output_nid generation:  0.0030412673950195312
local_in_edges_tensor generation:  0.0013957023620605469
mini_batch_src_global generation:  0.0018794536590576172
r_  generation:  0.021094560623168945
local_output_nid generation:  0.0030126571655273438
local_in_edges_tensor generation:  0.0014693737030029297
mini_batch_src_global generation:  0.0019161701202392578
r_  generation:  0.021520376205444336
local_output_nid generation:  0.002949953079223633
local_in_edges_tensor generation:  0.0014336109161376953
mini_batch_src_global generation:  0.0019328594207763672
r_  generation:  0.019287824630737305
----------------------check_connections_block total spend ----------------------------- 0.5430116653442383
generate_one_block  0.026407241821289062
generate_one_block  0.02765178680419922
generate_one_block  0.029961109161376953
generate_one_block  0.027448177337646484
generate_one_block  0.027939319610595703
generate_one_block  0.027801036834716797
generate_one_block  0.02809929847717285
generate_one_block  0.028643369674682617
generate_one_block  0.02735280990600586
generate_one_block  0.027544021606445312
generate_one_block  0.027699708938598633
generate_one_block  0.02806854248046875
generate_one_block  0.02769303321838379
generate_one_block  0.027269363403320312
generate_one_block  0.027983665466308594
generate_one_block  0.0277097225189209
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03670024871826172
gen group dst list time:  0.018870115280151367
time for parepare:  0.01894211769104004
local_output_nid generation:  0.008168458938598633
local_in_edges_tensor generation:  0.016004323959350586
mini_batch_src_global generation:  0.019092559814453125
r_  generation:  0.1880970001220703
local_output_nid generation:  0.01195979118347168
local_in_edges_tensor generation:  0.0186154842376709
mini_batch_src_global generation:  0.026499271392822266
r_  generation:  0.19405174255371094
local_output_nid generation:  0.011594295501708984
local_in_edges_tensor generation:  0.015007495880126953
mini_batch_src_global generation:  0.02257847785949707
r_  generation:  0.1966838836669922
local_output_nid generation:  0.011564016342163086
local_in_edges_tensor generation:  0.01304769515991211
mini_batch_src_global generation:  0.025397539138793945
r_  generation:  0.19830584526062012
local_output_nid generation:  0.011841058731079102
local_in_edges_tensor generation:  0.015472888946533203
mini_batch_src_global generation:  0.02529120445251465
r_  generation:  0.20621991157531738
local_output_nid generation:  0.011855363845825195
local_in_edges_tensor generation:  0.011838912963867188
mini_batch_src_global generation:  0.025890588760375977
r_  generation:  0.20316267013549805
local_output_nid generation:  0.01179051399230957
local_in_edges_tensor generation:  0.013292551040649414
mini_batch_src_global generation:  0.026057720184326172
r_  generation:  0.20769238471984863
local_output_nid generation:  0.012038230895996094
local_in_edges_tensor generation:  0.013955831527709961
mini_batch_src_global generation:  0.02837824821472168
r_  generation:  0.2130873203277588
local_output_nid generation:  0.01175236701965332
local_in_edges_tensor generation:  0.011908531188964844
mini_batch_src_global generation:  0.026193618774414062
r_  generation:  0.20504307746887207
local_output_nid generation:  0.011873483657836914
local_in_edges_tensor generation:  0.014405250549316406
mini_batch_src_global generation:  0.026168107986450195
r_  generation:  0.20981383323669434
local_output_nid generation:  0.011925935745239258
local_in_edges_tensor generation:  0.01519918441772461
mini_batch_src_global generation:  0.028719425201416016
r_  generation:  0.21535038948059082
local_output_nid generation:  0.011859416961669922
local_in_edges_tensor generation:  0.012067794799804688
mini_batch_src_global generation:  0.026729822158813477
r_  generation:  0.2091693878173828
local_output_nid generation:  0.011896371841430664
local_in_edges_tensor generation:  0.011837005615234375
mini_batch_src_global generation:  0.02666759490966797
r_  generation:  0.20954656600952148
local_output_nid generation:  0.011700153350830078
local_in_edges_tensor generation:  0.016481876373291016
mini_batch_src_global generation:  0.026293516159057617
r_  generation:  0.20430898666381836
local_output_nid generation:  0.011816978454589844
local_in_edges_tensor generation:  0.015529155731201172
mini_batch_src_global generation:  0.026517391204833984
r_  generation:  0.20904088020324707
local_output_nid generation:  0.011895179748535156
local_in_edges_tensor generation:  0.015491008758544922
mini_batch_src_global generation:  0.02675604820251465
r_  generation:  0.2139759063720703
----------------------check_connections_block total spend ----------------------------- 4.85830020904541
generate_one_block  0.2671549320220947
generate_one_block  0.26194095611572266
generate_one_block  0.2607567310333252
generate_one_block  0.26124095916748047
generate_one_block  0.28206348419189453
generate_one_block  0.2686886787414551
generate_one_block  0.26783251762390137
generate_one_block  0.27335023880004883
generate_one_block  0.2674679756164551
generate_one_block  0.2669661045074463
generate_one_block  0.26940131187438965
generate_one_block  0.27018165588378906
generate_one_block  0.26811909675598145
generate_one_block  0.2623143196105957
generate_one_block  0.275101900100708
generate_one_block  0.2703745365142822
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03450417518615723
gen group dst list time:  0.058495283126831055
time for parepare:  0.01906895637512207
local_output_nid generation:  0.025397777557373047
local_in_edges_tensor generation:  0.03791618347167969
mini_batch_src_global generation:  0.04158759117126465
r_  generation:  0.4355285167694092
local_output_nid generation:  0.030815601348876953
local_in_edges_tensor generation:  0.043311357498168945
mini_batch_src_global generation:  0.052687644958496094
r_  generation:  0.44622206687927246
local_output_nid generation:  0.030509471893310547
local_in_edges_tensor generation:  0.038462162017822266
mini_batch_src_global generation:  0.05280470848083496
r_  generation:  0.4442732334136963
local_output_nid generation:  0.032044172286987305
local_in_edges_tensor generation:  0.03730297088623047
mini_batch_src_global generation:  0.05556964874267578
r_  generation:  0.4451868534088135
local_output_nid generation:  0.034052133560180664
local_in_edges_tensor generation:  0.04015016555786133
mini_batch_src_global generation:  0.06420683860778809
r_  generation:  0.45125818252563477
local_output_nid generation:  0.030832767486572266
local_in_edges_tensor generation:  0.03281378746032715
mini_batch_src_global generation:  0.05309295654296875
r_  generation:  0.44913768768310547
local_output_nid generation:  0.032846927642822266
local_in_edges_tensor generation:  0.02814483642578125
mini_batch_src_global generation:  0.05244922637939453
r_  generation:  0.45577383041381836
local_output_nid generation:  0.031944990158081055
local_in_edges_tensor generation:  0.04038500785827637
mini_batch_src_global generation:  0.05285477638244629
r_  generation:  0.4519624710083008
local_output_nid generation:  0.031874895095825195
local_in_edges_tensor generation:  0.028192758560180664
mini_batch_src_global generation:  0.05748414993286133
r_  generation:  0.4540884494781494
local_output_nid generation:  0.031707763671875
local_in_edges_tensor generation:  0.028095483779907227
mini_batch_src_global generation:  0.05329728126525879
r_  generation:  0.4450504779815674
local_output_nid generation:  0.031694889068603516
local_in_edges_tensor generation:  0.03580498695373535
mini_batch_src_global generation:  0.05215620994567871
r_  generation:  0.4557778835296631
local_output_nid generation:  0.031889915466308594
local_in_edges_tensor generation:  0.040192365646362305
mini_batch_src_global generation:  0.05273127555847168
r_  generation:  0.4550635814666748
local_output_nid generation:  0.031862497329711914
local_in_edges_tensor generation:  0.02897024154663086
mini_batch_src_global generation:  0.05282115936279297
r_  generation:  0.45487475395202637
local_output_nid generation:  0.03200840950012207
local_in_edges_tensor generation:  0.028524160385131836
mini_batch_src_global generation:  0.05261850357055664
r_  generation:  0.45876264572143555
local_output_nid generation:  0.03171277046203613
local_in_edges_tensor generation:  0.032227277755737305
mini_batch_src_global generation:  0.05366039276123047
r_  generation:  0.4614987373352051
local_output_nid generation:  0.0319216251373291
local_in_edges_tensor generation:  0.040460824966430664
mini_batch_src_global generation:  0.05750393867492676
r_  generation:  0.45069336891174316
----------------------check_connections_block total spend ----------------------------- 10.730372905731201
generate_one_block  0.5791771411895752
generate_one_block  0.5715231895446777
generate_one_block  0.5836031436920166
generate_one_block  0.5768082141876221
generate_one_block  0.589867115020752
generate_one_block  0.5816817283630371
generate_one_block  0.6312048435211182
generate_one_block  0.5907928943634033
generate_one_block  0.5685372352600098
generate_one_block  0.5655782222747803
generate_one_block  0.5852911472320557
generate_one_block  0.5904557704925537
generate_one_block  0.57808518409729
generate_one_block  0.5714728832244873
generate_one_block  0.5771074295043945
generate_one_block  0.5905184745788574
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  15.588673114776611
block generation total time  13.624660015106201
average batch blocks generation time:  0.8515412509441376
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09001493453979492  GigaBytes
Max Memory Allocated: 0.09001493453979492  GigaBytes

torch.Size([154580, 128])
torch.Size([122561, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.44096946716308594  GigaBytes
Max Memory Allocated: 0.4585561752319336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.0911407470703125  GigaBytes
Max Memory Allocated: 0.48010969161987305  GigaBytes

torch.Size([154663, 128])
torch.Size([122412, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.4404935836791992  GigaBytes
Max Memory Allocated: 0.48010969161987305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.09103202819824219  GigaBytes
Max Memory Allocated: 0.48010969161987305  GigaBytes

torch.Size([154031, 128])
torch.Size([121259, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.4390072822570801  GigaBytes
Max Memory Allocated: 0.48010969161987305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.09108734130859375  GigaBytes
Max Memory Allocated: 0.48010969161987305  GigaBytes

torch.Size([154299, 128])
torch.Size([121885, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.43956899642944336  GigaBytes
Max Memory Allocated: 0.48010969161987305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.09128379821777344  GigaBytes
Max Memory Allocated: 0.48010969161987305  GigaBytes

torch.Size([154620, 128])
torch.Size([122677, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.4422335624694824  GigaBytes
Max Memory Allocated: 0.48010969161987305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.09116458892822266  GigaBytes
Max Memory Allocated: 0.48177003860473633  GigaBytes

torch.Size([154509, 128])
torch.Size([122280, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.4410676956176758  GigaBytes
Max Memory Allocated: 0.48177003860473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.09125041961669922  GigaBytes
Max Memory Allocated: 0.48177003860473633  GigaBytes

torch.Size([154361, 128])
torch.Size([122229, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.4414815902709961  GigaBytes
Max Memory Allocated: 0.48177003860473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.09139156341552734  GigaBytes
Max Memory Allocated: 0.48177003860473633  GigaBytes

torch.Size([154543, 128])
torch.Size([123003, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2987060546875 GB
    Memory Allocated: 0.44463586807250977  GigaBytes
Max Memory Allocated: 0.48177003860473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09115219116210938  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154443, 128])
torch.Size([122075, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44017887115478516  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09115982055664062  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154122, 128])
torch.Size([121765, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44043540954589844  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.0913095474243164  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154329, 128])
torch.Size([122490, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4414525032043457  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09128093719482422  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154571, 128])
torch.Size([122797, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44161081314086914  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09126663208007812  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154351, 128])
torch.Size([122405, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4414377212524414  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09111595153808594  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154659, 128])
torch.Size([122772, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4402499198913574  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09123706817626953  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154666, 128])
torch.Size([122555, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4415922164916992  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09131813049316406  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154491, 128])
torch.Size([122887, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44323110580444336  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037977784872055054 |0.03124222159385681 |0.05168795585632324 |9.785592555999756e-05 |0.005832105875015259 |0.0018286705017089844 |
----------------------------------------------------------pseudo_mini_loss sum 5.592266082763672
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5089955
Number of first layer input nodes during this epoch:  2471238
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.11389303207397461  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016269207000732422
random selection method range initialization spend 0.005388021469116211
time for parepare:  0.017155170440673828
local_output_nid generation:  0.0025129318237304688
local_in_edges_tensor generation:  0.004723072052001953
mini_batch_src_global generation:  0.0017385482788085938
r_  generation:  0.017729759216308594
local_output_nid generation:  0.0028192996978759766
local_in_edges_tensor generation:  0.001607656478881836
mini_batch_src_global generation:  0.0021653175354003906
r_  generation:  0.01866459846496582
local_output_nid generation:  0.0028874874114990234
local_in_edges_tensor generation:  0.001493692398071289
mini_batch_src_global generation:  0.0013964176177978516
r_  generation:  0.0187833309173584
local_output_nid generation:  0.002921581268310547
local_in_edges_tensor generation:  0.0015423297882080078
mini_batch_src_global generation:  0.0014071464538574219
r_  generation:  0.01861119270324707
local_output_nid generation:  0.0029532909393310547
local_in_edges_tensor generation:  0.0014281272888183594
mini_batch_src_global generation:  0.001409292221069336
r_  generation:  0.018294095993041992
local_output_nid generation:  0.0028879642486572266
local_in_edges_tensor generation:  0.0014722347259521484
mini_batch_src_global generation:  0.0014390945434570312
r_  generation:  0.018602848052978516
local_output_nid generation:  0.0028676986694335938
local_in_edges_tensor generation:  0.0014503002166748047
mini_batch_src_global generation:  0.001468658447265625
r_  generation:  0.019450902938842773
local_output_nid generation:  0.002917766571044922
local_in_edges_tensor generation:  0.0014328956604003906
mini_batch_src_global generation:  0.0015244483947753906
r_  generation:  0.019369840621948242
local_output_nid generation:  0.0029065608978271484
local_in_edges_tensor generation:  0.001424551010131836
mini_batch_src_global generation:  0.0014743804931640625
r_  generation:  0.01898503303527832
local_output_nid generation:  0.0029060840606689453
local_in_edges_tensor generation:  0.0014116764068603516
mini_batch_src_global generation:  0.0015053749084472656
r_  generation:  0.019623994827270508
local_output_nid generation:  0.002885580062866211
local_in_edges_tensor generation:  0.0014061927795410156
mini_batch_src_global generation:  0.0015065670013427734
r_  generation:  0.019475221633911133
local_output_nid generation:  0.002911806106567383
local_in_edges_tensor generation:  0.0014178752899169922
mini_batch_src_global generation:  0.0015151500701904297
r_  generation:  0.019344329833984375
local_output_nid generation:  0.0028994083404541016
local_in_edges_tensor generation:  0.0014922618865966797
mini_batch_src_global generation:  0.0015554428100585938
r_  generation:  0.0196688175201416
local_output_nid generation:  0.0028884410858154297
local_in_edges_tensor generation:  0.0014071464538574219
mini_batch_src_global generation:  0.0042035579681396484
r_  generation:  0.01952075958251953
local_output_nid generation:  0.002876758575439453
local_in_edges_tensor generation:  0.0014066696166992188
mini_batch_src_global generation:  0.001529693603515625
r_  generation:  0.019125699996948242
local_output_nid generation:  0.0028841495513916016
local_in_edges_tensor generation:  0.0013759136199951172
mini_batch_src_global generation:  0.0015769004821777344
r_  generation:  0.01980757713317871
----------------------check_connections_block total spend ----------------------------- 0.5028841495513916
generate_one_block  0.03062605857849121
generate_one_block  0.028285503387451172
generate_one_block  0.027774333953857422
generate_one_block  0.027469158172607422
generate_one_block  0.02720022201538086
generate_one_block  0.02976846694946289
generate_one_block  0.028174877166748047
generate_one_block  0.03262042999267578
generate_one_block  0.028646230697631836
generate_one_block  0.028038501739501953
generate_one_block  0.02886819839477539
generate_one_block  0.028185606002807617
generate_one_block  0.029743194580078125
generate_one_block  0.02882981300354004
generate_one_block  0.029558897018432617
generate_one_block  0.03047347068786621
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.048537492752075195
gen group dst list time:  0.018796205520629883
time for parepare:  0.021544218063354492
local_output_nid generation:  0.008205175399780273
local_in_edges_tensor generation:  0.03495526313781738
mini_batch_src_global generation:  0.021294593811035156
r_  generation:  0.19485068321228027
local_output_nid generation:  0.011959075927734375
local_in_edges_tensor generation:  0.01974201202392578
mini_batch_src_global generation:  0.024085521697998047
r_  generation:  0.19588971138000488
local_output_nid generation:  0.011823415756225586
local_in_edges_tensor generation:  0.0163726806640625
mini_batch_src_global generation:  0.023418664932250977
r_  generation:  0.20829248428344727
local_output_nid generation:  0.012611865997314453
local_in_edges_tensor generation:  0.01668691635131836
mini_batch_src_global generation:  0.026394128799438477
r_  generation:  0.2113642692565918
local_output_nid generation:  0.012557744979858398
local_in_edges_tensor generation:  0.012741327285766602
mini_batch_src_global generation:  0.025636911392211914
r_  generation:  0.20963048934936523
local_output_nid generation:  0.011933565139770508
local_in_edges_tensor generation:  0.012385129928588867
mini_batch_src_global generation:  0.02550482749938965
r_  generation:  0.20633912086486816
local_output_nid generation:  0.011923074722290039
local_in_edges_tensor generation:  0.014436721801757812
mini_batch_src_global generation:  0.027713537216186523
r_  generation:  0.21453166007995605
local_output_nid generation:  0.01184535026550293
local_in_edges_tensor generation:  0.016427278518676758
mini_batch_src_global generation:  0.026424407958984375
r_  generation:  0.2107224464416504
local_output_nid generation:  0.011719942092895508
local_in_edges_tensor generation:  0.01255488395690918
mini_batch_src_global generation:  0.026221275329589844
r_  generation:  0.20729756355285645
local_output_nid generation:  0.011932373046875
local_in_edges_tensor generation:  0.01458430290222168
mini_batch_src_global generation:  0.026611328125
r_  generation:  0.21756696701049805
local_output_nid generation:  0.011856317520141602
local_in_edges_tensor generation:  0.013076543807983398
mini_batch_src_global generation:  0.026672840118408203
r_  generation:  0.21562933921813965
local_output_nid generation:  0.011806249618530273
local_in_edges_tensor generation:  0.015208959579467773
mini_batch_src_global generation:  0.02628612518310547
r_  generation:  0.21415114402770996
local_output_nid generation:  0.011885643005371094
local_in_edges_tensor generation:  0.016390085220336914
mini_batch_src_global generation:  0.027060270309448242
r_  generation:  0.2169027328491211
local_output_nid generation:  0.01176142692565918
local_in_edges_tensor generation:  0.012938499450683594
mini_batch_src_global generation:  0.027027368545532227
r_  generation:  0.2140181064605713
local_output_nid generation:  0.012573719024658203
local_in_edges_tensor generation:  0.019754648208618164
mini_batch_src_global generation:  0.026836156845092773
r_  generation:  0.21753597259521484
local_output_nid generation:  0.0144195556640625
local_in_edges_tensor generation:  0.01825118064880371
mini_batch_src_global generation:  0.026952743530273438
r_  generation:  0.21778655052185059
----------------------check_connections_block total spend ----------------------------- 5.026881694793701
generate_one_block  0.28905725479125977
generate_one_block  0.26547956466674805
generate_one_block  0.27405309677124023
generate_one_block  0.27379369735717773
generate_one_block  0.26938486099243164
generate_one_block  0.26256513595581055
generate_one_block  0.29778575897216797
generate_one_block  0.2963261604309082
generate_one_block  0.2653052806854248
generate_one_block  0.27589845657348633
generate_one_block  0.26996707916259766
generate_one_block  0.2663693428039551
generate_one_block  0.2769737243652344
generate_one_block  0.2734711170196533
generate_one_block  0.26645731925964355
generate_one_block  0.2785604000091553
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.049759864807128906
gen group dst list time:  0.06034445762634277
time for parepare:  0.017683982849121094
local_output_nid generation:  0.0255279541015625
local_in_edges_tensor generation:  0.056261539459228516
mini_batch_src_global generation:  0.042066335678100586
r_  generation:  0.44887351989746094
local_output_nid generation:  0.03324079513549805
local_in_edges_tensor generation:  0.049118995666503906
mini_batch_src_global generation:  0.057485103607177734
r_  generation:  0.44159722328186035
local_output_nid generation:  0.0327143669128418
local_in_edges_tensor generation:  0.04731035232543945
mini_batch_src_global generation:  0.05309343338012695
r_  generation:  0.4481983184814453
local_output_nid generation:  0.031716108322143555
local_in_edges_tensor generation:  0.03331613540649414
mini_batch_src_global generation:  0.052187442779541016
r_  generation:  0.44873738288879395
local_output_nid generation:  0.03144240379333496
local_in_edges_tensor generation:  0.08124327659606934
mini_batch_src_global generation:  0.0518341064453125
r_  generation:  0.4492075443267822
local_output_nid generation:  0.03051137924194336
local_in_edges_tensor generation:  0.03078317642211914
mini_batch_src_global generation:  0.05248832702636719
r_  generation:  0.44315385818481445
local_output_nid generation:  0.030716896057128906
local_in_edges_tensor generation:  0.0352482795715332
mini_batch_src_global generation:  0.05264902114868164
r_  generation:  0.45644521713256836
local_output_nid generation:  0.030227184295654297
local_in_edges_tensor generation:  0.03869509696960449
mini_batch_src_global generation:  0.052277326583862305
r_  generation:  0.45152926445007324
local_output_nid generation:  0.03031134605407715
local_in_edges_tensor generation:  0.04039144515991211
mini_batch_src_global generation:  0.05409574508666992
r_  generation:  0.451676607131958
local_output_nid generation:  0.03071904182434082
local_in_edges_tensor generation:  0.04162907600402832
mini_batch_src_global generation:  0.05253005027770996
r_  generation:  0.45345282554626465
local_output_nid generation:  0.031249523162841797
local_in_edges_tensor generation:  0.03522825241088867
mini_batch_src_global generation:  0.05483865737915039
r_  generation:  0.47109198570251465
local_output_nid generation:  0.032330989837646484
local_in_edges_tensor generation:  0.03489112854003906
mini_batch_src_global generation:  0.05598640441894531
r_  generation:  0.4486849308013916
local_output_nid generation:  0.03275585174560547
local_in_edges_tensor generation:  0.04158806800842285
mini_batch_src_global generation:  0.05178546905517578
r_  generation:  0.45459723472595215
local_output_nid generation:  0.03155970573425293
local_in_edges_tensor generation:  0.04073071479797363
mini_batch_src_global generation:  0.052324771881103516
r_  generation:  0.4508018493652344
local_output_nid generation:  0.03159356117248535
local_in_edges_tensor generation:  0.029048919677734375
mini_batch_src_global generation:  0.05222582817077637
r_  generation:  0.4528381824493408
local_output_nid generation:  0.03164839744567871
local_in_edges_tensor generation:  0.03302288055419922
mini_batch_src_global generation:  0.053063392639160156
r_  generation:  0.4543616771697998
----------------------check_connections_block total spend ----------------------------- 10.818959712982178
generate_one_block  0.5773358345031738
generate_one_block  0.5700047016143799
generate_one_block  0.5910601615905762
generate_one_block  0.5665886402130127
generate_one_block  0.5859537124633789
generate_one_block  0.5638141632080078
generate_one_block  0.5827841758728027
generate_one_block  0.5724599361419678
generate_one_block  0.5950608253479004
generate_one_block  0.6028542518615723
generate_one_block  0.5609309673309326
generate_one_block  0.573488712310791
generate_one_block  0.5872538089752197
generate_one_block  0.5775611400604248
generate_one_block  0.5667235851287842
generate_one_block  0.5803625583648682
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.11389303207397461  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

connection checking time:  15.845841407775879
block generation total time  13.655685424804688
average batch blocks generation time:  0.853480339050293
block dataloader generation time/epoch 31.612669467926025
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.0918431282043457  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154472, 128])
torch.Size([122299, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4422307014465332  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09168338775634766  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154351, 128])
torch.Size([122079, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4411740303039551  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.091888427734375  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154624, 128])
torch.Size([123030, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44362974166870117  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09183502197265625  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154100, 128])
torch.Size([122284, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4421863555908203  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09178543090820312  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154619, 128])
torch.Size([122724, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4414634704589844  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09161758422851562  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154567, 128])
torch.Size([121906, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4400463104248047  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09186458587646484  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154373, 128])
torch.Size([122165, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44208240509033203  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09177112579345703  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154605, 128])
torch.Size([122304, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44195079803466797  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.091644287109375  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154444, 128])
torch.Size([121890, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44037771224975586  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09189128875732422  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154117, 128])
torch.Size([122545, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44235754013061523  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09173393249511719  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154570, 128])
torch.Size([122506, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4415154457092285  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09171295166015625  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154630, 128])
torch.Size([122434, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4412040710449219  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.0918731689453125  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154416, 128])
torch.Size([122678, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44244909286499023  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09181690216064453  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154804, 128])
torch.Size([122749, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44167232513427734  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09162330627441406  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154596, 128])
torch.Size([121949, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.43990564346313477  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09188652038574219  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

torch.Size([154628, 128])
torch.Size([122999, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4444618225097656  GigaBytes
Max Memory Allocated: 0.4843878746032715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03465905785560608 |0.012643098831176758 |0.003965646028518677 |0.00010041892528533936 |0.004071086645126343 |0.0015208721160888672 |
----------------------------------------------------------pseudo_mini_loss sum 3.5699524879455566
Total (block generation + training)time/epoch 32.53751873970032
Training time/epoch 0.9245643615722656
Training time without block to device /epoch 0.7222747802734375
Training time without total dataloading part /epoch 0.1317152976989746
load block tensor time/epoch 0.5545449256896973
block to device time/epoch 0.20228958129882812
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5091135
Number of first layer input nodes during this epoch:  2471916
