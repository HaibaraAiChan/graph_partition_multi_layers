Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648355686.4787707
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02797412872314453
random selection method range initialization spend 0.006520748138427734
time for parepare:  0.01854228973388672
local_output_nid generation:  0.002119302749633789
local_in_edges_tensor generation:  0.005091428756713867
mini_batch_src_global generation:  0.001965761184692383
r_  generation:  0.020099639892578125
local_output_nid generation:  0.002473592758178711
local_in_edges_tensor generation:  0.001676321029663086
mini_batch_src_global generation:  0.002328634262084961
r_  generation:  0.020397186279296875
local_output_nid generation:  0.0028192996978759766
local_in_edges_tensor generation:  0.0016145706176757812
mini_batch_src_global generation:  0.0015201568603515625
r_  generation:  0.02054119110107422
local_output_nid generation:  0.0028679370880126953
local_in_edges_tensor generation:  0.0015342235565185547
mini_batch_src_global generation:  0.0015976428985595703
r_  generation:  0.020422935485839844
local_output_nid generation:  0.0029637813568115234
local_in_edges_tensor generation:  0.0015215873718261719
mini_batch_src_global generation:  0.0015804767608642578
r_  generation:  0.020326614379882812
local_output_nid generation:  0.0028977394104003906
local_in_edges_tensor generation:  0.001590728759765625
mini_batch_src_global generation:  0.0016319751739501953
r_  generation:  0.02029728889465332
local_output_nid generation:  0.0028429031372070312
local_in_edges_tensor generation:  0.0014538764953613281
mini_batch_src_global generation:  0.0015845298767089844
r_  generation:  0.020550966262817383
local_output_nid generation:  0.0028383731842041016
local_in_edges_tensor generation:  0.00152587890625
mini_batch_src_global generation:  0.0017087459564208984
r_  generation:  0.021392822265625
local_output_nid generation:  0.002887725830078125
local_in_edges_tensor generation:  0.0015959739685058594
mini_batch_src_global generation:  0.0016791820526123047
r_  generation:  0.021764516830444336
local_output_nid generation:  0.002917766571044922
local_in_edges_tensor generation:  0.0014529228210449219
mini_batch_src_global generation:  0.0017418861389160156
r_  generation:  0.021256208419799805
local_output_nid generation:  0.002947092056274414
local_in_edges_tensor generation:  0.0014586448669433594
mini_batch_src_global generation:  0.0017423629760742188
r_  generation:  0.02259659767150879
local_output_nid generation:  0.002966642379760742
local_in_edges_tensor generation:  0.0015506744384765625
mini_batch_src_global generation:  0.0017511844635009766
r_  generation:  0.021608829498291016
local_output_nid generation:  0.002997875213623047
local_in_edges_tensor generation:  0.0015385150909423828
mini_batch_src_global generation:  0.001718282699584961
r_  generation:  0.021699905395507812
local_output_nid generation:  0.0029075145721435547
local_in_edges_tensor generation:  0.0015010833740234375
mini_batch_src_global generation:  0.0016925334930419922
r_  generation:  0.020914316177368164
local_output_nid generation:  0.0028967857360839844
local_in_edges_tensor generation:  0.0014505386352539062
mini_batch_src_global generation:  0.0017254352569580078
r_  generation:  0.021094083786010742
local_output_nid generation:  0.002933025360107422
local_in_edges_tensor generation:  0.0014560222625732422
mini_batch_src_global generation:  0.0017819404602050781
r_  generation:  0.022064685821533203
----------------------check_connections_block total spend ----------------------------- 0.5412924289703369
generate_one_block  0.03106522560119629
generate_one_block  0.03161454200744629
generate_one_block  0.03385043144226074
generate_one_block  0.03136897087097168
generate_one_block  0.03049921989440918
generate_one_block  0.030519962310791016
generate_one_block  0.030637741088867188
generate_one_block  0.03131842613220215
generate_one_block  0.03145003318786621
generate_one_block  0.030417680740356445
generate_one_block  0.031736135482788086
generate_one_block  0.031089067459106445
generate_one_block  0.03136014938354492
generate_one_block  0.030292987823486328
generate_one_block  0.03041672706604004
generate_one_block  0.030584096908569336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038271188735961914
gen group dst list time:  0.020423412322998047
time for parepare:  0.019977569580078125
local_output_nid generation:  0.009462594985961914
local_in_edges_tensor generation:  0.022893428802490234
mini_batch_src_global generation:  0.02121758460998535
r_  generation:  0.2165989875793457
local_output_nid generation:  0.016448020935058594
local_in_edges_tensor generation:  0.021740198135375977
mini_batch_src_global generation:  0.027411937713623047
r_  generation:  0.22379350662231445
local_output_nid generation:  0.016330718994140625
local_in_edges_tensor generation:  0.020310401916503906
mini_batch_src_global generation:  0.027811527252197266
r_  generation:  0.22974538803100586
local_output_nid generation:  0.016360998153686523
local_in_edges_tensor generation:  0.018727779388427734
mini_batch_src_global generation:  0.027935266494750977
r_  generation:  0.23641753196716309
local_output_nid generation:  0.016300678253173828
local_in_edges_tensor generation:  0.014044523239135742
mini_batch_src_global generation:  0.028456926345825195
r_  generation:  0.22815656661987305
local_output_nid generation:  0.01624321937561035
local_in_edges_tensor generation:  0.015957355499267578
mini_batch_src_global generation:  0.027637481689453125
r_  generation:  0.23014497756958008
local_output_nid generation:  0.01636528968811035
local_in_edges_tensor generation:  0.020720481872558594
mini_batch_src_global generation:  0.028695344924926758
r_  generation:  0.23211884498596191
local_output_nid generation:  0.016431331634521484
local_in_edges_tensor generation:  0.018351316452026367
mini_batch_src_global generation:  0.02920079231262207
r_  generation:  0.23519110679626465
local_output_nid generation:  0.016472578048706055
local_in_edges_tensor generation:  0.018115758895874023
mini_batch_src_global generation:  0.03418850898742676
r_  generation:  0.23513293266296387
local_output_nid generation:  0.016475439071655273
local_in_edges_tensor generation:  0.016233444213867188
mini_batch_src_global generation:  0.02856731414794922
r_  generation:  0.2321012020111084
local_output_nid generation:  0.016646385192871094
local_in_edges_tensor generation:  0.01692819595336914
mini_batch_src_global generation:  0.03650212287902832
r_  generation:  0.24283742904663086
local_output_nid generation:  0.016427278518676758
local_in_edges_tensor generation:  0.01594996452331543
mini_batch_src_global generation:  0.029268741607666016
r_  generation:  0.2334425449371338
local_output_nid generation:  0.01646256446838379
local_in_edges_tensor generation:  0.013927698135375977
mini_batch_src_global generation:  0.030895709991455078
r_  generation:  0.23893189430236816
local_output_nid generation:  0.016218900680541992
local_in_edges_tensor generation:  0.014136791229248047
mini_batch_src_global generation:  0.029481172561645508
r_  generation:  0.23871922492980957
local_output_nid generation:  0.016371965408325195
local_in_edges_tensor generation:  0.01600933074951172
mini_batch_src_global generation:  0.028986692428588867
r_  generation:  0.2343137264251709
local_output_nid generation:  0.016237497329711914
local_in_edges_tensor generation:  0.019883394241333008
mini_batch_src_global generation:  0.02910590171813965
r_  generation:  0.23471307754516602
----------------------check_connections_block total spend ----------------------------- 5.552950382232666
generate_one_block  0.3077068328857422
generate_one_block  0.3041200637817383
generate_one_block  0.31028056144714355
generate_one_block  0.30929017066955566
generate_one_block  0.3096170425415039
generate_one_block  0.2993471622467041
generate_one_block  0.2989025115966797
generate_one_block  0.3080105781555176
generate_one_block  0.31476449966430664
generate_one_block  0.30197978019714355
generate_one_block  0.32306385040283203
generate_one_block  0.30880117416381836
generate_one_block  0.301511287689209
generate_one_block  0.2955007553100586
generate_one_block  0.31169843673706055
generate_one_block  0.32294368743896484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05739998817443848
gen group dst list time:  0.0693216323852539
time for parepare:  0.023909330368041992
local_output_nid generation:  0.026500940322875977
local_in_edges_tensor generation:  0.06177830696105957
mini_batch_src_global generation:  0.04288291931152344
r_  generation:  0.4718897342681885
local_output_nid generation:  0.03592395782470703
local_in_edges_tensor generation:  0.06035804748535156
mini_batch_src_global generation:  0.056267738342285156
r_  generation:  0.4646952152252197
local_output_nid generation:  0.032720088958740234
local_in_edges_tensor generation:  0.04041790962219238
mini_batch_src_global generation:  0.04992532730102539
r_  generation:  0.47447657585144043
local_output_nid generation:  0.033438920974731445
local_in_edges_tensor generation:  0.05190396308898926
mini_batch_src_global generation:  0.06012272834777832
r_  generation:  0.45650792121887207
local_output_nid generation:  0.03325629234313965
local_in_edges_tensor generation:  0.041100263595581055
mini_batch_src_global generation:  0.05196332931518555
r_  generation:  0.4655580520629883
local_output_nid generation:  0.0327000617980957
local_in_edges_tensor generation:  0.048185110092163086
mini_batch_src_global generation:  0.05298495292663574
r_  generation:  0.46396446228027344
local_output_nid generation:  0.036009788513183594
local_in_edges_tensor generation:  0.04728960990905762
mini_batch_src_global generation:  0.05274152755737305
r_  generation:  0.4813992977142334
local_output_nid generation:  0.03302001953125
local_in_edges_tensor generation:  0.04360079765319824
mini_batch_src_global generation:  0.06501650810241699
r_  generation:  0.46175718307495117
local_output_nid generation:  0.03365921974182129
local_in_edges_tensor generation:  0.03494715690612793
mini_batch_src_global generation:  0.05545854568481445
r_  generation:  0.4682140350341797
local_output_nid generation:  0.032592058181762695
local_in_edges_tensor generation:  0.030933618545532227
mini_batch_src_global generation:  0.05305218696594238
r_  generation:  0.45758605003356934
local_output_nid generation:  0.03273940086364746
local_in_edges_tensor generation:  0.02922964096069336
mini_batch_src_global generation:  0.06559109687805176
r_  generation:  0.46991801261901855
local_output_nid generation:  0.03283500671386719
local_in_edges_tensor generation:  0.03477787971496582
mini_batch_src_global generation:  0.05303239822387695
r_  generation:  0.4673144817352295
local_output_nid generation:  0.03281569480895996
local_in_edges_tensor generation:  0.03424954414367676
mini_batch_src_global generation:  0.052323102951049805
r_  generation:  0.46859073638916016
local_output_nid generation:  0.0334470272064209
local_in_edges_tensor generation:  0.03649187088012695
mini_batch_src_global generation:  0.05400705337524414
r_  generation:  0.4646909236907959
local_output_nid generation:  0.0327000617980957
local_in_edges_tensor generation:  0.034014225006103516
mini_batch_src_global generation:  0.05605316162109375
r_  generation:  0.47229814529418945
local_output_nid generation:  0.032380104064941406
local_in_edges_tensor generation:  0.04018568992614746
mini_batch_src_global generation:  0.05386805534362793
r_  generation:  0.5042533874511719
----------------------check_connections_block total spend ----------------------------- 11.268332481384277
generate_one_block  0.6217963695526123
generate_one_block  0.6022775173187256
generate_one_block  0.5914626121520996
generate_one_block  0.5968191623687744
generate_one_block  0.6021766662597656
generate_one_block  0.5846085548400879
generate_one_block  0.6383717060089111
generate_one_block  0.5906264781951904
generate_one_block  0.5883405208587646
generate_one_block  0.5772299766540527
generate_one_block  0.5979411602020264
generate_one_block  0.5897252559661865
generate_one_block  0.5925884246826172
generate_one_block  0.5852549076080322
generate_one_block  0.5905156135559082
generate_one_block  0.5901074409484863
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  16.821282863616943
block generation total time  14.46738076210022
average batch blocks generation time:  0.9042112976312637
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09084558486938477  GigaBytes
Max Memory Allocated: 0.09084558486938477  GigaBytes

torch.Size([154699, 128])
torch.Size([124187, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.2572331428527832  GigaBytes
Max Memory Allocated: 0.2659950256347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09176826477050781  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

torch.Size([155145, 128])
torch.Size([125527, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25515079498291016  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.0917806625366211  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

torch.Size([154686, 128])
torch.Size([124663, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2543215751647949  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09188175201416016  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

torch.Size([155115, 128])
torch.Size([125613, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25714588165283203  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.0915842056274414  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

torch.Size([154856, 128])
torch.Size([124428, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2530517578125  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09158515930175781  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

torch.Size([154852, 128])
torch.Size([124221, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25170469284057617  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09166145324707031  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

torch.Size([154967, 128])
torch.Size([124805, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25378847122192383  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09180927276611328  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

torch.Size([154917, 128])
torch.Size([124975, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2556595802307129  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09182453155517578  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

torch.Size([155186, 128])
torch.Size([125436, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2560420036315918  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09167289733886719  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

torch.Size([155244, 128])
torch.Size([124922, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25386810302734375  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09193038940429688  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

torch.Size([155360, 128])
torch.Size([126128, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2581748962402344  GigaBytes
Max Memory Allocated: 0.2796955108642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.0917205810546875  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([155196, 128])
torch.Size([125280, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2544698715209961  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09174728393554688  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([154913, 128])
torch.Size([124942, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25431346893310547  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.0915975570678711  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([154864, 128])
torch.Size([124749, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25223255157470703  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09168434143066406  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([155091, 128])
torch.Size([124658, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25368452072143555  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09161663055419922  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([154857, 128])
torch.Size([124278, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25314903259277344  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037057310342788696 |0.03570571541786194 |0.0509185791015625 |0.00010022521018981934 |0.008901774883270264 |0.0038826465606689453 |
----------------------------------------------------------pseudo_mini_loss sum 5.344468593597412
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5209543
Number of first layer input nodes during this epoch:  2479948
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.12708425521850586  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021604537963867188
random selection method range initialization spend 0.005552530288696289
time for parepare:  0.017795562744140625
local_output_nid generation:  0.0022962093353271484
local_in_edges_tensor generation:  0.004841327667236328
mini_batch_src_global generation:  0.002010345458984375
r_  generation:  0.02022695541381836
local_output_nid generation:  0.0028870105743408203
local_in_edges_tensor generation:  0.0016336441040039062
mini_batch_src_global generation:  0.002333402633666992
r_  generation:  0.019652366638183594
local_output_nid generation:  0.0029191970825195312
local_in_edges_tensor generation:  0.0015609264373779297
mini_batch_src_global generation:  0.0014972686767578125
r_  generation:  0.02071380615234375
local_output_nid generation:  0.0030257701873779297
local_in_edges_tensor generation:  0.0015950202941894531
mini_batch_src_global generation:  0.0015707015991210938
r_  generation:  0.020807504653930664
local_output_nid generation:  0.0029144287109375
local_in_edges_tensor generation:  0.0014939308166503906
mini_batch_src_global generation:  0.001592397689819336
r_  generation:  0.020661354064941406
local_output_nid generation:  0.0028934478759765625
local_in_edges_tensor generation:  0.0015408992767333984
mini_batch_src_global generation:  0.0016624927520751953
r_  generation:  0.022237777709960938
local_output_nid generation:  0.0029141902923583984
local_in_edges_tensor generation:  0.0015153884887695312
mini_batch_src_global generation:  0.0017004013061523438
r_  generation:  0.02245187759399414
local_output_nid generation:  0.003007173538208008
local_in_edges_tensor generation:  0.001527547836303711
mini_batch_src_global generation:  0.0016536712646484375
r_  generation:  0.021537303924560547
local_output_nid generation:  0.0029838085174560547
local_in_edges_tensor generation:  0.001583099365234375
mini_batch_src_global generation:  0.001691579818725586
r_  generation:  0.02221226692199707
local_output_nid generation:  0.0029649734497070312
local_in_edges_tensor generation:  0.0015249252319335938
mini_batch_src_global generation:  0.0017406940460205078
r_  generation:  0.022347211837768555
local_output_nid generation:  0.002953767776489258
local_in_edges_tensor generation:  0.0015137195587158203
mini_batch_src_global generation:  0.002790212631225586
r_  generation:  0.022589683532714844
local_output_nid generation:  0.0029397010803222656
local_in_edges_tensor generation:  0.0015659332275390625
mini_batch_src_global generation:  0.0017273426055908203
r_  generation:  0.022148847579956055
local_output_nid generation:  0.0029773712158203125
local_in_edges_tensor generation:  0.0014989376068115234
mini_batch_src_global generation:  0.0017476081848144531
r_  generation:  0.021919727325439453
local_output_nid generation:  0.0029413700103759766
local_in_edges_tensor generation:  0.0015761852264404297
mini_batch_src_global generation:  0.0017237663269042969
r_  generation:  0.022050857543945312
local_output_nid generation:  0.002908945083618164
local_in_edges_tensor generation:  0.0017218589782714844
mini_batch_src_global generation:  0.0017848014831542969
r_  generation:  0.022513151168823242
local_output_nid generation:  0.0029408931732177734
local_in_edges_tensor generation:  0.0015108585357666016
mini_batch_src_global generation:  0.0018448829650878906
r_  generation:  0.022572994232177734
----------------------check_connections_block total spend ----------------------------- 0.5579798221588135
generate_one_block  0.03374814987182617
generate_one_block  0.029906272888183594
generate_one_block  0.03069448471069336
generate_one_block  0.0303497314453125
generate_one_block  0.031061649322509766
generate_one_block  0.03575420379638672
generate_one_block  0.031995534896850586
generate_one_block  0.03058338165283203
generate_one_block  0.03206062316894531
generate_one_block  0.031946659088134766
generate_one_block  0.031496286392211914
generate_one_block  0.03136563301086426
generate_one_block  0.03115105628967285
generate_one_block  0.030999422073364258
generate_one_block  0.031917572021484375
generate_one_block  0.0326390266418457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03892159461975098
gen group dst list time:  0.01929926872253418
time for parepare:  0.01892685890197754
local_output_nid generation:  0.008940458297729492
local_in_edges_tensor generation:  0.019080638885498047
mini_batch_src_global generation:  0.021285295486450195
r_  generation:  0.2185230255126953
local_output_nid generation:  0.01293325424194336
local_in_edges_tensor generation:  0.020430326461791992
mini_batch_src_global generation:  0.026474714279174805
r_  generation:  0.21597790718078613
local_output_nid generation:  0.012913227081298828
local_in_edges_tensor generation:  0.020978689193725586
mini_batch_src_global generation:  0.027222156524658203
r_  generation:  0.2243180274963379
local_output_nid generation:  0.013301849365234375
local_in_edges_tensor generation:  0.014742851257324219
mini_batch_src_global generation:  0.026674985885620117
r_  generation:  0.22498846054077148
local_output_nid generation:  0.01427912712097168
local_in_edges_tensor generation:  0.019608020782470703
mini_batch_src_global generation:  0.029742002487182617
r_  generation:  0.23519253730773926
local_output_nid generation:  0.013699054718017578
local_in_edges_tensor generation:  0.022240638732910156
mini_batch_src_global generation:  0.03879213333129883
r_  generation:  0.24971580505371094
local_output_nid generation:  0.014345169067382812
local_in_edges_tensor generation:  0.015771865844726562
mini_batch_src_global generation:  0.029808998107910156
r_  generation:  0.2369859218597412
local_output_nid generation:  0.013074398040771484
local_in_edges_tensor generation:  0.012939929962158203
mini_batch_src_global generation:  0.028819561004638672
r_  generation:  0.23544573783874512
local_output_nid generation:  0.015168190002441406
local_in_edges_tensor generation:  0.0170440673828125
mini_batch_src_global generation:  0.03137087821960449
r_  generation:  0.2366640567779541
local_output_nid generation:  0.01319265365600586
local_in_edges_tensor generation:  0.013331890106201172
mini_batch_src_global generation:  0.029677867889404297
r_  generation:  0.23638606071472168
local_output_nid generation:  0.01325845718383789
local_in_edges_tensor generation:  0.015156269073486328
mini_batch_src_global generation:  0.03403472900390625
r_  generation:  0.23633408546447754
local_output_nid generation:  0.01337432861328125
local_in_edges_tensor generation:  0.013170242309570312
mini_batch_src_global generation:  0.031311988830566406
r_  generation:  0.2377481460571289
local_output_nid generation:  0.013163089752197266
local_in_edges_tensor generation:  0.01716470718383789
mini_batch_src_global generation:  0.029137611389160156
r_  generation:  0.24047470092773438
local_output_nid generation:  0.013119697570800781
local_in_edges_tensor generation:  0.015045881271362305
mini_batch_src_global generation:  0.029062271118164062
r_  generation:  0.23546171188354492
local_output_nid generation:  0.014081954956054688
local_in_edges_tensor generation:  0.017836332321166992
mini_batch_src_global generation:  0.031140565872192383
r_  generation:  0.2394390106201172
local_output_nid generation:  0.01810169219970703
local_in_edges_tensor generation:  0.022667646408081055
mini_batch_src_global generation:  0.036618947982788086
r_  generation:  0.24742388725280762
----------------------check_connections_block total spend ----------------------------- 5.567148208618164
generate_one_block  0.3204777240753174
generate_one_block  0.2942392826080322
generate_one_block  0.2995631694793701
generate_one_block  0.29609107971191406
generate_one_block  0.3048396110534668
generate_one_block  0.3255774974822998
generate_one_block  0.34718847274780273
generate_one_block  0.3090357780456543
generate_one_block  0.3189125061035156
generate_one_block  0.3140854835510254
generate_one_block  0.3207969665527344
generate_one_block  0.3165147304534912
generate_one_block  0.30403733253479004
generate_one_block  0.29927849769592285
generate_one_block  0.30966877937316895
generate_one_block  0.3210940361022949
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04942631721496582
gen group dst list time:  0.07093667984008789
time for parepare:  0.021025896072387695
local_output_nid generation:  0.030359745025634766
local_in_edges_tensor generation:  0.06397128105163574
mini_batch_src_global generation:  0.04491019248962402
r_  generation:  0.4566988945007324
local_output_nid generation:  0.0338284969329834
local_in_edges_tensor generation:  0.04834723472595215
mini_batch_src_global generation:  0.05078601837158203
r_  generation:  0.4423038959503174
local_output_nid generation:  0.03190326690673828
local_in_edges_tensor generation:  0.03558993339538574
mini_batch_src_global generation:  0.05046582221984863
r_  generation:  0.45990777015686035
local_output_nid generation:  0.03276705741882324
local_in_edges_tensor generation:  0.03992295265197754
mini_batch_src_global generation:  0.0517733097076416
r_  generation:  0.45879077911376953
local_output_nid generation:  0.03307914733886719
local_in_edges_tensor generation:  0.09592914581298828
mini_batch_src_global generation:  0.05157923698425293
r_  generation:  0.4629197120666504
local_output_nid generation:  0.03205156326293945
local_in_edges_tensor generation:  0.04433321952819824
mini_batch_src_global generation:  0.05277204513549805
r_  generation:  0.46211743354797363
local_output_nid generation:  0.03204989433288574
local_in_edges_tensor generation:  0.03587985038757324
mini_batch_src_global generation:  0.05160927772521973
r_  generation:  0.47348475456237793
local_output_nid generation:  0.03217744827270508
local_in_edges_tensor generation:  0.03652381896972656
mini_batch_src_global generation:  0.05333065986633301
r_  generation:  0.4664905071258545
local_output_nid generation:  0.03347277641296387
local_in_edges_tensor generation:  0.04027867317199707
mini_batch_src_global generation:  0.05249595642089844
r_  generation:  0.4851973056793213
local_output_nid generation:  0.032928466796875
local_in_edges_tensor generation:  0.046958208084106445
mini_batch_src_global generation:  0.06382012367248535
r_  generation:  0.4642043113708496
local_output_nid generation:  0.034482717514038086
local_in_edges_tensor generation:  0.036206722259521484
mini_batch_src_global generation:  0.05591273307800293
r_  generation:  0.4666604995727539
local_output_nid generation:  0.033187150955200195
local_in_edges_tensor generation:  0.04421353340148926
mini_batch_src_global generation:  0.05434846878051758
r_  generation:  0.4605729579925537
local_output_nid generation:  0.03323101997375488
local_in_edges_tensor generation:  0.040374755859375
mini_batch_src_global generation:  0.05204653739929199
r_  generation:  0.4656705856323242
local_output_nid generation:  0.033011436462402344
local_in_edges_tensor generation:  0.03202080726623535
mini_batch_src_global generation:  0.0525965690612793
r_  generation:  0.4581012725830078
local_output_nid generation:  0.03297281265258789
local_in_edges_tensor generation:  0.03226661682128906
mini_batch_src_global generation:  0.05218362808227539
r_  generation:  0.47227048873901367
local_output_nid generation:  0.03302192687988281
local_in_edges_tensor generation:  0.03168606758117676
mini_batch_src_global generation:  0.053777217864990234
r_  generation:  0.46991491317749023
----------------------check_connections_block total spend ----------------------------- 11.132719039916992
generate_one_block  0.5850207805633545
generate_one_block  0.5892086029052734
generate_one_block  0.5804779529571533
generate_one_block  0.5910260677337646
generate_one_block  0.5873839855194092
generate_one_block  0.5924680233001709
generate_one_block  0.5955595970153809
generate_one_block  0.5835578441619873
generate_one_block  0.6338748931884766
generate_one_block  0.572913646697998
generate_one_block  0.5820860862731934
generate_one_block  0.6062278747558594
generate_one_block  0.5911076068878174
generate_one_block  0.5683503150939941
generate_one_block  0.5822734832763672
generate_one_block  0.5903465747833252
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.12708425521850586  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

connection checking time:  16.699867248535156
block generation total time  14.433284282684326
average batch blocks generation time:  0.9020802676677704
block dataloader generation time/epoch 33.39873766899109
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09205102920532227  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([155071, 128])
torch.Size([125045, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25590038299560547  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09165096282958984  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([155025, 128])
torch.Size([124598, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2518315315246582  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.0918264389038086  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([154373, 128])
torch.Size([123658, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25156402587890625  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09173011779785156  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([154878, 128])
torch.Size([124079, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25135040283203125  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09181976318359375  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([155217, 128])
torch.Size([125129, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2539024353027344  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09217071533203125  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([154995, 128])
torch.Size([125302, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2576780319213867  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09200572967529297  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([155152, 128])
torch.Size([125137, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.25501060485839844  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0918893814086914  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([155042, 128])
torch.Size([124865, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.25380420684814453  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09211254119873047  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([155208, 128])
torch.Size([125511, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2576146125793457  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09201526641845703  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([155070, 128])
torch.Size([124766, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.25466299057006836  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09203433990478516  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([154684, 128])
torch.Size([124644, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.254457950592041  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09200382232666016  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([155091, 128])
torch.Size([125181, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2549619674682617  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09193038940429688  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([155123, 128])
torch.Size([125199, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2545328140258789  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09173583984375  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([154479, 128])
torch.Size([123723, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.251370906829834  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09202098846435547  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([154912, 128])
torch.Size([124479, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2542595863342285  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09209918975830078  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

torch.Size([155043, 128])
torch.Size([125317, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.25752830505371094  GigaBytes
Max Memory Allocated: 0.28023767471313477  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032766565680503845 |0.013245776295661926 |0.003604412078857422 |9.196996688842773e-05 |0.0033482015132904053 |0.0018630027770996094 |
----------------------------------------------------------pseudo_mini_loss sum 4.094918251037598
Total (block generation + training)time/epoch 34.28086280822754
Training time/epoch 0.881840705871582
Training time without block to device /epoch 0.6699082851409912
Training time without total dataloading part /epoch 0.11457633972167969
load block tensor time/epoch 0.5242650508880615
block to device time/epoch 0.21193242073059082
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5206029
Number of first layer input nodes during this epoch:  2479363
