Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648356692.9722319
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02695441246032715
random selection method range initialization spend 0.006015300750732422
time for parepare:  0.01880335807800293
local_output_nid generation:  0.0022487640380859375
local_in_edges_tensor generation:  0.00513768196105957
mini_batch_src_global generation:  0.001997709274291992
r_  generation:  0.02050304412841797
local_output_nid generation:  0.002701997756958008
local_in_edges_tensor generation:  0.0016732215881347656
mini_batch_src_global generation:  0.0023229122161865234
r_  generation:  0.020358800888061523
local_output_nid generation:  0.0028603076934814453
local_in_edges_tensor generation:  0.0016121864318847656
mini_batch_src_global generation:  0.0015916824340820312
r_  generation:  0.01999497413635254
local_output_nid generation:  0.0028548240661621094
local_in_edges_tensor generation:  0.0015337467193603516
mini_batch_src_global generation:  0.0015969276428222656
r_  generation:  0.02008199691772461
local_output_nid generation:  0.002849102020263672
local_in_edges_tensor generation:  0.001558542251586914
mini_batch_src_global generation:  0.0015377998352050781
r_  generation:  0.019749164581298828
local_output_nid generation:  0.002866029739379883
local_in_edges_tensor generation:  0.0014786720275878906
mini_batch_src_global generation:  0.0015556812286376953
r_  generation:  0.02029561996459961
local_output_nid generation:  0.0028836727142333984
local_in_edges_tensor generation:  0.0014781951904296875
mini_batch_src_global generation:  0.0015985965728759766
r_  generation:  0.02040576934814453
local_output_nid generation:  0.0029070377349853516
local_in_edges_tensor generation:  0.001459360122680664
mini_batch_src_global generation:  0.0017247200012207031
r_  generation:  0.02113199234008789
local_output_nid generation:  0.0028624534606933594
local_in_edges_tensor generation:  0.0014841556549072266
mini_batch_src_global generation:  0.0016829967498779297
r_  generation:  0.021591901779174805
local_output_nid generation:  0.002844572067260742
local_in_edges_tensor generation:  0.0014498233795166016
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.021394014358520508
local_output_nid generation:  0.002905130386352539
local_in_edges_tensor generation:  0.0014536380767822266
mini_batch_src_global generation:  0.001783132553100586
r_  generation:  0.021998882293701172
local_output_nid generation:  0.0029375553131103516
local_in_edges_tensor generation:  0.0014495849609375
mini_batch_src_global generation:  0.0017800331115722656
r_  generation:  0.021334171295166016
local_output_nid generation:  0.00289154052734375
local_in_edges_tensor generation:  0.0015063285827636719
mini_batch_src_global generation:  0.0017173290252685547
r_  generation:  0.022038698196411133
local_output_nid generation:  0.002871274948120117
local_in_edges_tensor generation:  0.0014352798461914062
mini_batch_src_global generation:  0.0016970634460449219
r_  generation:  0.02107071876525879
local_output_nid generation:  0.0029218196868896484
local_in_edges_tensor generation:  0.001474142074584961
mini_batch_src_global generation:  0.0017399787902832031
r_  generation:  0.021059751510620117
local_output_nid generation:  0.002856731414794922
local_in_edges_tensor generation:  0.0014712810516357422
mini_batch_src_global generation:  0.0017504692077636719
r_  generation:  0.021375179290771484
----------------------check_connections_block total spend ----------------------------- 0.5382239818572998
generate_one_block  0.031092405319213867
generate_one_block  0.03171801567077637
generate_one_block  0.034253597259521484
generate_one_block  0.0319828987121582
generate_one_block  0.030577898025512695
generate_one_block  0.03074479103088379
generate_one_block  0.030561447143554688
generate_one_block  0.031572818756103516
generate_one_block  0.03147292137145996
generate_one_block  0.03074789047241211
generate_one_block  0.03248333930969238
generate_one_block  0.03131413459777832
generate_one_block  0.03166699409484863
generate_one_block  0.03059244155883789
generate_one_block  0.03092479705810547
generate_one_block  0.03157353401184082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040461063385009766
gen group dst list time:  0.02070331573486328
time for parepare:  0.019637346267700195
local_output_nid generation:  0.009394645690917969
local_in_edges_tensor generation:  0.022505521774291992
mini_batch_src_global generation:  0.027736186981201172
r_  generation:  0.2528233528137207
local_output_nid generation:  0.015352725982666016
local_in_edges_tensor generation:  0.024081945419311523
mini_batch_src_global generation:  0.03269767761230469
r_  generation:  0.26056790351867676
local_output_nid generation:  0.01525115966796875
local_in_edges_tensor generation:  0.01952338218688965
mini_batch_src_global generation:  0.03172707557678223
r_  generation:  0.2642214298248291
local_output_nid generation:  0.015210628509521484
local_in_edges_tensor generation:  0.02216649055480957
mini_batch_src_global generation:  0.03234410285949707
r_  generation:  0.2788255214691162
local_output_nid generation:  0.015031576156616211
local_in_edges_tensor generation:  0.017226696014404297
mini_batch_src_global generation:  0.03276515007019043
r_  generation:  0.2687969207763672
local_output_nid generation:  0.01508951187133789
local_in_edges_tensor generation:  0.014618396759033203
mini_batch_src_global generation:  0.033182382583618164
r_  generation:  0.2638089656829834
local_output_nid generation:  0.015138387680053711
local_in_edges_tensor generation:  0.016599178314208984
mini_batch_src_global generation:  0.03572225570678711
r_  generation:  0.26958370208740234
local_output_nid generation:  0.01517033576965332
local_in_edges_tensor generation:  0.01764512062072754
mini_batch_src_global generation:  0.034284353256225586
r_  generation:  0.2740507125854492
local_output_nid generation:  0.015297174453735352
local_in_edges_tensor generation:  0.01714158058166504
mini_batch_src_global generation:  0.03683042526245117
r_  generation:  0.27848052978515625
local_output_nid generation:  0.015232563018798828
local_in_edges_tensor generation:  0.0186002254486084
mini_batch_src_global generation:  0.03414630889892578
r_  generation:  0.27244114875793457
local_output_nid generation:  0.015565633773803711
local_in_edges_tensor generation:  0.020137548446655273
mini_batch_src_global generation:  0.03491330146789551
r_  generation:  0.2819247245788574
local_output_nid generation:  0.015160322189331055
local_in_edges_tensor generation:  0.019493579864501953
mini_batch_src_global generation:  0.03428506851196289
r_  generation:  0.27272653579711914
local_output_nid generation:  0.015358924865722656
local_in_edges_tensor generation:  0.017674922943115234
mini_batch_src_global generation:  0.03622078895568848
r_  generation:  0.27335214614868164
local_output_nid generation:  0.014957904815673828
local_in_edges_tensor generation:  0.015300273895263672
mini_batch_src_global generation:  0.03411602973937988
r_  generation:  0.2686903476715088
local_output_nid generation:  0.01530909538269043
local_in_edges_tensor generation:  0.014836549758911133
mini_batch_src_global generation:  0.03883075714111328
r_  generation:  0.27529215812683105
local_output_nid generation:  0.015188932418823242
local_in_edges_tensor generation:  0.020296812057495117
mini_batch_src_global generation:  0.034812211990356445
r_  generation:  0.2718982696533203
----------------------check_connections_block total spend ----------------------------- 6.34709095954895
generate_one_block  0.36135077476501465
generate_one_block  0.35625505447387695
generate_one_block  0.3560068607330322
generate_one_block  0.36359190940856934
generate_one_block  0.361828088760376
generate_one_block  0.3449580669403076
generate_one_block  0.3510398864746094
generate_one_block  0.3594024181365967
generate_one_block  0.36417341232299805
generate_one_block  0.3497335910797119
generate_one_block  0.3679330348968506
generate_one_block  0.35282325744628906
generate_one_block  0.35398340225219727
generate_one_block  0.34875988960266113
generate_one_block  0.36242198944091797
generate_one_block  0.35391831398010254
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04129648208618164
gen group dst list time:  0.06250500679016113
time for parepare:  0.018870830535888672
local_output_nid generation:  0.025967836380004883
local_in_edges_tensor generation:  0.04335379600524902
mini_batch_src_global generation:  0.05075526237487793
r_  generation:  0.5268380641937256
local_output_nid generation:  0.032407283782958984
local_in_edges_tensor generation:  0.05262351036071777
mini_batch_src_global generation:  0.061684608459472656
r_  generation:  0.5238707065582275
local_output_nid generation:  0.03163790702819824
local_in_edges_tensor generation:  0.04863476753234863
mini_batch_src_global generation:  0.05818319320678711
r_  generation:  0.5329389572143555
local_output_nid generation:  0.03235483169555664
local_in_edges_tensor generation:  0.04301261901855469
mini_batch_src_global generation:  0.059293508529663086
r_  generation:  0.5317883491516113
local_output_nid generation:  0.03171992301940918
local_in_edges_tensor generation:  0.03368234634399414
mini_batch_src_global generation:  0.05997633934020996
r_  generation:  0.5422630310058594
local_output_nid generation:  0.03274846076965332
local_in_edges_tensor generation:  0.037363290786743164
mini_batch_src_global generation:  0.06485724449157715
r_  generation:  0.5333125591278076
local_output_nid generation:  0.032100677490234375
local_in_edges_tensor generation:  0.0386350154876709
mini_batch_src_global generation:  0.06123685836791992
r_  generation:  0.542743444442749
local_output_nid generation:  0.0319676399230957
local_in_edges_tensor generation:  0.04358816146850586
mini_batch_src_global generation:  0.06129789352416992
r_  generation:  0.5371744632720947
local_output_nid generation:  0.03220367431640625
local_in_edges_tensor generation:  0.04287433624267578
mini_batch_src_global generation:  0.06136798858642578
r_  generation:  0.5409698486328125
local_output_nid generation:  0.03205585479736328
local_in_edges_tensor generation:  0.03818106651306152
mini_batch_src_global generation:  0.06156349182128906
r_  generation:  0.5470998287200928
local_output_nid generation:  0.032288312911987305
local_in_edges_tensor generation:  0.04322457313537598
mini_batch_src_global generation:  0.06114077568054199
r_  generation:  0.545046329498291
local_output_nid generation:  0.03210258483886719
local_in_edges_tensor generation:  0.03915548324584961
mini_batch_src_global generation:  0.06226015090942383
r_  generation:  0.5469467639923096
local_output_nid generation:  0.032126665115356445
local_in_edges_tensor generation:  0.033577680587768555
mini_batch_src_global generation:  0.06178903579711914
r_  generation:  0.5444092750549316
local_output_nid generation:  0.03251481056213379
local_in_edges_tensor generation:  0.034210205078125
mini_batch_src_global generation:  0.062139272689819336
r_  generation:  0.5406522750854492
local_output_nid generation:  0.03239893913269043
local_in_edges_tensor generation:  0.0336761474609375
mini_batch_src_global generation:  0.0641322135925293
r_  generation:  0.5491394996643066
local_output_nid generation:  0.032546281814575195
local_in_edges_tensor generation:  0.049382686614990234
mini_batch_src_global generation:  0.08238530158996582
r_  generation:  0.5671453475952148
----------------------check_connections_block total spend ----------------------------- 12.727940082550049
generate_one_block  0.7024204730987549
generate_one_block  0.7447397708892822
generate_one_block  0.7140829563140869
generate_one_block  0.7191596031188965
generate_one_block  0.7161843776702881
generate_one_block  0.7002296447753906
generate_one_block  0.7984669208526611
generate_one_block  0.7006106376647949
generate_one_block  0.7051718235015869
generate_one_block  0.701873779296875
generate_one_block  0.7106833457946777
generate_one_block  0.6850521564483643
generate_one_block  0.68540358543396
generate_one_block  0.6863601207733154
generate_one_block  0.6990032196044922
generate_one_block  0.6959319114685059
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  19.075031042099
block generation total time  17.073554277420044
average batch blocks generation time:  1.0670971423387527
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09524965286254883  GigaBytes
Max Memory Allocated: 0.09524965286254883  GigaBytes

torch.Size([157496, 128])
torch.Size([129391, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.2672429084777832  GigaBytes
Max Memory Allocated: 0.27602100372314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09593391418457031  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

torch.Size([157692, 128])
torch.Size([130390, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26694822311401367  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09577655792236328  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

torch.Size([157312, 128])
torch.Size([129530, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26656293869018555  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09602832794189453  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

torch.Size([157626, 128])
torch.Size([130337, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26691532135009766  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.0957183837890625  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

torch.Size([157604, 128])
torch.Size([129625, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2655954360961914  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09568977355957031  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

torch.Size([157528, 128])
torch.Size([129443, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2653627395629883  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09680557250976562  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

torch.Size([157699, 128])
torch.Size([129898, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2670469284057617  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09590864181518555  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

torch.Size([157515, 128])
torch.Size([130029, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2668190002441406  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09600210189819336  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

torch.Size([157635, 128])
torch.Size([130497, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2669825553894043  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09684085845947266  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

torch.Size([157837, 128])
torch.Size([130040, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26704883575439453  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.0970907211303711  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

torch.Size([157898, 128])
torch.Size([130910, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26880788803100586  GigaBytes
Max Memory Allocated: 0.2897214889526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.0958700180053711  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157672, 128])
torch.Size([130310, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2663230895996094  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09583711624145508  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157517, 128])
torch.Size([129850, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2664198875427246  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09571981430053711  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157549, 128])
torch.Size([129950, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26545238494873047  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09685039520263672  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157774, 128])
torch.Size([129727, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2670321464538574  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09576225280761719  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157562, 128])
torch.Size([129545, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26587724685668945  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038073375821113586 |0.03654050827026367 |0.04885576665401459 |9.496510028839111e-05 |0.009064063429832458 |0.0038764476776123047 |
----------------------------------------------------------pseudo_mini_loss sum 5.338092803955078
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5332314
Number of first layer input nodes during this epoch:  2521916
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.13782310485839844  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02132558822631836
random selection method range initialization spend 0.00516963005065918
time for parepare:  0.017164945602416992
local_output_nid generation:  0.002415180206298828
local_in_edges_tensor generation:  0.004755973815917969
mini_batch_src_global generation:  0.001977682113647461
r_  generation:  0.02014446258544922
local_output_nid generation:  0.0029296875
local_in_edges_tensor generation:  0.0017235279083251953
mini_batch_src_global generation:  0.0023059844970703125
r_  generation:  0.019710540771484375
local_output_nid generation:  0.0036096572875976562
local_in_edges_tensor generation:  0.005644559860229492
mini_batch_src_global generation:  0.0027747154235839844
r_  generation:  0.021569013595581055
local_output_nid generation:  0.003201007843017578
local_in_edges_tensor generation:  0.001957416534423828
mini_batch_src_global generation:  0.0015347003936767578
r_  generation:  0.020280838012695312
local_output_nid generation:  0.0029494762420654297
local_in_edges_tensor generation:  0.0015211105346679688
mini_batch_src_global generation:  0.0016541481018066406
r_  generation:  0.02074456214904785
local_output_nid generation:  0.002973794937133789
local_in_edges_tensor generation:  0.0032045841217041016
mini_batch_src_global generation:  0.0028917789459228516
r_  generation:  0.022583961486816406
local_output_nid generation:  0.0036432743072509766
local_in_edges_tensor generation:  0.001566171646118164
mini_batch_src_global generation:  0.0017237663269042969
r_  generation:  0.022063016891479492
local_output_nid generation:  0.002981424331665039
local_in_edges_tensor generation:  0.0015082359313964844
mini_batch_src_global generation:  0.0018126964569091797
r_  generation:  0.021254539489746094
local_output_nid generation:  0.003000974655151367
local_in_edges_tensor generation:  0.0017962455749511719
mini_batch_src_global generation:  0.0016758441925048828
r_  generation:  0.02243185043334961
local_output_nid generation:  0.0030214786529541016
local_in_edges_tensor generation:  0.001857757568359375
mini_batch_src_global generation:  0.0016846656799316406
r_  generation:  0.022261381149291992
local_output_nid generation:  0.003046274185180664
local_in_edges_tensor generation:  0.0017650127410888672
mini_batch_src_global generation:  0.0017428398132324219
r_  generation:  0.022229671478271484
local_output_nid generation:  0.0029778480529785156
local_in_edges_tensor generation:  0.0015568733215332031
mini_batch_src_global generation:  0.001743316650390625
r_  generation:  0.022054433822631836
local_output_nid generation:  0.002964496612548828
local_in_edges_tensor generation:  0.0015246868133544922
mini_batch_src_global generation:  0.001728057861328125
r_  generation:  0.021442174911499023
local_output_nid generation:  0.003027200698852539
local_in_edges_tensor generation:  0.0016865730285644531
mini_batch_src_global generation:  0.001664876937866211
r_  generation:  0.021833419799804688
local_output_nid generation:  0.002996206283569336
local_in_edges_tensor generation:  0.001522064208984375
mini_batch_src_global generation:  0.0017130374908447266
r_  generation:  0.022756099700927734
local_output_nid generation:  0.0029976367950439453
local_in_edges_tensor generation:  0.0015869140625
mini_batch_src_global generation:  0.0017888545989990234
r_  generation:  0.022351980209350586
----------------------check_connections_block total spend ----------------------------- 0.5755105018615723
generate_one_block  0.030843257904052734
generate_one_block  0.030138492584228516
generate_one_block  0.030736446380615234
generate_one_block  0.03050827980041504
generate_one_block  0.030816316604614258
generate_one_block  0.034726858139038086
generate_one_block  0.03212928771972656
generate_one_block  0.030894994735717773
generate_one_block  0.03195977210998535
generate_one_block  0.031720638275146484
generate_one_block  0.03159689903259277
generate_one_block  0.03128361701965332
generate_one_block  0.031453609466552734
generate_one_block  0.03075265884399414
generate_one_block  0.031630516052246094
generate_one_block  0.03303408622741699
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.051767826080322266
gen group dst list time:  0.019237279891967773
time for parepare:  0.01872539520263672
local_output_nid generation:  0.009083032608032227
local_in_edges_tensor generation:  0.037580013275146484
mini_batch_src_global generation:  0.026949644088745117
r_  generation:  0.25345849990844727
local_output_nid generation:  0.012933731079101562
local_in_edges_tensor generation:  0.023281574249267578
mini_batch_src_global generation:  0.030963897705078125
r_  generation:  0.24660086631774902
local_output_nid generation:  0.012863874435424805
local_in_edges_tensor generation:  0.021646738052368164
mini_batch_src_global generation:  0.030164718627929688
r_  generation:  0.25832104682922363
local_output_nid generation:  0.015810251235961914
local_in_edges_tensor generation:  0.02151203155517578
mini_batch_src_global generation:  0.03084278106689453
r_  generation:  0.2589740753173828
local_output_nid generation:  0.013143539428710938
local_in_edges_tensor generation:  0.014570474624633789
mini_batch_src_global generation:  0.04753851890563965
r_  generation:  0.28995752334594727
local_output_nid generation:  0.0235288143157959
local_in_edges_tensor generation:  0.02233433723449707
mini_batch_src_global generation:  0.03879070281982422
r_  generation:  0.30906033515930176
local_output_nid generation:  0.020624160766601562
local_in_edges_tensor generation:  0.022775650024414062
mini_batch_src_global generation:  0.03915905952453613
r_  generation:  0.30428075790405273
local_output_nid generation:  0.02029275894165039
local_in_edges_tensor generation:  0.018085718154907227
mini_batch_src_global generation:  0.03863954544067383
r_  generation:  0.28458738327026367
local_output_nid generation:  0.017389535903930664
local_in_edges_tensor generation:  0.024214982986450195
mini_batch_src_global generation:  0.03953289985656738
r_  generation:  0.2881641387939453
local_output_nid generation:  0.014059305191040039
local_in_edges_tensor generation:  0.023355722427368164
mini_batch_src_global generation:  0.03698563575744629
r_  generation:  0.2826724052429199
local_output_nid generation:  0.014545679092407227
local_in_edges_tensor generation:  0.03158903121948242
mini_batch_src_global generation:  0.04824423789978027
r_  generation:  0.2801227569580078
local_output_nid generation:  0.014593362808227539
local_in_edges_tensor generation:  0.018768787384033203
mini_batch_src_global generation:  0.03436851501464844
r_  generation:  0.27901601791381836
local_output_nid generation:  0.01343989372253418
local_in_edges_tensor generation:  0.014922142028808594
mini_batch_src_global generation:  0.03495144844055176
r_  generation:  0.2726938724517822
local_output_nid generation:  0.015197038650512695
local_in_edges_tensor generation:  0.016575098037719727
mini_batch_src_global generation:  0.03399157524108887
r_  generation:  0.2865612506866455
local_output_nid generation:  0.01339411735534668
local_in_edges_tensor generation:  0.020943641662597656
mini_batch_src_global generation:  0.03660702705383301
r_  generation:  0.27750086784362793
local_output_nid generation:  0.013541221618652344
local_in_edges_tensor generation:  0.02633357048034668
mini_batch_src_global generation:  0.03564715385437012
r_  generation:  0.288865327835083
----------------------check_connections_block total spend ----------------------------- 6.650876045227051
generate_one_block  0.36474061012268066
generate_one_block  0.33829188346862793
generate_one_block  0.35449910163879395
generate_one_block  0.3470590114593506
generate_one_block  0.34618353843688965
generate_one_block  0.36917591094970703
generate_one_block  0.388822078704834
generate_one_block  0.35002636909484863
generate_one_block  0.38141894340515137
generate_one_block  0.3637692928314209
generate_one_block  0.3606393337249756
generate_one_block  0.36554861068725586
generate_one_block  0.3658590316772461
generate_one_block  0.34655284881591797
generate_one_block  0.35831403732299805
generate_one_block  0.3723440170288086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06621551513671875
gen group dst list time:  0.07506775856018066
time for parepare:  0.02115154266357422
local_output_nid generation:  0.027641773223876953
local_in_edges_tensor generation:  0.06124520301818848
mini_batch_src_global generation:  0.05709242820739746
r_  generation:  0.5231091976165771
local_output_nid generation:  0.03221440315246582
local_in_edges_tensor generation:  0.05185580253601074
mini_batch_src_global generation:  0.06309342384338379
r_  generation:  0.5259177684783936
local_output_nid generation:  0.031911373138427734
local_in_edges_tensor generation:  0.03746223449707031
mini_batch_src_global generation:  0.06028270721435547
r_  generation:  0.5306689739227295
local_output_nid generation:  0.03203940391540527
local_in_edges_tensor generation:  0.047785282135009766
mini_batch_src_global generation:  0.06058788299560547
r_  generation:  0.5405573844909668
local_output_nid generation:  0.031999826431274414
local_in_edges_tensor generation:  0.10451817512512207
mini_batch_src_global generation:  0.061757802963256836
r_  generation:  0.5469975471496582
local_output_nid generation:  0.03396105766296387
local_in_edges_tensor generation:  0.04130196571350098
mini_batch_src_global generation:  0.06585049629211426
r_  generation:  0.5768561363220215
local_output_nid generation:  0.03537487983703613
local_in_edges_tensor generation:  0.04159379005432129
mini_batch_src_global generation:  0.06676793098449707
r_  generation:  0.5384714603424072
local_output_nid generation:  0.032689571380615234
local_in_edges_tensor generation:  0.03992581367492676
mini_batch_src_global generation:  0.06144094467163086
r_  generation:  0.5404806137084961
local_output_nid generation:  0.03319144248962402
local_in_edges_tensor generation:  0.0376739501953125
mini_batch_src_global generation:  0.06557750701904297
r_  generation:  0.5425751209259033
local_output_nid generation:  0.033651113510131836
local_in_edges_tensor generation:  0.033472299575805664
mini_batch_src_global generation:  0.06362342834472656
r_  generation:  0.5411880016326904
local_output_nid generation:  0.03301405906677246
local_in_edges_tensor generation:  0.03380441665649414
mini_batch_src_global generation:  0.06237649917602539
r_  generation:  0.5373284816741943
local_output_nid generation:  0.033612728118896484
local_in_edges_tensor generation:  0.04746437072753906
mini_batch_src_global generation:  0.060430049896240234
r_  generation:  0.5473597049713135
local_output_nid generation:  0.03356504440307617
local_in_edges_tensor generation:  0.03836536407470703
mini_batch_src_global generation:  0.06561470031738281
r_  generation:  0.5432024002075195
local_output_nid generation:  0.03321433067321777
local_in_edges_tensor generation:  0.03667473793029785
mini_batch_src_global generation:  0.06163430213928223
r_  generation:  0.5410299301147461
local_output_nid generation:  0.03344106674194336
local_in_edges_tensor generation:  0.054047584533691406
mini_batch_src_global generation:  0.06173968315124512
r_  generation:  0.5403411388397217
local_output_nid generation:  0.03354024887084961
local_in_edges_tensor generation:  0.041287899017333984
mini_batch_src_global generation:  0.061292409896850586
r_  generation:  0.5575206279754639
----------------------check_connections_block total spend ----------------------------- 12.917260885238647
generate_one_block  0.7281408309936523
generate_one_block  0.7043988704681396
generate_one_block  0.6873137950897217
generate_one_block  0.7001490592956543
generate_one_block  0.6997900009155273
generate_one_block  0.7017440795898438
generate_one_block  0.6878938674926758
generate_one_block  0.6853020191192627
generate_one_block  0.7196483612060547
generate_one_block  0.6839609146118164
generate_one_block  0.6894731521606445
generate_one_block  0.69400954246521
generate_one_block  0.6846721172332764
generate_one_block  0.6708636283874512
generate_one_block  0.6706345081329346
generate_one_block  0.707305908203125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.13782310485839844  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

connection checking time:  19.5681369304657
block generation total time  16.888545274734497
average batch blocks generation time:  1.055534079670906
block dataloader generation time/epoch 38.810659408569336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09722280502319336  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157716, 128])
torch.Size([130137, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26805734634399414  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09576988220214844  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157642, 128])
torch.Size([129888, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2652277946472168  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09574699401855469  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157120, 128])
torch.Size([128951, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2655034065246582  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09585189819335938  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157558, 128])
torch.Size([129486, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2651538848876953  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09696388244628906  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157879, 128])
torch.Size([130219, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.26685619354248047  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09632301330566406  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157552, 128])
torch.Size([130200, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2680811882019043  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09719276428222656  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157737, 128])
torch.Size([130204, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2682194709777832  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09708309173583984  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157738, 128])
torch.Size([130039, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.26706695556640625  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09728145599365234  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157712, 128])
torch.Size([130472, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2686033248901367  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09618997573852539  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157669, 128])
torch.Size([129856, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.26706695556640625  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09606075286865234  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157314, 128])
torch.Size([129714, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2667512893676758  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09720420837402344  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157720, 128])
torch.Size([130268, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2681708335876465  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09709358215332031  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157727, 128])
torch.Size([130204, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2674679756164551  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09568977355957031  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157176, 128])
torch.Size([129081, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2653651237487793  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.0961604118347168  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157573, 128])
torch.Size([129567, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2667670249938965  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09629583358764648  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

torch.Size([157667, 128])
torch.Size([130374, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.26781511306762695  GigaBytes
Max Memory Allocated: 0.29084253311157227  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032758474349975586 |0.014292716979980469 |0.003449559211730957 |8.915364742279053e-05 |0.004168614745140076 |0.0029997825622558594 |
----------------------------------------------------------pseudo_mini_loss sum 4.099643230438232
Total (block generation + training)time/epoch 39.719703912734985
Training time/epoch 0.9088430404663086
Training time without block to device /epoch 0.6801595687866211
Training time without total dataloading part /epoch 0.12631702423095703
load block tensor time/epoch 0.5241355895996094
block to device time/epoch 0.2286834716796875
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5330625
Number of first layer input nodes during this epoch:  2521500
