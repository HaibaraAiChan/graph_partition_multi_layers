Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647945009.3424203
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------before full batch dataloader 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------after full batch dataloader 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

Number of first layer input nodes during this epoch:  167760
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.08530902862548828  GigaBytes
Max Memory Allocated: 0.08530902862548828  GigaBytes

----------------------------------------after batch labels to device
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.08598661422729492  GigaBytes
Max Memory Allocated: 0.08598661422729492  GigaBytes

----------------------------------------after load block subtensor 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.08598661422729492  GigaBytes
Max Memory Allocated: 0.08598661422729492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.11638116836547852  GigaBytes
Max Memory Allocated: 0.11638116836547852  GigaBytes

----------------------------------------before pred = model(blocks, inputs) 
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.11638116836547852  GigaBytes
Max Memory Allocated: 0.11638116836547852  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.11638116836547852  GigaBytes
Max Memory Allocated: 0.11638116836547852  GigaBytes

torch.Size([167760, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.11638116836547852  GigaBytes
Max Memory Allocated: 0.11638116836547852  GigaBytes

m.shape torch.Size([19250, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1170654296875 GB
    Memory Allocated: 0.8919196128845215  GigaBytes
Max Memory Allocated: 0.9075803756713867  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1170654296875 GB
    Memory Allocated: 0.8919196128845215  GigaBytes
Max Memory Allocated: 0.9075803756713867  GigaBytes

----------------------------------------3
 Nvidia-smi: 2.1170654296875 GB
    Memory Allocated: 0.9102778434753418  GigaBytes
Max Memory Allocated: 0.9102778434753418  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 1.0583224296569824  GigaBytes
Max Memory Allocated: 1.0675015449523926  GigaBytes

torch.Size([1, 19250, 128])
m.shape torch.Size([17903, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 1.0662169456481934  GigaBytes
Max Memory Allocated: 1.0675015449523926  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 1.0662169456481934  GigaBytes
Max Memory Allocated: 1.0675015449523926  GigaBytes

----------------------------------------3
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 1.0832905769348145  GigaBytes
Max Memory Allocated: 1.0832905769348145  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5955810546875 GB
    Memory Allocated: 1.3393950462341309  GigaBytes
Max Memory Allocated: 1.3569731712341309  GigaBytes

torch.Size([1, 17903, 128])
m.shape torch.Size([14895, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.6170654296875 GB
    Memory Allocated: 1.3523426055908203  GigaBytes
Max Memory Allocated: 1.3569731712341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6170654296875 GB
    Memory Allocated: 1.3523426055908203  GigaBytes
Max Memory Allocated: 1.3569731712341309  GigaBytes

----------------------------------------3
 Nvidia-smi: 2.6170654296875 GB
    Memory Allocated: 1.3665475845336914  GigaBytes
Max Memory Allocated: 1.3665475845336914  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.6870393753051758  GigaBytes
Max Memory Allocated: 1.7085237503051758  GigaBytes

torch.Size([1, 14895, 128])
m.shape torch.Size([12361, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9881591796875 GB
    Memory Allocated: 1.7035136222839355  GigaBytes
Max Memory Allocated: 1.7085237503051758  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9881591796875 GB
    Memory Allocated: 1.7035136222839355  GigaBytes
Max Memory Allocated: 1.7085237503051758  GigaBytes

----------------------------------------3
 Nvidia-smi: 2.9881591796875 GB
    Memory Allocated: 1.7153019905090332  GigaBytes
Max Memory Allocated: 1.7153019905090332  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3768310546875 GB
    Memory Allocated: 2.0571646690368652  GigaBytes
Max Memory Allocated: 2.0807414054870605  GigaBytes

torch.Size([1, 12361, 128])
m.shape torch.Size([10553, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.3768310546875 GB
    Memory Allocated: 2.0766611099243164  GigaBytes
Max Memory Allocated: 2.0807414054870605  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3768310546875 GB
    Memory Allocated: 2.0766611099243164  GigaBytes
Max Memory Allocated: 2.0807414054870605  GigaBytes

----------------------------------------3
 Nvidia-smi: 3.3768310546875 GB
    Memory Allocated: 2.087313652038574  GigaBytes
Max Memory Allocated: 2.087313652038574  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7830810546875 GB
    Memory Allocated: 2.4507784843444824  GigaBytes
Max Memory Allocated: 2.4761691093444824  GigaBytes

torch.Size([1, 10553, 128])
m.shape torch.Size([8752, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7830810546875 GB
    Memory Allocated: 2.471137046813965  GigaBytes
Max Memory Allocated: 2.4761691093444824  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7830810546875 GB
    Memory Allocated: 2.471137046813965  GigaBytes
Max Memory Allocated: 2.4761691093444824  GigaBytes

----------------------------------------3
 Nvidia-smi: 3.7830810546875 GB
    Memory Allocated: 2.4800071716308594  GigaBytes
Max Memory Allocated: 2.4800071716308594  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 2.8562979698181152  GigaBytes
Max Memory Allocated: 2.8816885948181152  GigaBytes

torch.Size([1, 8752, 128])
m.shape torch.Size([7694, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.2108154296875 GB
    Memory Allocated: 2.8778061866760254  GigaBytes
Max Memory Allocated: 2.8816885948181152  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2108154296875 GB
    Memory Allocated: 2.8778061866760254  GigaBytes
Max Memory Allocated: 2.8816885948181152  GigaBytes

----------------------------------------3
 Nvidia-smi: 4.2108154296875 GB
    Memory Allocated: 2.885499954223633  GigaBytes
Max Memory Allocated: 2.885499954223633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5975341796875 GB
    Memory Allocated: 3.2702035903930664  GigaBytes
Max Memory Allocated: 3.2958850860595703  GigaBytes

torch.Size([1, 7694, 128])
m.shape torch.Size([6714, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5975341796875 GB
    Memory Allocated: 3.292146682739258  GigaBytes
Max Memory Allocated: 3.2958850860595703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5975341796875 GB
    Memory Allocated: 3.292146682739258  GigaBytes
Max Memory Allocated: 3.2958850860595703  GigaBytes

----------------------------------------3
 Nvidia-smi: 4.5975341796875 GB
    Memory Allocated: 3.2988624572753906  GigaBytes
Max Memory Allocated: 3.2988624572753906  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 3.6819963455200195  GigaBytes
Max Memory Allocated: 3.707608222961426  GigaBytes

torch.Size([1, 6714, 128])
m.shape torch.Size([5896, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 3.7040977478027344  GigaBytes
Max Memory Allocated: 3.707608222961426  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 3.7040977478027344  GigaBytes
Max Memory Allocated: 3.707608222961426  GigaBytes

----------------------------------------3
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 3.7097740173339844  GigaBytes
Max Memory Allocated: 3.7097740173339844  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4158935546875 GB
    Memory Allocated: 4.079960823059082  GigaBytes
Max Memory Allocated: 4.105351448059082  GigaBytes

torch.Size([1, 5896, 128])
m.shape torch.Size([5250, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4158935546875 GB
    Memory Allocated: 4.102540016174316  GigaBytes
Max Memory Allocated: 4.105351448059082  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4158935546875 GB
    Memory Allocated: 4.102540016174316  GigaBytes
Max Memory Allocated: 4.105351448059082  GigaBytes

----------------------------------------3
 Nvidia-smi: 5.4158935546875 GB
    Memory Allocated: 4.107865333557129  GigaBytes
Max Memory Allocated: 4.107865333557129  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8358154296875 GB
    Memory Allocated: 4.465275287628174  GigaBytes
Max Memory Allocated: 4.490665912628174  GigaBytes

torch.Size([1, 5250, 128])
m.shape torch.Size([4638, 11, 128])
----------------------------------------1
 Nvidia-smi: 5.8358154296875 GB
    Memory Allocated: 4.4870991706848145  GigaBytes
Max Memory Allocated: 4.490665912628174  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8358154296875 GB
    Memory Allocated: 4.4870991706848145  GigaBytes
Max Memory Allocated: 4.490665912628174  GigaBytes

----------------------------------------3
 Nvidia-smi: 5.8358154296875 GB
    Memory Allocated: 4.492014408111572  GigaBytes
Max Memory Allocated: 4.492014408111572  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 4.838228702545166  GigaBytes
Max Memory Allocated: 4.862555980682373  GigaBytes

torch.Size([1, 4638, 128])
m.shape torch.Size([4181, 12, 128])
----------------------------------------1
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 4.859941005706787  GigaBytes
Max Memory Allocated: 4.862555980682373  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 4.859941005706787  GigaBytes
Max Memory Allocated: 4.862555980682373  GigaBytes

----------------------------------------3
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 4.863955974578857  GigaBytes
Max Memory Allocated: 4.863955974578857  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6287841796875 GB
    Memory Allocated: 5.203437328338623  GigaBytes
Max Memory Allocated: 5.22736120223999  GigaBytes

torch.Size([1, 4181, 128])
m.shape torch.Size([3828, 13, 128])
----------------------------------------1
 Nvidia-smi: 6.6287841796875 GB
    Memory Allocated: 5.225172996520996  GigaBytes
Max Memory Allocated: 5.22736120223999  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6287841796875 GB
    Memory Allocated: 5.225172996520996  GigaBytes
Max Memory Allocated: 5.22736120223999  GigaBytes

----------------------------------------3
 Nvidia-smi: 6.6287841796875 GB
    Memory Allocated: 5.228850364685059  GigaBytes
Max Memory Allocated: 5.228850364685059  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 5.566081523895264  GigaBytes
Max Memory Allocated: 5.589810848236084  GigaBytes

torch.Size([1, 3828, 128])
m.shape torch.Size([3376, 14, 128])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 5.586793422698975  GigaBytes
Max Memory Allocated: 5.589810848236084  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 5.586793422698975  GigaBytes
Max Memory Allocated: 5.589810848236084  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 5.590109348297119  GigaBytes
Max Memory Allocated: 5.590109348297119  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3221435546875 GB
    Memory Allocated: 5.914580821990967  GigaBytes
Max Memory Allocated: 5.938018321990967  GigaBytes

torch.Size([1, 3376, 128])
m.shape torch.Size([3041, 15, 128])
----------------------------------------1
 Nvidia-smi: 7.3221435546875 GB
    Memory Allocated: 5.934599876403809  GigaBytes
Max Memory Allocated: 5.938018321990967  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3221435546875 GB
    Memory Allocated: 5.934599876403809  GigaBytes
Max Memory Allocated: 5.938018321990967  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.3221435546875 GB
    Memory Allocated: 5.937559127807617  GigaBytes
Max Memory Allocated: 5.938018321990967  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6385498046875 GB
    Memory Allocated: 6.253070831298828  GigaBytes
Max Memory Allocated: 6.274821758270264  GigaBytes

torch.Size([1, 3041, 128])
m.shape torch.Size([2735, 16, 128])
----------------------------------------1
 Nvidia-smi: 7.6385498046875 GB
    Memory Allocated: 6.272250652313232  GigaBytes
Max Memory Allocated: 6.274821758270264  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6385498046875 GB
    Memory Allocated: 6.272250652313232  GigaBytes
Max Memory Allocated: 6.274821758270264  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.6385498046875 GB
    Memory Allocated: 6.274962902069092  GigaBytes
Max Memory Allocated: 6.274962902069092  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 6.58389139175415  GigaBytes
Max Memory Allocated: 6.60537576675415  GigaBytes

torch.Size([1, 2735, 128])
m.shape torch.Size([2603, 17, 128])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 6.604071617126465  GigaBytes
Max Memory Allocated: 6.60537576675415  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 6.604071617126465  GigaBytes
Max Memory Allocated: 6.60537576675415  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 6.606616497039795  GigaBytes
Max Memory Allocated: 6.606616497039795  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3260498046875 GB
    Memory Allocated: 6.907304763793945  GigaBytes
Max Memory Allocated: 6.928789138793945  GigaBytes

torch.Size([1, 2603, 128])
m.shape torch.Size([2395, 18, 128])
----------------------------------------1
 Nvidia-smi: 8.3260498046875 GB
    Memory Allocated: 6.927547931671143  GigaBytes
Max Memory Allocated: 6.928789138793945  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3260498046875 GB
    Memory Allocated: 6.927547931671143  GigaBytes
Max Memory Allocated: 6.928789138793945  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.3260498046875 GB
    Memory Allocated: 6.929893970489502  GigaBytes
Max Memory Allocated: 6.929893970489502  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4647216796875 GB
    Memory Allocated: 7.231032848358154  GigaBytes
Max Memory Allocated: 7.252517223358154  GigaBytes

torch.Size([1, 2395, 128])
m.shape torch.Size([2098, 19, 128])
----------------------------------------1
 Nvidia-smi: 8.4647216796875 GB
    Memory Allocated: 7.248898506164551  GigaBytes
Max Memory Allocated: 7.252517223358154  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4647216796875 GB
    Memory Allocated: 7.248898506164551  GigaBytes
Max Memory Allocated: 7.252517223358154  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4647216796875 GB
    Memory Allocated: 7.250916481018066  GigaBytes
Max Memory Allocated: 7.252517223358154  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7772216796875 GB
    Memory Allocated: 7.525233745574951  GigaBytes
Max Memory Allocated: 7.544764995574951  GigaBytes

torch.Size([1, 2098, 128])
m.shape torch.Size([2005, 20, 128])
----------------------------------------1
 Nvidia-smi: 8.7772216796875 GB
    Memory Allocated: 7.543241024017334  GigaBytes
Max Memory Allocated: 7.544764995574951  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7772216796875 GB
    Memory Allocated: 7.543241024017334  GigaBytes
Max Memory Allocated: 7.544764995574951  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.7772216796875 GB
    Memory Allocated: 7.5451531410217285  GigaBytes
Max Memory Allocated: 7.5451531410217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0721435546875 GB
    Memory Allocated: 7.819505214691162  GigaBytes
Max Memory Allocated: 7.839036464691162  GigaBytes

torch.Size([1, 2005, 128])
m.shape torch.Size([1873, 21, 128])
----------------------------------------1
 Nvidia-smi: 9.0721435546875 GB
    Memory Allocated: 7.838080406188965  GigaBytes
Max Memory Allocated: 7.839036464691162  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0721435546875 GB
    Memory Allocated: 7.838080406188965  GigaBytes
Max Memory Allocated: 7.839036464691162  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0740966796875 GB
    Memory Allocated: 7.839866638183594  GigaBytes
Max Memory Allocated: 7.839866638183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3709716796875 GB
    Memory Allocated: 8.104228973388672  GigaBytes
Max Memory Allocated: 8.123760223388672  GigaBytes

torch.Size([1, 1873, 128])
m.shape torch.Size([1563, 22, 128])
----------------------------------------1
 Nvidia-smi: 9.3709716796875 GB
    Memory Allocated: 8.11973237991333  GigaBytes
Max Memory Allocated: 8.123760223388672  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3709716796875 GB
    Memory Allocated: 8.11973237991333  GigaBytes
Max Memory Allocated: 8.123760223388672  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.3709716796875 GB
    Memory Allocated: 8.121222972869873  GigaBytes
Max Memory Allocated: 8.123760223388672  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6307373046875 GB
    Memory Allocated: 8.35404920578003  GigaBytes
Max Memory Allocated: 8.370599269866943  GigaBytes

torch.Size([1, 1563, 128])
m.shape torch.Size([1446, 23, 128])
----------------------------------------1
 Nvidia-smi: 9.6307373046875 GB
    Memory Allocated: 8.369853973388672  GigaBytes
Max Memory Allocated: 8.370599269866943  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6307373046875 GB
    Memory Allocated: 8.369853973388672  GigaBytes
Max Memory Allocated: 8.370599269866943  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.6307373046875 GB
    Memory Allocated: 8.371232986450195  GigaBytes
Max Memory Allocated: 8.371232986450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.8905029296875 GB
    Memory Allocated: 8.596658706665039  GigaBytes
Max Memory Allocated: 8.612517356872559  GigaBytes

torch.Size([1, 1446, 128])
m.shape torch.Size([1417, 24, 128])
----------------------------------------1
 Nvidia-smi: 9.8905029296875 GB
    Memory Allocated: 8.61218547821045  GigaBytes
Max Memory Allocated: 8.612565994262695  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.8905029296875 GB
    Memory Allocated: 8.61218547821045  GigaBytes
Max Memory Allocated: 8.612565994262695  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.8924560546875 GB
    Memory Allocated: 8.613536834716797  GigaBytes
Max Memory Allocated: 8.613536834716797  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1561279296875 GB
    Memory Allocated: 8.848319053649902  GigaBytes
Max Memory Allocated: 8.865147590637207  GigaBytes

torch.Size([1, 1417, 128])
m.shape torch.Size([20175, 25, 128])
----------------------------------------1
 Nvidia-smi: 10.3983154296875 GB
    Memory Allocated: 9.08814811706543  GigaBytes
Max Memory Allocated: 9.094166278839111  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3983154296875 GB
    Memory Allocated: 9.08814811706543  GigaBytes
Max Memory Allocated: 9.094166278839111  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4178466796875 GB
    Memory Allocated: 9.107388496398926  GigaBytes
Max Memory Allocated: 9.107388496398926  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0975341796875 GB
    Memory Allocated: 12.544888496398926  GigaBytes
Max Memory Allocated: 12.785393238067627  GigaBytes

torch.Size([1, 20175, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.0975341796875 GB
    Memory Allocated: 11.862576484680176  GigaBytes
Max Memory Allocated: 12.785393238067627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.0975341796875 GB
    Memory Allocated: 12.021498680114746  GigaBytes
Max Memory Allocated: 12.785393238067627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.0975341796875 GB
    Memory Allocated: 12.180420875549316  GigaBytes
Max Memory Allocated: 12.785393238067627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.0975341796875 GB
    Memory Allocated: 12.019852638244629  GigaBytes
Max Memory Allocated: 12.785393238067627  GigaBytes

torch.Size([166642, 256])
input nodes number: 167760
output nodes number: 166642
edges number: 1567872
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 14.0975341796875 GB
    Memory Allocated: 12.181717872619629  GigaBytes
Max Memory Allocated: 12.785393238067627  GigaBytes

torch.Size([166642, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.0975341796875 GB
    Memory Allocated: 12.3406400680542  GigaBytes
Max Memory Allocated: 12.785393238067627  GigaBytes

torch.Size([166642, 256])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.0975341796875 GB
    Memory Allocated: 12.380370616912842  GigaBytes
Max Memory Allocated: 12.785393238067627  GigaBytes

torch.Size([166642, 256])
----------------------------------------before model layer 1
 Nvidia-smi: 14.0975341796875 GB
    Memory Allocated: 12.380370616912842  GigaBytes
Max Memory Allocated: 12.785393238067627  GigaBytes

torch.Size([166642, 256])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.0975341796875 GB
    Memory Allocated: 12.380370616912842  GigaBytes
Max Memory Allocated: 12.785393238067627  GigaBytes

m.shape torch.Size([16911, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.6873779296875 GB
    Memory Allocated: 14.003904342651367  GigaBytes
Max Memory Allocated: 14.015459060668945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6873779296875 GB
    Memory Allocated: 14.003904342651367  GigaBytes
Max Memory Allocated: 14.015459060668945  GigaBytes

----------------------------------------3
 Nvidia-smi: 15.6873779296875 GB
    Memory Allocated: 14.03615951538086  GigaBytes
Max Memory Allocated: 14.03615951538086  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7225341796875 GB
    Memory Allocated: 14.294200897216797  GigaBytes
Max Memory Allocated: 14.310328483581543  GigaBytes

torch.Size([1, 16911, 256])
m.shape torch.Size([16257, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.7225341796875 GB
    Memory Allocated: 14.310036182403564  GigaBytes
Max Memory Allocated: 14.310328483581543  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7225341796875 GB
    Memory Allocated: 14.310036182403564  GigaBytes
Max Memory Allocated: 14.310328483581543  GigaBytes

----------------------------------------3
 Nvidia-smi: 15.7381591796875 GB
    Memory Allocated: 14.34116506576538  GigaBytes
Max Memory Allocated: 14.34116506576538  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2381591796875 GB
    Memory Allocated: 14.80991506576538  GigaBytes
Max Memory Allocated: 14.84116506576538  GigaBytes

torch.Size([1, 16257, 256])
m.shape torch.Size([13782, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.2791748046875 GB
    Memory Allocated: 14.834029197692871  GigaBytes
Max Memory Allocated: 14.84116506576538  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2791748046875 GB
    Memory Allocated: 14.834029197692871  GigaBytes
Max Memory Allocated: 14.84116506576538  GigaBytes

----------------------------------------3
 Nvidia-smi: 16.2791748046875 GB
    Memory Allocated: 14.860946655273438  GigaBytes
Max Memory Allocated: 14.860946655273438  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8768310546875 GB
    Memory Allocated: 15.44387435913086  GigaBytes
Max Memory Allocated: 15.483304977416992  GigaBytes

torch.Size([1, 13782, 256])
m.shape torch.Size([11550, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.9217529296875 GB
    Memory Allocated: 15.475468635559082  GigaBytes
Max Memory Allocated: 15.483304977416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.9217529296875 GB
    Memory Allocated: 15.475468635559082  GigaBytes
Max Memory Allocated: 15.483304977416992  GigaBytes

----------------------------------------3
 Nvidia-smi: 16.9217529296875 GB
    Memory Allocated: 15.497498512268066  GigaBytes
Max Memory Allocated: 15.497498512268066  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.5994873046875 GB
    Memory Allocated: 16.15234088897705  GigaBytes
Max Memory Allocated: 16.19726276397705  GigaBytes

torch.Size([1, 11550, 256])
m.shape torch.Size([9956, 5, 256])
----------------------------------------1
 Nvidia-smi: 17.6483154296875 GB
    Memory Allocated: 16.188467025756836  GigaBytes
Max Memory Allocated: 16.19726276397705  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.6483154296875 GB
    Memory Allocated: 16.188467025756836  GigaBytes
Max Memory Allocated: 16.19726276397705  GigaBytes

----------------------------------------3
 Nvidia-smi: 17.6483154296875 GB
    Memory Allocated: 16.20787286758423  GigaBytes
Max Memory Allocated: 16.20787286758423  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3612060546875 GB
    Memory Allocated: 16.894747257232666  GigaBytes
Max Memory Allocated: 16.94222116470337  GigaBytes

torch.Size([1, 9956, 256])
m.shape torch.Size([8312, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.3612060546875 GB
    Memory Allocated: 16.933186054229736  GigaBytes
Max Memory Allocated: 16.94222116470337  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3612060546875 GB
    Memory Allocated: 16.933186054229736  GigaBytes
Max Memory Allocated: 16.94222116470337  GigaBytes

----------------------------------------3
 Nvidia-smi: 18.3612060546875 GB
    Memory Allocated: 16.94969367980957  GigaBytes
Max Memory Allocated: 16.94969367980957  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.1248779296875 GB
    Memory Allocated: 17.631410598754883  GigaBytes
Max Memory Allocated: 17.678972244262695  GigaBytes

torch.Size([1, 8312, 256])
m.shape torch.Size([7277, 7, 256])
----------------------------------------1
 Nvidia-smi: 19.1248779296875 GB
    Memory Allocated: 17.672691345214844  GigaBytes
Max Memory Allocated: 17.678972244262695  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.1248779296875 GB
    Memory Allocated: 17.672691345214844  GigaBytes
Max Memory Allocated: 17.678972244262695  GigaBytes

----------------------------------------3
 Nvidia-smi: 19.1248779296875 GB
    Memory Allocated: 17.68710947036743  GigaBytes
Max Memory Allocated: 17.68710947036743  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9451904296875 GB
    Memory Allocated: 18.38109827041626  GigaBytes
Max Memory Allocated: 18.42992639541626  GigaBytes

torch.Size([1, 7277, 256])
m.shape torch.Size([6396, 8, 256])
----------------------------------------1
 Nvidia-smi: 19.9451904296875 GB
    Memory Allocated: 18.423367977142334  GigaBytes
Max Memory Allocated: 18.42992639541626  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9451904296875 GB
    Memory Allocated: 18.423367977142334  GigaBytes
Max Memory Allocated: 18.42992639541626  GigaBytes

----------------------------------------3
 Nvidia-smi: 19.9451904296875 GB
    Memory Allocated: 18.435959339141846  GigaBytes
Max Memory Allocated: 18.435959339141846  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7205810546875 GB
    Memory Allocated: 19.131717205047607  GigaBytes
Max Memory Allocated: 19.180545330047607  GigaBytes

torch.Size([1, 6396, 256])
m.shape torch.Size([5639, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7205810546875 GB
    Memory Allocated: 19.174823760986328  GigaBytes
Max Memory Allocated: 19.180545330047607  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7205810546875 GB
    Memory Allocated: 19.174823760986328  GigaBytes
Max Memory Allocated: 19.180545330047607  GigaBytes

----------------------------------------3
 Nvidia-smi: 20.7205810546875 GB
    Memory Allocated: 19.186126708984375  GigaBytes
Max Memory Allocated: 19.186126708984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4803466796875 GB
    Memory Allocated: 19.876092433929443  GigaBytes
Max Memory Allocated: 19.924920558929443  GigaBytes

torch.Size([1, 5639, 256])
m.shape torch.Size([5052, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.4803466796875 GB
    Memory Allocated: 19.91991949081421  GigaBytes
Max Memory Allocated: 19.924920558929443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4803466796875 GB
    Memory Allocated: 19.91991949081421  GigaBytes
Max Memory Allocated: 19.924920558929443  GigaBytes

----------------------------------------3
 Nvidia-smi: 21.4803466796875 GB
    Memory Allocated: 19.929914474487305  GigaBytes
Max Memory Allocated: 19.929914474487305  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.2322998046875 GB
    Memory Allocated: 20.623703956604004  GigaBytes
Max Memory Allocated: 20.672532081604004  GigaBytes

torch.Size([1, 5052, 256])
m.shape torch.Size([4479, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.2322998046875 GB
    Memory Allocated: 20.665980339050293  GigaBytes
Max Memory Allocated: 20.672532081604004  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.2322998046875 GB
    Memory Allocated: 20.665980339050293  GigaBytes
Max Memory Allocated: 20.672532081604004  GigaBytes

----------------------------------------3
 Nvidia-smi: 22.2322998046875 GB
    Memory Allocated: 20.675329208374023  GigaBytes
Max Memory Allocated: 20.675329208374023  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.9783935546875 GB
    Memory Allocated: 21.35792350769043  GigaBytes
Max Memory Allocated: 21.40491008758545  GigaBytes

torch.Size([1, 4479, 256])
m.shape torch.Size([4038, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.9783935546875 GB
    Memory Allocated: 21.400224685668945  GigaBytes
Max Memory Allocated: 21.40491008758545  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.9783935546875 GB
    Memory Allocated: 21.400224685668945  GigaBytes
Max Memory Allocated: 21.40491008758545  GigaBytes

----------------------------------------3
 Nvidia-smi: 22.9783935546875 GB
    Memory Allocated: 21.408669471740723  GigaBytes
Max Memory Allocated: 21.408669471740723  GigaBytes

Traceback (most recent call last):
  File "full_batch_arxiv_sage_GPU_mem.py", line 467, in <module>
    main()
  File "full_batch_arxiv_sage_GPU_mem.py", line 463, in main
    best_test = run(args, device, data)
  File "full_batch_arxiv_sage_GPU_mem.py", line 282, in run
    pred = model(blocks, full_batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/full_batch_train/SAGE/graphsage_model_arxiv.py", line 179, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/full_batch_train/SAGE/graphsage_model_arxiv.py", line 128, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/graph_partition_multi_layers/full_batch_train/SAGE/graphsage_model_arxiv.py", line 74, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 16.00 MiB (GPU 0; 23.62 GiB total capacity; 22.04 GiB already allocated; 12.44 MiB free; 22.41 GiB reserved in total by PyTorch)
